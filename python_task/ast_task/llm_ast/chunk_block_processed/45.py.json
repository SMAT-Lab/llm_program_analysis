{
    "type": "module",
    "start_token": 0,
    "end_token": 99,
    "label": "import logging\nimport uuid\nfrom datetime import datetime, timezone\nfrom typing import List, Optional\n\nfrom autogpt_libs.api_key.key_manager import APIKeyManager\nfrom prisma.enums import APIKeyPermission, APIKeyStatus\nfrom prisma.errors import PrismaError\nfrom prisma.models import APIKey as PrismaAPIKey\nfrom prisma.types import (\n    APIKeyCreateInput,\n    APIKeyUpdateInput,\n    APIKeyWhereInput,\n    APIKeyWhereUniqueInput,\n)\nfrom pydantic import BaseModel\n\nfrom backend.data.db import BaseDbModel\n\nlogger = logging.getLogger(__name__)",
    "children": [
        {
            "type": "import_statement",
            "start_token": 0,
            "end_token": 1,
            "label": "import logging",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 1,
                    "end_token": 1,
                    "label": "logging",
                    "children": []
                }
            ]
        },
        {
            "type": "import_statement",
            "start_token": 3,
            "end_token": 4,
            "label": "import uuid",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 4,
                    "end_token": 4,
                    "label": "uuid",
                    "children": []
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 6,
            "end_token": 11,
            "label": "from datetime import datetime, timezone",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 7,
                    "end_token": 7,
                    "label": "datetime",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 9,
                    "end_token": 11,
                    "label": "datetime, timezone",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 9,
                            "end_token": 9,
                            "label": "datetime",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 11,
                            "end_token": 11,
                            "label": "timezone",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 13,
            "end_token": 18,
            "label": "from typing import List, Optional",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 14,
                    "end_token": 14,
                    "label": "typing",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 16,
                    "end_token": 18,
                    "label": "List, Optional",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 16,
                            "end_token": 16,
                            "label": "List",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 18,
                            "end_token": 18,
                            "label": "Optional",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 21,
            "end_token": 28,
            "label": "from autogpt_libs.api_key.key_manager import APIKeyManager",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 22,
                    "end_token": 26,
                    "label": "autogpt_libs.api_key.key_manager",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 28,
                    "end_token": 28,
                    "label": "APIKeyManager",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 28,
                            "end_token": 28,
                            "label": "APIKeyManager",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 30,
            "end_token": 37,
            "label": "from prisma.enums import APIKeyPermission, APIKeyStatus",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 31,
                    "end_token": 33,
                    "label": "prisma.enums",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 35,
                    "end_token": 37,
                    "label": "APIKeyPermission, APIKeyStatus",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 35,
                            "end_token": 35,
                            "label": "APIKeyPermission",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 37,
                            "end_token": 37,
                            "label": "APIKeyStatus",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 39,
            "end_token": 44,
            "label": "from prisma.errors import PrismaError",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 40,
                    "end_token": 42,
                    "label": "prisma.errors",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 44,
                    "end_token": 44,
                    "label": "PrismaError",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 44,
                            "end_token": 44,
                            "label": "PrismaError",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 46,
            "end_token": 53,
            "label": "from prisma.models import APIKey as PrismaAPIKey",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 47,
                    "end_token": 49,
                    "label": "prisma.models",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 51,
                    "end_token": 53,
                    "label": "APIKey as PrismaAPIKey",
                    "children": [
                        {
                            "type": "aliased_import",
                            "start_token": 51,
                            "end_token": 53,
                            "label": "APIKey as PrismaAPIKey",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 51,
                                    "end_token": 51,
                                    "label": "APIKey",
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 53,
                                    "end_token": 53,
                                    "label": "PrismaAPIKey",
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 55,
            "end_token": 74,
            "label": "from prisma.types import (\n    APIKeyCreateInput,\n    APIKeyUpdateInput,\n    APIKeyWhereInput,\n    APIKeyWhereUniqueInput,\n)",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 56,
                    "end_token": 58,
                    "label": "prisma.types",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 60,
                    "end_token": 74,
                    "label": "(\n    APIKeyCreateInput,\n    APIKeyUpdateInput,\n    APIKeyWhereInput,\n    APIKeyWhereUniqueInput,\n)",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 62,
                            "end_token": 62,
                            "label": "APIKeyCreateInput",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 64,
                            "end_token": 64,
                            "label": "\n",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 66,
                            "end_token": 66,
                            "label": ",",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 68,
                            "end_token": 68,
                            "label": "APIKeyWhereInput",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 70,
                            "end_token": 70,
                            "label": "\n",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 76,
            "end_token": 79,
            "label": "from pydantic import BaseModel",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 77,
                    "end_token": 77,
                    "label": "pydantic",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 79,
                    "end_token": 79,
                    "label": "BaseModel",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 79,
                            "end_token": 79,
                            "label": "BaseModel",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "start_token": 82,
            "end_token": 89,
            "label": "from backend.data.db import BaseDbModel",
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 83,
                    "end_token": 87,
                    "label": "backend.data.db",
                    "children": []
                },
                {
                    "type": "import_prefix",
                    "start_token": 89,
                    "end_token": 89,
                    "label": "BaseDbModel",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 89,
                            "end_token": 89,
                            "label": "BaseDbModel",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "assignment",
            "start_token": 92,
            "end_token": 99,
            "label": "logger = logging.getLogger(__name__)",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 92,
                    "end_token": 92,
                    "label": "logger",
                    "children": []
                },
                {
                    "type": "call",
                    "start_token": 94,
                    "end_token": 99,
                    "label": "logging.getLogger(__name__)",
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 94,
                            "end_token": 96,
                            "label": "logging.getLogger",
                            "children": [
                                {
                                    "type": "dotted_name",
                                    "start_token": 94,
                                    "end_token": 94,
                                    "label": "logging",
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 96,
                                    "end_token": 96,
                                    "label": "getLogger",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "argument_list",
                            "start_token": 97,
                            "end_token": 99,
                            "label": "(__name__)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 98,
                                    "end_token": 98,
                                    "label": "__name__",
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "start_token": 108,
            "end_token": 121,
            "label": "class APIKeyError(Exception):\n    \"\"\"Base exception for API key operations\"\"\"\n\n    pass\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 109,
                    "end_token": 109,
                    "label": "APIKeyError",
                    "children": []
                },
                {
                    "type": "argument_list",
                    "start_token": 110,
                    "end_token": 112,
                    "label": "(Exception)",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 111,
                            "end_token": 111,
                            "label": "Exception",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "string",
                    "start_token": 115,
                    "end_token": 117,
                    "label": "\"\"\"Base exception for API key operations\"\"\"",
                    "children": [
                        {
                            "type": "string_content",
                            "start_token": 116,
                            "end_token": 116,
                            "label": "\"Base exception for API key operations\"",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": 119,
                    "end_token": 120,
                    "label": "\n    pass",
                    "children": [
                        {
                            "type": "pass_statement",
                            "start_token": 120,
                            "end_token": 120,
                            "label": "pass",
                            "children": []
                        }
                    ]
                }
            ],
            "name": "APIKeyError",
            "start_line": 24,
            "end_line": 27
        },
        {
            "type": "class_definition",
            "start_token": 124,
            "end_token": 137,
            "label": "class APIKeyNotFoundError(APIKeyError):\n    \"\"\"Raised when an API key is not found\"\"\"\n\n    pass\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 124,
                    "end_token": 124,
                    "label": "class",
                    "children": []
                },
                {
                    "type": "identifier",
                    "start_token": 125,
                    "end_token": 125,
                    "label": "APIKeyNotFoundError",
                    "children": []
                },
                {
                    "type": "argument_list",
                    "start_token": 126,
                    "end_token": 128,
                    "label": "(APIKeyError)",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 127,
                            "end_token": 127,
                            "label": "APIKeyError",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "string",
                    "start_token": 131,
                    "end_token": 133,
                    "label": "\"\"\"Raised when an API key is not found\"\"\"",
                    "children": []
                },
                {
                    "type": "pass_statement",
                    "start_token": 136,
                    "end_token": 136,
                    "label": "pass",
                    "children": []
                }
            ],
            "name": "APIKeyNotFoundError",
            "start_line": 30,
            "end_line": 33
        },
        {
            "type": "class_definition",
            "start_token": 140,
            "end_token": 153,
            "label": "class APIKeyPermissionError(APIKeyError):\n    \"\"\"Raised when there are permission issues with API key operations\"\"\"\n\n    pass\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 140,
                    "end_token": 140,
                    "label": "class",
                    "children": []
                },
                {
                    "type": "identifier",
                    "start_token": 141,
                    "end_token": 141,
                    "label": "APIKeyPermissionError",
                    "children": []
                },
                {
                    "type": "argument_list",
                    "start_token": 142,
                    "end_token": 144,
                    "label": "(APIKeyError)",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 143,
                            "end_token": 143,
                            "label": "APIKeyError",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": 145,
                    "end_token": 152,
                    "label": ":\n    \"\"\"Raised when there are permission issues with API key operations\"\"\"\n\n    pass",
                    "children": [
                        {
                            "type": "string",
                            "start_token": 147,
                            "end_token": 149,
                            "label": "\"\"\"Raised when there are permission issues with API key operations\"\"\"",
                            "children": []
                        },
                        {
                            "type": "pass_statement",
                            "start_token": 152,
                            "end_token": 152,
                            "label": "pass",
                            "children": []
                        }
                    ]
                }
            ],
            "name": "APIKeyPermissionError",
            "start_line": 36,
            "end_line": 39
        },
        {
            "type": "class_definition",
            "start_token": 156,
            "end_token": 169,
            "label": "class APIKeyValidationError(APIKeyError):\n    \"\"\"Raised when API key validation fails\"\"\"\n\n    pass\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 156,
                    "end_token": 156,
                    "label": "class",
                    "children": []
                },
                {
                    "type": "identifier",
                    "start_token": 157,
                    "end_token": 157,
                    "label": "APIKeyValidationError",
                    "children": []
                },
                {
                    "type": "argument_list",
                    "start_token": 158,
                    "end_token": 160,
                    "label": "(APIKeyError)",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 159,
                            "end_token": 159,
                            "label": "APIKeyError",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": 162,
                    "end_token": 168,
                    "label": "\n    \"\"\"Raised when API key validation fails\"\"\"\n\n    pass",
                    "children": [
                        {
                            "type": "string",
                            "start_token": 163,
                            "end_token": 165,
                            "label": "\"\"\"Raised when API key validation fails\"\"\"",
                            "children": [
                                {
                                    "type": "string_start",
                                    "start_token": 163,
                                    "end_token": 163,
                                    "label": "\"\"",
                                    "children": []
                                },
                                {
                                    "type": "string_content",
                                    "start_token": 164,
                                    "end_token": 164,
                                    "label": "\"Raised when API key validation fails\"",
                                    "children": []
                                },
                                {
                                    "type": "string_end",
                                    "start_token": 165,
                                    "end_token": 165,
                                    "label": "\"\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "pass_statement",
                            "start_token": 168,
                            "end_token": 168,
                            "label": "pass",
                            "children": []
                        }
                    ]
                }
            ],
            "name": "APIKeyValidationError",
            "start_line": 42,
            "end_line": 45
        },
        {
            "type": "class_placeholder",
            "name": "APIKey",
            "start_line": 48,
            "end_line": 80,
            "start_token": 172,
            "end_token": 383,
            "label": "class APIKey(BaseDbModel):\n    name: str\n    prefix: str\n    key: str\n    status: APIKeyStatus = APIKeyStatus.ACTIVE\n    permissions: List[APIKeyPermission]\n    postfix: str\n    created_at: datetime\n    last_used_at: Optional[datetime] = None\n    revoked_at: Optional[datetime] = None\n    description: Optional[str] = None\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")\n",
            "children": [
                {
                    "type": "module",
                    "start_token": 172,
                    "end_token": 248,
                    "label": "class APIKey(BaseDbModel):\n    name: str\n    prefix: str\n    key: str\n    status: APIKeyStatus = APIKeyStatus.ACTIVE\n    permissions: List[APIKeyPermission]\n    postfix: str\n    created_at: datetime\n    last_used_at: Optional[datetime] = None\n    revoked_at: Optional[datetime] = None\n    description: Optional[str] = None\n    user_id: str\n\n    @staticmethod\n",
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 172,
                            "end_token": 244,
                            "label": "class APIKey(BaseDbModel):\n    name: str\n    prefix: str\n    key: str\n    status: APIKeyStatus = APIKeyStatus.ACTIVE\n    permissions: List[APIKeyPermission]\n    postfix: str\n    created_at: datetime\n    last_used_at: Optional[datetime] = None\n    revoked_at: Optional[datetime] = None\n    description: Optional[str] = None\n    user_id: str\n",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 173,
                                    "end_token": 173,
                                    "label": "APIKey",
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "start_token": 174,
                                    "end_token": 176,
                                    "label": "(BaseDbModel)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 175,
                                            "end_token": 175,
                                            "label": "BaseDbModel",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": 178,
                                    "end_token": 244,
                                    "label": "\n    name: str\n    prefix: str\n    key: str\n    status: APIKeyStatus = APIKeyStatus.ACTIVE\n    permissions: List[APIKeyPermission]\n    postfix: str\n    created_at: datetime\n    last_used_at: Optional[datetime] = None\n    revoked_at: Optional[datetime] = None\n    description: Optional[str] = None\n    user_id: str\n",
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 179,
                                            "end_token": 181,
                                            "label": "name: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 179,
                                                    "end_token": 179,
                                                    "label": "name",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 181,
                                                    "end_token": 181,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 183,
                                            "end_token": 185,
                                            "label": "prefix: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 183,
                                                    "end_token": 183,
                                                    "label": "prefix",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 185,
                                                    "end_token": 185,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 187,
                                            "end_token": 189,
                                            "label": "key: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 187,
                                                    "end_token": 187,
                                                    "label": "key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 189,
                                                    "end_token": 189,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 191,
                                            "end_token": 197,
                                            "label": "status: APIKeyStatus = APIKeyStatus.ACTIVE",
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "start_token": 191,
                                                    "end_token": 193,
                                                    "label": "status: APIKeyStatus",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 191,
                                                            "end_token": 191,
                                                            "label": "status",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 193,
                                                            "end_token": 193,
                                                            "label": "APIKeyStatus",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 195,
                                                    "end_token": 197,
                                                    "label": "APIKeyStatus.ACTIVE",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 195,
                                                            "end_token": 195,
                                                            "label": "APIKeyStatus",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 197,
                                                            "end_token": 197,
                                                            "label": "ACTIVE",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 199,
                                            "end_token": 204,
                                            "label": "permissions: List[APIKeyPermission]",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 199,
                                                    "end_token": 199,
                                                    "label": "permissions",
                                                    "children": []
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 201,
                                                    "end_token": 204,
                                                    "label": "List[APIKeyPermission]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 201,
                                                            "end_token": 201,
                                                            "label": "List",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 203,
                                                            "end_token": 203,
                                                            "label": "APIKeyPermission",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 206,
                                            "end_token": 208,
                                            "label": "postfix: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 206,
                                                    "end_token": 206,
                                                    "label": "postfix",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 208,
                                                    "end_token": 208,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 210,
                                            "end_token": 212,
                                            "label": "created_at: datetime",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 210,
                                                    "end_token": 210,
                                                    "label": "created_at",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 212,
                                                    "end_token": 212,
                                                    "label": "datetime",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 214,
                                            "end_token": 221,
                                            "label": "last_used_at: Optional[datetime] = None",
                                            "children": [
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 214,
                                                    "end_token": 219,
                                                    "label": "last_used_at: Optional[datetime]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 214,
                                                            "end_token": 214,
                                                            "label": "last_used_at",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 216,
                                                            "end_token": 219,
                                                            "label": "Optional[datetime]",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 216,
                                                                    "end_token": 216,
                                                                    "label": "Optional",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 218,
                                                                    "end_token": 218,
                                                                    "label": "datetime",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 221,
                                                    "end_token": 221,
                                                    "label": "None",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 223,
                                            "end_token": 230,
                                            "label": "revoked_at: Optional[datetime] = None",
                                            "children": [
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 223,
                                                    "end_token": 228,
                                                    "label": "revoked_at: Optional[datetime]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 223,
                                                            "end_token": 223,
                                                            "label": "revoked_at",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 225,
                                                            "end_token": 228,
                                                            "label": "Optional[datetime]",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 225,
                                                                    "end_token": 225,
                                                                    "label": "Optional",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 227,
                                                                    "end_token": 227,
                                                                    "label": "datetime",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 230,
                                                    "end_token": 230,
                                                    "label": "None",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 232,
                                            "end_token": 239,
                                            "label": "description: Optional[str] = None",
                                            "children": [
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 232,
                                                    "end_token": 237,
                                                    "label": "description: Optional[str]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 232,
                                                            "end_token": 232,
                                                            "label": "description",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 234,
                                                            "end_token": 237,
                                                            "label": "Optional[str]",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 234,
                                                                    "end_token": 234,
                                                                    "label": "Optional",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 236,
                                                                    "end_token": 236,
                                                                    "label": "str",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 239,
                                                    "end_token": 239,
                                                    "label": "None",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 241,
                                            "end_token": 243,
                                            "label": "user_id: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 241,
                                                    "end_token": 241,
                                                    "label": "user_id",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 243,
                                                    "end_token": 243,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorator",
                            "start_token": 246,
                            "end_token": 247,
                            "label": "@staticmethod",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 247,
                                    "end_token": 247,
                                    "label": "staticmethod",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "start_token": 249,
                            "end_token": 383,
                            "label": "def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")\n",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 250,
                                    "end_token": 250,
                                    "label": "from_db",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 251,
                                    "end_token": 255,
                                    "label": "(api_key: PrismaAPIKey)",
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 252,
                                            "end_token": 254,
                                            "label": "api_key: PrismaAPIKey",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 252,
                                                    "end_token": 252,
                                                    "label": "api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 254,
                                                    "end_token": 254,
                                                    "label": "PrismaAPIKey",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": 257,
                                    "end_token": 382,
                                    "label": "\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "try_statement",
                                            "start_token": 258,
                                            "end_token": 382,
                                            "label": "try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 260,
                                                    "end_token": 361,
                                                    "label": "\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 261,
                                                            "end_token": 361,
                                                            "label": "return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 262,
                                                                    "end_token": 361,
                                                                    "label": "APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 262,
                                                                            "end_token": 262,
                                                                            "label": "APIKey",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 263,
                                                                            "end_token": 361,
                                                                            "label": "(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 265,
                                                                                    "end_token": 270,
                                                                                    "label": "id=api_key.id,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 265,
                                                                                            "end_token": 265,
                                                                                            "label": "id",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 267,
                                                                                            "end_token": 269,
                                                                                            "label": "api_key.id",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 267,
                                                                                                    "end_token": 267,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 269,
                                                                                                    "end_token": 269,
                                                                                                    "label": "id",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 272,
                                                                                    "end_token": 277,
                                                                                    "label": "name=api_key.name,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 272,
                                                                                            "end_token": 272,
                                                                                            "label": "name",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 274,
                                                                                            "end_token": 276,
                                                                                            "label": "api_key.name",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 274,
                                                                                                    "end_token": 274,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 276,
                                                                                                    "end_token": 276,
                                                                                                    "label": "name",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 279,
                                                                                    "end_token": 284,
                                                                                    "label": "prefix=api_key.prefix,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 279,
                                                                                            "end_token": 279,
                                                                                            "label": "prefix",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 281,
                                                                                            "end_token": 283,
                                                                                            "label": "api_key.prefix",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 281,
                                                                                                    "end_token": 281,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 283,
                                                                                                    "end_token": 283,
                                                                                                    "label": "prefix",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 286,
                                                                                    "end_token": 291,
                                                                                    "label": "postfix=api_key.postfix,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 286,
                                                                                            "end_token": 286,
                                                                                            "label": "postfix",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 288,
                                                                                            "end_token": 290,
                                                                                            "label": "api_key.postfix",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 288,
                                                                                                    "end_token": 288,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 290,
                                                                                                    "end_token": 290,
                                                                                                    "label": "postfix",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 293,
                                                                                    "end_token": 298,
                                                                                    "label": "key=api_key.key,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 293,
                                                                                            "end_token": 293,
                                                                                            "label": "key",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 295,
                                                                                            "end_token": 297,
                                                                                            "label": "api_key.key",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 295,
                                                                                                    "end_token": 295,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 297,
                                                                                                    "end_token": 297,
                                                                                                    "label": "key",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 300,
                                                                                    "end_token": 308,
                                                                                    "label": "status=APIKeyStatus(api_key.status),",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 300,
                                                                                            "end_token": 300,
                                                                                            "label": "status",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 302,
                                                                                            "end_token": 307,
                                                                                            "label": "APIKeyStatus(api_key.status)",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 302,
                                                                                                    "end_token": 302,
                                                                                                    "label": "APIKeyStatus",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 303,
                                                                                                    "end_token": 307,
                                                                                                    "label": "(api_key.status)",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 304,
                                                                                                            "end_token": 306,
                                                                                                            "label": "api_key.status",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 304,
                                                                                                                    "end_token": 304,
                                                                                                                    "label": "api_key",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 306,
                                                                                                                    "end_token": 306,
                                                                                                                    "label": "status",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 310,
                                                                                    "end_token": 323,
                                                                                    "label": "permissions=[APIKeyPermission(p) for p in api_key.permissions]",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 310,
                                                                                            "end_token": 310,
                                                                                            "label": "permissions",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "list_comprehension",
                                                                                            "start_token": 312,
                                                                                            "end_token": 323,
                                                                                            "label": "[APIKeyPermission(p) for p in api_key.permissions]",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 313,
                                                                                                    "end_token": 316,
                                                                                                    "label": "APIKeyPermission(p)",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 313,
                                                                                                            "end_token": 313,
                                                                                                            "label": "APIKeyPermission",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 314,
                                                                                                            "end_token": 316,
                                                                                                            "label": "(p)",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 315,
                                                                                                                    "end_token": 315,
                                                                                                                    "label": "p",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "for_in_clause",
                                                                                                    "start_token": 317,
                                                                                                    "end_token": 322,
                                                                                                    "label": "for p in api_key.permissions",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 318,
                                                                                                            "end_token": 318,
                                                                                                            "label": "p",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 320,
                                                                                                            "end_token": 322,
                                                                                                            "label": "api_key.permissions",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 320,
                                                                                                                    "end_token": 320,
                                                                                                                    "label": "api_key",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 322,
                                                                                                                    "end_token": 322,
                                                                                                                    "label": "permissions",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 326,
                                                                                    "end_token": 331,
                                                                                    "label": "created_at=api_key.createdAt,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 326,
                                                                                            "end_token": 326,
                                                                                            "label": "created_at",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 328,
                                                                                            "end_token": 330,
                                                                                            "label": "api_key.createdAt",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 328,
                                                                                                    "end_token": 328,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 330,
                                                                                                    "end_token": 330,
                                                                                                    "label": "createdAt",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 333,
                                                                                    "end_token": 338,
                                                                                    "label": "last_used_at=api_key.lastUsedAt,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 333,
                                                                                            "end_token": 333,
                                                                                            "label": "last_used_at",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 335,
                                                                                            "end_token": 337,
                                                                                            "label": "api_key.lastUsedAt",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 335,
                                                                                                    "end_token": 335,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 337,
                                                                                                    "end_token": 337,
                                                                                                    "label": "lastUsedAt",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 340,
                                                                                    "end_token": 345,
                                                                                    "label": "revoked_at=api_key.revokedAt,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 340,
                                                                                            "end_token": 340,
                                                                                            "label": "revoked_at",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 342,
                                                                                            "end_token": 344,
                                                                                            "label": "api_key.revokedAt",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 342,
                                                                                                    "end_token": 342,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 344,
                                                                                                    "end_token": 344,
                                                                                                    "label": "revokedAt",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 347,
                                                                                    "end_token": 352,
                                                                                    "label": "description=api_key.description,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 347,
                                                                                            "end_token": 347,
                                                                                            "label": "description",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 349,
                                                                                            "end_token": 351,
                                                                                            "label": "api_key.description",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 349,
                                                                                                    "end_token": 349,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 351,
                                                                                                    "end_token": 351,
                                                                                                    "label": "description",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 354,
                                                                                    "end_token": 359,
                                                                                    "label": "user_id=api_key.userId,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 354,
                                                                                            "end_token": 354,
                                                                                            "label": "user_id",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 356,
                                                                                            "end_token": 358,
                                                                                            "label": "api_key.userId",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 356,
                                                                                                    "end_token": 356,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 358,
                                                                                                    "end_token": 358,
                                                                                                    "label": "userId",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "except_clause",
                                                    "start_token": 363,
                                                    "end_token": 382,
                                                    "label": "except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 364,
                                                            "end_token": 364,
                                                            "label": "Exception",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "as_pattern",
                                                            "start_token": 365,
                                                            "end_token": 366,
                                                            "label": "as e",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 366,
                                                                    "end_token": 366,
                                                                    "label": "e",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 368,
                                                            "end_token": 382,
                                                            "label": "\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "start_token": 369,
                                                                    "end_token": 375,
                                                                    "label": "logger.error(f\"Error creating APIKey from db: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 369,
                                                                            "end_token": 375,
                                                                            "label": "logger.error(f\"Error creating APIKey from db: {str(e)}\")",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 369,
                                                                                    "end_token": 371,
                                                                                    "label": "logger.error",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 369,
                                                                                            "end_token": 369,
                                                                                            "label": "logger",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 371,
                                                                                            "end_token": 371,
                                                                                            "label": "error",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 372,
                                                                                    "end_token": 374,
                                                                                    "label": "(f\"Error creating APIKey from db: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "start_token": 373,
                                                                                            "end_token": 374,
                                                                                            "label": "f\"Error creating APIKey from db: {str(e)}\"",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "start_token": 373,
                                                                                                    "end_token": 374,
                                                                                                    "label": "f\"Error creating APIKey from db: {str(e)}\"",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 373,
                                                                                                            "end_token": 374,
                                                                                                            "label": "f\"Error creating APIKey from db: {str(e)}\"",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 373,
                                                                                                                    "end_token": 373,
                                                                                                                    "label": "f",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 373,
                                                                                                                    "end_token": 374,
                                                                                                                    "label": "f\"Error creating APIKey from db: {str(e)}\"",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 374,
                                                                                                                            "end_token": 374,
                                                                                                                            "label": "\"Error creating APIKey from db: {str(e)}\"",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 377,
                                                                    "end_token": 382,
                                                                    "label": "raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 378,
                                                                            "end_token": 381,
                                                                            "label": "APIKeyError(f\"Failed to create API key object: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 378,
                                                                                    "end_token": 378,
                                                                                    "label": "APIKeyError",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 379,
                                                                                    "end_token": 381,
                                                                                    "label": "(f\"Failed to create API key object: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "start_token": 380,
                                                                                            "end_token": 381,
                                                                                            "label": "f\"Failed to create API key object: {str(e)}\"",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "start_token": 380,
                                                                                                    "end_token": 381,
                                                                                                    "label": "f\"Failed to create API key object: {str(e)}\"",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 380,
                                                                                                            "end_token": 381,
                                                                                                            "label": "f\"Failed to create API key object: {str(e)}\"",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 380,
                                                                                                                    "end_token": 380,
                                                                                                                    "label": "f",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 380,
                                                                                                                    "end_token": 381,
                                                                                                                    "label": "f\"Failed to create API key object: {str(e)}\"",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 381,
                                                                                                                            "end_token": 381,
                                                                                                                            "label": "\"Failed to create API key object: {str(e)}\"",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "from_db",
                            "start_line": 62,
                            "end_line": 80
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "APIKeyWithoutHash",
            "start_line": 83,
            "end_line": 114,
            "start_token": 386,
            "end_token": 580,
            "label": "class APIKeyWithoutHash(BaseModel):\n    id: str\n    name: str\n    prefix: str\n    postfix: str\n    status: APIKeyStatus\n    permissions: List[APIKeyPermission]\n    created_at: datetime\n    last_used_at: Optional[datetime]\n    revoked_at: Optional[datetime]\n    description: Optional[str]\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")\n",
            "children": [
                {
                    "type": "module",
                    "start_token": 386,
                    "end_token": 452,
                    "label": "class APIKeyWithoutHash(BaseModel):\n    id: str\n    name: str\n    prefix: str\n    postfix: str\n    status: APIKeyStatus\n    permissions: List[APIKeyPermission]\n    created_at: datetime\n    last_used_at: Optional[datetime]\n    revoked_at: Optional[datetime]\n    description: Optional[str]\n    user_id: str\n\n    @staticmethod\n",
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 386,
                            "end_token": 449,
                            "label": "class APIKeyWithoutHash(BaseModel):\n    id: str\n    name: str\n    prefix: str\n    postfix: str\n    status: APIKeyStatus\n    permissions: List[APIKeyPermission]\n    created_at: datetime\n    last_used_at: Optional[datetime]\n    revoked_at: Optional[datetime]\n    description: Optional[str]\n    user_id: str\n\n",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 387,
                                    "end_token": 387,
                                    "label": "APIKeyWithoutHash",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 388,
                                    "end_token": 390,
                                    "label": "(BaseModel)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 389,
                                            "end_token": 389,
                                            "label": "BaseModel",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": 392,
                                    "end_token": 449,
                                    "label": "\n    id: str\n    name: str\n    prefix: str\n    postfix: str\n    status: APIKeyStatus\n    permissions: List[APIKeyPermission]\n    created_at: datetime\n    last_used_at: Optional[datetime]\n    revoked_at: Optional[datetime]\n    description: Optional[str]\n    user_id: str\n\n",
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 393,
                                            "end_token": 395,
                                            "label": "id: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 393,
                                                    "end_token": 393,
                                                    "label": "id",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 395,
                                                    "end_token": 395,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 397,
                                            "end_token": 399,
                                            "label": "name: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 397,
                                                    "end_token": 397,
                                                    "label": "name",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 399,
                                                    "end_token": 399,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 401,
                                            "end_token": 403,
                                            "label": "prefix: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 401,
                                                    "end_token": 401,
                                                    "label": "prefix",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 403,
                                                    "end_token": 403,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 405,
                                            "end_token": 407,
                                            "label": "postfix: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 405,
                                                    "end_token": 405,
                                                    "label": "postfix",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 407,
                                                    "end_token": 407,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 409,
                                            "end_token": 411,
                                            "label": "status: APIKeyStatus",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 409,
                                                    "end_token": 409,
                                                    "label": "status",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 411,
                                                    "end_token": 411,
                                                    "label": "APIKeyStatus",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 413,
                                            "end_token": 418,
                                            "label": "permissions: List[APIKeyPermission]",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 413,
                                                    "end_token": 413,
                                                    "label": "permissions",
                                                    "children": []
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 415,
                                                    "end_token": 418,
                                                    "label": "List[APIKeyPermission]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 415,
                                                            "end_token": 415,
                                                            "label": "List",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 417,
                                                            "end_token": 417,
                                                            "label": "APIKeyPermission",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 420,
                                            "end_token": 422,
                                            "label": "created_at: datetime",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 420,
                                                    "end_token": 420,
                                                    "label": "created_at",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 422,
                                                    "end_token": 422,
                                                    "label": "datetime",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 424,
                                            "end_token": 429,
                                            "label": "last_used_at: Optional[datetime]",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 424,
                                                    "end_token": 424,
                                                    "label": "last_used_at",
                                                    "children": []
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 426,
                                                    "end_token": 429,
                                                    "label": "Optional[datetime]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 426,
                                                            "end_token": 426,
                                                            "label": "Optional",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 428,
                                                            "end_token": 428,
                                                            "label": "datetime",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 431,
                                            "end_token": 436,
                                            "label": "revoked_at: Optional[datetime]",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 431,
                                                    "end_token": 431,
                                                    "label": "revoked_at",
                                                    "children": []
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 433,
                                                    "end_token": 436,
                                                    "label": "Optional[datetime]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 433,
                                                            "end_token": 433,
                                                            "label": "Optional",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 435,
                                                            "end_token": 435,
                                                            "label": "datetime",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 438,
                                            "end_token": 443,
                                            "label": "description: Optional[str]",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 438,
                                                    "end_token": 438,
                                                    "label": "description",
                                                    "children": []
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 440,
                                                    "end_token": 443,
                                                    "label": "Optional[str]",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 440,
                                                            "end_token": 440,
                                                            "label": "Optional",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 442,
                                                            "end_token": 442,
                                                            "label": "str",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 445,
                                            "end_token": 447,
                                            "label": "user_id: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 445,
                                                    "end_token": 445,
                                                    "label": "user_id",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 447,
                                                    "end_token": 447,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorator",
                            "start_token": 450,
                            "end_token": 451,
                            "label": "@staticmethod",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 451,
                                    "end_token": 451,
                                    "label": "staticmethod",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "start_token": 453,
                            "end_token": 580,
                            "label": "def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")\n",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 454,
                                    "end_token": 454,
                                    "label": "from_db",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 455,
                                    "end_token": 459,
                                    "label": "(api_key: PrismaAPIKey)",
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 456,
                                            "end_token": 458,
                                            "label": "api_key: PrismaAPIKey",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 456,
                                                    "end_token": 456,
                                                    "label": "api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 458,
                                                    "end_token": 458,
                                                    "label": "PrismaAPIKey",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": 461,
                                    "end_token": 579,
                                    "label": "\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "try_statement",
                                            "start_token": 462,
                                            "end_token": 579,
                                            "label": "try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 464,
                                                    "end_token": 558,
                                                    "label": "\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 465,
                                                            "end_token": 558,
                                                            "label": "return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 466,
                                                                    "end_token": 558,
                                                                    "label": "APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 466,
                                                                            "end_token": 466,
                                                                            "label": "APIKeyWithoutHash",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 467,
                                                                            "end_token": 558,
                                                                            "label": "(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 469,
                                                                                    "end_token": 474,
                                                                                    "label": "id=api_key.id,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 469,
                                                                                            "end_token": 469,
                                                                                            "label": "id",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 471,
                                                                                            "end_token": 473,
                                                                                            "label": "api_key.id",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 471,
                                                                                                    "end_token": 471,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 473,
                                                                                                    "end_token": 473,
                                                                                                    "label": "id",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 476,
                                                                                    "end_token": 481,
                                                                                    "label": "name=api_key.name,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 476,
                                                                                            "end_token": 476,
                                                                                            "label": "name",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 478,
                                                                                            "end_token": 480,
                                                                                            "label": "api_key.name",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 478,
                                                                                                    "end_token": 478,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 480,
                                                                                                    "end_token": 480,
                                                                                                    "label": "name",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 483,
                                                                                    "end_token": 488,
                                                                                    "label": "prefix=api_key.prefix,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 483,
                                                                                            "end_token": 483,
                                                                                            "label": "prefix",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 485,
                                                                                            "end_token": 487,
                                                                                            "label": "api_key.prefix",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 485,
                                                                                                    "end_token": 485,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 487,
                                                                                                    "end_token": 487,
                                                                                                    "label": "prefix",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 490,
                                                                                    "end_token": 495,
                                                                                    "label": "postfix=api_key.postfix,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 490,
                                                                                            "end_token": 490,
                                                                                            "label": "postfix",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 492,
                                                                                            "end_token": 494,
                                                                                            "label": "api_key.postfix",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 492,
                                                                                                    "end_token": 492,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 494,
                                                                                                    "end_token": 494,
                                                                                                    "label": "postfix",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 497,
                                                                                    "end_token": 505,
                                                                                    "label": "status=APIKeyStatus(api_key.status),",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 497,
                                                                                            "end_token": 497,
                                                                                            "label": "status",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 499,
                                                                                            "end_token": 504,
                                                                                            "label": "APIKeyStatus(api_key.status)",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 499,
                                                                                                    "end_token": 499,
                                                                                                    "label": "APIKeyStatus",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 500,
                                                                                                    "end_token": 504,
                                                                                                    "label": "(api_key.status)",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 501,
                                                                                                            "end_token": 503,
                                                                                                            "label": "api_key.status",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 501,
                                                                                                                    "end_token": 501,
                                                                                                                    "label": "api_key",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 503,
                                                                                                                    "end_token": 503,
                                                                                                                    "label": "status",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 507,
                                                                                    "end_token": 520,
                                                                                    "label": "permissions=[APIKeyPermission(p) for p in api_key.permissions]",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 507,
                                                                                            "end_token": 507,
                                                                                            "label": "permissions",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "list_comprehension",
                                                                                            "start_token": 509,
                                                                                            "end_token": 520,
                                                                                            "label": "[APIKeyPermission(p) for p in api_key.permissions]",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 510,
                                                                                                    "end_token": 513,
                                                                                                    "label": "APIKeyPermission(p)",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 510,
                                                                                                            "end_token": 510,
                                                                                                            "label": "APIKeyPermission",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 511,
                                                                                                            "end_token": 513,
                                                                                                            "label": "(p)",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 512,
                                                                                                                    "end_token": 512,
                                                                                                                    "label": "p",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "for_in_clause",
                                                                                                    "start_token": 514,
                                                                                                    "end_token": 519,
                                                                                                    "label": "for p in api_key.permissions",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 515,
                                                                                                            "end_token": 515,
                                                                                                            "label": "p",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 517,
                                                                                                            "end_token": 519,
                                                                                                            "label": "api_key.permissions",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 517,
                                                                                                                    "end_token": 517,
                                                                                                                    "label": "api_key",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 519,
                                                                                                                    "end_token": 519,
                                                                                                                    "label": "permissions",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 523,
                                                                                    "end_token": 528,
                                                                                    "label": "created_at=api_key.createdAt,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 523,
                                                                                            "end_token": 523,
                                                                                            "label": "created_at",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 525,
                                                                                            "end_token": 527,
                                                                                            "label": "api_key.createdAt",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 525,
                                                                                                    "end_token": 525,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 527,
                                                                                                    "end_token": 527,
                                                                                                    "label": "createdAt",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 530,
                                                                                    "end_token": 535,
                                                                                    "label": "last_used_at=api_key.lastUsedAt,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 530,
                                                                                            "end_token": 530,
                                                                                            "label": "last_used_at",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 532,
                                                                                            "end_token": 534,
                                                                                            "label": "api_key.lastUsedAt",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 532,
                                                                                                    "end_token": 532,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 534,
                                                                                                    "end_token": 534,
                                                                                                    "label": "lastUsedAt",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 537,
                                                                                    "end_token": 542,
                                                                                    "label": "revoked_at=api_key.revokedAt,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 537,
                                                                                            "end_token": 537,
                                                                                            "label": "revoked_at",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 539,
                                                                                            "end_token": 541,
                                                                                            "label": "api_key.revokedAt",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 539,
                                                                                                    "end_token": 539,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 541,
                                                                                                    "end_token": 541,
                                                                                                    "label": "revokedAt",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 544,
                                                                                    "end_token": 549,
                                                                                    "label": "description=api_key.description,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 544,
                                                                                            "end_token": 544,
                                                                                            "label": "description",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 546,
                                                                                            "end_token": 548,
                                                                                            "label": "api_key.description",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 546,
                                                                                                    "end_token": 546,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 548,
                                                                                                    "end_token": 548,
                                                                                                    "label": "description",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 551,
                                                                                    "end_token": 556,
                                                                                    "label": "user_id=api_key.userId,",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 551,
                                                                                            "end_token": 551,
                                                                                            "label": "user_id",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 553,
                                                                                            "end_token": 555,
                                                                                            "label": "api_key.userId",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 553,
                                                                                                    "end_token": 553,
                                                                                                    "label": "api_key",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 555,
                                                                                                    "end_token": 555,
                                                                                                    "label": "userId",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "except_clause",
                                                    "start_token": 560,
                                                    "end_token": 579,
                                                    "label": "except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 561,
                                                            "end_token": 561,
                                                            "label": "Exception",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "as_pattern",
                                                            "start_token": 562,
                                                            "end_token": 563,
                                                            "label": "as e",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 563,
                                                                    "end_token": 563,
                                                                    "label": "e",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 564,
                                                            "end_token": 579,
                                                            "label": ":\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "start_token": 566,
                                                                    "end_token": 572,
                                                                    "label": "logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 566,
                                                                            "end_token": 572,
                                                                            "label": "logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 566,
                                                                                    "end_token": 568,
                                                                                    "label": "logger.error",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 566,
                                                                                            "end_token": 566,
                                                                                            "label": "logger",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 568,
                                                                                            "end_token": 568,
                                                                                            "label": "error",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 569,
                                                                                    "end_token": 572,
                                                                                    "label": "(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "formatted_string",
                                                                                            "start_token": 570,
                                                                                            "end_token": 571,
                                                                                            "label": "f\"Error creating APIKeyWithoutHash from db: {str(e)}\"",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 574,
                                                                    "end_token": 579,
                                                                    "label": "raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 575,
                                                                            "end_token": 579,
                                                                            "label": "APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 575,
                                                                                    "end_token": 575,
                                                                                    "label": "APIKeyError",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 576,
                                                                                    "end_token": 579,
                                                                                    "label": "(f\"Failed to create API key object: {str(e)}\")",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "formatted_string",
                                                                                            "start_token": 577,
                                                                                            "end_token": 578,
                                                                                            "label": "f\"Failed to create API key object: {str(e)}\"",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "from_db",
                            "start_line": 97,
                            "end_line": 114
                        }
                    ]
                }
            ]
        },
        {
            "type": "decorated_definition",
            "start_token": 583,
            "end_token": 787,
            "label": "async def generate_api_key(\n    name: str,\n    user_id: str,\n    permissions: List[APIKeyPermission],\n    description: Optional[str] = None,\n) -> tuple[APIKeyWithoutHash, str]:\n    \"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"\n    try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n    except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n",
            "children": [
                {
                    "type": "decorator",
                    "start_token": 583,
                    "end_token": 583,
                    "label": "async",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 583,
                            "end_token": 583,
                            "label": "async",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "function_definition",
                    "start_token": 584,
                    "end_token": 787,
                    "label": "def generate_api_key(\n    name: str,\n    user_id: str,\n    permissions: List[APIKeyPermission],\n    description: Optional[str] = None,\n) -> tuple[APIKeyWithoutHash, str]:\n    \"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"\n    try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n    except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 585,
                            "end_token": 585,
                            "label": "generate_api_key",
                            "children": []
                        },
                        {
                            "type": "parameters",
                            "start_token": 586,
                            "end_token": 616,
                            "label": "(\n    name: str,\n    user_id: str,\n    permissions: List[APIKeyPermission],\n    description: Optional[str] = None,\n)",
                            "children": [
                                {
                                    "type": "typed_parameter",
                                    "start_token": 588,
                                    "end_token": 591,
                                    "label": "name: str,",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 588,
                                            "end_token": 588,
                                            "label": "name",
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "start_token": 590,
                                            "end_token": 590,
                                            "label": "str",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "typed_parameter",
                                    "start_token": 593,
                                    "end_token": 596,
                                    "label": "user_id: str,",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 593,
                                            "end_token": 593,
                                            "label": "user_id",
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "start_token": 595,
                                            "end_token": 595,
                                            "label": "str",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "typed_parameter",
                                    "start_token": 598,
                                    "end_token": 604,
                                    "label": "permissions: List[APIKeyPermission],",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 598,
                                            "end_token": 598,
                                            "label": "permissions",
                                            "children": []
                                        },
                                        {
                                            "type": "generic_type",
                                            "start_token": 600,
                                            "end_token": 603,
                                            "label": "List[APIKeyPermission]",
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "start_token": 600,
                                                    "end_token": 600,
                                                    "label": "List",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 602,
                                                    "end_token": 602,
                                                    "label": "APIKeyPermission",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "typed_default_parameter",
                                    "start_token": 606,
                                    "end_token": 614,
                                    "label": "description: Optional[str] = None,",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 606,
                                            "end_token": 606,
                                            "label": "description",
                                            "children": []
                                        },
                                        {
                                            "type": "generic_type",
                                            "start_token": 608,
                                            "end_token": 611,
                                            "label": "Optional[str]",
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "start_token": 608,
                                                    "end_token": 608,
                                                    "label": "Optional",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 610,
                                                    "end_token": 610,
                                                    "label": "str",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "none",
                                            "start_token": 613,
                                            "end_token": 613,
                                            "label": "None",
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "union_type",
                            "start_token": 617,
                            "end_token": 624,
                            "label": "-> tuple[APIKeyWithoutHash, str]",
                            "children": [
                                {
                                    "type": "type",
                                    "start_token": 619,
                                    "end_token": 619,
                                    "label": "tuple",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 621,
                                    "end_token": 621,
                                    "label": "APIKeyWithoutHash",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 623,
                                    "end_token": 623,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "string",
                            "start_token": 627,
                            "end_token": 629,
                            "label": "\"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"",
                            "children": []
                        },
                        {
                            "type": "block",
                            "start_token": 630,
                            "end_token": 786,
                            "label": "\n    try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n    except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                            "children": [
                                {
                                    "type": "try_statement",
                                    "start_token": 631,
                                    "end_token": 745,
                                    "label": "try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n",
                                    "children": [
                                        {
                                            "type": "block",
                                            "start_token": 633,
                                            "end_token": 745,
                                            "label": "\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n",
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 634,
                                                    "end_token": 638,
                                                    "label": "api_manager = APIKeyManager()",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 634,
                                                            "end_token": 634,
                                                            "label": "api_manager",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 636,
                                                            "end_token": 638,
                                                            "label": "APIKeyManager()",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 636,
                                                                    "end_token": 636,
                                                                    "label": "APIKeyManager",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 640,
                                                    "end_token": 646,
                                                    "label": "key = api_manager.generate_api_key()",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 640,
                                                            "end_token": 640,
                                                            "label": "key",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 642,
                                                            "end_token": 646,
                                                            "label": "api_manager.generate_api_key()",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 642,
                                                                    "end_token": 644,
                                                                    "label": "api_manager.generate_api_key",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 642,
                                                                            "end_token": 642,
                                                                            "label": "api_manager",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 644,
                                                                            "end_token": 644,
                                                                            "label": "generate_api_key",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 649,
                                                    "end_token": 727,
                                                    "label": "api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 649,
                                                            "end_token": 649,
                                                            "label": "api_key",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 651,
                                                            "end_token": 727,
                                                            "label": "await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 652,
                                                                    "end_token": 727,
                                                                    "label": "PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 652,
                                                                            "end_token": 654,
                                                                            "label": "PrismaAPIKey.prisma",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 652,
                                                                                    "end_token": 653,
                                                                                    "label": "PrismaAPIKey.",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 652,
                                                                                            "end_token": 652,
                                                                                            "label": "PrismaAPIKey",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 653,
                                                                                            "end_token": 653,
                                                                                            "label": ".",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 654,
                                                                                    "end_token": 654,
                                                                                    "label": "prisma",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 655,
                                                                            "end_token": 727,
                                                                            "label": "().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 658,
                                                                                    "end_token": 658,
                                                                                    "label": "create",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 659,
                                                                                    "end_token": 726,
                                                                                    "label": "(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 661,
                                                                                            "end_token": 723,
                                                                                            "label": "data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 661,
                                                                                                    "end_token": 661,
                                                                                                    "label": "data",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 663,
                                                                                                    "end_token": 725,
                                                                                                    "label": "APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "type",
                                                                                                            "start_token": 663,
                                                                                                            "end_token": 663,
                                                                                                            "label": "APIKeyCreateInput",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 664,
                                                                                                            "end_token": 724,
                                                                                                            "label": "(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 666,
                                                                                                                    "end_token": 675,
                                                                                                                    "label": "id=str(uuid.uuid4())",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 666,
                                                                                                                            "end_token": 666,
                                                                                                                            "label": "id",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "start_token": 668,
                                                                                                                            "end_token": 675,
                                                                                                                            "label": "str(uuid.uuid4())",
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "type",
                                                                                                                                    "start_token": 668,
                                                                                                                                    "end_token": 668,
                                                                                                                                    "label": "str",
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "start_token": 670,
                                                                                                                                    "end_token": 672,
                                                                                                                                    "label": "uuid.uuid4",
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "start_token": 670,
                                                                                                                                            "end_token": 670,
                                                                                                                                            "label": "uuid",
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "start_token": 672,
                                                                                                                                            "end_token": 672,
                                                                                                                                            "label": "uuid4",
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 678,
                                                                                                                    "end_token": 681,
                                                                                                                    "label": "name=name,",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 678,
                                                                                                                            "end_token": 678,
                                                                                                                            "label": "name",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 680,
                                                                                                                            "end_token": 680,
                                                                                                                            "label": "name",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 683,
                                                                                                                    "end_token": 688,
                                                                                                                    "label": "prefix=key.prefix,",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 683,
                                                                                                                            "end_token": 683,
                                                                                                                            "label": "prefix",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 685,
                                                                                                                            "end_token": 687,
                                                                                                                            "label": "key.prefix",
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 685,
                                                                                                                                    "end_token": 685,
                                                                                                                                    "label": "key",
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 687,
                                                                                                                                    "end_token": 687,
                                                                                                                                    "label": "prefix",
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 690,
                                                                                                                    "end_token": 695,
                                                                                                                    "label": "postfix=key.postfix,",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 690,
                                                                                                                            "end_token": 690,
                                                                                                                            "label": "postfix",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 692,
                                                                                                                            "end_token": 694,
                                                                                                                            "label": "key.postfix",
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 692,
                                                                                                                                    "end_token": 692,
                                                                                                                                    "label": "key",
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 694,
                                                                                                                                    "end_token": 694,
                                                                                                                                    "label": "postfix",
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 697,
                                                                                                                    "end_token": 702,
                                                                                                                    "label": "key=key.hash,",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 697,
                                                                                                                            "end_token": 697,
                                                                                                                            "label": "key",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 699,
                                                                                                                            "end_token": 701,
                                                                                                                            "label": "key.hash",
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 699,
                                                                                                                                    "end_token": 699,
                                                                                                                                    "label": "key",
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 701,
                                                                                                                                    "end_token": 701,
                                                                                                                                    "label": "hash",
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 704,
                                                                                                                    "end_token": 713,
                                                                                                                    "label": "permissions=[p for p in permissions],",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 704,
                                                                                                                            "end_token": 704,
                                                                                                                            "label": "permissions",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "list_comprehension",
                                                                                                                            "start_token": 706,
                                                                                                                            "end_token": 711,
                                                                                                                            "label": "[p for p in permissions",
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 707,
                                                                                                                                    "end_token": 707,
                                                                                                                                    "label": "p",
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "for_in_clause",
                                                                                                                                    "start_token": 708,
                                                                                                                                    "end_token": 711,
                                                                                                                                    "label": "for p in permissions",
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "start_token": 709,
                                                                                                                                            "end_token": 709,
                                                                                                                                            "label": "p",
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "start_token": 711,
                                                                                                                                            "end_token": 711,
                                                                                                                                            "label": "permissions",
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 715,
                                                                                                                    "end_token": 718,
                                                                                                                    "label": "description=description,",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 715,
                                                                                                                            "end_token": 715,
                                                                                                                            "label": "description",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 717,
                                                                                                                            "end_token": 717,
                                                                                                                            "label": "description",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "start_token": 720,
                                                                                                                    "end_token": 723,
                                                                                                                    "label": "userId=user_id,",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 720,
                                                                                                                            "end_token": 720,
                                                                                                                            "label": "userId",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 722,
                                                                                                                            "end_token": 722,
                                                                                                                            "label": "user_id",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 730,
                                                    "end_token": 737,
                                                    "label": "api_key_without_hash = APIKeyWithoutHash.from_db(api_key)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 730,
                                                            "end_token": 730,
                                                            "label": "api_key_without_hash",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 732,
                                                            "end_token": 737,
                                                            "label": "APIKeyWithoutHash.from_db(api_key)",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 732,
                                                                    "end_token": 734,
                                                                    "label": "APIKeyWithoutHash.from_db",
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 732,
                                                                            "end_token": 732,
                                                                            "label": "APIKeyWithoutHash",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 734,
                                                                            "end_token": 734,
                                                                            "label": "from_db",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 736,
                                                                    "end_token": 736,
                                                                    "label": "api_key",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 739,
                                                    "end_token": 745,
                                                    "label": "return api_key_without_hash, key.raw\n",
                                                    "children": [
                                                        {
                                                            "type": "expression_list",
                                                            "start_token": 740,
                                                            "end_token": 744,
                                                            "label": "api_key_without_hash, key.raw",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 740,
                                                                    "end_token": 740,
                                                                    "label": "api_key_without_hash",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 742,
                                                                    "end_token": 744,
                                                                    "label": "key.raw",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 742,
                                                                            "end_token": 742,
                                                                            "label": "key",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 744,
                                                                            "end_token": 744,
                                                                            "label": "raw",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "except_clause",
                                            "start_token": 746,
                                            "end_token": 765,
                                            "label": "except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "as_pattern",
                                                    "start_token": 747,
                                                    "end_token": 749,
                                                    "label": "PrismaError as e",
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 747,
                                                            "end_token": 747,
                                                            "label": "PrismaError",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 749,
                                                            "end_token": 749,
                                                            "label": "e",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 750,
                                                    "end_token": 765,
                                                    "label": ":\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 752,
                                                            "end_token": 758,
                                                            "label": "logger.error(f\"Database error while generating API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 752,
                                                                    "end_token": 758,
                                                                    "label": "logger.error(f\"Database error while generating API key: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 752,
                                                                            "end_token": 754,
                                                                            "label": "logger.error",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 752,
                                                                                    "end_token": 752,
                                                                                    "label": "logger",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 754,
                                                                                    "end_token": 754,
                                                                                    "label": "error",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 756,
                                                                            "end_token": 757,
                                                                            "label": "f\"Database error while generating API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 756,
                                                                                    "end_token": 756,
                                                                                    "label": "f",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 757,
                                                                                    "end_token": 757,
                                                                                    "label": "\"Database error while generating API key: {str(e)}\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 760,
                                                            "end_token": 765,
                                                            "label": "raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 761,
                                                                    "end_token": 765,
                                                                    "label": "APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 761,
                                                                            "end_token": 761,
                                                                            "label": "APIKeyError",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 763,
                                                                            "end_token": 764,
                                                                            "label": "f\"Failed to generate API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 763,
                                                                                    "end_token": 763,
                                                                                    "label": "f",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 764,
                                                                                    "end_token": 764,
                                                                                    "label": "\"Failed to generate API key: {str(e)}\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "except_clause",
                                            "start_token": 767,
                                            "end_token": 786,
                                            "label": "except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "as_pattern",
                                                    "start_token": 768,
                                                    "end_token": 770,
                                                    "label": "Exception as e",
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 768,
                                                            "end_token": 768,
                                                            "label": "Exception",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 770,
                                                            "end_token": 770,
                                                            "label": "e",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 771,
                                                    "end_token": 786,
                                                    "label": ":\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 773,
                                                            "end_token": 779,
                                                            "label": "logger.error(f\"Unexpected error while generating API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 773,
                                                                    "end_token": 779,
                                                                    "label": "logger.error(f\"Unexpected error while generating API key: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 773,
                                                                            "end_token": 775,
                                                                            "label": "logger.error",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 773,
                                                                                    "end_token": 773,
                                                                                    "label": "logger",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 775,
                                                                                    "end_token": 775,
                                                                                    "label": "error",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 777,
                                                                            "end_token": 778,
                                                                            "label": "f\"Unexpected error while generating API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 777,
                                                                                    "end_token": 777,
                                                                                    "label": "f",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 778,
                                                                                    "end_token": 778,
                                                                                    "label": "\"Unexpected error while generating API key: {str(e)}\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 781,
                                                            "end_token": 786,
                                                            "label": "raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 782,
                                                                    "end_token": 786,
                                                                    "label": "APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 782,
                                                                            "end_token": 782,
                                                                            "label": "APIKeyError",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 784,
                                                                            "end_token": 785,
                                                                            "label": "f\"Failed to generate API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 784,
                                                                                    "end_token": 784,
                                                                                    "label": "f",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 785,
                                                                                    "end_token": 785,
                                                                                    "label": "\"Failed to generate API key: {str(e)}\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "generate_api_key",
            "start_line": 117,
            "end_line": 151
        },
        {
            "type": "function_definition",
            "start_token": 790,
            "end_token": 959,
            "label": "async def validate_api_key(plain_text_key: str) -> Optional[APIKey]:\n    \"\"\"\n    Validate an API key and return the API key object if valid.\n    \"\"\"\n    try:\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)\n    except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 792,
                    "end_token": 792,
                    "label": "validate_api_key",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": 793,
                    "end_token": 797,
                    "label": "(plain_text_key: str)",
                    "children": [
                        {
                            "type": "typed_parameter",
                            "start_token": 794,
                            "end_token": 796,
                            "label": "plain_text_key: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 794,
                                    "end_token": 794,
                                    "label": "plain_text_key",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 796,
                                    "end_token": 796,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "union_type",
                    "start_token": 799,
                    "end_token": 803,
                    "label": "> Optional[APIKey]",
                    "children": [
                        {
                            "type": "generic_type",
                            "start_token": 800,
                            "end_token": 803,
                            "label": "Optional[APIKey]",
                            "children": [
                                {
                                    "type": "type",
                                    "start_token": 800,
                                    "end_token": 800,
                                    "label": "Optional",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 802,
                                    "end_token": 802,
                                    "label": "APIKey",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "string",
                    "start_token": 806,
                    "end_token": 808,
                    "label": "\"\"\"\n    Validate an API key and return the API key object if valid.\n    \"\"\"",
                    "children": []
                },
                {
                    "type": "block",
                    "start_token": 810,
                    "end_token": 958,
                    "label": "try:\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)\n    except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                    "children": [
                        {
                            "type": "try_statement",
                            "start_token": 810,
                            "end_token": 958,
                            "label": "try:\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)\n    except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                            "children": [
                                {
                                    "type": "block",
                                    "start_token": 812,
                                    "end_token": 929,
                                    "label": "\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n",
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "start_token": 813,
                                            "end_token": 833,
                                            "label": "if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None",
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 814,
                                                    "end_token": 822,
                                                    "label": "not plain_text_key.startswith(APIKeyManager.PREFIX)",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 815,
                                                            "end_token": 822,
                                                            "label": "plain_text_key.startswith(APIKeyManager.PREFIX)",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 815,
                                                                    "end_token": 817,
                                                                    "label": "plain_text_key.startswith",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 815,
                                                                            "end_token": 815,
                                                                            "label": "plain_text_key",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 818,
                                                                    "end_token": 822,
                                                                    "label": "(APIKeyManager.PREFIX)",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 819,
                                                                            "end_token": 821,
                                                                            "label": "APIKeyManager.PREFIX",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 819,
                                                                                    "end_token": 819,
                                                                                    "label": "APIKeyManager",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 823,
                                                    "end_token": 833,
                                                    "label": ":\n            logger.warning(\"Invalid API key format\")\n            return None",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 825,
                                                            "end_token": 830,
                                                            "label": "logger.warning(\"Invalid API key format\")",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 825,
                                                                    "end_token": 827,
                                                                    "label": "logger.warning",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 825,
                                                                            "end_token": 825,
                                                                            "label": "logger",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 832,
                                                            "end_token": 833,
                                                            "label": "return None",
                                                            "children": [
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 833,
                                                                    "end_token": 833,
                                                                    "label": "None",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 836,
                                            "end_token": 844,
                                            "label": "prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 836,
                                                    "end_token": 836,
                                                    "label": "prefix",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 846,
                                            "end_token": 850,
                                            "label": "api_manager = APIKeyManager()",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 846,
                                                    "end_token": 846,
                                                    "label": "api_manager",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 853,
                                            "end_token": 882,
                                            "label": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 853,
                                                    "end_token": 853,
                                                    "label": "api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 855,
                                                    "end_token": 882,
                                                    "label": "await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 856,
                                                            "end_token": 882,
                                                            "label": "PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 856,
                                                                    "end_token": 862,
                                                                    "label": "PrismaAPIKey.prisma().find_first",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 856,
                                                                            "end_token": 856,
                                                                            "label": "PrismaAPIKey",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 863,
                                                                    "end_token": 882,
                                                                    "label": "(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 867,
                                                                            "end_token": 880,
                                                                            "label": "APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 867,
                                                                                    "end_token": 867,
                                                                                    "label": "APIKeyWhereInput",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 885,
                                            "end_token": 899,
                                            "label": "if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None",
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 886,
                                                    "end_token": 887,
                                                    "label": "not api_key",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 887,
                                                            "end_token": 887,
                                                            "label": "api_key",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 888,
                                                    "end_token": 899,
                                                    "label": ":\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 890,
                                                            "end_token": 896,
                                                            "label": "logger.warning(f\"No active API key found with prefix {prefix}\")",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 890,
                                                                    "end_token": 892,
                                                                    "label": "logger.warning",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 890,
                                                                            "end_token": 890,
                                                                            "label": "logger",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 898,
                                                            "end_token": 899,
                                                            "label": "return None",
                                                            "children": [
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 899,
                                                                    "end_token": 899,
                                                                    "label": "None",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 902,
                                            "end_token": 913,
                                            "label": "is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 902,
                                                    "end_token": 902,
                                                    "label": "is_valid",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 915,
                                            "end_token": 928,
                                            "label": "if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None",
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 916,
                                                    "end_token": 917,
                                                    "label": "not is_valid",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 917,
                                                            "end_token": 917,
                                                            "label": "is_valid",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 918,
                                                    "end_token": 928,
                                                    "label": ":\n            logger.warning(\"API key verification failed\")\n            return None",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 920,
                                                            "end_token": 924,
                                                            "label": "logger.warning(\"API key verification failed\"",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 920,
                                                                    "end_token": 922,
                                                                    "label": "logger.warning",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 920,
                                                                            "end_token": 920,
                                                                            "label": "logger",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 927,
                                                            "end_token": 928,
                                                            "label": "return None",
                                                            "children": [
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 928,
                                                                    "end_token": 928,
                                                                    "label": "None",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 931,
                                            "end_token": 937,
                                            "label": "return APIKey.from_db(api_key)",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 932,
                                                    "end_token": 937,
                                                    "label": "APIKey.from_db(api_key)",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 932,
                                                            "end_token": 934,
                                                            "label": "APIKey.from_db",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 932,
                                                                    "end_token": 932,
                                                                    "label": "APIKey",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 939,
                                    "end_token": 958,
                                    "label": "except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "block",
                                            "start_token": 944,
                                            "end_token": 958,
                                            "label": "\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 945,
                                                    "end_token": 951,
                                                    "label": "logger.error(f\"Error validating API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 945,
                                                            "end_token": 947,
                                                            "label": "logger.error",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 945,
                                                                    "end_token": 945,
                                                                    "label": "logger",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 953,
                                                    "end_token": 958,
                                                    "label": "raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 954,
                                                            "end_token": 958,
                                                            "label": "APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 954,
                                                                    "end_token": 954,
                                                                    "label": "APIKeyValidationError",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "validate_api_key",
            "start_line": 154,
            "end_line": 182
        },
        {
            "type": "function_definition",
            "start_token": 962,
            "end_token": 1161,
            "label": "async def revoke_api_key(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 963,
                    "end_token": 963,
                    "label": "def",
                    "children": []
                },
                {
                    "type": "identifier",
                    "start_token": 964,
                    "end_token": 964,
                    "label": "revoke_api_key",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": 965,
                    "end_token": 973,
                    "label": "(key_id: str, user_id: str)",
                    "children": [
                        {
                            "type": "typed_parameter",
                            "start_token": 966,
                            "end_token": 968,
                            "label": "key_id: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 966,
                                    "end_token": 966,
                                    "label": "key_id",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "start_token": 970,
                            "end_token": 972,
                            "label": "user_id: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 970,
                                    "end_token": 970,
                                    "label": "user_id",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "union_type",
                    "start_token": 975,
                    "end_token": 979,
                    "label": "> Optional[APIKeyWithoutHash]",
                    "children": [
                        {
                            "type": "generic_type",
                            "start_token": 976,
                            "end_token": 979,
                            "label": "Optional[APIKeyWithoutHash]",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": 981,
                    "end_token": 1105,
                    "label": "\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None",
                    "children": [
                        {
                            "type": "try_statement",
                            "start_token": 982,
                            "end_token": 1105,
                            "label": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None",
                            "children": [
                                {
                                    "type": "block",
                                    "start_token": 985,
                                    "end_token": 1103,
                                    "label": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 985,
                                            "end_token": 1003,
                                            "label": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                            "children": [
                                                {
                                                    "type": "await",
                                                    "start_token": 987,
                                                    "end_token": 1003,
                                                    "label": "await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 988,
                                                            "end_token": 1003,
                                                            "label": "PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 988,
                                                                    "end_token": 994,
                                                                    "label": "PrismaAPIKey.prisma().find_unique",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 988,
                                                                            "end_token": 993,
                                                                            "label": "PrismaAPIKey.prisma().",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 995,
                                                                    "end_token": 1003,
                                                                    "label": "(where={\"id\": key_id})",
                                                                    "children": [
                                                                        {
                                                                            "type": "dictionary",
                                                                            "start_token": 998,
                                                                            "end_token": 1002,
                                                                            "label": "{\"id\": key_id}",
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 999,
                                                                                    "end_token": 1001,
                                                                                    "label": "\"id\": key_id",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 999,
                                                                                            "end_token": 999,
                                                                                            "label": "\"id\"",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1001,
                                                                                            "end_token": 1001,
                                                                                            "label": "key_id",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 1006,
                                            "end_token": 1016,
                                            "label": "if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 1007,
                                                    "end_token": 1008,
                                                    "label": "not api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1008,
                                                    "end_token": 1008,
                                                    "label": "api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1011,
                                                    "end_token": 1016,
                                                    "label": "raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1012,
                                                            "end_token": 1016,
                                                            "label": "APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 1015,
                                                                    "end_token": 1015,
                                                                    "label": "\"API key with id {key_id} not found\"",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 1019,
                                            "end_token": 1034,
                                            "label": "if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )",
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 1021,
                                                    "end_token": 1025,
                                                    "label": ".userId != user_id",
                                                    "children": []
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1028,
                                                    "end_token": 1034,
                                                    "label": "raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1029,
                                                            "end_token": 1034,
                                                            "label": "APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )",
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 1032,
                                                                    "end_token": 1032,
                                                                    "label": "\"You do not have permission to revoke this API key.\"",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 1037,
                                            "end_token": 1045,
                                            "label": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 1039,
                                                    "end_token": 1039,
                                                    "label": "APIKeyWhereUniqueInput",
                                                    "children": []
                                                },
                                                {
                                                    "type": "dictionary",
                                                    "start_token": 1041,
                                                    "end_token": 1044,
                                                    "label": "{\"id\": key_id",
                                                    "children": [
                                                        {
                                                            "type": "pair",
                                                            "start_token": 1042,
                                                            "end_token": 1044,
                                                            "label": "\"id\": key_id",
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 1042,
                                                                    "end_token": 1042,
                                                                    "label": "\"id\"",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1044,
                                                                    "end_token": 1044,
                                                                    "label": "key_id",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 1047,
                                            "end_token": 1089,
                                            "label": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                                            "children": [
                                                {
                                                    "type": "await",
                                                    "start_token": 1049,
                                                    "end_token": 1089,
                                                    "label": "await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1050,
                                                            "end_token": 1089,
                                                            "label": "PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 1050,
                                                                    "end_token": 1056,
                                                                    "label": "PrismaAPIKey.prisma().update",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1050,
                                                                            "end_token": 1055,
                                                                            "label": "PrismaAPIKey.prisma().",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1057,
                                                                    "end_token": 1089,
                                                                    "label": "(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                                                                    "children": [
                                                                        {
                                                                            "type": "dictionary",
                                                                            "start_token": 1060,
                                                                            "end_token": 1061,
                                                                            "label": "=where_clause",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 1066,
                                                                            "end_token": 1086,
                                                                            "label": "APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            )",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 1071,
                                                                                    "end_token": 1073,
                                                                                    "label": "APIKeyStatus.REVOKED",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1071,
                                                                                            "end_token": 1071,
                                                                                            "label": "APIKeyStatus",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1077,
                                                                                    "end_token": 1084,
                                                                                    "label": "datetime.now(timezone.utc)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 1078,
                                                                                            "end_token": 1083,
                                                                                            "label": ".now(timezone.utc",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1107,
                                    "end_token": 1119,
                                    "label": "except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 1113,
                                            "end_token": 1113,
                                            "label": "as",
                                            "children": []
                                        },
                                        {
                                            "type": "raise_statement",
                                            "start_token": 1117,
                                            "end_token": 1119,
                                            "label": "raise e\n",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1118,
                                                    "end_token": 1118,
                                                    "label": "e",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1120,
                                    "end_token": 1140,
                                    "label": "except PrismaError as e:\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n",
                                    "children": [
                                        {
                                            "type": "block",
                                            "start_token": 1124,
                                            "end_token": 1139,
                                            "label": ":\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1126,
                                                    "end_token": 1132,
                                                    "label": "logger.error(f\"Database error while revoking API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1126,
                                                            "end_token": 1128,
                                                            "label": "logger.error",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 1131,
                                                            "end_token": 1131,
                                                            "label": "\"Database error while revoking API key: {str(e)}\"",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1134,
                                                    "end_token": 1139,
                                                    "label": "raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1135,
                                                            "end_token": 1139,
                                                            "label": "APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 1138,
                                                                    "end_token": 1138,
                                                                    "label": "\"Failed to revoke API key: {str(e)}\"",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1141,
                                    "end_token": 1161,
                                    "label": "except Exception as e:\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n",
                                    "children": [
                                        {
                                            "type": "block",
                                            "start_token": 1145,
                                            "end_token": 1160,
                                            "label": ":\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1147,
                                                    "end_token": 1153,
                                                    "label": "logger.error(f\"Unexpected error while revoking API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1147,
                                                            "end_token": 1149,
                                                            "label": "logger.error",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 1152,
                                                            "end_token": 1152,
                                                            "label": "\"Unexpected error while revoking API key: {str(e)}\"",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1155,
                                                    "end_token": 1160,
                                                    "label": "raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1156,
                                                            "end_token": 1160,
                                                            "label": "APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 1159,
                                                                    "end_token": 1159,
                                                                    "label": "\"Failed to revoke API key: {str(e)}\"",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "revoke_api_key",
            "start_line": 185,
            "end_line": 215
        },
        {
            "type": "function_definition",
            "start_token": 1164,
            "end_token": 1276,
            "label": "async def list_user_api_keys(user_id: str) -> List[APIKeyWithoutHash]:\n    try:\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n    except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 1165,
                    "end_token": 1165,
                    "label": "def",
                    "children": []
                },
                {
                    "type": "identifier",
                    "start_token": 1166,
                    "end_token": 1166,
                    "label": "list_user_api_keys",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": 1167,
                    "end_token": 1171,
                    "label": "(user_id: str)",
                    "children": [
                        {
                            "type": "typed_parameter",
                            "start_token": 1168,
                            "end_token": 1170,
                            "label": "user_id: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1168,
                                    "end_token": 1168,
                                    "label": "user_id",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1170,
                                    "end_token": 1170,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "union_type",
                    "start_token": 1173,
                    "end_token": 1177,
                    "label": "> List[APIKeyWithoutHash]",
                    "children": [
                        {
                            "type": "generic_type",
                            "start_token": 1174,
                            "end_token": 1177,
                            "label": "List[APIKeyWithoutHash]",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1174,
                                    "end_token": 1174,
                                    "label": "List",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1176,
                                    "end_token": 1176,
                                    "label": "APIKeyWithoutHash",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": 1179,
                    "end_token": 1275,
                    "label": "\n    try:\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n    except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                    "children": [
                        {
                            "type": "try_statement",
                            "start_token": 1180,
                            "end_token": 1275,
                            "label": "try:\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n    except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                            "children": [
                                {
                                    "type": "block",
                                    "start_token": 1182,
                                    "end_token": 1234,
                                    "label": "\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 1183,
                                            "end_token": 1191,
                                            "label": "where_clause: APIKeyWhereInput = {\"userId\": user_id}",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1183,
                                                    "end_token": 1183,
                                                    "label": "where_clause",
                                                    "children": []
                                                },
                                                {
                                                    "type": "dictionary",
                                                    "start_token": 1187,
                                                    "end_token": 1191,
                                                    "label": "{\"userId\": user_id}",
                                                    "children": [
                                                        {
                                                            "type": "pair",
                                                            "start_token": 1188,
                                                            "end_token": 1190,
                                                            "label": "\"userId\": user_id",
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 1188,
                                                                    "end_token": 1188,
                                                                    "label": "\"userId\"",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1190,
                                                                    "end_token": 1190,
                                                                    "label": "user_id",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 1194,
                                            "end_token": 1218,
                                            "label": "api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1194,
                                                    "end_token": 1194,
                                                    "label": "api_keys",
                                                    "children": []
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 1196,
                                                    "end_token": 1218,
                                                    "label": "await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1196,
                                                            "end_token": 1218,
                                                            "label": "await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 1197,
                                                                    "end_token": 1203,
                                                                    "label": "PrismaAPIKey.prisma().find_many",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1197,
                                                                            "end_token": 1200,
                                                                            "label": "PrismaAPIKey.prisma(",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1197,
                                                                                    "end_token": 1197,
                                                                                    "label": "PrismaAPIKey",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1199,
                                                                                    "end_token": 1199,
                                                                                    "label": "prisma",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1203,
                                                                            "end_token": 1203,
                                                                            "label": "find_many",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1204,
                                                                    "end_token": 1218,
                                                                    "label": "(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 1206,
                                                                            "end_token": 1208,
                                                                            "label": "where=where_clause",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1206,
                                                                                    "end_token": 1206,
                                                                                    "label": "where",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1208,
                                                                                    "end_token": 1208,
                                                                                    "label": "where_clause",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 1210,
                                                                            "end_token": 1216,
                                                                            "label": "order={\"createdAt\": \"desc\"}",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1210,
                                                                                    "end_token": 1210,
                                                                                    "label": "order",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 1212,
                                                                                    "end_token": 1216,
                                                                                    "label": "{\"createdAt\": \"desc\"}",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 1213,
                                                                                            "end_token": 1215,
                                                                                            "label": "\"createdAt\": \"desc\"",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 1213,
                                                                                                    "end_token": 1213,
                                                                                                    "label": "\"createdAt\"",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 1215,
                                                                                                    "end_token": 1215,
                                                                                                    "label": "\"desc\"",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 1221,
                                            "end_token": 1233,
                                            "label": "return [APIKeyWithoutHash.from_db(key) for key in api_keys]",
                                            "children": [
                                                {
                                                    "type": "list_comprehension",
                                                    "start_token": 1222,
                                                    "end_token": 1233,
                                                    "label": "[APIKeyWithoutHash.from_db(key) for key in api_keys]",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1223,
                                                            "end_token": 1228,
                                                            "label": "APIKeyWithoutHash.from_db(key)",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 1223,
                                                                    "end_token": 1225,
                                                                    "label": "APIKeyWithoutHash.from_db",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1223,
                                                                            "end_token": 1223,
                                                                            "label": "APIKeyWithoutHash",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1225,
                                                                            "end_token": 1225,
                                                                            "label": "from_db",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1226,
                                                                    "end_token": 1228,
                                                                    "label": "(key)",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1227,
                                                                            "end_token": 1227,
                                                                            "label": "key",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "for_in_clause",
                                                            "start_token": 1229,
                                                            "end_token": 1232,
                                                            "label": "for key in api_keys",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1230,
                                                                    "end_token": 1230,
                                                                    "label": "key",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1232,
                                                                    "end_token": 1232,
                                                                    "label": "api_keys",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1235,
                                    "end_token": 1255,
                                    "label": "except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n",
                                    "children": [
                                        {
                                            "type": "as_pattern",
                                            "start_token": 1236,
                                            "end_token": 1238,
                                            "label": "PrismaError as e",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1236,
                                                    "end_token": 1236,
                                                    "label": "PrismaError",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1238,
                                                    "end_token": 1238,
                                                    "label": "e",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 1239,
                                            "end_token": 1254,
                                            "label": ":\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1241,
                                                    "end_token": 1247,
                                                    "label": "logger.error(f\"Database error while listing API keys: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1241,
                                                            "end_token": 1243,
                                                            "label": "logger.error",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1241,
                                                                    "end_token": 1241,
                                                                    "label": "logger",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1243,
                                                                    "end_token": 1243,
                                                                    "label": "error",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 1244,
                                                            "end_token": 1247,
                                                            "label": "(f\"Database error while listing API keys: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 1245,
                                                                    "end_token": 1246,
                                                                    "label": "f\"Database error while listing API keys: {str(e)}\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 1245,
                                                                            "end_token": 1245,
                                                                            "label": "f",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 1246,
                                                                            "end_token": 1246,
                                                                            "label": "\"Database error while listing API keys: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1246,
                                                                                    "end_token": 1246,
                                                                                    "label": "\"Database error while listing API keys: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1246,
                                                                                            "end_token": 1246,
                                                                                            "label": "\"Database error while listing API keys: {str(e)}\"",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1246,
                                                                                            "end_token": 1246,
                                                                                            "label": "\"Database error while listing API keys: {str(e)}\"",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1249,
                                                    "end_token": 1254,
                                                    "label": "raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1250,
                                                            "end_token": 1254,
                                                            "label": "APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1250,
                                                                    "end_token": 1250,
                                                                    "label": "APIKeyError",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1251,
                                                                    "end_token": 1254,
                                                                    "label": "(f\"Failed to list API keys: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 1252,
                                                                            "end_token": 1253,
                                                                            "label": "f\"Failed to list API keys: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 1252,
                                                                                    "end_token": 1252,
                                                                                    "label": "f",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 1253,
                                                                                    "end_token": 1253,
                                                                                    "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 1253,
                                                                                            "end_token": 1253,
                                                                                            "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 1253,
                                                                                                    "end_token": 1253,
                                                                                                    "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 1253,
                                                                                                    "end_token": 1253,
                                                                                                    "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1256,
                                    "end_token": 1275,
                                    "label": "except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "as_pattern",
                                            "start_token": 1257,
                                            "end_token": 1259,
                                            "label": "Exception as e",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1257,
                                                    "end_token": 1257,
                                                    "label": "Exception",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1259,
                                                    "end_token": 1259,
                                                    "label": "e",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 1260,
                                            "end_token": 1275,
                                            "label": ":\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1262,
                                                    "end_token": 1268,
                                                    "label": "logger.error(f\"Unexpected error while listing API keys: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1262,
                                                            "end_token": 1264,
                                                            "label": "logger.error",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1262,
                                                                    "end_token": 1262,
                                                                    "label": "logger",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1264,
                                                                    "end_token": 1264,
                                                                    "label": "error",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 1265,
                                                            "end_token": 1268,
                                                            "label": "(f\"Unexpected error while listing API keys: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 1266,
                                                                    "end_token": 1267,
                                                                    "label": "f\"Unexpected error while listing API keys: {str(e)}\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 1266,
                                                                            "end_token": 1266,
                                                                            "label": "f",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 1267,
                                                                            "end_token": 1267,
                                                                            "label": "\"Unexpected error while listing API keys: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1267,
                                                                                    "end_token": 1267,
                                                                                    "label": "\"Unexpected error while listing API keys: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1267,
                                                                                            "end_token": 1267,
                                                                                            "label": "\"Unexpected error while listing API keys: {str(e)}\"",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1267,
                                                                                            "end_token": 1267,
                                                                                            "label": "\"Unexpected error while listing API keys: {str(e)}\"",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1270,
                                                    "end_token": 1275,
                                                    "label": "raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1271,
                                                            "end_token": 1275,
                                                            "label": "APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1271,
                                                                    "end_token": 1271,
                                                                    "label": "APIKeyError",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1272,
                                                                    "end_token": 1275,
                                                                    "label": "(f\"Failed to list API keys: {str(e)}\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 1273,
                                                                            "end_token": 1274,
                                                                            "label": "f\"Failed to list API keys: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 1273,
                                                                                    "end_token": 1273,
                                                                                    "label": "f",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 1274,
                                                                                    "end_token": 1274,
                                                                                    "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 1274,
                                                                                            "end_token": 1274,
                                                                                            "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 1274,
                                                                                                    "end_token": 1274,
                                                                                                    "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 1274,
                                                                                                    "end_token": 1274,
                                                                                                    "label": "\"Failed to list API keys: {str(e)}\"",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "list_user_api_keys",
            "start_line": 218,
            "end_line": 232
        },
        {
            "type": "function_definition",
            "start_token": 1279,
            "end_token": 1465,
            "label": "async def suspend_api_key(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 1279,
                    "end_token": 1279,
                    "label": "async",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": 1282,
                    "end_token": 1290,
                    "label": "(key_id: str, user_id: str)",
                    "children": [
                        {
                            "type": "typed_parameter",
                            "start_token": 1283,
                            "end_token": 1285,
                            "label": "key_id: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1283,
                                    "end_token": 1283,
                                    "label": "key_id",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1285,
                                    "end_token": 1285,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "start_token": 1287,
                            "end_token": 1289,
                            "label": "user_id: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1287,
                                    "end_token": 1287,
                                    "label": "user_id",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1289,
                                    "end_token": 1289,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "return_statement",
                    "start_token": 1291,
                    "end_token": 1296,
                    "label": "-> Optional[APIKeyWithoutHash]",
                    "children": [
                        {
                            "type": "generic_type",
                            "start_token": 1293,
                            "end_token": 1296,
                            "label": "Optional[APIKeyWithoutHash]",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1293,
                                    "end_token": 1293,
                                    "label": "Optional",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1295,
                                    "end_token": 1295,
                                    "label": "APIKeyWithoutHash",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": 1298,
                    "end_token": 1410,
                    "label": "\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n",
                    "children": [
                        {
                            "type": "try_statement",
                            "start_token": 1298,
                            "end_token": 1423,
                            "label": "\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n",
                            "children": [
                                {
                                    "type": "block",
                                    "start_token": 1301,
                                    "end_token": 1408,
                                    "label": "\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 1302,
                                            "end_token": 1320,
                                            "label": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1302,
                                                    "end_token": 1302,
                                                    "label": "api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 1304,
                                                    "end_token": 1320,
                                                    "label": "await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1305,
                                                            "end_token": 1320,
                                                            "label": "PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 1305,
                                                                    "end_token": 1311,
                                                                    "label": "PrismaAPIKey.prisma().find_unique",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1305,
                                                                            "end_token": 1309,
                                                                            "label": "PrismaAPIKey.prisma()",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1305,
                                                                                    "end_token": 1305,
                                                                                    "label": "PrismaAPIKey",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1307,
                                                                                    "end_token": 1309,
                                                                                    "label": "prisma()",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1307,
                                                                                            "end_token": 1307,
                                                                                            "label": "prisma",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1311,
                                                                            "end_token": 1311,
                                                                            "label": "find_unique",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1312,
                                                                    "end_token": 1320,
                                                                    "label": "(where={\"id\": key_id})",
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 1313,
                                                                            "end_token": 1319,
                                                                            "label": "where={\"id\": key_id}",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 1316,
                                                                                    "end_token": 1316,
                                                                                    "label": "\"id\"",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1318,
                                                                                    "end_token": 1318,
                                                                                    "label": "key_id",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 1323,
                                            "end_token": 1333,
                                            "label": "if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 1324,
                                                    "end_token": 1325,
                                                    "label": "not api_key",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1325,
                                                            "end_token": 1325,
                                                            "label": "api_key",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 1326,
                                                    "end_token": 1333,
                                                    "label": ":\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 1328,
                                                            "end_token": 1333,
                                                            "label": "raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 1329,
                                                                    "end_token": 1333,
                                                                    "label": "APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1329,
                                                                            "end_token": 1329,
                                                                            "label": "APIKeyNotFoundError",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 1330,
                                                                            "end_token": 1333,
                                                                            "label": "(f\"API key with id {key_id} not found\")",
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 1332,
                                                                                    "end_token": 1332,
                                                                                    "label": "\"API key with id {key_id} not found\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 1336,
                                            "end_token": 1351,
                                            "label": "if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 1337,
                                                    "end_token": 1342,
                                                    "label": "api_key.userId != user_id",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1337,
                                                            "end_token": 1339,
                                                            "label": "api_key.userId",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1337,
                                                                    "end_token": 1337,
                                                                    "label": "api_key",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1339,
                                                                    "end_token": 1339,
                                                                    "label": "userId",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1342,
                                                            "end_token": 1342,
                                                            "label": "user_id",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 1343,
                                                    "end_token": 1351,
                                                    "label": ":\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 1345,
                                                            "end_token": 1351,
                                                            "label": "raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 1346,
                                                                    "end_token": 1351,
                                                                    "label": "APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1346,
                                                                            "end_token": 1346,
                                                                            "label": "APIKeyPermissionError",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 1347,
                                                                            "end_token": 1350,
                                                                            "label": "(\n                \"You do not have permission to suspend this API key.\"\n",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 1349,
                                                                                    "end_token": 1349,
                                                                                    "label": "\"You do not have permission to suspend this API key.\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 1354,
                                            "end_token": 1362,
                                            "label": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1354,
                                                    "end_token": 1354,
                                                    "label": "where_clause",
                                                    "children": []
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "start_token": 1356,
                                                    "end_token": 1357,
                                                    "label": "APIKeyWhereUniqueInput =",
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 1356,
                                                            "end_token": 1356,
                                                            "label": "APIKeyWhereUniqueInput",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "dictionary",
                                                            "start_token": 1358,
                                                            "end_token": 1362,
                                                            "label": "{\"id\": key_id}",
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 1359,
                                                                    "end_token": 1361,
                                                                    "label": "\"id\": key_id",
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 1359,
                                                                            "end_token": 1359,
                                                                            "label": "\"id\"",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1361,
                                                                            "end_token": 1361,
                                                                            "label": "key_id",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 1364,
                                            "end_token": 1393,
                                            "label": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1364,
                                                    "end_token": 1364,
                                                    "label": "updated_api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 1366,
                                                    "end_token": 1393,
                                                    "label": "await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1367,
                                                            "end_token": 1393,
                                                            "label": "PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 1367,
                                                                    "end_token": 1373,
                                                                    "label": "PrismaAPIKey.prisma().update",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1367,
                                                                            "end_token": 1371,
                                                                            "label": "PrismaAPIKey.prisma()",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1367,
                                                                                    "end_token": 1367,
                                                                                    "label": "PrismaAPIKey",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1369,
                                                                                    "end_token": 1371,
                                                                                    "label": "prisma()",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1369,
                                                                                            "end_token": 1369,
                                                                                            "label": "prisma",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1373,
                                                                            "end_token": 1373,
                                                                            "label": "update",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1374,
                                                                    "end_token": 1393,
                                                                    "label": "(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 1376,
                                                                            "end_token": 1379,
                                                                            "label": "where=where_clause,",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1376,
                                                                                    "end_token": 1376,
                                                                                    "label": "where",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1378,
                                                                                    "end_token": 1378,
                                                                                    "label": "where_clause",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 1381,
                                                                            "end_token": 1390,
                                                                            "label": "data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1381,
                                                                                    "end_token": 1381,
                                                                                    "label": "data",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1383,
                                                                                    "end_token": 1390,
                                                                                    "label": "APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1383,
                                                                                            "end_token": 1383,
                                                                                            "label": "APIKeyUpdateInput",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 1385,
                                                                                            "end_token": 1389,
                                                                                            "label": "status=APIKeyStatus.SUSPENDED",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 1385,
                                                                                                    "end_token": 1385,
                                                                                                    "label": "status",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 1387,
                                                                                                    "end_token": 1389,
                                                                                                    "label": "APIKeyStatus.SUSPENDED",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 1387,
                                                                                                            "end_token": 1387,
                                                                                                            "label": "APIKeyStatus",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 1389,
                                                                                                            "end_token": 1389,
                                                                                                            "label": "SUSPENDED",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 1396,
                                            "end_token": 1408,
                                            "label": "if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1397,
                                                    "end_token": 1397,
                                                    "label": "updated_api_key",
                                                    "children": []
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 1398,
                                                    "end_token": 1408,
                                                    "label": ":\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 1400,
                                                            "end_token": 1406,
                                                            "label": "return APIKeyWithoutHash.from_db(updated_api_key)",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 1401,
                                                                    "end_token": 1406,
                                                                    "label": "APIKeyWithoutHash.from_db(updated_api_key)",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1401,
                                                                            "end_token": 1403,
                                                                            "label": "APIKeyWithoutHash.from_db",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1401,
                                                                                    "end_token": 1401,
                                                                                    "label": "APIKeyWithoutHash",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1403,
                                                                                    "end_token": 1403,
                                                                                    "label": "from_db",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 1404,
                                                                            "end_token": 1406,
                                                                            "label": "(updated_api_key)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1405,
                                                                                    "end_token": 1405,
                                                                                    "label": "updated_api_key",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 1408,
                                                            "end_token": 1409,
                                                            "label": "return None",
                                                            "children": [
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 1409,
                                                                    "end_token": 1409,
                                                                    "label": "None",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1411,
                                    "end_token": 1423,
                                    "label": "except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n",
                                    "children": [
                                        {
                                            "type": "expression_list",
                                            "start_token": 1412,
                                            "end_token": 1415,
                                            "label": "(APIKeyNotFoundError, APIKeyPermissionError",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1413,
                                                    "end_token": 1413,
                                                    "label": "APIKeyNotFoundError",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1415,
                                                    "end_token": 1415,
                                                    "label": "APIKeyPermissionError",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "as_pattern",
                                            "start_token": 1417,
                                            "end_token": 1418,
                                            "label": "as e",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1418,
                                                    "end_token": 1418,
                                                    "label": "e",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 1419,
                                            "end_token": 1423,
                                            "label": ":\n        raise e\n",
                                            "children": [
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1421,
                                                    "end_token": 1422,
                                                    "label": "raise e",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1422,
                                                            "end_token": 1422,
                                                            "label": "e",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "except_clause",
                            "start_token": 1424,
                            "end_token": 1443,
                            "label": "except PrismaError as e:\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1425,
                                    "end_token": 1425,
                                    "label": "PrismaError",
                                    "children": []
                                },
                                {
                                    "type": "as_pattern",
                                    "start_token": 1427,
                                    "end_token": 1428,
                                    "label": "e:",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 1428,
                                            "end_token": 1428,
                                            "label": ":",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": 1429,
                                    "end_token": 1443,
                                    "label": "\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "call",
                                            "start_token": 1430,
                                            "end_token": 1436,
                                            "label": "logger.error(f\"Database error while suspending API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 1430,
                                                    "end_token": 1432,
                                                    "label": "logger.error",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1430,
                                                            "end_token": 1430,
                                                            "label": "logger",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1432,
                                                            "end_token": 1432,
                                                            "label": "error",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "start_token": 1433,
                                                    "end_token": 1436,
                                                    "label": "(f\"Database error while suspending API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "concatenated_string",
                                                            "start_token": 1435,
                                                            "end_token": 1435,
                                                            "label": "\"Database error while suspending API key: {str(e)}\"",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "raise_statement",
                                            "start_token": 1438,
                                            "end_token": 1443,
                                            "label": "raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1439,
                                                    "end_token": 1443,
                                                    "label": "APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1439,
                                                            "end_token": 1439,
                                                            "label": "APIKeyError",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 1440,
                                                            "end_token": 1443,
                                                            "label": "(f\"Failed to suspend API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 1442,
                                                                    "end_token": 1442,
                                                                    "label": "\"Failed to suspend API key: {str(e)}\"",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "except_clause",
                            "start_token": 1445,
                            "end_token": 1464,
                            "label": "except Exception as e:\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1446,
                                    "end_token": 1446,
                                    "label": "Exception",
                                    "children": []
                                },
                                {
                                    "type": "as_pattern",
                                    "start_token": 1447,
                                    "end_token": 1448,
                                    "label": "as e",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 1448,
                                            "end_token": 1448,
                                            "label": "e",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": 1449,
                                    "end_token": 1464,
                                    "label": ":\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "call",
                                            "start_token": 1451,
                                            "end_token": 1457,
                                            "label": "logger.error(f\"Unexpected error while suspending API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 1451,
                                                    "end_token": 1453,
                                                    "label": "logger.error",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1451,
                                                            "end_token": 1451,
                                                            "label": "logger",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1453,
                                                            "end_token": 1453,
                                                            "label": "error",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "start_token": 1454,
                                                    "end_token": 1457,
                                                    "label": "(f\"Unexpected error while suspending API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "concatenated_string",
                                                            "start_token": 1456,
                                                            "end_token": 1456,
                                                            "label": "\"Unexpected error while suspending API key: {str(e)}\"",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "raise_statement",
                                            "start_token": 1459,
                                            "end_token": 1464,
                                            "label": "raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1460,
                                                    "end_token": 1464,
                                                    "label": "APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1460,
                                                            "end_token": 1460,
                                                            "label": "APIKeyError",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 1461,
                                                            "end_token": 1464,
                                                            "label": "(f\"Failed to suspend API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 1463,
                                                                    "end_token": 1463,
                                                                    "label": "\"Failed to suspend API key: {str(e)}\"",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "suspend_api_key",
            "start_line": 235,
            "end_line": 263
        },
        {
            "type": "function_definition",
            "start_token": 1468,
            "end_token": 1510,
            "label": "def has_permission(api_key: APIKey, required_permission: APIKeyPermission) -> bool:\n    try:\n        return required_permission in api_key.permissions\n    except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 1469,
                    "end_token": 1469,
                    "label": "has_permission",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": 1470,
                    "end_token": 1478,
                    "label": "(api_key: APIKey, required_permission: APIKeyPermission)",
                    "children": [
                        {
                            "type": "typed_parameter",
                            "start_token": 1471,
                            "end_token": 1473,
                            "label": "api_key: APIKey",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1471,
                                    "end_token": 1471,
                                    "label": "api_key",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1473,
                                    "end_token": 1473,
                                    "label": "APIKey",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "start_token": 1475,
                            "end_token": 1477,
                            "label": "required_permission: APIKeyPermission",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1475,
                                    "end_token": 1475,
                                    "label": "required_permission",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1477,
                                    "end_token": 1477,
                                    "label": "APIKeyPermission",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "start_token": 1480,
                    "end_token": 1481,
                    "label": "> bool",
                    "children": []
                },
                {
                    "type": "block",
                    "start_token": 1483,
                    "end_token": 1510,
                    "label": "\n    try:\n        return required_permission in api_key.permissions\n    except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False\n",
                    "children": [
                        {
                            "type": "try_statement",
                            "start_token": 1484,
                            "end_token": 1509,
                            "label": "try:\n        return required_permission in api_key.permissions\n    except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
                            "children": [
                                {
                                    "type": "block",
                                    "start_token": 1487,
                                    "end_token": 1492,
                                    "label": "return required_permission in api_key.permissions",
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "start_token": 1487,
                                            "end_token": 1492,
                                            "label": "return required_permission in api_key.permissions",
                                            "children": [
                                                {
                                                    "type": "boolean_operator",
                                                    "start_token": 1488,
                                                    "end_token": 1492,
                                                    "label": "required_permission in api_key.permissions",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1488,
                                                            "end_token": 1488,
                                                            "label": "required_permission",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1490,
                                                            "end_token": 1492,
                                                            "label": "api_key.permissions",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1490,
                                                                    "end_token": 1490,
                                                                    "label": "api_key",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1492,
                                                                    "end_token": 1492,
                                                                    "label": "permissions",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1494,
                                    "end_token": 1509,
                                    "label": "except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
                                    "children": [
                                        {
                                            "type": "as_pattern",
                                            "start_token": 1495,
                                            "end_token": 1497,
                                            "label": "Exception as e",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1495,
                                                    "end_token": 1495,
                                                    "label": "Exception",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1497,
                                                    "end_token": 1497,
                                                    "label": "e",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 1500,
                                            "end_token": 1509,
                                            "label": "logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "start_token": 1500,
                                                    "end_token": 1506,
                                                    "label": "logger.error(f\"Error checking API key permissions: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1500,
                                                            "end_token": 1506,
                                                            "label": "logger.error(f\"Error checking API key permissions: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 1500,
                                                                    "end_token": 1502,
                                                                    "label": "logger.error",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1500,
                                                                            "end_token": 1500,
                                                                            "label": "logger",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1502,
                                                                            "end_token": 1502,
                                                                            "label": "error",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1503,
                                                                    "end_token": 1505,
                                                                    "label": "(f\"Error checking API key permissions: {str(e)}\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 1504,
                                                                            "end_token": 1505,
                                                                            "label": "f\"Error checking API key permissions: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "start_token": 1505,
                                                                                    "end_token": 1505,
                                                                                    "label": "\"Error checking API key permissions: {str(e)}\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 1508,
                                                    "end_token": 1509,
                                                    "label": "return False",
                                                    "children": [
                                                        {
                                                            "type": "false",
                                                            "start_token": 1509,
                                                            "end_token": 1509,
                                                            "label": "False",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "has_permission",
            "start_line": 266,
            "end_line": 271
        },
        {
            "type": "function_definition",
            "start_token": 1513,
            "end_token": 1622,
            "label": "async def get_api_key_by_id(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)\n    except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 1514,
                    "end_token": 1514,
                    "label": "def",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": 1516,
                    "end_token": 1524,
                    "label": "(key_id: str, user_id: str)",
                    "children": [
                        {
                            "type": "typed_parameter",
                            "start_token": 1517,
                            "end_token": 1519,
                            "label": "key_id: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1517,
                                    "end_token": 1517,
                                    "label": "key_id",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1519,
                                    "end_token": 1519,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "start_token": 1521,
                            "end_token": 1523,
                            "label": "user_id: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1521,
                                    "end_token": 1521,
                                    "label": "user_id",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1523,
                                    "end_token": 1523,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "generic_type",
                    "start_token": 1527,
                    "end_token": 1530,
                    "label": "Optional[APIKeyWithoutHash]",
                    "children": [
                        {
                            "type": "type",
                            "start_token": 1527,
                            "end_token": 1527,
                            "label": "Optional",
                            "children": []
                        },
                        {
                            "type": "type",
                            "start_token": 1529,
                            "end_token": 1529,
                            "label": "APIKeyWithoutHash",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": 1532,
                    "end_token": 1622,
                    "label": "\n    try:\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)\n    except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n",
                    "children": [
                        {
                            "type": "try_statement",
                            "start_token": 1533,
                            "end_token": 1622,
                            "label": "try:\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)\n    except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n",
                            "children": [
                                {
                                    "type": "block",
                                    "start_token": 1536,
                                    "end_token": 1579,
                                    "label": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 1536,
                                            "end_token": 1559,
                                            "label": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)",
                                            "children": [
                                                {
                                                    "type": "await",
                                                    "start_token": 1538,
                                                    "end_token": 1559,
                                                    "label": "await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1539,
                                                            "end_token": 1559,
                                                            "label": "PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 1539,
                                                                    "end_token": 1545,
                                                                    "label": "PrismaAPIKey.prisma().find_first",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1539,
                                                                            "end_token": 1541,
                                                                            "label": "PrismaAPIKey.prisma",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1539,
                                                                                    "end_token": 1539,
                                                                                    "label": "PrismaAPIKey",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1541,
                                                                                    "end_token": 1541,
                                                                                    "label": "prisma",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1545,
                                                                            "end_token": 1545,
                                                                            "label": "find_first",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 1546,
                                                                    "end_token": 1561,
                                                                    "label": "(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )",
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 1548,
                                                                            "end_token": 1559,
                                                                            "label": "where=APIKeyWhereInput(id=key_id, userId=user_id)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1550,
                                                                                    "end_token": 1559,
                                                                                    "label": "APIKeyWhereInput(id=key_id, userId=user_id)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1550,
                                                                                            "end_token": 1550,
                                                                                            "label": "APIKeyWhereInput",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 1551,
                                                                                            "end_token": 1559,
                                                                                            "label": "(id=key_id, userId=user_id)",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 1552,
                                                                                                    "end_token": 1554,
                                                                                                    "label": "id=key_id",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 1552,
                                                                                                            "end_token": 1552,
                                                                                                            "label": "id",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 1554,
                                                                                                            "end_token": 1554,
                                                                                                            "label": "key_id",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 1556,
                                                                                                    "end_token": 1558,
                                                                                                    "label": "userId=user_id",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 1556,
                                                                                                            "end_token": 1556,
                                                                                                            "label": "userId",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 1558,
                                                                                                            "end_token": 1558,
                                                                                                            "label": "user_id",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 1564,
                                            "end_token": 1570,
                                            "label": "if not api_key:\n            return None",
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 1565,
                                                    "end_token": 1566,
                                                    "label": "not api_key",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1566,
                                                            "end_token": 1566,
                                                            "label": "api_key",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 1568,
                                                    "end_token": 1570,
                                                    "label": "\n            return None",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 1569,
                                                            "end_token": 1570,
                                                            "label": "return None",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 1573,
                                            "end_token": 1579,
                                            "label": "return APIKeyWithoutHash.from_db(api_key)",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1574,
                                                    "end_token": 1579,
                                                    "label": "APIKeyWithoutHash.from_db(api_key)",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1574,
                                                            "end_token": 1576,
                                                            "label": "APIKeyWithoutHash.from_db",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1574,
                                                                    "end_token": 1574,
                                                                    "label": "APIKeyWithoutHash",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1576,
                                                                    "end_token": 1576,
                                                                    "label": "from_db",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 1577,
                                                            "end_token": 1579,
                                                            "label": "(api_key)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1578,
                                                                    "end_token": 1578,
                                                                    "label": "api_key",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1581,
                                    "end_token": 1601,
                                    "label": "except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n",
                                    "children": [
                                        {
                                            "type": "as_pattern",
                                            "start_token": 1582,
                                            "end_token": 1584,
                                            "label": "PrismaError as e",
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "start_token": 1582,
                                                    "end_token": 1582,
                                                    "label": "PrismaError",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1584,
                                                    "end_token": 1584,
                                                    "label": "e",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 1586,
                                            "end_token": 1601,
                                            "label": "\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1587,
                                                    "end_token": 1593,
                                                    "label": "logger.error(f\"Database error while getting API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1587,
                                                            "end_token": 1589,
                                                            "label": "logger.error",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1587,
                                                                    "end_token": 1587,
                                                                    "label": "logger",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1589,
                                                                    "end_token": 1589,
                                                                    "label": "error",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "concatenated_string",
                                                            "start_token": 1591,
                                                            "end_token": 1592,
                                                            "label": "f\"Database error while getting API key: {str(e)}\"",
                                                            "children": [
                                                                {
                                                                    "type": "interpolation",
                                                                    "start_token": 1592,
                                                                    "end_token": 1592,
                                                                    "label": "\"Database error while getting API key: {str(e)}\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 1592,
                                                                            "end_token": 1592,
                                                                            "label": "\"Database error while getting API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "start_token": 1592,
                                                                                    "end_token": 1592,
                                                                                    "label": "\"Database error while getting API key: {str(e)}\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1595,
                                                    "end_token": 1600,
                                                    "label": "raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1596,
                                                            "end_token": 1600,
                                                            "label": "APIKeyError(f\"Failed to get API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 1596,
                                                                    "end_token": 1596,
                                                                    "label": "APIKeyError",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 1598,
                                                                    "end_token": 1599,
                                                                    "label": "f\"Failed to get API key: {str(e)}\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 1599,
                                                                            "end_token": 1599,
                                                                            "label": "\"Failed to get API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1599,
                                                                                    "end_token": 1599,
                                                                                    "label": "\"Failed to get API key: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "type",
                                                                                            "start_token": 1599,
                                                                                            "end_token": 1599,
                                                                                            "label": "\"Failed to get API key: {str(e)}\"",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "start_token": 1602,
                                    "end_token": 1621,
                                    "label": "except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "as_pattern",
                                            "start_token": 1603,
                                            "end_token": 1605,
                                            "label": "Exception as e",
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "start_token": 1603,
                                                    "end_token": 1603,
                                                    "label": "Exception",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1605,
                                                    "end_token": 1605,
                                                    "label": "e",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 1607,
                                            "end_token": 1621,
                                            "label": "\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 1608,
                                                    "end_token": 1614,
                                                    "label": "logger.error(f\"Unexpected error while getting API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 1608,
                                                            "end_token": 1610,
                                                            "label": "logger.error",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1608,
                                                                    "end_token": 1608,
                                                                    "label": "logger",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1610,
                                                                    "end_token": 1610,
                                                                    "label": "error",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "concatenated_string",
                                                            "start_token": 1612,
                                                            "end_token": 1613,
                                                            "label": "f\"Unexpected error while getting API key: {str(e)}\"",
                                                            "children": [
                                                                {
                                                                    "type": "interpolation",
                                                                    "start_token": 1613,
                                                                    "end_token": 1613,
                                                                    "label": "\"Unexpected error while getting API key: {str(e)}\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 1613,
                                                                            "end_token": 1613,
                                                                            "label": "\"Unexpected error while getting API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "start_token": 1613,
                                                                                    "end_token": 1613,
                                                                                    "label": "\"Unexpected error while getting API key: {str(e)}\"",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 1616,
                                                    "end_token": 1621,
                                                    "label": "raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 1617,
                                                            "end_token": 1621,
                                                            "label": "APIKeyError(f\"Failed to get API key: {str(e)}\")",
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 1617,
                                                                    "end_token": 1617,
                                                                    "label": "APIKeyError",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 1619,
                                                                    "end_token": 1620,
                                                                    "label": "f\"Failed to get API key: {str(e)}\"",
                                                                    "children": [
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 1620,
                                                                            "end_token": 1620,
                                                                            "label": "\"Failed to get API key: {str(e)}\"",
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 1620,
                                                                                    "end_token": 1620,
                                                                                    "label": "\"Failed to get API key: {str(e)}\"",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "type",
                                                                                            "start_token": 1620,
                                                                                            "end_token": 1620,
                                                                                            "label": "\"Failed to get API key: {str(e)}\"",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "get_api_key_by_id",
            "start_line": 274,
            "end_line": 289
        },
        {
            "type": "decorated_definition",
            "start_token": 1625,
            "end_token": 1822,
            "label": "async def update_api_key_permissions(\n    key_id: str, user_id: str, permissions: List[APIKeyPermission]\n) -> Optional[APIKeyWithoutHash]:\n    \"\"\"\n    Update the permissions of an API key.\n    \"\"\"\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n",
            "children": [
                {
                    "type": "function_definition",
                    "start_token": 1625,
                    "end_token": 1821,
                    "label": "async def update_api_key_permissions(\n    key_id: str, user_id: str, permissions: List[APIKeyPermission]\n) -> Optional[APIKeyWithoutHash]:\n    \"\"\"\n    Update the permissions of an API key.\n    \"\"\"\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 1626,
                            "end_token": 1626,
                            "label": "def",
                            "children": []
                        },
                        {
                            "type": "parameters",
                            "start_token": 1628,
                            "end_token": 1645,
                            "label": "(\n    key_id: str, user_id: str, permissions: List[APIKeyPermission]\n)",
                            "children": [
                                {
                                    "type": "typed_parameter",
                                    "start_token": 1630,
                                    "end_token": 1632,
                                    "label": "key_id: str",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 1630,
                                            "end_token": 1630,
                                            "label": "key_id",
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "start_token": 1631,
                                            "end_token": 1632,
                                            "label": ": str",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "typed_parameter",
                                    "start_token": 1634,
                                    "end_token": 1636,
                                    "label": "user_id: str",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 1634,
                                            "end_token": 1634,
                                            "label": "user_id",
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "start_token": 1635,
                                            "end_token": 1636,
                                            "label": ": str",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "typed_parameter",
                                    "start_token": 1638,
                                    "end_token": 1643,
                                    "label": "permissions: List[APIKeyPermission]",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 1638,
                                            "end_token": 1638,
                                            "label": "permissions",
                                            "children": []
                                        },
                                        {
                                            "type": "generic_type",
                                            "start_token": 1639,
                                            "end_token": 1643,
                                            "label": ": List[APIKeyPermission]",
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "start_token": 1640,
                                                    "end_token": 1640,
                                                    "label": "List",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 1642,
                                                    "end_token": 1642,
                                                    "label": "APIKeyPermission",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "union_type",
                            "start_token": 1646,
                            "end_token": 1651,
                            "label": "-> Optional[APIKeyWithoutHash]",
                            "children": [
                                {
                                    "type": "type",
                                    "start_token": 1648,
                                    "end_token": 1648,
                                    "label": "Optional",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 1650,
                                    "end_token": 1650,
                                    "label": "APIKeyWithoutHash",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "block",
                            "start_token": 1653,
                            "end_token": 1821,
                            "label": "\n    \"\"\"\n    Update the permissions of an API key.\n    \"\"\"\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 1654,
                                    "end_token": 1656,
                                    "label": "\"\"\"\n    Update the permissions of an API key.\n    \"\"\"",
                                    "children": [
                                        {
                                            "type": "string_content",
                                            "start_token": 1655,
                                            "end_token": 1655,
                                            "label": "\"\n    Update the permissions of an API key.\n    \"",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "try_statement",
                                    "start_token": 1658,
                                    "end_token": 1821,
                                    "label": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                                    "children": [
                                        {
                                            "type": "block",
                                            "start_token": 1658,
                                            "end_token": 1767,
                                            "label": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n",
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 1661,
                                                    "end_token": 1679,
                                                    "label": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1661,
                                                            "end_token": 1661,
                                                            "label": "api_key",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 1663,
                                                            "end_token": 1679,
                                                            "label": "await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 1663,
                                                                    "end_token": 1679,
                                                                    "label": "await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1664,
                                                                            "end_token": 1670,
                                                                            "label": "PrismaAPIKey.prisma().find_unique",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 1664,
                                                                                    "end_token": 1666,
                                                                                    "label": "PrismaAPIKey.prisma",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1670,
                                                                                    "end_token": 1670,
                                                                                    "label": "find_unique",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 1671,
                                                                            "end_token": 1679,
                                                                            "label": "(where={\"id\": key_id})",
                                                                            "children": [
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 1674,
                                                                                    "end_token": 1678,
                                                                                    "label": "{\"id\": key_id}",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 1675,
                                                                                            "end_token": 1677,
                                                                                            "label": "\"id\": key_id",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 1675,
                                                                                                    "end_token": 1675,
                                                                                                    "label": "\"id\"",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 1677,
                                                                                                    "end_token": 1677,
                                                                                                    "label": "key_id",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 1682,
                                                    "end_token": 1692,
                                                    "label": "if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")",
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 1683,
                                                            "end_token": 1685,
                                                            "label": "api_key is None",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 1685,
                                                            "end_token": 1685,
                                                            "label": "None",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 1686,
                                                            "end_token": 1692,
                                                            "label": ":\n            raise APIKeyNotFoundError(\"No such API key found.\")",
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 1688,
                                                                    "end_token": 1692,
                                                                    "label": "raise APIKeyNotFoundError(\"No such API key found.\")",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 1689,
                                                                            "end_token": 1691,
                                                                            "label": "APIKeyNotFoundError(\"No such API key found.\"",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 1695,
                                                    "end_token": 1710,
                                                    "label": "if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )",
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 1696,
                                                            "end_token": 1702,
                                                            "label": "api_key.userId != user_id:",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 1703,
                                                            "end_token": 1710,
                                                            "label": "\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )",
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 1704,
                                                                    "end_token": 1710,
                                                                    "label": "raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 1705,
                                                                            "end_token": 1709,
                                                                            "label": "APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 1713,
                                                    "end_token": 1721,
                                                    "label": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 1713,
                                                            "end_token": 1715,
                                                            "label": "where_clause: APIKeyWhereUniqueInput",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "dictionary",
                                                            "start_token": 1717,
                                                            "end_token": 1720,
                                                            "label": "{\"id\": key_id",
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 1718,
                                                                    "end_token": 1720,
                                                                    "label": "\"id\": key_id",
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 1718,
                                                                            "end_token": 1718,
                                                                            "label": "\"id\"",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 1720,
                                                                            "end_token": 1720,
                                                                            "label": "key_id",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 1723,
                                                    "end_token": 1750,
                                                    "label": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1723,
                                                            "end_token": 1723,
                                                            "label": "updated_api_key",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 1725,
                                                            "end_token": 1750,
                                                            "label": "await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 1725,
                                                                    "end_token": 1750,
                                                                    "label": "await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 1726,
                                                                            "end_token": 1732,
                                                                            "label": "PrismaAPIKey.prisma().update",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 1726,
                                                                                    "end_token": 1728,
                                                                                    "label": "PrismaAPIKey.prisma",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 1732,
                                                                                    "end_token": 1732,
                                                                                    "label": "update",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 1733,
                                                                            "end_token": 1750,
                                                                            "label": "(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 1735,
                                                                                    "end_token": 1737,
                                                                                    "label": "where=where_clause",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1735,
                                                                                            "end_token": 1735,
                                                                                            "label": "where",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 1740,
                                                                                    "end_token": 1747,
                                                                                    "label": "data=APIKeyUpdateInput(permissions=permissions)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1740,
                                                                                            "end_token": 1742,
                                                                                            "label": "data=APIKeyUpdateInput",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 1746,
                                                                                            "end_token": 1746,
                                                                                            "label": "permissions",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 1753,
                                                    "end_token": 1763,
                                                    "label": "if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1754,
                                                            "end_token": 1754,
                                                            "label": "updated_api_key",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 1755,
                                                            "end_token": 1763,
                                                            "label": ":\n            return APIKeyWithoutHash.from_db(updated_api_key)",
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": 1757,
                                                                    "end_token": 1763,
                                                                    "label": "return APIKeyWithoutHash.from_db(updated_api_key)",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 1758,
                                                                            "end_token": 1762,
                                                                            "label": "APIKeyWithoutHash.from_db(updated_api_key",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 1765,
                                                    "end_token": 1766,
                                                    "label": "return None",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "except_clause",
                                            "start_token": 1768,
                                            "end_token": 1780,
                                            "label": "except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n",
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 1776,
                                                    "end_token": 1780,
                                                    "label": ":\n        raise e\n",
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 1778,
                                                            "end_token": 1779,
                                                            "label": "raise e",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "except_clause",
                                            "start_token": 1781,
                                            "end_token": 1801,
                                            "label": "except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n",
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 1785,
                                                    "end_token": 1801,
                                                    "label": ":\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 1787,
                                                            "end_token": 1793,
                                                            "label": "logger.error(f\"Database error while updating API key permissions: {str(e)}\")",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 1795,
                                                            "end_token": 1800,
                                                            "label": "raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "except_clause",
                                            "start_token": 1802,
                                            "end_token": 1821,
                                            "label": "except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 1806,
                                                    "end_token": 1821,
                                                    "label": ":\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 1808,
                                                            "end_token": 1814,
                                                            "label": "logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 1816,
                                                            "end_token": 1821,
                                                            "label": "raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "update_api_key_permissions",
            "start_line": 292,
            "end_line": 325
        }
    ]
}
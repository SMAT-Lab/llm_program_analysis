{
    "type": "module",
    "start_token": 0,
    "end_token": 201,
    "label": "import ipaddress\nimport re\nimport socket\nfrom typing import Callable\nfrom urllib.parse import urlparse, urlunparse\n\nimport idna\nimport requests as req\n\nfrom backend.util.settings import Config\n\n# List of IP networks to block\nBLOCKED_IP_NETWORKS = [\n    # --8<-- [start:BLOCKED_IP_NETWORKS]\n    ipaddress.ip_network(\"0.0.0.0/8\"),  # \"This\" Network\n    ipaddress.ip_network(\"10.0.0.0/8\"),  # Private-Use\n    ipaddress.ip_network(\"127.0.0.0/8\"),  # Loopback\n    ipaddress.ip_network(\"169.254.0.0/16\"),  # Link Local\n    ipaddress.ip_network(\"172.16.0.0/12\"),  # Private-Use\n    ipaddress.ip_network(\"192.168.0.0/16\"),  # Private-Use\n    ipaddress.ip_network(\"224.0.0.0/4\"),  # Multicast\n    ipaddress.ip_network(\"240.0.0.0/4\"),  # Reserved for Future Use\n    # --8<-- [end:BLOCKED_IP_NETWORKS]\n]\n\nALLOWED_SCHEMES = [\"http\", \"https\"]\nHOSTNAME_REGEX = re.compile(r\"^[A-Za-z0-9.-]+$\")  # Basic DNS-safe hostname pattern\n\n\n",
    "children": [
        {
            "type": "function_definition",
            "start_token": -1,
            "end_token": 242,
            "label": "",
            "children": [
                {
                    "type": "identifier",
                    "start_token": -1,
                    "end_token": -1,
                    "label": "",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": -1,
                    "end_token": -1,
                    "label": "",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": -1,
                    "end_token": -1,
                    "label": "",
                    "children": [
                        {
                            "type": "if_statement",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "if_clause",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "comparison_operator",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        },
                                        {
                                            "type": "block",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "integer",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "else_clause",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "block",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "integer",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": []
                        },
                        {
                            "type": "assignment",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "integer",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "_is_ip_blocked",
            "start_line": 42,
            "end_line": 47
        },
        {
            "type": "function_definition",
            "start_token": -1,
            "end_token": 242,
            "label": "",
            "children": [
                {
                    "type": "decorator",
                    "start_token": -1,
                    "end_token": -1,
                    "label": "",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "argument_list",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "start_token": -1,
                    "end_token": -1,
                    "label": "",
                    "children": [
                        {
                            "type": "parameters",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": []
                        },
                        {
                            "type": "return_statement",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": []
                        },
                        {
                            "type": "comment",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": []
                        },
                        {
                            "type": "assignment",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "call",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "dotted_name",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "validate_url",
            "start_line": 50,
            "end_line": 102
        },
        {
            "type": "class_placeholder",
            "name": "Requests",
            "start_line": 105,
            "end_line": 170,
            "start_token": -1,
            "end_token": 242,
            "label": "",
            "children": [
                {
                    "type": "module",
                    "start_token": -1,
                    "end_token": -1,
                    "label": "",
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "keyword_separator",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "parenthesized_expression",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "argument_list",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "if_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "integer",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "else_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "binary_operator",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "parameter",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "integer",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "if_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "binary_operator",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "else_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "for_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "if_statement",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "if_clause",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "binary_operator",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "label": "",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "label": "",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "integer",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "binary_operator",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "label": "",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "label": "",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "integer",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "expression_statement",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "label": "",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "label": "",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "else_clause",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "expression_statement",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "label": "",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "label": "",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "continue_statement",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "__init__",
                            "start_line": 110,
                            "end_line": 126
                        },
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "else_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "boolean_operator",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "request",
                            "start_line": 128,
                            "end_line": 149
                        },
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "if_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "parenthesized_expression",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "concatenated_string",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "get",
                            "start_line": 151,
                            "end_line": 152
                        },
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "if_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "else_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "post",
                            "start_line": 154,
                            "end_line": 155
                        },
                        {
                            "type": "function_placeholder",
                            "name": "put",
                            "start_line": 157,
                            "end_line": 158,
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "import_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "import_prefix",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "dotted_name",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "function_definition",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "parameters",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "binary_operator",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "integer",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "class_definition",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "parameters",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "integer",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "function_definition",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "parameters",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "typed_parameter",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "type",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "binary_operator",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "binary_operator",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "integer",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "delete",
                            "start_line": 160,
                            "end_line": 161
                        },
                        {
                            "type": "function_placeholder",
                            "name": "head",
                            "start_line": 163,
                            "end_line": 164,
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "comment",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        },
                                        {
                                            "type": "import_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "dotted_name",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "as_pattern",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "as_pattern_target",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "function_definition",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "parameters",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "default_parameter",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "integer",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "binary_operator",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "integer",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "integer",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "return_statement",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "else_clause",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": [
                                                                                {
                                                                                    "type": "try_statement",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "label": "",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "block",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "except_clause",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "label": "",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "label": "",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "raise_statement",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comment",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "label": "",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "true",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "binary_operator",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "integer",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ],
                            "name": "options",
                            "start_line": 166,
                            "end_line": 167
                        },
                        {
                            "type": "function_definition",
                            "start_token": -1,
                            "end_token": 242,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "if_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "true",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "else_clause",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "label": "",
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "label": "",
                                                                    "children": [
                                                                        {
                                                                            "type": "false",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "label": "",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                }
                            ],
                            "name": "patch",
                            "start_line": 169,
                            "end_line": 170
                        }
                    ]
                }
            ]
        },
        {
            "type": "block",
            "start_token": 0,
            "end_token": 41,
            "label": "import ipaddress\nimport re\nimport socket\nfrom typing import Callable\nfrom urllib.parse import urlparse, urlunparse\n\nimport idna\nimport requests as req\n\nfrom backend.util.settings import Config\n",
            "children": [
                {
                    "type": "import_statement",
                    "start_token": 0,
                    "end_token": 1,
                    "label": "import ipaddress",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 1,
                            "end_token": 1,
                            "label": "ipaddress",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "import_statement",
                    "start_token": 3,
                    "end_token": 4,
                    "label": "import re",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 4,
                            "end_token": 4,
                            "label": "re",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "import_statement",
                    "start_token": 6,
                    "end_token": 7,
                    "label": "import socket",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 7,
                            "end_token": 7,
                            "label": "socket",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "import_from_statement",
                    "start_token": 9,
                    "end_token": 12,
                    "label": "from typing import Callable",
                    "children": [
                        {
                            "type": "dotted_name",
                            "start_token": 10,
                            "end_token": 10,
                            "label": "typing",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 12,
                            "end_token": 12,
                            "label": "Callable",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "import_from_statement",
                    "start_token": 14,
                    "end_token": 21,
                    "label": "from urllib.parse import urlparse, urlunparse",
                    "children": [
                        {
                            "type": "dotted_name",
                            "start_token": 15,
                            "end_token": 17,
                            "label": "urllib.parse",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 15,
                                    "end_token": 15,
                                    "label": "urllib",
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 17,
                                    "end_token": 17,
                                    "label": "parse",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "identifier",
                            "start_token": 19,
                            "end_token": 19,
                            "label": "urlparse",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "start_token": 21,
                            "end_token": 21,
                            "label": "urlunparse",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "import_statement",
                    "start_token": 24,
                    "end_token": 25,
                    "label": "import idna",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 25,
                            "end_token": 25,
                            "label": "idna",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "aliased_import",
                    "start_token": 27,
                    "end_token": 30,
                    "label": "import requests as req",
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 28,
                            "end_token": 28,
                            "label": "requests",
                            "children": []
                        },
                        {
                            "type": "as_pattern_target",
                            "start_token": 30,
                            "end_token": 30,
                            "label": "req",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "import_from_statement",
                    "start_token": 33,
                    "end_token": 40,
                    "label": "from backend.util.settings import Config",
                    "children": [
                        {
                            "type": "dotted_name",
                            "start_token": 34,
                            "end_token": 38,
                            "label": "backend.util.settings",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 34,
                                    "end_token": 34,
                                    "label": "backend",
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 36,
                                    "end_token": 36,
                                    "label": "util",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "identifier",
                            "start_token": 40,
                            "end_token": 40,
                            "label": "Config",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "comment",
            "start_token": 43,
            "end_token": 49,
            "label": "# List of IP networks to block",
            "children": []
        },
        {
            "type": "assignment",
            "start_token": 51,
            "end_token": 172,
            "label": "BLOCKED_IP_NETWORKS = [\n    # --8<-- [start:BLOCKED_IP_NETWORKS]\n    ipaddress.ip_network(\"0.0.0.0/8\"),  # \"This\" Network\n    ipaddress.ip_network(\"10.0.0.0/8\"),  # Private-Use\n    ipaddress.ip_network(\"127.0.0.0/8\"),  # Loopback\n    ipaddress.ip_network(\"169.254.0.0/16\"),  # Link Local\n    ipaddress.ip_network(\"172.16.0.0/12\"),  # Private-Use\n    ipaddress.ip_network(\"192.168.0.0/16\"),  # Private-Use\n    ipaddress.ip_network(\"224.0.0.0/4\"),  # Multicast\n    ipaddress.ip_network(\"240.0.0.0/4\"),  # Reserved for Future Use\n    # --8<-- [end:BLOCKED_IP_NETWORKS]\n]",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 51,
                    "end_token": 51,
                    "label": "BLOCKED_IP_NETWORKS",
                    "children": []
                },
                {
                    "type": "list",
                    "start_token": 53,
                    "end_token": 172,
                    "label": "[\n    # --8<-- [start:BLOCKED_IP_NETWORKS]\n    ipaddress.ip_network(\"0.0.0.0/8\"),  # \"This\" Network\n    ipaddress.ip_network(\"10.0.0.0/8\"),  # Private-Use\n    ipaddress.ip_network(\"127.0.0.0/8\"),  # Loopback\n    ipaddress.ip_network(\"169.254.0.0/16\"),  # Link Local\n    ipaddress.ip_network(\"172.16.0.0/12\"),  # Private-Use\n    ipaddress.ip_network(\"192.168.0.0/16\"),  # Private-Use\n    ipaddress.ip_network(\"224.0.0.0/4\"),  # Multicast\n    ipaddress.ip_network(\"240.0.0.0/4\"),  # Reserved for Future Use\n    # --8<-- [end:BLOCKED_IP_NETWORKS]\n]",
                    "children": [
                        {
                            "type": "comment",
                            "start_token": 55,
                            "end_token": 66,
                            "label": "# --8<-- [start:BLOCKED_IP_NETWORKS]",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 68,
                            "end_token": 73,
                            "label": "ipaddress.ip_network(\"0.0.0.0/8\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 68,
                                    "end_token": 70,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 68,
                                            "end_token": 68,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 70,
                                            "end_token": 70,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 72,
                                    "end_token": 72,
                                    "label": "\"0.0.0.0/8\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 75,
                            "end_token": 78,
                            "label": "# \"This\" Network\n",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 79,
                            "end_token": 84,
                            "label": "ipaddress.ip_network(\"10.0.0.0/8\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 79,
                                    "end_token": 81,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 79,
                                            "end_token": 79,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 81,
                                            "end_token": 81,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 83,
                                    "end_token": 83,
                                    "label": "\"10.0.0.0/8\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 86,
                            "end_token": 90,
                            "label": "# Private-Use\n",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 91,
                            "end_token": 96,
                            "label": "ipaddress.ip_network(\"127.0.0.0/8\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 91,
                                    "end_token": 93,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 91,
                                            "end_token": 91,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 93,
                                            "end_token": 93,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 95,
                                    "end_token": 95,
                                    "label": "\"127.0.0.0/8\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 98,
                            "end_token": 100,
                            "label": "# Loopback\n",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 101,
                            "end_token": 106,
                            "label": "ipaddress.ip_network(\"169.254.0.0/16\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 101,
                                    "end_token": 103,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 101,
                                            "end_token": 101,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 103,
                                            "end_token": 103,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 105,
                                    "end_token": 105,
                                    "label": "\"169.254.0.0/16\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 108,
                            "end_token": 111,
                            "label": "# Link Local\n",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 112,
                            "end_token": 117,
                            "label": "ipaddress.ip_network(\"172.16.0.0/12\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 112,
                                    "end_token": 114,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 112,
                                            "end_token": 112,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 114,
                                            "end_token": 114,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 116,
                                    "end_token": 116,
                                    "label": "\"172.16.0.0/12\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 119,
                            "end_token": 123,
                            "label": "# Private-Use\n",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 124,
                            "end_token": 129,
                            "label": "ipaddress.ip_network(\"192.168.0.0/16\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 124,
                                    "end_token": 126,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 124,
                                            "end_token": 124,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 126,
                                            "end_token": 126,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 128,
                                    "end_token": 128,
                                    "label": "\"192.168.0.0/16\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 131,
                            "end_token": 135,
                            "label": "# Private-Use\n",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 136,
                            "end_token": 141,
                            "label": "ipaddress.ip_network(\"224.0.0.0/4\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 136,
                                    "end_token": 138,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 136,
                                            "end_token": 136,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 138,
                                            "end_token": 138,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 140,
                                    "end_token": 140,
                                    "label": "\"224.0.0.0/4\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 143,
                            "end_token": 145,
                            "label": "# Multicast\n",
                            "children": []
                        },
                        {
                            "type": "call",
                            "start_token": 146,
                            "end_token": 151,
                            "label": "ipaddress.ip_network(\"240.0.0.0/4\")",
                            "children": [
                                {
                                    "type": "attribute",
                                    "start_token": 146,
                                    "end_token": 148,
                                    "label": "ipaddress.ip_network",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 146,
                                            "end_token": 146,
                                            "label": "ipaddress",
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 148,
                                            "end_token": 148,
                                            "label": "ip_network",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "start_token": 150,
                                    "end_token": 150,
                                    "label": "\"240.0.0.0/4\"",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 153,
                            "end_token": 158,
                            "label": "# Reserved for Future Use\n",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "assignment",
            "start_token": 175,
            "end_token": 181,
            "label": "ALLOWED_SCHEMES = [\"http\", \"https\"]",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 175,
                    "end_token": 175,
                    "label": "ALLOWED_SCHEMES",
                    "children": []
                },
                {
                    "type": "list",
                    "start_token": 177,
                    "end_token": 181,
                    "label": "[\"http\", \"https\"]",
                    "children": [
                        {
                            "type": "string",
                            "start_token": 178,
                            "end_token": 178,
                            "label": "\"http\"",
                            "children": []
                        },
                        {
                            "type": "string",
                            "start_token": 180,
                            "end_token": 180,
                            "label": "\"https\"",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "assignment",
            "start_token": 183,
            "end_token": 191,
            "label": "HOSTNAME_REGEX = re.compile(r\"^[A-Za-z0-9.-]+$\")",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 183,
                    "end_token": 183,
                    "label": "HOSTNAME_REGEX",
                    "children": []
                },
                {
                    "type": "call",
                    "start_token": 185,
                    "end_token": 191,
                    "label": "re.compile(r\"^[A-Za-z0-9.-]+$\")",
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 185,
                            "end_token": 187,
                            "label": "re.compile",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 185,
                                    "end_token": 185,
                                    "label": "re",
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 187,
                                    "end_token": 187,
                                    "label": "compile",
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "string",
                            "start_token": 189,
                            "end_token": 189,
                            "label": "r",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "start_token": 202,
            "end_token": 242,
            "label": "def _canonicalize_url(url: str) -> str:\n    # Strip spaces and trailing slashes\n    url = url.strip().strip(\"/\")\n    # Ensure the URL starts with http:// or https://\n    if not url.startswith((\"http://\", \"https://\")):\n        url = \"http://\" + url\n\n    # Replace backslashes with forward slashes to avoid parsing ambiguities\n    url = url.replace(\"\\\\\", \"/\")\n    return url\n\n\ndef _is_ip_blocked(ip: str) -> bool:\n    \"\"\"\n    Checks if the IP address is in a blocked network.\n    \"\"\"\n    ip_addr = ipaddress.ip_address(ip)\n    return any(ip_addr in network for network in BLOCKED_IP_NETWORKS)\n\n\ndef validate_url(url: str, trusted_origins: list[str]) -> str:\n    \"\"\"\n    Validates the URL to prevent SSRF attacks by ensuring it does not point to a private\n    or untrusted IP address, unless whitelisted.\n    \"\"\"\n    url = _canonicalize_url(url)\n    parsed = urlparse(url)\n\n    # Check scheme\n    if parsed.scheme not in ALLOWED_SCHEMES:\n        raise ValueError(\n            f\"Scheme '{parsed.scheme}' is not allowed. Only HTTP/HTTPS are supported.\"\n        )\n\n    # Validate and IDNA encode the hostname\n    if not parsed.hostname:\n        raise ValueError(\"Invalid URL: No hostname found.\")\n\n    # IDNA encode to prevent Unicode domain attacks\n    try:\n        ascii_hostname = idna.encode(parsed.hostname).decode(\"ascii\")\n    except idna.IDNAError:\n        raise ValueError(\"Invalid hostname with unsupported characters.\")\n\n    # Check hostname characters\n    if not HOSTNAME_REGEX.match(ascii_hostname):\n        raise ValueError(\"Hostname contains invalid characters.\")\n\n    # Rebuild the URL with the normalized, IDNA-encoded hostname\n    parsed = parsed._replace(netloc=ascii_hostname)\n    url = str(urlunparse(parsed))\n\n    # Check if hostname is a trusted origin (exact match)\n    if ascii_hostname in trusted_origins:\n        return url\n\n    # Resolve all IP addresses for the hostname\n    try:\n        ip_addresses = {res[4][0] for res in socket.getaddrinfo(ascii_hostname, None)}\n    except socket.gaierror:\n        raise ValueError(f\"Unable to resolve IP address for hostname {ascii_hostname}\")\n\n    if not ip_addresses:\n        raise ValueError(f\"No IP addresses found for {ascii_hostname}\")\n\n    # Check if any resolved IP address falls into blocked ranges\n    for ip in ip_addresses:\n        if _is_ip_blocked(ip):\n            raise ValueError(\n                f\"Access to private IP address {ip} for hostname {ascii_hostname} is not allowed.\"\n            )\n\n    return url\n\n\nclass Requests:\n    \"\"\"\n    A wrapper around the requests library that validates URLs before making requests.\n    \"\"\"\n\n    def __init__(\n        self,\n        trusted_origins: list[str] | None = None,\n        raise_for_status: bool = True,\n        extra_url_validator: Callable[[str], str] | None = None,\n        extra_headers: dict[str, str] | None = None,\n    ):\n        self.trusted_origins = []\n        for url in trusted_origins or []:\n            hostname = urlparse(url).hostname\n            if not hostname:\n                raise ValueError(f\"Invalid URL: Unable to determine hostname of {url}\")\n            self.trusted_origins.append(hostname)\n\n        self.raise_for_status = raise_for_status\n        self.extra_url_validator = extra_url_validator\n        self.extra_headers = extra_headers\n\n    def request(\n        self, method, url, headers=None, allow_redirects=False, *args, **kwargs\n    ) -> req.Response:\n        if self.extra_headers is not None:\n            headers = {**(headers or {}), **self.extra_headers}\n\n        url = validate_url(url, self.trusted_origins)\n        if self.extra_url_validator is not None:\n            url = self.extra_url_validator(url)\n\n        response = req.request(\n            method,\n            url,\n            headers=headers,\n            allow_redirects=allow_redirects,\n            *args,\n            **kwargs,\n        )\n        if self.raise_for_status:\n            response.raise_for_status()\n\n        return response\n\n    def get(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"GET\", url, *args, **kwargs)\n\n    def post(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"POST\", url, *args, **kwargs)\n\n    def put(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"PUT\", url, *args, **kwargs)\n\n    def delete(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"DELETE\", url, *args, **kwargs)\n\n    def head(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"HEAD\", url, *args, **kwargs)\n\n    def options(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"OPTIONS\", url, *args, **kwargs)\n\n    def patch(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"PATCH\", url, *args, **kwargs)\n\n\nrequests = Requests(trusted_origins=Config().trust_endpoints_for_requests)\n",
            "children": [
                {
                    "type": "identifier",
                    "start_token": 203,
                    "end_token": 203,
                    "label": "_canonicalize_url",
                    "children": []
                },
                {
                    "type": "parameters",
                    "start_token": 204,
                    "end_token": 208,
                    "label": "(url: str)",
                    "children": [
                        {
                            "type": "typed_parameter",
                            "start_token": 205,
                            "end_token": 207,
                            "label": "url: str",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 205,
                                    "end_token": 205,
                                    "label": "url",
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "start_token": 207,
                                    "end_token": 207,
                                    "label": "str",
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "start_token": 211,
                    "end_token": 211,
                    "label": "str",
                    "children": []
                },
                {
                    "type": "block",
                    "start_token": 212,
                    "end_token": -1,
                    "label": "",
                    "children": [
                        {
                            "type": "comment",
                            "start_token": 214,
                            "end_token": 219,
                            "label": "# Strip spaces and trailing slashes",
                            "children": []
                        },
                        {
                            "type": "assignment",
                            "start_token": 221,
                            "end_token": 232,
                            "label": "url = url.strip().strip(\"/\")",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 221,
                                    "end_token": 221,
                                    "label": "url",
                                    "children": []
                                },
                                {
                                    "type": "call",
                                    "start_token": 223,
                                    "end_token": 227,
                                    "label": "url.strip()",
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "start_token": 223,
                                            "end_token": 225,
                                            "label": "url.strip",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 223,
                                                    "end_token": 223,
                                                    "label": "url",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 225,
                                                    "end_token": 225,
                                                    "label": "strip",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "call",
                                    "start_token": 228,
                                    "end_token": 232,
                                    "label": ".strip(\"/\")",
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "start_token": 228,
                                            "end_token": 229,
                                            "label": ".strip",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 228,
                                                    "end_token": 228,
                                                    "label": ".",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 229,
                                                    "end_token": 229,
                                                    "label": "strip",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "argument_list",
                                            "start_token": 230,
                                            "end_token": 231,
                                            "label": "(\"/\"",
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "start_token": 234,
                            "end_token": 242,
                            "label": "# Ensure the URL starts with http:// or https://\n    if not url.startswith((\"http://\", \"https://\")):\n        url = \"http://\" + url\n\n    # Replace backslashes with forward slashes to avoid parsing ambiguities\n    url = url.replace(\"\\\\\", \"/\")\n    return url\n\n\ndef _is_ip_blocked(ip: str) -> bool:\n    \"\"\"\n    Checks if the IP address is in a blocked network.\n    \"\"\"\n    ip_addr = ipaddress.ip_address(ip)\n    return any(ip_addr in network for network in BLOCKED_IP_NETWORKS)\n\n\ndef validate_url(url: str, trusted_origins: list[str]) -> str:\n    \"\"\"\n    Validates the URL to prevent SSRF attacks by ensuring it does not point to a private\n    or untrusted IP address, unless whitelisted.\n    \"\"\"\n    url = _canonicalize_url(url)\n    parsed = urlparse(url)\n\n    # Check scheme\n    if parsed.scheme not in ALLOWED_SCHEMES:\n        raise ValueError(\n            f\"Scheme '{parsed.scheme}' is not allowed. Only HTTP/HTTPS are supported.\"\n        )\n\n    # Validate and IDNA encode the hostname\n    if not parsed.hostname:\n        raise ValueError(\"Invalid URL: No hostname found.\")\n\n    # IDNA encode to prevent Unicode domain attacks\n    try:\n        ascii_hostname = idna.encode(parsed.hostname).decode(\"ascii\")\n    except idna.IDNAError:\n        raise ValueError(\"Invalid hostname with unsupported characters.\")\n\n    # Check hostname characters\n    if not HOSTNAME_REGEX.match(ascii_hostname):\n        raise ValueError(\"Hostname contains invalid characters.\")\n\n    # Rebuild the URL with the normalized, IDNA-encoded hostname\n    parsed = parsed._replace(netloc=ascii_hostname)\n    url = str(urlunparse(parsed))\n\n    # Check if hostname is a trusted origin (exact match)\n    if ascii_hostname in trusted_origins:\n        return url\n\n    # Resolve all IP addresses for the hostname\n    try:\n        ip_addresses = {res[4][0] for res in socket.getaddrinfo(ascii_hostname, None)}\n    except socket.gaierror:\n        raise ValueError(f\"Unable to resolve IP address for hostname {ascii_hostname}\")\n\n    if not ip_addresses:\n        raise ValueError(f\"No IP addresses found for {ascii_hostname}\")\n\n    # Check if any resolved IP address falls into blocked ranges\n    for ip in ip_addresses:\n        if _is_ip_blocked(ip):\n            raise ValueError(\n                f\"Access to private IP address {ip} for hostname {ascii_hostname} is not allowed.\"\n            )\n\n    return url\n\n\nclass Requests:\n    \"\"\"\n    A wrapper around the requests library that validates URLs before making requests.\n    \"\"\"\n\n    def __init__(\n        self,\n        trusted_origins: list[str] | None = None,\n        raise_for_status: bool = True,\n        extra_url_validator: Callable[[str], str] | None = None,\n        extra_headers: dict[str, str] | None = None,\n    ):\n        self.trusted_origins = []\n        for url in trusted_origins or []:\n            hostname = urlparse(url).hostname\n            if not hostname:\n                raise ValueError(f\"Invalid URL: Unable to determine hostname of {url}\")\n            self.trusted_origins.append(hostname)\n\n        self.raise_for_status = raise_for_status\n        self.extra_url_validator = extra_url_validator\n        self.extra_headers = extra_headers\n\n    def request(\n        self, method, url, headers=None, allow_redirects=False, *args, **kwargs\n    ) -> req.Response:\n        if self.extra_headers is not None:\n            headers = {**(headers or {}), **self.extra_headers}\n\n        url = validate_url(url, self.trusted_origins)\n        if self.extra_url_validator is not None:\n            url = self.extra_url_validator(url)\n\n        response = req.request(\n            method,\n            url,\n            headers=headers,\n            allow_redirects=allow_redirects,\n            *args,\n            **kwargs,\n        )\n        if self.raise_for_status:\n            response.raise_for_status()\n\n        return response\n\n    def get(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"GET\", url, *args, **kwargs)\n\n    def post(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"POST\", url, *args, **kwargs)\n\n    def put(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"PUT\", url, *args, **kwargs)\n\n    def delete(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"DELETE\", url, *args, **kwargs)\n\n    def head(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"HEAD\", url, *args, **kwargs)\n\n    def options(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"OPTIONS\", url, *args, **kwargs)\n\n    def patch(self, url, *args, **kwargs) -> req.Response:\n        return self.request(\"PATCH\", url, *args, **kwargs)\n\n\nrequests = Requests(trusted_origins=Config().trust_endpoints_for_requests)\n",
                            "children": []
                        },
                        {
                            "type": "conditional_expression",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "boolean_operator",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "not_operator",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "call",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "argument_list",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "assignment",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        },
                                        {
                                            "type": "binary_operator",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "assignment",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                },
                                {
                                    "type": "call",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "label": "",
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "argument_list",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "label": "",
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "start_token": -1,
                            "end_token": -1,
                            "label": "",
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "label": "",
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ],
            "name": "_canonicalize_url",
            "start_line": 30,
            "end_line": 39
        }
    ]
}
{
    "type": "module",
    "start_token": 0,
    "end_token": 526,
    "children": [
        {
            "type": "import_statement",
            "start_token": 0,
            "end_token": 1,
            "children": [],
            "label": "import secrets"
        },
        {
            "type": "import_from_statement",
            "start_token": 3,
            "end_token": 11,
            "children": [],
            "label": "from datetime import datetime, timedelta, timezone\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 12,
            "end_token": 15,
            "children": [],
            "label": "from typing import TYPE_CHECKING"
        },
        {
            "type": "if_statement",
            "start_token": 24,
            "end_token": 36,
            "children": [
                {
                    "type": "block",
                    "start_token": 28,
                    "end_token": 36,
                    "children": [
                        {
                            "type": "import_from_statement",
                            "start_token": 28,
                            "end_token": 35,
                            "children": [],
                            "label": "from backend.executor.database import DatabaseManager"
                        }
                    ],
                    "label": "from backend.executor.database import DatabaseManager\n"
                }
            ],
            "label": "if TYPE_CHECKING:\n    from backend.executor.database import DatabaseManager\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 38,
            "end_token": 45,
            "children": [],
            "label": "from autogpt_libs.utils.cache import thread_cached"
        },
        {
            "type": "import_from_statement",
            "start_token": 47,
            "end_token": 54,
            "children": [],
            "label": "from autogpt_libs.utils.synchronize import RedisKeyedMutex"
        },
        {
            "type": "import_from_statement",
            "start_token": 57,
            "end_token": 81,
            "children": [],
            "label": "from backend.data.model import (\n    APIKeyCredentials,\n    Credentials,\n    OAuth2Credentials,\n    OAuthState,\n    UserIntegrations,\n)"
        },
        {
            "type": "import_from_statement",
            "start_token": 83,
            "end_token": 90,
            "children": [],
            "label": "from backend.util.settings import Settings"
        },
        {
            "type": "assignment",
            "start_token": 93,
            "end_token": 97,
            "children": [
                {
                    "type": "call",
                    "start_token": 93,
                    "end_token": 97,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 95,
                            "end_token": 95,
                            "children": [],
                            "label": "Settings"
                        }
                    ],
                    "label": "settings = Settings()"
                }
            ],
            "label": "settings = Settings()"
        },
        {
            "type": "assignment",
            "start_token": 100,
            "end_token": 137,
            "children": [
                {
                    "type": "call",
                    "start_token": 102,
                    "end_token": 137,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 102,
                            "end_token": 102,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 105,
                            "end_token": 137,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 107,
                                    "end_token": 107,
                                    "children": [],
                                    "label": "\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 112,
                                    "end_token": 112,
                                    "children": [],
                                    "label": "\"revid\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 117,
                                    "end_token": 124,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 117,
                                            "end_token": 117,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 119,
                                            "end_token": 123,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 119,
                                                    "end_token": 121,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 119,
                                                            "end_token": 119,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 121,
                                                            "end_token": 121,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 123,
                                                    "end_token": 123,
                                                    "children": [],
                                                    "label": "revid_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.revid_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.revid_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 129,
                                    "end_token": 129,
                                    "children": [],
                                    "label": "\"Use Credits for Revid\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 134,
                                    "end_token": 134,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)"
                }
            ],
            "label": "revid_credentials = APIKeyCredentials(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 139,
            "end_token": 176,
            "children": [
                {
                    "type": "call",
                    "start_token": 141,
                    "end_token": 176,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 141,
                            "end_token": 141,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 144,
                            "end_token": 176,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 146,
                                    "end_token": 146,
                                    "children": [],
                                    "label": "\"760f84fc-b270-42de-91f6-08efe1b512d0\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 151,
                                    "end_token": 151,
                                    "children": [],
                                    "label": "\"ideogram\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 156,
                                    "end_token": 163,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 156,
                                            "end_token": 156,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 158,
                                            "end_token": 162,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 158,
                                                    "end_token": 160,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 158,
                                                            "end_token": 158,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 160,
                                                            "end_token": 160,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 162,
                                                    "end_token": 162,
                                                    "children": [],
                                                    "label": "ideogram_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.ideogram_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.ideogram_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 168,
                                    "end_token": 168,
                                    "children": [],
                                    "label": "\"Use Credits for Ideogram\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 173,
                                    "end_token": 173,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)"
                }
            ],
            "label": "ideogram_credentials = APIKeyCredentials(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 178,
            "end_token": 215,
            "children": [
                {
                    "type": "call",
                    "start_token": 180,
                    "end_token": 215,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 180,
                            "end_token": 180,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 183,
                            "end_token": 215,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 185,
                                    "end_token": 185,
                                    "children": [],
                                    "label": "\"6b9fc200-4726-4973-86c9-cd526f5ce5db\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 190,
                                    "end_token": 190,
                                    "children": [],
                                    "label": "\"replicate\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 195,
                                    "end_token": 202,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 195,
                                            "end_token": 195,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 197,
                                            "end_token": 201,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 197,
                                                    "end_token": 199,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 197,
                                                            "end_token": 197,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 199,
                                                            "end_token": 199,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 201,
                                                    "end_token": 201,
                                                    "children": [],
                                                    "label": "replicate_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.replicate_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.replicate_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 207,
                                    "end_token": 207,
                                    "children": [],
                                    "label": "\"Use Credits for Replicate\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 212,
                                    "end_token": 212,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)"
                }
            ],
            "label": "replicate_credentials = APIKeyCredentials(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 217,
            "end_token": 254,
            "children": [
                {
                    "type": "call",
                    "start_token": 219,
                    "end_token": 254,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 219,
                            "end_token": 219,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 222,
                            "end_token": 254,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 224,
                                    "end_token": 224,
                                    "children": [],
                                    "label": "\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 229,
                                    "end_token": 229,
                                    "children": [],
                                    "label": "\"openai\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 234,
                                    "end_token": 241,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 234,
                                            "end_token": 234,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 236,
                                            "end_token": 240,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 236,
                                                    "end_token": 238,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 236,
                                                            "end_token": 236,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 238,
                                                            "end_token": 238,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 240,
                                                    "end_token": 240,
                                                    "children": [],
                                                    "label": "openai_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.openai_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.openai_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 246,
                                    "end_token": 246,
                                    "children": [],
                                    "label": "\"Use Credits for OpenAI\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 251,
                                    "end_token": 251,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)"
                }
            ],
            "label": "openai_credentials = APIKeyCredentials(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 256,
            "end_token": 293,
            "children": [
                {
                    "type": "call",
                    "start_token": 258,
                    "end_token": 293,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 258,
                            "end_token": 258,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 261,
                            "end_token": 293,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 263,
                                    "end_token": 263,
                                    "children": [],
                                    "label": "\"24e5d942-d9e3-4798-8151-90143ee55629\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 268,
                                    "end_token": 268,
                                    "children": [],
                                    "label": "\"anthropic\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 273,
                                    "end_token": 280,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 273,
                                            "end_token": 273,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 275,
                                            "end_token": 279,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 275,
                                                    "end_token": 277,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 275,
                                                            "end_token": 275,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 277,
                                                            "end_token": 277,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 279,
                                                    "end_token": 279,
                                                    "children": [],
                                                    "label": "anthropic_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.anthropic_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.anthropic_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 285,
                                    "end_token": 285,
                                    "children": [],
                                    "label": "\"Use Credits for Anthropic\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 290,
                                    "end_token": 290,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)"
                }
            ],
            "label": "anthropic_credentials = APIKeyCredentials(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 295,
            "end_token": 332,
            "children": [
                {
                    "type": "call",
                    "start_token": 297,
                    "end_token": 332,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 297,
                            "end_token": 297,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 300,
                            "end_token": 332,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 302,
                                    "end_token": 302,
                                    "children": [],
                                    "label": "\"4ec22295-8f97-4dd1-b42b-2c6957a02545\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 307,
                                    "end_token": 307,
                                    "children": [],
                                    "label": "\"groq\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 312,
                                    "end_token": 319,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 312,
                                            "end_token": 312,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 314,
                                            "end_token": 318,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 314,
                                                    "end_token": 316,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 314,
                                                            "end_token": 314,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 316,
                                                            "end_token": 316,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 318,
                                                    "end_token": 318,
                                                    "children": [],
                                                    "label": "groq_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.groq_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.groq_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 324,
                                    "end_token": 324,
                                    "children": [],
                                    "label": "\"Use Credits for Groq\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 329,
                                    "end_token": 329,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)"
                }
            ],
            "label": "groq_credentials = APIKeyCredentials(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 334,
            "end_token": 371,
            "children": [
                {
                    "type": "call",
                    "start_token": 336,
                    "end_token": 371,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 336,
                            "end_token": 336,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 339,
                            "end_token": 371,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 341,
                                    "end_token": 341,
                                    "children": [],
                                    "label": "\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 346,
                                    "end_token": 346,
                                    "children": [],
                                    "label": "\"d_id\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 351,
                                    "end_token": 358,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 351,
                                            "end_token": 351,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 353,
                                            "end_token": 357,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 353,
                                                    "end_token": 355,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 353,
                                                            "end_token": 353,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 355,
                                                            "end_token": 355,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 357,
                                                    "end_token": 357,
                                                    "children": [],
                                                    "label": "did_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.did_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.did_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 363,
                                    "end_token": 363,
                                    "children": [],
                                    "label": "\"Use Credits for D-ID\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 368,
                                    "end_token": 368,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)"
                }
            ],
            "label": "did_credentials = APIKeyCredentials(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 373,
            "end_token": 410,
            "children": [
                {
                    "type": "call",
                    "start_token": 375,
                    "end_token": 410,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 375,
                            "end_token": 375,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 378,
                            "end_token": 410,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 380,
                                    "end_token": 380,
                                    "children": [],
                                    "label": "\"7f26de70-ba0d-494e-ba76-238e65e7b45f\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 385,
                                    "end_token": 385,
                                    "children": [],
                                    "label": "\"jina\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 390,
                                    "end_token": 397,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 390,
                                            "end_token": 390,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 392,
                                            "end_token": 396,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 392,
                                                    "end_token": 394,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 392,
                                                            "end_token": 392,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 394,
                                                            "end_token": 394,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 396,
                                                    "end_token": 396,
                                                    "children": [],
                                                    "label": "jina_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.jina_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.jina_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 402,
                                    "end_token": 402,
                                    "children": [],
                                    "label": "\"Use Credits for Jina\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 407,
                                    "end_token": 407,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)"
                }
            ],
            "label": "jina_credentials = APIKeyCredentials(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 412,
            "end_token": 449,
            "children": [
                {
                    "type": "call",
                    "start_token": 414,
                    "end_token": 449,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 414,
                            "end_token": 414,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 417,
                            "end_token": 449,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 419,
                                    "end_token": 419,
                                    "children": [],
                                    "label": "\"66f20754-1b81-48e4-91d0-f4f0dd82145f\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 424,
                                    "end_token": 424,
                                    "children": [],
                                    "label": "\"unreal\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 429,
                                    "end_token": 436,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 429,
                                            "end_token": 429,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 431,
                                            "end_token": 435,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 431,
                                                    "end_token": 433,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 431,
                                                            "end_token": 431,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 433,
                                                            "end_token": 433,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 435,
                                                    "end_token": 435,
                                                    "children": [],
                                                    "label": "unreal_speech_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.unreal_speech_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.unreal_speech_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 441,
                                    "end_token": 441,
                                    "children": [],
                                    "label": "\"Use Credits for Unreal\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 446,
                                    "end_token": 446,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)"
                }
            ],
            "label": "unreal_credentials = APIKeyCredentials(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 451,
            "end_token": 488,
            "children": [
                {
                    "type": "call",
                    "start_token": 453,
                    "end_token": 488,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 453,
                            "end_token": 453,
                            "children": [],
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 456,
                            "end_token": 488,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 458,
                                    "end_token": 458,
                                    "children": [],
                                    "label": "\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\""
                                },
                                {
                                    "type": "string",
                                    "start_token": 463,
                                    "end_token": 463,
                                    "children": [],
                                    "label": "\"open_router\""
                                },
                                {
                                    "type": "call",
                                    "start_token": 468,
                                    "end_token": 475,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 468,
                                            "end_token": 468,
                                            "children": [],
                                            "label": "SecretStr"
                                        },
                                        {
                                            "type": "attribute",
                                            "start_token": 470,
                                            "end_token": 474,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 470,
                                                    "end_token": 472,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 470,
                                                            "end_token": 470,
                                                            "children": [],
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 472,
                                                            "end_token": 472,
                                                            "children": [],
                                                            "label": "secrets"
                                                        }
                                                    ],
                                                    "label": "settings.secrets"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 474,
                                                    "end_token": 474,
                                                    "children": [],
                                                    "label": "open_router_api_key"
                                                }
                                            ],
                                            "label": "settings.secrets.open_router_api_key"
                                        }
                                    ],
                                    "label": "SecretStr(settings.secrets.open_router_api_key)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 480,
                                    "end_token": 480,
                                    "children": [],
                                    "label": "\"Use Credits for Open Router\""
                                },
                                {
                                    "type": "none",
                                    "start_token": 485,
                                    "end_token": 485,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)"
                        }
                    ],
                    "label": "APIKeyCredentials(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)"
                }
            ],
            "label": "open_router_credentials = APIKeyCredentials(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)"
        },
        {
            "type": "assignment",
            "start_token": 492,
            "end_token": 526,
            "children": [
                {
                    "type": "list",
                    "start_token": 494,
                    "end_token": 526,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 496,
                            "end_token": 496,
                            "children": [],
                            "label": "revid_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 499,
                            "end_token": 499,
                            "children": [],
                            "label": "ideogram_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 502,
                            "end_token": 502,
                            "children": [],
                            "label": "replicate_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 505,
                            "end_token": 505,
                            "children": [],
                            "label": "openai_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 508,
                            "end_token": 508,
                            "children": [],
                            "label": "anthropic_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 511,
                            "end_token": 511,
                            "children": [],
                            "label": "groq_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 514,
                            "end_token": 514,
                            "children": [],
                            "label": "did_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 517,
                            "end_token": 517,
                            "children": [],
                            "label": "jina_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 520,
                            "end_token": 520,
                            "children": [],
                            "label": "unreal_credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 523,
                            "end_token": 523,
                            "children": [],
                            "label": "open_router_credentials"
                        }
                    ],
                    "label": "[\n    revid_credentials,\n    ideogram_credentials,\n    replicate_credentials,\n    openai_credentials,\n    anthropic_credentials,\n    groq_credentials,\n    did_credentials,\n    jina_credentials,\n    unreal_credentials,\n    open_router_credentials,\n]"
                }
            ],
            "label": "DEFAULT_CREDENTIALS = [\n    revid_credentials,\n    ideogram_credentials,\n    replicate_credentials,\n    openai_credentials,\n    anthropic_credentials,\n    groq_credentials,\n    did_credentials,\n    jina_credentials,\n    unreal_credentials,\n    open_router_credentials,\n]"
        },
        {
            "type": "class_placeholder",
            "name": "IntegrationCredentialsStore",
            "start_line": 110,
            "end_line": 309,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 10,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 2,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "IntegrationCredentialsStore"
                                }
                            ],
                            "label": "class IntegrationCredentialsStore:"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 5,
                            "end_token": 10,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 5,
                                    "end_token": 6,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "children": [],
                                            "label": "property"
                                        }
                                    ],
                                    "label": "@property"
                                },
                                {
                                    "type": "decorator",
                                    "start_token": 8,
                                    "end_token": 9,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 9,
                                            "end_token": 9,
                                            "children": [],
                                            "label": "thread_cached"
                                        }
                                    ],
                                    "label": "@thread_cached"
                                }
                            ],
                            "label": "@property\n    @thread_cached\n"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__init__",
                            "start_line": 111,
                            "end_line": 114,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 27,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 6,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "__init__"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 6,
                                                    "children": [],
                                                    "label": "\n"
                                                }
                                            ],
                                            "label": "def __init__(self):\n"
                                        },
                                        {
                                            "type": "import_from_statement",
                                            "start_token": 7,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "relative_import",
                                                    "start_token": 7,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 8,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "children": [],
                                                                    "label": "backend"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": "data"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "redis"
                                                                }
                                                            ],
                                                            "label": "backend.data.redis"
                                                        }
                                                    ],
                                                    "label": "from backend.data.redis"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 14,
                                                    "end_token": 14,
                                                    "children": [],
                                                    "label": "get_redis"
                                                }
                                            ],
                                            "label": "from backend.data.redis import get_redis"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 17,
                                            "end_token": 26,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 17,
                                                    "end_token": 19,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 17,
                                                            "end_token": 17,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 19,
                                                            "end_token": 19,
                                                            "children": [],
                                                            "label": "locks"
                                                        }
                                                    ],
                                                    "label": "self.locks"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 21,
                                                    "end_token": 26,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 21,
                                                            "end_token": 21,
                                                            "children": [],
                                                            "label": "RedisKeyedMutex"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 22,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 23,
                                                                    "end_token": 25,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 23,
                                                                            "end_token": 23,
                                                                            "children": [],
                                                                            "label": "get_redis"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 24,
                                                                            "end_token": 25,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "get_redis()"
                                                                }
                                                            ],
                                                            "label": "(get_redis())"
                                                        }
                                                    ],
                                                    "label": "RedisKeyedMutex(get_redis())"
                                                }
                                            ],
                                            "label": "self.locks = RedisKeyedMutex(get_redis())"
                                        }
                                    ],
                                    "label": "def __init__(self):\n        from backend.data.redis import get_redis\n\n        self.locks = RedisKeyedMutex(get_redis())\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "db_manager",
                            "start_line": 118,
                            "end_line": 122,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 34,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 34,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "db_manager"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 8,
                                                    "end_token": 34,
                                                    "children": [
                                                        {
                                                            "type": "import_from_statement",
                                                            "start_token": 10,
                                                            "end_token": 17,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 11,
                                                                    "end_token": 15,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "label": "backend"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "label": "executor"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "label": "database"
                                                                        }
                                                                    ],
                                                                    "label": "backend.executor.database"
                                                                },
                                                                {
                                                                    "type": "import_prefix",
                                                                    "start_token": 16,
                                                                    "end_token": 17,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "DatabaseManager"
                                                                        }
                                                                    ],
                                                                    "label": "import DatabaseManager"
                                                                }
                                                            ],
                                                            "label": "from backend.executor.database import DatabaseManager"
                                                        },
                                                        {
                                                            "type": "import_from_statement",
                                                            "start_token": 19,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 20,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 20,
                                                                            "end_token": 20,
                                                                            "label": "backend"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "label": "util"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 24,
                                                                            "end_token": 24,
                                                                            "label": "service"
                                                                        }
                                                                    ],
                                                                    "label": "backend.util.service"
                                                                },
                                                                {
                                                                    "type": "import_prefix",
                                                                    "start_token": 25,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 26,
                                                                            "end_token": 26,
                                                                            "label": "get_service_client"
                                                                        }
                                                                    ],
                                                                    "label": "import get_service_client"
                                                                }
                                                            ],
                                                            "label": "from backend.util.service import get_service_client"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 29,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 30,
                                                                    "end_token": 33,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 30,
                                                                            "end_token": 30,
                                                                            "label": "get_service_client"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 31,
                                                                            "end_token": 33,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 32,
                                                                                    "end_token": 32,
                                                                                    "label": "DatabaseManager"
                                                                                }
                                                                            ],
                                                                            "label": "(DatabaseManager)"
                                                                        }
                                                                    ],
                                                                    "label": "get_service_client(DatabaseManager)"
                                                                }
                                                            ],
                                                            "label": "return get_service_client(DatabaseManager)"
                                                        }
                                                    ],
                                                    "label": ":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)\n"
                                                }
                                            ],
                                            "label": "def db_manager(self) -> \"DatabaseManager\":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)\n"
                                        }
                                    ],
                                    "label": "def db_manager(self) -> \"DatabaseManager\":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "add_creds",
                            "start_line": 124,
                            "end_line": 133,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 72,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 72,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "add_creds"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 6,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 6,
                                                                    "label": ":"
                                                                }
                                                            ],
                                                            "label": "self, user_id:"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 9,
                                                                    "end_token": 9,
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "label": "Credentials"
                                                                }
                                                            ],
                                                            "label": "credentials: Credentials"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, credentials: Credentials)"
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 15,
                                                    "end_token": 15,
                                                    "label": "None"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 17,
                                                    "end_token": 72,
                                                    "children": [
                                                        {
                                                            "type": "with_statement",
                                                            "start_token": 18,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "with_item",
                                                                    "start_token": 19,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 19,
                                                                            "end_token": 21,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "locked_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self.locked_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 22,
                                                                            "end_token": 24,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 22,
                                                                                    "end_token": 22,
                                                                                    "label": "("
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 23,
                                                                                    "end_token": 24,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 23,
                                                                                            "end_token": 23,
                                                                                            "label": "user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_id)"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.locked_user_integrations(user_id)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 27,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 27,
                                                                            "end_token": 38,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 28,
                                                                                    "end_token": 37,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 28,
                                                                                            "end_token": 30,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 28,
                                                                                                    "end_token": 28,
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 30,
                                                                                                    "end_token": 30,
                                                                                                    "label": "get_creds_by_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.get_creds_by_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 31,
                                                                                            "end_token": 37,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 32,
                                                                                                    "end_token": 32,
                                                                                                    "label": "user_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 34,
                                                                                                    "end_token": 36,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 34,
                                                                                                            "end_token": 34,
                                                                                                            "label": "credentials"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 36,
                                                                                                            "end_token": 36,
                                                                                                            "label": "id"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "credentials.id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(user_id, credentials.id)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.get_creds_by_id(user_id, credentials.id)"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 39,
                                                                                    "end_token": 38,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "start_token": 40,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 40,
                                                                                                    "end_token": 40,
                                                                                                    "label": "raise"
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 41,
                                                                                                    "end_token": 50,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 41,
                                                                                                            "end_token": 41,
                                                                                                            "label": "ValueError"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 42,
                                                                                                            "end_token": 50,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "concatenated_string",
                                                                                                                    "start_token": 44,
                                                                                                                    "end_token": 48,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "start_token": 44,
                                                                                                                            "end_token": 44,
                                                                                                                            "label": "f"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "start_token": 46,
                                                                                                                            "end_token": 46,
                                                                                                                            "label": "\n"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )"
                                                                                                }
                                                                                            ],
                                                                                            "label": "raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )"
                                                                                        }
                                                                                    ],
                                                                                    "label": ""
                                                                                }
                                                                            ],
                                                                            "label": "if self.get_creds_by_id(user_id, credentials.id):"
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 52,
                                                                            "end_token": 71,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 52,
                                                                                    "end_token": 71,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 52,
                                                                                            "end_token": 54,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 52,
                                                                                                    "end_token": 52,
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 54,
                                                                                                    "end_token": 54,
                                                                                                    "label": "_set_user_integration_creds"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self._set_user_integration_creds"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 55,
                                                                                            "end_token": 71,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 57,
                                                                                                    "end_token": 57,
                                                                                                    "label": "user_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "list",
                                                                                                    "start_token": 59,
                                                                                                    "end_token": 69,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "list_splat",
                                                                                                            "start_token": 60,
                                                                                                            "end_token": 61,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "start_token": 61,
                                                                                                                    "end_token": 66,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 61,
                                                                                                                            "end_token": 63,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 61,
                                                                                                                                    "end_token": 61,
                                                                                                                                    "label": "self"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 63,
                                                                                                                                    "end_token": 63,
                                                                                                                                    "label": "get_all_creds"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.get_all_creds"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "argument_list",
                                                                                                                            "start_token": 64,
                                                                                                                            "end_token": 66,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 65,
                                                                                                                                    "end_token": 65,
                                                                                                                                    "label": "user_id"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "(user_id)"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "self.get_all_creds(user_id)"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "*self"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 68,
                                                                                                            "end_token": 68,
                                                                                                            "label": "credentials"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "[*self.get_all_creds(user_id), credentials]"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )"
                                                                        }
                                                                    ],
                                                                    "label": ""
                                                                }
                                                            ],
                                                            "label": "with self.locked_user_integrations(user_id):\n"
                                                        }
                                                    ],
                                                    "label": "\n        with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )\n"
                                                }
                                            ],
                                            "label": "def add_creds(self, user_id: str, credentials: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )\n"
                                        }
                                    ],
                                    "label": "def add_creds(self, user_id: str, credentials: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_all_creds",
                            "start_line": 135,
                            "end_line": 158,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 183,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 183,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "get_all_creds"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "user_id: str"
                                                                }
                                                            ],
                                                            "label": "self, user_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 16,
                                                    "end_token": 183,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 17,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 17,
                                                                    "end_token": 17,
                                                                    "children": [],
                                                                    "label": "users_credentials"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 19,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 19,
                                                                            "end_token": 21,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "children": [],
                                                                                    "label": "_get_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self._get_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 24,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 25,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "children": [],
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "children": [],
                                                                                    "label": "credentials"
                                                                                }
                                                                            ],
                                                                            "label": ".credentials"
                                                                        }
                                                                    ],
                                                                    "label": "self._get_user_integrations(user_id).credentials"
                                                                }
                                                            ],
                                                            "label": "users_credentials = self._get_user_integrations(user_id).credentials"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 28,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 28,
                                                                    "end_token": 28,
                                                                    "children": [],
                                                                    "label": "all_credentials"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 30,
                                                                    "end_token": 30,
                                                                    "children": [],
                                                                    "label": "users_credentials"
                                                                }
                                                            ],
                                                            "label": "all_credentials = users_credentials"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 32,
                                                            "end_token": 45,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 32,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 33,
                                                                            "end_token": 37,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 33,
                                                                                    "end_token": 35,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 33,
                                                                                            "end_token": 33,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 35,
                                                                                            "end_token": 35,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 37,
                                                                                    "end_token": 37,
                                                                                    "children": [],
                                                                                    "label": "revid_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.revid_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.revid_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 39,
                                                                    "end_token": 45,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 40,
                                                                            "end_token": 45,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 40,
                                                                                    "end_token": 42,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 40,
                                                                                            "end_token": 40,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 42,
                                                                                            "end_token": 42,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 43,
                                                                                    "end_token": 44,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 44,
                                                                                            "end_token": 44,
                                                                                            "children": [],
                                                                                            "label": "revid_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(revid_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(revid_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(revid_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 47,
                                                            "end_token": 60,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 47,
                                                                    "end_token": 53,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 48,
                                                                            "end_token": 52,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 48,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 48,
                                                                                            "end_token": 48,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 50,
                                                                                            "end_token": 50,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 52,
                                                                                    "end_token": 52,
                                                                                    "children": [],
                                                                                    "label": "ideogram_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.ideogram_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.ideogram_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 54,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 55,
                                                                            "end_token": 60,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 55,
                                                                                    "end_token": 57,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 55,
                                                                                            "end_token": 55,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 57,
                                                                                            "end_token": 57,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 58,
                                                                                    "end_token": 59,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 59,
                                                                                            "end_token": 59,
                                                                                            "children": [],
                                                                                            "label": "ideogram_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(ideogram_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(ideogram_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(ideogram_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 62,
                                                            "end_token": 75,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 62,
                                                                    "end_token": 68,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 63,
                                                                            "end_token": 67,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 63,
                                                                                    "end_token": 65,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 63,
                                                                                            "end_token": 63,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 65,
                                                                                            "end_token": 65,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 67,
                                                                                    "children": [],
                                                                                    "label": "groq_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.groq_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.groq_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 69,
                                                                    "end_token": 75,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 70,
                                                                            "end_token": 75,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 70,
                                                                                    "end_token": 72,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 70,
                                                                                            "end_token": 70,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 72,
                                                                                            "end_token": 72,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 73,
                                                                                    "end_token": 74,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 74,
                                                                                            "end_token": 74,
                                                                                            "children": [],
                                                                                            "label": "groq_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(groq_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(groq_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(groq_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 77,
                                                            "end_token": 90,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 77,
                                                                    "end_token": 83,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 78,
                                                                            "end_token": 82,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 78,
                                                                                    "end_token": 80,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 78,
                                                                                            "end_token": 78,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 80,
                                                                                            "end_token": 80,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 82,
                                                                                    "end_token": 82,
                                                                                    "children": [],
                                                                                    "label": "replicate_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.replicate_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.replicate_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 84,
                                                                    "end_token": 90,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 85,
                                                                            "end_token": 90,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 85,
                                                                                    "end_token": 87,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 85,
                                                                                            "end_token": 85,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 87,
                                                                                            "end_token": 87,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 88,
                                                                                    "end_token": 89,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 89,
                                                                                            "end_token": 89,
                                                                                            "children": [],
                                                                                            "label": "replicate_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(replicate_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(replicate_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(replicate_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 92,
                                                            "end_token": 105,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 92,
                                                                    "end_token": 98,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 93,
                                                                            "end_token": 97,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 93,
                                                                                    "end_token": 95,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 93,
                                                                                            "end_token": 93,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 95,
                                                                                            "end_token": 95,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 97,
                                                                                    "end_token": 97,
                                                                                    "children": [],
                                                                                    "label": "openai_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.openai_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.openai_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 99,
                                                                    "end_token": 105,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 100,
                                                                            "end_token": 105,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 100,
                                                                                    "end_token": 102,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 100,
                                                                                            "end_token": 100,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 102,
                                                                                            "end_token": 102,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 103,
                                                                                    "end_token": 104,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 104,
                                                                                            "end_token": 104,
                                                                                            "children": [],
                                                                                            "label": "openai_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(openai_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(openai_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(openai_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 107,
                                                            "end_token": 120,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 107,
                                                                    "end_token": 113,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 108,
                                                                            "end_token": 112,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 108,
                                                                                    "end_token": 110,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 108,
                                                                                            "end_token": 108,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 110,
                                                                                            "end_token": 110,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 112,
                                                                                    "end_token": 112,
                                                                                    "children": [],
                                                                                    "label": "anthropic_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.anthropic_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.anthropic_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 114,
                                                                    "end_token": 120,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 115,
                                                                            "end_token": 120,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 115,
                                                                                    "end_token": 117,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 115,
                                                                                            "end_token": 115,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 117,
                                                                                            "end_token": 117,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 118,
                                                                                    "end_token": 119,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 119,
                                                                                            "end_token": 119,
                                                                                            "children": [],
                                                                                            "label": "anthropic_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(anthropic_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(anthropic_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(anthropic_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 122,
                                                            "end_token": 135,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 122,
                                                                    "end_token": 128,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 123,
                                                                            "end_token": 127,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 123,
                                                                                    "end_token": 125,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 123,
                                                                                            "end_token": 123,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 125,
                                                                                            "end_token": 125,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 127,
                                                                                    "end_token": 127,
                                                                                    "children": [],
                                                                                    "label": "did_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.did_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.did_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 129,
                                                                    "end_token": 135,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 130,
                                                                            "end_token": 135,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 130,
                                                                                    "end_token": 132,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 130,
                                                                                            "end_token": 130,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 132,
                                                                                            "end_token": 132,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 133,
                                                                                    "end_token": 134,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 134,
                                                                                            "end_token": 134,
                                                                                            "children": [],
                                                                                            "label": "did_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(did_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(did_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(did_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 137,
                                                            "end_token": 150,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 137,
                                                                    "end_token": 143,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 138,
                                                                            "end_token": 142,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 138,
                                                                                    "end_token": 140,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 138,
                                                                                            "end_token": 138,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 140,
                                                                                            "end_token": 140,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 142,
                                                                                    "end_token": 142,
                                                                                    "children": [],
                                                                                    "label": "jina_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.jina_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.jina_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 144,
                                                                    "end_token": 150,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 145,
                                                                            "end_token": 150,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 145,
                                                                                    "end_token": 147,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 145,
                                                                                            "end_token": 145,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 147,
                                                                                            "end_token": 147,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 148,
                                                                                    "end_token": 149,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 149,
                                                                                            "end_token": 149,
                                                                                            "children": [],
                                                                                            "label": "jina_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(jina_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(jina_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(jina_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 152,
                                                            "end_token": 165,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 152,
                                                                    "end_token": 158,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 153,
                                                                            "end_token": 157,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 153,
                                                                                    "end_token": 155,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 153,
                                                                                            "end_token": 153,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 155,
                                                                                            "end_token": 155,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 157,
                                                                                    "end_token": 157,
                                                                                    "children": [],
                                                                                    "label": "unreal_speech_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.unreal_speech_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.unreal_speech_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 159,
                                                                    "end_token": 165,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 160,
                                                                            "end_token": 165,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 160,
                                                                                    "end_token": 162,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 160,
                                                                                            "end_token": 160,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 162,
                                                                                            "end_token": 162,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 163,
                                                                                    "end_token": 164,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 164,
                                                                                            "end_token": 164,
                                                                                            "children": [],
                                                                                            "label": "unreal_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(unreal_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(unreal_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(unreal_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 167,
                                                            "end_token": 180,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 167,
                                                                    "end_token": 173,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 168,
                                                                            "end_token": 172,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 168,
                                                                                    "end_token": 170,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 168,
                                                                                            "end_token": 168,
                                                                                            "children": [],
                                                                                            "label": "settings"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 170,
                                                                                            "end_token": 170,
                                                                                            "children": [],
                                                                                            "label": "secrets"
                                                                                        }
                                                                                    ],
                                                                                    "label": "settings.secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 172,
                                                                                    "end_token": 172,
                                                                                    "children": [],
                                                                                    "label": "open_router_api_key"
                                                                                }
                                                                            ],
                                                                            "label": "settings.secrets.open_router_api_key"
                                                                        }
                                                                    ],
                                                                    "label": "if settings.secrets.open_router_api_key:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 174,
                                                                    "end_token": 180,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 175,
                                                                            "end_token": 180,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 175,
                                                                                    "end_token": 177,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 175,
                                                                                            "end_token": 175,
                                                                                            "children": [],
                                                                                            "label": "all_credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 177,
                                                                                            "end_token": 177,
                                                                                            "children": [],
                                                                                            "label": "append"
                                                                                        }
                                                                                    ],
                                                                                    "label": "all_credentials.append"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 178,
                                                                                    "end_token": 179,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 179,
                                                                                            "end_token": 179,
                                                                                            "children": [],
                                                                                            "label": "open_router_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(open_router_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "all_credentials.append(open_router_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            all_credentials.append(open_router_credentials)"
                                                                }
                                                            ],
                                                            "label": "if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 182,
                                                            "end_token": 183,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 183,
                                                                    "end_token": 183,
                                                                    "children": [],
                                                                    "label": "all_credentials"
                                                                }
                                                            ],
                                                            "label": "return all_credentials"
                                                        }
                                                    ],
                                                    "label": "\n        users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials"
                                                }
                                            ],
                                            "label": "def get_all_creds(self, user_id: str) -> list[Credentials]:\n        users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials"
                                        }
                                    ],
                                    "label": "def get_all_creds(self, user_id: str) -> list[Credentials]:\n        users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_creds_by_id",
                            "start_line": 160,
                            "end_line": 162,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 48,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 48,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "get_creds_by_id"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 4,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "label": "self"
                                                                }
                                                            ],
                                                            "label": "self,"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 9,
                                                                    "end_token": 9,
                                                                    "label": "credentials_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "credentials_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, credentials_id: str)"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 14,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 15,
                                                            "end_token": 15,
                                                            "label": "Credentials"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 17,
                                                            "end_token": 17,
                                                            "label": "None"
                                                        }
                                                    ],
                                                    "label": "> Credentials | None"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 18,
                                                    "end_token": 48,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 20,
                                                            "end_token": 27,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 20,
                                                                    "end_token": 20,
                                                                    "label": "all_credentials"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 22,
                                                                    "end_token": 27,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 22,
                                                                            "end_token": 24,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 22,
                                                                                    "end_token": 22,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 24,
                                                                                    "end_token": 24,
                                                                                    "label": "get_all_creds"
                                                                                }
                                                                            ],
                                                                            "label": "self.get_all_creds"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 25,
                                                                            "end_token": 27,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.get_all_creds(user_id)"
                                                                }
                                                            ],
                                                            "label": "all_credentials = self.get_all_creds(user_id)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 29,
                                                            "end_token": 48,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 30,
                                                                    "end_token": 48,
                                                                    "children": [
                                                                        {
                                                                            "type": "generator_expression",
                                                                            "start_token": 31,
                                                                            "end_token": 45,
                                                                            "children": [
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "start_token": 33,
                                                                                    "end_token": 37,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 33,
                                                                                            "end_token": 33,
                                                                                            "label": "c"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 37,
                                                                                            "end_token": 37,
                                                                                            "label": "all_credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "c for c in all_credentials"
                                                                                },
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 38,
                                                                                    "end_token": 44,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 39,
                                                                                            "end_token": 41,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 39,
                                                                                                    "end_token": 39,
                                                                                                    "label": "c"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 41,
                                                                                                    "end_token": 41,
                                                                                                    "label": "id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "c.id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 44,
                                                                                            "end_token": 44,
                                                                                            "label": "credentials_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "if c.id == credentials_id"
                                                                                }
                                                                            ],
                                                                            "label": "((c for c in all_credentials if c.id == credentials_id)"
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "start_token": 47,
                                                                            "end_token": 47,
                                                                            "label": "None"
                                                                        }
                                                                    ],
                                                                    "label": "next((c for c in all_credentials if c.id == credentials_id), None)"
                                                                }
                                                            ],
                                                            "label": "return next((c for c in all_credentials if c.id == credentials_id), None)"
                                                        }
                                                    ],
                                                    "label": ":\n        all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)"
                                                }
                                            ],
                                            "label": "def get_creds_by_id(self, user_id: str, credentials_id: str) -> Credentials | None:\n        all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)"
                                        }
                                    ],
                                    "label": "def get_creds_by_id(self, user_id: str, credentials_id: str) -> Credentials | None:\n        all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_creds_by_provider",
                            "start_line": 164,
                            "end_line": 166,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 44,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 44,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "get_creds_by_provider"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 9,
                                                                    "end_token": 9,
                                                                    "label": "provider"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "provider: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, provider: str)"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 14,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 15,
                                                            "end_token": 15,
                                                            "label": "list"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 17,
                                                            "end_token": 17,
                                                            "label": "Credentials"
                                                        }
                                                    ],
                                                    "label": "> list[Credentials]"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 19,
                                                    "end_token": 44,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 21,
                                                            "end_token": 28,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 21,
                                                                    "end_token": 21,
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 23,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 23,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "label": "get_all_creds"
                                                                                }
                                                                            ],
                                                                            "label": "self.get_all_creds"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 26,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.get_all_creds(user_id)"
                                                                }
                                                            ],
                                                            "label": "credentials = self.get_all_creds(user_id)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 30,
                                                            "end_token": 44,
                                                            "children": [
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "start_token": 31,
                                                                    "end_token": 44,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 32,
                                                                            "end_token": 32,
                                                                            "label": "c"
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": 33,
                                                                            "end_token": 36,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 34,
                                                                                    "end_token": 34,
                                                                                    "label": "c"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 36,
                                                                                    "end_token": 36,
                                                                                    "label": "credentials"
                                                                                }
                                                                            ],
                                                                            "label": "for c in credentials"
                                                                        },
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": 37,
                                                                            "end_token": 43,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 38,
                                                                                    "end_token": 40,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 38,
                                                                                            "end_token": 38,
                                                                                            "label": "c"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 40,
                                                                                            "end_token": 40,
                                                                                            "label": "provider"
                                                                                        }
                                                                                    ],
                                                                                    "label": "c.provider"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 43,
                                                                                    "label": "provider"
                                                                                }
                                                                            ],
                                                                            "label": "if c.provider == provider"
                                                                        }
                                                                    ],
                                                                    "label": "[c for c in credentials if c.provider == provider]"
                                                                }
                                                            ],
                                                            "label": "return [c for c in credentials if c.provider == provider]"
                                                        }
                                                    ],
                                                    "label": ":\n        credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]"
                                                }
                                            ],
                                            "label": "def get_creds_by_provider(self, user_id: str, provider: str) -> list[Credentials]:\n        credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]"
                                        }
                                    ],
                                    "label": "def get_creds_by_provider(self, user_id: str, provider: str) -> list[Credentials]:\n        credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_authorized_providers",
                            "start_line": 168,
                            "end_line": 170,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 40,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 40,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "get_authorized_providers"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "self, user_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str)"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 10,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 11,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "label": "list"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 12,
                                                                    "end_token": 14,
                                                                    "label": "[str]"
                                                                }
                                                            ],
                                                            "label": "list[str]"
                                                        }
                                                    ],
                                                    "label": "> list[str]"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 15,
                                                    "end_token": 40,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 17,
                                                            "end_token": 24,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 17,
                                                                    "end_token": 17,
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 19,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 19,
                                                                            "end_token": 21,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "get_all_creds"
                                                                                }
                                                                            ],
                                                                            "label": "self.get_all_creds"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 24,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.get_all_creds(user_id)"
                                                                }
                                                            ],
                                                            "label": "credentials = self.get_all_creds(user_id)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 26,
                                                            "end_token": 39,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 27,
                                                                    "end_token": 39,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "label": "list"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 28,
                                                                            "end_token": 39,
                                                                            "children": [
                                                                                {
                                                                                    "type": "set_comprehension",
                                                                                    "start_token": 29,
                                                                                    "end_token": 38,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 31,
                                                                                            "end_token": 33,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 31,
                                                                                                    "end_token": 31,
                                                                                                    "label": "c"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 33,
                                                                                                    "end_token": 33,
                                                                                                    "label": "provider"
                                                                                                }
                                                                                            ],
                                                                                            "label": "c.provider"
                                                                                        },
                                                                                        {
                                                                                            "type": "for_in_clause",
                                                                                            "start_token": 34,
                                                                                            "end_token": 37,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 35,
                                                                                                    "end_token": 35,
                                                                                                    "label": "c"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 37,
                                                                                                    "label": "credentials"
                                                                                                }
                                                                                            ],
                                                                                            "label": "for c in credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "set(c.provider for c in credentials)"
                                                                                }
                                                                            ],
                                                                            "label": "(set(c.provider for c in credentials))"
                                                                        }
                                                                    ],
                                                                    "label": "list(set(c.provider for c in credentials))"
                                                                }
                                                            ],
                                                            "label": "return list(set(c.provider for c in credentials))"
                                                        }
                                                    ],
                                                    "label": ":\n        credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))\n"
                                                }
                                            ],
                                            "label": "def get_authorized_providers(self, user_id: str) -> list[str]:\n        credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))\n"
                                        }
                                    ],
                                    "label": "def get_authorized_providers(self, user_id: str) -> list[str]:\n        credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "update_creds",
                            "start_line": 172,
                            "end_line": 204,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 191,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 191,
                                            "children": [
                                                {
                                                    "type": "dotted_name",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "update_creds"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_default_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "updated: Credentials"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, updated: Credentials)"
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 15,
                                                    "end_token": 15,
                                                    "children": [],
                                                    "label": "None"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 18,
                                                    "end_token": 191,
                                                    "children": [
                                                        {
                                                            "type": "with_statement",
                                                            "start_token": 18,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "with_item",
                                                                    "start_token": 19,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 19,
                                                                            "end_token": 22,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 19,
                                                                                    "end_token": 21,
                                                                                    "children": [],
                                                                                    "label": "self.locked_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self.locked_user_integrations("
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 24,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.locked_user_integrations(user_id)"
                                                                }
                                                            ],
                                                            "label": "with self.locked_user_integrations(user_id):"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 27,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 27,
                                                                    "end_token": 27,
                                                                    "children": [],
                                                                    "label": "current"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 29,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 29,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 29,
                                                                                    "end_token": 30,
                                                                                    "children": [],
                                                                                    "label": "self."
                                                                                }
                                                                            ],
                                                                            "label": "self.get_creds_by_id"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 32,
                                                                            "end_token": 38,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 33,
                                                                                    "end_token": 33,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 35,
                                                                                    "end_token": 37,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 35,
                                                                                            "end_token": 35,
                                                                                            "children": [],
                                                                                            "label": "updated"
                                                                                        }
                                                                                    ],
                                                                                    "label": "updated.id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id, updated.id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.get_creds_by_id(user_id, updated.id)"
                                                                }
                                                            ],
                                                            "label": "current = self.get_creds_by_id(user_id, updated.id)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 40,
                                                            "end_token": 55,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 41,
                                                                    "end_token": 42,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 42,
                                                                            "end_token": 42,
                                                                            "children": [],
                                                                            "label": "current"
                                                                        }
                                                                    ],
                                                                    "label": "not current"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 43,
                                                                    "end_token": 55,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 45,
                                                                            "end_token": 55,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 46,
                                                                                    "end_token": 46,
                                                                                    "children": [],
                                                                                    "label": "ValueError"
                                                                                },
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 47,
                                                                                    "end_token": 55,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 49,
                                                                                            "end_token": 51,
                                                                                            "children": [],
                                                                                            "label": "f\"Credentials with ID {updated.id} \"\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 52,
                                                                                            "end_token": 54,
                                                                                            "children": [],
                                                                                            "label": "f\"for user with ID {user_id} not found\"\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )"
                                                                        }
                                                                    ],
                                                                    "label": ":\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )"
                                                                }
                                                            ],
                                                            "label": "if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 57,
                                                            "end_token": 83,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": 58,
                                                                    "end_token": 67,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 58,
                                                                            "end_token": 60,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 60,
                                                                                    "end_token": 60,
                                                                                    "children": [],
                                                                                    "label": "current"
                                                                                }
                                                                            ],
                                                                            "label": "type(current"
                                                                        },
                                                                        {
                                                                            "type": "not_operator",
                                                                            "start_token": 62,
                                                                            "end_token": 64,
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "start_token": 64,
                                                                                    "end_token": 66,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 66,
                                                                                            "end_token": 66,
                                                                                            "children": [],
                                                                                            "label": "updated"
                                                                                        }
                                                                                    ],
                                                                                    "label": "type(updated"
                                                                                }
                                                                            ],
                                                                            "label": "is not type"
                                                                        }
                                                                    ],
                                                                    "label": "type(current) is not type(updated)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 68,
                                                                    "end_token": 83,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 70,
                                                                            "end_token": 83,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 71,
                                                                                    "end_token": 71,
                                                                                    "children": [],
                                                                                    "label": "TypeError"
                                                                                },
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 72,
                                                                                    "end_token": 83,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 74,
                                                                                            "end_token": 76,
                                                                                            "children": [],
                                                                                            "label": "f\"Can not update credentials with ID {updated.id} \"\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 77,
                                                                                            "end_token": 79,
                                                                                            "children": [],
                                                                                            "label": "f\"from type {type(current)} \"\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 80,
                                                                                            "end_token": 81,
                                                                                            "children": [],
                                                                                            "label": "f\"to type {type(updated)}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )"
                                                                        }
                                                                    ],
                                                                    "label": ":\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )"
                                                                }
                                                            ],
                                                            "label": "if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 86,
                                                            "end_token": 94,
                                                            "children": [],
                                                            "label": "# Ensure no scopes are removed when updating credentials"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 96,
                                                            "end_token": 146,
                                                            "children": [
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": 98,
                                                                    "end_token": 130,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 99,
                                                                            "end_token": 104,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 99,
                                                                                    "end_token": 100,
                                                                                    "children": [],
                                                                                    "label": "isinstance("
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 101,
                                                                                    "end_token": 104,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 101,
                                                                                            "end_token": 101,
                                                                                            "children": [],
                                                                                            "label": "updated"
                                                                                        },
                                                                                        {
                                                                                            "type": "generic_type",
                                                                                            "start_token": 103,
                                                                                            "end_token": 103,
                                                                                            "children": [],
                                                                                            "label": "OAuth2Credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "updated, OAuth2Credentials)"
                                                                                }
                                                                            ],
                                                                            "label": "isinstance(updated, OAuth2Credentials)"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 107,
                                                                            "end_token": 112,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 107,
                                                                                    "end_token": 108,
                                                                                    "children": [],
                                                                                    "label": "isinstance("
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 109,
                                                                                    "end_token": 112,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 109,
                                                                                            "end_token": 109,
                                                                                            "children": [],
                                                                                            "label": "current"
                                                                                        },
                                                                                        {
                                                                                            "type": "generic_type",
                                                                                            "start_token": 111,
                                                                                            "end_token": 111,
                                                                                            "children": [],
                                                                                            "label": "OAuth2Credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "current, OAuth2Credentials)"
                                                                                }
                                                                            ],
                                                                            "label": "isinstance(current, OAuth2Credentials)"
                                                                        },
                                                                        {
                                                                            "type": "not_operator",
                                                                            "start_token": 115,
                                                                            "end_token": 129,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 116,
                                                                                    "end_token": 129,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 123,
                                                                                            "end_token": 123,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dotted_name",
                                                                                                    "start_token": 116,
                                                                                                    "end_token": 121,
                                                                                                    "children": [],
                                                                                                    "label": "set(updated.scopes)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "issuperset"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 124,
                                                                                            "end_token": 128,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 125,
                                                                                                    "end_token": 127,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 125,
                                                                                                            "end_token": 125,
                                                                                                            "children": [],
                                                                                                            "label": "current"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "current.scopes"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(current.scopes)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "set(updated.scopes).issuperset(current.scopes)\n"
                                                                                }
                                                                            ],
                                                                            "label": "not set(updated.scopes).issuperset(current.scopes)\n"
                                                                        }
                                                                    ],
                                                                    "label": "\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            )"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 131,
                                                                    "end_token": 146,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 133,
                                                                            "end_token": 146,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 134,
                                                                                    "end_token": 134,
                                                                                    "children": [],
                                                                                    "label": "ValueError"
                                                                                },
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 135,
                                                                                    "end_token": 146,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 137,
                                                                                            "end_token": 139,
                                                                                            "children": [],
                                                                                            "label": "f\"Can not update credentials with ID {updated.id} \"\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 140,
                                                                                            "end_token": 142,
                                                                                            "children": [],
                                                                                            "label": "f\"and scopes {current.scopes} \"\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 143,
                                                                                            "end_token": 145,
                                                                                            "children": [],
                                                                                            "label": "f\"to more restrictive set of scopes {updated.scopes}\"\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )"
                                                                        }
                                                                    ],
                                                                    "label": ":\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )"
                                                                }
                                                            ],
                                                            "label": "if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 149,
                                                            "end_token": 153,
                                                            "children": [],
                                                            "label": "# Update the credentials\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 154,
                                                            "end_token": 181,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 154,
                                                                    "end_token": 154,
                                                                    "children": [],
                                                                    "label": "updated_credentials_list"
                                                                },
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "start_token": 155,
                                                                    "end_token": 181,
                                                                    "children": [
                                                                        {
                                                                            "type": "conditional_expression",
                                                                            "start_token": 158,
                                                                            "end_token": 169,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 158,
                                                                                    "end_token": 158,
                                                                                    "children": [],
                                                                                    "label": "updated"
                                                                                },
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 160,
                                                                                    "end_token": 168,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 160,
                                                                                            "end_token": 162,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 160,
                                                                                                    "end_token": 160,
                                                                                                    "children": [],
                                                                                                    "label": "c"
                                                                                                }
                                                                                            ],
                                                                                            "label": "c.id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 166,
                                                                                            "end_token": 167,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 166,
                                                                                                    "end_token": 166,
                                                                                                    "children": [],
                                                                                                    "label": "."
                                                                                                }
                                                                                            ],
                                                                                            "label": ".id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "c.id == updated.id else"
                                                                                },
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 169,
                                                                                    "end_token": 169,
                                                                                    "children": [],
                                                                                    "label": "c"
                                                                                }
                                                                            ],
                                                                            "label": "updated if c.id == updated.id else c"
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": 171,
                                                                            "end_token": 179,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 172,
                                                                                    "end_token": 172,
                                                                                    "children": [],
                                                                                    "label": "c"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 174,
                                                                                    "end_token": 179,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 174,
                                                                                            "end_token": 176,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 174,
                                                                                                    "end_token": 174,
                                                                                                    "children": [],
                                                                                                    "label": "self"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.get_all_creds"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 177,
                                                                                            "end_token": 179,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 178,
                                                                                                    "end_token": 178,
                                                                                                    "children": [],
                                                                                                    "label": "user_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(user_id)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.get_all_creds(user_id)"
                                                                                }
                                                                            ],
                                                                            "label": "for c in self.get_all_creds(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "= [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]"
                                                                }
                                                            ],
                                                            "label": "updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 183,
                                                            "end_token": 190,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 183,
                                                                    "end_token": 190,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 183,
                                                                            "end_token": 185,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 183,
                                                                                    "end_token": 184,
                                                                                    "children": [],
                                                                                    "label": "self."
                                                                                }
                                                                            ],
                                                                            "label": "self._set_user_integration_creds"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 186,
                                                                            "end_token": 190,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 187,
                                                                                    "end_token": 187,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 189,
                                                                                    "end_token": 189,
                                                                                    "children": [],
                                                                                    "label": "updated_credentials_list"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id, updated_credentials_list)"
                                                                        }
                                                                    ],
                                                                    "label": "self._set_user_integration_creds(user_id, updated_credentials_list)"
                                                                }
                                                            ],
                                                            "label": "self._set_user_integration_creds(user_id, updated_credentials_list)"
                                                        }
                                                    ],
                                                    "label": "with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)\n"
                                                }
                                            ],
                                            "label": "def update_creds(self, user_id: str, updated: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)\n"
                                        }
                                    ],
                                    "label": "def update_creds(self, user_id: str, updated: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "delete_creds_by_id",
                            "start_line": 206,
                            "end_line": 211,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 59,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 59,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "delete_creds_by_id"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "label": "self"
                                                                }
                                                            ],
                                                            "label": "self, user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "user_id"
                                                                }
                                                            ],
                                                            "label": "user_id: str, credentials_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, credentials_id: str)"
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 15,
                                                    "end_token": 15,
                                                    "label": "None"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 17,
                                                    "end_token": 59,
                                                    "children": [
                                                        {
                                                            "type": "with_statement",
                                                            "start_token": 18,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "with_item",
                                                                    "start_token": 19,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 19,
                                                                            "end_token": 21,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "locked_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self.locked_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 24,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.locked_user_integrations(user_id)"
                                                                }
                                                            ],
                                                            "label": "with self.locked_user_integrations(user_id):"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 27,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 27,
                                                                    "end_token": 27,
                                                                    "label": "filtered_credentials"
                                                                },
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "start_token": 29,
                                                                    "end_token": 49,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 31,
                                                                            "end_token": 31,
                                                                            "label": "c"
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": 32,
                                                                            "end_token": 40,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 33,
                                                                                    "end_token": 33,
                                                                                    "label": "c"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 35,
                                                                                    "end_token": 40,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 35,
                                                                                            "end_token": 37,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 35,
                                                                                                    "end_token": 35,
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 37,
                                                                                                    "label": "get_all_creds"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.get_all_creds"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 38,
                                                                                            "end_token": 40,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 39,
                                                                                                    "end_token": 39,
                                                                                                    "label": "user_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(user_id)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.get_all_creds(user_id)"
                                                                                }
                                                                            ],
                                                                            "label": "for c in self.get_all_creds(user_id)"
                                                                        },
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": 41,
                                                                            "end_token": 47,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 42,
                                                                                    "end_token": 44,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 42,
                                                                                            "end_token": 42,
                                                                                            "label": "c"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 44,
                                                                                            "end_token": 44,
                                                                                            "label": "id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "c.id"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 47,
                                                                                    "end_token": 47,
                                                                                    "label": "credentials_id"
                                                                                }
                                                                            ],
                                                                            "label": "if c.id != credentials_id"
                                                                        }
                                                                    ],
                                                                    "label": "[\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]"
                                                                }
                                                            ],
                                                            "label": "filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 51,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 51,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 51,
                                                                            "end_token": 53,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 51,
                                                                                    "end_token": 51,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 53,
                                                                                    "end_token": 53,
                                                                                    "label": "_set_user_integration_creds"
                                                                                }
                                                                            ],
                                                                            "label": "self._set_user_integration_creds"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 54,
                                                                            "end_token": 58,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 55,
                                                                                    "end_token": 55,
                                                                                    "label": "user_id"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 57,
                                                                                    "end_token": 57,
                                                                                    "label": "filtered_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id, filtered_credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "self._set_user_integration_creds(user_id, filtered_credentials)"
                                                                }
                                                            ],
                                                            "label": "self._set_user_integration_creds(user_id, filtered_credentials)"
                                                        }
                                                    ],
                                                    "label": "\n        with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)\n"
                                                }
                                            ],
                                            "label": "def delete_creds_by_id(self, user_id: str, credentials_id: str) -> None:\n        with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)\n"
                                        }
                                    ],
                                    "label": "def delete_creds_by_id(self, user_id: str, credentials_id: str) -> None:\n        with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "store_state_token",
                            "start_line": 213,
                            "end_line": 234,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 146,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 145,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "store_state_token"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 19,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "provider: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 13,
                                                            "end_token": 18,
                                                            "children": [],
                                                            "label": "scopes: list[str]"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, provider: str, scopes: list[str])"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 24,
                                                    "end_token": 145,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 25,
                                                            "end_token": 32,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 25,
                                                                    "end_token": 25,
                                                                    "children": [],
                                                                    "label": "token"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 27,
                                                                    "end_token": 32,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 27,
                                                                            "end_token": 29,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "children": [],
                                                                                    "label": "secrets"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "children": [],
                                                                                    "label": "token_urlsafe"
                                                                                }
                                                                            ],
                                                                            "label": "secrets.token_urlsafe"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 30,
                                                                            "end_token": 32,
                                                                            "children": [
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 31,
                                                                                    "end_token": 31,
                                                                                    "children": [],
                                                                                    "label": "32"
                                                                                }
                                                                            ],
                                                                            "label": "(32)"
                                                                        }
                                                                    ],
                                                                    "label": "secrets.token_urlsafe(32)"
                                                                }
                                                            ],
                                                            "label": "token = secrets.token_urlsafe(32)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 34,
                                                            "end_token": 50,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 34,
                                                                    "end_token": 34,
                                                                    "children": [],
                                                                    "label": "expires_at"
                                                                },
                                                                {
                                                                    "type": "binary_operator",
                                                                    "start_token": 36,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 36,
                                                                            "end_token": 43,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 36,
                                                                                    "end_token": 42,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 36,
                                                                                            "end_token": 38,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 36,
                                                                                                    "end_token": 36,
                                                                                                    "children": [],
                                                                                                    "label": "datetime"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 38,
                                                                                                    "end_token": 38,
                                                                                                    "children": [],
                                                                                                    "label": "now"
                                                                                                }
                                                                                            ],
                                                                                            "label": "datetime.now"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 42,
                                                                                            "end_token": 42,
                                                                                            "children": [],
                                                                                            "label": "utc"
                                                                                        }
                                                                                    ],
                                                                                    "label": "datetime.now(timezone.utc"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 39,
                                                                                    "end_token": 43,
                                                                                    "children": [],
                                                                                    "label": "(timezone.utc)"
                                                                                }
                                                                            ],
                                                                            "label": "datetime.now(timezone.utc)"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 45,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 45,
                                                                                    "end_token": 45,
                                                                                    "children": [],
                                                                                    "label": "timedelta"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 46,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 48,
                                                                                            "end_token": 49,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 48,
                                                                                                    "end_token": 48,
                                                                                                    "children": [],
                                                                                                    "label": "="
                                                                                                },
                                                                                                {
                                                                                                    "type": "integer",
                                                                                                    "start_token": 49,
                                                                                                    "end_token": 49,
                                                                                                    "children": [],
                                                                                                    "label": "10"
                                                                                                }
                                                                                            ],
                                                                                            "label": "=10"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(minutes=10)"
                                                                                }
                                                                            ],
                                                                            "label": "timedelta(minutes=10)"
                                                                        }
                                                                    ],
                                                                    "label": "datetime.now(timezone.utc) + timedelta(minutes=10)"
                                                                }
                                                            ],
                                                            "label": "expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 53,
                                                            "end_token": 85,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 53,
                                                                    "end_token": 53,
                                                                    "children": [],
                                                                    "label": "state"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 55,
                                                                    "end_token": 85,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 55,
                                                                            "end_token": 55,
                                                                            "children": [],
                                                                            "label": "OAuthState"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 56,
                                                                            "end_token": 85,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 58,
                                                                                    "end_token": 60,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 58,
                                                                                            "end_token": 58,
                                                                                            "children": [],
                                                                                            "label": "token"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 60,
                                                                                            "end_token": 60,
                                                                                            "children": [],
                                                                                            "label": "token"
                                                                                        }
                                                                                    ],
                                                                                    "label": "token=token"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 63,
                                                                                    "end_token": 65,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 63,
                                                                                            "end_token": 63,
                                                                                            "children": [],
                                                                                            "label": "provider"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 65,
                                                                                            "end_token": 65,
                                                                                            "children": [],
                                                                                            "label": "provider"
                                                                                        }
                                                                                    ],
                                                                                    "label": "provider=provider"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 68,
                                                                                    "end_token": 77,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 68,
                                                                                            "end_token": 68,
                                                                                            "children": [],
                                                                                            "label": "expires_at"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 70,
                                                                                            "end_token": 77,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 70,
                                                                                                    "end_token": 70,
                                                                                                    "children": [],
                                                                                                    "label": "int"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 71,
                                                                                                    "end_token": 77,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 72,
                                                                                                            "end_token": 76,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 72,
                                                                                                                    "end_token": 74,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 72,
                                                                                                                            "end_token": 72,
                                                                                                                            "children": [],
                                                                                                                            "label": "expires_at"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 74,
                                                                                                                            "end_token": 74,
                                                                                                                            "children": [],
                                                                                                                            "label": "timestamp"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "expires_at.timestamp"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 75,
                                                                                                                    "end_token": 76,
                                                                                                                    "children": [],
                                                                                                                    "label": "()"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "expires_at.timestamp()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(expires_at.timestamp())"
                                                                                                }
                                                                                            ],
                                                                                            "label": "int(expires_at.timestamp())"
                                                                                        }
                                                                                    ],
                                                                                    "label": "expires_at=int(expires_at.timestamp())"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 80,
                                                                                    "end_token": 82,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 80,
                                                                                            "end_token": 80,
                                                                                            "children": [],
                                                                                            "label": "scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 82,
                                                                                            "end_token": 82,
                                                                                            "children": [],
                                                                                            "label": "scopes"
                                                                                        }
                                                                                    ],
                                                                                    "label": "scopes=scopes"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )"
                                                                }
                                                            ],
                                                            "label": "state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )"
                                                        },
                                                        {
                                                            "type": "with_statement",
                                                            "start_token": 88,
                                                            "end_token": 126,
                                                            "children": [
                                                                {
                                                                    "type": "with_item",
                                                                    "start_token": 88,
                                                                    "end_token": 95,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 89,
                                                                            "end_token": 94,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 89,
                                                                                    "end_token": 91,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 89,
                                                                                            "end_token": 89,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 91,
                                                                                            "end_token": 91,
                                                                                            "children": [],
                                                                                            "label": "locked_user_integrations"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.locked_user_integrations"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 92,
                                                                                    "end_token": 94,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 93,
                                                                                            "end_token": 93,
                                                                                            "children": [],
                                                                                            "label": "user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(user_id)"
                                                                                }
                                                                            ],
                                                                            "label": "self.locked_user_integrations(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "with self.locked_user_integrations(user_id):"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 96,
                                                                    "end_token": 126,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 97,
                                                                            "end_token": 104,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 97,
                                                                                    "end_token": 97,
                                                                                    "children": [],
                                                                                    "label": "user_integrations"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 99,
                                                                                    "end_token": 104,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 99,
                                                                                            "end_token": 101,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 99,
                                                                                                    "end_token": 99,
                                                                                                    "children": [],
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 101,
                                                                                                    "end_token": 101,
                                                                                                    "children": [],
                                                                                                    "label": "_get_user_integrations"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self._get_user_integrations"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 102,
                                                                                            "end_token": 104,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 103,
                                                                                                    "end_token": 103,
                                                                                                    "children": [],
                                                                                                    "label": "user_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(user_id)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self._get_user_integrations(user_id)"
                                                                                }
                                                                            ],
                                                                            "label": "user_integrations = self._get_user_integrations(user_id)"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 106,
                                                                            "end_token": 111,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 106,
                                                                                    "end_token": 106,
                                                                                    "children": [],
                                                                                    "label": "oauth_states"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 108,
                                                                                    "end_token": 110,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 108,
                                                                                            "end_token": 108,
                                                                                            "children": [],
                                                                                            "label": "user_integrations"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 110,
                                                                                            "end_token": 110,
                                                                                            "children": [],
                                                                                            "label": "oauth_states"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_integrations.oauth_states"
                                                                                }
                                                                            ],
                                                                            "label": "oauth_states = user_integrations.oauth_states\n"
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 112,
                                                                            "end_token": 117,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 112,
                                                                                    "end_token": 117,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 112,
                                                                                            "end_token": 114,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 112,
                                                                                                    "end_token": 112,
                                                                                                    "children": [],
                                                                                                    "label": "oauth_states"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 114,
                                                                                                    "end_token": 114,
                                                                                                    "children": [],
                                                                                                    "label": "append"
                                                                                                }
                                                                                            ],
                                                                                            "label": "oauth_states.append"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 115,
                                                                                            "end_token": 117,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 116,
                                                                                                    "end_token": 116,
                                                                                                    "children": [],
                                                                                                    "label": "state"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(state)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "oauth_states.append(state)"
                                                                                }
                                                                            ],
                                                                            "label": "oauth_states.append(state)"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 119,
                                                                            "end_token": 123,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 119,
                                                                                    "end_token": 121,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 119,
                                                                                            "end_token": 119,
                                                                                            "children": [],
                                                                                            "label": "user_integrations"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 121,
                                                                                            "end_token": 121,
                                                                                            "children": [],
                                                                                            "label": "oauth_states"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_integrations.oauth_states"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 123,
                                                                                    "end_token": 123,
                                                                                    "children": [],
                                                                                    "label": "oauth_states"
                                                                                }
                                                                            ],
                                                                            "label": "user_integrations.oauth_states = oauth_states"
                                                                        }
                                                                    ],
                                                                    "label": "\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self"
                                                                }
                                                            ],
                                                            "label": "with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 126,
                                                            "end_token": 141,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 126,
                                                                    "end_token": 130,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 126,
                                                                            "end_token": 128,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 126,
                                                                                    "end_token": 126,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 128,
                                                                                    "end_token": 128,
                                                                                    "children": [],
                                                                                    "label": "db_manager"
                                                                                }
                                                                            ],
                                                                            "label": "self.db_manager"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 130,
                                                                            "end_token": 130,
                                                                            "children": [],
                                                                            "label": "update_user_integrations"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_manager.update_user_integrations"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 131,
                                                                    "end_token": 141,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 133,
                                                                            "end_token": 135,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 133,
                                                                                    "end_token": 133,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 135,
                                                                                    "end_token": 135,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "user_id=user_id"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 137,
                                                                            "end_token": 139,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 137,
                                                                                    "end_token": 137,
                                                                                    "children": [],
                                                                                    "label": "data"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 139,
                                                                                    "end_token": 139,
                                                                                    "children": [],
                                                                                    "label": "user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "data=user_integrations"
                                                                        }
                                                                    ],
                                                                    "label": "(\n                user_id=user_id, data=user_integrations\n            )"
                                                                }
                                                            ],
                                                            "label": "self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 144,
                                                            "end_token": 145,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 145,
                                                                    "end_token": 145,
                                                                    "children": [],
                                                                    "label": "token"
                                                                }
                                                            ],
                                                            "label": "return token"
                                                        }
                                                    ],
                                                    "label": "\n        token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token"
                                                }
                                            ],
                                            "label": "def store_state_token(self, user_id: str, provider: str, scopes: list[str]) -> str:\n        token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token"
                                        }
                                    ],
                                    "label": "def store_state_token(self, user_id: str, provider: str, scopes: list[str]) -> str:\n        token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_any_valid_scopes_from_state_token",
                            "start_line": 236,
                            "end_line": 264,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 120,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 120,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "get_any_valid_scopes_from_state_token"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 8,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 8,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 8,
                                                                            "end_token": 8,
                                                                            "label": "str"
                                                                        }
                                                                    ],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "self, user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 10,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "label": "token"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 11,
                                                                    "end_token": 12,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "label": "str"
                                                                        }
                                                                    ],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "token: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 14,
                                                            "end_token": 16,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "provider"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 15,
                                                                    "end_token": 16,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 16,
                                                                            "end_token": 16,
                                                                            "label": "str"
                                                                        }
                                                                    ],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "provider: str"
                                                        }
                                                    ],
                                                    "label": "(\n        self, user_id: str, token: str, provider: str\n    )"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 20,
                                                    "end_token": 24,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 21,
                                                            "end_token": 21,
                                                            "label": "list"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 23,
                                                            "end_token": 23,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "str"
                                                        }
                                                    ],
                                                    "label": "> list[str]"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 27,
                                                    "end_token": 29,
                                                    "children": [
                                                        {
                                                            "type": "string_content",
                                                            "start_token": 28,
                                                            "end_token": 28,
                                                            "label": "\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \""
                                                        }
                                                    ],
                                                    "label": "\"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\""
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 30,
                                                    "end_token": 120,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 31,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 31,
                                                                    "end_token": 31,
                                                                    "label": "user_integrations"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 33,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 33,
                                                                            "end_token": 35,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 33,
                                                                                    "end_token": 33,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 35,
                                                                                    "end_token": 35,
                                                                                    "label": "_get_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self._get_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 36,
                                                                            "end_token": 38,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 37,
                                                                                    "end_token": 37,
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self._get_user_integrations(user_id)"
                                                                }
                                                            ],
                                                            "label": "user_integrations = self._get_user_integrations(user_id)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 40,
                                                            "end_token": 45,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 40,
                                                                    "end_token": 40,
                                                                    "label": "oauth_states"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 42,
                                                                    "end_token": 44,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 42,
                                                                            "end_token": 42,
                                                                            "label": "user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 44,
                                                                            "end_token": 44,
                                                                            "label": "oauth_states"
                                                                        }
                                                                    ],
                                                                    "label": "user_integrations.oauth_states"
                                                                }
                                                            ],
                                                            "label": "oauth_states = user_integrations.oauth_states\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 47,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 47,
                                                                    "end_token": 47,
                                                                    "label": "now"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 49,
                                                                    "end_token": 56,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 49,
                                                                            "end_token": 51,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 49,
                                                                                    "end_token": 49,
                                                                                    "label": "datetime"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 51,
                                                                                    "end_token": 51,
                                                                                    "label": "now"
                                                                                }
                                                                            ],
                                                                            "label": "datetime.now"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 53,
                                                                            "end_token": 56,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 53,
                                                                                    "end_token": 55,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 53,
                                                                                            "end_token": 53,
                                                                                            "label": "timezone"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 55,
                                                                                            "end_token": 55,
                                                                                            "label": "utc"
                                                                                        }
                                                                                    ],
                                                                                    "label": "timezone.utc"
                                                                                }
                                                                            ],
                                                                            "label": "timezone.utc)"
                                                                        }
                                                                    ],
                                                                    "label": "datetime.now(timezone.utc)"
                                                                }
                                                            ],
                                                            "label": "now = datetime.now(timezone.utc)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 58,
                                                            "end_token": 105,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 58,
                                                                    "end_token": 58,
                                                                    "label": "valid_state"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 60,
                                                                    "end_token": 105,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 60,
                                                                            "end_token": 60,
                                                                            "label": "next"
                                                                        },
                                                                        {
                                                                            "type": "generator_expression",
                                                                            "start_token": 62,
                                                                            "end_token": 99,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 65,
                                                                                    "end_token": 65,
                                                                                    "label": "state"
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "start_token": 67,
                                                                                    "end_token": 70,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 68,
                                                                                            "end_token": 68,
                                                                                            "label": "state"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 70,
                                                                                            "end_token": 70,
                                                                                            "label": "oauth_states"
                                                                                        }
                                                                                    ],
                                                                                    "label": "for state in oauth_states"
                                                                                },
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "start_token": 72,
                                                                                    "end_token": 98,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "start_token": 72,
                                                                                            "end_token": 78,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 73,
                                                                                                    "end_token": 75,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 73,
                                                                                                            "end_token": 73,
                                                                                                            "label": "state"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 75,
                                                                                                            "end_token": 75,
                                                                                                            "label": "token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "state.token"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 78,
                                                                                                    "end_token": 78,
                                                                                                    "label": "token"
                                                                                                }
                                                                                            ],
                                                                                            "label": "if state.token == token"
                                                                                        },
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "start_token": 80,
                                                                                            "end_token": 86,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 81,
                                                                                                    "end_token": 83,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 81,
                                                                                                            "end_token": 81,
                                                                                                            "label": "state"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 83,
                                                                                                            "end_token": 83,
                                                                                                            "label": "provider"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "state.provider"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 86,
                                                                                                    "end_token": 86,
                                                                                                    "label": "provider"
                                                                                                }
                                                                                            ],
                                                                                            "label": "and state.provider == provider"
                                                                                        },
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "start_token": 88,
                                                                                            "end_token": 98,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 89,
                                                                                                    "end_token": 91,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 89,
                                                                                                            "end_token": 89,
                                                                                                            "label": "state"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 91,
                                                                                                            "end_token": 91,
                                                                                                            "label": "expires_at"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "state.expires_at"
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 93,
                                                                                                    "end_token": 97,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 93,
                                                                                                            "end_token": 95,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 93,
                                                                                                                    "end_token": 93,
                                                                                                                    "label": "now"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 95,
                                                                                                                    "end_token": 95,
                                                                                                                    "label": "timestamp"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "now.timestamp"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "now.timestamp()"
                                                                                                }
                                                                                            ],
                                                                                            "label": "and state.expires_at > now.timestamp()\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n"
                                                                                }
                                                                            ],
                                                                            "label": "\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            )"
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "start_token": 102,
                                                                            "end_token": 102,
                                                                            "label": "None"
                                                                        }
                                                                    ],
                                                                    "label": "next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )"
                                                                }
                                                            ],
                                                            "label": "valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 108,
                                                            "end_token": 115,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 108,
                                                                    "end_token": 110,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 109,
                                                                            "end_token": 109,
                                                                            "label": "valid_state"
                                                                        }
                                                                    ],
                                                                    "label": "if valid_state:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 111,
                                                                    "end_token": 115,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 112,
                                                                            "end_token": 115,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 113,
                                                                                    "end_token": 115,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 113,
                                                                                            "end_token": 113,
                                                                                            "label": "valid_state"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 115,
                                                                                            "end_token": 115,
                                                                                            "label": "scopes"
                                                                                        }
                                                                                    ],
                                                                                    "label": "valid_state.scopes"
                                                                                }
                                                                            ],
                                                                            "label": "return valid_state.scopes"
                                                                        }
                                                                    ],
                                                                    "label": "\n            return valid_state.scopes"
                                                                }
                                                            ],
                                                            "label": "if valid_state:\n            return valid_state.scopes"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 118,
                                                            "end_token": 120,
                                                            "children": [
                                                                {
                                                                    "type": "list",
                                                                    "start_token": 119,
                                                                    "end_token": 120,
                                                                    "children": [],
                                                                    "label": "[]"
                                                                }
                                                            ],
                                                            "label": "return []"
                                                        }
                                                    ],
                                                    "label": "\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []"
                                                }
                                            ],
                                            "label": "def get_any_valid_scopes_from_state_token(\n        self, user_id: str, token: str, provider: str\n    ) -> list[str]:\n        \"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []"
                                        }
                                    ],
                                    "label": "def get_any_valid_scopes_from_state_token(\n        self, user_id: str, token: str, provider: str\n    ) -> list[str]:\n        \"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "verify_state_token",
                            "start_line": 266,
                            "end_line": 290,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 148,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 147,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "verify_state_token"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 16,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "token: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 13,
                                                            "end_token": 15,
                                                            "children": [],
                                                            "label": "provider: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, token: str, provider: str)"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 18,
                                                    "end_token": 19,
                                                    "children": [],
                                                    "label": "> bool"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 20,
                                                    "end_token": 147,
                                                    "children": [
                                                        {
                                                            "type": "with_statement",
                                                            "start_token": 22,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "with_item",
                                                                    "start_token": 23,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 23,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "children": [],
                                                                                    "label": "locked_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self.locked_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 26,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self.locked_user_integrations(user_id)"
                                                                }
                                                            ],
                                                            "label": "with self.locked_user_integrations(user_id):\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 31,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 31,
                                                                    "end_token": 31,
                                                                    "children": [],
                                                                    "label": "user_integrations"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 33,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 33,
                                                                            "end_token": 35,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 33,
                                                                                    "end_token": 33,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 35,
                                                                                    "end_token": 35,
                                                                                    "children": [],
                                                                                    "label": "_get_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self._get_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 36,
                                                                            "end_token": 38,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 37,
                                                                                    "end_token": 37,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self._get_user_integrations(user_id)"
                                                                }
                                                            ],
                                                            "label": "user_integrations = self._get_user_integrations(user_id)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 40,
                                                            "end_token": 45,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 40,
                                                                    "end_token": 40,
                                                                    "children": [],
                                                                    "label": "oauth_states"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 42,
                                                                    "end_token": 44,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 42,
                                                                            "end_token": 42,
                                                                            "children": [],
                                                                            "label": "user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 44,
                                                                            "end_token": 44,
                                                                            "children": [],
                                                                            "label": "oauth_states"
                                                                        }
                                                                    ],
                                                                    "label": "user_integrations.oauth_states"
                                                                }
                                                            ],
                                                            "label": "oauth_states = user_integrations.oauth_states\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 47,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 47,
                                                                    "end_token": 47,
                                                                    "children": [],
                                                                    "label": "now"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 49,
                                                                    "end_token": 56,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 49,
                                                                            "end_token": 51,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 49,
                                                                                    "end_token": 49,
                                                                                    "children": [],
                                                                                    "label": "datetime"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 51,
                                                                                    "end_token": 51,
                                                                                    "children": [],
                                                                                    "label": "now"
                                                                                }
                                                                            ],
                                                                            "label": "datetime.now"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 54,
                                                                            "end_token": 55,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 54,
                                                                                    "end_token": 54,
                                                                                    "children": [],
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 55,
                                                                                    "end_token": 55,
                                                                                    "children": [],
                                                                                    "label": "utc"
                                                                                }
                                                                            ],
                                                                            "label": ".utc"
                                                                        }
                                                                    ],
                                                                    "label": "datetime.now(timezone.utc)"
                                                                }
                                                            ],
                                                            "label": "now = datetime.now(timezone.utc)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 58,
                                                            "end_token": 105,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 58,
                                                                    "end_token": 58,
                                                                    "children": [],
                                                                    "label": "valid_state"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 60,
                                                                    "end_token": 105,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 62,
                                                                            "end_token": 99,
                                                                            "children": [
                                                                                {
                                                                                    "type": "generator_expression",
                                                                                    "start_token": 63,
                                                                                    "end_token": 99,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 65,
                                                                                            "end_token": 65,
                                                                                            "children": [],
                                                                                            "label": "state"
                                                                                        },
                                                                                        {
                                                                                            "type": "for_in_clause",
                                                                                            "start_token": 67,
                                                                                            "end_token": 70,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 68,
                                                                                                    "end_token": 68,
                                                                                                    "children": [],
                                                                                                    "label": "state"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 70,
                                                                                                    "end_token": 70,
                                                                                                    "children": [],
                                                                                                    "label": "oauth_states"
                                                                                                }
                                                                                            ],
                                                                                            "label": "for state in oauth_states"
                                                                                        },
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "start_token": 72,
                                                                                            "end_token": 93,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "start_token": 73,
                                                                                                    "end_token": 78,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 73,
                                                                                                            "end_token": 75,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 73,
                                                                                                                    "end_token": 73,
                                                                                                                    "children": [],
                                                                                                                    "label": "state"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 75,
                                                                                                                    "end_token": 75,
                                                                                                                    "children": [],
                                                                                                                    "label": "token"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "state.token"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 78,
                                                                                                            "end_token": 78,
                                                                                                            "children": [],
                                                                                                            "label": "token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "state.token == token"
                                                                                                },
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "start_token": 80,
                                                                                                    "end_token": 93,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "start_token": 81,
                                                                                                            "end_token": 86,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 81,
                                                                                                                    "end_token": 83,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 81,
                                                                                                                            "end_token": 81,
                                                                                                                            "children": [],
                                                                                                                            "label": "state"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 83,
                                                                                                                            "end_token": 83,
                                                                                                                            "children": [],
                                                                                                                            "label": "provider"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "state.provider"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 86,
                                                                                                                    "end_token": 86,
                                                                                                                    "children": [],
                                                                                                                    "label": "provider"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "state.provider == provider"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "start_token": 89,
                                                                                                            "end_token": 93,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 89,
                                                                                                                    "end_token": 91,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 89,
                                                                                                                            "end_token": 89,
                                                                                                                            "children": [],
                                                                                                                            "label": "state"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 91,
                                                                                                                            "end_token": 91,
                                                                                                                            "children": [],
                                                                                                                            "label": "expires_at"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "state.expires_at"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "start_token": 93,
                                                                                                                    "end_token": 97,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 93,
                                                                                                                            "end_token": 94,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 93,
                                                                                                                                    "end_token": 93,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "now"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 94,
                                                                                                                                    "end_token": 94,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "."
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "now."
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "now.timestamp()"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "state.expires_at > now"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "and state.provider == provider\n                    and state.expires_at > now"
                                                                                                }
                                                                                            ],
                                                                                            "label": "if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                )"
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "start_token": 102,
                                                                            "end_token": 102,
                                                                            "children": [],
                                                                            "label": "None"
                                                                        }
                                                                    ],
                                                                    "label": "next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )"
                                                                }
                                                            ],
                                                            "label": "valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 108,
                                                            "end_token": 144,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 109,
                                                                    "end_token": 109,
                                                                    "children": [],
                                                                    "label": "valid_state"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 110,
                                                                    "end_token": 144,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 118,
                                                                            "end_token": 123,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 118,
                                                                                    "end_token": 123,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 118,
                                                                                            "end_token": 120,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 118,
                                                                                                    "end_token": 118,
                                                                                                    "children": [],
                                                                                                    "label": "oauth_states"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 120,
                                                                                                    "end_token": 120,
                                                                                                    "children": [],
                                                                                                    "label": "remove"
                                                                                                }
                                                                                            ],
                                                                                            "label": "oauth_states.remove"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 122,
                                                                                            "end_token": 122,
                                                                                            "children": [],
                                                                                            "label": "valid_state"
                                                                                        }
                                                                                    ],
                                                                                    "label": "oauth_states.remove(valid_state)"
                                                                                }
                                                                            ],
                                                                            "label": "oauth_states.remove(valid_state)"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 125,
                                                                            "end_token": 130,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 125,
                                                                                    "end_token": 127,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 125,
                                                                                            "end_token": 125,
                                                                                            "children": [],
                                                                                            "label": "user_integrations"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 127,
                                                                                            "end_token": 127,
                                                                                            "children": [],
                                                                                            "label": "oauth_states"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_integrations.oauth_states"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 129,
                                                                                    "end_token": 129,
                                                                                    "children": [],
                                                                                    "label": "oauth_states"
                                                                                }
                                                                            ],
                                                                            "label": "user_integrations.oauth_states = oauth_states\n"
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 131,
                                                                            "end_token": 140,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 131,
                                                                                    "end_token": 140,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 131,
                                                                                            "end_token": 135,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 131,
                                                                                                    "end_token": 133,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 131,
                                                                                                            "end_token": 131,
                                                                                                            "children": [],
                                                                                                            "label": "self"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 133,
                                                                                                            "end_token": 133,
                                                                                                            "children": [],
                                                                                                            "label": "db_manager"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "self.db_manager"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 135,
                                                                                                    "end_token": 135,
                                                                                                    "children": [],
                                                                                                    "label": "update_user_integrations"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.db_manager.update_user_integrations"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 136,
                                                                                            "end_token": 139,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 137,
                                                                                                    "end_token": 137,
                                                                                                    "children": [],
                                                                                                    "label": "user_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 139,
                                                                                                    "end_token": 139,
                                                                                                    "children": [],
                                                                                                    "label": "user_integrations"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(user_id, user_integrations"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.db_manager.update_user_integrations(user_id, user_integrations)"
                                                                                }
                                                                            ],
                                                                            "label": "self.db_manager.update_user_integrations(user_id, user_integrations)"
                                                                        },
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 142,
                                                                            "end_token": 143,
                                                                            "children": [
                                                                                {
                                                                                    "type": "true",
                                                                                    "start_token": 143,
                                                                                    "end_token": 143,
                                                                                    "children": [],
                                                                                    "label": "True"
                                                                                }
                                                                            ],
                                                                            "label": "return True"
                                                                        }
                                                                    ],
                                                                    "label": ":\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n"
                                                                }
                                                            ],
                                                            "label": "if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 146,
                                                            "end_token": 147,
                                                            "children": [
                                                                {
                                                                    "type": "false",
                                                                    "start_token": 147,
                                                                    "end_token": 147,
                                                                    "children": [],
                                                                    "label": "False"
                                                                }
                                                            ],
                                                            "label": "return False"
                                                        }
                                                    ],
                                                    "label": ":\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False"
                                                }
                                            ],
                                            "label": "def verify_state_token(self, user_id: str, token: str, provider: str) -> bool:\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False"
                                        }
                                    ],
                                    "label": "def verify_state_token(self, user_id: str, token: str, provider: str) -> bool:\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_set_user_integration_creds",
                            "start_line": 292,
                            "end_line": 299,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 70,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 70,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "_set_user_integration_creds"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 8,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "self, user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 6,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 6,
                                                                    "end_token": 6,
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "generic_type",
                                                                    "start_token": 12,
                                                                    "end_token": 15,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "label": "list"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 14,
                                                                            "end_token": 14,
                                                                            "label": "Credentials"
                                                                        }
                                                                    ],
                                                                    "label": "list[Credentials]"
                                                                }
                                                            ],
                                                            "label": "user_id: str, credentials: list[Credentials]"
                                                        }
                                                    ],
                                                    "label": "(\n        self, user_id: str, credentials: list[Credentials]\n    )"
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 19,
                                                    "end_token": 20,
                                                    "label": "> None"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 21,
                                                    "end_token": 70,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 23,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "label": "integrations"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 25,
                                                                    "end_token": 30,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 25,
                                                                            "end_token": 27,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "label": "_get_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self._get_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 28,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "label": "user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self._get_user_integrations(user_id)"
                                                                }
                                                            ],
                                                            "label": "integrations = self._get_user_integrations(user_id)"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 32,
                                                            "end_token": 38,
                                                            "label": "# Remove default credentials from the list"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 40,
                                                            "end_token": 53,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 40,
                                                                    "end_token": 40,
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "start_token": 42,
                                                                    "end_token": 53,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 43,
                                                                            "end_token": 43,
                                                                            "label": "c"
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": 44,
                                                                            "end_token": 47,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 45,
                                                                                    "end_token": 45,
                                                                                    "label": "c"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 47,
                                                                                    "end_token": 47,
                                                                                    "label": "credentials"
                                                                                }
                                                                            ],
                                                                            "label": "for c in credentials"
                                                                        },
                                                                        {
                                                                            "type": "boolean_operator",
                                                                            "start_token": 48,
                                                                            "end_token": 52,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 49,
                                                                                    "end_token": 49,
                                                                                    "label": "c"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 51,
                                                                                    "end_token": 51,
                                                                                    "label": "in"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 52,
                                                                                    "end_token": 52,
                                                                                    "label": "DEFAULT_CREDENTIALS"
                                                                                }
                                                                            ],
                                                                            "label": "if c not in DEFAULT_CREDENTIALS"
                                                                        }
                                                                    ],
                                                                    "label": "[c for c in credentials if c not in DEFAULT_CREDENTIALS]"
                                                                }
                                                            ],
                                                            "label": "credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 55,
                                                            "end_token": 59,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 55,
                                                                    "end_token": 57,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 55,
                                                                            "end_token": 55,
                                                                            "label": "integrations"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 57,
                                                                            "end_token": 57,
                                                                            "label": "credentials"
                                                                        }
                                                                    ],
                                                                    "label": "integrations.credentials"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 59,
                                                                    "end_token": 59,
                                                                    "label": "credentials"
                                                                }
                                                            ],
                                                            "label": "integrations.credentials = credentials"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 61,
                                                            "end_token": 70,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 61,
                                                                    "end_token": 65,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 61,
                                                                            "end_token": 63,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 61,
                                                                                    "end_token": 61,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "label": "db_manager"
                                                                                }
                                                                            ],
                                                                            "label": "self.db_manager"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 65,
                                                                            "end_token": 65,
                                                                            "label": "update_user_integrations"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_manager.update_user_integrations"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 66,
                                                                    "end_token": 70,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 67,
                                                                            "end_token": 67,
                                                                            "label": "user_id"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 69,
                                                                            "end_token": 69,
                                                                            "label": "integrations"
                                                                        }
                                                                    ],
                                                                    "label": "(user_id, integrations)"
                                                                }
                                                            ],
                                                            "label": "self.db_manager.update_user_integrations(user_id, integrations)"
                                                        }
                                                    ],
                                                    "label": ":\n        integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)"
                                                }
                                            ],
                                            "label": "def _set_user_integration_creds(\n        self, user_id: str, credentials: list[Credentials]\n    ) -> None:\n        integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)"
                                        }
                                    ],
                                    "label": "def _set_user_integration_creds(\n        self, user_id: str, credentials: list[Credentials]\n    ) -> None:\n        integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_get_user_integrations",
                            "start_line": 301,
                            "end_line": 305,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 33,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 33,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_get_user_integrations"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "self, user_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str)"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 10,
                                                    "end_token": 11,
                                                    "children": [],
                                                    "label": "> UserIntegrations"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 13,
                                                    "end_token": 33,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 14,
                                                            "end_token": 28,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "children": [],
                                                                    "label": "integrations"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 16,
                                                                    "end_token": 16,
                                                                    "children": [],
                                                                    "label": "UserIntegrations"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 18,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 18,
                                                                            "end_token": 22,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 18,
                                                                                    "end_token": 20,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 18,
                                                                                            "end_token": 18,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 20,
                                                                                            "end_token": 20,
                                                                                            "children": [],
                                                                                            "label": "db_manager"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.db_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 22,
                                                                                    "end_token": 22,
                                                                                    "children": [],
                                                                                    "label": "get_user_integrations"
                                                                                }
                                                                            ],
                                                                            "label": "self.db_manager.get_user_integrations"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 23,
                                                                            "end_token": 27,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 25,
                                                                                    "end_token": 27,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 25,
                                                                                            "end_token": 25,
                                                                                            "children": [],
                                                                                            "label": "user_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 27,
                                                                                            "end_token": 27,
                                                                                            "children": [],
                                                                                            "label": "user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_id=user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            user_id=user_id"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_manager.get_user_integrations(\n            user_id=user_id\n"
                                                                }
                                                            ],
                                                            "label": "integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 31,
                                                            "end_token": 32,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 32,
                                                                    "end_token": 32,
                                                                    "children": [],
                                                                    "label": "integrations"
                                                                }
                                                            ],
                                                            "label": "return integrations"
                                                        }
                                                    ],
                                                    "label": "\n        integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations\n"
                                                }
                                            ],
                                            "label": "def _get_user_integrations(self, user_id: str) -> UserIntegrations:\n        integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations\n"
                                        }
                                    ],
                                    "label": "def _get_user_integrations(self, user_id: str) -> UserIntegrations:\n        integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "locked_user_integrations",
                            "start_line": 307,
                            "end_line": 309,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 29,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 28,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "locked_user_integrations"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "self, user_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 10,
                                                    "end_token": 28,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 11,
                                                            "end_token": 18,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "children": [],
                                                                    "label": "key"
                                                                },
                                                                {
                                                                    "type": "tuple",
                                                                    "start_token": 13,
                                                                    "end_token": 18,
                                                                    "children": [
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 14,
                                                                            "end_token": 15,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 15,
                                                                                    "end_token": 15,
                                                                                    "children": [],
                                                                                    "label": "\"user:{user_id}\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"user:{user_id}\""
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "children": [],
                                                                            "label": "\"integrations\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"user:{user_id}\", \"integrations\")"
                                                                }
                                                            ],
                                                            "label": "key = (f\"user:{user_id}\", \"integrations\")"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 20,
                                                            "end_token": 28,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 21,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 21,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 21,
                                                                                    "end_token": 23,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 21,
                                                                                            "end_token": 21,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 23,
                                                                                            "end_token": 23,
                                                                                            "children": [],
                                                                                            "label": "locks"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.locks"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "children": [],
                                                                                    "label": "locked"
                                                                                }
                                                                            ],
                                                                            "label": "self.locks.locked"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 26,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "children": [],
                                                                                    "label": "key"
                                                                                }
                                                                            ],
                                                                            "label": "(key)"
                                                                        }
                                                                    ],
                                                                    "label": "self.locks.locked(key)"
                                                                }
                                                            ],
                                                            "label": "return self.locks.locked(key)"
                                                        }
                                                    ],
                                                    "label": "\n        key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)"
                                                }
                                            ],
                                            "label": "def locked_user_integrations(self, user_id: str):\n        key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)"
                                        }
                                    ],
                                    "label": "def locked_user_integrations(self, user_id: str):\n        key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)\n"
                                }
                            ]
                        }
                    ],
                    "label": "class IntegrationCredentialsStore:\n\n    @property\n    @thread_cached\n"
                }
            ]
        }
    ],
    "label": "import secrets\nfrom datetime import datetime, timedelta, timezone\nfrom typing import TYPE_CHECKING\n\nfrom pydantic import SecretStr\n\nif TYPE_CHECKING:\n    from backend.executor.database import DatabaseManager\n\nfrom autogpt_libs.utils.cache import thread_cached\nfrom autogpt_libs.utils.synchronize import RedisKeyedMutex\n\nfrom backend.data.model import (\n    APIKeyCredentials,\n    Credentials,\n    OAuth2Credentials,\n    OAuthState,\n    UserIntegrations,\n)\nfrom backend.util.settings import Settings\n\nsettings = Settings()\n\nrevid_credentials = APIKeyCredentials(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)\nideogram_credentials = APIKeyCredentials(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)\nreplicate_credentials = APIKeyCredentials(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)\nopenai_credentials = APIKeyCredentials(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)\nanthropic_credentials = APIKeyCredentials(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)\ngroq_credentials = APIKeyCredentials(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)\ndid_credentials = APIKeyCredentials(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)\njina_credentials = APIKeyCredentials(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)\nunreal_credentials = APIKeyCredentials(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)\nopen_router_credentials = APIKeyCredentials(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)\n\n\nDEFAULT_CREDENTIALS = [\n    revid_credentials,\n    ideogram_credentials,\n    replicate_credentials,\n    openai_credentials,\n    anthropic_credentials,\n    groq_credentials,\n    did_credentials,\n    jina_credentials,\n    unreal_credentials,\n    open_router_credentials,\n]"
}
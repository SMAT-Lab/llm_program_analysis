{
    "type": "module",
    "start_token": 0,
    "end_token": 477,
    "children": [
        {
            "type": "import_statement",
            "start_token": 0,
            "end_token": 1,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 1,
                    "end_token": 1,
                    "children": [],
                    "label": "logging"
                }
            ],
            "label": "import logging"
        },
        {
            "type": "import_from_statement",
            "start_token": 3,
            "end_token": 11,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 4,
                    "end_token": 4,
                    "children": [],
                    "label": "typing"
                },
                {
                    "type": "import_prefix",
                    "start_token": 5,
                    "end_token": 10,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 6,
                            "end_token": 6,
                            "label": "TYPE_CHECKING"
                        },
                        {
                            "type": "identifier",
                            "start_token": 8,
                            "end_token": 8,
                            "label": "Annotated"
                        },
                        {
                            "type": "identifier",
                            "start_token": 10,
                            "end_token": 10,
                            "label": "Literal"
                        }
                    ],
                    "label": "import TYPE_CHECKING, Annotated, Literal"
                }
            ],
            "label": "from typing import TYPE_CHECKING, Annotated, Literal\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 13,
            "end_token": 29,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 14,
                    "end_token": 14,
                    "children": [],
                    "label": "fastapi"
                },
                {
                    "type": "import_prefix",
                    "start_token": 15,
                    "end_token": 28,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 16,
                            "end_token": 16,
                            "label": "APIRouter"
                        },
                        {
                            "type": "identifier",
                            "start_token": 18,
                            "end_token": 18,
                            "label": "Body"
                        },
                        {
                            "type": "identifier",
                            "start_token": 20,
                            "end_token": 20,
                            "label": "Depends"
                        },
                        {
                            "type": "identifier",
                            "start_token": 22,
                            "end_token": 22,
                            "label": "HTTPException"
                        },
                        {
                            "type": "identifier",
                            "start_token": 24,
                            "end_token": 24,
                            "label": "Path"
                        },
                        {
                            "type": "identifier",
                            "start_token": 26,
                            "end_token": 26,
                            "label": "Query"
                        },
                        {
                            "type": "identifier",
                            "start_token": 28,
                            "end_token": 28,
                            "label": "Request"
                        }
                    ],
                    "label": "import APIRouter, Body, Depends, HTTPException, Path, Query, Request"
                }
            ],
            "label": "from fastapi import APIRouter, Body, Depends, HTTPException, Path, Query, Request\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 30,
            "end_token": 38,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 31,
                    "end_token": 31,
                    "children": [],
                    "label": "pydantic"
                },
                {
                    "type": "import_prefix",
                    "start_token": 32,
                    "end_token": 37,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 33,
                            "end_token": 33,
                            "label": "BaseModel"
                        },
                        {
                            "type": "identifier",
                            "start_token": 35,
                            "end_token": 35,
                            "label": "Field"
                        },
                        {
                            "type": "identifier",
                            "start_token": 37,
                            "end_token": 37,
                            "label": "SecretStr"
                        }
                    ],
                    "label": "import BaseModel, Field, SecretStr"
                }
            ],
            "label": "from pydantic import BaseModel, Field, SecretStr\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 40,
            "end_token": 48,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 41,
                    "end_token": 45,
                    "children": [],
                    "label": "backend.data.graph"
                },
                {
                    "type": "import_prefix",
                    "start_token": 46,
                    "end_token": 47,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 47,
                            "end_token": 47,
                            "label": "set_node_webhook"
                        }
                    ],
                    "label": "import set_node_webhook"
                }
            ],
            "label": "from backend.data.graph import set_node_webhook\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 49,
            "end_token": 73,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 50,
                    "end_token": 54,
                    "children": [],
                    "label": "backend.data.integrations"
                },
                {
                    "type": "import_prefix",
                    "start_token": 56,
                    "end_token": 72,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 58,
                            "end_token": 58,
                            "label": "WebhookEvent"
                        },
                        {
                            "type": "identifier",
                            "start_token": 61,
                            "end_token": 61,
                            "label": "get_all_webhooks_by_creds"
                        },
                        {
                            "type": "identifier",
                            "start_token": 64,
                            "end_token": 64,
                            "label": "get_webhook"
                        },
                        {
                            "type": "identifier",
                            "start_token": 67,
                            "end_token": 67,
                            "label": "publish_webhook_event"
                        },
                        {
                            "type": "identifier",
                            "start_token": 70,
                            "end_token": 70,
                            "label": "wait_for_webhook_event"
                        }
                    ],
                    "label": "(\n    WebhookEvent,\n    get_all_webhooks_by_creds,\n    get_webhook,\n    publish_webhook_event,\n    wait_for_webhook_event,\n"
                }
            ],
            "label": "from backend.data.integrations import (\n    WebhookEvent,\n    get_all_webhooks_by_creds,\n    get_webhook,\n    publish_webhook_event,\n    wait_for_webhook_event,\n)"
        },
        {
            "type": "import_from_statement",
            "start_token": 75,
            "end_token": 96,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 76,
                    "end_token": 80,
                    "children": [],
                    "label": "backend.data.model"
                },
                {
                    "type": "import_prefix",
                    "start_token": 82,
                    "end_token": 95,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 84,
                            "end_token": 84,
                            "label": "APIKeyCredentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 87,
                            "end_token": 87,
                            "label": "Credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 90,
                            "end_token": 90,
                            "label": "CredentialsType"
                        },
                        {
                            "type": "identifier",
                            "start_token": 93,
                            "end_token": 93,
                            "label": "OAuth2Credentials"
                        }
                    ],
                    "label": "(\n    APIKeyCredentials,\n    Credentials,\n    CredentialsType,\n    OAuth2Credentials,\n"
                }
            ],
            "label": "from backend.data.model import (\n    APIKeyCredentials,\n    Credentials,\n    CredentialsType,\n    OAuth2Credentials,\n)"
        },
        {
            "type": "import_from_statement",
            "start_token": 98,
            "end_token": 106,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 99,
                    "end_token": 103,
                    "children": [],
                    "label": "backend.executor.manager"
                },
                {
                    "type": "import_prefix",
                    "start_token": 104,
                    "end_token": 105,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 105,
                            "end_token": 105,
                            "label": "ExecutionManager"
                        }
                    ],
                    "label": "import ExecutionManager"
                }
            ],
            "label": "from backend.executor.manager import ExecutionManager\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 107,
            "end_token": 115,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 108,
                    "end_token": 112,
                    "children": [],
                    "label": "backend.integrations.creds_manager"
                },
                {
                    "type": "import_prefix",
                    "start_token": 113,
                    "end_token": 114,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 114,
                            "end_token": 114,
                            "label": "IntegrationCredentialsManager"
                        }
                    ],
                    "label": "import IntegrationCredentialsManager"
                }
            ],
            "label": "from backend.integrations.creds_manager import IntegrationCredentialsManager\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 116,
            "end_token": 124,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 117,
                    "end_token": 121,
                    "children": [],
                    "label": "backend.integrations.oauth"
                },
                {
                    "type": "import_prefix",
                    "start_token": 123,
                    "end_token": 123,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 123,
                            "end_token": 123,
                            "label": "HANDLERS_BY_NAME"
                        }
                    ],
                    "label": "HANDLERS_BY_NAME"
                }
            ],
            "label": "from backend.integrations.oauth import HANDLERS_BY_NAME\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 125,
            "end_token": 133,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 126,
                    "end_token": 130,
                    "children": [],
                    "label": "backend.integrations.providers"
                },
                {
                    "type": "import_prefix",
                    "start_token": 132,
                    "end_token": 132,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 132,
                            "end_token": 132,
                            "label": "ProviderName"
                        }
                    ],
                    "label": "ProviderName"
                }
            ],
            "label": "from backend.integrations.providers import ProviderName\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 134,
            "end_token": 142,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 135,
                    "end_token": 139,
                    "children": [],
                    "label": "backend.integrations.webhooks"
                },
                {
                    "type": "import_prefix",
                    "start_token": 141,
                    "end_token": 141,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 141,
                            "end_token": 141,
                            "label": "WEBHOOK_MANAGERS_BY_NAME"
                        }
                    ],
                    "label": "WEBHOOK_MANAGERS_BY_NAME"
                }
            ],
            "label": "from backend.integrations.webhooks import WEBHOOK_MANAGERS_BY_NAME\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 143,
            "end_token": 151,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 144,
                    "end_token": 148,
                    "children": [],
                    "label": "backend.util.exceptions"
                },
                {
                    "type": "import_prefix",
                    "start_token": 149,
                    "end_token": 150,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 150,
                            "end_token": 150,
                            "label": "NeedConfirmation"
                        }
                    ],
                    "label": "import NeedConfirmation"
                }
            ],
            "label": "from backend.util.exceptions import NeedConfirmation\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 152,
            "end_token": 160,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 153,
                    "end_token": 157,
                    "children": [],
                    "label": "backend.util.service"
                },
                {
                    "type": "import_prefix",
                    "start_token": 158,
                    "end_token": 159,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 159,
                            "end_token": 159,
                            "label": "get_service_client"
                        }
                    ],
                    "label": "import get_service_client"
                }
            ],
            "label": "from backend.util.service import get_service_client\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 161,
            "end_token": 169,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 162,
                    "end_token": 166,
                    "children": [],
                    "label": "backend.util.settings"
                },
                {
                    "type": "import_prefix",
                    "start_token": 168,
                    "end_token": 168,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 168,
                            "end_token": 168,
                            "label": "Settings"
                        }
                    ],
                    "label": "Settings"
                }
            ],
            "label": "from backend.util.settings import Settings\n"
        },
        {
            "type": "if_statement",
            "start_token": 171,
            "end_token": 183,
            "children": [
                {
                    "type": "expression_list",
                    "start_token": 171,
                    "end_token": 172,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 172,
                            "end_token": 172,
                            "children": [],
                            "label": "TYPE_CHECKING"
                        }
                    ],
                    "label": "if TYPE_CHECKING"
                },
                {
                    "type": "block",
                    "start_token": 173,
                    "end_token": 183,
                    "children": [
                        {
                            "type": "import_from_statement",
                            "start_token": 175,
                            "end_token": 182,
                            "children": [
                                {
                                    "type": "dotted_name",
                                    "start_token": 176,
                                    "end_token": 180,
                                    "children": [],
                                    "label": "backend.integrations.oauth"
                                },
                                {
                                    "type": "import_prefix",
                                    "start_token": 181,
                                    "end_token": 182,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 182,
                                            "end_token": 182,
                                            "label": "BaseOAuthHandler"
                                        }
                                    ],
                                    "label": "import BaseOAuthHandler"
                                }
                            ],
                            "label": "from backend.integrations.oauth import BaseOAuthHandler"
                        }
                    ],
                    "label": ":\n    from backend.integrations.oauth import BaseOAuthHandler\n"
                }
            ],
            "label": "if TYPE_CHECKING:\n    from backend.integrations.oauth import BaseOAuthHandler\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 185,
            "end_token": 191,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 186,
                    "end_token": 188,
                    "children": [],
                    "label": "..utils"
                },
                {
                    "type": "import_prefix",
                    "start_token": 189,
                    "end_token": 190,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 190,
                            "end_token": 190,
                            "label": "get_user_id"
                        }
                    ],
                    "label": "import get_user_id"
                }
            ],
            "label": "from ..utils import get_user_id\n"
        },
        {
            "type": "assignment",
            "start_token": 193,
            "end_token": 200,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 193,
                    "end_token": 193,
                    "label": "logger"
                },
                {
                    "type": "call",
                    "start_token": 195,
                    "end_token": 200,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 195,
                            "end_token": 197,
                            "children": [
                                {
                                    "type": "dotted_name",
                                    "start_token": 195,
                                    "end_token": 195,
                                    "label": "logging"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 197,
                                    "end_token": 197,
                                    "label": "getLogger"
                                }
                            ],
                            "label": "logging.getLogger"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 198,
                            "end_token": 199,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 199,
                                    "end_token": 199,
                                    "label": "__name__"
                                }
                            ],
                            "label": "(__name__"
                        }
                    ],
                    "label": "logging.getLogger(__name__)"
                }
            ],
            "label": "logger = logging.getLogger(__name__)"
        },
        {
            "type": "assignment",
            "start_token": 202,
            "end_token": 206,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 202,
                    "end_token": 202,
                    "label": "settings"
                },
                {
                    "type": "call",
                    "start_token": 204,
                    "end_token": 206,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 204,
                            "end_token": 204,
                            "label": "Settings"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 205,
                            "end_token": 205,
                            "children": [],
                            "label": "("
                        }
                    ],
                    "label": "Settings()"
                }
            ],
            "label": "settings = Settings()"
        },
        {
            "type": "assignment",
            "start_token": 208,
            "end_token": 212,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 208,
                    "end_token": 208,
                    "label": "router"
                },
                {
                    "type": "call",
                    "start_token": 210,
                    "end_token": 212,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 210,
                            "end_token": 210,
                            "label": "APIRouter"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 211,
                            "end_token": 211,
                            "children": [],
                            "label": "("
                        }
                    ],
                    "label": "APIRouter()"
                }
            ],
            "label": "router = APIRouter()"
        },
        {
            "type": "assignment",
            "start_token": 215,
            "end_token": 219,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 215,
                    "end_token": 215,
                    "label": "creds_manager"
                },
                {
                    "type": "call",
                    "start_token": 217,
                    "end_token": 219,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 217,
                            "end_token": 217,
                            "label": "IntegrationCredentialsManager"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 218,
                            "end_token": 218,
                            "children": [],
                            "label": "("
                        }
                    ],
                    "label": "IntegrationCredentialsManager()"
                }
            ],
            "label": "creds_manager = IntegrationCredentialsManager()"
        },
        {
            "type": "decorated_definition",
            "start_token": 225,
            "end_token": 231,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 225,
                    "end_token": 230,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 226,
                            "end_token": 228,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 226,
                                    "end_token": 226,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 228,
                                    "end_token": 228,
                                    "label": "get"
                                }
                            ],
                            "label": "router.get"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 229,
                            "end_token": 230,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 230,
                                    "end_token": 230,
                                    "children": [],
                                    "label": "\"/{provider}/login\""
                                }
                            ],
                            "label": "(\"/{provider}/login\""
                        }
                    ],
                    "label": "@router.get(\"/{provider}/login\""
                }
            ],
            "label": "@router.get(\"/{provider}/login\")"
        },
        {
            "type": "decorated_definition",
            "start_token": 237,
            "end_token": 243,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 237,
                    "end_token": 242,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 238,
                            "end_token": 240,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 238,
                                    "end_token": 238,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 240,
                                    "end_token": 240,
                                    "label": "post"
                                }
                            ],
                            "label": "router.post"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 241,
                            "end_token": 242,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 242,
                                    "end_token": 242,
                                    "children": [],
                                    "label": "\"/{provider}/callback\""
                                }
                            ],
                            "label": "(\"/{provider}/callback\""
                        }
                    ],
                    "label": "@router.post(\"/{provider}/callback\""
                }
            ],
            "label": "@router.post(\"/{provider}/callback\")"
        },
        {
            "type": "decorated_definition",
            "start_token": 247,
            "end_token": 253,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 247,
                    "end_token": 252,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 248,
                            "end_token": 250,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 248,
                                    "end_token": 248,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 250,
                                    "end_token": 250,
                                    "label": "get"
                                }
                            ],
                            "label": "router.get"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 251,
                            "end_token": 252,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 252,
                                    "end_token": 252,
                                    "children": [],
                                    "label": "\"/credentials\""
                                }
                            ],
                            "label": "(\"/credentials\""
                        }
                    ],
                    "label": "@router.get(\"/credentials\""
                }
            ],
            "label": "@router.get(\"/credentials\")"
        },
        {
            "type": "decorated_definition",
            "start_token": 257,
            "end_token": 263,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 257,
                    "end_token": 262,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 258,
                            "end_token": 260,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 258,
                                    "end_token": 258,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 260,
                                    "end_token": 260,
                                    "label": "get"
                                }
                            ],
                            "label": "router.get"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 261,
                            "end_token": 262,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 262,
                                    "end_token": 262,
                                    "children": [],
                                    "label": "\"/{provider}/credentials\""
                                }
                            ],
                            "label": "(\"/{provider}/credentials\""
                        }
                    ],
                    "label": "@router.get(\"/{provider}/credentials\""
                }
            ],
            "label": "@router.get(\"/{provider}/credentials\")"
        },
        {
            "type": "decorated_definition",
            "start_token": 267,
            "end_token": 273,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 267,
                    "end_token": 272,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 268,
                            "end_token": 270,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 268,
                                    "end_token": 268,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 270,
                                    "end_token": 270,
                                    "label": "get"
                                }
                            ],
                            "label": "router.get"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 271,
                            "end_token": 272,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 272,
                                    "end_token": 272,
                                    "children": [],
                                    "label": "\"/{provider}/credentials/{cred_id}\""
                                }
                            ],
                            "label": "(\"/{provider}/credentials/{cred_id}\""
                        }
                    ],
                    "label": "@router.get(\"/{provider}/credentials/{cred_id}\""
                }
            ],
            "label": "@router.get(\"/{provider}/credentials/{cred_id}\")"
        },
        {
            "type": "decorated_definition",
            "start_token": 277,
            "end_token": 287,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 277,
                    "end_token": 286,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 278,
                            "end_token": 280,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 278,
                                    "end_token": 278,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 280,
                                    "end_token": 280,
                                    "label": "post"
                                }
                            ],
                            "label": "router.post"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 281,
                            "end_token": 286,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 282,
                                    "end_token": 282,
                                    "children": [],
                                    "label": "\"/{provider}/credentials\""
                                },
                                {
                                    "type": "keyword_argument",
                                    "start_token": 284,
                                    "end_token": 286,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 284,
                                            "end_token": 284,
                                            "label": "status_code"
                                        },
                                        {
                                            "type": "integer",
                                            "start_token": 286,
                                            "end_token": 286,
                                            "label": "201"
                                        }
                                    ],
                                    "label": "status_code=201"
                                }
                            ],
                            "label": "(\"/{provider}/credentials\", status_code=201"
                        }
                    ],
                    "label": "@router.post(\"/{provider}/credentials\", status_code=201"
                }
            ],
            "label": "@router.post(\"/{provider}/credentials\", status_code=201)"
        },
        {
            "type": "decorated_definition",
            "start_token": 295,
            "end_token": 301,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 295,
                    "end_token": 300,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 296,
                            "end_token": 298,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 296,
                                    "end_token": 296,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 298,
                                    "end_token": 298,
                                    "label": "delete"
                                }
                            ],
                            "label": "router.delete"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 299,
                            "end_token": 300,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 300,
                                    "end_token": 300,
                                    "children": [],
                                    "label": "\"/{provider}/credentials/{cred_id}\""
                                }
                            ],
                            "label": "(\"/{provider}/credentials/{cred_id}\""
                        }
                    ],
                    "label": "@router.delete(\"/{provider}/credentials/{cred_id}\""
                }
            ],
            "label": "@router.delete(\"/{provider}/credentials/{cred_id}\")"
        },
        {
            "type": "comment",
            "start_token": 305,
            "end_token": 359,
            "children": [],
            "label": "# ------------------------- WEBHOOK STUFF -------------------------- #"
        },
        {
            "type": "decorated_definition",
            "start_token": 396,
            "end_token": 402,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 396,
                    "end_token": 401,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 397,
                            "end_token": 399,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 397,
                                    "end_token": 397,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 399,
                                    "end_token": 399,
                                    "label": "post"
                                }
                            ],
                            "label": "router.post"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 400,
                            "end_token": 401,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 401,
                                    "end_token": 401,
                                    "children": [],
                                    "label": "\"/{provider}/webhooks/{webhook_id}/ingress\""
                                }
                            ],
                            "label": "(\"/{provider}/webhooks/{webhook_id}/ingress\""
                        }
                    ],
                    "label": "@router.post(\"/{provider}/webhooks/{webhook_id}/ingress\""
                }
            ],
            "label": "@router.post(\"/{provider}/webhooks/{webhook_id}/ingress\")"
        },
        {
            "type": "decorated_definition",
            "start_token": 406,
            "end_token": 412,
            "children": [
                {
                    "type": "decorator",
                    "start_token": 406,
                    "end_token": 411,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 407,
                            "end_token": 409,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 407,
                                    "end_token": 407,
                                    "label": "router"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 409,
                                    "end_token": 409,
                                    "label": "post"
                                }
                            ],
                            "label": "router.post"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 410,
                            "end_token": 411,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 411,
                                    "end_token": 411,
                                    "children": [],
                                    "label": "\"/webhooks/{webhook_id}/ping\""
                                }
                            ],
                            "label": "(\"/webhooks/{webhook_id}/ping\""
                        }
                    ],
                    "label": "@router.post(\"/webhooks/{webhook_id}/ping\""
                }
            ],
            "label": "@router.post(\"/webhooks/{webhook_id}/ping\")"
        },
        {
            "type": "comment",
            "start_token": 416,
            "end_token": 473,
            "children": [],
            "label": "# --------------------------- UTILITIES ---------------------------- #"
        },
        {
            "type": "function_placeholder",
            "name": "login",
            "start_line": 48,
            "end_line": 69,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 143,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 143,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "login"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 58,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 18,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "label": "provider"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 6,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 9,
                                                            "end_token": 9,
                                                            "label": "ProviderName"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 12,
                                                            "end_token": 16,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 13,
                                                                    "end_token": 15,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "label": "title"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "label": "\"The provider to initiate an OAuth flow for\""
                                                                        }
                                                                    ],
                                                                    "label": "title=\"The provider to initiate an OAuth flow for\""
                                                                }
                                                            ],
                                                            "label": "(title=\"The provider to initiate an OAuth flow for\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n        ProviderName, Path(title=\"The provider to initiate an OAuth flow for\")\n    ]"
                                                }
                                            ],
                                            "label": "provider: Annotated[\n        ProviderName, Path(title=\"The provider to initiate an OAuth flow for\")\n    ]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 21,
                                            "end_token": 31,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 21,
                                                    "end_token": 21,
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 23,
                                                    "end_token": 31,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 25,
                                                            "end_token": 25,
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 28,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 29,
                                                                    "end_token": 29,
                                                                    "label": "get_user_id"
                                                                }
                                                            ],
                                                            "label": "(get_user_id)"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Depends(get_user_id)]"
                                                }
                                            ],
                                            "label": "user_id: Annotated[str, Depends(get_user_id)]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 34,
                                            "end_token": 36,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 34,
                                                    "end_token": 34,
                                                    "label": "request"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 36,
                                                    "end_token": 36,
                                                    "label": "Request"
                                                }
                                            ],
                                            "label": "request: Request"
                                        },
                                        {
                                            "type": "typed_default_parameter",
                                            "start_token": 39,
                                            "end_token": 55,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 39,
                                                    "end_token": 39,
                                                    "label": "scopes"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 41,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 44,
                                                            "end_token": 44,
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 47,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 48,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 48,
                                                                            "end_token": 48,
                                                                            "label": "title"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 50,
                                                                            "end_token": 50,
                                                                            "label": "\"Comma-separated list of authorization scopes\""
                                                                        }
                                                                    ],
                                                                    "label": "title=\"Comma-separated list of authorization scopes\""
                                                                }
                                                            ],
                                                            "label": "(title=\"Comma-separated list of authorization scopes\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n        str, Query(title=\"Comma-separated list of authorization scopes\")\n    ]"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 55,
                                                    "end_token": 55,
                                                    "label": "\"\""
                                                }
                                            ],
                                            "label": "scopes: Annotated[\n        str, Query(title=\"Comma-separated list of authorization scopes\")\n    ] = \"\""
                                        }
                                    ],
                                    "label": "(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to initiate an OAuth flow for\")\n    ],\n    user_id: Annotated[str, Depends(get_user_id)],\n    request: Request,\n    scopes: Annotated[\n        str, Query(title=\"Comma-separated list of authorization scopes\")\n    ] = \"\",\n)"
                                },
                                {
                                    "type": "type",
                                    "start_token": 59,
                                    "end_token": 61,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 61,
                                            "end_token": 61,
                                            "label": "LoginResponse"
                                        }
                                    ],
                                    "label": "-> LoginResponse"
                                },
                                {
                                    "type": "block",
                                    "start_token": 62,
                                    "end_token": 143,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 64,
                                            "end_token": 71,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 64,
                                                    "end_token": 64,
                                                    "label": "handler"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 66,
                                                    "end_token": 71,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 66,
                                                            "end_token": 66,
                                                            "label": "_get_provider_oauth_handler"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 67,
                                                            "end_token": 71,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 68,
                                                                    "end_token": 68,
                                                                    "label": "request"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 70,
                                                                    "end_token": 70,
                                                                    "label": "provider"
                                                                }
                                                            ],
                                                            "label": "(request, provider)"
                                                        }
                                                    ],
                                                    "label": "_get_provider_oauth_handler(request, provider)"
                                                }
                                            ],
                                            "label": "handler = _get_provider_oauth_handler(request, provider)"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 74,
                                            "end_token": 86,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 74,
                                                    "end_token": 74,
                                                    "label": "requested_scopes"
                                                },
                                                {
                                                    "type": "conditional_expression",
                                                    "start_token": 76,
                                                    "end_token": 86,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 76,
                                                            "end_token": 81,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 76,
                                                                    "end_token": 78,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 76,
                                                                            "end_token": 76,
                                                                            "label": "scopes"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 78,
                                                                            "end_token": 78,
                                                                            "label": "split"
                                                                        }
                                                                    ],
                                                                    "label": "scopes.split"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 79,
                                                                    "end_token": 81,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 80,
                                                                            "end_token": 80,
                                                                            "label": "\",\""
                                                                        }
                                                                    ],
                                                                    "label": "(\",\")"
                                                                }
                                                            ],
                                                            "label": "scopes.split(\",\")"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 83,
                                                            "end_token": 83,
                                                            "label": "scopes"
                                                        },
                                                        {
                                                            "type": "list",
                                                            "start_token": 85,
                                                            "end_token": 86,
                                                            "children": [],
                                                            "label": "[]"
                                                        }
                                                    ],
                                                    "label": "scopes.split(\",\") if scopes else []"
                                                }
                                            ],
                                            "label": "requested_scopes = scopes.split(\",\") if scopes else []"
                                        },
                                        {
                                            "type": "comment",
                                            "start_token": 89,
                                            "end_token": 101,
                                            "label": "# Generate and store a secure random state token along with the scopes"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 103,
                                            "end_token": 118,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 103,
                                                    "end_token": 103,
                                                    "label": "state_token"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 105,
                                                    "end_token": 118,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 105,
                                                            "end_token": 109,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 105,
                                                                    "end_token": 105,
                                                                    "label": "creds_manager"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 107,
                                                                    "end_token": 107,
                                                                    "label": "store"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 109,
                                                                    "end_token": 109,
                                                                    "label": "store_state_token"
                                                                }
                                                            ],
                                                            "label": "creds_manager.store.store_state_token"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 110,
                                                            "end_token": 118,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 112,
                                                                    "end_token": 112,
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 114,
                                                                    "end_token": 114,
                                                                    "label": "provider"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 116,
                                                                    "end_token": 116,
                                                                    "label": "requested_scopes"
                                                                }
                                                            ],
                                                            "label": "(\n        user_id, provider, requested_scopes\n    )"
                                                        }
                                                    ],
                                                    "label": "creds_manager.store.store_state_token(\n        user_id, provider, requested_scopes\n    )"
                                                }
                                            ],
                                            "label": "state_token = creds_manager.store.store_state_token(\n        user_id, provider, requested_scopes\n    )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 121,
                                            "end_token": 130,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 121,
                                                    "end_token": 121,
                                                    "label": "login_url"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 123,
                                                    "end_token": 130,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 123,
                                                            "end_token": 125,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 123,
                                                                    "end_token": 123,
                                                                    "label": "handler"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 125,
                                                                    "end_token": 125,
                                                                    "label": "get_login_url"
                                                                }
                                                            ],
                                                            "label": "handler.get_login_url"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 126,
                                                            "end_token": 130,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 127,
                                                                    "end_token": 127,
                                                                    "label": "requested_scopes"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 129,
                                                                    "end_token": 129,
                                                                    "label": "state_token"
                                                                }
                                                            ],
                                                            "label": "(requested_scopes, state_token)"
                                                        }
                                                    ],
                                                    "label": "handler.get_login_url(requested_scopes, state_token)"
                                                }
                                            ],
                                            "label": "login_url = handler.get_login_url(requested_scopes, state_token)"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 133,
                                            "end_token": 143,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 134,
                                                    "end_token": 143,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 134,
                                                            "end_token": 134,
                                                            "label": "LoginResponse"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 135,
                                                            "end_token": 143,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 136,
                                                                    "end_token": 138,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 136,
                                                                            "end_token": 136,
                                                                            "label": "login_url"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 138,
                                                                            "end_token": 138,
                                                                            "label": "login_url"
                                                                        }
                                                                    ],
                                                                    "label": "login_url=login_url"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 140,
                                                                    "end_token": 142,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 140,
                                                                            "end_token": 140,
                                                                            "label": "state_token"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 142,
                                                                            "end_token": 142,
                                                                            "label": "state_token"
                                                                        }
                                                                    ],
                                                                    "label": "state_token=state_token"
                                                                }
                                                            ],
                                                            "label": "(login_url=login_url, state_token=state_token)"
                                                        }
                                                    ],
                                                    "label": "LoginResponse(login_url=login_url, state_token=state_token)"
                                                }
                                            ],
                                            "label": "return LoginResponse(login_url=login_url, state_token=state_token)"
                                        }
                                    ],
                                    "label": ":\n    handler = _get_provider_oauth_handler(request, provider)\n\n    requested_scopes = scopes.split(\",\") if scopes else []\n\n    # Generate and store a secure random state token along with the scopes\n    state_token = creds_manager.store.store_state_token(\n        user_id, provider, requested_scopes\n    )\n\n    login_url = handler.get_login_url(requested_scopes, state_token)\n\n    return LoginResponse(login_url=login_url, state_token=state_token)"
                                }
                            ],
                            "label": "def login(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to initiate an OAuth flow for\")\n    ],\n    user_id: Annotated[str, Depends(get_user_id)],\n    request: Request,\n    scopes: Annotated[\n        str, Query(title=\"Comma-separated list of authorization scopes\")\n    ] = \"\",\n) -> LoginResponse:\n    handler = _get_provider_oauth_handler(request, provider)\n\n    requested_scopes = scopes.split(\",\") if scopes else []\n\n    # Generate and store a secure random state token along with the scopes\n    state_token = creds_manager.store.store_state_token(\n        user_id, provider, requested_scopes\n    )\n\n    login_url = handler.get_login_url(requested_scopes, state_token)\n\n    return LoginResponse(login_url=login_url, state_token=state_token)"
                        }
                    ],
                    "label": "def login(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to initiate an OAuth flow for\")\n    ],\n    user_id: Annotated[str, Depends(get_user_id)],\n    request: Request,\n    scopes: Annotated[\n        str, Query(title=\"Comma-separated list of authorization scopes\")\n    ] = \"\",\n) -> LoginResponse:\n    handler = _get_provider_oauth_handler(request, provider)\n\n    requested_scopes = scopes.split(\",\") if scopes else []\n\n    # Generate and store a secure random state token along with the scopes\n    state_token = creds_manager.store.store_state_token(\n        user_id, provider, requested_scopes\n    )\n\n    login_url = handler.get_login_url(requested_scopes, state_token)\n\n    return LoginResponse(login_url=login_url, state_token=state_token)"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "callback",
            "start_line": 82,
            "end_line": 138,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 369,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 368,
                            "children": [
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 69,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 18,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "provider"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 6,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 6,
                                                            "end_token": 6,
                                                            "children": [],
                                                            "label": "Annotated"
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "start_token": 7,
                                                            "end_token": 18,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 9,
                                                                    "end_token": 9,
                                                                    "children": [],
                                                                    "label": "ProviderName"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 12,
                                                                    "end_token": 16,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "children": [],
                                                                            "label": "("
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 13,
                                                                            "end_token": 15,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 13,
                                                                                    "end_token": 13,
                                                                                    "children": [],
                                                                                    "label": "title"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 15,
                                                                                    "end_token": 15,
                                                                                    "children": [],
                                                                                    "label": "\"The target provider for this OAuth exchange\""
                                                                                }
                                                                            ],
                                                                            "label": "title=\"The target provider for this OAuth exchange\""
                                                                        }
                                                                    ],
                                                                    "label": "(title=\"The target provider for this OAuth exchange\")"
                                                                }
                                                            ],
                                                            "label": "[\n        ProviderName, Path(title=\"The target provider for this OAuth exchange\")\n    ]"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n        ProviderName, Path(title=\"The target provider for this OAuth exchange\")\n    ]"
                                                }
                                            ],
                                            "label": "provider: Annotated[\n        ProviderName, Path(title=\"The target provider for this OAuth exchange\")\n    ]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 21,
                                            "end_token": 33,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 21,
                                                    "end_token": 21,
                                                    "children": [],
                                                    "label": "code"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 23,
                                                    "end_token": 33,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 23,
                                                            "end_token": 23,
                                                            "children": [],
                                                            "label": "Annotated"
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "start_token": 24,
                                                            "end_token": 32,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 25,
                                                                    "end_token": 25,
                                                                    "children": [],
                                                                    "label": "str"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 28,
                                                                    "end_token": 32,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 28,
                                                                            "end_token": 28,
                                                                            "children": [],
                                                                            "label": "("
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 29,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "children": [],
                                                                                    "label": "title"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 31,
                                                                                    "end_token": 31,
                                                                                    "children": [],
                                                                                    "label": "\"Authorization code acquired by user login\""
                                                                                }
                                                                            ],
                                                                            "label": "title=\"Authorization code acquired by user login\""
                                                                        }
                                                                    ],
                                                                    "label": "(title=\"Authorization code acquired by user login\")"
                                                                }
                                                            ],
                                                            "label": "[str, Body(title=\"Authorization code acquired by user login\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Body(title=\"Authorization code acquired by user login\")]"
                                                }
                                            ],
                                            "label": "code: Annotated[str, Body(title=\"Authorization code acquired by user login\")]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 36,
                                            "end_token": 48,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 36,
                                                    "end_token": 36,
                                                    "children": [],
                                                    "label": "state_token"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 38,
                                                    "end_token": 48,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 38,
                                                            "end_token": 38,
                                                            "children": [],
                                                            "label": "Annotated"
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "start_token": 39,
                                                            "end_token": 47,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 40,
                                                                    "end_token": 40,
                                                                    "children": [],
                                                                    "label": "str"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 43,
                                                                    "end_token": 47,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 43,
                                                                            "end_token": 43,
                                                                            "children": [],
                                                                            "label": "("
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 44,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 44,
                                                                                    "end_token": 44,
                                                                                    "children": [],
                                                                                    "label": "title"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 46,
                                                                                    "end_token": 46,
                                                                                    "children": [],
                                                                                    "label": "\"Anti-CSRF nonce\""
                                                                                }
                                                                            ],
                                                                            "label": "title=\"Anti-CSRF nonce\""
                                                                        }
                                                                    ],
                                                                    "label": "(title=\"Anti-CSRF nonce\")"
                                                                }
                                                            ],
                                                            "label": "[str, Body(title=\"Anti-CSRF nonce\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Body(title=\"Anti-CSRF nonce\")]"
                                                }
                                            ],
                                            "label": "state_token: Annotated[str, Body(title=\"Anti-CSRF nonce\")]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 51,
                                            "end_token": 61,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 51,
                                                    "end_token": 51,
                                                    "children": [],
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 53,
                                                    "end_token": 61,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 53,
                                                            "end_token": 53,
                                                            "children": [],
                                                            "label": "Annotated"
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "start_token": 54,
                                                            "end_token": 60,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 55,
                                                                    "end_token": 55,
                                                                    "children": [],
                                                                    "label": "str"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 57,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 57,
                                                                            "end_token": 57,
                                                                            "children": [],
                                                                            "label": "Depends"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 59,
                                                                            "end_token": 59,
                                                                            "children": [],
                                                                            "label": "get_user_id"
                                                                        }
                                                                    ],
                                                                    "label": "Depends(get_user_id)"
                                                                }
                                                            ],
                                                            "label": "[str, Depends(get_user_id)"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Depends(get_user_id)]"
                                                }
                                            ],
                                            "label": "user_id: Annotated[str, Depends(get_user_id)]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 64,
                                            "end_token": 66,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 64,
                                                    "end_token": 64,
                                                    "children": [],
                                                    "label": "request"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 66,
                                                    "end_token": 66,
                                                    "children": [],
                                                    "label": "Request"
                                                }
                                            ],
                                            "label": "request: Request"
                                        }
                                    ],
                                    "label": "(\n    provider: Annotated[\n        ProviderName, Path(title=\"The target provider for this OAuth exchange\")\n    ],\n    code: Annotated[str, Body(title=\"Authorization code acquired by user login\")],\n    state_token: Annotated[str, Body(title=\"Anti-CSRF nonce\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n    request: Request,\n)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 73,
                                    "end_token": 368,
                                    "children": [
                                        {
                                            "type": "call",
                                            "start_token": 75,
                                            "end_token": 81,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 75,
                                                    "end_token": 77,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 75,
                                                            "end_token": 75,
                                                            "children": [],
                                                            "label": "logger"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 77,
                                                            "end_token": 77,
                                                            "children": [],
                                                            "label": "debug"
                                                        }
                                                    ],
                                                    "label": "logger.debug"
                                                },
                                                {
                                                    "type": "concatenated_string",
                                                    "start_token": 79,
                                                    "end_token": 80,
                                                    "children": [],
                                                    "label": "f\"Received OAuth callback for provider: {provider}\""
                                                }
                                            ],
                                            "label": "logger.debug(f\"Received OAuth callback for provider: {provider}\")"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 83,
                                            "end_token": 90,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 83,
                                                    "end_token": 83,
                                                    "children": [],
                                                    "label": "handler"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 85,
                                                    "end_token": 90,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 85,
                                                            "end_token": 85,
                                                            "children": [],
                                                            "label": "_get_provider_oauth_handler"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 87,
                                                            "end_token": 87,
                                                            "children": [],
                                                            "label": "request"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 89,
                                                            "end_token": 89,
                                                            "children": [],
                                                            "label": "provider"
                                                        }
                                                    ],
                                                    "label": "_get_provider_oauth_handler(request, provider)"
                                                }
                                            ],
                                            "label": "handler = _get_provider_oauth_handler(request, provider)"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 99,
                                            "end_token": 133,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 100,
                                                    "end_token": 112,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 101,
                                                            "end_token": 112,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 101,
                                                                    "end_token": 105,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 101,
                                                                            "end_token": 103,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 101,
                                                                                    "end_token": 101,
                                                                                    "children": [],
                                                                                    "label": "creds_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 103,
                                                                                    "end_token": 103,
                                                                                    "children": [],
                                                                                    "label": "store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 105,
                                                                                    "end_token": 105,
                                                                                    "children": [],
                                                                                    "label": "verify_state_token"
                                                                                }
                                                                            ],
                                                                            "label": "creds_manager.store"
                                                                        }
                                                                    ],
                                                                    "label": "creds_manager.store.verify_state_token"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 107,
                                                                    "end_token": 107,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 109,
                                                                    "end_token": 109,
                                                                    "children": [],
                                                                    "label": "state_token"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 111,
                                                                    "end_token": 111,
                                                                    "children": [],
                                                                    "label": "provider"
                                                                }
                                                            ],
                                                            "label": "creds_manager.store.verify_state_token(user_id, state_token, provider)"
                                                        }
                                                    ],
                                                    "label": "not creds_manager.store.verify_state_token(user_id, state_token, provider)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 113,
                                                    "end_token": 133,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 115,
                                                            "end_token": 121,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 115,
                                                                    "end_token": 117,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 115,
                                                                            "end_token": 115,
                                                                            "children": [],
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 117,
                                                                            "end_token": 117,
                                                                            "children": [],
                                                                            "label": "warning"
                                                                        }
                                                                    ],
                                                                    "label": "logger.warning"
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 119,
                                                                    "end_token": 120,
                                                                    "children": [],
                                                                    "label": "f\"Invalid or expired state token for user {user_id}\""
                                                                }
                                                            ],
                                                            "label": "logger.warning(f\"Invalid or expired state token for user {user_id}\")"
                                                        },
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 123,
                                                            "end_token": 133,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 124,
                                                                    "end_token": 133,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 124,
                                                                            "end_token": 124,
                                                                            "children": [],
                                                                            "label": "HTTPException"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 126,
                                                                            "end_token": 128,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 126,
                                                                                    "end_token": 126,
                                                                                    "children": [],
                                                                                    "label": "status_code"
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 128,
                                                                                    "end_token": 128,
                                                                                    "children": [],
                                                                                    "label": "400"
                                                                                }
                                                                            ],
                                                                            "label": "status_code=400"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 130,
                                                                            "end_token": 132,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 130,
                                                                                    "end_token": 130,
                                                                                    "children": [],
                                                                                    "label": "detail"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 132,
                                                                                    "end_token": 132,
                                                                                    "children": [],
                                                                                    "label": "\"Invalid or expired state token\""
                                                                                }
                                                                            ],
                                                                            "label": "detail=\"Invalid or expired state token\""
                                                                        }
                                                                    ],
                                                                    "label": "HTTPException(status_code=400, detail=\"Invalid or expired state token\")"
                                                                }
                                                            ],
                                                            "label": "raise HTTPException(status_code=400, detail=\"Invalid or expired state token\")"
                                                        }
                                                    ],
                                                    "label": ":\n        logger.warning(f\"Invalid or expired state token for user {user_id}\")\n        raise HTTPException(status_code=400, detail=\"Invalid or expired state token\")"
                                                }
                                            ],
                                            "label": "if not creds_manager.store.verify_state_token(user_id, state_token, provider):\n        logger.warning(f\"Invalid or expired state token for user {user_id}\")\n        raise HTTPException(status_code=400, detail=\"Invalid or expired state token\")"
                                        },
                                        {
                                            "type": "try_statement",
                                            "start_token": 136,
                                            "end_token": 281,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 137,
                                                    "end_token": 224,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 139,
                                                            "end_token": 154,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 139,
                                                                    "end_token": 139,
                                                                    "children": [],
                                                                    "label": "scopes"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 141,
                                                                    "end_token": 154,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 141,
                                                                            "end_token": 145,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 141,
                                                                                    "end_token": 143,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 141,
                                                                                            "end_token": 141,
                                                                                            "children": [],
                                                                                            "label": "creds_manager"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 143,
                                                                                            "end_token": 143,
                                                                                            "children": [],
                                                                                            "label": "store"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 145,
                                                                                            "end_token": 145,
                                                                                            "children": [],
                                                                                            "label": "get_any_valid_scopes_from_state_token"
                                                                                        }
                                                                                    ],
                                                                                    "label": "creds_manager.store"
                                                                                }
                                                                            ],
                                                                            "label": "creds_manager.store.get_any_valid_scopes_from_state_token"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 147,
                                                                            "end_token": 147,
                                                                            "children": [],
                                                                            "label": "\n"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 149,
                                                                            "end_token": 149,
                                                                            "children": [],
                                                                            "label": ","
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 151,
                                                                            "end_token": 151,
                                                                            "children": [],
                                                                            "label": ","
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 153,
                                                                            "end_token": 153,
                                                                            "children": [],
                                                                            "label": "\n"
                                                                        }
                                                                    ],
                                                                    "label": "creds_manager.store.get_any_valid_scopes_from_state_token(\n            user_id, state_token, provider\n        )"
                                                                }
                                                            ],
                                                            "label": "scopes = creds_manager.store.get_any_valid_scopes_from_state_token(\n            user_id, state_token, provider\n        )"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 156,
                                                            "end_token": 162,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 156,
                                                                    "end_token": 158,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 156,
                                                                            "end_token": 156,
                                                                            "children": [],
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 158,
                                                                            "end_token": 158,
                                                                            "children": [],
                                                                            "label": "debug"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug"
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 160,
                                                                    "end_token": 161,
                                                                    "children": [],
                                                                    "label": "f\"Retrieved scopes from state token: {scopes}\""
                                                                }
                                                            ],
                                                            "label": "logger.debug(f\"Retrieved scopes from state token: {scopes}\")"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 165,
                                                            "end_token": 172,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 165,
                                                                    "end_token": 165,
                                                                    "children": [],
                                                                    "label": "scopes"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 167,
                                                                    "end_token": 172,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 167,
                                                                            "end_token": 169,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 167,
                                                                                    "end_token": 167,
                                                                                    "children": [],
                                                                                    "label": "handler"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 169,
                                                                                    "end_token": 169,
                                                                                    "children": [],
                                                                                    "label": "handle_default_scopes"
                                                                                }
                                                                            ],
                                                                            "label": "handler.handle_default_scopes"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 171,
                                                                            "end_token": 171,
                                                                            "children": [],
                                                                            "label": "scopes"
                                                                        }
                                                                    ],
                                                                    "label": "handler.handle_default_scopes(scopes)"
                                                                }
                                                            ],
                                                            "label": "scopes = handler.handle_default_scopes(scopes)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 175,
                                                            "end_token": 184,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 175,
                                                                    "end_token": 175,
                                                                    "children": [],
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 177,
                                                                    "end_token": 184,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 177,
                                                                            "end_token": 179,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 177,
                                                                                    "end_token": 177,
                                                                                    "children": [],
                                                                                    "label": "handler"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 179,
                                                                                    "end_token": 179,
                                                                                    "children": [],
                                                                                    "label": "exchange_code_for_tokens"
                                                                                }
                                                                            ],
                                                                            "label": "handler.exchange_code_for_tokens"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 181,
                                                                            "end_token": 181,
                                                                            "children": [],
                                                                            "label": "code"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 183,
                                                                            "end_token": 183,
                                                                            "children": [],
                                                                            "label": "scopes"
                                                                        }
                                                                    ],
                                                                    "label": "handler.exchange_code_for_tokens(code, scopes)"
                                                                }
                                                            ],
                                                            "label": "credentials = handler.exchange_code_for_tokens(code, scopes)"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 186,
                                                            "end_token": 192,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 186,
                                                                    "end_token": 188,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 186,
                                                                            "end_token": 186,
                                                                            "children": [],
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 188,
                                                                            "end_token": 188,
                                                                            "children": [],
                                                                            "label": "debug"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug"
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 190,
                                                                    "end_token": 191,
                                                                    "children": [],
                                                                    "label": "f\"Received credentials with final scopes: {credentials.scopes}\""
                                                                }
                                                            ],
                                                            "label": "logger.debug(f\"Received credentials with final scopes: {credentials.scopes}\")"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 208,
                                                            "end_token": 251,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 209,
                                                                    "end_token": 223,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 210,
                                                                            "end_token": 223,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 210,
                                                                                    "end_token": 215,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "set",
                                                                                            "start_token": 210,
                                                                                            "end_token": 214,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 212,
                                                                                                    "end_token": 212,
                                                                                                    "children": [],
                                                                                                    "label": "scopes"
                                                                                                }
                                                                                            ],
                                                                                            "label": "set(scopes)."
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 214,
                                                                                            "end_token": 214,
                                                                                            "children": [],
                                                                                            "label": "."
                                                                                        }
                                                                                    ],
                                                                                    "label": "set(scopes).issubset"
                                                                                }
                                                                            ],
                                                                            "label": "set(scopes).issubset(set(credentials.scopes))"
                                                                        }
                                                                    ],
                                                                    "label": "not set(scopes).issubset(set(credentials.scopes))"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 224,
                                                                    "end_token": 251,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 240,
                                                                            "end_token": 250,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 240,
                                                                                    "end_token": 242,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 240,
                                                                                            "end_token": 240,
                                                                                            "children": [],
                                                                                            "label": "logger"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 242,
                                                                                            "end_token": 242,
                                                                                            "children": [],
                                                                                            "label": "warning"
                                                                                        }
                                                                                    ],
                                                                                    "label": "logger.warning"
                                                                                },
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 245,
                                                                                    "end_token": 249,
                                                                                    "children": [],
                                                                                    "label": "f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\""
                                                                                }
                                                                            ],
                                                                            "label": "logger.warning(\n                f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\"\n"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            # For now, we'll just log the warning and continue\n            logger.warning(\n                f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\"\n            )"
                                                                }
                                                            ],
                                                            "label": "if not set(scopes).issubset(set(credentials.scopes)):\n            # For now, we'll just log the warning and continue\n            logger.warning(\n                f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\"\n            )"
                                                        }
                                                    ],
                                                    "label": ":\n        scopes = creds_manager.store.get_any_valid_scopes_from_state_token(\n            user_id, state_token, provider\n        )\n        logger.debug(f\"Retrieved scopes from state token: {scopes}\")\n\n        scopes = handler.handle_default_scopes(scopes)\n\n        credentials = handler.exchange_code_for_tokens(code, scopes)\n        logger.debug(f\"Received credentials with final scopes: {credentials.scopes}\")\n\n        # Check if the granted scopes are sufficient for the requested scopes\n        if not set(scopes).issubset(set(credentials.scopes)):"
                                                },
                                                {
                                                    "type": "except_clause",
                                                    "start_token": 254,
                                                    "end_token": 281,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 256,
                                                            "end_token": 256,
                                                            "children": [],
                                                            "label": "as"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 259,
                                                            "end_token": 281,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 261,
                                                                    "end_token": 265,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 261,
                                                                            "end_token": 263,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 261,
                                                                                    "end_token": 261,
                                                                                    "children": [],
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 263,
                                                                                    "end_token": 263,
                                                                                    "children": [],
                                                                                    "label": "("
                                                                                }
                                                                            ],
                                                                            "label": ".error("
                                                                        },
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 265,
                                                                            "end_token": 265,
                                                                            "children": [],
                                                                            "label": "\"Code->Token exchange failed for provider {provider.value}: {e}\""
                                                                        }
                                                                    ],
                                                                    "label": ".error(f\"Code->Token exchange failed for provider {provider.value}: {e}\""
                                                                },
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 268,
                                                                    "end_token": 280,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 270,
                                                                            "end_token": 280,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 270,
                                                                                    "end_token": 270,
                                                                                    "children": [],
                                                                                    "label": "("
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 272,
                                                                                    "end_token": 274,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 272,
                                                                                            "end_token": 272,
                                                                                            "children": [],
                                                                                            "label": "status_code"
                                                                                        },
                                                                                        {
                                                                                            "type": "integer",
                                                                                            "start_token": 274,
                                                                                            "end_token": 274,
                                                                                            "children": [],
                                                                                            "label": "400"
                                                                                        }
                                                                                    ],
                                                                                    "label": "status_code=400"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 276,
                                                                                    "end_token": 279,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 276,
                                                                                            "end_token": 276,
                                                                                            "children": [],
                                                                                            "label": "detail"
                                                                                        },
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "start_token": 278,
                                                                                            "end_token": 279,
                                                                                            "children": [],
                                                                                            "label": "f\"Failed to exchange code for tokens: {str(e)}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "detail=f\"Failed to exchange code for tokens: {str(e)}\""
                                                                                }
                                                                            ],
                                                                            "label": "(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n"
                                                                        }
                                                                    ],
                                                                    "label": "raise HTTPException(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n"
                                                                }
                                                            ],
                                                            "label": "\n        logger.error(f\"Code->Token exchange failed for provider {provider.value}: {e}\")\n        raise HTTPException(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n        )"
                                                        }
                                                    ],
                                                    "label": "except Exception as e:\n        logger.error(f\"Code->Token exchange failed for provider {provider.value}: {e}\")\n        raise HTTPException(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n        )"
                                                }
                                            ],
                                            "label": "try:\n        scopes = creds_manager.store.get_any_valid_scopes_from_state_token(\n            user_id, state_token, provider\n        )\n        logger.debug(f\"Retrieved scopes from state token: {scopes}\")\n\n        scopes = handler.handle_default_scopes(scopes)\n\n        credentials = handler.exchange_code_for_tokens(code, scopes)\n        logger.debug(f\"Received credentials with final scopes: {credentials.scopes}\")\n\n        # Check if the granted scopes are sufficient for the requested scopes\n        if not set(scopes).issubset(set(credentials.scopes)):\n            # For now, we'll just log the warning and continue\n            logger.warning(\n                f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\"\n            )\n\n    except Exception as e:\n        logger.error(f\"Code->Token exchange failed for provider {provider.value}: {e}\")\n        raise HTTPException(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n        )"
                                        },
                                        {
                                            "type": "call",
                                            "start_token": 299,
                                            "end_token": 306,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 299,
                                                    "end_token": 301,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 299,
                                                            "end_token": 299,
                                                            "children": [],
                                                            "label": "creds_manager"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 301,
                                                            "end_token": 301,
                                                            "children": [],
                                                            "label": "create"
                                                        }
                                                    ],
                                                    "label": "creds_manager.create"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 303,
                                                    "end_token": 303,
                                                    "children": [],
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 305,
                                                    "end_token": 305,
                                                    "children": [],
                                                    "label": "credentials"
                                                }
                                            ],
                                            "label": "creds_manager.create(user_id, credentials)"
                                        },
                                        {
                                            "type": "call",
                                            "start_token": 310,
                                            "end_token": 319,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 310,
                                                    "end_token": 312,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 310,
                                                            "end_token": 310,
                                                            "children": [],
                                                            "label": "."
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 312,
                                                            "end_token": 312,
                                                            "children": [],
                                                            "label": "("
                                                        }
                                                    ],
                                                    "label": ".debug("
                                                },
                                                {
                                                    "type": "concatenated_string",
                                                    "start_token": 314,
                                                    "end_token": 318,
                                                    "children": [],
                                                    "label": "f\"Successfully processed OAuth callback for user {user_id} \"\n        f\"and provider {provider.value}\""
                                                }
                                            ],
                                            "label": ".debug(\n        f\"Successfully processed OAuth callback for user {user_id} \"\n        f\"and provider {provider.value}\"\n"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 322,
                                            "end_token": 368,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 323,
                                                    "end_token": 368,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 323,
                                                            "end_token": 323,
                                                            "children": [],
                                                            "label": "CredentialsMetaResponse"
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "start_token": 326,
                                                            "end_token": 330,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 326,
                                                                    "end_token": 326,
                                                                    "children": [],
                                                                    "label": "id"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 328,
                                                                    "end_token": 330,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 328,
                                                                            "end_token": 328,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 330,
                                                                            "end_token": 330,
                                                                            "children": [],
                                                                            "label": "id"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.id"
                                                                }
                                                            ],
                                                            "label": "id=credentials.id"
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "start_token": 333,
                                                            "end_token": 337,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 333,
                                                                    "end_token": 333,
                                                                    "children": [],
                                                                    "label": "provider"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 335,
                                                                    "end_token": 337,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 335,
                                                                            "end_token": 335,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 337,
                                                                            "end_token": 337,
                                                                            "children": [],
                                                                            "label": "provider"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.provider"
                                                                }
                                                            ],
                                                            "label": "provider=credentials.provider"
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "start_token": 340,
                                                            "end_token": 344,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 340,
                                                                    "end_token": 340,
                                                                    "children": [],
                                                                    "label": "type"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 342,
                                                                    "end_token": 344,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 342,
                                                                            "end_token": 342,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 344,
                                                                            "end_token": 344,
                                                                            "children": [],
                                                                            "label": "type"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.type"
                                                                }
                                                            ],
                                                            "label": "type=credentials.type"
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "start_token": 347,
                                                            "end_token": 351,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 347,
                                                                    "end_token": 347,
                                                                    "children": [],
                                                                    "label": "title"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 349,
                                                                    "end_token": 351,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 349,
                                                                            "end_token": 349,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 351,
                                                                            "end_token": 351,
                                                                            "children": [],
                                                                            "label": "title"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.title"
                                                                }
                                                            ],
                                                            "label": "title=credentials.title"
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "start_token": 354,
                                                            "end_token": 358,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 354,
                                                                    "end_token": 354,
                                                                    "children": [],
                                                                    "label": "scopes"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 356,
                                                                    "end_token": 358,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 356,
                                                                            "end_token": 356,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 358,
                                                                            "end_token": 358,
                                                                            "children": [],
                                                                            "label": "scopes"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.scopes"
                                                                }
                                                            ],
                                                            "label": "scopes=credentials.scopes"
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "start_token": 361,
                                                            "end_token": 365,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 361,
                                                                    "end_token": 361,
                                                                    "children": [],
                                                                    "label": "username"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 363,
                                                                    "end_token": 365,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 363,
                                                                            "end_token": 363,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 365,
                                                                            "end_token": 365,
                                                                            "children": [],
                                                                            "label": "username"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.username"
                                                                }
                                                            ],
                                                            "label": "username=credentials.username"
                                                        }
                                                    ],
                                                    "label": "CredentialsMetaResponse(\n        id=credentials.id,\n        provider=credentials.provider,\n        type=credentials.type,\n        title=credentials.title,\n        scopes=credentials.scopes,\n        username=credentials.username,\n    )"
                                                }
                                            ],
                                            "label": "return CredentialsMetaResponse(\n        id=credentials.id,\n        provider=credentials.provider,\n        type=credentials.type,\n        title=credentials.title,\n        scopes=credentials.scopes,\n        username=credentials.username,\n    )"
                                        }
                                    ],
                                    "label": ":\n    logger.debug(f\"Received OAuth callback for provider: {provider}\")\n    handler = _get_provider_oauth_handler(request, provider)\n\n    # Verify the state token\n    if not creds_manager.store.verify_state_token(user_id, state_token, provider):\n        logger.warning(f\"Invalid or expired state token for user {user_id}\")\n        raise HTTPException(status_code=400, detail=\"Invalid or expired state token\")\n\n    try:\n        scopes = creds_manager.store.get_any_valid_scopes_from_state_token(\n            user_id, state_token, provider\n        )\n        logger.debug(f\"Retrieved scopes from state token: {scopes}\")\n\n        scopes = handler.handle_default_scopes(scopes)\n\n        credentials = handler.exchange_code_for_tokens(code, scopes)\n        logger.debug(f\"Received credentials with final scopes: {credentials.scopes}\")\n\n        # Check if the granted scopes are sufficient for the requested scopes\n        if not set(scopes).issubset(set(credentials.scopes)):\n            # For now, we'll just log the warning and continue\n            logger.warning(\n                f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\"\n            )\n\n    except Exception as e:\n        logger.error(f\"Code->Token exchange failed for provider {provider.value}: {e}\")\n        raise HTTPException(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n        )\n\n    # TODO: Allow specifying `title` to set on `credentials`\n    creds_manager.create(user_id, credentials)\n\n    logger.debug(\n        f\"Successfully processed OAuth callback for user {user_id} \"\n        f\"and provider {provider.value}\"\n    )\n    return CredentialsMetaResponse(\n        id=credentials.id,\n        provider=credentials.provider,\n        type=credentials.type,\n        title=credentials.title,\n        scopes=credentials.scopes,\n        username=credentials.username,\n    )"
                                }
                            ],
                            "label": "def callback(\n    provider: Annotated[\n        ProviderName, Path(title=\"The target provider for this OAuth exchange\")\n    ],\n    code: Annotated[str, Body(title=\"Authorization code acquired by user login\")],\n    state_token: Annotated[str, Body(title=\"Anti-CSRF nonce\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n    request: Request,\n) -> CredentialsMetaResponse:\n    logger.debug(f\"Received OAuth callback for provider: {provider}\")\n    handler = _get_provider_oauth_handler(request, provider)\n\n    # Verify the state token\n    if not creds_manager.store.verify_state_token(user_id, state_token, provider):\n        logger.warning(f\"Invalid or expired state token for user {user_id}\")\n        raise HTTPException(status_code=400, detail=\"Invalid or expired state token\")\n\n    try:\n        scopes = creds_manager.store.get_any_valid_scopes_from_state_token(\n            user_id, state_token, provider\n        )\n        logger.debug(f\"Retrieved scopes from state token: {scopes}\")\n\n        scopes = handler.handle_default_scopes(scopes)\n\n        credentials = handler.exchange_code_for_tokens(code, scopes)\n        logger.debug(f\"Received credentials with final scopes: {credentials.scopes}\")\n\n        # Check if the granted scopes are sufficient for the requested scopes\n        if not set(scopes).issubset(set(credentials.scopes)):\n            # For now, we'll just log the warning and continue\n            logger.warning(\n                f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\"\n            )\n\n    except Exception as e:\n        logger.error(f\"Code->Token exchange failed for provider {provider.value}: {e}\")\n        raise HTTPException(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n        )\n\n    # TODO: Allow specifying `title` to set on `credentials`\n    creds_manager.create(user_id, credentials)\n\n    logger.debug(\n        f\"Successfully processed OAuth callback for user {user_id} \"\n        f\"and provider {provider.value}\"\n    )\n    return CredentialsMetaResponse(\n        id=credentials.id,\n        provider=credentials.provider,\n        type=credentials.type,\n        title=credentials.title,\n        scopes=credentials.scopes,\n        username=credentials.username,\n    )"
                        }
                    ],
                    "label": "def callback(\n    provider: Annotated[\n        ProviderName, Path(title=\"The target provider for this OAuth exchange\")\n    ],\n    code: Annotated[str, Body(title=\"Authorization code acquired by user login\")],\n    state_token: Annotated[str, Body(title=\"Anti-CSRF nonce\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n    request: Request,\n) -> CredentialsMetaResponse:\n    logger.debug(f\"Received OAuth callback for provider: {provider}\")\n    handler = _get_provider_oauth_handler(request, provider)\n\n    # Verify the state token\n    if not creds_manager.store.verify_state_token(user_id, state_token, provider):\n        logger.warning(f\"Invalid or expired state token for user {user_id}\")\n        raise HTTPException(status_code=400, detail=\"Invalid or expired state token\")\n\n    try:\n        scopes = creds_manager.store.get_any_valid_scopes_from_state_token(\n            user_id, state_token, provider\n        )\n        logger.debug(f\"Retrieved scopes from state token: {scopes}\")\n\n        scopes = handler.handle_default_scopes(scopes)\n\n        credentials = handler.exchange_code_for_tokens(code, scopes)\n        logger.debug(f\"Received credentials with final scopes: {credentials.scopes}\")\n\n        # Check if the granted scopes are sufficient for the requested scopes\n        if not set(scopes).issubset(set(credentials.scopes)):\n            # For now, we'll just log the warning and continue\n            logger.warning(\n                f\"Granted scopes {credentials.scopes} for provider {provider.value} \"\n                f\"do not include all requested scopes {scopes}\"\n            )\n\n    except Exception as e:\n        logger.error(f\"Code->Token exchange failed for provider {provider.value}: {e}\")\n        raise HTTPException(\n            status_code=400, detail=f\"Failed to exchange code for tokens: {str(e)}\"\n        )\n\n    # TODO: Allow specifying `title` to set on `credentials`\n    creds_manager.create(user_id, credentials)\n\n    logger.debug(\n        f\"Successfully processed OAuth callback for user {user_id} \"\n        f\"and provider {provider.value}\"\n    )\n    return CredentialsMetaResponse(\n        id=credentials.id,\n        provider=credentials.provider,\n        type=credentials.type,\n        title=credentials.title,\n        scopes=credentials.scopes,\n        username=credentials.username,\n    )\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "list_credentials",
            "start_line": 142,
            "end_line": 156,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 110,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 110,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "list_credentials"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 17,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 15,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 5,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 6,
                                                            "end_token": 8,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 6,
                                                                    "children": [],
                                                                    "label": "Annotated"
                                                                },
                                                                {
                                                                    "type": "type_parameter",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "children": [],
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "Annotated[str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 10,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": "Depends"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 11,
                                                                    "end_token": 13,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "children": [],
                                                                            "label": "get_user_id"
                                                                        }
                                                                    ],
                                                                    "label": "(get_user_id)"
                                                                }
                                                            ],
                                                            "label": "Depends(get_user_id)"
                                                        }
                                                    ],
                                                    "label": ": Annotated[str, Depends(get_user_id)]"
                                                }
                                            ],
                                            "label": "user_id: Annotated[str, Depends(get_user_id)],"
                                        }
                                    ],
                                    "label": "(\n    user_id: Annotated[str, Depends(get_user_id)],\n)"
                                },
                                {
                                    "type": "type",
                                    "start_token": 19,
                                    "end_token": 23,
                                    "children": [
                                        {
                                            "type": "generic_type",
                                            "start_token": 20,
                                            "end_token": 22,
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "start_token": 20,
                                                    "end_token": 20,
                                                    "children": [],
                                                    "label": "list"
                                                },
                                                {
                                                    "type": "type_parameter",
                                                    "start_token": 22,
                                                    "end_token": 22,
                                                    "children": [],
                                                    "label": "CredentialsMetaResponse"
                                                }
                                            ],
                                            "label": "list[CredentialsMetaResponse"
                                        }
                                    ],
                                    "label": "> list[CredentialsMetaResponse]"
                                },
                                {
                                    "type": "block",
                                    "start_token": 24,
                                    "end_token": 110,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 26,
                                            "end_token": 35,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 26,
                                                    "end_token": 26,
                                                    "children": [],
                                                    "label": "credentials"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 28,
                                                    "end_token": 35,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 28,
                                                            "end_token": 32,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 28,
                                                                    "end_token": 30,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 28,
                                                                            "end_token": 28,
                                                                            "children": [],
                                                                            "label": "creds_manager"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 30,
                                                                            "end_token": 30,
                                                                            "children": [],
                                                                            "label": "store"
                                                                        }
                                                                    ],
                                                                    "label": "creds_manager.store"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 32,
                                                                    "end_token": 32,
                                                                    "children": [],
                                                                    "label": "get_all_creds"
                                                                }
                                                            ],
                                                            "label": "creds_manager.store.get_all_creds"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 33,
                                                            "end_token": 35,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 34,
                                                                    "end_token": 34,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                }
                                                            ],
                                                            "label": "(user_id)"
                                                        }
                                                    ],
                                                    "label": "creds_manager.store.get_all_creds(user_id)"
                                                }
                                            ],
                                            "label": "credentials = creds_manager.store.get_all_creds(user_id)"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 37,
                                            "end_token": 110,
                                            "children": [
                                                {
                                                    "type": "list",
                                                    "start_token": 38,
                                                    "end_token": 110,
                                                    "children": [
                                                        {
                                                            "type": "list_comprehension",
                                                            "start_token": 39,
                                                            "end_token": 109,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 40,
                                                                    "end_token": 103,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 40,
                                                                            "end_token": 40,
                                                                            "children": [],
                                                                            "label": "CredentialsMetaResponse"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 41,
                                                                            "end_token": 103,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 43,
                                                                                    "end_token": 48,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 43,
                                                                                            "end_token": 43,
                                                                                            "children": [],
                                                                                            "label": "id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 45,
                                                                                            "end_token": 47,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 45,
                                                                                                    "end_token": 45,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 47,
                                                                                                    "end_token": 47,
                                                                                                    "children": [],
                                                                                                    "label": "id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "id=cred.id,"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 50,
                                                                                    "end_token": 55,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 50,
                                                                                            "end_token": 50,
                                                                                            "children": [],
                                                                                            "label": "provider"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 52,
                                                                                            "end_token": 54,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 52,
                                                                                                    "end_token": 52,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 54,
                                                                                                    "end_token": 54,
                                                                                                    "children": [],
                                                                                                    "label": "provider"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.provider"
                                                                                        }
                                                                                    ],
                                                                                    "label": "provider=cred.provider,"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 57,
                                                                                    "end_token": 62,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 57,
                                                                                            "end_token": 57,
                                                                                            "children": [],
                                                                                            "label": "type"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 59,
                                                                                            "end_token": 61,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 59,
                                                                                                    "end_token": 59,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 61,
                                                                                                    "end_token": 61,
                                                                                                    "children": [],
                                                                                                    "label": "type"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.type"
                                                                                        }
                                                                                    ],
                                                                                    "label": "type=cred.type,"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 64,
                                                                                    "end_token": 69,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 64,
                                                                                            "end_token": 64,
                                                                                            "children": [],
                                                                                            "label": "title"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 66,
                                                                                            "end_token": 68,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 66,
                                                                                                    "end_token": 66,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 68,
                                                                                                    "end_token": 68,
                                                                                                    "children": [],
                                                                                                    "label": "title"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.title"
                                                                                        }
                                                                                    ],
                                                                                    "label": "title=cred.title,"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 71,
                                                                                    "end_token": 100,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 71,
                                                                                            "end_token": 71,
                                                                                            "children": [],
                                                                                            "label": "scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "conditional_expression",
                                                                                            "start_token": 73,
                                                                                            "end_token": 100,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 73,
                                                                                                    "end_token": 75,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 73,
                                                                                                            "end_token": 73,
                                                                                                            "children": [],
                                                                                                            "label": "cred"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 75,
                                                                                                            "end_token": 75,
                                                                                                            "children": [],
                                                                                                            "label": "scopes"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "cred.scopes"
                                                                                                },
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "start_token": 76,
                                                                                                    "end_token": 83,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 77,
                                                                                                            "end_token": 82,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 77,
                                                                                                                    "end_token": 77,
                                                                                                                    "children": [],
                                                                                                                    "label": "isinstance"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 78,
                                                                                                                    "end_token": 82,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 79,
                                                                                                                            "end_token": 79,
                                                                                                                            "children": [],
                                                                                                                            "label": "cred"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "type",
                                                                                                                            "start_token": 81,
                                                                                                                            "end_token": 81,
                                                                                                                            "children": [],
                                                                                                                            "label": "OAuth2Credentials"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "(cred, OAuth2Credentials)"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "isinstance(cred, OAuth2Credentials)"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "none",
                                                                                                            "start_token": 84,
                                                                                                            "end_token": 84,
                                                                                                            "children": [],
                                                                                                            "label": "None"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "if isinstance(cred, OAuth2Credentials) else"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None"
                                                                                        }
                                                                                    ],
                                                                                    "label": "scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 87,
                                                                                    "end_token": 100,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 87,
                                                                                            "end_token": 87,
                                                                                            "children": [],
                                                                                            "label": "username"
                                                                                        },
                                                                                        {
                                                                                            "type": "conditional_expression",
                                                                                            "start_token": 89,
                                                                                            "end_token": 100,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 89,
                                                                                                    "end_token": 91,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 89,
                                                                                                            "end_token": 89,
                                                                                                            "children": [],
                                                                                                            "label": "cred"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 91,
                                                                                                            "end_token": 91,
                                                                                                            "children": [],
                                                                                                            "label": "username"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "cred.username"
                                                                                                },
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "start_token": 92,
                                                                                                    "end_token": 99,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 93,
                                                                                                            "end_token": 98,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 93,
                                                                                                                    "end_token": 93,
                                                                                                                    "children": [],
                                                                                                                    "label": "isinstance"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 94,
                                                                                                                    "end_token": 98,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 95,
                                                                                                                            "end_token": 95,
                                                                                                                            "children": [],
                                                                                                                            "label": "cred"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "type",
                                                                                                                            "start_token": 97,
                                                                                                                            "end_token": 97,
                                                                                                                            "children": [],
                                                                                                                            "label": "OAuth2Credentials"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "(cred, OAuth2Credentials)"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "isinstance(cred, OAuth2Credentials)"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "none",
                                                                                                            "start_token": 100,
                                                                                                            "end_token": 100,
                                                                                                            "children": [],
                                                                                                            "label": "None"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "if isinstance(cred, OAuth2Credentials) else"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.username if isinstance(cred, OAuth2Credentials) else None"
                                                                                        }
                                                                                    ],
                                                                                    "label": "username=cred.username if isinstance(cred, OAuth2Credentials) else None"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )"
                                                                },
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "start_token": 105,
                                                                    "end_token": 108,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 106,
                                                                            "end_token": 106,
                                                                            "children": [],
                                                                            "label": "cred"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 108,
                                                                            "end_token": 108,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        }
                                                                    ],
                                                                    "label": "for cred in credentials"
                                                                }
                                                            ],
                                                            "label": "\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n"
                                                        }
                                                    ],
                                                    "label": "[\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                                                }
                                            ],
                                            "label": "return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                                        }
                                    ],
                                    "label": ":\n    credentials = creds_manager.store.get_all_creds(user_id)\n    return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                                }
                            ],
                            "label": "def list_credentials(\n    user_id: Annotated[str, Depends(get_user_id)],\n) -> list[CredentialsMetaResponse]:\n    credentials = creds_manager.store.get_all_creds(user_id)\n    return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                        }
                    ],
                    "label": "def list_credentials(\n    user_id: Annotated[str, Depends(get_user_id)],\n) -> list[CredentialsMetaResponse]:\n    credentials = creds_manager.store.get_all_creds(user_id)\n    return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "list_credentials_by_provider",
            "start_line": 160,
            "end_line": 177,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 129,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 129,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "list_credentials_by_provider"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 34,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 19,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "provider"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 6,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 9,
                                                                    "end_token": 9,
                                                                    "children": [],
                                                                    "label": "ProviderName"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "children": [],
                                                                    "label": "Path"
                                                                }
                                                            ],
                                                            "label": "ProviderName, Path"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 12,
                                                            "end_token": 16,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 13,
                                                                    "end_token": 15,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "children": [],
                                                                            "label": "title"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "children": [],
                                                                            "label": "\"The provider to list credentials for\""
                                                                        }
                                                                    ],
                                                                    "label": "title=\"The provider to list credentials for\""
                                                                }
                                                            ],
                                                            "label": "(title=\"The provider to list credentials for\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n        ProviderName, Path(title=\"The provider to list credentials for\")\n    ]"
                                                }
                                            ],
                                            "label": "provider: Annotated[\n        ProviderName, Path(title=\"The provider to list credentials for\")\n    ],"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 21,
                                            "end_token": 31,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 21,
                                                    "end_token": 21,
                                                    "children": [],
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 23,
                                                    "end_token": 31,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 25,
                                                            "end_token": 25,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 27,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 29,
                                                                    "end_token": 29,
                                                                    "children": [],
                                                                    "label": "get_user_id"
                                                                }
                                                            ],
                                                            "label": "Depends(get_user_id)"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Depends(get_user_id)]"
                                                }
                                            ],
                                            "label": "user_id: Annotated[str, Depends(get_user_id)]"
                                        }
                                    ],
                                    "label": "(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to list credentials for\")\n    ],\n    user_id: Annotated[str, Depends(get_user_id)],\n)"
                                },
                                {
                                    "type": "union_type",
                                    "start_token": 36,
                                    "end_token": 40,
                                    "children": [
                                        {
                                            "type": "list",
                                            "start_token": 37,
                                            "end_token": 39,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 39,
                                                    "end_token": 39,
                                                    "children": [],
                                                    "label": "CredentialsMetaResponse"
                                                }
                                            ],
                                            "label": "list[CredentialsMetaResponse"
                                        }
                                    ],
                                    "label": "> list[CredentialsMetaResponse]"
                                },
                                {
                                    "type": "block",
                                    "start_token": 41,
                                    "end_token": 129,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 43,
                                            "end_token": 54,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 43,
                                                    "end_token": 43,
                                                    "children": [],
                                                    "label": "credentials"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 45,
                                                    "end_token": 54,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 45,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 45,
                                                                    "end_token": 45,
                                                                    "children": [],
                                                                    "label": "creds_manager"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 49,
                                                                    "end_token": 49,
                                                                    "children": [],
                                                                    "label": "get_creds_by_provider"
                                                                }
                                                            ],
                                                            "label": "creds_manager.store.get_creds_by_provider"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 50,
                                                            "end_token": 54,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 51,
                                                                    "end_token": 51,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 53,
                                                                    "end_token": 53,
                                                                    "children": [],
                                                                    "label": "provider"
                                                                }
                                                            ],
                                                            "label": "(user_id, provider)"
                                                        }
                                                    ],
                                                    "label": "creds_manager.store.get_creds_by_provider(user_id, provider)"
                                                }
                                            ],
                                            "label": "credentials = creds_manager.store.get_creds_by_provider(user_id, provider)"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 56,
                                            "end_token": 129,
                                            "children": [
                                                {
                                                    "type": "list_comprehension",
                                                    "start_token": 57,
                                                    "end_token": 129,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 59,
                                                            "end_token": 122,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 59,
                                                                    "end_token": 59,
                                                                    "children": [],
                                                                    "label": "CredentialsMetaResponse"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 60,
                                                                    "end_token": 120,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 62,
                                                                            "end_token": 64,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 62,
                                                                                    "end_token": 62,
                                                                                    "children": [],
                                                                                    "label": "id"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 64,
                                                                                    "end_token": 66,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 64,
                                                                                            "end_token": 64,
                                                                                            "children": [],
                                                                                            "label": "cred"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 66,
                                                                                            "end_token": 66,
                                                                                            "children": [],
                                                                                            "label": "id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cred.id"
                                                                                }
                                                                            ],
                                                                            "label": "id=cred"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 69,
                                                                            "end_token": 73,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 69,
                                                                                    "end_token": 69,
                                                                                    "children": [],
                                                                                    "label": "provider"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 71,
                                                                                    "end_token": 73,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 71,
                                                                                            "end_token": 71,
                                                                                            "children": [],
                                                                                            "label": "cred"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 73,
                                                                                            "end_token": 73,
                                                                                            "children": [],
                                                                                            "label": "provider"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cred.provider"
                                                                                }
                                                                            ],
                                                                            "label": "provider=cred.provider"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 76,
                                                                            "end_token": 80,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 76,
                                                                                    "end_token": 76,
                                                                                    "children": [],
                                                                                    "label": "type"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 78,
                                                                                    "end_token": 80,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 78,
                                                                                            "end_token": 78,
                                                                                            "children": [],
                                                                                            "label": "cred"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 80,
                                                                                            "end_token": 80,
                                                                                            "children": [],
                                                                                            "label": "type"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cred.type"
                                                                                }
                                                                            ],
                                                                            "label": "type=cred.type"
                                                                        },
                                                                        {
                                                                            "type": "conditional_expression",
                                                                            "start_token": 83,
                                                                            "end_token": 103,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 83,
                                                                                    "end_token": 87,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 83,
                                                                                            "end_token": 83,
                                                                                            "children": [],
                                                                                            "label": "title"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 85,
                                                                                            "end_token": 87,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 85,
                                                                                                    "end_token": 85,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 87,
                                                                                                    "end_token": 87,
                                                                                                    "children": [],
                                                                                                    "label": "title"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.title"
                                                                                        }
                                                                                    ],
                                                                                    "label": "title=cred.title"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 95,
                                                                                    "end_token": 101,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 95,
                                                                                            "end_token": 95,
                                                                                            "children": [],
                                                                                            "label": "if"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 96,
                                                                                            "end_token": 100,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 98,
                                                                                                    "end_token": 98,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 100,
                                                                                                    "end_token": 100,
                                                                                                    "children": [],
                                                                                                    "label": "OAuth2Credentials"
                                                                                                }
                                                                                            ],
                                                                                            "label": "isinstance(cred, OAuth2Credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "if isinstance(cred, OAuth2Credentials)"
                                                                                },
                                                                                {
                                                                                    "type": "none",
                                                                                    "start_token": 103,
                                                                                    "end_token": 103,
                                                                                    "children": [],
                                                                                    "label": "None"
                                                                                }
                                                                            ],
                                                                            "label": "title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None"
                                                                        },
                                                                        {
                                                                            "type": "conditional_expression",
                                                                            "start_token": 106,
                                                                            "end_token": 119,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 106,
                                                                                    "end_token": 110,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 106,
                                                                                            "end_token": 106,
                                                                                            "children": [],
                                                                                            "label": "username"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 108,
                                                                                            "end_token": 110,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 108,
                                                                                                    "end_token": 108,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 110,
                                                                                                    "end_token": 110,
                                                                                                    "children": [],
                                                                                                    "label": "username"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cred.username"
                                                                                        }
                                                                                    ],
                                                                                    "label": "username=cred.username"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 112,
                                                                                    "end_token": 117,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 112,
                                                                                            "end_token": 112,
                                                                                            "children": [],
                                                                                            "label": "isinstance"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 113,
                                                                                            "end_token": 116,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 114,
                                                                                                    "end_token": 114,
                                                                                                    "children": [],
                                                                                                    "label": "cred"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 116,
                                                                                                    "end_token": 116,
                                                                                                    "children": [],
                                                                                                    "label": "OAuth2Credentials"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(cred, OAuth2Credentials"
                                                                                        }
                                                                                    ],
                                                                                    "label": "isinstance(cred, OAuth2Credentials)"
                                                                                },
                                                                                {
                                                                                    "type": "none",
                                                                                    "start_token": 119,
                                                                                    "end_token": 119,
                                                                                    "children": [],
                                                                                    "label": "None"
                                                                                }
                                                                            ],
                                                                            "label": "username=cred.username if isinstance(cred, OAuth2Credentials) else None"
                                                                        }
                                                                    ],
                                                                    "label": "(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,"
                                                                }
                                                            ],
                                                            "label": "CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )"
                                                        },
                                                        {
                                                            "type": "for_in_clause",
                                                            "start_token": 124,
                                                            "end_token": 127,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 125,
                                                                    "end_token": 125,
                                                                    "children": [],
                                                                    "label": "cred"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 127,
                                                                    "end_token": 127,
                                                                    "children": [],
                                                                    "label": "credentials"
                                                                }
                                                            ],
                                                            "label": "for cred in credentials"
                                                        }
                                                    ],
                                                    "label": "[\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                                                }
                                            ],
                                            "label": "return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                                        }
                                    ],
                                    "label": ":\n    credentials = creds_manager.store.get_creds_by_provider(user_id, provider)\n    return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                                }
                            ],
                            "label": "def list_credentials_by_provider(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to list credentials for\")\n    ],\n    user_id: Annotated[str, Depends(get_user_id)],\n) -> list[CredentialsMetaResponse]:\n    credentials = creds_manager.store.get_creds_by_provider(user_id, provider)\n    return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                        }
                    ],
                    "label": "def list_credentials_by_provider(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to list credentials for\")\n    ],\n    user_id: Annotated[str, Depends(get_user_id)],\n) -> list[CredentialsMetaResponse]:\n    credentials = creds_manager.store.get_creds_by_provider(user_id, provider)\n    return [\n        CredentialsMetaResponse(\n            id=cred.id,\n            provider=cred.provider,\n            type=cred.type,\n            title=cred.title,\n            scopes=cred.scopes if isinstance(cred, OAuth2Credentials) else None,\n            username=cred.username if isinstance(cred, OAuth2Credentials) else None,\n        )\n        for cred in credentials\n    ]"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "get_credential",
            "start_line": 181,
            "end_line": 195,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 108,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 108,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "get_credential"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 49,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 19,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "provider"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 6,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 9,
                                                            "end_token": 9,
                                                            "children": [],
                                                            "label": "ProviderName"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 12,
                                                            "end_token": 16,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 13,
                                                                    "end_token": 15,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "children": [],
                                                                            "label": "title"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "children": [],
                                                                            "label": "\"The provider to retrieve credentials for\""
                                                                        }
                                                                    ],
                                                                    "label": "title=\"The provider to retrieve credentials for\""
                                                                }
                                                            ],
                                                            "label": "(title=\"The provider to retrieve credentials for\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n        ProviderName, Path(title=\"The provider to retrieve credentials for\")\n    ]"
                                                }
                                            ],
                                            "label": "provider: Annotated[\n        ProviderName, Path(title=\"The provider to retrieve credentials for\")\n    ],"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 21,
                                            "end_token": 33,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 21,
                                                    "end_token": 21,
                                                    "children": [],
                                                    "label": "cred_id"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 23,
                                                    "end_token": 32,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 25,
                                                            "end_token": 25,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 28,
                                                            "end_token": 32,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 29,
                                                                    "end_token": 31,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 29,
                                                                            "end_token": 29,
                                                                            "children": [],
                                                                            "label": "title"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 31,
                                                                            "end_token": 31,
                                                                            "children": [],
                                                                            "label": "\"The ID of the credentials to retrieve\""
                                                                        }
                                                                    ],
                                                                    "label": "title=\"The ID of the credentials to retrieve\""
                                                                }
                                                            ],
                                                            "label": "(title=\"The ID of the credentials to retrieve\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Path(title=\"The ID of the credentials to retrieve\")"
                                                }
                                            ],
                                            "label": "cred_id: Annotated[str, Path(title=\"The ID of the credentials to retrieve\")]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 36,
                                            "end_token": 46,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 36,
                                                    "end_token": 36,
                                                    "children": [],
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 38,
                                                    "end_token": 46,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 40,
                                                            "end_token": 40,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 43,
                                                            "end_token": 45,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 44,
                                                                    "end_token": 44,
                                                                    "children": [],
                                                                    "label": "get_user_id"
                                                                }
                                                            ],
                                                            "label": "(get_user_id)"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Depends(get_user_id)]"
                                                }
                                            ],
                                            "label": "user_id: Annotated[str, Depends(get_user_id)]"
                                        }
                                    ],
                                    "label": "(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to retrieve credentials for\")\n    ],\n    cred_id: Annotated[str, Path(title=\"The ID of the credentials to retrieve\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 53,
                                    "end_token": 108,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 55,
                                            "end_token": 64,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 55,
                                                    "end_token": 55,
                                                    "children": [],
                                                    "label": "credential"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 58,
                                                    "end_token": 64,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 58,
                                                            "end_token": 59,
                                                            "children": [],
                                                            "label": ".get"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 60,
                                                            "end_token": 64,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 61,
                                                                    "end_token": 61,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 63,
                                                                    "end_token": 63,
                                                                    "children": [],
                                                                    "label": "cred_id"
                                                                }
                                                            ],
                                                            "label": "(user_id, cred_id)"
                                                        }
                                                    ],
                                                    "label": ".get(user_id, cred_id)"
                                                }
                                            ],
                                            "label": "credential = creds_manager.get(user_id, cred_id)"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 66,
                                            "end_token": 81,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 67,
                                                    "end_token": 68,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 68,
                                                            "end_token": 68,
                                                            "children": [],
                                                            "label": "credential"
                                                        }
                                                    ],
                                                    "label": "not credential"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 70,
                                                    "end_token": 81,
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 71,
                                                            "end_token": 81,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 72,
                                                                    "end_token": 81,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 74,
                                                                            "end_token": 76,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 74,
                                                                                    "end_token": 74,
                                                                                    "children": [],
                                                                                    "label": "status_code"
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 76,
                                                                                    "end_token": 76,
                                                                                    "children": [],
                                                                                    "label": "404"
                                                                                }
                                                                            ],
                                                                            "label": "status_code=404"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 78,
                                                                            "end_token": 80,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 78,
                                                                                    "end_token": 78,
                                                                                    "children": [],
                                                                                    "label": "detail"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 80,
                                                                                    "end_token": 80,
                                                                                    "children": [],
                                                                                    "label": "\"Credentials not found\""
                                                                                }
                                                                            ],
                                                                            "label": "detail=\"Credentials not found\""
                                                                        }
                                                                    ],
                                                                    "label": "HTTPException(status_code=404, detail=\"Credentials not found\")"
                                                                }
                                                            ],
                                                            "label": "raise HTTPException(status_code=404, detail=\"Credentials not found\")"
                                                        }
                                                    ],
                                                    "label": "\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")"
                                                }
                                            ],
                                            "label": "if not credential:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 83,
                                            "end_token": 104,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 85,
                                                    "end_token": 89,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 85,
                                                            "end_token": 86,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 84,
                                                                    "end_token": 84,
                                                                    "children": [],
                                                                    "label": "credential"
                                                                }
                                                            ],
                                                            "label": ".provider"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 89,
                                                            "end_token": 89,
                                                            "children": [],
                                                            "label": "provider"
                                                        }
                                                    ],
                                                    "label": ".provider != provider"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 91,
                                                    "end_token": 104,
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 92,
                                                            "end_token": 104,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 93,
                                                                    "end_token": 103,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 96,
                                                                            "end_token": 98,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 96,
                                                                                    "end_token": 96,
                                                                                    "children": [],
                                                                                    "label": "status_code"
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 98,
                                                                                    "end_token": 98,
                                                                                    "children": [],
                                                                                    "label": "404"
                                                                                }
                                                                            ],
                                                                            "label": "status_code=404"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 100,
                                                                            "end_token": 102,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 100,
                                                                                    "end_token": 100,
                                                                                    "children": [],
                                                                                    "label": "detail"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 102,
                                                                                    "end_token": 102,
                                                                                    "children": [],
                                                                                    "label": "\"Credentials do not match the specified provider\""
                                                                                }
                                                                            ],
                                                                            "label": "detail=\"Credentials do not match the specified provider\""
                                                                        }
                                                                    ],
                                                                    "label": "HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n"
                                                                }
                                                            ],
                                                            "label": "raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )"
                                                }
                                            ],
                                            "label": "if credential.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 106,
                                            "end_token": 107,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 107,
                                                    "end_token": 107,
                                                    "children": [],
                                                    "label": "credential"
                                                }
                                            ],
                                            "label": "return credential"
                                        }
                                    ],
                                    "label": ":\n    credential = creds_manager.get(user_id, cred_id)\n    if not credential:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")\n    if credential.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )\n    return credential\n"
                                }
                            ],
                            "label": "def get_credential(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to retrieve credentials for\")\n    ],\n    cred_id: Annotated[str, Path(title=\"The ID of the credentials to retrieve\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n) -> Credentials:\n    credential = creds_manager.get(user_id, cred_id)\n    if not credential:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")\n    if credential.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )\n    return credential\n"
                        }
                    ],
                    "label": "def get_credential(\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to retrieve credentials for\")\n    ],\n    cred_id: Annotated[str, Path(title=\"The ID of the credentials to retrieve\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n) -> Credentials:\n    credential = creds_manager.get(user_id, cred_id)\n    if not credential:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")\n    if credential.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )\n    return credential\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "create_api_key_credentials",
            "start_line": 199,
            "end_line": 223,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 157,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 157,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "create_api_key_credentials"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 85,
                                    "children": [
                                        {
                                            "type": "typed_default_parameter",
                                            "start_token": 4,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 6,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 8,
                                                            "end_token": 8,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 10,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": "Depends"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 11,
                                                                    "end_token": 13,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "children": [],
                                                                            "label": "get_user_id"
                                                                        }
                                                                    ],
                                                                    "label": "(get_user_id)"
                                                                }
                                                            ],
                                                            "label": "Depends(get_user_id)"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Depends(get_user_id)]"
                                                }
                                            ],
                                            "label": "user_id: Annotated[str, Depends(get_user_id)]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 17,
                                            "end_token": 31,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 17,
                                                    "end_token": 17,
                                                    "children": [],
                                                    "label": "provider"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 19,
                                                    "end_token": 31,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 22,
                                                            "end_token": 22,
                                                            "children": [],
                                                            "label": "ProviderName"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 24,
                                                            "end_token": 29,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 24,
                                                                    "end_token": 24,
                                                                    "children": [],
                                                                    "label": "Path"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 25,
                                                                    "end_token": 29,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 26,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "children": [],
                                                                                    "label": "title"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [],
                                                                                    "label": "\"The provider to create credentials for\""
                                                                                }
                                                                            ],
                                                                            "label": "title=\"The provider to create credentials for\""
                                                                        }
                                                                    ],
                                                                    "label": "(title=\"The provider to create credentials for\")"
                                                                }
                                                            ],
                                                            "label": "Path(title=\"The provider to create credentials for\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n        ProviderName, Path(title=\"The provider to create credentials for\")\n    ]"
                                                }
                                            ],
                                            "label": "provider: Annotated[\n        ProviderName, Path(title=\"The provider to create credentials for\")\n    ]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 34,
                                            "end_token": 46,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 34,
                                                    "end_token": 34,
                                                    "children": [],
                                                    "label": "api_key"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 36,
                                                    "end_token": 46,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 38,
                                                            "end_token": 38,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 40,
                                                            "end_token": 45,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 40,
                                                                    "end_token": 40,
                                                                    "children": [],
                                                                    "label": "Body"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 41,
                                                                    "end_token": 45,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 42,
                                                                            "end_token": 44,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 42,
                                                                                    "end_token": 42,
                                                                                    "children": [],
                                                                                    "label": "title"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 44,
                                                                                    "end_token": 44,
                                                                                    "children": [],
                                                                                    "label": "\"The API key to store\""
                                                                                }
                                                                            ],
                                                                            "label": "title=\"The API key to store\""
                                                                        }
                                                                    ],
                                                                    "label": "(title=\"The API key to store\")"
                                                                }
                                                            ],
                                                            "label": "Body(title=\"The API key to store\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Body(title=\"The API key to store\")]"
                                                }
                                            ],
                                            "label": "api_key: Annotated[str, Body(title=\"The API key to store\")]"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 49,
                                            "end_token": 61,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 49,
                                                    "end_token": 49,
                                                    "children": [],
                                                    "label": "title"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 51,
                                                    "end_token": 61,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 53,
                                                            "end_token": 53,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 55,
                                                            "end_token": 60,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 55,
                                                                    "end_token": 55,
                                                                    "children": [],
                                                                    "label": "Body"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 56,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 57,
                                                                            "end_token": 59,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 57,
                                                                                    "end_token": 57,
                                                                                    "children": [],
                                                                                    "label": "title"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 59,
                                                                                    "end_token": 59,
                                                                                    "children": [],
                                                                                    "label": "\"Optional title for the credentials\""
                                                                                }
                                                                            ],
                                                                            "label": "title=\"Optional title for the credentials\""
                                                                        }
                                                                    ],
                                                                    "label": "(title=\"Optional title for the credentials\")"
                                                                }
                                                            ],
                                                            "label": "Body(title=\"Optional title for the credentials\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Body(title=\"Optional title for the credentials\")]"
                                                }
                                            ],
                                            "label": "title: Annotated[str, Body(title=\"Optional title for the credentials\")]"
                                        },
                                        {
                                            "type": "typed_default_parameter",
                                            "start_token": 64,
                                            "end_token": 83,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 64,
                                                    "end_token": 64,
                                                    "children": [],
                                                    "label": "expires_at"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 66,
                                                    "end_token": 68,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 69,
                                                            "end_token": 69,
                                                            "children": [],
                                                            "label": "int"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 71,
                                                            "end_token": 71,
                                                            "children": [],
                                                            "label": "None"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 73,
                                                    "end_token": 78,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 73,
                                                            "end_token": 73,
                                                            "children": [],
                                                            "label": "Body"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 74,
                                                            "end_token": 78,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 75,
                                                                    "end_token": 77,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 75,
                                                                            "end_token": 75,
                                                                            "children": [],
                                                                            "label": "title"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 77,
                                                                            "end_token": 77,
                                                                            "children": [],
                                                                            "label": "\"Unix timestamp when the key expires\""
                                                                        }
                                                                    ],
                                                                    "label": "title=\"Unix timestamp when the key expires\""
                                                                }
                                                            ],
                                                            "label": "(title=\"Unix timestamp when the key expires\")"
                                                        }
                                                    ],
                                                    "label": "Body(title=\"Unix timestamp when the key expires\")"
                                                },
                                                {
                                                    "type": "none",
                                                    "start_token": 82,
                                                    "end_token": 82,
                                                    "children": [],
                                                    "label": "None"
                                                }
                                            ],
                                            "label": "expires_at: Annotated[\n        int | None, Body(title=\"Unix timestamp when the key expires\")\n    ] = None,"
                                        }
                                    ],
                                    "label": "(\n    user_id: Annotated[str, Depends(get_user_id)],\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to create credentials for\")\n    ],\n    api_key: Annotated[str, Body(title=\"The API key to store\")],\n    title: Annotated[str, Body(title=\"Optional title for the credentials\")],\n    expires_at: Annotated[\n        int | None, Body(title=\"Unix timestamp when the key expires\")\n    ] = None,\n)"
                                },
                                {
                                    "type": "type",
                                    "start_token": 87,
                                    "end_token": 87,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 88,
                                            "end_token": 88,
                                            "children": [],
                                            "label": "APIKeyCredentials"
                                        }
                                    ],
                                    "label": ">"
                                },
                                {
                                    "type": "block",
                                    "start_token": 89,
                                    "end_token": 157,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 91,
                                            "end_token": 119,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 91,
                                                    "end_token": 91,
                                                    "children": [],
                                                    "label": "new_credentials"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 93,
                                                    "end_token": 119,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 93,
                                                            "end_token": 93,
                                                            "children": [],
                                                            "label": "APIKeyCredentials"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 94,
                                                            "end_token": 119,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 96,
                                                                    "end_token": 98,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 96,
                                                                            "end_token": 96,
                                                                            "children": [],
                                                                            "label": "provider"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 98,
                                                                            "end_token": 98,
                                                                            "children": [],
                                                                            "label": "provider"
                                                                        }
                                                                    ],
                                                                    "label": "provider=provider"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 101,
                                                                    "end_token": 107,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 101,
                                                                            "end_token": 101,
                                                                            "children": [],
                                                                            "label": "api_key"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 103,
                                                                            "end_token": 107,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 103,
                                                                                    "end_token": 103,
                                                                                    "children": [],
                                                                                    "label": "SecretStr"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 104,
                                                                                    "end_token": 106,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 105,
                                                                                            "end_token": 105,
                                                                                            "children": [],
                                                                                            "label": "api_key"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(api_key)"
                                                                                }
                                                                            ],
                                                                            "label": "SecretStr(api_key),"
                                                                        }
                                                                    ],
                                                                    "label": "api_key=SecretStr(api_key),"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 109,
                                                                    "end_token": 111,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 109,
                                                                            "end_token": 109,
                                                                            "children": [],
                                                                            "label": "title"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 111,
                                                                            "end_token": 111,
                                                                            "children": [],
                                                                            "label": "title"
                                                                        }
                                                                    ],
                                                                    "label": "title=title"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 114,
                                                                    "end_token": 116,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 114,
                                                                            "end_token": 114,
                                                                            "children": [],
                                                                            "label": "expires_at"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 116,
                                                                            "end_token": 116,
                                                                            "children": [],
                                                                            "label": "expires_at"
                                                                        }
                                                                    ],
                                                                    "label": "expires_at=expires_at"
                                                                }
                                                            ],
                                                            "label": "(\n        provider=provider,\n        api_key=SecretStr(api_key),\n        title=title,\n        expires_at=expires_at,\n    )"
                                                        }
                                                    ],
                                                    "label": "APIKeyCredentials(\n        provider=provider,\n        api_key=SecretStr(api_key),\n        title=title,\n        expires_at=expires_at,\n    )"
                                                }
                                            ],
                                            "label": "new_credentials = APIKeyCredentials(\n        provider=provider,\n        api_key=SecretStr(api_key),\n        title=title,\n        expires_at=expires_at,\n    )"
                                        },
                                        {
                                            "type": "try_statement",
                                            "start_token": 122,
                                            "end_token": 154,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 124,
                                                    "end_token": 132,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 125,
                                                            "end_token": 132,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 125,
                                                                    "end_token": 127,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 125,
                                                                            "end_token": 125,
                                                                            "children": [],
                                                                            "label": "creds_manager"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 127,
                                                                            "end_token": 127,
                                                                            "children": [],
                                                                            "label": "create"
                                                                        }
                                                                    ],
                                                                    "label": "creds_manager.create"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 128,
                                                                    "end_token": 132,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 129,
                                                                            "end_token": 129,
                                                                            "children": [],
                                                                            "label": "user_id"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 131,
                                                                            "end_token": 131,
                                                                            "children": [],
                                                                            "label": "new_credentials"
                                                                        }
                                                                    ],
                                                                    "label": "(user_id, new_credentials)"
                                                                }
                                                            ],
                                                            "label": "creds_manager.create(user_id, new_credentials)"
                                                        }
                                                    ],
                                                    "label": "\n        creds_manager.create(user_id, new_credentials)"
                                                },
                                                {
                                                    "type": "except_clause",
                                                    "start_token": 134,
                                                    "end_token": 153,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 135,
                                                            "end_token": 135,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 135,
                                                                    "end_token": 135,
                                                                    "children": [],
                                                                    "label": "Exception"
                                                                }
                                                            ],
                                                            "label": "Exception"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 137,
                                                            "end_token": 137,
                                                            "children": [],
                                                            "label": "e"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 138,
                                                            "end_token": 153,
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 140,
                                                                    "end_token": 153,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 141,
                                                                            "end_token": 153,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 141,
                                                                                    "end_token": 141,
                                                                                    "children": [],
                                                                                    "label": "HTTPException"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 142,
                                                                                    "end_token": 152,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 144,
                                                                                            "end_token": 146,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 144,
                                                                                                    "end_token": 144,
                                                                                                    "children": [],
                                                                                                    "label": "status_code"
                                                                                                },
                                                                                                {
                                                                                                    "type": "integer",
                                                                                                    "start_token": 146,
                                                                                                    "end_token": 146,
                                                                                                    "children": [],
                                                                                                    "label": "500"
                                                                                                }
                                                                                            ],
                                                                                            "label": "status_code=500"
                                                                                        },
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 148,
                                                                                            "end_token": 150,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 148,
                                                                                                    "end_token": 148,
                                                                                                    "children": [],
                                                                                                    "label": "detail"
                                                                                                },
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "start_token": 150,
                                                                                                    "end_token": 151,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 150,
                                                                                                            "end_token": 150,
                                                                                                            "children": [],
                                                                                                            "label": "f"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "start_token": 151,
                                                                                                            "end_token": 151,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "start_token": 151,
                                                                                                                    "end_token": 151,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 151,
                                                                                                                            "end_token": 151,
                                                                                                                            "children": [],
                                                                                                                            "label": "\"Failed to store credentials: {str(e)}\""
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "\"Failed to store credentials: {str(e)}\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"Failed to store credentials: {str(e)}\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "f\"Failed to store credentials: {str(e)}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "detail=f"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n"
                                                                                }
                                                                            ],
                                                                            "label": "HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "raise HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )"
                                                                }
                                                            ],
                                                            "label": ":\n        raise HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )"
                                                        }
                                                    ],
                                                    "label": "except Exception as e:\n        raise HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )"
                                                }
                                            ],
                                            "label": "try:\n        creds_manager.create(user_id, new_credentials)\n    except Exception as e:\n        raise HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )\n"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 155,
                                            "end_token": 156,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 156,
                                                    "end_token": 156,
                                                    "children": [],
                                                    "label": "new_credentials"
                                                }
                                            ],
                                            "label": "return new_credentials"
                                        }
                                    ],
                                    "label": ":\n    new_credentials = APIKeyCredentials(\n        provider=provider,\n        api_key=SecretStr(api_key),\n        title=title,\n        expires_at=expires_at,\n    )\n\n    try:\n        creds_manager.create(user_id, new_credentials)\n    except Exception as e:\n        raise HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )\n    return new_credentials\n"
                                }
                            ],
                            "label": "def create_api_key_credentials(\n    user_id: Annotated[str, Depends(get_user_id)],\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to create credentials for\")\n    ],\n    api_key: Annotated[str, Body(title=\"The API key to store\")],\n    title: Annotated[str, Body(title=\"Optional title for the credentials\")],\n    expires_at: Annotated[\n        int | None, Body(title=\"Unix timestamp when the key expires\")\n    ] = None,\n) -> APIKeyCredentials:\n    new_credentials = APIKeyCredentials(\n        provider=provider,\n        api_key=SecretStr(api_key),\n        title=title,\n        expires_at=expires_at,\n    )\n\n    try:\n        creds_manager.create(user_id, new_credentials)\n    except Exception as e:\n        raise HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )\n    return new_credentials\n"
                        }
                    ],
                    "label": "def create_api_key_credentials(\n    user_id: Annotated[str, Depends(get_user_id)],\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to create credentials for\")\n    ],\n    api_key: Annotated[str, Body(title=\"The API key to store\")],\n    title: Annotated[str, Body(title=\"Optional title for the credentials\")],\n    expires_at: Annotated[\n        int | None, Body(title=\"Unix timestamp when the key expires\")\n    ] = None,\n) -> APIKeyCredentials:\n    new_credentials = APIKeyCredentials(\n        provider=provider,\n        api_key=SecretStr(api_key),\n        title=title,\n        expires_at=expires_at,\n    )\n\n    try:\n        creds_manager.create(user_id, new_credentials)\n    except Exception as e:\n        raise HTTPException(\n            status_code=500, detail=f\"Failed to store credentials: {str(e)}\"\n        )\n    return new_credentials\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "delete_credentials",
            "start_line": 242,
            "end_line": 273,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 213,
                    "children": [
                        {
                            "type": "async",
                            "start_token": 0,
                            "end_token": 0,
                            "children": [
                                {
                                    "type": "function_definition",
                                    "start_token": 1,
                                    "end_token": 213,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 2,
                                            "end_token": 2,
                                            "label": "delete_credentials"
                                        },
                                        {
                                            "type": "parameters",
                                            "start_token": 3,
                                            "end_token": 74,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "start_token": 5,
                                                    "end_token": 7,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 5,
                                                            "end_token": 5,
                                                            "label": "request"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 7,
                                                            "end_token": 7,
                                                            "label": "Request"
                                                        }
                                                    ],
                                                    "label": "request: Request"
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 10,
                                                    "end_token": 22,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 10,
                                                            "end_token": 10,
                                                            "label": "provider"
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 12,
                                                            "end_token": 22,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 15,
                                                                    "end_token": 21,
                                                                    "label": "ProviderName, Path(title=\"The provider to delete credentials for\""
                                                                }
                                                            ],
                                                            "label": "Annotated[\n        ProviderName, Path(title=\"The provider to delete credentials for\")"
                                                        }
                                                    ],
                                                    "label": "provider: Annotated[\n        ProviderName, Path(title=\"The provider to delete credentials for\")"
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 27,
                                                    "end_token": 39,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 27,
                                                            "end_token": 27,
                                                            "label": "cred_id"
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 29,
                                                            "end_token": 39,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 31,
                                                                    "end_token": 38,
                                                                    "label": "str, Path(title=\"The ID of the credentials to delete\")"
                                                                }
                                                            ],
                                                            "label": "Annotated[str, Path(title=\"The ID of the credentials to delete\")]"
                                                        }
                                                    ],
                                                    "label": "cred_id: Annotated[str, Path(title=\"The ID of the credentials to delete\")]"
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "start_token": 42,
                                                    "end_token": 52,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 42,
                                                            "end_token": 42,
                                                            "label": "user_id"
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 44,
                                                            "end_token": 52,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 46,
                                                                    "end_token": 46,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "Annotated[str, Depends(get_user_id)]"
                                                        }
                                                    ],
                                                    "label": "user_id: Annotated[str, Depends(get_user_id)]"
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 55,
                                                    "end_token": 71,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 55,
                                                            "end_token": 55,
                                                            "label": "force"
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 57,
                                                            "end_token": 69,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 60,
                                                                    "end_token": 66,
                                                                    "label": "bool, Query(title=\"Whether to proceed if any linked webhooks are still in use\""
                                                                }
                                                            ],
                                                            "label": "Annotated[\n        bool, Query(title=\"Whether to proceed if any linked webhooks are still in use\")\n    ]"
                                                        },
                                                        {
                                                            "type": "false",
                                                            "start_token": 71,
                                                            "end_token": 71,
                                                            "label": "False"
                                                        }
                                                    ],
                                                    "label": "force: Annotated[\n        bool, Query(title=\"Whether to proceed if any linked webhooks are still in use\")\n    ] = False"
                                                }
                                            ],
                                            "label": "(\n    request: Request,\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to delete credentials for\")\n    ],\n    cred_id: Annotated[str, Path(title=\"The ID of the credentials to delete\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n    force: Annotated[\n        bool, Query(title=\"Whether to proceed if any linked webhooks are still in use\")\n    ] = False,\n)"
                                        },
                                        {
                                            "type": "union_type",
                                            "start_token": 76,
                                            "end_token": 79,
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "start_token": 77,
                                                    "end_token": 77,
                                                    "label": "CredentialsDeletionResponse"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 79,
                                                    "end_token": 79,
                                                    "label": "CredentialsDeletionNeedsConfirmationResponse"
                                                }
                                            ],
                                            "label": "> CredentialsDeletionResponse | CredentialsDeletionNeedsConfirmationResponse"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 80,
                                            "end_token": 213,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 82,
                                                    "end_token": 93,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 82,
                                                            "end_token": 82,
                                                            "label": "creds"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 84,
                                                            "end_token": 93,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 84,
                                                                    "end_token": 88,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 84,
                                                                            "end_token": 86,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 84,
                                                                                    "end_token": 84,
                                                                                    "label": "creds_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 86,
                                                                                    "end_token": 86,
                                                                                    "label": "store"
                                                                                }
                                                                            ],
                                                                            "label": "creds_manager.store"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 88,
                                                                            "end_token": 88,
                                                                            "label": "get_creds_by_id"
                                                                        }
                                                                    ],
                                                                    "label": "creds_manager.store.get_creds_by_id"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 89,
                                                                    "end_token": 93,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 90,
                                                                            "end_token": 90,
                                                                            "label": "user_id"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 92,
                                                                            "end_token": 92,
                                                                            "label": "cred_id"
                                                                        }
                                                                    ],
                                                                    "label": "(user_id, cred_id)"
                                                                }
                                                            ],
                                                            "label": "creds_manager.store.get_creds_by_id(user_id, cred_id)"
                                                        }
                                                    ],
                                                    "label": "creds = creds_manager.store.get_creds_by_id(user_id, cred_id)"
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 95,
                                                    "end_token": 110,
                                                    "children": [
                                                        {
                                                            "type": "not_operator",
                                                            "start_token": 95,
                                                            "end_token": 97,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 97,
                                                                    "end_token": 97,
                                                                    "label": "creds"
                                                                }
                                                            ],
                                                            "label": "if not creds"
                                                        },
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 100,
                                                            "end_token": 110,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 101,
                                                                    "end_token": 110,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 101,
                                                                            "end_token": 101,
                                                                            "label": "HTTPException"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 102,
                                                                            "end_token": 110,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 103,
                                                                                    "end_token": 105,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 103,
                                                                                            "end_token": 103,
                                                                                            "label": "status_code"
                                                                                        },
                                                                                        {
                                                                                            "type": "integer",
                                                                                            "start_token": 105,
                                                                                            "end_token": 105,
                                                                                            "label": "404"
                                                                                        }
                                                                                    ],
                                                                                    "label": "status_code=404"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 107,
                                                                                    "end_token": 109,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 107,
                                                                                            "end_token": 107,
                                                                                            "label": "detail"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 109,
                                                                                            "end_token": 109,
                                                                                            "label": "\"Credentials not found\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "detail=\"Credentials not found\""
                                                                                }
                                                                            ],
                                                                            "label": "(status_code=404, detail=\"Credentials not found\")"
                                                                        }
                                                                    ],
                                                                    "label": "HTTPException(status_code=404, detail=\"Credentials not found\")"
                                                                }
                                                            ],
                                                            "label": "raise HTTPException(status_code=404, detail=\"Credentials not found\")"
                                                        }
                                                    ],
                                                    "label": "if not creds:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")"
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 112,
                                                    "end_token": 133,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 112,
                                                            "end_token": 118,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 113,
                                                                    "end_token": 115,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 113,
                                                                            "end_token": 113,
                                                                            "label": "creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 115,
                                                                            "end_token": 115,
                                                                            "label": "provider"
                                                                        }
                                                                    ],
                                                                    "label": "creds.provider"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 118,
                                                                    "end_token": 118,
                                                                    "label": "provider"
                                                                }
                                                            ],
                                                            "label": "if creds.provider != provider"
                                                        },
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 121,
                                                            "end_token": 133,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 122,
                                                                    "end_token": 133,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 122,
                                                                            "end_token": 122,
                                                                            "label": "HTTPException"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 123,
                                                                            "end_token": 133,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 125,
                                                                                    "end_token": 127,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 125,
                                                                                            "end_token": 125,
                                                                                            "label": "status_code"
                                                                                        },
                                                                                        {
                                                                                            "type": "integer",
                                                                                            "start_token": 127,
                                                                                            "end_token": 127,
                                                                                            "label": "404"
                                                                                        }
                                                                                    ],
                                                                                    "label": "status_code=404"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 129,
                                                                                    "end_token": 131,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 129,
                                                                                            "end_token": 129,
                                                                                            "label": "detail"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 131,
                                                                                            "end_token": 131,
                                                                                            "label": "\"Credentials do not match the specified provider\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "detail=\"Credentials do not match the specified provider\""
                                                                                }
                                                                            ],
                                                                            "label": "(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )"
                                                                }
                                                            ],
                                                            "label": "raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )"
                                                        }
                                                    ],
                                                    "label": "if creds.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )"
                                                },
                                                {
                                                    "type": "try_statement",
                                                    "start_token": 136,
                                                    "end_token": 145,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 139,
                                                            "end_token": 145,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 140,
                                                                    "end_token": 145,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 140,
                                                                            "end_token": 140,
                                                                            "label": "remove_all_webhooks_for_credentials"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 141,
                                                                            "end_token": 145,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 142,
                                                                                    "end_token": 142,
                                                                                    "label": "creds"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 144,
                                                                                    "end_token": 144,
                                                                                    "label": "force"
                                                                                }
                                                                            ],
                                                                            "label": "(creds, force)"
                                                                        }
                                                                    ],
                                                                    "label": "remove_all_webhooks_for_credentials(creds, force)"
                                                                }
                                                            ],
                                                            "label": "await remove_all_webhooks_for_credentials(creds, force)"
                                                        },
                                                        {
                                                            "type": "except_clause",
                                                            "start_token": 147,
                                                            "end_token": 162,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 148,
                                                                    "end_token": 150,
                                                                    "label": "NeedConfirmation as e"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 152,
                                                                    "end_token": 162,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 153,
                                                                            "end_token": 162,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 154,
                                                                                    "end_token": 162,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 154,
                                                                                            "end_token": 154,
                                                                                            "label": "CredentialsDeletionNeedsConfirmationResponse"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 155,
                                                                                            "end_token": 162,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 156,
                                                                                                    "end_token": 161,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 156,
                                                                                                            "end_token": 156,
                                                                                                            "label": "message"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 158,
                                                                                                            "end_token": 161,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 158,
                                                                                                                    "end_token": 158,
                                                                                                                    "label": "str"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 159,
                                                                                                                    "end_token": 160,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 160,
                                                                                                                            "end_token": 160,
                                                                                                                            "label": "e"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "(e"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "str(e)"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "message=str(e)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(message=str(e))"
                                                                                        }
                                                                                    ],
                                                                                    "label": "CredentialsDeletionNeedsConfirmationResponse(message=str(e))"
                                                                                }
                                                                            ],
                                                                            "label": "return CredentialsDeletionNeedsConfirmationResponse(message=str(e))"
                                                                        }
                                                                    ],
                                                                    "label": "\n        return CredentialsDeletionNeedsConfirmationResponse(message=str(e))"
                                                                }
                                                            ],
                                                            "label": "except NeedConfirmation as e:\n        return CredentialsDeletionNeedsConfirmationResponse(message=str(e))"
                                                        }
                                                    ],
                                                    "label": "try:\n        await remove_all_webhooks_for_credentials(creds, force)"
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "start_token": 165,
                                                    "end_token": 172,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 165,
                                                            "end_token": 172,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 165,
                                                                    "end_token": 167,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 165,
                                                                            "end_token": 167,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 165,
                                                                                    "end_token": 165,
                                                                                    "label": "creds_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 167,
                                                                                    "end_token": 167,
                                                                                    "label": "delete"
                                                                                }
                                                                            ],
                                                                            "label": "creds_manager.delete"
                                                                        }
                                                                    ],
                                                                    "label": "creds_manager.delete"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 168,
                                                                    "end_token": 172,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 169,
                                                                            "end_token": 169,
                                                                            "label": "user_id"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 171,
                                                                            "end_token": 171,
                                                                            "label": "cred_id"
                                                                        }
                                                                    ],
                                                                    "label": "(user_id, cred_id)"
                                                                }
                                                            ],
                                                            "label": "creds_manager.delete(user_id, cred_id)"
                                                        }
                                                    ],
                                                    "label": "creds_manager.delete(user_id, cred_id)"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 175,
                                                    "end_token": 177,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 175,
                                                            "end_token": 175,
                                                            "label": "tokens_revoked"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 177,
                                                            "end_token": 177,
                                                            "label": "None"
                                                        }
                                                    ],
                                                    "label": "tokens_revoked = None"
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 179,
                                                    "end_token": 205,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 180,
                                                            "end_token": 185,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 180,
                                                                    "end_token": 180,
                                                                    "label": "isinstance"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 181,
                                                                    "end_token": 185,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 182,
                                                                            "end_token": 182,
                                                                            "label": "creds"
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 184,
                                                                            "end_token": 184,
                                                                            "label": "OAuth2Credentials"
                                                                        }
                                                                    ],
                                                                    "label": "(creds, OAuth2Credentials)"
                                                                }
                                                            ],
                                                            "label": "isinstance(creds, OAuth2Credentials)"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 186,
                                                            "end_token": 205,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 188,
                                                                    "end_token": 195,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 188,
                                                                            "end_token": 188,
                                                                            "label": "handler"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 190,
                                                                            "end_token": 195,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 190,
                                                                                    "end_token": 190,
                                                                                    "label": "_get_provider_oauth_handler"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 191,
                                                                                    "end_token": 195,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 192,
                                                                                            "end_token": 192,
                                                                                            "label": "request"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 194,
                                                                                            "end_token": 194,
                                                                                            "label": "provider"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(request, provider)"
                                                                                }
                                                                            ],
                                                                            "label": "_get_provider_oauth_handler(request, provider)"
                                                                        }
                                                                    ],
                                                                    "label": "handler = _get_provider_oauth_handler(request, provider)"
                                                                },
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 197,
                                                                    "end_token": 204,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 197,
                                                                            "end_token": 197,
                                                                            "label": "tokens_revoked"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 199,
                                                                            "end_token": 204,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 199,
                                                                                    "end_token": 201,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 199,
                                                                                            "end_token": 199,
                                                                                            "label": "handler"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 201,
                                                                                            "end_token": 201,
                                                                                            "label": "revoke_tokens"
                                                                                        }
                                                                                    ],
                                                                                    "label": "handler.revoke_tokens"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 202,
                                                                                    "end_token": 204,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 203,
                                                                                            "end_token": 203,
                                                                                            "label": "creds"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(creds)"
                                                                                }
                                                                            ],
                                                                            "label": "handler.revoke_tokens(creds)"
                                                                        }
                                                                    ],
                                                                    "label": "tokens_revoked = handler.revoke_tokens(creds)"
                                                                }
                                                            ],
                                                            "label": ":\n        handler = _get_provider_oauth_handler(request, provider)\n        tokens_revoked = handler.revoke_tokens(creds)\n"
                                                        }
                                                    ],
                                                    "label": "if isinstance(creds, OAuth2Credentials):\n        handler = _get_provider_oauth_handler(request, provider)\n        tokens_revoked = handler.revoke_tokens(creds)\n"
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 207,
                                                    "end_token": 213,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 208,
                                                            "end_token": 213,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 208,
                                                                    "end_token": 208,
                                                                    "label": "CredentialsDeletionResponse"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 209,
                                                                    "end_token": 213,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 210,
                                                                            "end_token": 212,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 210,
                                                                                    "end_token": 210,
                                                                                    "label": "revoked"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 212,
                                                                                    "end_token": 212,
                                                                                    "label": "tokens_revoked"
                                                                                }
                                                                            ],
                                                                            "label": "revoked=tokens_revoked"
                                                                        }
                                                                    ],
                                                                    "label": "(revoked=tokens_revoked)"
                                                                }
                                                            ],
                                                            "label": "CredentialsDeletionResponse(revoked=tokens_revoked)"
                                                        }
                                                    ],
                                                    "label": "return CredentialsDeletionResponse(revoked=tokens_revoked)"
                                                }
                                            ],
                                            "label": ":\n    creds = creds_manager.store.get_creds_by_id(user_id, cred_id)\n    if not creds:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")\n    if creds.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )\n\n    try:\n        await remove_all_webhooks_for_credentials(creds, force)\n    except NeedConfirmation as e:\n        return CredentialsDeletionNeedsConfirmationResponse(message=str(e))\n\n    creds_manager.delete(user_id, cred_id)\n\n    tokens_revoked = None\n    if isinstance(creds, OAuth2Credentials):\n        handler = _get_provider_oauth_handler(request, provider)\n        tokens_revoked = handler.revoke_tokens(creds)\n\n    return CredentialsDeletionResponse(revoked=tokens_revoked)"
                                        }
                                    ],
                                    "label": "def delete_credentials(\n    request: Request,\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to delete credentials for\")\n    ],\n    cred_id: Annotated[str, Path(title=\"The ID of the credentials to delete\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n    force: Annotated[\n        bool, Query(title=\"Whether to proceed if any linked webhooks are still in use\")\n    ] = False,\n) -> CredentialsDeletionResponse | CredentialsDeletionNeedsConfirmationResponse:\n    creds = creds_manager.store.get_creds_by_id(user_id, cred_id)\n    if not creds:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")\n    if creds.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )\n\n    try:\n        await remove_all_webhooks_for_credentials(creds, force)\n    except NeedConfirmation as e:\n        return CredentialsDeletionNeedsConfirmationResponse(message=str(e))\n\n    creds_manager.delete(user_id, cred_id)\n\n    tokens_revoked = None\n    if isinstance(creds, OAuth2Credentials):\n        handler = _get_provider_oauth_handler(request, provider)\n        tokens_revoked = handler.revoke_tokens(creds)\n\n    return CredentialsDeletionResponse(revoked=tokens_revoked)"
                                }
                            ],
                            "label": "async"
                        }
                    ],
                    "label": "async def delete_credentials(\n    request: Request,\n    provider: Annotated[\n        ProviderName, Path(title=\"The provider to delete credentials for\")\n    ],\n    cred_id: Annotated[str, Path(title=\"The ID of the credentials to delete\")],\n    user_id: Annotated[str, Depends(get_user_id)],\n    force: Annotated[\n        bool, Query(title=\"Whether to proceed if any linked webhooks are still in use\")\n    ] = False,\n) -> CredentialsDeletionResponse | CredentialsDeletionNeedsConfirmationResponse:\n    creds = creds_manager.store.get_creds_by_id(user_id, cred_id)\n    if not creds:\n        raise HTTPException(status_code=404, detail=\"Credentials not found\")\n    if creds.provider != provider:\n        raise HTTPException(\n            status_code=404, detail=\"Credentials do not match the specified provider\"\n        )\n\n    try:\n        await remove_all_webhooks_for_credentials(creds, force)\n    except NeedConfirmation as e:\n        return CredentialsDeletionNeedsConfirmationResponse(message=str(e))\n\n    creds_manager.delete(user_id, cred_id)\n\n    tokens_revoked = None\n    if isinstance(creds, OAuth2Credentials):\n        handler = _get_provider_oauth_handler(request, provider)\n        tokens_revoked = handler.revoke_tokens(creds)\n\n    return CredentialsDeletionResponse(revoked=tokens_revoked)"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "webhook_ingress_generic",
            "start_line": 283,
            "end_line": 323,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 237,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 237,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 2,
                                    "end_token": 2,
                                    "children": [],
                                    "label": "webhook_ingress_generic"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 42,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 5,
                                            "end_token": 9,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 5,
                                                    "end_token": 5,
                                                    "children": [],
                                                    "label": "request"
                                                },
                                                {
                                                    "type": "dotted_name",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "children": [],
                                                    "label": "Request"
                                                }
                                            ],
                                            "label": "request: Request,\n"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 10,
                                            "end_token": 25,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "children": [],
                                                    "label": "provider"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 12,
                                                    "end_token": 24,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 15,
                                                            "end_token": 15,
                                                            "children": [],
                                                            "label": "ProviderName"
                                                        },
                                                        {
                                                            "type": "annotator",
                                                            "start_token": 17,
                                                            "end_token": 22,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 19,
                                                                    "end_token": 19,
                                                                    "children": [],
                                                                    "label": "title"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 21,
                                                                    "end_token": 21,
                                                                    "children": [],
                                                                    "label": "\"Provider where the webhook was registered\""
                                                                }
                                                            ],
                                                            "label": "Path(title=\"Provider where the webhook was registered\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[\n        ProviderName, Path(title=\"Provider where the webhook was registered\")\n    ]"
                                                }
                                            ],
                                            "label": "provider: Annotated[\n        ProviderName, Path(title=\"Provider where the webhook was registered\")\n    ],"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 27,
                                            "end_token": 40,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 27,
                                                    "end_token": 27,
                                                    "children": [],
                                                    "label": "webhook_id"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 29,
                                                    "end_token": 39,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 31,
                                                            "end_token": 31,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "annotator",
                                                            "start_token": 33,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 35,
                                                                    "end_token": 35,
                                                                    "children": [],
                                                                    "label": "title"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 37,
                                                                    "end_token": 37,
                                                                    "children": [],
                                                                    "label": "\"Our ID for the webhook\""
                                                                }
                                                            ],
                                                            "label": "Path(title=\"Our ID for the webhook\")"
                                                        }
                                                    ],
                                                    "label": "Annotated[str, Path(title=\"Our ID for the webhook\")]"
                                                }
                                            ],
                                            "label": "webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],"
                                        }
                                    ],
                                    "label": "(\n    request: Request,\n    provider: Annotated[\n        ProviderName, Path(title=\"Provider where the webhook was registered\")\n    ],\n    webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],\n)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 44,
                                    "end_token": 237,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "start_token": 45,
                                            "end_token": 51,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 45,
                                                    "end_token": 51,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 45,
                                                            "end_token": 47,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 45,
                                                                    "end_token": 45,
                                                                    "children": [],
                                                                    "label": "logger"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 47,
                                                                    "end_token": 47,
                                                                    "children": [],
                                                                    "label": "debug"
                                                                }
                                                            ],
                                                            "label": "logger.debug"
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "start_token": 49,
                                                            "end_token": 50,
                                                            "children": [],
                                                            "label": "f\"Received {provider.value} webhook ingress for ID {webhook_id}\""
                                                        }
                                                    ],
                                                    "label": "logger.debug(f\"Received {provider.value} webhook ingress for ID {webhook_id}\")"
                                                }
                                            ],
                                            "label": "logger.debug(f\"Received {provider.value} webhook ingress for ID {webhook_id}\")"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 53,
                                            "end_token": 61,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 53,
                                                    "end_token": 53,
                                                    "children": [],
                                                    "label": "webhook_manager"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 55,
                                                    "end_token": 61,
                                                    "children": [
                                                        {
                                                            "type": "subscript",
                                                            "start_token": 55,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 55,
                                                                    "end_token": 55,
                                                                    "children": [],
                                                                    "label": "WEBHOOK_MANAGERS_BY_NAME"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 57,
                                                                    "end_token": 57,
                                                                    "children": [],
                                                                    "label": "provider"
                                                                }
                                                            ],
                                                            "label": "WEBHOOK_MANAGERS_BY_NAME[provider]"
                                                        }
                                                    ],
                                                    "label": "WEBHOOK_MANAGERS_BY_NAME[provider]()\n"
                                                }
                                            ],
                                            "label": "webhook_manager = WEBHOOK_MANAGERS_BY_NAME[provider]()\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 62,
                                            "end_token": 68,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 62,
                                                    "end_token": 62,
                                                    "children": [],
                                                    "label": "webhook"
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 64,
                                                    "end_token": 68,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 65,
                                                            "end_token": 68,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 65,
                                                                    "end_token": 65,
                                                                    "children": [],
                                                                    "label": "get_webhook"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 67,
                                                                    "end_token": 67,
                                                                    "children": [],
                                                                    "label": "webhook_id"
                                                                }
                                                            ],
                                                            "label": "get_webhook(webhook_id)"
                                                        }
                                                    ],
                                                    "label": "await get_webhook(webhook_id)"
                                                }
                                            ],
                                            "label": "webhook = await get_webhook(webhook_id)"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "start_token": 70,
                                            "end_token": 76,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 70,
                                                    "end_token": 76,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 70,
                                                            "end_token": 72,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 70,
                                                                    "end_token": 70,
                                                                    "children": [],
                                                                    "label": "logger"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 72,
                                                                    "end_token": 72,
                                                                    "children": [],
                                                                    "label": "debug"
                                                                }
                                                            ],
                                                            "label": "logger.debug"
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "start_token": 74,
                                                            "end_token": 75,
                                                            "children": [],
                                                            "label": "f\"Webhook #{webhook_id}: {webhook}\""
                                                        }
                                                    ],
                                                    "label": "logger.debug(f\"Webhook #{webhook_id}: {webhook}\")"
                                                }
                                            ],
                                            "label": "logger.debug(f\"Webhook #{webhook_id}: {webhook}\")"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 78,
                                            "end_token": 90,
                                            "children": [
                                                {
                                                    "type": "expression_list",
                                                    "start_token": 78,
                                                    "end_token": 80,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 78,
                                                            "end_token": 78,
                                                            "children": [],
                                                            "label": "payload"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 80,
                                                            "end_token": 80,
                                                            "children": [],
                                                            "label": "event_type"
                                                        }
                                                    ],
                                                    "label": "payload, event_type"
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 82,
                                                    "end_token": 90,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 83,
                                                            "end_token": 90,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 83,
                                                                    "end_token": 85,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 83,
                                                                            "end_token": 83,
                                                                            "children": [],
                                                                            "label": "webhook_manager"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 85,
                                                                            "end_token": 85,
                                                                            "children": [],
                                                                            "label": "validate_payload"
                                                                        }
                                                                    ],
                                                                    "label": "webhook_manager.validate_payload"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 87,
                                                                    "end_token": 87,
                                                                    "children": [],
                                                                    "label": "webhook"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 89,
                                                                    "end_token": 89,
                                                                    "children": [],
                                                                    "label": "request"
                                                                }
                                                            ],
                                                            "label": "webhook_manager.validate_payload(webhook, request)"
                                                        }
                                                    ],
                                                    "label": "await webhook_manager.validate_payload(webhook, request)"
                                                }
                                            ],
                                            "label": "payload, event_type = await webhook_manager.validate_payload(webhook, request)"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "start_token": 92,
                                            "end_token": 103,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 92,
                                                    "end_token": 103,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 92,
                                                            "end_token": 94,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 92,
                                                                    "end_token": 92,
                                                                    "children": [],
                                                                    "label": "logger"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 94,
                                                                    "end_token": 94,
                                                                    "children": [],
                                                                    "label": "debug"
                                                                }
                                                            ],
                                                            "label": "logger.debug"
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "start_token": 96,
                                                            "end_token": 102,
                                                            "children": [],
                                                            "label": "\n        f\"Validated {provider.value} {webhook.webhook_type} {event_type} event \"\n        f\"with payload {payload}\"\n"
                                                        }
                                                    ],
                                                    "label": "logger.debug(\n        f\"Validated {provider.value} {webhook.webhook_type} {event_type} event \"\n        f\"with payload {payload}\"\n    )"
                                                }
                                            ],
                                            "label": "logger.debug(\n        f\"Validated {provider.value} {webhook.webhook_type} {event_type} event \"\n        f\"with payload {payload}\"\n    )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 106,
                                            "end_token": 131,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 106,
                                                    "end_token": 106,
                                                    "children": [],
                                                    "label": "webhook_event"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 108,
                                                    "end_token": 131,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 108,
                                                            "end_token": 108,
                                                            "children": [],
                                                            "label": "WebhookEvent"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 109,
                                                            "end_token": 131,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 111,
                                                                    "end_token": 114,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 111,
                                                                            "end_token": 111,
                                                                            "children": [],
                                                                            "label": "provider"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 113,
                                                                            "end_token": 113,
                                                                            "children": [],
                                                                            "label": "provider"
                                                                        }
                                                                    ],
                                                                    "label": "provider=provider,"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 116,
                                                                    "end_token": 119,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 116,
                                                                            "end_token": 116,
                                                                            "children": [],
                                                                            "label": "webhook_id"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 118,
                                                                            "end_token": 118,
                                                                            "children": [],
                                                                            "label": "webhook_id"
                                                                        }
                                                                    ],
                                                                    "label": "webhook_id=webhook_id,"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 121,
                                                                    "end_token": 124,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 121,
                                                                            "end_token": 121,
                                                                            "children": [],
                                                                            "label": "event_type"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 123,
                                                                            "end_token": 123,
                                                                            "children": [],
                                                                            "label": "event_type"
                                                                        }
                                                                    ],
                                                                    "label": "event_type=event_type,"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 126,
                                                                    "end_token": 129,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 126,
                                                                            "end_token": 126,
                                                                            "children": [],
                                                                            "label": "payload"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 128,
                                                                            "end_token": 128,
                                                                            "children": [],
                                                                            "label": "payload"
                                                                        }
                                                                    ],
                                                                    "label": "payload=payload,"
                                                                }
                                                            ],
                                                            "label": "(\n        provider=provider,\n        webhook_id=webhook_id,\n        event_type=event_type,\n        payload=payload,\n    )"
                                                        }
                                                    ],
                                                    "label": "WebhookEvent(\n        provider=provider,\n        webhook_id=webhook_id,\n        event_type=event_type,\n        payload=payload,\n    )"
                                                }
                                            ],
                                            "label": "webhook_event = WebhookEvent(\n        provider=provider,\n        webhook_id=webhook_id,\n        event_type=event_type,\n        payload=payload,\n    )"
                                        },
                                        {
                                            "type": "await",
                                            "start_token": 133,
                                            "end_token": 137,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 134,
                                                    "end_token": 137,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 134,
                                                            "end_token": 134,
                                                            "children": [],
                                                            "label": "publish_webhook_event"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 136,
                                                            "end_token": 136,
                                                            "children": [],
                                                            "label": "webhook_event"
                                                        }
                                                    ],
                                                    "label": "publish_webhook_event(webhook_event)"
                                                }
                                            ],
                                            "label": "await publish_webhook_event(webhook_event)"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "start_token": 139,
                                            "end_token": 145,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 139,
                                                    "end_token": 145,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 139,
                                                            "end_token": 141,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 139,
                                                                    "end_token": 139,
                                                                    "children": [],
                                                                    "label": "logger"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 141,
                                                                    "end_token": 141,
                                                                    "children": [],
                                                                    "label": "debug"
                                                                }
                                                            ],
                                                            "label": "logger.debug"
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "start_token": 143,
                                                            "end_token": 144,
                                                            "children": [],
                                                            "label": "f\"Webhook event published: {webhook_event}\""
                                                        }
                                                    ],
                                                    "label": "logger.debug(f\"Webhook event published: {webhook_event}\")"
                                                }
                                            ],
                                            "label": "logger.debug(f\"Webhook event published: {webhook_event}\")"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 148,
                                            "end_token": 156,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 149,
                                                    "end_token": 153,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 150,
                                                            "end_token": 152,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 150,
                                                                    "end_token": 150,
                                                                    "children": [],
                                                                    "label": "webhook"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 152,
                                                                    "end_token": 152,
                                                                    "children": [],
                                                                    "label": "attached_nodes"
                                                                }
                                                            ],
                                                            "label": "webhook.attached_nodes"
                                                        }
                                                    ],
                                                    "label": "not webhook.attached_nodes:"
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 155,
                                                    "end_token": 155,
                                                    "children": [],
                                                    "label": "return"
                                                }
                                            ],
                                            "label": "if not webhook.attached_nodes:\n        return\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 158,
                                            "end_token": 163,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 158,
                                                    "end_token": 158,
                                                    "children": [],
                                                    "label": "executor"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 160,
                                                    "end_token": 163,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 160,
                                                            "end_token": 160,
                                                            "children": [],
                                                            "label": "get_service_client"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 162,
                                                            "end_token": 162,
                                                            "children": [],
                                                            "label": "ExecutionManager"
                                                        }
                                                    ],
                                                    "label": "get_service_client(ExecutionManager)"
                                                }
                                            ],
                                            "label": "executor = get_service_client(ExecutionManager)"
                                        },
                                        {
                                            "type": "for_statement",
                                            "start_token": 165,
                                            "end_token": 236,
                                            "children": [
                                                {
                                                    "type": "for_in_clause",
                                                    "start_token": 165,
                                                    "end_token": 169,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 166,
                                                            "end_token": 166,
                                                            "children": [],
                                                            "label": "node"
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 168,
                                                            "end_token": 170,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 168,
                                                                    "end_token": 168,
                                                                    "children": [],
                                                                    "label": "webhook"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 170,
                                                                    "end_token": 170,
                                                                    "children": [],
                                                                    "label": "attached_nodes"
                                                                }
                                                            ],
                                                            "label": "webhook.attached_nodes"
                                                        }
                                                    ],
                                                    "label": "for node in webhook."
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 171,
                                                    "end_token": 236,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 173,
                                                            "end_token": 179,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 173,
                                                                    "end_token": 179,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 173,
                                                                            "end_token": 175,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 173,
                                                                                    "end_token": 173,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 175,
                                                                                    "end_token": 175,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 177,
                                                                            "end_token": 178,
                                                                            "children": [],
                                                                            "label": "f\"Webhook-attached node: {node}\""
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(f\"Webhook-attached node: {node}\")"
                                                                }
                                                            ],
                                                            "label": "logger.debug(f\"Webhook-attached node: {node}\")"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 181,
                                                            "end_token": 199,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 182,
                                                                    "end_token": 188,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 183,
                                                                            "end_token": 188,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 183,
                                                                                    "end_token": 185,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 183,
                                                                                            "end_token": 183,
                                                                                            "children": [],
                                                                                            "label": "node"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 185,
                                                                                            "end_token": 185,
                                                                                            "children": [],
                                                                                            "label": "is_triggered_by_event_type"
                                                                                        }
                                                                                    ],
                                                                                    "label": "node.is_triggered_by_event_type"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 187,
                                                                                    "end_token": 187,
                                                                                    "children": [],
                                                                                    "label": "event_type"
                                                                                }
                                                                            ],
                                                                            "label": "node.is_triggered_by_event_type(event_type)"
                                                                        }
                                                                    ],
                                                                    "label": "not node.is_triggered_by_event_type(event_type)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 189,
                                                                    "end_token": 199,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 191,
                                                                            "end_token": 197,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 191,
                                                                                    "end_token": 197,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 191,
                                                                                            "end_token": 193,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 191,
                                                                                                    "end_token": 191,
                                                                                                    "children": [],
                                                                                                    "label": "logger"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 193,
                                                                                                    "end_token": 193,
                                                                                                    "children": [],
                                                                                                    "label": "debug"
                                                                                                }
                                                                                            ],
                                                                                            "label": "logger.debug"
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "start_token": 195,
                                                                                            "end_token": 196,
                                                                                            "children": [],
                                                                                            "label": "f\"Node #{node.id} doesn't trigger on event {event_type}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")"
                                                                        },
                                                                        {
                                                                            "type": "continue_statement",
                                                                            "start_token": 199,
                                                                            "end_token": 199,
                                                                            "children": [],
                                                                            "label": "continue"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")\n            continue"
                                                                }
                                                            ],
                                                            "label": "if not node.is_triggered_by_event_type(event_type):\n            logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")\n            continue"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 201,
                                                            "end_token": 207,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 201,
                                                                    "end_token": 207,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 201,
                                                                            "end_token": 203,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 201,
                                                                                    "end_token": 201,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 203,
                                                                                    "end_token": 203,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 205,
                                                                            "end_token": 206,
                                                                            "children": [],
                                                                            "label": "f\"Executing graph #{node.graph_id} node #{node.id}\""
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(f\"Executing graph #{node.graph_id} node #{node.id}\")"
                                                                }
                                                            ],
                                                            "label": "logger.debug(f\"Executing graph #{node.graph_id} node #{node.id}\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 209,
                                                            "end_token": 236,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 209,
                                                                    "end_token": 236,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 209,
                                                                            "end_token": 211,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 209,
                                                                                    "end_token": 209,
                                                                                    "children": [],
                                                                                    "label": "executor"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 211,
                                                                                    "end_token": 211,
                                                                                    "children": [],
                                                                                    "label": "add_execution"
                                                                                }
                                                                            ],
                                                                            "label": "executor.add_execution"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 213,
                                                                            "end_token": 236,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 214,
                                                                                    "end_token": 214,
                                                                                    "children": [],
                                                                                    "label": "node"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 219,
                                                                                    "end_token": 227,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 220,
                                                                                            "end_token": 220,
                                                                                            "children": [],
                                                                                            "label": "="
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 221,
                                                                                            "end_token": 226,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 222,
                                                                                                    "end_token": 225,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "start_token": 222,
                                                                                                            "end_token": 224,
                                                                                                            "children": [],
                                                                                                            "label": "f\"webhook_{webhook_id}_payload\":"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 225,
                                                                                                            "end_token": 225,
                                                                                                            "children": [],
                                                                                                            "label": "payload"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "f\"webhook_{webhook_id}_payload\": payload"
                                                                                                }
                                                                                            ],
                                                                                            "label": "{f\"webhook_{webhook_id}_payload\": payload}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "data={f\"webhook_{webhook_id}_payload\": payload},"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 229,
                                                                                    "end_token": 234,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 229,
                                                                                            "end_token": 229,
                                                                                            "children": [],
                                                                                            "label": "user_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 231,
                                                                                            "end_token": 233,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 231,
                                                                                                    "end_token": 231,
                                                                                                    "children": [],
                                                                                                    "label": "webhook"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 233,
                                                                                                    "end_token": 233,
                                                                                                    "children": [],
                                                                                                    "label": "user_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "webhook.user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_id=webhook.user_id,"
                                                                                }
                                                                            ],
                                                                            "label": "\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "executor.add_execution(\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )"
                                                                }
                                                            ],
                                                            "label": "executor.add_execution(\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )"
                                                        }
                                                    ],
                                                    "label": ":\n        logger.debug(f\"Webhook-attached node: {node}\")\n        if not node.is_triggered_by_event_type(event_type):\n            logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")\n            continue\n        logger.debug(f\"Executing graph #{node.graph_id} node #{node.id}\")\n        executor.add_execution(\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )"
                                                }
                                            ],
                                            "label": "for node in webhook.attached_nodes:\n        logger.debug(f\"Webhook-attached node: {node}\")\n        if not node.is_triggered_by_event_type(event_type):\n            logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")\n            continue\n        logger.debug(f\"Executing graph #{node.graph_id} node #{node.id}\")\n        executor.add_execution(\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )"
                                        }
                                    ],
                                    "label": "\n    logger.debug(f\"Received {provider.value} webhook ingress for ID {webhook_id}\")\n    webhook_manager = WEBHOOK_MANAGERS_BY_NAME[provider]()\n    webhook = await get_webhook(webhook_id)\n    logger.debug(f\"Webhook #{webhook_id}: {webhook}\")\n    payload, event_type = await webhook_manager.validate_payload(webhook, request)\n    logger.debug(\n        f\"Validated {provider.value} {webhook.webhook_type} {event_type} event \"\n        f\"with payload {payload}\"\n    )\n\n    webhook_event = WebhookEvent(\n        provider=provider,\n        webhook_id=webhook_id,\n        event_type=event_type,\n        payload=payload,\n    )\n    await publish_webhook_event(webhook_event)\n    logger.debug(f\"Webhook event published: {webhook_event}\")\n\n    if not webhook.attached_nodes:\n        return\n\n    executor = get_service_client(ExecutionManager)\n    for node in webhook.attached_nodes:\n        logger.debug(f\"Webhook-attached node: {node}\")\n        if not node.is_triggered_by_event_type(event_type):\n            logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")\n            continue\n        logger.debug(f\"Executing graph #{node.graph_id} node #{node.id}\")\n        executor.add_execution(\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )\n"
                                }
                            ],
                            "label": "async def webhook_ingress_generic(\n    request: Request,\n    provider: Annotated[\n        ProviderName, Path(title=\"Provider where the webhook was registered\")\n    ],\n    webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],\n):\n    logger.debug(f\"Received {provider.value} webhook ingress for ID {webhook_id}\")\n    webhook_manager = WEBHOOK_MANAGERS_BY_NAME[provider]()\n    webhook = await get_webhook(webhook_id)\n    logger.debug(f\"Webhook #{webhook_id}: {webhook}\")\n    payload, event_type = await webhook_manager.validate_payload(webhook, request)\n    logger.debug(\n        f\"Validated {provider.value} {webhook.webhook_type} {event_type} event \"\n        f\"with payload {payload}\"\n    )\n\n    webhook_event = WebhookEvent(\n        provider=provider,\n        webhook_id=webhook_id,\n        event_type=event_type,\n        payload=payload,\n    )\n    await publish_webhook_event(webhook_event)\n    logger.debug(f\"Webhook event published: {webhook_event}\")\n\n    if not webhook.attached_nodes:\n        return\n\n    executor = get_service_client(ExecutionManager)\n    for node in webhook.attached_nodes:\n        logger.debug(f\"Webhook-attached node: {node}\")\n        if not node.is_triggered_by_event_type(event_type):\n            logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")\n            continue\n        logger.debug(f\"Executing graph #{node.graph_id} node #{node.id}\")\n        executor.add_execution(\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )\n"
                        }
                    ],
                    "label": "async def webhook_ingress_generic(\n    request: Request,\n    provider: Annotated[\n        ProviderName, Path(title=\"Provider where the webhook was registered\")\n    ],\n    webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],\n):\n    logger.debug(f\"Received {provider.value} webhook ingress for ID {webhook_id}\")\n    webhook_manager = WEBHOOK_MANAGERS_BY_NAME[provider]()\n    webhook = await get_webhook(webhook_id)\n    logger.debug(f\"Webhook #{webhook_id}: {webhook}\")\n    payload, event_type = await webhook_manager.validate_payload(webhook, request)\n    logger.debug(\n        f\"Validated {provider.value} {webhook.webhook_type} {event_type} event \"\n        f\"with payload {payload}\"\n    )\n\n    webhook_event = WebhookEvent(\n        provider=provider,\n        webhook_id=webhook_id,\n        event_type=event_type,\n        payload=payload,\n    )\n    await publish_webhook_event(webhook_event)\n    logger.debug(f\"Webhook event published: {webhook_event}\")\n\n    if not webhook.attached_nodes:\n        return\n\n    executor = get_service_client(ExecutionManager)\n    for node in webhook.attached_nodes:\n        logger.debug(f\"Webhook-attached node: {node}\")\n        if not node.is_triggered_by_event_type(event_type):\n            logger.debug(f\"Node #{node.id} doesn't trigger on event {event_type}\")\n            continue\n        logger.debug(f\"Executing graph #{node.graph_id} node #{node.id}\")\n        executor.add_execution(\n            node.graph_id,\n            data={f\"webhook_{webhook_id}_payload\": payload},\n            user_id=webhook.user_id,\n        )\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "webhook_ping",
            "start_line": 327,
            "end_line": 347,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 136,
                    "children": [
                        {
                            "type": "decorated_definition",
                            "start_token": 0,
                            "end_token": 136,
                            "children": [
                                {
                                    "type": "async",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "async"
                                },
                                {
                                    "type": "function_definition",
                                    "start_token": 1,
                                    "end_token": 136,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 1,
                                            "end_token": 1,
                                            "label": "def"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 2,
                                            "end_token": 2,
                                            "label": "webhook_ping"
                                        },
                                        {
                                            "type": "parameters",
                                            "start_token": 3,
                                            "end_token": 36,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "start_token": 5,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 5,
                                                            "end_token": 5,
                                                            "label": "webhook_id"
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 7,
                                                            "end_token": 17,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "Annotated"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 9,
                                                                    "end_token": 11,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "label": "str"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 12,
                                                                            "end_token": 16,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 11,
                                                                                    "end_token": 11,
                                                                                    "label": "Path"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 12,
                                                                                    "end_token": 16,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 13,
                                                                                            "end_token": 15,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 13,
                                                                                                    "end_token": 13,
                                                                                                    "label": "title"
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 15,
                                                                                                    "end_token": 15,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "start_token": 15,
                                                                                                            "end_token": 15,
                                                                                                            "label": "\"Our ID for the webhook\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"Our ID for the webhook\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "title=\"Our ID for the webhook\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(title=\"Our ID for the webhook\")"
                                                                                }
                                                                            ],
                                                                            "label": "(title=\"Our ID for the webhook\")"
                                                                        }
                                                                    ],
                                                                    "label": "str, Path"
                                                                }
                                                            ],
                                                            "label": "Annotated[str, Path(title=\"Our ID for the webhook\")]"
                                                        }
                                                    ],
                                                    "label": "webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")]"
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "start_token": 20,
                                                    "end_token": 30,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 20,
                                                            "end_token": 20,
                                                            "label": "user_id"
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 22,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 22,
                                                                    "end_token": 22,
                                                                    "label": "Annotated"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 24,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 24,
                                                                            "end_token": 24,
                                                                            "label": "str"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 27,
                                                                            "end_token": 29,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "label": "Depends"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 27,
                                                                                    "end_token": 29,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 28,
                                                                                            "end_token": 28,
                                                                                            "label": "get_user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(get_user_id)"
                                                                                }
                                                                            ],
                                                                            "label": "(get_user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "str, Depends"
                                                                }
                                                            ],
                                                            "label": "Annotated[str, Depends(get_user_id)]"
                                                        }
                                                    ],
                                                    "label": "user_id: Annotated[str, Depends(get_user_id)]"
                                                }
                                            ],
                                            "label": "(\n    webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],\n    user_id: Annotated[str, Depends(get_user_id)],  # require auth\n)"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 38,
                                            "end_token": 136,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 39,
                                                    "end_token": 45,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 39,
                                                            "end_token": 39,
                                                            "label": "webhook"
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 41,
                                                            "end_token": 45,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 42,
                                                                    "end_token": 45,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 42,
                                                                            "end_token": 42,
                                                                            "label": "get_webhook"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 43,
                                                                            "end_token": 45,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 44,
                                                                                    "end_token": 44,
                                                                                    "label": "webhook_id"
                                                                                }
                                                                            ],
                                                                            "label": "(webhook_id)"
                                                                        }
                                                                    ],
                                                                    "label": "get_webhook(webhook_id)"
                                                                }
                                                            ],
                                                            "label": "await get_webhook(webhook_id)"
                                                        }
                                                    ],
                                                    "label": "webhook = await get_webhook(webhook_id)"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 47,
                                                    "end_token": 56,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 47,
                                                            "end_token": 47,
                                                            "label": "webhook_manager"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 49,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 49,
                                                                    "end_token": 54,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 49,
                                                                            "end_token": 49,
                                                                            "label": "WEBHOOK_MANAGERS_BY_NAME"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 51,
                                                                            "end_token": 53,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 51,
                                                                                    "end_token": 51,
                                                                                    "label": "webhook"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 53,
                                                                                    "end_token": 53,
                                                                                    "label": "provider"
                                                                                }
                                                                            ],
                                                                            "label": "webhook.provider"
                                                                        }
                                                                    ],
                                                                    "label": "WEBHOOK_MANAGERS_BY_NAME[webhook.provider]"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 55,
                                                                    "end_token": 56,
                                                                    "children": [],
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "WEBHOOK_MANAGERS_BY_NAME[webhook.provider]()"
                                                        }
                                                    ],
                                                    "label": "webhook_manager = WEBHOOK_MANAGERS_BY_NAME[webhook.provider]()"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 59,
                                                    "end_token": 82,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 59,
                                                            "end_token": 59,
                                                            "label": "credentials"
                                                        },
                                                        {
                                                            "type": "conditional_expression",
                                                            "start_token": 61,
                                                            "end_token": 81,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 63,
                                                                    "end_token": 72,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 63,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "label": "creds_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 65,
                                                                                    "end_token": 65,
                                                                                    "label": "get"
                                                                                }
                                                                            ],
                                                                            "label": "creds_manager.get"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 66,
                                                                            "end_token": 72,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 67,
                                                                                    "label": "user_id"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 69,
                                                                                    "end_token": 71,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 69,
                                                                                            "end_token": 69,
                                                                                            "label": "webhook"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 71,
                                                                                            "end_token": 71,
                                                                                            "label": "credentials_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "webhook.credentials_id"
                                                                                }
                                                                            ],
                                                                            "label": "(user_id, webhook.credentials_id)"
                                                                        }
                                                                    ],
                                                                    "label": "creds_manager.get(user_id, webhook.credentials_id)"
                                                                },
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": 74,
                                                                    "end_token": 78,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 74,
                                                                            "end_token": 74,
                                                                            "label": "if"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 76,
                                                                            "end_token": 77,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 76,
                                                                                    "end_token": 76,
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 77,
                                                                                    "end_token": 77,
                                                                                    "label": "credentials_id"
                                                                                }
                                                                            ],
                                                                            "label": ".credentials_id"
                                                                        }
                                                                    ],
                                                                    "label": "if webhook.credentials_id\n"
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 80,
                                                                    "end_token": 80,
                                                                    "label": "None"
                                                                }
                                                            ],
                                                            "label": "(\n        creds_manager.get(user_id, webhook.credentials_id)\n        if webhook.credentials_id\n        else None\n"
                                                        }
                                                    ],
                                                    "label": "credentials = (\n        creds_manager.get(user_id, webhook.credentials_id)\n        if webhook.credentials_id\n        else None\n    )"
                                                },
                                                {
                                                    "type": "try_statement",
                                                    "start_token": 84,
                                                    "end_token": 135,
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "start_token": 86,
                                                            "end_token": 95,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "start_token": 87,
                                                                    "end_token": 95,
                                                                    "children": [
                                                                        {
                                                                            "type": "await",
                                                                            "start_token": 87,
                                                                            "end_token": 95,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 88,
                                                                                    "end_token": 95,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 88,
                                                                                            "end_token": 90,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 88,
                                                                                                    "end_token": 88,
                                                                                                    "label": "webhook_manager"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 90,
                                                                                                    "end_token": 90,
                                                                                                    "label": "trigger_ping"
                                                                                                }
                                                                                            ],
                                                                                            "label": "webhook_manager.trigger_ping"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 91,
                                                                                            "end_token": 95,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 92,
                                                                                                    "end_token": 92,
                                                                                                    "label": "webhook"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 94,
                                                                                                    "end_token": 94,
                                                                                                    "label": "credentials"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(webhook, credentials)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "webhook_manager.trigger_ping(webhook, credentials)"
                                                                                }
                                                                            ],
                                                                            "label": "await webhook_manager.trigger_ping(webhook, credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "await webhook_manager.trigger_ping(webhook, credentials)"
                                                                }
                                                            ],
                                                            "label": "\n        await webhook_manager.trigger_ping(webhook, credentials)"
                                                        },
                                                        {
                                                            "type": "except_clause",
                                                            "start_token": 97,
                                                            "end_token": 103,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 98,
                                                                    "end_token": 98,
                                                                    "label": "NotImplementedError"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 99,
                                                                    "end_token": 102,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 101,
                                                                            "end_token": 102,
                                                                            "children": [
                                                                                {
                                                                                    "type": "false",
                                                                                    "start_token": 102,
                                                                                    "end_token": 102,
                                                                                    "label": "False"
                                                                                }
                                                                            ],
                                                                            "label": "return False"
                                                                        }
                                                                    ],
                                                                    "label": ":\n        return False"
                                                                }
                                                            ],
                                                            "label": "except NotImplementedError:\n        return False\n"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 105,
                                                            "end_token": 134,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 106,
                                                                    "end_token": 107,
                                                                    "children": [
                                                                        {
                                                                            "type": "await",
                                                                            "start_token": 107,
                                                                            "end_token": 119,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 108,
                                                                                    "end_token": 119,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 108,
                                                                                            "end_token": 108,
                                                                                            "label": "wait_for_webhook_event"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 109,
                                                                                            "end_token": 119,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 110,
                                                                                                    "end_token": 110,
                                                                                                    "label": "webhook_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 112,
                                                                                                    "end_token": 114,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 112,
                                                                                                            "end_token": 112,
                                                                                                            "label": "event_type"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 114,
                                                                                                            "end_token": 114,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "start_token": 114,
                                                                                                                    "end_token": 114,
                                                                                                                    "label": "\"ping\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"ping\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "event_type=\"ping\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 116,
                                                                                                    "end_token": 118,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 116,
                                                                                                            "end_token": 116,
                                                                                                            "label": "timeout"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "integer",
                                                                                                            "start_token": 118,
                                                                                                            "end_token": 118,
                                                                                                            "label": "10"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "timeout=10"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(webhook_id, event_type=\"ping\", timeout=10)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10)"
                                                                                }
                                                                            ],
                                                                            "label": "await wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10)"
                                                                        }
                                                                    ],
                                                                    "label": "not await"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 122,
                                                                    "end_token": 132,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 122,
                                                                            "end_token": 132,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 123,
                                                                                    "end_token": 132,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 123,
                                                                                            "end_token": 123,
                                                                                            "label": "HTTPException"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 124,
                                                                                            "end_token": 132,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 125,
                                                                                                    "end_token": 127,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 125,
                                                                                                            "end_token": 125,
                                                                                                            "label": "status_code"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "integer",
                                                                                                            "start_token": 127,
                                                                                                            "end_token": 127,
                                                                                                            "label": "504"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "status_code=504"
                                                                                                },
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 129,
                                                                                                    "end_token": 131,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 129,
                                                                                                            "end_token": 129,
                                                                                                            "label": "detail"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 131,
                                                                                                            "end_token": 131,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "start_token": 131,
                                                                                                                    "end_token": 131,
                                                                                                                    "label": "\"Webhook ping timed out\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"Webhook ping timed out\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "detail=\"Webhook ping timed out\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(status_code=504, detail=\"Webhook ping timed out\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "HTTPException(status_code=504, detail=\"Webhook ping timed out\")"
                                                                                }
                                                                            ],
                                                                            "label": "raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")"
                                                                        }
                                                                    ],
                                                                    "label": "raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")"
                                                                }
                                                            ],
                                                            "label": "if not await wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10):\n        raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")\n\n"
                                                        }
                                                    ],
                                                    "label": "try:\n        await webhook_manager.trigger_ping(webhook, credentials)\n    except NotImplementedError:\n        return False\n\n    if not await wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10):\n        raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")\n\n    return"
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 135,
                                                    "end_token": 136,
                                                    "children": [
                                                        {
                                                            "type": "true",
                                                            "start_token": 136,
                                                            "end_token": 136,
                                                            "label": "True"
                                                        }
                                                    ],
                                                    "label": "return True"
                                                }
                                            ],
                                            "label": "\n    webhook = await get_webhook(webhook_id)\n    webhook_manager = WEBHOOK_MANAGERS_BY_NAME[webhook.provider]()\n\n    credentials = (\n        creds_manager.get(user_id, webhook.credentials_id)\n        if webhook.credentials_id\n        else None\n    )\n    try:\n        await webhook_manager.trigger_ping(webhook, credentials)\n    except NotImplementedError:\n        return False\n\n    if not await wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10):\n        raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")\n\n    return True"
                                        }
                                    ],
                                    "label": "def webhook_ping(\n    webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],\n    user_id: Annotated[str, Depends(get_user_id)],  # require auth\n):\n    webhook = await get_webhook(webhook_id)\n    webhook_manager = WEBHOOK_MANAGERS_BY_NAME[webhook.provider]()\n\n    credentials = (\n        creds_manager.get(user_id, webhook.credentials_id)\n        if webhook.credentials_id\n        else None\n    )\n    try:\n        await webhook_manager.trigger_ping(webhook, credentials)\n    except NotImplementedError:\n        return False\n\n    if not await wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10):\n        raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")\n\n    return True"
                                }
                            ],
                            "label": "async def webhook_ping(\n    webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],\n    user_id: Annotated[str, Depends(get_user_id)],  # require auth\n):\n    webhook = await get_webhook(webhook_id)\n    webhook_manager = WEBHOOK_MANAGERS_BY_NAME[webhook.provider]()\n\n    credentials = (\n        creds_manager.get(user_id, webhook.credentials_id)\n        if webhook.credentials_id\n        else None\n    )\n    try:\n        await webhook_manager.trigger_ping(webhook, credentials)\n    except NotImplementedError:\n        return False\n\n    if not await wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10):\n        raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")\n\n    return True"
                        }
                    ],
                    "label": "async def webhook_ping(\n    webhook_id: Annotated[str, Path(title=\"Our ID for the webhook\")],\n    user_id: Annotated[str, Depends(get_user_id)],  # require auth\n):\n    webhook = await get_webhook(webhook_id)\n    webhook_manager = WEBHOOK_MANAGERS_BY_NAME[webhook.provider]()\n\n    credentials = (\n        creds_manager.get(user_id, webhook.credentials_id)\n        if webhook.credentials_id\n        else None\n    )\n    try:\n        await webhook_manager.trigger_ping(webhook, credentials)\n    except NotImplementedError:\n        return False\n\n    if not await wait_for_webhook_event(webhook_id, event_type=\"ping\", timeout=10):\n        raise HTTPException(status_code=504, detail=\"Webhook ping timed out\")\n\n    return True"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "remove_all_webhooks_for_credentials",
            "start_line": 353,
            "end_line": 391,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 168,
                    "children": [
                        {
                            "type": "decorated_definition",
                            "start_token": 0,
                            "end_token": 168,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "async"
                                },
                                {
                                    "type": "function_definition",
                                    "start_token": 1,
                                    "end_token": 168,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 2,
                                            "end_token": 2,
                                            "label": "remove_all_webhooks_for_credentials"
                                        },
                                        {
                                            "type": "parameters",
                                            "start_token": 3,
                                            "end_token": 15,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "start_token": 5,
                                                    "end_token": 7,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 5,
                                                            "end_token": 5,
                                                            "label": "credentials"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 7,
                                                            "end_token": 7,
                                                            "label": "Credentials"
                                                        }
                                                    ],
                                                    "label": "credentials: Credentials"
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 9,
                                                    "end_token": 13,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 9,
                                                            "end_token": 9,
                                                            "label": "force"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 11,
                                                            "end_token": 11,
                                                            "label": "bool"
                                                        },
                                                        {
                                                            "type": "boolean_operator",
                                                            "start_token": 13,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "false",
                                                                    "start_token": 13,
                                                                    "end_token": 13,
                                                                    "label": "False"
                                                                }
                                                            ],
                                                            "label": "False"
                                                        }
                                                    ],
                                                    "label": "force: bool = False"
                                                }
                                            ],
                                            "label": "(\n    credentials: Credentials, force: bool = False\n)"
                                        },
                                        {
                                            "type": "type",
                                            "start_token": 17,
                                            "end_token": 18,
                                            "children": [
                                                {
                                                    "type": "none",
                                                    "start_token": 18,
                                                    "end_token": 18,
                                                    "label": "None"
                                                }
                                            ],
                                            "label": "> None"
                                        },
                                        {
                                            "type": "string",
                                            "start_token": 21,
                                            "end_token": 23,
                                            "children": [
                                                {
                                                    "type": "string_content",
                                                    "start_token": 22,
                                                    "end_token": 22,
                                                    "label": "\"\n    Remove and deregister all webhooks that were registered using the given credentials.\n\n    Params:\n        credentials: The credentials for which to remove the associated webhooks.\n        force: Whether to proceed if any of the webhooks are still in use.\n\n    Raises:\n        NeedConfirmation: If any of the webhooks are still in use and `force` is `False`\n    \""
                                                }
                                            ],
                                            "label": "\"\"\"\n    Remove and deregister all webhooks that were registered using the given credentials.\n\n    Params:\n        credentials: The credentials for which to remove the associated webhooks.\n        force: Whether to proceed if any of the webhooks are still in use.\n\n    Raises:\n        NeedConfirmation: If any of the webhooks are still in use and `force` is `False`\n    \"\"\""
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 24,
                                            "end_token": 168,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 25,
                                                    "end_token": 33,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 25,
                                                            "end_token": 25,
                                                            "label": "webhooks"
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 27,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 28,
                                                                    "end_token": 33,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 28,
                                                                            "end_token": 28,
                                                                            "label": "get_all_webhooks_by_creds"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 29,
                                                                            "end_token": 33,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 30,
                                                                                    "end_token": 32,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 30,
                                                                                            "end_token": 30,
                                                                                            "label": "credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 32,
                                                                                            "end_token": 32,
                                                                                            "label": "id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "credentials.id"
                                                                                }
                                                                            ],
                                                                            "label": "(credentials.id)"
                                                                        }
                                                                    ],
                                                                    "label": "get_all_webhooks_by_creds(credentials.id)"
                                                                }
                                                            ],
                                                            "label": "await get_all_webhooks_by_creds(credentials.id)"
                                                        }
                                                    ],
                                                    "label": "webhooks = await get_all_webhooks_by_creds(credentials.id)"
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 35,
                                                    "end_token": 64,
                                                    "children": [
                                                        {
                                                            "type": "boolean_operator",
                                                            "start_token": 36,
                                                            "end_token": 41,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 36,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 36,
                                                                            "end_token": 36,
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 38,
                                                                            "end_token": 38,
                                                                            "label": "provider"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.provider"
                                                                },
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 39,
                                                                    "end_token": 41,
                                                                    "label": "not in WEBHOOK_MANAGERS_BY_NAME"
                                                                }
                                                            ],
                                                            "label": "credentials.provider not in WEBHOOK_MANAGERS_BY_NAME"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 42,
                                                            "end_token": 64,
                                                            "children": [
                                                                {
                                                                    "type": "if_statement",
                                                                    "start_token": 44,
                                                                    "end_token": 64,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 45,
                                                                            "end_token": 45,
                                                                            "label": "webhooks"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 46,
                                                                            "end_token": 64,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "start_token": 48,
                                                                                    "end_token": 62,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 48,
                                                                                            "end_token": 62,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 48,
                                                                                                    "end_token": 50,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 48,
                                                                                                            "end_token": 48,
                                                                                                            "label": "logger"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 50,
                                                                                                            "end_token": 50,
                                                                                                            "label": "error"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "logger.error"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 51,
                                                                                                    "end_token": 62,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "concatenated_string",
                                                                                                            "start_token": 53,
                                                                                                            "end_token": 61,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "start_token": 53,
                                                                                                                    "end_token": 54,
                                                                                                                    "label": "f\"Credentials #{credentials.id} for provider {credentials.provider} \""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "start_token": 56,
                                                                                                                    "end_token": 57,
                                                                                                                    "label": "f\"are attached to {len(webhooks)} webhooks, \""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "start_token": 59,
                                                                                                                    "end_token": 60,
                                                                                                                    "label": "f\"but there is no available WebhooksHandler for {credentials.provider}\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )"
                                                                                                }
                                                                                            ],
                                                                                            "label": "logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )"
                                                                                        }
                                                                                    ],
                                                                                    "label": "logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )"
                                                                                },
                                                                                {
                                                                                    "type": "return_statement",
                                                                                    "start_token": 64,
                                                                                    "end_token": 64,
                                                                                    "label": "return"
                                                                                }
                                                                            ],
                                                                            "label": ":\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return"
                                                                        }
                                                                    ],
                                                                    "label": "if webhooks:\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return"
                                                                }
                                                            ],
                                                            "label": ":\n        if webhooks:\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return"
                                                        }
                                                    ],
                                                    "label": "if credentials.provider not in WEBHOOK_MANAGERS_BY_NAME:\n        if webhooks:\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return"
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 66,
                                                    "end_token": 88,
                                                    "children": [
                                                        {
                                                            "type": "binary_operator",
                                                            "start_token": 67,
                                                            "end_token": 79,
                                                            "children": [
                                                                {
                                                                    "type": "generator_expression",
                                                                    "start_token": 68,
                                                                    "end_token": 76,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 69,
                                                                            "end_token": 71,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 69,
                                                                                    "end_token": 69,
                                                                                    "label": "w"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 71,
                                                                                    "end_token": 71,
                                                                                    "label": "attached_nodes"
                                                                                }
                                                                            ],
                                                                            "label": "w.attached_nodes"
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": 72,
                                                                            "end_token": 75,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 73,
                                                                                    "end_token": 73,
                                                                                    "label": "w"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 75,
                                                                                    "end_token": 75,
                                                                                    "label": "webhooks"
                                                                                }
                                                                            ],
                                                                            "label": "for w in webhooks"
                                                                        }
                                                                    ],
                                                                    "label": "(w.attached_nodes for w in webhooks)"
                                                                },
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 78,
                                                                    "end_token": 79,
                                                                    "label": "not force"
                                                                }
                                                            ],
                                                            "label": "any(w.attached_nodes for w in webhooks) and not force"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 80,
                                                            "end_token": 88,
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 82,
                                                                    "end_token": 88,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 83,
                                                                            "end_token": 83,
                                                                            "label": "NeedConfirmation"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 84,
                                                                            "end_token": 88,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 86,
                                                                                    "end_token": 86,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "start_token": 86,
                                                                                            "end_token": 86,
                                                                                            "label": "\"Some webhooks linked to these credentials are still in use by an agent\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "\"Some webhooks linked to these credentials are still in use by an agent\""
                                                                                }
                                                                            ],
                                                                            "label": "(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "raise NeedConfirmation(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )"
                                                                }
                                                            ],
                                                            "label": ":\n        raise NeedConfirmation(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )"
                                                        }
                                                    ],
                                                    "label": "if any(w.attached_nodes for w in webhooks) and not force:\n        raise NeedConfirmation(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )"
                                                },
                                                {
                                                    "type": "for_statement",
                                                    "start_token": 90,
                                                    "end_token": 165,
                                                    "children": [
                                                        {
                                                            "type": "for_in_clause",
                                                            "start_token": 91,
                                                            "end_token": 94,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 91,
                                                                    "end_token": 91,
                                                                    "label": "webhook"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 93,
                                                                    "end_token": 93,
                                                                    "label": "webhooks"
                                                                }
                                                            ],
                                                            "label": "webhook in webhooks:"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 95,
                                                            "end_token": 165,
                                                            "children": [
                                                                {
                                                                    "type": "for_statement",
                                                                    "start_token": 101,
                                                                    "end_token": 120,
                                                                    "children": [
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": 102,
                                                                            "end_token": 110,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 102,
                                                                                    "end_token": 102,
                                                                                    "label": "node"
                                                                                },
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "start_token": 104,
                                                                                    "end_token": 110,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 104,
                                                                                            "end_token": 106,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 104,
                                                                                                    "end_token": 104,
                                                                                                    "label": "webhook"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 106,
                                                                                                    "end_token": 106,
                                                                                                    "label": "attached_nodes"
                                                                                                }
                                                                                            ],
                                                                                            "label": "webhook.attached_nodes"
                                                                                        },
                                                                                        {
                                                                                            "type": "list",
                                                                                            "start_token": 108,
                                                                                            "end_token": 109,
                                                                                            "label": "[]"
                                                                                        }
                                                                                    ],
                                                                                    "label": "webhook.attached_nodes or []:"
                                                                                }
                                                                            ],
                                                                            "label": "node in webhook.attached_nodes or []:"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 111,
                                                                            "end_token": 120,
                                                                            "children": [
                                                                                {
                                                                                    "type": "await",
                                                                                    "start_token": 112,
                                                                                    "end_token": 120,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 113,
                                                                                            "end_token": 120,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 113,
                                                                                                    "end_token": 113,
                                                                                                    "label": "set_node_webhook"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 114,
                                                                                                    "end_token": 119,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 115,
                                                                                                            "end_token": 117,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 115,
                                                                                                                    "end_token": 115,
                                                                                                                    "label": "node"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 117,
                                                                                                                    "end_token": 117,
                                                                                                                    "label": "id"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "node.id"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "none",
                                                                                                            "start_token": 119,
                                                                                                            "end_token": 119,
                                                                                                            "label": "None"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(node.id, None"
                                                                                                }
                                                                                            ],
                                                                                            "label": "set_node_webhook(node.id, None)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "await set_node_webhook(node.id, None)"
                                                                                }
                                                                            ],
                                                                            "label": "\n            await set_node_webhook(node.id, None)"
                                                                        }
                                                                    ],
                                                                    "label": "for node in webhook.attached_nodes or []:\n            await set_node_webhook(node.id, None)"
                                                                },
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 128,
                                                                    "end_token": 137,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 128,
                                                                            "end_token": 128,
                                                                            "label": "webhook_manager"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 130,
                                                                            "end_token": 137,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "start_token": 130,
                                                                                    "end_token": 135,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 130,
                                                                                            "end_token": 130,
                                                                                            "label": "WEBHOOK_MANAGERS_BY_NAME"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 132,
                                                                                            "end_token": 134,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 132,
                                                                                                    "end_token": 132,
                                                                                                    "label": "credentials"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 134,
                                                                                                    "end_token": 134,
                                                                                                    "label": "provider"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credentials.provider"
                                                                                        }
                                                                                    ],
                                                                                    "label": "WEBHOOK_MANAGERS_BY_NAME[credentials.provider]"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 136,
                                                                                    "end_token": 137,
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()"
                                                                        }
                                                                    ],
                                                                    "label": "webhook_manager = WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()"
                                                                },
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 139,
                                                                    "end_token": 153,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 139,
                                                                            "end_token": 139,
                                                                            "label": "success"
                                                                        },
                                                                        {
                                                                            "type": "await",
                                                                            "start_token": 141,
                                                                            "end_token": 153,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 142,
                                                                                    "end_token": 153,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 142,
                                                                                            "end_token": 144,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 142,
                                                                                                    "end_token": 142,
                                                                                                    "label": "webhook_manager"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 144,
                                                                                                    "end_token": 144,
                                                                                                    "label": "prune_webhook_if_dangling"
                                                                                                }
                                                                                            ],
                                                                                            "label": "webhook_manager.prune_webhook_if_dangling"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 145,
                                                                                            "end_token": 152,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 147,
                                                                                                    "end_token": 149,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 147,
                                                                                                            "end_token": 147,
                                                                                                            "label": "webhook"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 149,
                                                                                                            "end_token": 149,
                                                                                                            "label": "id"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "webhook.id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 151,
                                                                                                    "end_token": 151,
                                                                                                    "label": "credentials"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n            webhook.id, credentials\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )"
                                                                                }
                                                                            ],
                                                                            "label": "await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "success = await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )"
                                                                },
                                                                {
                                                                    "type": "if_statement",
                                                                    "start_token": 155,
                                                                    "end_token": 166,
                                                                    "children": [
                                                                        {
                                                                            "type": "not_operator",
                                                                            "start_token": 156,
                                                                            "end_token": 157,
                                                                            "label": "not success"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 158,
                                                                            "end_token": 166,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "start_token": 160,
                                                                                    "end_token": 165,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 160,
                                                                                            "end_token": 165,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 160,
                                                                                                    "end_token": 162,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 160,
                                                                                                            "end_token": 160,
                                                                                                            "label": "logger"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 162,
                                                                                                            "end_token": 162,
                                                                                                            "label": "warning"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "logger.warning"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 163,
                                                                                                    "end_token": 165,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "start_token": 164,
                                                                                                            "end_token": 164,
                                                                                                            "label": "f"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(f\"Webhook #{webhook.id} failed to prune\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "logger.warning(f\"Webhook #{webhook.id} failed to prune\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "logger.warning(f\"Webhook #{webhook.id} failed to prune\""
                                                                                }
                                                                            ],
                                                                            "label": ":\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\")"
                                                                        }
                                                                    ],
                                                                    "label": "if not success:\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\")"
                                                                }
                                                            ],
                                                            "label": "\n        # Unlink all nodes\n        for node in webhook.attached_nodes or []:\n            await set_node_webhook(node.id, None)\n\n        # Prune the webhook\n        webhook_manager = WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()\n        success = await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )\n        if not success:\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\""
                                                        }
                                                    ],
                                                    "label": "for webhook in webhooks:\n        # Unlink all nodes\n        for node in webhook.attached_nodes or []:\n            await set_node_webhook(node.id, None)\n\n        # Prune the webhook\n        webhook_manager = WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()\n        success = await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )\n        if not success:\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\""
                                                }
                                            ],
                                            "label": "\n    webhooks = await get_all_webhooks_by_creds(credentials.id)\n    if credentials.provider not in WEBHOOK_MANAGERS_BY_NAME:\n        if webhooks:\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return\n    if any(w.attached_nodes for w in webhooks) and not force:\n        raise NeedConfirmation(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )\n    for webhook in webhooks:\n        # Unlink all nodes\n        for node in webhook.attached_nodes or []:\n            await set_node_webhook(node.id, None)\n\n        # Prune the webhook\n        webhook_manager = WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()\n        success = await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )\n        if not success:\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\")\n\n"
                                        }
                                    ],
                                    "label": "def remove_all_webhooks_for_credentials(\n    credentials: Credentials, force: bool = False\n) -> None:\n    \"\"\"\n    Remove and deregister all webhooks that were registered using the given credentials.\n\n    Params:\n        credentials: The credentials for which to remove the associated webhooks.\n        force: Whether to proceed if any of the webhooks are still in use.\n\n    Raises:\n        NeedConfirmation: If any of the webhooks are still in use and `force` is `False`\n    \"\"\"\n    webhooks = await get_all_webhooks_by_creds(credentials.id)\n    if credentials.provider not in WEBHOOK_MANAGERS_BY_NAME:\n        if webhooks:\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return\n    if any(w.attached_nodes for w in webhooks) and not force:\n        raise NeedConfirmation(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )\n    for webhook in webhooks:\n        # Unlink all nodes\n        for node in webhook.attached_nodes or []:\n            await set_node_webhook(node.id, None)\n\n        # Prune the webhook\n        webhook_manager = WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()\n        success = await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )\n        if not success:\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\")\n\n"
                                }
                            ],
                            "label": "async def remove_all_webhooks_for_credentials(\n    credentials: Credentials, force: bool = False\n) -> None:\n    \"\"\"\n    Remove and deregister all webhooks that were registered using the given credentials.\n\n    Params:\n        credentials: The credentials for which to remove the associated webhooks.\n        force: Whether to proceed if any of the webhooks are still in use.\n\n    Raises:\n        NeedConfirmation: If any of the webhooks are still in use and `force` is `False`\n    \"\"\"\n    webhooks = await get_all_webhooks_by_creds(credentials.id)\n    if credentials.provider not in WEBHOOK_MANAGERS_BY_NAME:\n        if webhooks:\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return\n    if any(w.attached_nodes for w in webhooks) and not force:\n        raise NeedConfirmation(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )\n    for webhook in webhooks:\n        # Unlink all nodes\n        for node in webhook.attached_nodes or []:\n            await set_node_webhook(node.id, None)\n\n        # Prune the webhook\n        webhook_manager = WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()\n        success = await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )\n        if not success:\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\")\n\n"
                        }
                    ],
                    "label": "async def remove_all_webhooks_for_credentials(\n    credentials: Credentials, force: bool = False\n) -> None:\n    \"\"\"\n    Remove and deregister all webhooks that were registered using the given credentials.\n\n    Params:\n        credentials: The credentials for which to remove the associated webhooks.\n        force: Whether to proceed if any of the webhooks are still in use.\n\n    Raises:\n        NeedConfirmation: If any of the webhooks are still in use and `force` is `False`\n    \"\"\"\n    webhooks = await get_all_webhooks_by_creds(credentials.id)\n    if credentials.provider not in WEBHOOK_MANAGERS_BY_NAME:\n        if webhooks:\n            logger.error(\n                f\"Credentials #{credentials.id} for provider {credentials.provider} \"\n                f\"are attached to {len(webhooks)} webhooks, \"\n                f\"but there is no available WebhooksHandler for {credentials.provider}\"\n            )\n        return\n    if any(w.attached_nodes for w in webhooks) and not force:\n        raise NeedConfirmation(\n            \"Some webhooks linked to these credentials are still in use by an agent\"\n        )\n    for webhook in webhooks:\n        # Unlink all nodes\n        for node in webhook.attached_nodes or []:\n            await set_node_webhook(node.id, None)\n\n        # Prune the webhook\n        webhook_manager = WEBHOOK_MANAGERS_BY_NAME[credentials.provider]()\n        success = await webhook_manager.prune_webhook_if_dangling(\n            webhook.id, credentials\n        )\n        if not success:\n            logger.warning(f\"Webhook #{webhook.id} failed to prune\")\n\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "_get_provider_oauth_handler",
            "start_line": 393,
            "end_line": 422,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 152,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 152,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "_get_provider_oauth_handler"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 12,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 6,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "req"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 6,
                                                    "end_token": 6,
                                                    "children": [],
                                                    "label": "Request"
                                                }
                                            ],
                                            "label": "req: Request"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 8,
                                            "end_token": 10,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 8,
                                                    "end_token": 8,
                                                    "children": [],
                                                    "label": "provider_name"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "children": [],
                                                    "label": "ProviderName"
                                                }
                                            ],
                                            "label": "provider_name: ProviderName"
                                        }
                                    ],
                                    "label": "(\n    req: Request, provider_name: ProviderName\n)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 16,
                                    "end_token": 152,
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "start_token": 18,
                                            "end_token": 41,
                                            "children": [
                                                {
                                                    "type": "boolean_operator",
                                                    "start_token": 19,
                                                    "end_token": 22,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 19,
                                                            "end_token": 19,
                                                            "children": [],
                                                            "label": "provider_name"
                                                        },
                                                        {
                                                            "type": "not_operator",
                                                            "start_token": 20,
                                                            "end_token": 21,
                                                            "children": [],
                                                            "label": "not in"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 22,
                                                            "end_token": 22,
                                                            "children": [],
                                                            "label": "HANDLERS_BY_NAME"
                                                        }
                                                    ],
                                                    "label": "provider_name not in HANDLERS_BY_NAME"
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 25,
                                                    "end_token": 40,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 26,
                                                            "end_token": 40,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 26,
                                                                    "end_token": 26,
                                                                    "children": [],
                                                                    "label": "HTTPException"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 27,
                                                                    "end_token": 40,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 29,
                                                                            "end_token": 31,
                                                                            "children": [],
                                                                            "label": "status_code=404"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 34,
                                                                            "end_token": 38,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 36,
                                                                                    "end_token": 37,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "start_token": 37,
                                                                                            "end_token": 37,
                                                                                            "children": [],
                                                                                            "label": "\"Provider '{provider_name.value}' does not support OAuth\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "f\"Provider '{provider_name.value}' does not support OAuth\""
                                                                                }
                                                                            ],
                                                                            "label": "detail=f\"Provider '{provider_name.value}' does not support OAuth\","
                                                                        }
                                                                    ],
                                                                    "label": "(\n            status_code=404,\n            detail=f\"Provider '{provider_name.value}' does not support OAuth\",\n        )"
                                                                }
                                                            ],
                                                            "label": "HTTPException(\n            status_code=404,\n            detail=f\"Provider '{provider_name.value}' does not support OAuth\",\n        )"
                                                        }
                                                    ],
                                                    "label": "raise HTTPException(\n            status_code=404,\n            detail=f\"Provider '{provider_name.value}' does not support OAuth\",\n        )"
                                                }
                                            ],
                                            "label": "if provider_name not in HANDLERS_BY_NAME:\n        raise HTTPException(\n            status_code=404,\n            detail=f\"Provider '{provider_name.value}' does not support OAuth\",\n        )\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 43,
                                            "end_token": 53,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 43,
                                                    "end_token": 43,
                                                    "children": [],
                                                    "label": "client_id"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 45,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 45,
                                                            "end_token": 45,
                                                            "children": [],
                                                            "label": "getattr"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 46,
                                                            "end_token": 53,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 47,
                                                                    "end_token": 49,
                                                                    "children": [],
                                                                    "label": "settings.secrets"
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 51,
                                                                    "end_token": 52,
                                                                    "children": [
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 52,
                                                                            "end_token": 52,
                                                                            "children": [],
                                                                            "label": "\"{provider_name.value}_client_id\""
                                                                        }
                                                                    ],
                                                                    "label": "f\"{provider_name.value}_client_id\""
                                                                }
                                                            ],
                                                            "label": "(settings.secrets, f\"{provider_name.value}_client_id\")"
                                                        }
                                                    ],
                                                    "label": "getattr(settings.secrets, f\"{provider_name.value}_client_id\")"
                                                }
                                            ],
                                            "label": "client_id = getattr(settings.secrets, f\"{provider_name.value}_client_id\")"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 55,
                                            "end_token": 65,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 55,
                                                    "end_token": 55,
                                                    "children": [],
                                                    "label": "client_secret"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 57,
                                                    "end_token": 65,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 57,
                                                            "end_token": 57,
                                                            "children": [],
                                                            "label": "getattr"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 58,
                                                            "end_token": 65,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 59,
                                                                    "end_token": 61,
                                                                    "children": [],
                                                                    "label": "settings.secrets"
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 63,
                                                                    "end_token": 64,
                                                                    "children": [
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 64,
                                                                            "end_token": 64,
                                                                            "children": [],
                                                                            "label": "\"{provider_name.value}_client_secret\""
                                                                        }
                                                                    ],
                                                                    "label": "f\"{provider_name.value}_client_secret\""
                                                                }
                                                            ],
                                                            "label": "(settings.secrets, f\"{provider_name.value}_client_secret\")"
                                                        }
                                                    ],
                                                    "label": "getattr(settings.secrets, f\"{provider_name.value}_client_secret\")"
                                                }
                                            ],
                                            "label": "client_secret = getattr(settings.secrets, f\"{provider_name.value}_client_secret\")"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 67,
                                            "end_token": 95,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 68,
                                                    "end_token": 73,
                                                    "children": [
                                                        {
                                                            "type": "boolean_operator",
                                                            "start_token": 69,
                                                            "end_token": 73,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 70,
                                                                    "end_token": 70,
                                                                    "children": [],
                                                                    "label": "client_id"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 72,
                                                                    "end_token": 72,
                                                                    "children": [],
                                                                    "label": "client_secret"
                                                                }
                                                            ],
                                                            "label": "(client_id and client_secret)"
                                                        }
                                                    ],
                                                    "label": "not (client_id and client_secret)"
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "start_token": 76,
                                                    "end_token": 95,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 77,
                                                            "end_token": 95,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 77,
                                                                    "end_token": 77,
                                                                    "children": [],
                                                                    "label": "HTTPException"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 78,
                                                                    "end_token": 95,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 80,
                                                                            "end_token": 82,
                                                                            "children": [],
                                                                            "label": "status_code=501"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 85,
                                                                            "end_token": 91,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 89,
                                                                                    "end_token": 90,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "start_token": 90,
                                                                                            "end_token": 90,
                                                                                            "children": [],
                                                                                            "label": "\"Integration with provider '{provider_name.value}' is not configured\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "f\"Integration with provider '{provider_name.value}' is not configured\""
                                                                                }
                                                                            ],
                                                                            "label": "detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n"
                                                                        }
                                                                    ],
                                                                    "label": "(\n            status_code=501,\n            detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n            ),\n        )"
                                                                }
                                                            ],
                                                            "label": "HTTPException(\n            status_code=501,\n            detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n            ),\n        )"
                                                        }
                                                    ],
                                                    "label": "raise HTTPException(\n            status_code=501,\n            detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n            ),\n        )"
                                                }
                                            ],
                                            "label": "if not (client_id and client_secret):\n        raise HTTPException(\n            status_code=501,\n            detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n            ),\n        )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 98,
                                            "end_token": 103,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 98,
                                                    "end_token": 98,
                                                    "children": [],
                                                    "label": "handler_class"
                                                },
                                                {
                                                    "type": "subscript",
                                                    "start_token": 100,
                                                    "end_token": 103,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 100,
                                                            "end_token": 100,
                                                            "children": [],
                                                            "label": "HANDLERS_BY_NAME"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 102,
                                                            "end_token": 102,
                                                            "children": [],
                                                            "label": "provider_name"
                                                        }
                                                    ],
                                                    "label": "HANDLERS_BY_NAME[provider_name]"
                                                }
                                            ],
                                            "label": "handler_class = HANDLERS_BY_NAME[provider_name]"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 105,
                                            "end_token": 128,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 105,
                                                    "end_token": 105,
                                                    "children": [],
                                                    "label": "frontend_base_url"
                                                },
                                                {
                                                    "type": "boolean_operator",
                                                    "start_token": 107,
                                                    "end_token": 128,
                                                    "children": [
                                                        {
                                                            "type": "boolean_operator",
                                                            "start_token": 109,
                                                            "end_token": 113,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 109,
                                                                    "end_token": 111,
                                                                    "children": [],
                                                                    "label": "settings.config"
                                                                }
                                                            ],
                                                            "label": "settings.config.frontend_base_url"
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 116,
                                                            "end_token": 119,
                                                            "children": [],
                                                            "label": "settings.config."
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 123,
                                                            "end_token": 128,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 123,
                                                                    "end_token": 123,
                                                                    "children": [],
                                                                    "label": "str"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 125,
                                                                    "end_token": 127,
                                                                    "children": [],
                                                                    "label": "req.base_url"
                                                                }
                                                            ],
                                                            "label": "str(req.base_url)"
                                                        }
                                                    ],
                                                    "label": "(\n        settings.config.frontend_base_url\n        or settings.config.platform_base_url\n        or str(req.base_url)"
                                                }
                                            ],
                                            "label": "frontend_base_url = (\n        settings.config.frontend_base_url\n        or settings.config.platform_base_url\n        or str(req.base_url)"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 132,
                                            "end_token": 152,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 133,
                                                    "end_token": 152,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 133,
                                                            "end_token": 133,
                                                            "children": [],
                                                            "label": "handler_class"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 134,
                                                            "end_token": 152,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 136,
                                                                    "end_token": 138,
                                                                    "children": [],
                                                                    "label": "client_id=client_id"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 141,
                                                                    "end_token": 143,
                                                                    "children": [],
                                                                    "label": "client_secret=client_secret"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 146,
                                                                    "end_token": 149,
                                                                    "children": [
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 148,
                                                                            "end_token": 149,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 149,
                                                                                    "end_token": 149,
                                                                                    "children": [],
                                                                                    "label": "\"{frontend_base_url}/auth/integrations/oauth_callback\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"{frontend_base_url}/auth/integrations/oauth_callback\""
                                                                        }
                                                                    ],
                                                                    "label": "redirect_uri=f\"{frontend_base_url}/auth/integrations/oauth_callback\""
                                                                }
                                                            ],
                                                            "label": "(\n        client_id=client_id,\n        client_secret=client_secret,\n        redirect_uri=f\"{frontend_base_url}/auth/integrations/oauth_callback\",\n    )"
                                                        }
                                                    ],
                                                    "label": "handler_class(\n        client_id=client_id,\n        client_secret=client_secret,\n        redirect_uri=f\"{frontend_base_url}/auth/integrations/oauth_callback\",\n    )"
                                                }
                                            ],
                                            "label": "return handler_class(\n        client_id=client_id,\n        client_secret=client_secret,\n        redirect_uri=f\"{frontend_base_url}/auth/integrations/oauth_callback\",\n    )"
                                        }
                                    ],
                                    "label": ":\n    if provider_name not in HANDLERS_BY_NAME:\n        raise HTTPException(\n            status_code=404,\n            detail=f\"Provider '{provider_name.value}' does not support OAuth\",\n        )\n\n    client_id = getattr(settings.secrets, f\"{provider_name.value}_client_id\")\n    client_secret = getattr(settings.secrets, f\"{provider_name.value}_client_secret\")\n    if not (client_id and client_secret):\n        raise HTTPException(\n            status_code=501,\n            detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n            ),\n        )\n\n    handler_class = HANDLERS_BY_NAME[provider_name]\n    frontend_base_url = (\n        settings.config.frontend_base_url\n        or settings.config.platform_base_url\n        or str(req.base_url)\n    )\n    return handler_class(\n        client_id=client_id,\n        client_secret=client_secret,\n        redirect_uri=f\"{frontend_base_url}/auth/integrations/oauth_callback\",\n    )"
                                }
                            ],
                            "label": "def _get_provider_oauth_handler(\n    req: Request, provider_name: ProviderName\n) -> \"BaseOAuthHandler\":\n    if provider_name not in HANDLERS_BY_NAME:\n        raise HTTPException(\n            status_code=404,\n            detail=f\"Provider '{provider_name.value}' does not support OAuth\",\n        )\n\n    client_id = getattr(settings.secrets, f\"{provider_name.value}_client_id\")\n    client_secret = getattr(settings.secrets, f\"{provider_name.value}_client_secret\")\n    if not (client_id and client_secret):\n        raise HTTPException(\n            status_code=501,\n            detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n            ),\n        )\n\n    handler_class = HANDLERS_BY_NAME[provider_name]\n    frontend_base_url = (\n        settings.config.frontend_base_url\n        or settings.config.platform_base_url\n        or str(req.base_url)\n    )\n    return handler_class(\n        client_id=client_id,\n        client_secret=client_secret,\n        redirect_uri=f\"{frontend_base_url}/auth/integrations/oauth_callback\",\n    )"
                        }
                    ],
                    "label": "def _get_provider_oauth_handler(\n    req: Request, provider_name: ProviderName\n) -> \"BaseOAuthHandler\":\n    if provider_name not in HANDLERS_BY_NAME:\n        raise HTTPException(\n            status_code=404,\n            detail=f\"Provider '{provider_name.value}' does not support OAuth\",\n        )\n\n    client_id = getattr(settings.secrets, f\"{provider_name.value}_client_id\")\n    client_secret = getattr(settings.secrets, f\"{provider_name.value}_client_secret\")\n    if not (client_id and client_secret):\n        raise HTTPException(\n            status_code=501,\n            detail=(\n                f\"Integration with provider '{provider_name.value}' is not configured\"\n            ),\n        )\n\n    handler_class = HANDLERS_BY_NAME[provider_name]\n    frontend_base_url = (\n        settings.config.frontend_base_url\n        or settings.config.platform_base_url\n        or str(req.base_url)\n    )\n    return handler_class(\n        client_id=client_id,\n        client_secret=client_secret,\n        redirect_uri=f\"{frontend_base_url}/auth/integrations/oauth_callback\",\n    )"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "LoginResponse",
            "start_line": 42,
            "end_line": 44,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 14,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 14,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "LoginResponse"
                                },
                                {
                                    "type": "argument_list",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "children": [],
                                            "label": "BaseModel"
                                        }
                                    ],
                                    "label": "(BaseModel)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 6,
                                    "end_token": 14,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 7,
                                            "end_token": 9,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "children": [],
                                                    "label": "login_url"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 9,
                                                    "end_token": 9,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "login_url: str"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 11,
                                            "end_token": 13,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 11,
                                                    "end_token": 11,
                                                    "children": [],
                                                    "label": "state_token"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 13,
                                                    "end_token": 13,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "state_token: str"
                                        }
                                    ],
                                    "label": "\n    login_url: str\n    state_token: str\n"
                                }
                            ],
                            "label": "class LoginResponse(BaseModel):\n    login_url: str\n    state_token: str\n"
                        }
                    ],
                    "label": "class LoginResponse(BaseModel):\n    login_url: str\n    state_token: str\n"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "CredentialsMetaResponse",
            "start_line": 72,
            "end_line": 78,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 39,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 39,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "CredentialsMetaResponse"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "children": [],
                                            "label": "BaseModel"
                                        }
                                    ],
                                    "label": "(BaseModel)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 6,
                                    "end_token": 39,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 7,
                                            "end_token": 9,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "children": [],
                                                    "label": "id"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 9,
                                                    "end_token": 9,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "id: str"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 11,
                                            "end_token": 13,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 11,
                                                    "end_token": 11,
                                                    "children": [],
                                                    "label": "provider"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 13,
                                                    "end_token": 13,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "provider: str"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 15,
                                            "end_token": 17,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 15,
                                                    "end_token": 15,
                                                    "children": [],
                                                    "label": "type"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 17,
                                                    "end_token": 17,
                                                    "children": [],
                                                    "label": "CredentialsType"
                                                }
                                            ],
                                            "label": "type: CredentialsType"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 19,
                                            "end_token": 23,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 19,
                                                    "end_token": 19,
                                                    "children": [],
                                                    "label": "title"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 21,
                                                    "end_token": 23,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 21,
                                                            "end_token": 21,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 23,
                                                            "end_token": 23,
                                                            "children": [],
                                                            "label": "None"
                                                        }
                                                    ],
                                                    "label": "str | None"
                                                }
                                            ],
                                            "label": "title: str | None"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 25,
                                            "end_token": 33,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 25,
                                                    "end_token": 25,
                                                    "children": [],
                                                    "label": "scopes"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 27,
                                                    "end_token": 33,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 27,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 27,
                                                                    "end_token": 27,
                                                                    "children": [],
                                                                    "label": "list"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 29,
                                                                    "end_token": 29,
                                                                    "children": [],
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "list[str]"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 33,
                                                            "end_token": 33,
                                                            "children": [],
                                                            "label": "\n"
                                                        }
                                                    ],
                                                    "label": "list[str] | None\n"
                                                }
                                            ],
                                            "label": "scopes: list[str] | None\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 34,
                                            "end_token": 38,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 34,
                                                    "end_token": 34,
                                                    "children": [],
                                                    "label": "username"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 36,
                                                    "end_token": 38,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 36,
                                                            "end_token": 36,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 38,
                                                            "end_token": 38,
                                                            "children": [],
                                                            "label": "None"
                                                        }
                                                    ],
                                                    "label": "str | None"
                                                }
                                            ],
                                            "label": "username: str | None"
                                        }
                                    ],
                                    "label": "\n    id: str\n    provider: str\n    type: CredentialsType\n    title: str | None\n    scopes: list[str] | None\n    username: str | None\n"
                                }
                            ],
                            "label": "class CredentialsMetaResponse(BaseModel):\n    id: str\n    provider: str\n    type: CredentialsType\n    title: str | None\n    scopes: list[str] | None\n    username: str | None\n"
                        }
                    ],
                    "label": "class CredentialsMetaResponse(BaseModel):\n    id: str\n    provider: str\n    type: CredentialsType\n    title: str | None\n    scopes: list[str] | None\n    username: str | None\n"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "CredentialsDeletionResponse",
            "start_line": 226,
            "end_line": 232,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 34,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 34,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "CredentialsDeletionResponse"
                                },
                                {
                                    "type": "argument_list",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "children": [],
                                            "label": "BaseModel"
                                        }
                                    ],
                                    "label": "(BaseModel)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 6,
                                    "end_token": 34,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 7,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "children": [],
                                                    "label": "deleted"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 9,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 9,
                                                            "end_token": 9,
                                                            "children": [],
                                                            "label": "Literal"
                                                        },
                                                        {
                                                            "type": "true",
                                                            "start_token": 11,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "True"
                                                        }
                                                    ],
                                                    "label": "Literal[True]"
                                                },
                                                {
                                                    "type": "true",
                                                    "start_token": 14,
                                                    "end_token": 14,
                                                    "children": [],
                                                    "label": "True"
                                                }
                                            ],
                                            "label": "deleted: Literal[True] = True"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 16,
                                            "end_token": 33,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 16,
                                                    "end_token": 16,
                                                    "children": [],
                                                    "label": "revoked"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 18,
                                                    "end_token": 20,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 18,
                                                            "end_token": 18,
                                                            "children": [],
                                                            "label": "bool"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 20,
                                                            "end_token": 20,
                                                            "children": [],
                                                            "label": "None"
                                                        }
                                                    ],
                                                    "label": "bool | None"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 22,
                                                    "end_token": 33,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 22,
                                                            "end_token": 22,
                                                            "children": [],
                                                            "label": "Field"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 23,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 25,
                                                                    "end_token": 31,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 25,
                                                                            "end_token": 25,
                                                                            "children": [],
                                                                            "label": "description"
                                                                        },
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 27,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "children": [],
                                                                                    "label": "\"Indicates whether the credentials were also revoked by their \""
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "children": [],
                                                                                    "label": "\"provider. `None`/`null` if not applicable, e.g. when deleting \""
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 31,
                                                                                    "end_token": 31,
                                                                                    "children": [],
                                                                                    "label": "\"non-revocable credentials such as API keys.\""
                                                                                }
                                                                            ],
                                                                            "label": "\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\""
                                                                        }
                                                                    ],
                                                                    "label": "description=\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\""
                                                                }
                                                            ],
                                                            "label": "(\n        description=\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\"\n    )"
                                                        }
                                                    ],
                                                    "label": "Field(\n        description=\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\"\n    )"
                                                }
                                            ],
                                            "label": "revoked: bool | None = Field(\n        description=\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\"\n    )"
                                        }
                                    ],
                                    "label": "\n    deleted: Literal[True] = True\n    revoked: bool | None = Field(\n        description=\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\"\n    )\n"
                                }
                            ],
                            "label": "class CredentialsDeletionResponse(BaseModel):\n    deleted: Literal[True] = True\n    revoked: bool | None = Field(\n        description=\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\"\n    )\n"
                        }
                    ],
                    "label": "class CredentialsDeletionResponse(BaseModel):\n    deleted: Literal[True] = True\n    revoked: bool | None = Field(\n        description=\"Indicates whether the credentials were also revoked by their \"\n        \"provider. `None`/`null` if not applicable, e.g. when deleting \"\n        \"non-revocable credentials such as API keys.\"\n    )\n"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "CredentialsDeletionNeedsConfirmationResponse",
            "start_line": 235,
            "end_line": 238,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 28,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 28,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "CredentialsDeletionNeedsConfirmationResponse"
                                },
                                {
                                    "type": "parenthesized_expression",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "children": [],
                                            "label": "BaseModel"
                                        }
                                    ],
                                    "label": "(BaseModel)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 6,
                                    "end_token": 28,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 7,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "children": [],
                                                    "label": "deleted"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 9,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 9,
                                                            "end_token": 9,
                                                            "children": [],
                                                            "label": "Literal"
                                                        },
                                                        {
                                                            "type": "false",
                                                            "start_token": 11,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "False"
                                                        }
                                                    ],
                                                    "label": "Literal[False]"
                                                },
                                                {
                                                    "type": "false",
                                                    "start_token": 14,
                                                    "end_token": 14,
                                                    "children": [],
                                                    "label": "False"
                                                }
                                            ],
                                            "label": "deleted: Literal[False] = False"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 16,
                                            "end_token": 23,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 16,
                                                    "end_token": 16,
                                                    "children": [],
                                                    "label": "need_confirmation"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 18,
                                                    "end_token": 21,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 18,
                                                            "end_token": 18,
                                                            "children": [],
                                                            "label": "Literal"
                                                        },
                                                        {
                                                            "type": "true",
                                                            "start_token": 20,
                                                            "end_token": 20,
                                                            "children": [],
                                                            "label": "True"
                                                        }
                                                    ],
                                                    "label": "Literal[True]"
                                                },
                                                {
                                                    "type": "true",
                                                    "start_token": 23,
                                                    "end_token": 23,
                                                    "children": [],
                                                    "label": "True"
                                                }
                                            ],
                                            "label": "need_confirmation: Literal[True] = True"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 25,
                                            "end_token": 27,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 25,
                                                    "end_token": 25,
                                                    "children": [],
                                                    "label": "message"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 27,
                                                    "end_token": 27,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "message: str"
                                        }
                                    ],
                                    "label": "\n    deleted: Literal[False] = False\n    need_confirmation: Literal[True] = True\n    message: str\n"
                                }
                            ],
                            "label": "class CredentialsDeletionNeedsConfirmationResponse(BaseModel):\n    deleted: Literal[False] = False\n    need_confirmation: Literal[True] = True\n    message: str\n"
                        }
                    ],
                    "label": "class CredentialsDeletionNeedsConfirmationResponse(BaseModel):\n    deleted: Literal[False] = False\n    need_confirmation: Literal[True] = True\n    message: str\n"
                }
            ]
        }
    ],
    "label": "import logging\nfrom typing import TYPE_CHECKING, Annotated, Literal\n\nfrom fastapi import APIRouter, Body, Depends, HTTPException, Path, Query, Request\nfrom pydantic import BaseModel, Field, SecretStr\n\nfrom backend.data.graph import set_node_webhook\nfrom backend.data.integrations import (\n    WebhookEvent,\n    get_all_webhooks_by_creds,\n    get_webhook,\n    publish_webhook_event,\n    wait_for_webhook_event,\n)\nfrom backend.data.model import (\n    APIKeyCredentials,\n    Credentials,\n    CredentialsType,\n    OAuth2Credentials,\n)\nfrom backend.executor.manager import ExecutionManager\nfrom backend.integrations.creds_manager import IntegrationCredentialsManager\nfrom backend.integrations.oauth import HANDLERS_BY_NAME\nfrom backend.integrations.providers import ProviderName\nfrom backend.integrations.webhooks import WEBHOOK_MANAGERS_BY_NAME\nfrom backend.util.exceptions import NeedConfirmation\nfrom backend.util.service import get_service_client\nfrom backend.util.settings import Settings\n\nif TYPE_CHECKING:\n    from backend.integrations.oauth import BaseOAuthHandler\n\nfrom ..utils import get_user_id\n\nlogger = logging.getLogger(__name__)\nsettings = Settings()\nrouter = APIRouter()\n\ncreds_manager = IntegrationCredentialsManager()\n\n\n\n\n@router.get(\"/{provider}/login\")\n\n\n\n\n@router.post(\"/{provider}/callback\")\n\n\n@router.get(\"/credentials\")\n\n\n@router.get(\"/{provider}/credentials\")\n\n\n@router.get(\"/{provider}/credentials/{cred_id}\")\n\n\n@router.post(\"/{provider}/credentials\", status_code=201)\n\n\n\n\n\n\n@router.delete(\"/{provider}/credentials/{cred_id}\")\n\n\n# ------------------------- WEBHOOK STUFF -------------------------- #\n\n\n# ⚠️ Note\n# No user auth check because this endpoint is for webhook ingress and relies on\n# validation by the provider-specific `WebhooksManager`.\n@router.post(\"/{provider}/webhooks/{webhook_id}/ingress\")\n\n\n@router.post(\"/webhooks/{webhook_id}/ping\")\n\n\n# --------------------------- UTILITIES ---------------------------- #\n\n\n\n"
}
{
    "type": "module",
    "start_token": 0,
    "end_token": 89,
    "children": [
        {
            "type": "import_from_statement",
            "start_token": 0,
            "end_token": 5,
            "children": [],
            "label": "from abc import ABC, abstractmethod"
        },
        {
            "type": "import_from_statement",
            "start_token": 7,
            "end_token": 12,
            "children": [],
            "label": "from datetime import datetime, timezone"
        },
        {
            "type": "import_from_statement",
            "start_token": 15,
            "end_token": 18,
            "children": [],
            "label": "from prisma import Json"
        },
        {
            "type": "import_from_statement",
            "start_token": 20,
            "end_token": 25,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 21,
                    "end_token": 23,
                    "children": [],
                    "label": "prisma.enums"
                }
            ],
            "label": "from prisma.enums import CreditTransactionType"
        },
        {
            "type": "import_from_statement",
            "start_token": 27,
            "end_token": 32,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 28,
                    "end_token": 30,
                    "children": [],
                    "label": "prisma.errors"
                }
            ],
            "label": "from prisma.errors import UniqueViolationError"
        },
        {
            "type": "import_from_statement",
            "start_token": 34,
            "end_token": 39,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 35,
                    "end_token": 37,
                    "children": [],
                    "label": "prisma.models"
                }
            ],
            "label": "from prisma.models import CreditTransaction"
        },
        {
            "type": "import_from_statement",
            "start_token": 42,
            "end_token": 54,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 43,
                    "end_token": 47,
                    "children": [],
                    "label": "backend.data.block"
                }
            ],
            "label": "from backend.data.block import Block, BlockInput, get_block\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 55,
            "end_token": 62,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 56,
                    "end_token": 60,
                    "children": [],
                    "label": "backend.data.block_cost_config"
                }
            ],
            "label": "from backend.data.block_cost_config import BLOCK_COSTS"
        },
        {
            "type": "import_from_statement",
            "start_token": 64,
            "end_token": 71,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 65,
                    "end_token": 69,
                    "children": [],
                    "label": "backend.data.cost"
                }
            ],
            "label": "from backend.data.cost import BlockCost"
        },
        {
            "type": "import_from_statement",
            "start_token": 75,
            "end_token": 82,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 76,
                    "end_token": 80,
                    "children": [],
                    "label": "backend.util.settings"
                }
            ],
            "label": "from backend.util.settings import Config"
        },
        {
            "type": "assignment",
            "start_token": 85,
            "end_token": 89,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 85,
                    "end_token": 85,
                    "children": [],
                    "label": "config"
                },
                {
                    "type": "call",
                    "start_token": 87,
                    "end_token": 89,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 87,
                            "end_token": 87,
                            "children": [],
                            "label": "Config"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 88,
                            "end_token": 89,
                            "children": [],
                            "label": "()"
                        }
                    ],
                    "label": "Config()"
                }
            ],
            "label": "config = Config()"
        },
        {
            "type": "function_placeholder",
            "name": "get_user_credit_model",
            "start_line": 226,
            "end_line": 230,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 37,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 37,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "get_user_credit_model"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 3,
                                    "children": [],
                                    "label": "()"
                                },
                                {
                                    "type": "type",
                                    "start_token": 5,
                                    "end_token": 6,
                                    "children": [],
                                    "label": "> UserCreditBase"
                                },
                                {
                                    "type": "block",
                                    "start_token": 7,
                                    "end_token": 37,
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "start_token": 9,
                                            "end_token": 29,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 10,
                                                    "end_token": 19,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 10,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": "config"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "enable_credit"
                                                                }
                                                            ],
                                                            "label": "config.enable_credit"
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 13,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 13,
                                                                    "end_token": 13,
                                                                    "children": [],
                                                                    "label": "."
                                                                },
                                                                {
                                                                    "type": "parenthesized_expression",
                                                                    "start_token": 15,
                                                                    "end_token": 16,
                                                                    "children": [],
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": ".lower("
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 19,
                                                            "end_token": 19,
                                                            "children": [],
                                                            "label": "\"true\""
                                                        }
                                                    ],
                                                    "label": "config.enable_credit.lower() == \"true\""
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 20,
                                                    "end_token": 29,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 22,
                                                            "end_token": 28,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 23,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 23,
                                                                            "end_token": 23,
                                                                            "children": [],
                                                                            "label": "UserCredit"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 24,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 25,
                                                                                    "end_token": 27,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 25,
                                                                                            "end_token": 25,
                                                                                            "children": [],
                                                                                            "label": "config"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 27,
                                                                                            "end_token": 27,
                                                                                            "children": [],
                                                                                            "label": "num_user_credits_refill"
                                                                                        }
                                                                                    ],
                                                                                    "label": "config.num_user_credits_refill"
                                                                                }
                                                                            ],
                                                                            "label": "(config.num_user_credits_refill)"
                                                                        }
                                                                    ],
                                                                    "label": "UserCredit(config.num_user_credits_refill)"
                                                                }
                                                            ],
                                                            "label": "return UserCredit(config.num_user_credits_refill)"
                                                        }
                                                    ],
                                                    "label": ":\n        return UserCredit(config.num_user_credits_refill)\n"
                                                }
                                            ],
                                            "label": "if config.enable_credit.lower() == \"true\":\n        return UserCredit(config.num_user_credits_refill)\n"
                                        },
                                        {
                                            "type": "else_clause",
                                            "start_token": 30,
                                            "end_token": 37,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 31,
                                                    "end_token": 37,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 33,
                                                            "end_token": 37,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 34,
                                                                    "end_token": 37,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 34,
                                                                            "end_token": 34,
                                                                            "children": [],
                                                                            "label": "DisabledUserCredit"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 35,
                                                                            "end_token": 37,
                                                                            "children": [
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 36,
                                                                                    "end_token": 36,
                                                                                    "children": [],
                                                                                    "label": "0"
                                                                                }
                                                                            ],
                                                                            "label": "(0)"
                                                                        }
                                                                    ],
                                                                    "label": "DisabledUserCredit(0)"
                                                                }
                                                            ],
                                                            "label": "return DisabledUserCredit(0)"
                                                        }
                                                    ],
                                                    "label": ":\n        return DisabledUserCredit(0)"
                                                }
                                            ],
                                            "label": "else:\n        return DisabledUserCredit(0)"
                                        }
                                    ],
                                    "label": ":\n    if config.enable_credit.lower() == \"true\":\n        return UserCredit(config.num_user_credits_refill)\n    else:\n        return DisabledUserCredit(0)"
                                }
                            ],
                            "label": "def get_user_credit_model() -> UserCreditBase:\n    if config.enable_credit.lower() == \"true\":\n        return UserCredit(config.num_user_credits_refill)\n    else:\n        return DisabledUserCredit(0)"
                        }
                    ],
                    "label": "def get_user_credit_model() -> UserCreditBase:\n    if config.enable_credit.lower() == \"true\":\n        return UserCredit(config.num_user_credits_refill)\n    else:\n        return DisabledUserCredit(0)"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "get_block_costs",
            "start_line": 233,
            "end_line": 234,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 36,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 36,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "get_block_costs"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 3,
                                    "children": [],
                                    "label": "()"
                                },
                                {
                                    "type": "type",
                                    "start_token": 5,
                                    "end_token": 14,
                                    "children": [
                                        {
                                            "type": "generic_type",
                                            "start_token": 6,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 6,
                                                    "end_token": 6,
                                                    "children": [],
                                                    "label": "dict"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 7,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 8,
                                                            "end_token": 8,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 10,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 13,
                                                                    "children": [],
                                                                    "label": "[BlockCost]"
                                                                }
                                                            ],
                                                            "label": "list[BlockCost]"
                                                        }
                                                    ],
                                                    "label": "[str, list[BlockCost]]"
                                                }
                                            ],
                                            "label": "dict[str, list[BlockCost]]"
                                        }
                                    ],
                                    "label": "> dict[str, list[BlockCost]]"
                                },
                                {
                                    "type": "block",
                                    "start_token": 16,
                                    "end_token": 36,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "start_token": 17,
                                            "end_token": 36,
                                            "children": [
                                                {
                                                    "type": "dictionary_comprehension",
                                                    "start_token": 18,
                                                    "end_token": 36,
                                                    "children": [
                                                        {
                                                            "type": "pair",
                                                            "start_token": 19,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 19,
                                                                    "end_token": 23,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "children": [],
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 23,
                                                                            "end_token": 23,
                                                                            "children": [],
                                                                            "label": "id"
                                                                        }
                                                                    ],
                                                                    "label": "block().id"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 25,
                                                                    "end_token": 25,
                                                                    "children": [],
                                                                    "label": "costs"
                                                                }
                                                            ],
                                                            "label": "block().id: costs"
                                                        },
                                                        {
                                                            "type": "for_in_clause",
                                                            "start_token": 26,
                                                            "end_token": 35,
                                                            "children": [
                                                                {
                                                                    "type": "tuple_pattern",
                                                                    "start_token": 27,
                                                                    "end_token": 29,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "children": [],
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 29,
                                                                            "end_token": 29,
                                                                            "children": [],
                                                                            "label": "costs"
                                                                        }
                                                                    ],
                                                                    "label": "block, costs"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 31,
                                                                    "end_token": 35,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 31,
                                                                            "end_token": 33,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 31,
                                                                                    "end_token": 31,
                                                                                    "children": [],
                                                                                    "label": "BLOCK_COSTS"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 33,
                                                                                    "end_token": 33,
                                                                                    "children": [],
                                                                                    "label": "items"
                                                                                }
                                                                            ],
                                                                            "label": "BLOCK_COSTS.items"
                                                                        }
                                                                    ],
                                                                    "label": "BLOCK_COSTS.items()"
                                                                }
                                                            ],
                                                            "label": "for block, costs in BLOCK_COSTS.items()"
                                                        }
                                                    ],
                                                    "label": "{block().id: costs for block, costs in BLOCK_COSTS.items()}"
                                                }
                                            ],
                                            "label": "return {block().id: costs for block, costs in BLOCK_COSTS.items()}"
                                        }
                                    ],
                                    "label": "\n    return {block().id: costs for block, costs in BLOCK_COSTS.items()}"
                                }
                            ],
                            "label": "def get_block_costs() -> dict[str, list[BlockCost]]:\n    return {block().id: costs for block, costs in BLOCK_COSTS.items()}"
                        }
                    ],
                    "label": "def get_block_costs() -> dict[str, list[BlockCost]]:\n    return {block().id: costs for block, costs in BLOCK_COSTS.items()}"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "UserCreditBase",
            "start_line": 17,
            "end_line": 66,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 18,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 5,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "class"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "UserCreditBase"
                                },
                                {
                                    "type": "parenthesized_expression",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "label": "ABC"
                                        }
                                    ],
                                    "label": "(ABC)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 5,
                                    "end_token": 18,
                                    "children": [
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 8,
                                            "end_token": 9,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 8,
                                                    "end_token": 9,
                                                    "label": "@abstractmethod"
                                                }
                                            ],
                                            "label": "@abstractmethod"
                                        },
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 12,
                                            "end_token": 13,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 12,
                                                    "end_token": 13,
                                                    "label": "@abstractmethod"
                                                }
                                            ],
                                            "label": "@abstractmethod"
                                        },
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 16,
                                            "end_token": 17,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 16,
                                                    "end_token": 17,
                                                    "label": "@abstractmethod"
                                                }
                                            ],
                                            "label": "@abstractmethod"
                                        }
                                    ],
                                    "label": ":\n\n    @abstractmethod\n\n    @abstractmethod\n\n    @abstractmethod\n"
                                }
                            ],
                            "label": "class UserCreditBase(ABC):"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__init__",
                            "start_line": 18,
                            "end_line": 19,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 15,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 15,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "__init__"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_default_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "children": [],
                                                                    "label": "num_user_credits_refill"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "int"
                                                                }
                                                            ],
                                                            "label": "num_user_credits_refill: int"
                                                        }
                                                    ],
                                                    "label": "(self, num_user_credits_refill: int)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 10,
                                                    "end_token": 15,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 11,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 11,
                                                                    "end_token": 13,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "children": [],
                                                                            "label": "num_user_credits_refill"
                                                                        }
                                                                    ],
                                                                    "label": "self.num_user_credits_refill"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "children": [],
                                                                    "label": "num_user_credits_refill"
                                                                }
                                                            ],
                                                            "label": "self.num_user_credits_refill = num_user_credits_refill"
                                                        }
                                                    ],
                                                    "label": "\n        self.num_user_credits_refill = num_user_credits_refill"
                                                }
                                            ],
                                            "label": "def __init__(self, num_user_credits_refill: int):\n        self.num_user_credits_refill = num_user_credits_refill"
                                        }
                                    ],
                                    "label": "def __init__(self, num_user_credits_refill: int):\n        self.num_user_credits_refill = num_user_credits_refill"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_or_refill_credit",
                            "start_line": 22,
                            "end_line": 29,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 20,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 19,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 0,
                                                            "end_token": 0,
                                                            "children": [],
                                                            "label": "async"
                                                        }
                                                    ],
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 2,
                                                    "end_token": 2,
                                                    "children": [],
                                                    "label": "get_or_refill_credit"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 9,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "self"
                                                                }
                                                            ],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 8,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 6,
                                                                    "end_token": 6,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 8,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 8,
                                                                            "end_token": 8,
                                                                            "children": [],
                                                                            "label": "str"
                                                                        }
                                                                    ],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": ", user_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str)"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 10,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 12,
                                                            "end_token": 12,
                                                            "children": [],
                                                            "label": "int"
                                                        }
                                                    ],
                                                    "label": "-> int"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 13,
                                                    "end_token": 19,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 15,
                                                            "end_token": 17,
                                                            "children": [
                                                                {
                                                                    "type": "string_content",
                                                                    "start_token": 16,
                                                                    "end_token": 16,
                                                                    "children": [],
                                                                    "label": "\"\n        Get the current credit for the user and refill if no transaction has been made in the current cycle.\n\n        Returns:\n            int: The current credit for the user.\n        \""
                                                                }
                                                            ],
                                                            "label": "\"\"\"\n        Get the current credit for the user and refill if no transaction has been made in the current cycle.\n\n        Returns:\n            int: The current credit for the user.\n        \"\"\""
                                                        },
                                                        {
                                                            "type": "pass_statement",
                                                            "start_token": 19,
                                                            "end_token": 19,
                                                            "children": [],
                                                            "label": "pass"
                                                        }
                                                    ],
                                                    "label": ":\n        \"\"\"\n        Get the current credit for the user and refill if no transaction has been made in the current cycle.\n\n        Returns:\n            int: The current credit for the user.\n        \"\"\"\n        pass"
                                                }
                                            ],
                                            "label": "async def get_or_refill_credit(self, user_id: str) -> int:\n        \"\"\"\n        Get the current credit for the user and refill if no transaction has been made in the current cycle.\n\n        Returns:\n            int: The current credit for the user.\n        \"\"\"\n        pass"
                                        }
                                    ],
                                    "label": "async def get_or_refill_credit(self, user_id: str) -> int:\n        \"\"\"\n        Get the current credit for the user and refill if no transaction has been made in the current cycle.\n\n        Returns:\n            int: The current credit for the user.\n        \"\"\"\n        pass\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "spend_credits",
                            "start_line": 32,
                            "end_line": 55,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 49,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 48,
                                            "children": [
                                                {
                                                    "type": "await",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [],
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 2,
                                                    "end_token": 2,
                                                    "children": [],
                                                    "label": "spend_credits"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 38,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 5,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "children": [],
                                                                    "label": "self"
                                                                }
                                                            ],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 8,
                                                            "end_token": 10,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 13,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 13,
                                                                    "end_token": 13,
                                                                    "children": [],
                                                                    "label": "user_credit"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "children": [],
                                                                    "label": "int"
                                                                }
                                                            ],
                                                            "label": "user_credit: int"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 18,
                                                            "end_token": 20,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 18,
                                                                    "end_token": 18,
                                                                    "children": [],
                                                                    "label": "block_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 20,
                                                                    "end_token": 20,
                                                                    "children": [],
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "block_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 23,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "children": [],
                                                                    "label": "input_data"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 25,
                                                                    "end_token": 25,
                                                                    "children": [],
                                                                    "label": "BlockInput"
                                                                }
                                                            ],
                                                            "label": "input_data: BlockInput"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 28,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 28,
                                                                    "end_token": 28,
                                                                    "children": [],
                                                                    "label": "data_size"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 30,
                                                                    "end_token": 30,
                                                                    "children": [],
                                                                    "label": "float"
                                                                }
                                                            ],
                                                            "label": "data_size: float"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 33,
                                                            "end_token": 35,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 33,
                                                                    "end_token": 33,
                                                                    "children": [],
                                                                    "label": "run_time"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 35,
                                                                    "end_token": 35,
                                                                    "children": [],
                                                                    "label": "float"
                                                                }
                                                            ],
                                                            "label": "run_time: float"
                                                        }
                                                    ],
                                                    "label": "(\n        self,\n        user_id: str,\n        user_credit: int,\n        block_id: str,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n    )"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 41,
                                                    "end_token": 41,
                                                    "children": [],
                                                    "label": "int"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 44,
                                                    "end_token": 46,
                                                    "children": [],
                                                    "label": "\"\"\"\n        Spend the credits for the user based on the block usage.\n\n        Args:\n            user_id (str): The user ID.\n            user_credit (int): The current credit for the user.\n            block_id (str): The block ID.\n            input_data (BlockInput): The input data for the block.\n            data_size (float): The size of the data being processed.\n            run_time (float): The time taken to run the block.\n\n        Returns:\n            int: amount of credit spent\n        \"\"\""
                                                },
                                                {
                                                    "type": "pass_statement",
                                                    "start_token": 48,
                                                    "end_token": 48,
                                                    "children": [],
                                                    "label": "pass"
                                                }
                                            ],
                                            "label": "async def spend_credits(\n        self,\n        user_id: str,\n        user_credit: int,\n        block_id: str,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n    ) -> int:\n        \"\"\"\n        Spend the credits for the user based on the block usage.\n\n        Args:\n            user_id (str): The user ID.\n            user_credit (int): The current credit for the user.\n            block_id (str): The block ID.\n            input_data (BlockInput): The input data for the block.\n            data_size (float): The size of the data being processed.\n            run_time (float): The time taken to run the block.\n\n        Returns:\n            int: amount of credit spent\n        \"\"\"\n        pass"
                                        }
                                    ],
                                    "label": "async def spend_credits(\n        self,\n        user_id: str,\n        user_credit: int,\n        block_id: str,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n    ) -> int:\n        \"\"\"\n        Spend the credits for the user based on the block usage.\n\n        Args:\n            user_id (str): The user ID.\n            user_credit (int): The current credit for the user.\n            block_id (str): The block ID.\n            input_data (BlockInput): The input data for the block.\n            data_size (float): The size of the data being processed.\n            run_time (float): The time taken to run the block.\n\n        Returns:\n            int: amount of credit spent\n        \"\"\"\n        pass\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "top_up_credits",
                            "start_line": 58,
                            "end_line": 66,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 21,
                                    "children": [
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 0,
                                            "end_token": 20,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 0,
                                                            "end_token": 0,
                                                            "label": "async"
                                                        }
                                                    ],
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "function_definition",
                                                    "start_token": 1,
                                                    "end_token": 20,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 2,
                                                            "end_token": 2,
                                                            "label": "top_up_credits"
                                                        },
                                                        {
                                                            "type": "parameters",
                                                            "start_token": 3,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "typed_parameter",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "typed_parameter",
                                                                    "start_token": 6,
                                                                    "end_token": 8,
                                                                    "label": "user_id: str"
                                                                },
                                                                {
                                                                    "type": "typed_parameter",
                                                                    "start_token": 10,
                                                                    "end_token": 12,
                                                                    "label": "amount: int"
                                                                }
                                                            ],
                                                            "label": "(self, user_id: str, amount: int)"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 15,
                                                            "end_token": 20,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 16,
                                                                    "end_token": 18,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_content",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "\"\n        Top up the credits for the user.\n\n        Args:\n            user_id (str): The user ID.\n            amount (int): The amount to top up.\n        \""
                                                                        }
                                                                    ],
                                                                    "label": "\"\"\"\n        Top up the credits for the user.\n\n        Args:\n            user_id (str): The user ID.\n            amount (int): The amount to top up.\n        \"\"\""
                                                                },
                                                                {
                                                                    "type": "pass_statement",
                                                                    "start_token": 20,
                                                                    "end_token": 20,
                                                                    "label": "pass"
                                                                }
                                                            ],
                                                            "label": "\n        \"\"\"\n        Top up the credits for the user.\n\n        Args:\n            user_id (str): The user ID.\n            amount (int): The amount to top up.\n        \"\"\"\n        pass"
                                                        }
                                                    ],
                                                    "label": "def top_up_credits(self, user_id: str, amount: int):\n        \"\"\"\n        Top up the credits for the user.\n\n        Args:\n            user_id (str): The user ID.\n            amount (int): The amount to top up.\n        \"\"\"\n        pass"
                                                }
                                            ],
                                            "label": "async def top_up_credits(self, user_id: str, amount: int):\n        \"\"\"\n        Top up the credits for the user.\n\n        Args:\n            user_id (str): The user ID.\n            amount (int): The amount to top up.\n        \"\"\"\n        pass"
                                        }
                                    ],
                                    "label": "async def top_up_credits(self, user_id: str, amount: int):\n        \"\"\"\n        Top up the credits for the user.\n\n        Args:\n            user_id (str): The user ID.\n            amount (int): The amount to top up.\n        \"\"\"\n        pass\n"
                                }
                            ]
                        }
                    ],
                    "label": "class UserCreditBase(ABC):\n\n    @abstractmethod\n\n    @abstractmethod\n\n    @abstractmethod\n"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "UserCredit",
            "start_line": 69,
            "end_line": 213,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 9,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 5,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "UserCredit"
                                },
                                {
                                    "type": "argument_list",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "label": "UserCreditBase"
                                        }
                                    ],
                                    "label": "(UserCreditBase)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 6,
                                    "end_token": 9,
                                    "children": [
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 8,
                                            "end_token": 9,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 8,
                                                    "end_token": 9,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 9,
                                                            "end_token": 9,
                                                            "label": "staticmethod"
                                                        }
                                                    ],
                                                    "label": "@staticmethod"
                                                }
                                            ],
                                            "label": "@staticmethod"
                                        }
                                    ],
                                    "label": "\n\n    @staticmethod"
                                }
                            ],
                            "label": "class UserCredit(UserCreditBase):"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_or_refill_credit",
                            "start_line": 70,
                            "end_line": 108,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 262,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 262,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 2,
                                                    "end_token": 2,
                                                    "children": [],
                                                    "label": "get_or_refill_credit"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 9,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 6,
                                                            "end_token": 8,
                                                            "children": [],
                                                            "label": "user_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str)"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 11,
                                                    "end_token": 12,
                                                    "children": [],
                                                    "label": "> int"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 14,
                                                    "end_token": 262,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 21,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "children": [],
                                                                    "label": "cur_time"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 17,
                                                                    "end_token": 21,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 17,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "children": [],
                                                                                    "label": "time_now"
                                                                                }
                                                                            ],
                                                                            "label": "self.time_now"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 20,
                                                                            "end_token": 21,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "self.time_now()"
                                                                }
                                                            ],
                                                            "label": "cur_time = self.time_now()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 23,
                                                            "end_token": 48,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "children": [],
                                                                    "label": "cur_month"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 25,
                                                                    "end_token": 48,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 25,
                                                                            "end_token": 27,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "children": [],
                                                                                    "label": "cur_time"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "children": [],
                                                                                    "label": "replace"
                                                                                }
                                                                            ],
                                                                            "label": "cur_time.replace"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 28,
                                                                            "end_token": 48,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 29,
                                                                                    "end_token": 31,
                                                                                    "children": [],
                                                                                    "label": "day=1"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 33,
                                                                                    "end_token": 35,
                                                                                    "children": [],
                                                                                    "label": "hour=0"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 37,
                                                                                    "end_token": 39,
                                                                                    "children": [],
                                                                                    "label": "minute=0"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 41,
                                                                                    "end_token": 43,
                                                                                    "children": [],
                                                                                    "label": "second=0"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 45,
                                                                                    "end_token": 47,
                                                                                    "children": [],
                                                                                    "label": "microsecond=0"
                                                                                }
                                                                            ],
                                                                            "label": "(day=1, hour=0, minute=0, second=0, microsecond=0)"
                                                                        }
                                                                    ],
                                                                    "label": "cur_time.replace(day=1, hour=0, minute=0, second=0, microsecond=0)"
                                                                }
                                                            ],
                                                            "label": "cur_month = cur_time.replace(day=1, hour=0, minute=0, second=0, microsecond=0)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 50,
                                                            "end_token": 92,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 50,
                                                                    "end_token": 50,
                                                                    "children": [],
                                                                    "label": "nxt_month"
                                                                },
                                                                {
                                                                    "type": "conditional_expression",
                                                                    "start_token": 52,
                                                                    "end_token": 91,
                                                                    "children": [
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 54,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 54,
                                                                                    "end_token": 65,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 54,
                                                                                            "end_token": 56,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 54,
                                                                                                    "end_token": 54,
                                                                                                    "children": [],
                                                                                                    "label": "cur_month"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 56,
                                                                                                    "end_token": 56,
                                                                                                    "children": [],
                                                                                                    "label": "replace"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cur_month.replace"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 57,
                                                                                            "end_token": 65,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 58,
                                                                                                    "end_token": 64,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "binary_operator",
                                                                                                            "start_token": 60,
                                                                                                            "end_token": 64,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 60,
                                                                                                                    "end_token": 62,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 60,
                                                                                                                            "end_token": 60,
                                                                                                                            "children": [],
                                                                                                                            "label": "cur_month"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 62,
                                                                                                                            "end_token": 62,
                                                                                                                            "children": [],
                                                                                                                            "label": "month"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "cur_month.month"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "integer",
                                                                                                                    "start_token": 64,
                                                                                                                    "end_token": 64,
                                                                                                                    "children": [],
                                                                                                                    "label": "1"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "cur_month.month + 1"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "month=cur_month.month + 1"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(month=cur_month.month + 1)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cur_month.replace(month=cur_month.month + 1)"
                                                                                }
                                                                            ],
                                                                            "label": "cur_month.replace(month=cur_month.month + 1)"
                                                                        },
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": 67,
                                                                            "end_token": 72,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 68,
                                                                                    "end_token": 70,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 68,
                                                                                            "end_token": 68,
                                                                                            "children": [],
                                                                                            "label": "cur_month"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 70,
                                                                                            "end_token": 70,
                                                                                            "children": [],
                                                                                            "label": "month"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cur_month.month"
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 72,
                                                                                    "end_token": 72,
                                                                                    "children": [],
                                                                                    "label": "12"
                                                                                }
                                                                            ],
                                                                            "label": "if cur_month.month < 12"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 74,
                                                                            "end_token": 90,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 75,
                                                                                    "end_token": 90,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 75,
                                                                                            "end_token": 77,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 75,
                                                                                                    "end_token": 75,
                                                                                                    "children": [],
                                                                                                    "label": "cur_month"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 77,
                                                                                                    "end_token": 77,
                                                                                                    "children": [],
                                                                                                    "label": "replace"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cur_month.replace"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 78,
                                                                                            "end_token": 90,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 79,
                                                                                                    "end_token": 85,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "binary_operator",
                                                                                                            "start_token": 81,
                                                                                                            "end_token": 85,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 81,
                                                                                                                    "end_token": 83,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 81,
                                                                                                                            "end_token": 81,
                                                                                                                            "children": [],
                                                                                                                            "label": "cur_month"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 83,
                                                                                                                            "end_token": 83,
                                                                                                                            "children": [],
                                                                                                                            "label": "year"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "cur_month.year"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "integer",
                                                                                                                    "start_token": 85,
                                                                                                                    "end_token": 85,
                                                                                                                    "children": [],
                                                                                                                    "label": "1"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "cur_month.year + 1"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "year=cur_month.year + 1"
                                                                                                },
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 87,
                                                                                                    "end_token": 89,
                                                                                                    "children": [],
                                                                                                    "label": "month=1"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(year=cur_month.year + 1, month=1)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cur_month.replace(year=cur_month.year + 1, month=1)"
                                                                                }
                                                                            ],
                                                                            "label": "else cur_month.replace(year=cur_month.year + 1, month=1)"
                                                                        }
                                                                    ],
                                                                    "label": "(\n            cur_month.replace(month=cur_month.month + 1)\n            if cur_month.month < 12\n            else cur_month.replace(year=cur_month.year + 1, month=1)\n"
                                                                }
                                                            ],
                                                            "label": "nxt_month = (\n            cur_month.replace(month=cur_month.month + 1)\n            if cur_month.month < 12\n            else cur_month.replace(year=cur_month.year + 1, month=1)\n        )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 95,
                                                            "end_token": 153,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 95,
                                                                    "end_token": 95,
                                                                    "children": [],
                                                                    "label": "user_credit"
                                                                },
                                                                {
                                                                    "type": "await",
                                                                    "start_token": 97,
                                                                    "end_token": 153,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 98,
                                                                            "end_token": 153,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 98,
                                                                                    "end_token": 104,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 98,
                                                                                            "end_token": 102,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 98,
                                                                                                    "end_token": 100,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 98,
                                                                                                            "end_token": 98,
                                                                                                            "children": [],
                                                                                                            "label": "CreditTransaction"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 100,
                                                                                                            "end_token": 100,
                                                                                                            "children": [],
                                                                                                            "label": "prisma"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "CreditTransaction.prisma"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 101,
                                                                                                    "end_token": 102,
                                                                                                    "children": [],
                                                                                                    "label": "()"
                                                                                                }
                                                                                            ],
                                                                                            "label": "CreditTransaction.prisma()"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 104,
                                                                                            "end_token": 104,
                                                                                            "children": [],
                                                                                            "label": "group_by"
                                                                                        }
                                                                                    ],
                                                                                    "label": "CreditTransaction.prisma().group_by"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 105,
                                                                                    "end_token": 153,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 107,
                                                                                            "end_token": 111,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "list",
                                                                                                    "start_token": 109,
                                                                                                    "end_token": 111,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 110,
                                                                                                            "end_token": 110,
                                                                                                            "children": [],
                                                                                                            "label": "\"userId\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "[\"userId\"]"
                                                                                                }
                                                                                            ],
                                                                                            "label": "by=[\"userId\"]"
                                                                                        },
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 113,
                                                                                            "end_token": 121,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary",
                                                                                                    "start_token": 116,
                                                                                                    "end_token": 121,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 117,
                                                                                                            "end_token": 119,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 117,
                                                                                                                    "end_token": 117,
                                                                                                                    "children": [],
                                                                                                                    "label": "\"amount\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "true",
                                                                                                                    "start_token": 119,
                                                                                                                    "end_token": 119,
                                                                                                                    "children": [],
                                                                                                                    "label": "True"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"amount\": True"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "{\"amount\": True},"
                                                                                                }
                                                                                            ],
                                                                                            "label": "\n            sum={\"amount\": True},"
                                                                                        },
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 123,
                                                                                            "end_token": 150,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary",
                                                                                                    "start_token": 125,
                                                                                                    "end_token": 150,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 127,
                                                                                                            "end_token": 129,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 127,
                                                                                                                    "end_token": 127,
                                                                                                                    "children": [],
                                                                                                                    "label": "\"userId\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 129,
                                                                                                                    "end_token": 129,
                                                                                                                    "children": [],
                                                                                                                    "label": "user_id"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"userId\": user_id"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 132,
                                                                                                            "end_token": 142,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 132,
                                                                                                                    "end_token": 132,
                                                                                                                    "children": [],
                                                                                                                    "label": "\"createdAt\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "dictionary",
                                                                                                                    "start_token": 134,
                                                                                                                    "end_token": 142,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "pair",
                                                                                                                            "start_token": 135,
                                                                                                                            "end_token": 137,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string",
                                                                                                                                    "start_token": 135,
                                                                                                                                    "end_token": 135,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "\"gte\""
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 137,
                                                                                                                                    "end_token": 137,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "cur_month"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "\"gte\": cur_month"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "pair",
                                                                                                                            "start_token": 139,
                                                                                                                            "end_token": 141,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string",
                                                                                                                                    "start_token": 139,
                                                                                                                                    "end_token": 139,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "\"lt\""
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 141,
                                                                                                                                    "end_token": 141,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "nxt_month"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "\"lt\": nxt_month"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "{\"gte\": cur_month, \"lt\": nxt_month}"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month}"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 145,
                                                                                                            "end_token": 147,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 145,
                                                                                                                    "end_token": 145,
                                                                                                                    "children": [],
                                                                                                                    "label": "\"isActive\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "true",
                                                                                                                    "start_token": 147,
                                                                                                                    "end_token": 147,
                                                                                                                    "children": [],
                                                                                                                    "label": "True"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"isActive\": True"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "{\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            }"
                                                                                                }
                                                                                            ],
                                                                                            "label": "where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            }"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n            by=[\"userId\"],\n            sum={\"amount\": True},\n            where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            },\n        )"
                                                                                }
                                                                            ],
                                                                            "label": "CreditTransaction.prisma().group_by(\n            by=[\"userId\"],\n            sum={\"amount\": True},\n            where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            },\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "await CreditTransaction.prisma().group_by(\n            by=[\"userId\"],\n            sum={\"amount\": True},\n            where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            },\n        )"
                                                                }
                                                            ],
                                                            "label": "user_credit = await CreditTransaction.prisma().group_by(\n            by=[\"userId\"],\n            sum={\"amount\": True},\n            where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            },\n        )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 156,
                                                            "end_token": 183,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 157,
                                                                    "end_token": 157,
                                                                    "children": [],
                                                                    "label": "user_credit"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 158,
                                                                    "end_token": 183,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 160,
                                                                            "end_token": 173,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 160,
                                                                                    "end_token": 160,
                                                                                    "children": [],
                                                                                    "label": "credit_sum"
                                                                                },
                                                                                {
                                                                                    "type": "binary_operator",
                                                                                    "start_token": 162,
                                                                                    "end_token": 171,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 162,
                                                                                            "end_token": 170,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "start_token": 162,
                                                                                                    "end_token": 165,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 162,
                                                                                                            "end_token": 162,
                                                                                                            "children": [],
                                                                                                            "label": "user_credit"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "integer",
                                                                                                            "start_token": 164,
                                                                                                            "end_token": 164,
                                                                                                            "children": [],
                                                                                                            "label": "0"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "user_credit[0]"
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 166,
                                                                                                    "end_token": 168,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 166,
                                                                                                            "end_token": 166,
                                                                                                            "children": [],
                                                                                                            "label": "."
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 168,
                                                                                                            "end_token": 168,
                                                                                                            "children": [],
                                                                                                            "label": "("
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": ".get("
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 169,
                                                                                                    "end_token": 170,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 169,
                                                                                                            "end_token": 169,
                                                                                                            "children": [],
                                                                                                            "label": "\"_sum\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"_sum\")"
                                                                                                }
                                                                                            ],
                                                                                            "label": "user_credit[0].get(\"_sum\")"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 171,
                                                                                            "end_token": 173,
                                                                                            "children": [],
                                                                                            "label": "or {}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_credit[0].get(\"_sum\") or"
                                                                                }
                                                                            ],
                                                                            "label": "credit_sum = user_credit[0].get(\"_sum\") or {}"
                                                                        },
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 175,
                                                                            "end_token": 183,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 176,
                                                                                    "end_token": 182,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 176,
                                                                                            "end_token": 178,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 176,
                                                                                                    "end_token": 176,
                                                                                                    "children": [],
                                                                                                    "label": "credit_sum"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 178,
                                                                                                    "end_token": 178,
                                                                                                    "children": [],
                                                                                                    "label": "get"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credit_sum.get"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 179,
                                                                                            "end_token": 182,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 180,
                                                                                                    "end_token": 180,
                                                                                                    "children": [],
                                                                                                    "label": "\"amount\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "integer",
                                                                                                    "start_token": 182,
                                                                                                    "end_token": 182,
                                                                                                    "children": [],
                                                                                                    "label": "0"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\"amount\", 0"
                                                                                        }
                                                                                    ],
                                                                                    "label": "credit_sum.get(\"amount\", 0"
                                                                                }
                                                                            ],
                                                                            "label": "return credit_sum.get(\"amount\", 0)"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            credit_sum = user_credit[0].get(\"_sum\") or {}\n            return credit_sum.get(\"amount\", 0)"
                                                                }
                                                            ],
                                                            "label": "if user_credit:\n            credit_sum = user_credit[0].get(\"_sum\") or {}\n            return credit_sum.get(\"amount\", 0)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 186,
                                                            "end_token": 189,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 186,
                                                                    "end_token": 186,
                                                                    "children": [],
                                                                    "label": "key"
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "start_token": 188,
                                                                    "end_token": 189,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_content",
                                                                            "start_token": 189,
                                                                            "end_token": 189,
                                                                            "children": [],
                                                                            "label": "\"MONTHLY-CREDIT-TOP-UP-{cur_month}\""
                                                                        }
                                                                    ],
                                                                    "label": "f\"MONTHLY-CREDIT-TOP-UP-{cur_month}\""
                                                                }
                                                            ],
                                                            "label": "key = f\"MONTHLY-CREDIT-TOP-UP-{cur_month}\""
                                                        },
                                                        {
                                                            "type": "try_statement",
                                                            "start_token": 192,
                                                            "end_token": 258,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 193,
                                                                    "end_token": 244,
                                                                    "children": [
                                                                        {
                                                                            "type": "await",
                                                                            "start_token": 195,
                                                                            "end_token": 244,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 196,
                                                                                    "end_token": 244,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 196,
                                                                                            "end_token": 202,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 196,
                                                                                                    "end_token": 200,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 196,
                                                                                                            "end_token": 198,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 196,
                                                                                                                    "end_token": 196,
                                                                                                                    "children": [],
                                                                                                                    "label": "CreditTransaction"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 198,
                                                                                                                    "end_token": 198,
                                                                                                                    "children": [],
                                                                                                                    "label": "prisma"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "CreditTransaction.prisma"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 199,
                                                                                                            "end_token": 200,
                                                                                                            "children": [],
                                                                                                            "label": "()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "CreditTransaction.prisma()"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 202,
                                                                                                    "end_token": 202,
                                                                                                    "children": [],
                                                                                                    "label": "create"
                                                                                                }
                                                                                            ],
                                                                                            "label": "CreditTransaction.prisma().create"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 203,
                                                                                            "end_token": 244,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "start_token": 205,
                                                                                                    "end_token": 242,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "dictionary",
                                                                                                            "start_token": 207,
                                                                                                            "end_token": 242,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "start_token": 209,
                                                                                                                    "end_token": 211,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "start_token": 209,
                                                                                                                            "end_token": 209,
                                                                                                                            "children": [],
                                                                                                                            "label": "\"amount\""
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 211,
                                                                                                                            "end_token": 213,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 211,
                                                                                                                                    "end_token": 211,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "self"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 213,
                                                                                                                                    "end_token": 213,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "num_user_credits_refill"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.num_user_credits_refill"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "\"amount\": self"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "start_token": 216,
                                                                                                                    "end_token": 218,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "start_token": 216,
                                                                                                                            "end_token": 216,
                                                                                                                            "children": [],
                                                                                                                            "label": "\"type\""
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 218,
                                                                                                                            "end_token": 220,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 218,
                                                                                                                                    "end_token": 218,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "CreditTransactionType"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 220,
                                                                                                                                    "end_token": 220,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "TOP_UP"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "CreditTransactionType.TOP_UP"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "\"type\": CreditTransactionType"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "start_token": 223,
                                                                                                                    "end_token": 225,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "start_token": 223,
                                                                                                                            "end_token": 223,
                                                                                                                            "children": [],
                                                                                                                            "label": "\"userId\""
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 225,
                                                                                                                            "end_token": 225,
                                                                                                                            "children": [],
                                                                                                                            "label": "user_id"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "\"userId\": user_id"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "start_token": 228,
                                                                                                                    "end_token": 230,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "start_token": 228,
                                                                                                                            "end_token": 228,
                                                                                                                            "children": [],
                                                                                                                            "label": "\"transactionKey\""
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 230,
                                                                                                                            "end_token": 230,
                                                                                                                            "children": [],
                                                                                                                            "label": "key"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "\"transactionKey\": key"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "start_token": 233,
                                                                                                                    "end_token": 239,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "start_token": 233,
                                                                                                                            "end_token": 233,
                                                                                                                            "children": [],
                                                                                                                            "label": "\"createdAt\""
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "start_token": 235,
                                                                                                                            "end_token": 239,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "start_token": 235,
                                                                                                                                    "end_token": 237,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "start_token": 235,
                                                                                                                                            "end_token": 235,
                                                                                                                                            "children": [],
                                                                                                                                            "label": "self"
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "start_token": 237,
                                                                                                                                            "end_token": 237,
                                                                                                                                            "children": [],
                                                                                                                                            "label": "time_now"
                                                                                                                                        }
                                                                                                                                    ],
                                                                                                                                    "label": "self.time_now"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "start_token": 238,
                                                                                                                                    "end_token": 239,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "()"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.time_now()"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "\"createdAt\": self.time_now()"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "{\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )"
                                                                                        }
                                                                                    ],
                                                                                    "label": "CreditTransaction.prisma().create(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "await CreditTransaction.prisma().create(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            await CreditTransaction.prisma().create(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )"
                                                                },
                                                                {
                                                                    "type": "except_clause",
                                                                    "start_token": 246,
                                                                    "end_token": 256,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 247,
                                                                            "end_token": 247,
                                                                            "children": [],
                                                                            "label": "UniqueViolationError"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 248,
                                                                            "end_token": 256,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pass_statement",
                                                                                    "start_token": 250,
                                                                                    "end_token": 250,
                                                                                    "children": [],
                                                                                    "label": "pass"
                                                                                },
                                                                                {
                                                                                    "type": "comment",
                                                                                    "start_token": 251,
                                                                                    "end_token": 255,
                                                                                    "children": [],
                                                                                    "label": "# Already refilled this month"
                                                                                }
                                                                            ],
                                                                            "label": ":\n            pass  # Already refilled this month\n"
                                                                        }
                                                                    ],
                                                                    "label": "except UniqueViolationError:\n            pass  # Already refilled this month\n"
                                                                }
                                                            ],
                                                            "label": "try:\n            await CreditTransaction.prisma().create(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )\n        except UniqueViolationError:\n            pass  # Already refilled this month\n\n        return"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 258,
                                                            "end_token": 262,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 259,
                                                                    "end_token": 261,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 259,
                                                                            "end_token": 259,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 261,
                                                                            "end_token": 261,
                                                                            "children": [],
                                                                            "label": "num_user_credits_refill"
                                                                        }
                                                                    ],
                                                                    "label": "self.num_user_credits_refill"
                                                                }
                                                            ],
                                                            "label": "return self.num_user_credits_refill\n"
                                                        }
                                                    ],
                                                    "label": "\n        cur_time = self.time_now()\n        cur_month = cur_time.replace(day=1, hour=0, minute=0, second=0, microsecond=0)\n        nxt_month = (\n            cur_month.replace(month=cur_month.month + 1)\n            if cur_month.month < 12\n            else cur_month.replace(year=cur_month.year + 1, month=1)\n        )\n\n        user_credit = await CreditTransaction.prisma().group_by(\n            by=[\"userId\"],\n            sum={\"amount\": True},\n            where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            },\n        )\n\n        if user_credit:\n            credit_sum = user_credit[0].get(\"_sum\") or {}\n            return credit_sum.get(\"amount\", 0)\n\n        key = f\"MONTHLY-CREDIT-TOP-UP-{cur_month}\"\n\n        try:\n            await CreditTransaction.prisma().create(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )\n        except UniqueViolationError:\n            pass  # Already refilled this month\n\n        return self.num_user_credits_refill\n"
                                                }
                                            ],
                                            "label": "async def get_or_refill_credit(self, user_id: str) -> int:\n        cur_time = self.time_now()\n        cur_month = cur_time.replace(day=1, hour=0, minute=0, second=0, microsecond=0)\n        nxt_month = (\n            cur_month.replace(month=cur_month.month + 1)\n            if cur_month.month < 12\n            else cur_month.replace(year=cur_month.year + 1, month=1)\n        )\n\n        user_credit = await CreditTransaction.prisma().group_by(\n            by=[\"userId\"],\n            sum={\"amount\": True},\n            where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            },\n        )\n\n        if user_credit:\n            credit_sum = user_credit[0].get(\"_sum\") or {}\n            return credit_sum.get(\"amount\", 0)\n\n        key = f\"MONTHLY-CREDIT-TOP-UP-{cur_month}\"\n\n        try:\n            await CreditTransaction.prisma().create(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )\n        except UniqueViolationError:\n            pass  # Already refilled this month\n\n        return self.num_user_credits_refill\n"
                                        }
                                    ],
                                    "label": "async def get_or_refill_credit(self, user_id: str) -> int:\n        cur_time = self.time_now()\n        cur_month = cur_time.replace(day=1, hour=0, minute=0, second=0, microsecond=0)\n        nxt_month = (\n            cur_month.replace(month=cur_month.month + 1)\n            if cur_month.month < 12\n            else cur_month.replace(year=cur_month.year + 1, month=1)\n        )\n\n        user_credit = await CreditTransaction.prisma().group_by(\n            by=[\"userId\"],\n            sum={\"amount\": True},\n            where={\n                \"userId\": user_id,\n                \"createdAt\": {\"gte\": cur_month, \"lt\": nxt_month},\n                \"isActive\": True,\n            },\n        )\n\n        if user_credit:\n            credit_sum = user_credit[0].get(\"_sum\") or {}\n            return credit_sum.get(\"amount\", 0)\n\n        key = f\"MONTHLY-CREDIT-TOP-UP-{cur_month}\"\n\n        try:\n            await CreditTransaction.prisma().create(\n                data={\n                    \"amount\": self.num_user_credits_refill,\n                    \"type\": CreditTransactionType.TOP_UP,\n                    \"userId\": user_id,\n                    \"transactionKey\": key,\n                    \"createdAt\": self.time_now(),\n                }\n            )\n        except UniqueViolationError:\n            pass  # Already refilled this month\n\n        return self.num_user_credits_refill\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "time_now",
                            "start_line": 111,
                            "end_line": 112,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 15,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "time_now"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 3,
                                                    "children": [],
                                                    "label": "()"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 4,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 6,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 7,
                                                                    "end_token": 14,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 7,
                                                                            "end_token": 9,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 7,
                                                                                    "end_token": 7,
                                                                                    "label": "datetime"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 9,
                                                                                    "end_token": 9,
                                                                                    "label": "now"
                                                                                }
                                                                            ],
                                                                            "label": "datetime.now"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 10,
                                                                            "end_token": 14,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 11,
                                                                                    "end_token": 13,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 11,
                                                                                            "end_token": 11,
                                                                                            "label": "timezone"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 13,
                                                                                            "end_token": 13,
                                                                                            "label": "utc"
                                                                                        }
                                                                                    ],
                                                                                    "label": "timezone.utc"
                                                                                }
                                                                            ],
                                                                            "label": "(timezone.utc)"
                                                                        }
                                                                    ],
                                                                    "label": "datetime.now(timezone.utc)"
                                                                }
                                                            ],
                                                            "label": "return datetime.now(timezone.utc)"
                                                        }
                                                    ],
                                                    "label": ":\n        return datetime.now(timezone.utc)"
                                                }
                                            ],
                                            "label": "def time_now():\n        return datetime.now(timezone.utc)"
                                        }
                                    ],
                                    "label": "def time_now():\n        return datetime.now(timezone.utc)\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_block_usage_cost",
                            "start_line": 114,
                            "end_line": 144,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 175,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 175,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_block_usage_cost"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 27,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "self"
                                                                }
                                                            ],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 7,
                                                            "end_token": 9,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "block"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 9,
                                                                    "end_token": 9,
                                                                    "children": [],
                                                                    "label": "Block"
                                                                }
                                                            ],
                                                            "label": "block: Block"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "input_data"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "children": [],
                                                                    "label": "BlockInput"
                                                                }
                                                            ],
                                                            "label": "input_data: BlockInput"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 17,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 17,
                                                                    "end_token": 17,
                                                                    "children": [],
                                                                    "label": "data_size"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 19,
                                                                    "end_token": 19,
                                                                    "children": [],
                                                                    "label": "float"
                                                                }
                                                            ],
                                                            "label": "data_size: float"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 22,
                                                            "end_token": 24,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 22,
                                                                    "end_token": 22,
                                                                    "children": [],
                                                                    "label": "run_time"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 24,
                                                                    "end_token": 24,
                                                                    "children": [],
                                                                    "label": "float"
                                                                }
                                                            ],
                                                            "label": "run_time: float"
                                                        }
                                                    ],
                                                    "label": "(\n        self,\n        block: Block,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n    )"
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 28,
                                                    "end_token": 35,
                                                    "children": [
                                                        {
                                                            "type": "tuple",
                                                            "start_token": 30,
                                                            "end_token": 35,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 32,
                                                                    "end_token": 32,
                                                                    "children": [],
                                                                    "label": "int"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 34,
                                                                    "end_token": 34,
                                                                    "children": [],
                                                                    "label": "BlockInput"
                                                                }
                                                            ],
                                                            "label": "tuple[int, BlockInput]"
                                                        }
                                                    ],
                                                    "label": "-> tuple[int, BlockInput]"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 36,
                                                    "end_token": 174,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 38,
                                                            "end_token": 48,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 38,
                                                                    "end_token": 38,
                                                                    "children": [],
                                                                    "label": "block_costs"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 40,
                                                                    "end_token": 48,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 40,
                                                                            "end_token": 42,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 40,
                                                                                    "end_token": 40,
                                                                                    "children": [],
                                                                                    "label": "BLOCK_COSTS"
                                                                                }
                                                                            ],
                                                                            "label": "BLOCK_COSTS.get"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 43,
                                                                            "end_token": 48,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 45,
                                                                                    "end_token": 47,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 45,
                                                                                            "end_token": 45,
                                                                                            "children": [],
                                                                                            "label": "("
                                                                                        }
                                                                                    ],
                                                                                    "label": "(block)"
                                                                                }
                                                                            ],
                                                                            "label": "(type(block))"
                                                                        }
                                                                    ],
                                                                    "label": "BLOCK_COSTS.get(type(block))"
                                                                }
                                                            ],
                                                            "label": "block_costs = BLOCK_COSTS.get(type(block))"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 50,
                                                            "end_token": 60,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 51,
                                                                    "end_token": 52,
                                                                    "children": [],
                                                                    "label": "not block_costs"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 53,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 55,
                                                                            "end_token": 59,
                                                                            "children": [
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 56,
                                                                                    "end_token": 56,
                                                                                    "children": [],
                                                                                    "label": "0"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 58,
                                                                                    "end_token": 59,
                                                                                    "children": [],
                                                                                    "label": "{}"
                                                                                }
                                                                            ],
                                                                            "label": "return 0, {}"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            return 0, {}\n"
                                                                }
                                                            ],
                                                            "label": "if not block_costs:\n            return 0, {}\n"
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 62,
                                                            "end_token": 167,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 63,
                                                                    "end_token": 63,
                                                                    "children": [],
                                                                    "label": "block_cost"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 65,
                                                                    "end_token": 65,
                                                                    "children": [],
                                                                    "label": "block_costs"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 66,
                                                                    "end_token": 167,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 68,
                                                                            "end_token": 82,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "start_token": 69,
                                                                                    "end_token": 71,
                                                                                    "children": [],
                                                                                    "label": "not self."
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 72,
                                                                                    "end_token": 79,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 73,
                                                                                            "end_token": 76,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 73,
                                                                                                    "end_token": 73,
                                                                                                    "children": [],
                                                                                                    "label": "("
                                                                                                }
                                                                                            ],
                                                                                            "label": "(block_cost.cost_filter"
                                                                                        }
                                                                                    ],
                                                                                    "label": "_is_cost_filter_match(block_cost.cost_filter, input_data)"
                                                                                }
                                                                            ],
                                                                            "label": "if not self._is_cost_filter_match(block_cost.cost_filter, input_data):\n                continue"
                                                                        },
                                                                        {
                                                                            "type": "continue_statement",
                                                                            "start_token": 82,
                                                                            "end_token": 82,
                                                                            "children": [],
                                                                            "label": "continue"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 85,
                                                                            "end_token": 104,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 87,
                                                                                    "end_token": 94,
                                                                                    "children": [],
                                                                                    "label": ".cost_type == BlockCostType.RUN:"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 95,
                                                                                    "end_token": 104,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "return_statement",
                                                                                            "start_token": 96,
                                                                                            "end_token": 103,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 97,
                                                                                                    "end_token": 99,
                                                                                                    "children": [],
                                                                                                    "label": "block_cost.cost_amount"
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 101,
                                                                                                    "end_token": 103,
                                                                                                    "children": [],
                                                                                                    "label": "block_cost.cost_filter"
                                                                                                }
                                                                                            ],
                                                                                            "label": "return block_cost.cost_amount, block_cost.cost_filter"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                return block_cost.cost_amount, block_cost.cost_filter\n"
                                                                                }
                                                                            ],
                                                                            "label": "if block_cost.cost_type == BlockCostType.RUN:\n                return block_cost.cost_amount, block_cost.cost_filter\n"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 106,
                                                                            "end_token": 135,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 108,
                                                                                    "end_token": 115,
                                                                                    "children": [],
                                                                                    "label": ".cost_type == BlockCostType.SECOND:"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 116,
                                                                                    "end_token": 135,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "return_statement",
                                                                                            "start_token": 117,
                                                                                            "end_token": 134,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "parenthesized_expression",
                                                                                                    "start_token": 118,
                                                                                                    "end_token": 135,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 120,
                                                                                                            "end_token": 127,
                                                                                                            "children": [],
                                                                                                            "label": "int(run_time * block_cost.cost_amount)"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                                                                }
                                                                                            ],
                                                                                            "label": "return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "if block_cost.cost_type == BlockCostType.SECOND:\n                return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 138,
                                                                            "end_token": 167,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 140,
                                                                                    "end_token": 147,
                                                                                    "children": [],
                                                                                    "label": ".cost_type == BlockCostType.BYTE:"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 148,
                                                                                    "end_token": 167,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "return_statement",
                                                                                            "start_token": 149,
                                                                                            "end_token": 166,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "parenthesized_expression",
                                                                                                    "start_token": 150,
                                                                                                    "end_token": 167,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 152,
                                                                                                            "end_token": 159,
                                                                                                            "children": [],
                                                                                                            "label": "int(data_size * block_cost.cost_amount)"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                                                                }
                                                                                            ],
                                                                                            "label": "return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "if block_cost.cost_type == BlockCostType.BYTE:\n                return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            if not self._is_cost_filter_match(block_cost.cost_filter, input_data):\n                continue\n\n            if block_cost.cost_type == BlockCostType.RUN:\n                return block_cost.cost_amount, block_cost.cost_filter\n\n            if block_cost.cost_type == BlockCostType.SECOND:\n                return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n            if block_cost.cost_type == BlockCostType.BYTE:\n                return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                                }
                                                            ],
                                                            "label": "for block_cost in block_costs:\n            if not self._is_cost_filter_match(block_cost.cost_filter, input_data):\n                continue\n\n            if block_cost.cost_type == BlockCostType.RUN:\n                return block_cost.cost_amount, block_cost.cost_filter\n\n            if block_cost.cost_type == BlockCostType.SECOND:\n                return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n            if block_cost.cost_type == BlockCostType.BYTE:\n                return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 170,
                                                            "end_token": 174,
                                                            "children": [
                                                                {
                                                                    "type": "integer",
                                                                    "start_token": 171,
                                                                    "end_token": 171,
                                                                    "children": [],
                                                                    "label": "0"
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "start_token": 173,
                                                                    "end_token": 174,
                                                                    "children": [],
                                                                    "label": "{}"
                                                                }
                                                            ],
                                                            "label": "return 0, {}"
                                                        }
                                                    ],
                                                    "label": ":\n        block_costs = BLOCK_COSTS.get(type(block))\n        if not block_costs:\n            return 0, {}\n\n        for block_cost in block_costs:\n            if not self._is_cost_filter_match(block_cost.cost_filter, input_data):\n                continue\n\n            if block_cost.cost_type == BlockCostType.RUN:\n                return block_cost.cost_amount, block_cost.cost_filter\n\n            if block_cost.cost_type == BlockCostType.SECOND:\n                return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n            if block_cost.cost_type == BlockCostType.BYTE:\n                return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n        return 0, {}"
                                                }
                                            ],
                                            "label": "def _block_usage_cost(\n        self,\n        block: Block,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n    ) -> tuple[int, BlockInput]:\n        block_costs = BLOCK_COSTS.get(type(block))\n        if not block_costs:\n            return 0, {}\n\n        for block_cost in block_costs:\n            if not self._is_cost_filter_match(block_cost.cost_filter, input_data):\n                continue\n\n            if block_cost.cost_type == BlockCostType.RUN:\n                return block_cost.cost_amount, block_cost.cost_filter\n\n            if block_cost.cost_type == BlockCostType.SECOND:\n                return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n            if block_cost.cost_type == BlockCostType.BYTE:\n                return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n        return 0, {}\n"
                                        }
                                    ],
                                    "label": "def _block_usage_cost(\n        self,\n        block: Block,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n    ) -> tuple[int, BlockInput]:\n        block_costs = BLOCK_COSTS.get(type(block))\n        if not block_costs:\n            return 0, {}\n\n        for block_cost in block_costs:\n            if not self._is_cost_filter_match(block_cost.cost_filter, input_data):\n                continue\n\n            if block_cost.cost_type == BlockCostType.RUN:\n                return block_cost.cost_amount, block_cost.cost_filter\n\n            if block_cost.cost_type == BlockCostType.SECOND:\n                return (\n                    int(run_time * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n            if block_cost.cost_type == BlockCostType.BYTE:\n                return (\n                    int(data_size * block_cost.cost_amount),\n                    block_cost.cost_filter,\n                )\n\n        return 0, {}\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_is_cost_filter_match",
                            "start_line": 146,
                            "end_line": 162,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 99,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 99,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_is_cost_filter_match"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 8,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "children": [],
                                                                    "label": "BlockInput"
                                                                }
                                                            ],
                                                            "label": "self, cost_filter: BlockInput"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 10,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": "input_data"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "BlockInput"
                                                                }
                                                            ],
                                                            "label": "input_data: BlockInput"
                                                        }
                                                    ],
                                                    "label": "(\n        self, cost_filter: BlockInput, input_data: BlockInput\n    )"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 16,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 17,
                                                            "end_token": 17,
                                                            "children": [],
                                                            "label": "bool"
                                                        }
                                                    ],
                                                    "label": "> bool"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 20,
                                                    "end_token": 22,
                                                    "children": [
                                                        {
                                                            "type": "string_content",
                                                            "start_token": 21,
                                                            "end_token": 21,
                                                            "children": [],
                                                            "label": "\"\n        Filter rules:\n          - If costFilter is an object, then check if costFilter is the subset of inputValues\n          - Otherwise, check if costFilter is equal to inputValues.\n          - Undefined, null, and empty string are considered as equal.\n        \""
                                                        }
                                                    ],
                                                    "label": "\"\"\"\n        Filter rules:\n          - If costFilter is an object, then check if costFilter is the subset of inputValues\n          - Otherwise, check if costFilter is equal to inputValues.\n          - Undefined, null, and empty string are considered as equal.\n        \"\"\""
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 23,
                                                    "end_token": 99,
                                                    "children": [
                                                        {
                                                            "type": "conditional_expression",
                                                            "start_token": 24,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": 25,
                                                                    "end_token": 39,
                                                                    "children": [
                                                                        {
                                                                            "type": "not_operator",
                                                                            "start_token": 25,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 26,
                                                                                    "end_token": 31,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "children": [],
                                                                                            "label": "isinstance"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 27,
                                                                                            "end_token": 31,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 28,
                                                                                                    "end_token": 28,
                                                                                                    "children": [],
                                                                                                    "label": "cost_filter"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 30,
                                                                                                    "end_token": 30,
                                                                                                    "children": [],
                                                                                                    "label": "dict"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(cost_filter, dict)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "isinstance(cost_filter, dict)"
                                                                                }
                                                                            ],
                                                                            "label": "not isinstance(cost_filter, dict)"
                                                                        },
                                                                        {
                                                                            "type": "not_operator",
                                                                            "start_token": 33,
                                                                            "end_token": 39,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 34,
                                                                                    "end_token": 39,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 34,
                                                                                            "end_token": 34,
                                                                                            "children": [],
                                                                                            "label": "isinstance"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 35,
                                                                                            "end_token": 39,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 36,
                                                                                                    "end_token": 36,
                                                                                                    "children": [],
                                                                                                    "label": "input_data"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 38,
                                                                                                    "end_token": 38,
                                                                                                    "children": [],
                                                                                                    "label": "dict"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(input_data, dict)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "isinstance(input_data, dict)"
                                                                                }
                                                                            ],
                                                                            "label": "not isinstance(input_data, dict)"
                                                                        }
                                                                    ],
                                                                    "label": "not isinstance(cost_filter, dict) or not isinstance(input_data, dict)"
                                                                },
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": 42,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": 43,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 43,
                                                                                    "children": [],
                                                                                    "label": "cost_filter"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 46,
                                                                                    "end_token": 46,
                                                                                    "children": [],
                                                                                    "label": "input_data"
                                                                                }
                                                                            ],
                                                                            "label": "cost_filter == input_data"
                                                                        }
                                                                    ],
                                                                    "label": "return cost_filter == input_data"
                                                                }
                                                            ],
                                                            "label": "if not isinstance(cost_filter, dict) or not isinstance(input_data, dict):\n            return cost_filter == input_data"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 49,
                                                            "end_token": 99,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 50,
                                                                    "end_token": 99,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 50,
                                                                            "end_token": 50,
                                                                            "children": [],
                                                                            "label": "all"
                                                                        },
                                                                        {
                                                                            "type": "generator_expression",
                                                                            "start_token": 51,
                                                                            "end_token": 99,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "start_token": 53,
                                                                                    "end_token": 86,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "start_token": 54,
                                                                                            "end_token": 64,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "not_operator",
                                                                                                    "start_token": 54,
                                                                                                    "end_token": 60,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 55,
                                                                                                            "end_token": 60,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 55,
                                                                                                                    "end_token": 57,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 55,
                                                                                                                            "end_token": 55,
                                                                                                                            "children": [],
                                                                                                                            "label": "input_data"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 56,
                                                                                                                            "end_token": 56,
                                                                                                                            "children": [],
                                                                                                                            "label": "."
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "input_data.get"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 58,
                                                                                                                    "end_token": 60,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 59,
                                                                                                                            "end_token": 59,
                                                                                                                            "children": [],
                                                                                                                            "label": "k"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "(k)"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "input_data.get(k)"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "not input_data.get(k)"
                                                                                                },
                                                                                                {
                                                                                                    "type": "not_operator",
                                                                                                    "start_token": 62,
                                                                                                    "end_token": 64,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 63,
                                                                                                            "end_token": 63,
                                                                                                            "children": [],
                                                                                                            "label": "v"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "not v)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "not input_data.get(k) and not v)"
                                                                                        },
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "start_token": 67,
                                                                                            "end_token": 86,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 68,
                                                                                                    "end_token": 73,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 68,
                                                                                                            "end_token": 70,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 68,
                                                                                                                    "end_token": 68,
                                                                                                                    "children": [],
                                                                                                                    "label": "input_data"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 69,
                                                                                                                    "end_token": 69,
                                                                                                                    "children": [],
                                                                                                                    "label": "."
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "input_data.get"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 71,
                                                                                                            "end_token": 73,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 72,
                                                                                                                    "end_token": 72,
                                                                                                                    "children": [],
                                                                                                                    "label": "k"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "(k)"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "input_data.get(k)"
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 75,
                                                                                                    "end_token": 85,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 75,
                                                                                                            "end_token": 77,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 75,
                                                                                                                    "end_token": 75,
                                                                                                                    "children": [],
                                                                                                                    "label": "self"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 76,
                                                                                                                    "end_token": 76,
                                                                                                                    "children": [],
                                                                                                                    "label": "."
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "self._is_cost_filter_match"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 78,
                                                                                                            "end_token": 85,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 79,
                                                                                                                    "end_token": 79,
                                                                                                                    "children": [],
                                                                                                                    "label": "v"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "subscript",
                                                                                                                    "start_token": 81,
                                                                                                                    "end_token": 83,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 81,
                                                                                                                            "end_token": 81,
                                                                                                                            "children": [],
                                                                                                                            "label": "input_data"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 83,
                                                                                                                            "end_token": 83,
                                                                                                                            "children": [],
                                                                                                                            "label": "k"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "input_data[k"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "(v, input_data[k])"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "self._is_cost_filter_match(v, input_data[k])"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(not input_data.get(k) and not v)\n            or (input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))"
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "start_token": 88,
                                                                                    "end_token": 97,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 89,
                                                                                            "end_token": 89,
                                                                                            "children": [],
                                                                                            "label": "k"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 91,
                                                                                            "end_token": 91,
                                                                                            "children": [],
                                                                                            "label": "v"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 93,
                                                                                            "end_token": 95,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 93,
                                                                                                    "end_token": 93,
                                                                                                    "children": [],
                                                                                                    "label": "cost_filter"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 94,
                                                                                                    "end_token": 94,
                                                                                                    "children": [],
                                                                                                    "label": "."
                                                                                                }
                                                                                            ],
                                                                                            "label": "cost_filter.items"
                                                                                        }
                                                                                    ],
                                                                                    "label": "for k, v in cost_filter.items()"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            (not input_data.get(k) and not v)\n            or (input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))\n            for k, v in cost_filter.items()\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "all(\n            (not input_data.get(k) and not v)\n            or (input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))\n            for k, v in cost_filter.items()\n        )"
                                                                }
                                                            ],
                                                            "label": "return all(\n            (not input_data.get(k) and not v)\n            or (input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))\n            for k, v in cost_filter.items()\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        if not isinstance(cost_filter, dict) or not isinstance(input_data, dict):\n            return cost_filter == input_data\n\n        return all(\n            (not input_data.get(k) and not v)\n            or (input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))\n            for k, v in cost_filter.items()\n        )"
                                                }
                                            ],
                                            "label": "def _is_cost_filter_match(\n        self, cost_filter: BlockInput, input_data: BlockInput\n    ) -> bool:\n        \"\"\"\n        Filter rules:\n          - If costFilter is an object, then check if costFilter is the subset of inputValues\n          - Otherwise, check if costFilter is equal to inputValues.\n          - Undefined, null, and empty string are considered as equal.\n        \"\"\"\n        if not isinstance(cost_filter, dict) or not isinstance(input_data, dict):\n            return cost_filter == input_data\n\n        return all(\n            (not input_data.get(k) and not v)\n            or (input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))\n            for k, v in cost_filter.items()\n        )"
                                        }
                                    ],
                                    "label": "def _is_cost_filter_match(\n        self, cost_filter: BlockInput, input_data: BlockInput\n    ) -> bool:\n        \"\"\"\n        Filter rules:\n          - If costFilter is an object, then check if costFilter is the subset of inputValues\n          - Otherwise, check if costFilter is equal to inputValues.\n          - Undefined, null, and empty string are considered as equal.\n        \"\"\"\n        if not isinstance(cost_filter, dict) or not isinstance(input_data, dict):\n            return cost_filter == input_data\n\n        return all(\n            (not input_data.get(k) and not v)\n            or (input_data.get(k) and self._is_cost_filter_match(v, input_data[k]))\n            for k, v in cost_filter.items()\n        )"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "spend_credits",
                            "start_line": 164,
                            "end_line": 202,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 203,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 203,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 45,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 10,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 9,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "self,\n        user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 8,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "children": [],
                                                                    "label": "user_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 14,
                                                                    "end_token": 15,
                                                                    "children": [],
                                                                    "label": ": int"
                                                                }
                                                            ],
                                                            "label": "user_id: str,\n        user_credit: int"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 18,
                                                            "end_token": 20,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 18,
                                                                    "end_token": 18,
                                                                    "children": [],
                                                                    "label": "block_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 19,
                                                                    "end_token": 20,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "block_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 23,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "children": [],
                                                                    "label": "input_data"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 24,
                                                                    "end_token": 25,
                                                                    "children": [],
                                                                    "label": ": BlockInput"
                                                                }
                                                            ],
                                                            "label": "input_data: BlockInput"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 28,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 28,
                                                                    "end_token": 28,
                                                                    "children": [],
                                                                    "label": "data_size"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 29,
                                                                    "end_token": 30,
                                                                    "children": [],
                                                                    "label": ": float"
                                                                }
                                                            ],
                                                            "label": "data_size: float"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 33,
                                                            "end_token": 35,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 33,
                                                                    "end_token": 33,
                                                                    "children": [],
                                                                    "label": "run_time"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 34,
                                                                    "end_token": 35,
                                                                    "children": [],
                                                                    "label": ": float"
                                                                }
                                                            ],
                                                            "label": "run_time: float"
                                                        },
                                                        {
                                                            "type": "typed_default_parameter",
                                                            "start_token": 38,
                                                            "end_token": 42,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 38,
                                                                    "end_token": 38,
                                                                    "children": [],
                                                                    "label": "validate_balance"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 39,
                                                                    "end_token": 40,
                                                                    "children": [],
                                                                    "label": ": bool"
                                                                },
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": 42,
                                                                    "end_token": 42,
                                                                    "children": [],
                                                                    "label": "True"
                                                                }
                                                            ],
                                                            "label": "validate_balance: bool = True"
                                                        }
                                                    ],
                                                    "label": "(\n        self,\n        user_id: str,\n        user_credit: int,\n        block_id: str,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n        validate_balance: bool = True,\n    )"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 50,
                                                    "end_token": 203,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 51,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 51,
                                                                    "end_token": 51,
                                                                    "children": [],
                                                                    "label": "block"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 53,
                                                                    "end_token": 56,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 53,
                                                                            "end_token": 53,
                                                                            "children": [],
                                                                            "label": "get_block"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 54,
                                                                            "end_token": 55,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 55,
                                                                                    "end_token": 55,
                                                                                    "children": [],
                                                                                    "label": "block_id"
                                                                                }
                                                                            ],
                                                                            "label": "(block_id"
                                                                        }
                                                                    ],
                                                                    "label": "get_block(block_id)"
                                                                }
                                                            ],
                                                            "label": "block = get_block(block_id)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 58,
                                                            "end_token": 68,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 59,
                                                                    "end_token": 60,
                                                                    "children": [],
                                                                    "label": "not block"
                                                                },
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 63,
                                                                    "end_token": 68,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 64,
                                                                            "end_token": 64,
                                                                            "children": [],
                                                                            "label": "ValueError"
                                                                        },
                                                                        {
                                                                            "type": "parenthesized_expression",
                                                                            "start_token": 65,
                                                                            "end_token": 68,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 66,
                                                                                    "end_token": 67,
                                                                                    "children": [],
                                                                                    "label": "f\"Block not found: {block_id}\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"Block not found: {block_id}\")"
                                                                        }
                                                                    ],
                                                                    "label": "raise ValueError(f\"Block not found: {block_id}\")"
                                                                }
                                                            ],
                                                            "label": "if not block:\n            raise ValueError(f\"Block not found: {block_id}\")"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 71,
                                                            "end_token": 96,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 71,
                                                                    "end_token": 71,
                                                                    "children": [],
                                                                    "label": "cost"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 73,
                                                                    "end_token": 73,
                                                                    "children": [],
                                                                    "label": "matching_filter"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 75,
                                                                    "end_token": 96,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 75,
                                                                            "end_token": 77,
                                                                            "children": [],
                                                                            "label": "self._block_usage_cost"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 78,
                                                                            "end_token": 95,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 80,
                                                                                    "end_token": 82,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 80,
                                                                                            "end_token": 80,
                                                                                            "children": [],
                                                                                            "label": "block"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 82,
                                                                                            "end_token": 82,
                                                                                            "children": [],
                                                                                            "label": "block"
                                                                                        }
                                                                                    ],
                                                                                    "label": "block=block"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 84,
                                                                                    "end_token": 86,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 84,
                                                                                            "end_token": 84,
                                                                                            "children": [],
                                                                                            "label": "input_data"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 86,
                                                                                            "end_token": 86,
                                                                                            "children": [],
                                                                                            "label": "input_data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "input_data=input_data"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 88,
                                                                                    "end_token": 90,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 88,
                                                                                            "end_token": 88,
                                                                                            "children": [],
                                                                                            "label": "data_size"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 90,
                                                                                            "end_token": 90,
                                                                                            "children": [],
                                                                                            "label": "data_size"
                                                                                        }
                                                                                    ],
                                                                                    "label": "data_size=data_size"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 92,
                                                                                    "end_token": 94,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 92,
                                                                                            "end_token": 92,
                                                                                            "children": [],
                                                                                            "label": "run_time"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 94,
                                                                                            "end_token": 94,
                                                                                            "children": [],
                                                                                            "label": "run_time"
                                                                                        }
                                                                                    ],
                                                                                    "label": "run_time=run_time"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            block=block, input_data=input_data, data_size=data_size, run_time=run_time\n"
                                                                        }
                                                                    ],
                                                                    "label": "self._block_usage_cost(\n            block=block, input_data=input_data, data_size=data_size, run_time=run_time\n        )"
                                                                }
                                                            ],
                                                            "label": "cost, matching_filter = self._block_usage_cost(\n            block=block, input_data=input_data, data_size=data_size, run_time=run_time\n        )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 98,
                                                            "end_token": 107,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": 99,
                                                                    "end_token": 102,
                                                                    "children": [],
                                                                    "label": "cost <= 0"
                                                                },
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": 105,
                                                                    "end_token": 107,
                                                                    "children": [
                                                                        {
                                                                            "type": "integer",
                                                                            "start_token": 106,
                                                                            "end_token": 106,
                                                                            "children": [],
                                                                            "label": "0"
                                                                        }
                                                                    ],
                                                                    "label": "return 0\n"
                                                                }
                                                            ],
                                                            "label": "if cost <= 0:\n            return 0\n"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 109,
                                                            "end_token": 122,
                                                            "children": [
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": 110,
                                                                    "end_token": 112,
                                                                    "children": [],
                                                                    "label": "validate_balance and user_credit"
                                                                },
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": 113,
                                                                    "end_token": 114,
                                                                    "children": [],
                                                                    "label": "< cost"
                                                                },
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 117,
                                                                    "end_token": 122,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 118,
                                                                            "end_token": 118,
                                                                            "children": [],
                                                                            "label": "ValueError"
                                                                        },
                                                                        {
                                                                            "type": "parenthesized_expression",
                                                                            "start_token": 119,
                                                                            "end_token": 122,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 120,
                                                                                    "end_token": 121,
                                                                                    "children": [],
                                                                                    "label": "f\"Insufficient credit: {user_credit} < {cost}\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"Insufficient credit: {user_credit} < {cost}\")"
                                                                        }
                                                                    ],
                                                                    "label": "raise ValueError(f\"Insufficient credit: {user_credit} < {cost}\")"
                                                                }
                                                            ],
                                                            "label": "if validate_balance and user_credit < cost:\n            raise ValueError(f\"Insufficient credit: {user_credit} < {cost}\")"
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 125,
                                                            "end_token": 199,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 125,
                                                                    "end_token": 199,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 126,
                                                                            "end_token": 128,
                                                                            "children": [],
                                                                            "label": "CreditTransaction.prisma"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 129,
                                                                            "end_token": 130,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 131,
                                                                            "end_token": 132,
                                                                            "children": [],
                                                                            "label": ".create"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 133,
                                                                            "end_token": 199,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 135,
                                                                                    "end_token": 197,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 137,
                                                                                            "end_token": 197,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 139,
                                                                                                    "end_token": 142,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 139,
                                                                                                            "end_token": 139,
                                                                                                            "children": [],
                                                                                                            "label": "\"userId\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 141,
                                                                                                            "end_token": 141,
                                                                                                            "children": [],
                                                                                                            "label": "user_id"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"userId\": user_id,"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 144,
                                                                                                    "end_token": 147,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 144,
                                                                                                            "end_token": 144,
                                                                                                            "children": [],
                                                                                                            "label": "\"amount\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "unary_operator",
                                                                                                            "start_token": 146,
                                                                                                            "end_token": 147,
                                                                                                            "children": [],
                                                                                                            "label": "-cost"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"amount\": -cost"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 150,
                                                                                                    "end_token": 155,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 150,
                                                                                                            "end_token": 150,
                                                                                                            "children": [],
                                                                                                            "label": "\"type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 152,
                                                                                                            "end_token": 154,
                                                                                                            "children": [],
                                                                                                            "label": "CreditTransactionType.USAGE"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"type\": CreditTransactionType.USAGE,"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 157,
                                                                                                    "end_token": 162,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 157,
                                                                                                            "end_token": 157,
                                                                                                            "children": [],
                                                                                                            "label": "\"blockId\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 159,
                                                                                                            "end_token": 161,
                                                                                                            "children": [],
                                                                                                            "label": "block.id"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"blockId\": block.id,"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 164,
                                                                                                    "end_token": 185,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 164,
                                                                                                            "end_token": 164,
                                                                                                            "children": [],
                                                                                                            "label": "\"metadata\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 166,
                                                                                                            "end_token": 185,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "dictionary",
                                                                                                                    "start_token": 169,
                                                                                                                    "end_token": 183,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "pair",
                                                                                                                            "start_token": 171,
                                                                                                                            "end_token": 176,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string",
                                                                                                                                    "start_token": 171,
                                                                                                                                    "end_token": 171,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "\"block\""
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "start_token": 173,
                                                                                                                                    "end_token": 175,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "block.name"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "\"block\": block.name,"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "pair",
                                                                                                                            "start_token": 178,
                                                                                                                            "end_token": 181,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string",
                                                                                                                                    "start_token": 178,
                                                                                                                                    "end_token": 178,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "\"input\""
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 180,
                                                                                                                                    "end_token": 180,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "matching_filter"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "\"input\": matching_filter,"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "{\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                )"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                )"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 188,
                                                                                                    "end_token": 194,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 188,
                                                                                                            "end_token": 188,
                                                                                                            "children": [],
                                                                                                            "label": "\"createdAt\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 190,
                                                                                                            "end_token": 194,
                                                                                                            "children": [],
                                                                                                            "label": "self.time_now()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"createdAt\": self.time_now()"
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }"
                                                                                        }
                                                                                    ],
                                                                                    "label": "data={\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            data={\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }\n        )"
                                                                }
                                                            ],
                                                            "label": "await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }\n        )"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 201,
                                                            "end_token": 202,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 202,
                                                                    "end_token": 202,
                                                                    "children": [],
                                                                    "label": "cost"
                                                                }
                                                            ],
                                                            "label": "return cost"
                                                        }
                                                    ],
                                                    "label": "\n        block = get_block(block_id)\n        if not block:\n            raise ValueError(f\"Block not found: {block_id}\")\n\n        cost, matching_filter = self._block_usage_cost(\n            block=block, input_data=input_data, data_size=data_size, run_time=run_time\n        )\n        if cost <= 0:\n            return 0\n\n        if validate_balance and user_credit < cost:\n            raise ValueError(f\"Insufficient credit: {user_credit} < {cost}\")\n\n        await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }\n        )\n        return cost\n"
                                                }
                                            ],
                                            "label": "async def spend_credits(\n        self,\n        user_id: str,\n        user_credit: int,\n        block_id: str,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n        validate_balance: bool = True,\n    ) -> int:\n        block = get_block(block_id)\n        if not block:\n            raise ValueError(f\"Block not found: {block_id}\")\n\n        cost, matching_filter = self._block_usage_cost(\n            block=block, input_data=input_data, data_size=data_size, run_time=run_time\n        )\n        if cost <= 0:\n            return 0\n\n        if validate_balance and user_credit < cost:\n            raise ValueError(f\"Insufficient credit: {user_credit} < {cost}\")\n\n        await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }\n        )\n        return cost\n"
                                        }
                                    ],
                                    "label": "async def spend_credits(\n        self,\n        user_id: str,\n        user_credit: int,\n        block_id: str,\n        input_data: BlockInput,\n        data_size: float,\n        run_time: float,\n        validate_balance: bool = True,\n    ) -> int:\n        block = get_block(block_id)\n        if not block:\n            raise ValueError(f\"Block not found: {block_id}\")\n\n        cost, matching_filter = self._block_usage_cost(\n            block=block, input_data=input_data, data_size=data_size, run_time=run_time\n        )\n        if cost <= 0:\n            return 0\n\n        if validate_balance and user_credit < cost:\n            raise ValueError(f\"Insufficient credit: {user_credit} < {cost}\")\n\n        await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": -cost,\n                \"type\": CreditTransactionType.USAGE,\n                \"blockId\": block.id,\n                \"metadata\": Json(\n                    {\n                        \"block\": block.name,\n                        \"input\": matching_filter,\n                    }\n                ),\n                \"createdAt\": self.time_now(),\n            }\n        )\n        return cost\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "top_up_credits",
                            "start_line": 204,
                            "end_line": 212,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 59,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 59,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 2,
                                                    "end_token": 2,
                                                    "label": "top_up_credits"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 13,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 6,
                                                            "end_token": 8,
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 10,
                                                            "end_token": 12,
                                                            "label": "amount: int"
                                                        }
                                                    ],
                                                    "label": "(self, user_id: str, amount: int)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 15,
                                                    "end_token": 59,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 16,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 17,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 17,
                                                                            "end_token": 22,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "label": "CreditTransaction"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "label": "prisma"
                                                                                }
                                                                            ],
                                                                            "label": "CreditTransaction.prisma()."
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 22,
                                                                            "end_token": 23,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 22,
                                                                                    "end_token": 22,
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "create"
                                                                                }
                                                                            ],
                                                                            "label": ".create"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 24,
                                                                            "end_token": 58,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 26,
                                                                                    "end_token": 56,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "label": "data"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 28,
                                                                                            "end_token": 56,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 30,
                                                                                                    "end_token": 32,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 30,
                                                                                                            "end_token": 30,
                                                                                                            "label": "\"userId\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 32,
                                                                                                            "end_token": 32,
                                                                                                            "label": "user_id"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"userId\": user_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 35,
                                                                                                    "end_token": 37,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 35,
                                                                                                            "end_token": 35,
                                                                                                            "label": "\"amount\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 37,
                                                                                                            "end_token": 37,
                                                                                                            "label": "amount"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"amount\": amount"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 40,
                                                                                                    "end_token": 44,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 40,
                                                                                                            "end_token": 40,
                                                                                                            "label": "\"type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 42,
                                                                                                            "end_token": 44,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 42,
                                                                                                                    "end_token": 42,
                                                                                                                    "label": "CreditTransactionType"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 44,
                                                                                                                    "end_token": 44,
                                                                                                                    "label": "TOP_UP"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "CreditTransactionType.TOP_UP"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"type\": CreditTransactionType.TOP_UP"
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 47,
                                                                                                    "end_token": 53,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 47,
                                                                                                            "end_token": 47,
                                                                                                            "label": "\"createdAt\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 49,
                                                                                                            "end_token": 53,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 49,
                                                                                                                    "end_token": 51,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 49,
                                                                                                                            "end_token": 49,
                                                                                                                            "label": "self"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 51,
                                                                                                                            "end_token": 51,
                                                                                                                            "label": "time_now"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "self.time_now"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "self.time_now()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"createdAt\": self.time_now()"
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }"
                                                                                        }
                                                                                    ],
                                                                                    "label": "data={\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            data={\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }\n        )"
                                                                }
                                                            ],
                                                            "label": "await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }\n        )\n"
                                                }
                                            ],
                                            "label": "async def top_up_credits(self, user_id: str, amount: int):\n        await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }\n        )\n"
                                        }
                                    ],
                                    "label": "async def top_up_credits(self, user_id: str, amount: int):\n        await CreditTransaction.prisma().create(\n            data={\n                \"userId\": user_id,\n                \"amount\": amount,\n                \"type\": CreditTransactionType.TOP_UP,\n                \"createdAt\": self.time_now(),\n            }\n        )\n"
                                }
                            ]
                        }
                    ],
                    "label": "class UserCredit(UserCreditBase):\n\n    @staticmethod"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "DisabledUserCredit",
            "start_line": 215,
            "end_line": 223,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 5,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 5,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "class"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "DisabledUserCredit"
                                },
                                {
                                    "type": "argument_list",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "label": "UserCreditBase"
                                        }
                                    ],
                                    "label": "(UserCreditBase)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 5,
                                    "end_token": 5,
                                    "children": [],
                                    "label": ":"
                                }
                            ],
                            "label": "class DisabledUserCredit(UserCreditBase):"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_or_refill_credit",
                            "start_line": 216,
                            "end_line": 217,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 20,
                                    "children": [
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 0,
                                            "end_token": 20,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 0,
                                                            "end_token": 0,
                                                            "label": "async"
                                                        }
                                                    ],
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "function_definition",
                                                    "start_token": 1,
                                                    "end_token": 20,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1,
                                                            "end_token": 1,
                                                            "label": "def"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 2,
                                                            "end_token": 2,
                                                            "label": "get_or_refill_credit"
                                                        },
                                                        {
                                                            "type": "parameters",
                                                            "start_token": 3,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "list_splat_pattern",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "label": "args"
                                                                        }
                                                                    ],
                                                                    "label": "*args"
                                                                },
                                                                {
                                                                    "type": "dictionary_splat_pattern",
                                                                    "start_token": 9,
                                                                    "end_token": 11,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "label": "kwargs"
                                                                        }
                                                                    ],
                                                                    "label": "**kwargs"
                                                                }
                                                            ],
                                                            "label": "(self, *args, **kwargs)"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 14,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "label": "int"
                                                                }
                                                            ],
                                                            "label": "> int"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 16,
                                                            "end_token": 20,
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": 18,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "integer",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "0"
                                                                        }
                                                                    ],
                                                                    "label": "return 0"
                                                                }
                                                            ],
                                                            "label": ":\n        return 0\n"
                                                        }
                                                    ],
                                                    "label": "def get_or_refill_credit(self, *args, **kwargs) -> int:\n        return 0\n"
                                                }
                                            ],
                                            "label": "async def get_or_refill_credit(self, *args, **kwargs) -> int:\n        return 0\n"
                                        }
                                    ],
                                    "label": "async def get_or_refill_credit(self, *args, **kwargs) -> int:\n        return 0\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "spend_credits",
                            "start_line": 219,
                            "end_line": 220,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 20,
                                    "children": [
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 0,
                                            "end_token": 19,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 0,
                                                            "end_token": 0,
                                                            "label": "async"
                                                        }
                                                    ],
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "function_definition",
                                                    "start_token": 1,
                                                    "end_token": 19,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1,
                                                            "end_token": 1,
                                                            "label": "def"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 2,
                                                            "end_token": 2,
                                                            "label": "spend_credits"
                                                        },
                                                        {
                                                            "type": "parameters",
                                                            "start_token": 3,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "list_splat_pattern",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "label": "args"
                                                                        }
                                                                    ],
                                                                    "label": "*args"
                                                                },
                                                                {
                                                                    "type": "dictionary_splat_pattern",
                                                                    "start_token": 9,
                                                                    "end_token": 11,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "label": "kwargs"
                                                                        }
                                                                    ],
                                                                    "label": "**kwargs"
                                                                }
                                                            ],
                                                            "label": "(self, *args, **kwargs)"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 14,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "label": "int"
                                                                }
                                                            ],
                                                            "label": "> int"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 16,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": 18,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "integer",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "0"
                                                                        }
                                                                    ],
                                                                    "label": "return 0"
                                                                }
                                                            ],
                                                            "label": ":\n        return 0"
                                                        }
                                                    ],
                                                    "label": "def spend_credits(self, *args, **kwargs) -> int:\n        return 0"
                                                }
                                            ],
                                            "label": "async def spend_credits(self, *args, **kwargs) -> int:\n        return 0"
                                        }
                                    ],
                                    "label": "async def spend_credits(self, *args, **kwargs) -> int:\n        return 0\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "top_up_credits",
                            "start_line": 222,
                            "end_line": 223,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 16,
                                    "children": [
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 0,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "decorator",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 0,
                                                            "end_token": 0,
                                                            "label": "async"
                                                        }
                                                    ],
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "function_definition",
                                                    "start_token": 1,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1,
                                                            "end_token": 1,
                                                            "label": "def"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 2,
                                                            "end_token": 2,
                                                            "label": "top_up_credits"
                                                        },
                                                        {
                                                            "type": "parameters",
                                                            "start_token": 3,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "label": "args"
                                                                        }
                                                                    ],
                                                                    "label": "*args"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 11,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "label": "kwargs"
                                                                        }
                                                                    ],
                                                                    "label": "*kwargs"
                                                                }
                                                            ],
                                                            "label": "(self, *args, **kwargs)"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 14,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "pass_statement",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "label": "pass"
                                                                }
                                                            ],
                                                            "label": "\n"
                                                        }
                                                    ],
                                                    "label": "def top_up_credits(self, *args, **kwargs):\n"
                                                }
                                            ],
                                            "label": "async def top_up_credits(self, *args, **kwargs):\n"
                                        }
                                    ],
                                    "label": "async def top_up_credits(self, *args, **kwargs):\n        pass\n"
                                }
                            ]
                        }
                    ],
                    "label": "class DisabledUserCredit(UserCreditBase):"
                }
            ]
        }
    ],
    "label": "from abc import ABC, abstractmethod\nfrom datetime import datetime, timezone\n\nfrom prisma import Json\nfrom prisma.enums import CreditTransactionType\nfrom prisma.errors import UniqueViolationError\nfrom prisma.models import CreditTransaction\n\nfrom backend.data.block import Block, BlockInput, get_block\nfrom backend.data.block_cost_config import BLOCK_COSTS\nfrom backend.data.cost import BlockCost, BlockCostType\nfrom backend.util.settings import Config\n\nconfig = Config()"
}
{
    "type": "module",
    "start_token": 0,
    "end_token": 65,
    "children": [
        {
            "type": "aliased_import",
            "start_token": 0,
            "end_token": 1,
            "children": [],
            "label": "import io"
        },
        {
            "type": "aliased_import",
            "start_token": 3,
            "end_token": 6,
            "children": [],
            "label": "import unittest.mock"
        },
        {
            "type": "aliased_import",
            "start_token": 9,
            "end_token": 10,
            "children": [],
            "label": "import fastapi"
        },
        {
            "type": "aliased_import",
            "start_token": 12,
            "end_token": 13,
            "children": [],
            "label": "import pytest"
        },
        {
            "type": "aliased_import",
            "start_token": 15,
            "end_token": 18,
            "children": [],
            "label": "import starlette.datastructures"
        },
        {
            "type": "aliased_import",
            "start_token": 21,
            "end_token": 30,
            "children": [],
            "label": "import backend.server.v2.store.exceptions"
        },
        {
            "type": "aliased_import",
            "start_token": 32,
            "end_token": 41,
            "children": [],
            "label": "import backend.server.v2.store.media"
        },
        {
            "type": "import_from_statement",
            "start_token": 43,
            "end_token": 50,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 44,
                    "end_token": 48,
                    "children": [],
                    "label": "backend.util.settings"
                },
                {
                    "type": "identifier",
                    "start_token": 50,
                    "end_token": 50,
                    "children": [],
                    "label": "Settings"
                }
            ],
            "label": "from backend.util.settings import Settings"
        },
        {
            "type": "decorator",
            "start_token": 54,
            "end_token": 57,
            "children": [],
            "label": "@pytest.fixture"
        },
        {
            "type": "decorator",
            "start_token": 61,
            "end_token": 64,
            "children": [],
            "label": "@pytest.fixture"
        },
        {
            "type": "function_placeholder",
            "name": "mock_settings",
            "start_line": 14,
            "end_line": 19,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 42,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 41,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "mock_settings"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "label": "monkeypatch"
                                        }
                                    ],
                                    "label": "(monkeypatch)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 6,
                                    "end_token": 41,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 7,
                                            "end_token": 11,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "label": "settings"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 9,
                                                    "end_token": 11,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 9,
                                                            "end_token": 9,
                                                            "label": "Settings"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 10,
                                                            "end_token": 11,
                                                            "label": "()"
                                                        }
                                                    ],
                                                    "label": "Settings()"
                                                }
                                            ],
                                            "label": "settings = Settings()"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 13,
                                            "end_token": 19,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 13,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 13,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 13,
                                                                    "end_token": 13,
                                                                    "label": "settings"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "label": "config"
                                                                }
                                                            ],
                                                            "label": "settings.config"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 17,
                                                            "end_token": 17,
                                                            "label": "media_gcs_bucket_name"
                                                        }
                                                    ],
                                                    "label": "settings.config.media_gcs_bucket_name"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 19,
                                                    "end_token": 19,
                                                    "label": "\"test-bucket\""
                                                }
                                            ],
                                            "label": "settings.config.media_gcs_bucket_name = \"test-bucket\""
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 21,
                                            "end_token": 27,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 21,
                                                    "end_token": 25,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 21,
                                                            "end_token": 23,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 21,
                                                                    "end_token": 21,
                                                                    "label": "settings"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "label": "config"
                                                                }
                                                            ],
                                                            "label": "settings.config"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 25,
                                                            "end_token": 25,
                                                            "label": "google_application_credentials"
                                                        }
                                                    ],
                                                    "label": "settings.config.google_application_credentials"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 27,
                                                    "end_token": 27,
                                                    "label": "\"test-credentials\""
                                                }
                                            ],
                                            "label": "settings.config.google_application_credentials = \"test-credentials\""
                                        },
                                        {
                                            "type": "call",
                                            "start_token": 29,
                                            "end_token": 38,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 29,
                                                    "end_token": 31,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 29,
                                                            "end_token": 29,
                                                            "label": "monkeypatch"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 31,
                                                            "end_token": 31,
                                                            "label": "setattr"
                                                        }
                                                    ],
                                                    "label": "monkeypatch.setattr"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "start_token": 32,
                                                    "end_token": 38,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 33,
                                                            "end_token": 33,
                                                            "label": "\"backend.server.v2.store.media.Settings\""
                                                        },
                                                        {
                                                            "type": "lambda",
                                                            "start_token": 35,
                                                            "end_token": 37,
                                                            "children": [
                                                                {
                                                                    "type": "lambda_parameters",
                                                                    "start_token": 35,
                                                                    "end_token": 36,
                                                                    "label": "lambda:"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 37,
                                                                    "end_token": 37,
                                                                    "label": "settings"
                                                                }
                                                            ],
                                                            "label": "lambda: settings"
                                                        }
                                                    ],
                                                    "label": "(\"backend.server.v2.store.media.Settings\", lambda: settings)"
                                                }
                                            ],
                                            "label": "monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 40,
                                            "end_token": 41,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 41,
                                                    "end_token": 41,
                                                    "label": "settings"
                                                }
                                            ],
                                            "label": "return settings"
                                        }
                                    ],
                                    "label": "\n    settings = Settings()\n    settings.config.media_gcs_bucket_name = \"test-bucket\"\n    settings.config.google_application_credentials = \"test-credentials\"\n    monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)\n    return settings"
                                }
                            ],
                            "label": "def mock_settings(monkeypatch):\n    settings = Settings()\n    settings.config.media_gcs_bucket_name = \"test-bucket\"\n    settings.config.google_application_credentials = \"test-credentials\"\n    monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)\n    return settings"
                        }
                    ],
                    "label": "def mock_settings(monkeypatch):\n    settings = Settings()\n    settings.config.media_gcs_bucket_name = \"test-bucket\"\n    settings.config.google_application_credentials = \"test-credentials\"\n    monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)\n    return settings\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "mock_storage_client",
            "start_line": 23,
            "end_line": 34,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 74,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 74,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "mock_storage_client"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "children": [],
                                            "label": "mocker"
                                        }
                                    ],
                                    "label": "(mocker)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 6,
                                    "end_token": 74,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 7,
                                            "end_token": 15,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "children": [],
                                                    "label": "mock_client"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 9,
                                                    "end_token": 15,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 9,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 9,
                                                                    "end_token": 9,
                                                                    "children": [],
                                                                    "label": "unittest"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "children": [],
                                                                    "label": "mock"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 13,
                                                                    "end_token": 13,
                                                                    "children": [],
                                                                    "label": "MagicMock"
                                                                }
                                                            ],
                                                            "label": "unittest.mock.MagicMock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 14,
                                                            "end_token": 15,
                                                            "children": [],
                                                            "label": "()"
                                                        }
                                                    ],
                                                    "label": "unittest.mock.MagicMock()"
                                                }
                                            ],
                                            "label": "mock_client = unittest.mock.MagicMock()"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 17,
                                            "end_token": 25,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 17,
                                                    "end_token": 17,
                                                    "children": [],
                                                    "label": "mock_bucket"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 19,
                                                    "end_token": 25,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 19,
                                                            "end_token": 23,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 19,
                                                                    "end_token": 19,
                                                                    "children": [],
                                                                    "label": "unittest"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 21,
                                                                    "end_token": 21,
                                                                    "children": [],
                                                                    "label": "mock"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "children": [],
                                                                    "label": "MagicMock"
                                                                }
                                                            ],
                                                            "label": "unittest.mock.MagicMock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 24,
                                                            "end_token": 25,
                                                            "children": [],
                                                            "label": "()"
                                                        }
                                                    ],
                                                    "label": "unittest.mock.MagicMock()"
                                                }
                                            ],
                                            "label": "mock_bucket = unittest.mock.MagicMock()"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 27,
                                            "end_token": 35,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 27,
                                                    "end_token": 27,
                                                    "children": [],
                                                    "label": "mock_blob"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 29,
                                                    "end_token": 35,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 29,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 29,
                                                                    "end_token": 29,
                                                                    "children": [],
                                                                    "label": "unittest"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 31,
                                                                    "end_token": 31,
                                                                    "children": [],
                                                                    "label": "mock"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 33,
                                                                    "end_token": 33,
                                                                    "children": [],
                                                                    "label": "MagicMock"
                                                                }
                                                            ],
                                                            "label": "unittest.mock.MagicMock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 34,
                                                            "end_token": 35,
                                                            "children": [],
                                                            "label": "()"
                                                        }
                                                    ],
                                                    "label": "unittest.mock.MagicMock()"
                                                }
                                            ],
                                            "label": "mock_blob = unittest.mock.MagicMock()"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 38,
                                            "end_token": 44,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 38,
                                                    "end_token": 42,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 38,
                                                            "end_token": 38,
                                                            "children": [],
                                                            "label": "mock_client"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 40,
                                                            "end_token": 40,
                                                            "children": [],
                                                            "label": "bucket"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 42,
                                                            "end_token": 42,
                                                            "children": [],
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_client.bucket.return_value"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 44,
                                                    "end_token": 44,
                                                    "children": [],
                                                    "label": "mock_bucket"
                                                }
                                            ],
                                            "label": "mock_client.bucket.return_value = mock_bucket"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 46,
                                            "end_token": 52,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 46,
                                                    "end_token": 50,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 46,
                                                            "end_token": 46,
                                                            "children": [],
                                                            "label": "mock_bucket"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 48,
                                                            "end_token": 48,
                                                            "children": [],
                                                            "label": "blob"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 50,
                                                            "end_token": 50,
                                                            "children": [],
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_bucket.blob.return_value"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 52,
                                                    "end_token": 52,
                                                    "children": [],
                                                    "label": "mock_blob"
                                                }
                                            ],
                                            "label": "mock_bucket.blob.return_value = mock_blob"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 54,
                                            "end_token": 58,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 54,
                                                    "end_token": 56,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 54,
                                                            "end_token": 54,
                                                            "children": [],
                                                            "label": "mock_blob"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 56,
                                                            "end_token": 56,
                                                            "children": [],
                                                            "label": "public_url"
                                                        }
                                                    ],
                                                    "label": "mock_blob.public_url"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 58,
                                                    "end_token": 58,
                                                    "children": [],
                                                    "label": "\"http://test-url/media/laptop.jpeg\""
                                                }
                                            ],
                                            "label": "mock_blob.public_url = \"http://test-url/media/laptop.jpeg\""
                                        },
                                        {
                                            "type": "expression_statement",
                                            "start_token": 61,
                                            "end_token": 70,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 61,
                                                    "end_token": 70,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 61,
                                                            "end_token": 63,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 61,
                                                                    "end_token": 61,
                                                                    "children": [],
                                                                    "label": "mocker"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 63,
                                                                    "end_token": 63,
                                                                    "children": [],
                                                                    "label": "patch"
                                                                }
                                                            ],
                                                            "label": "mocker.patch"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 64,
                                                            "end_token": 70,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 65,
                                                                    "end_token": 65,
                                                                    "children": [],
                                                                    "label": "\"google.cloud.storage.Client\""
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 67,
                                                                    "end_token": 69,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 67,
                                                                            "end_token": 67,
                                                                            "children": [],
                                                                            "label": "return_value"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 69,
                                                                            "end_token": 69,
                                                                            "children": [],
                                                                            "label": "mock_client"
                                                                        }
                                                                    ],
                                                                    "label": "return_value=mock_client"
                                                                }
                                                            ],
                                                            "label": "(\"google.cloud.storage.Client\", return_value=mock_client)"
                                                        }
                                                    ],
                                                    "label": "mocker.patch(\"google.cloud.storage.Client\", return_value=mock_client)"
                                                }
                                            ],
                                            "label": "mocker.patch(\"google.cloud.storage.Client\", return_value=mock_client)"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 73,
                                            "end_token": 74,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 74,
                                                    "end_token": 74,
                                                    "children": [],
                                                    "label": "mock_client"
                                                }
                                            ],
                                            "label": "return mock_client"
                                        }
                                    ],
                                    "label": "\n    mock_client = unittest.mock.MagicMock()\n    mock_bucket = unittest.mock.MagicMock()\n    mock_blob = unittest.mock.MagicMock()\n\n    mock_client.bucket.return_value = mock_bucket\n    mock_bucket.blob.return_value = mock_blob\n    mock_blob.public_url = \"http://test-url/media/laptop.jpeg\"\n\n    mocker.patch(\"google.cloud.storage.Client\", return_value=mock_client)\n\n    return mock_client"
                                }
                            ],
                            "label": "def mock_storage_client(mocker):\n    mock_client = unittest.mock.MagicMock()\n    mock_bucket = unittest.mock.MagicMock()\n    mock_blob = unittest.mock.MagicMock()\n\n    mock_client.bucket.return_value = mock_bucket\n    mock_bucket.blob.return_value = mock_blob\n    mock_blob.public_url = \"http://test-url/media/laptop.jpeg\"\n\n    mocker.patch(\"google.cloud.storage.Client\", return_value=mock_client)\n\n    return mock_client"
                        }
                    ],
                    "label": "def mock_storage_client(mocker):\n    mock_client = unittest.mock.MagicMock()\n    mock_bucket = unittest.mock.MagicMock()\n    mock_blob = unittest.mock.MagicMock()\n\n    mock_client.bucket.return_value = mock_bucket\n    mock_bucket.blob.return_value = mock_blob\n    mock_blob.public_url = \"http://test-url/media/laptop.jpeg\"\n\n    mocker.patch(\"google.cloud.storage.Client\", return_value=mock_client)\n\n    return mock_client"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_success",
            "start_line": 37,
            "end_line": 52,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 119,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 118,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "async"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "def"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 2,
                                    "end_token": 2,
                                    "label": "test_upload_media_success"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 118,
                                    "children": [
                                        {
                                            "type": "comment",
                                            "start_token": 10,
                                            "end_token": 18,
                                            "label": "# Create test JPEG data with valid signature\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 19,
                                            "end_token": 25,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 19,
                                                    "end_token": 19,
                                                    "label": "test_data"
                                                },
                                                {
                                                    "type": "concatenated_string",
                                                    "start_token": 21,
                                                    "end_token": 25,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 21,
                                                            "end_token": 22,
                                                            "label": "b\"\\xFF\\xD8\\xFF\""
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 24,
                                                            "end_token": 25,
                                                            "label": "b\"test data\""
                                                        }
                                                    ],
                                                    "label": "b\"\\xFF\\xD8\\xFF\" + b\"test data\""
                                                }
                                            ],
                                            "label": "test_data = b\"\\xFF\\xD8\\xFF\" + b\"test data\""
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 28,
                                            "end_token": 66,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 28,
                                                    "end_token": 28,
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 30,
                                                    "end_token": 66,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 30,
                                                            "end_token": 32,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 30,
                                                                    "end_token": 30,
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 32,
                                                                    "end_token": 32,
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 33,
                                                            "end_token": 66,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 35,
                                                                    "end_token": 37,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 35,
                                                                            "end_token": 35,
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "label": "\"laptop.jpeg\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"laptop.jpeg\""
                                                                },
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 40,
                                                                    "end_token": 47,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 40,
                                                                            "end_token": 40,
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 42,
                                                                            "end_token": 47,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 42,
                                                                                    "end_token": 44,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 42,
                                                                                            "end_token": 43,
                                                                                            "label": "io."
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 44,
                                                                                            "end_token": 44,
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 45,
                                                                                    "end_token": 47,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 46,
                                                                                            "end_token": 46,
                                                                                            "label": "test_data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(test_data)"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(test_data)"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(test_data)"
                                                                },
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 50,
                                                                    "end_token": 63,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 50,
                                                                            "end_token": 50,
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 52,
                                                                            "end_token": 63,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 52,
                                                                                    "end_token": 56,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 52,
                                                                                            "end_token": 54,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 52,
                                                                                                    "end_token": 52,
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 54,
                                                                                                    "end_token": 54,
                                                                                                    "label": "datastructures"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 56,
                                                                                            "end_token": 56,
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 57,
                                                                                    "end_token": 63,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 58,
                                                                                            "end_token": 62,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 59,
                                                                                                    "end_token": 61,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 59,
                                                                                                            "end_token": 59,
                                                                                                            "label": "\"content-type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 61,
                                                                                                            "end_token": 61,
                                                                                                            "label": "\"image/jpeg\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"content-type\": \"image/jpeg\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"content-type\": \"image/jpeg\"}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"image/jpeg\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(test_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(test_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(test_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 69,
                                            "end_token": 87,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 69,
                                                    "end_token": 69,
                                                    "label": "result"
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 71,
                                                    "end_token": 87,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 72,
                                                            "end_token": 87,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 72,
                                                                    "end_token": 82,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 72,
                                                                            "end_token": 74,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 72,
                                                                                    "end_token": 72,
                                                                                    "label": "backend"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 74,
                                                                                    "end_token": 74,
                                                                                    "label": "server"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 76,
                                                                            "end_token": 78,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 76,
                                                                                    "end_token": 76,
                                                                                    "label": "v2"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 78,
                                                                                    "end_token": 78,
                                                                                    "label": "store"
                                                                                }
                                                                            ],
                                                                            "label": "v2.store"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 80,
                                                                            "end_token": 82,
                                                                            "label": "media.upload_media"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 83,
                                                                    "end_token": 87,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 84,
                                                                            "end_token": 84,
                                                                            "label": "\"test-user\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 86,
                                                                            "end_token": 86,
                                                                            "label": "test_file"
                                                                        }
                                                                    ],
                                                                    "label": "(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                        },
                                        {
                                            "type": "assert_statement",
                                            "start_token": 90,
                                            "end_token": 94,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 91,
                                                    "end_token": 93,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 91,
                                                            "end_token": 91,
                                                            "label": "result"
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 94,
                                                            "end_token": 94,
                                                            "label": "\"http://test-url/media/laptop.jpeg\""
                                                        }
                                                    ],
                                                    "label": "result =="
                                                }
                                            ],
                                            "label": "assert result == \"http://test-url/media/laptop.jpeg\""
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 96,
                                            "end_token": 102,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 96,
                                                    "end_token": 96,
                                                    "label": "mock_bucket"
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 98,
                                                    "end_token": 102,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 98,
                                                            "end_token": 100,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 98,
                                                                    "end_token": 98,
                                                                    "label": "mock_storage_client"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 100,
                                                                    "end_token": 100,
                                                                    "label": "bucket"
                                                                }
                                                            ],
                                                            "label": "mock_storage_client.bucket"
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 102,
                                                            "end_token": 102,
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_storage_client.bucket.return_value"
                                                }
                                            ],
                                            "label": "mock_bucket = mock_storage_client.bucket.return_value"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 104,
                                            "end_token": 110,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 104,
                                                    "end_token": 104,
                                                    "label": "mock_blob"
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 106,
                                                    "end_token": 110,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 106,
                                                            "end_token": 108,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 106,
                                                                    "end_token": 106,
                                                                    "label": "mock_bucket"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 108,
                                                                    "end_token": 108,
                                                                    "label": "blob"
                                                                }
                                                            ],
                                                            "label": "mock_bucket.blob"
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 110,
                                                            "end_token": 110,
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_bucket.blob.return_value"
                                                }
                                            ],
                                            "label": "mock_blob = mock_bucket.blob.return_value"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "start_token": 112,
                                            "end_token": 118,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 112,
                                                    "end_token": 118,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 112,
                                                            "end_token": 116,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 112,
                                                                    "end_token": 112,
                                                                    "label": "mock_blob"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 114,
                                                                    "end_token": 114,
                                                                    "label": "upload_from_string"
                                                                }
                                                            ],
                                                            "label": "mock_blob.upload_from_string.assert_called_once"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 117,
                                                            "end_token": 118,
                                                            "label": "()"
                                                        }
                                                    ],
                                                    "label": "mock_blob.upload_from_string.assert_called_once()"
                                                }
                                            ],
                                            "label": "mock_blob.upload_from_string.assert_called_once()"
                                        }
                                    ],
                                    "label": "\n    # Create test JPEG data with valid signature\n    test_data = b\"\\xFF\\xD8\\xFF\" + b\"test data\"\n\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(test_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    assert result == \"http://test-url/media/laptop.jpeg\"\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_called_once()"
                                }
                            ],
                            "label": "async def test_upload_media_success(mock_settings, mock_storage_client):\n    # Create test JPEG data with valid signature\n    test_data = b\"\\xFF\\xD8\\xFF\" + b\"test data\"\n\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(test_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    assert result == \"http://test-url/media/laptop.jpeg\"\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_called_once()"
                        }
                    ],
                    "label": "async def test_upload_media_success(mock_settings, mock_storage_client):\n    # Create test JPEG data with valid signature\n    test_data = b\"\\xFF\\xD8\\xFF\" + b\"test data\"\n\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(test_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    assert result == \"http://test-url/media/laptop.jpeg\"\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_called_once()\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_invalid_type",
            "start_line": 55,
            "end_line": 67,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 113,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 113,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "def"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 113,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 49,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 12,
                                                    "end_token": 49,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 15,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 17,
                                                                    "end_token": 20,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "\"test.txt\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"test.txt\","
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 22,
                                                                    "end_token": 31,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 24,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 24,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 28,
                                                                                    "end_token": 29,
                                                                                    "label": "b\"test data\""
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"test data\")"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"test data\"),"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 33,
                                                                    "end_token": 47,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 33,
                                                                            "end_token": 33,
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 35,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 35,
                                                                                    "end_token": 39,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 35,
                                                                                            "end_token": 37,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 35,
                                                                                                    "end_token": 35,
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 37,
                                                                                                    "label": "datastructures"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 39,
                                                                                            "end_token": 39,
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 41,
                                                                                    "end_token": 45,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 42,
                                                                                            "end_token": 44,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 42,
                                                                                                    "end_token": 42,
                                                                                                    "label": "\"content-type\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 44,
                                                                                                    "end_token": 44,
                                                                                                    "label": "\"text/plain\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "\"content-type\": \"text/plain\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "{\"content-type\": \"text/plain\"}"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"text/plain\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"text/plain\"}),"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"test.txt\",\n        file=io.BytesIO(b\"test data\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"text/plain\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"test.txt\",\n        file=io.BytesIO(b\"test data\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"text/plain\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"test.txt\",\n        file=io.BytesIO(b\"test data\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"text/plain\"}),\n    )"
                                        },
                                        {
                                            "type": "with_statement",
                                            "start_token": 52,
                                            "end_token": 69,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 53,
                                                    "end_token": 68,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 53,
                                                            "end_token": 67,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 53,
                                                                    "end_token": 55,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 53,
                                                                            "end_token": 53,
                                                                            "label": "pytest"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 55,
                                                                            "end_token": 55,
                                                                            "label": "raises"
                                                                        }
                                                                    ],
                                                                    "label": "pytest.raises"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 57,
                                                                    "end_token": 67,
                                                                    "children": [
                                                                        {
                                                                            "type": "dotted_name",
                                                                            "start_token": 57,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 57,
                                                                                    "end_token": 57,
                                                                                    "label": "backend"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 59,
                                                                                    "end_token": 59,
                                                                                    "label": "server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 61,
                                                                                    "end_token": 61,
                                                                                    "label": "v2"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "label": "store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 65,
                                                                                    "end_token": 65,
                                                                                    "label": "exceptions"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.exceptions"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 67,
                                                                            "end_token": 67,
                                                                            "label": "InvalidFileTypeError"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.exceptions.InvalidFileTypeError"
                                                                }
                                                            ],
                                                            "label": "pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError"
                                                        }
                                                    ],
                                                    "label": "pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 70,
                                                    "end_token": 87,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 71,
                                                            "end_token": 87,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 72,
                                                                    "end_token": 87,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 72,
                                                                            "end_token": 82,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 72,
                                                                                    "end_token": 80,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dotted_name",
                                                                                            "start_token": 72,
                                                                                            "end_token": 78,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 72,
                                                                                                    "end_token": 72,
                                                                                                    "label": "backend"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 74,
                                                                                                    "end_token": 74,
                                                                                                    "label": "server"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 76,
                                                                                                    "end_token": 76,
                                                                                                    "label": "v2"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 78,
                                                                                                    "end_token": 78,
                                                                                                    "label": "store"
                                                                                                }
                                                                                            ],
                                                                                            "label": "backend.server.v2.store"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 80,
                                                                                            "end_token": 80,
                                                                                            "label": "media"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server.v2.store.media"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 82,
                                                                                    "end_token": 82,
                                                                                    "label": "upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 83,
                                                                            "end_token": 87,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 84,
                                                                                    "end_token": 84,
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 86,
                                                                                    "end_token": 86,
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 90,
                                            "end_token": 97,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 90,
                                                    "end_token": 90,
                                                    "label": "mock_bucket"
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 92,
                                                    "end_token": 96,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 92,
                                                            "end_token": 94,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 92,
                                                                    "end_token": 92,
                                                                    "label": "mock_storage_client"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 94,
                                                                    "end_token": 94,
                                                                    "label": "bucket"
                                                                }
                                                            ],
                                                            "label": "mock_storage_client.bucket"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 96,
                                                            "end_token": 96,
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_storage_client.bucket.return_value"
                                                }
                                            ],
                                            "label": "mock_bucket = mock_storage_client.bucket.return_value\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 98,
                                            "end_token": 105,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 98,
                                                    "end_token": 98,
                                                    "label": "mock_blob"
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 100,
                                                    "end_token": 104,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 100,
                                                            "end_token": 102,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 100,
                                                                    "end_token": 100,
                                                                    "label": "mock_bucket"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 102,
                                                                    "end_token": 102,
                                                                    "label": "blob"
                                                                }
                                                            ],
                                                            "label": "mock_bucket.blob"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 104,
                                                            "end_token": 104,
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_bucket.blob.return_value"
                                                }
                                            ],
                                            "label": "mock_blob = mock_bucket.blob.return_value\n"
                                        },
                                        {
                                            "type": "expression_statement",
                                            "start_token": 106,
                                            "end_token": 112,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 106,
                                                    "end_token": 112,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 106,
                                                            "end_token": 110,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 106,
                                                                    "end_token": 108,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 106,
                                                                            "end_token": 106,
                                                                            "label": "mock_blob"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 108,
                                                                            "end_token": 108,
                                                                            "label": "upload_from_string"
                                                                        }
                                                                    ],
                                                                    "label": "mock_blob.upload_from_string"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 110,
                                                                    "end_token": 110,
                                                                    "label": "assert_not_called"
                                                                }
                                                            ],
                                                            "label": "mock_blob.upload_from_string.assert_not_called"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 111,
                                                            "end_token": 112,
                                                            "label": "()"
                                                        }
                                                    ],
                                                    "label": "mock_blob.upload_from_string.assert_not_called()"
                                                }
                                            ],
                                            "label": "mock_blob.upload_from_string.assert_not_called()"
                                        }
                                    ],
                                    "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"test.txt\",\n        file=io.BytesIO(b\"test data\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"text/plain\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_not_called()\n"
                                }
                            ],
                            "label": "async def test_upload_media_invalid_type(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.txt\",\n        file=io.BytesIO(b\"test data\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"text/plain\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_not_called()\n"
                        }
                    ],
                    "label": "async def test_upload_media_invalid_type(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.txt\",\n        file=io.BytesIO(b\"test data\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"text/plain\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_not_called()\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_missing_credentials",
            "start_line": 70,
            "end_line": 83,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 127,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 127,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "def"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 5,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "label": "monkeypatch"
                                        }
                                    ],
                                    "label": "(monkeypatch)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 7,
                                    "end_token": 127,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 8,
                                            "end_token": 12,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 8,
                                                    "end_token": 8,
                                                    "label": "settings"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 10,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 10,
                                                            "end_token": 10,
                                                            "label": "Settings"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 11,
                                                            "end_token": 12,
                                                            "label": "()"
                                                        }
                                                    ],
                                                    "label": "Settings()"
                                                }
                                            ],
                                            "label": "settings = Settings()"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 14,
                                            "end_token": 20,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 14,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 14,
                                                            "end_token": 14,
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 16,
                                                            "end_token": 16,
                                                            "label": "config"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 18,
                                                            "end_token": 18,
                                                            "label": "media_gcs_bucket_name"
                                                        }
                                                    ],
                                                    "label": "settings.config.media_gcs_bucket_name"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 20,
                                                    "end_token": 20,
                                                    "label": "\"\""
                                                }
                                            ],
                                            "label": "settings.config.media_gcs_bucket_name = \"\""
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 22,
                                            "end_token": 28,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 22,
                                                    "end_token": 26,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 22,
                                                            "end_token": 22,
                                                            "label": "settings"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 24,
                                                            "end_token": 24,
                                                            "label": "config"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 26,
                                                            "end_token": 26,
                                                            "label": "google_application_credentials"
                                                        }
                                                    ],
                                                    "label": "settings.config.google_application_credentials"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 28,
                                                    "end_token": 28,
                                                    "label": "\"\""
                                                }
                                            ],
                                            "label": "settings.config.google_application_credentials = \"\""
                                        },
                                        {
                                            "type": "call",
                                            "start_token": 30,
                                            "end_token": 39,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 30,
                                                    "end_token": 32,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 30,
                                                            "end_token": 30,
                                                            "label": "monkeypatch"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 32,
                                                            "end_token": 32,
                                                            "label": "setattr"
                                                        }
                                                    ],
                                                    "label": "monkeypatch.setattr"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "start_token": 33,
                                                    "end_token": 39,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 34,
                                                            "end_token": 34,
                                                            "label": "\"backend.server.v2.store.media.Settings\""
                                                        },
                                                        {
                                                            "type": "lambda",
                                                            "start_token": 36,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "lambda_parameters",
                                                                    "start_token": 36,
                                                                    "end_token": 37,
                                                                    "label": "lambda:"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 38,
                                                                    "end_token": 38,
                                                                    "label": "settings"
                                                                }
                                                            ],
                                                            "label": "lambda: settings"
                                                        }
                                                    ],
                                                    "label": "(\"backend.server.v2.store.media.Settings\", lambda: settings)"
                                                }
                                            ],
                                            "label": "monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 42,
                                            "end_token": 88,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 42,
                                                    "end_token": 42,
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 44,
                                                    "end_token": 88,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 44,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 44,
                                                                    "end_token": 44,
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 46,
                                                                    "end_token": 46,
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 47,
                                                            "end_token": 88,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 49,
                                                                    "end_token": 52,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 49,
                                                                            "end_token": 49,
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 51,
                                                                            "end_token": 51,
                                                                            "label": "\"laptop.jpeg\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"laptop.jpeg\","
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 54,
                                                                    "end_token": 65,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 54,
                                                                            "end_token": 54,
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 56,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 56,
                                                                                    "end_token": 58,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 56,
                                                                                            "end_token": 56,
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 58,
                                                                                            "end_token": 58,
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 59,
                                                                                    "end_token": 65,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "binary_operator",
                                                                                            "start_token": 60,
                                                                                            "end_token": 64,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 60,
                                                                                                    "end_token": 60,
                                                                                                    "label": "b"
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 63,
                                                                                                    "end_token": 63,
                                                                                                    "label": "b"
                                                                                                }
                                                                                            ],
                                                                                            "label": "b\"\\xFF\\xD8\\xFF\" + b\"test data\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(b\"\\xFF\\xD8\\xFF\" + b\"test data\")"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\")"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\")"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 72,
                                                                    "end_token": 85,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 72,
                                                                            "end_token": 72,
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 74,
                                                                            "end_token": 85,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 74,
                                                                                    "end_token": 78,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 74,
                                                                                            "end_token": 74,
                                                                                            "label": "starlette"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 76,
                                                                                            "end_token": 76,
                                                                                            "label": "datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 78,
                                                                                            "end_token": 78,
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 79,
                                                                                    "end_token": 85,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 80,
                                                                                            "end_token": 84,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 81,
                                                                                                    "end_token": 83,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 81,
                                                                                                            "end_token": 81,
                                                                                                            "label": "\"content-type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 83,
                                                                                                            "end_token": 83,
                                                                                                            "label": "\"image/jpeg\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"content-type\": \"image/jpeg\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"content-type\": \"image/jpeg\"}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"image/jpeg\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\"),  # Valid JPEG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\"),  # Valid JPEG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\"),  # Valid JPEG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                        },
                                        {
                                            "type": "with_statement",
                                            "start_token": 91,
                                            "end_token": 127,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "start_token": 91,
                                                    "end_token": 108,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 92,
                                                            "end_token": 107,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 92,
                                                                    "end_token": 106,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 92,
                                                                            "end_token": 102,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 92,
                                                                                    "end_token": 98,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 92,
                                                                                            "end_token": 96,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dotted_name",
                                                                                                    "start_token": 92,
                                                                                                    "end_token": 93,
                                                                                                    "label": "pytest."
                                                                                                },
                                                                                                {
                                                                                                    "type": "dotted_name",
                                                                                                    "start_token": 94,
                                                                                                    "end_token": 96,
                                                                                                    "label": "raises(backend"
                                                                                                }
                                                                                            ],
                                                                                            "label": "pytest.raises(backend"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 98,
                                                                                            "end_token": 98,
                                                                                            "label": "server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "pytest.raises(backend.server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 100,
                                                                                    "end_token": 102,
                                                                                    "label": "v2.store"
                                                                                }
                                                                            ],
                                                                            "label": "pytest.raises(backend.server.v2.store"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 104,
                                                                            "end_token": 106,
                                                                            "label": "exceptions.StorageConfigError"
                                                                        }
                                                                    ],
                                                                    "label": "pytest.raises(backend.server.v2.store.exceptions.StorageConfigError"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 107,
                                                                    "end_token": 107,
                                                                    "label": ")"
                                                                }
                                                            ],
                                                            "label": "pytest.raises(backend.server.v2.store.exceptions.StorageConfigError)"
                                                        }
                                                    ],
                                                    "label": "with pytest.raises(backend.server.v2.store.exceptions.StorageConfigError):"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 109,
                                                    "end_token": 127,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 110,
                                                            "end_token": 126,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 111,
                                                                    "end_token": 126,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 111,
                                                                            "end_token": 121,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 111,
                                                                                    "end_token": 119,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 111,
                                                                                            "end_token": 117,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dotted_name",
                                                                                                    "start_token": 111,
                                                                                                    "end_token": 113,
                                                                                                    "label": "backend.server"
                                                                                                },
                                                                                                {
                                                                                                    "type": "dotted_name",
                                                                                                    "start_token": 114,
                                                                                                    "end_token": 116,
                                                                                                    "label": ".v2."
                                                                                                }
                                                                                            ],
                                                                                            "label": "backend.server.v2.store"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 118,
                                                                                            "end_token": 119,
                                                                                            "label": ".media"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server.v2.store.media"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 120,
                                                                                    "end_token": 121,
                                                                                    "label": ".upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 122,
                                                                            "end_token": 126,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 123,
                                                                                    "end_token": 123,
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 125,
                                                                                    "end_token": 125,
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                                                }
                                            ],
                                            "label": "with pytest.raises(backend.server.v2.store.exceptions.StorageConfigError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                                        }
                                    ],
                                    "label": "\n    settings = Settings()\n    settings.config.media_gcs_bucket_name = \"\"\n    settings.config.google_application_credentials = \"\"\n    monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)\n\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\"),  # Valid JPEG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.StorageConfigError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                                }
                            ],
                            "label": "async def test_upload_media_missing_credentials(monkeypatch):\n    settings = Settings()\n    settings.config.media_gcs_bucket_name = \"\"\n    settings.config.google_application_credentials = \"\"\n    monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)\n\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\"),  # Valid JPEG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.StorageConfigError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                        }
                    ],
                    "label": "async def test_upload_media_missing_credentials(monkeypatch):\n    settings = Settings()\n    settings.config.media_gcs_bucket_name = \"\"\n    settings.config.google_application_credentials = \"\"\n    monkeypatch.setattr(\"backend.server.v2.store.media.Settings\", lambda: settings)\n\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\\xFF\\xD8\\xFF\" + b\"test data\"),  # Valid JPEG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.StorageConfigError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_video_type",
            "start_line": 86,
            "end_line": 98,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 106,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 105,
                            "children": [
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "children": [],
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "children": [],
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 105,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 53,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "children": [],
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 12,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "children": [],
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 15,
                                                            "end_token": 53,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "children": [],
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "children": [],
                                                                            "label": "\"test.mp4\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"test.mp4\""
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 22,
                                                                    "end_token": 30,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "children": [],
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 24,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 24,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "children": [],
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "children": [],
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 27,
                                                                                    "end_token": 30,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "bytes",
                                                                                            "start_token": 29,
                                                                                            "end_token": 29,
                                                                                            "children": [],
                                                                                            "label": "\"\\x00\\x00\\x00\\x18ftypmp42\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(b\"\\x00\\x00\\x00\\x18ftypmp42\")"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\")"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\")"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 37,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "children": [],
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 39,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 39,
                                                                                    "end_token": 43,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 39,
                                                                                            "end_token": 41,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 39,
                                                                                                    "end_token": 39,
                                                                                                    "children": [],
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 41,
                                                                                                    "end_token": 41,
                                                                                                    "children": [],
                                                                                                    "label": "datastructures"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 43,
                                                                                            "end_token": 43,
                                                                                            "children": [],
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 44,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 45,
                                                                                            "end_token": 49,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 46,
                                                                                                    "end_token": 48,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 46,
                                                                                                            "end_token": 46,
                                                                                                            "children": [],
                                                                                                            "label": "\"content-type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 48,
                                                                                                            "end_token": 48,
                                                                                                            "children": [],
                                                                                                            "label": "\"video/mp4\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"content-type\": \"video/mp4\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"content-type\": \"video/mp4\"}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"video/mp4\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"video/mp4\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"video/mp4\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"test.mp4\",\n        file=io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\"),  # Valid MP4 signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/mp4\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"test.mp4\",\n        file=io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\"),  # Valid MP4 signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/mp4\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"test.mp4\",\n        file=io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\"),  # Valid MP4 signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/mp4\"}),\n    )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 56,
                                            "end_token": 74,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 56,
                                                    "end_token": 56,
                                                    "children": [],
                                                    "label": "result"
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 58,
                                                    "end_token": 74,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 59,
                                                            "end_token": 74,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 59,
                                                                    "end_token": 69,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 59,
                                                                            "end_token": 61,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 59,
                                                                                    "end_token": 59,
                                                                                    "children": [],
                                                                                    "label": "backend"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 61,
                                                                                    "end_token": 61,
                                                                                    "children": [],
                                                                                    "label": "server"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 62,
                                                                            "end_token": 63,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 62,
                                                                                    "end_token": 62,
                                                                                    "children": [],
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "children": [],
                                                                                    "label": "v2"
                                                                                }
                                                                            ],
                                                                            "label": ".v2"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 64,
                                                                            "end_token": 67,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 64,
                                                                                    "end_token": 64,
                                                                                    "children": [],
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 67,
                                                                                    "children": [],
                                                                                    "label": "media"
                                                                                }
                                                                            ],
                                                                            "label": ".store.media"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 69,
                                                                            "end_token": 69,
                                                                            "children": [],
                                                                            "label": "upload_media"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 70,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 71,
                                                                            "end_token": 71,
                                                                            "children": [],
                                                                            "label": "\"test-user\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 73,
                                                                            "end_token": 73,
                                                                            "children": [],
                                                                            "label": "test_file"
                                                                        }
                                                                    ],
                                                                    "label": "(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                        },
                                        {
                                            "type": "assert_statement",
                                            "start_token": 77,
                                            "end_token": 81,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 78,
                                                    "end_token": 80,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 78,
                                                            "end_token": 78,
                                                            "children": [],
                                                            "label": "result"
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 81,
                                                            "end_token": 81,
                                                            "children": [],
                                                            "label": "\"http://test-url/media/laptop.jpeg\""
                                                        }
                                                    ],
                                                    "label": "result =="
                                                }
                                            ],
                                            "label": "assert result == \"http://test-url/media/laptop.jpeg\""
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 83,
                                            "end_token": 90,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 83,
                                                    "end_token": 83,
                                                    "children": [],
                                                    "label": "mock_bucket"
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 85,
                                                    "end_token": 89,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 85,
                                                            "end_token": 87,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 85,
                                                                    "end_token": 85,
                                                                    "children": [],
                                                                    "label": "mock_storage_client"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 87,
                                                                    "end_token": 87,
                                                                    "children": [],
                                                                    "label": "bucket"
                                                                }
                                                            ],
                                                            "label": "mock_storage_client.bucket"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 89,
                                                            "end_token": 89,
                                                            "children": [],
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_storage_client.bucket.return_value"
                                                }
                                            ],
                                            "label": "mock_bucket = mock_storage_client.bucket.return_value\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 91,
                                            "end_token": 98,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 91,
                                                    "end_token": 91,
                                                    "children": [],
                                                    "label": "mock_blob"
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 93,
                                                    "end_token": 97,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 93,
                                                            "end_token": 95,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 93,
                                                                    "end_token": 93,
                                                                    "children": [],
                                                                    "label": "mock_bucket"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 95,
                                                                    "end_token": 95,
                                                                    "children": [],
                                                                    "label": "blob"
                                                                }
                                                            ],
                                                            "label": "mock_bucket.blob"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 97,
                                                            "end_token": 97,
                                                            "children": [],
                                                            "label": "return_value"
                                                        }
                                                    ],
                                                    "label": "mock_bucket.blob.return_value"
                                                }
                                            ],
                                            "label": "mock_blob = mock_bucket.blob.return_value\n"
                                        },
                                        {
                                            "type": "call",
                                            "start_token": 99,
                                            "end_token": 105,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 99,
                                                    "end_token": 102,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 99,
                                                            "end_token": 101,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 99,
                                                                    "end_token": 99,
                                                                    "children": [],
                                                                    "label": "mock_blob"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 101,
                                                                    "end_token": 101,
                                                                    "children": [],
                                                                    "label": "upload_from_string"
                                                                }
                                                            ],
                                                            "label": "mock_blob.upload_from_string"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 102,
                                                            "end_token": 102,
                                                            "children": [],
                                                            "label": "."
                                                        }
                                                    ],
                                                    "label": "mock_blob.upload_from_string."
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "start_token": 104,
                                                    "end_token": 105,
                                                    "children": [],
                                                    "label": "()"
                                                }
                                            ],
                                            "label": "mock_blob.upload_from_string.assert_called_once()"
                                        }
                                    ],
                                    "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"test.mp4\",\n        file=io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\"),  # Valid MP4 signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/mp4\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    assert result == \"http://test-url/media/laptop.jpeg\"\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_called_once()"
                                }
                            ],
                            "label": "async def test_upload_media_video_type(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.mp4\",\n        file=io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\"),  # Valid MP4 signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/mp4\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    assert result == \"http://test-url/media/laptop.jpeg\"\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_called_once()"
                        }
                    ],
                    "label": "async def test_upload_media_video_type(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.mp4\",\n        file=io.BytesIO(b\"\\x00\\x00\\x00\\x18ftypmp42\"),  # Valid MP4 signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/mp4\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n\n    assert result == \"http://test-url/media/laptop.jpeg\"\n    mock_bucket = mock_storage_client.bucket.return_value\n    mock_blob = mock_bucket.blob.return_value\n    mock_blob.upload_from_string.assert_called_once()\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_file_too_large",
            "start_line": 101,
            "end_line": 112,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 116,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 116,
                            "children": [
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "children": [],
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "children": [],
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 116,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 38,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "children": [],
                                                    "label": "large_data"
                                                },
                                                {
                                                    "type": "binary_operator",
                                                    "start_token": 12,
                                                    "end_token": 26,
                                                    "children": [
                                                        {
                                                            "type": "binary_operator",
                                                            "start_token": 12,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "b"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 13,
                                                                    "end_token": 13,
                                                                    "children": [],
                                                                    "label": "\"\\xFF\\xD8\\xFF\""
                                                                }
                                                            ],
                                                            "label": "b\"\\xFF\\xD8\\xFF\""
                                                        },
                                                        {
                                                            "type": "binary_operator",
                                                            "start_token": 15,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "binary_operator",
                                                                    "start_token": 15,
                                                                    "end_token": 17,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "children": [],
                                                                            "label": "b"
                                                                        },
                                                                        {
                                                                            "type": "integer",
                                                                            "start_token": 18,
                                                                            "end_token": 18,
                                                                            "children": [],
                                                                            "label": "("
                                                                        }
                                                                    ],
                                                                    "label": "b\"x\" *"
                                                                },
                                                                {
                                                                    "type": "integer",
                                                                    "start_token": 26,
                                                                    "end_token": 26,
                                                                    "children": [],
                                                                    "label": "1"
                                                                }
                                                            ],
                                                            "label": "b\"x\" * (\n        50 * 1024 * 1024 + 1"
                                                        }
                                                    ],
                                                    "label": "b\"\\xFF\\xD8\\xFF\" + b\"x\" * (\n        50 * 1024 * 1024 + 1"
                                                }
                                            ],
                                            "label": "large_data = b\"\\xFF\\xD8\\xFF\" + b\"x\" * (\n        50 * 1024 * 1024 + 1\n    )  # 50MB + 1 byte with valid JPEG signature"
                                        },
                                        {
                                            "type": "comment",
                                            "start_token": 29,
                                            "end_token": 38,
                                            "children": [],
                                            "label": "# 50MB + 1 byte with valid JPEG signature"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 40,
                                            "end_token": 78,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 40,
                                                    "end_token": 40,
                                                    "children": [],
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 42,
                                                    "end_token": 78,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 42,
                                                            "end_token": 44,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 42,
                                                                    "end_token": 42,
                                                                    "children": [],
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 44,
                                                                    "end_token": 44,
                                                                    "children": [],
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "arguments",
                                                            "start_token": 45,
                                                            "end_token": 78,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 47,
                                                                    "end_token": 49,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 47,
                                                                            "end_token": 47,
                                                                            "children": [],
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 49,
                                                                            "end_token": 49,
                                                                            "children": [],
                                                                            "label": "\"laptop.jpeg\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"laptop.jpeg\""
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 52,
                                                                    "end_token": 59,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 52,
                                                                            "end_token": 52,
                                                                            "children": [],
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 54,
                                                                            "end_token": 59,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 54,
                                                                                    "end_token": 56,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 54,
                                                                                            "end_token": 54,
                                                                                            "children": [],
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 56,
                                                                                            "end_token": 56,
                                                                                            "children": [],
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 57,
                                                                                    "end_token": 59,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 58,
                                                                                            "end_token": 58,
                                                                                            "children": [],
                                                                                            "label": "large_data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(large_data)"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(large_data)"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(large_data)"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 62,
                                                                    "end_token": 75,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 62,
                                                                            "end_token": 62,
                                                                            "children": [],
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 64,
                                                                            "end_token": 75,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 64,
                                                                                    "end_token": 68,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 64,
                                                                                            "end_token": 66,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 64,
                                                                                                    "end_token": 64,
                                                                                                    "children": [],
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 66,
                                                                                                    "end_token": 66,
                                                                                                    "children": [],
                                                                                                    "label": "datastructures"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 68,
                                                                                            "end_token": 68,
                                                                                            "children": [],
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 69,
                                                                                    "end_token": 75,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 71,
                                                                                            "end_token": 73,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 71,
                                                                                                    "end_token": 71,
                                                                                                    "children": [],
                                                                                                    "label": "\"content-type\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 73,
                                                                                                    "end_token": 73,
                                                                                                    "children": [],
                                                                                                    "label": "\"image/jpeg\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "\"content-type\": \"image/jpeg\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"image/jpeg\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(large_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(large_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(large_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                        },
                                        {
                                            "type": "with_statement",
                                            "start_token": 81,
                                            "end_token": 116,
                                            "children": [
                                                {
                                                    "type": "with_item",
                                                    "start_token": 81,
                                                    "end_token": 97,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 82,
                                                            "end_token": 97,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 82,
                                                                    "end_token": 84,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 82,
                                                                            "end_token": 82,
                                                                            "children": [],
                                                                            "label": "pytest"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 84,
                                                                            "end_token": 84,
                                                                            "children": [],
                                                                            "label": "raises"
                                                                        }
                                                                    ],
                                                                    "label": "pytest.raises"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 85,
                                                                    "end_token": 97,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 86,
                                                                            "end_token": 96,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 86,
                                                                                    "end_token": 92,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 86,
                                                                                            "end_token": 88,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 86,
                                                                                                    "end_token": 86,
                                                                                                    "children": [],
                                                                                                    "label": "backend"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 88,
                                                                                                    "end_token": 88,
                                                                                                    "children": [],
                                                                                                    "label": "server"
                                                                                                }
                                                                                            ],
                                                                                            "label": "backend.server"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 90,
                                                                                            "end_token": 92,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 90,
                                                                                                    "end_token": 90,
                                                                                                    "children": [],
                                                                                                    "label": "v2"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 92,
                                                                                                    "end_token": 92,
                                                                                                    "children": [],
                                                                                                    "label": "store"
                                                                                                }
                                                                                            ],
                                                                                            "label": "v2.store"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server.v2.store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 94,
                                                                                    "end_token": 96,
                                                                                    "children": [],
                                                                                    "label": "exceptions.FileSizeTooLargeError"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.exceptions.FileSizeTooLargeError"
                                                                        }
                                                                    ],
                                                                    "label": "(backend.server.v2.store.exceptions.FileSizeTooLargeError)"
                                                                }
                                                            ],
                                                            "label": "pytest.raises(backend.server.v2.store.exceptions.FileSizeTooLargeError)"
                                                        }
                                                    ],
                                                    "label": "with pytest.raises(backend.server.v2.store.exceptions.FileSizeTooLargeError)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 99,
                                                    "end_token": 116,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 100,
                                                            "end_token": 116,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 101,
                                                                    "end_token": 116,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 101,
                                                                            "end_token": 111,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 101,
                                                                                    "end_token": 103,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 101,
                                                                                            "end_token": 101,
                                                                                            "children": [],
                                                                                            "label": "backend"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 103,
                                                                                            "end_token": 103,
                                                                                            "children": [],
                                                                                            "label": "server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 105,
                                                                                    "end_token": 111,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 105,
                                                                                            "end_token": 107,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 105,
                                                                                                    "end_token": 105,
                                                                                                    "children": [],
                                                                                                    "label": "v2"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 107,
                                                                                                    "end_token": 107,
                                                                                                    "children": [],
                                                                                                    "label": "store"
                                                                                                }
                                                                                            ],
                                                                                            "label": "v2.store"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 109,
                                                                                            "end_token": 111,
                                                                                            "children": [],
                                                                                            "label": "media.upload_media"
                                                                                        }
                                                                                    ],
                                                                                    "label": "v2.store.media.upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 112,
                                                                            "end_token": 116,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 113,
                                                                                    "end_token": 113,
                                                                                    "children": [],
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 115,
                                                                                    "end_token": 115,
                                                                                    "children": [],
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "with pytest.raises(backend.server.v2.store.exceptions.FileSizeTooLargeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                        }
                                    ],
                                    "label": "\n    large_data = b\"\\xFF\\xD8\\xFF\" + b\"x\" * (\n        50 * 1024 * 1024 + 1\n    )  # 50MB + 1 byte with valid JPEG signature\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(large_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.FileSizeTooLargeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                }
                            ],
                            "label": "async def test_upload_media_file_too_large(mock_settings, mock_storage_client):\n    large_data = b\"\\xFF\\xD8\\xFF\" + b\"x\" * (\n        50 * 1024 * 1024 + 1\n    )  # 50MB + 1 byte with valid JPEG signature\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(large_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.FileSizeTooLargeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                        }
                    ],
                    "label": "async def test_upload_media_file_too_large(mock_settings, mock_storage_client):\n    large_data = b\"\\xFF\\xD8\\xFF\" + b\"x\" * (\n        50 * 1024 * 1024 + 1\n    )  # 50MB + 1 byte with valid JPEG signature\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(large_data),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.FileSizeTooLargeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_file_read_error",
            "start_line": 115,
            "end_line": 124,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 114,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 114,
                            "children": [
                                {
                                    "type": "async",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "children": [],
                                    "label": "async"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "def"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 2,
                                    "end_token": 2,
                                    "children": [],
                                    "label": "test_upload_media_file_read_error"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "children": [],
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "children": [],
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 114,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 58,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "children": [],
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 12,
                                                    "end_token": 58,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "children": [],
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 15,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "children": [],
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "children": [],
                                                                            "label": "\"laptop.jpeg\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"laptop.jpeg\""
                                                                },
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 22,
                                                                    "end_token": 31,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "children": [],
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 24,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 24,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "children": [],
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "children": [],
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 27,
                                                                                    "end_token": 30,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "bytes",
                                                                                            "start_token": 28,
                                                                                            "end_token": 29,
                                                                                            "children": [],
                                                                                            "label": "b\"\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(b\"\")"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"\"),"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"\"),"
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "start_token": 32,
                                                                    "end_token": 41,
                                                                    "children": [],
                                                                    "label": "# Empty file that will raise error on read\n"
                                                                },
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 42,
                                                                    "end_token": 55,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 42,
                                                                            "end_token": 42,
                                                                            "children": [],
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 44,
                                                                            "end_token": 55,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 44,
                                                                                    "end_token": 48,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 44,
                                                                                            "end_token": 46,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 44,
                                                                                                    "end_token": 44,
                                                                                                    "children": [],
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 46,
                                                                                                    "end_token": 46,
                                                                                                    "children": [],
                                                                                                    "label": "datastructures"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 48,
                                                                                            "end_token": 48,
                                                                                            "children": [],
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 49,
                                                                                    "end_token": 55,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 50,
                                                                                            "end_token": 54,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 51,
                                                                                                    "end_token": 53,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 51,
                                                                                                            "end_token": 51,
                                                                                                            "children": [],
                                                                                                            "label": "\"content-type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 53,
                                                                                                            "end_token": 53,
                                                                                                            "children": [],
                                                                                                            "label": "\"image/jpeg\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"content-type\": \"image/jpeg\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"content-type\": \"image/jpeg\"}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"image/jpeg\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\"),  # Empty file that will raise error on read\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\"),  # Empty file that will raise error on read\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\"),  # Empty file that will raise error on read\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 60,
                                            "end_token": 76,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 60,
                                                    "end_token": 62,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 60,
                                                            "end_token": 60,
                                                            "children": [],
                                                            "label": "test_file"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 62,
                                                            "end_token": 62,
                                                            "children": [],
                                                            "label": "read"
                                                        }
                                                    ],
                                                    "label": "test_file.read"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 64,
                                                    "end_token": 76,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 64,
                                                            "end_token": 68,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 64,
                                                                    "end_token": 66,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 64,
                                                                            "end_token": 64,
                                                                            "children": [],
                                                                            "label": "unittest"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 66,
                                                                            "end_token": 66,
                                                                            "children": [],
                                                                            "label": "mock"
                                                                        }
                                                                    ],
                                                                    "label": "unittest.mock"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 68,
                                                                    "end_token": 68,
                                                                    "children": [],
                                                                    "label": "AsyncMock"
                                                                }
                                                            ],
                                                            "label": "unittest.mock.AsyncMock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 69,
                                                            "end_token": 76,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "start_token": 70,
                                                                    "end_token": 75,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 70,
                                                                            "end_token": 70,
                                                                            "children": [],
                                                                            "label": "side_effect"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 72,
                                                                            "end_token": 75,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 72,
                                                                                    "end_token": 72,
                                                                                    "children": [],
                                                                                    "label": "Exception"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 73,
                                                                                    "end_token": 75,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 74,
                                                                                            "end_token": 74,
                                                                                            "children": [],
                                                                                            "label": "\"Read error\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\"Read error\")"
                                                                                }
                                                                            ],
                                                                            "label": "Exception(\"Read error\")"
                                                                        }
                                                                    ],
                                                                    "label": "side_effect=Exception(\"Read error\")"
                                                                }
                                                            ],
                                                            "label": "(side_effect=Exception(\"Read error\"))"
                                                        }
                                                    ],
                                                    "label": "unittest.mock.AsyncMock(side_effect=Exception(\"Read error\"))"
                                                }
                                            ],
                                            "label": "test_file.read = unittest.mock.AsyncMock(side_effect=Exception(\"Read error\"))"
                                        },
                                        {
                                            "type": "with_statement",
                                            "start_token": 79,
                                            "end_token": 114,
                                            "children": [
                                                {
                                                    "type": "with_item",
                                                    "start_token": 80,
                                                    "end_token": 95,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 80,
                                                            "end_token": 95,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 80,
                                                                    "end_token": 82,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 80,
                                                                            "end_token": 80,
                                                                            "children": [],
                                                                            "label": "pytest"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 82,
                                                                            "end_token": 82,
                                                                            "children": [],
                                                                            "label": "raises"
                                                                        }
                                                                    ],
                                                                    "label": "pytest.raises"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 83,
                                                                    "end_token": 95,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 84,
                                                                            "end_token": 94,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 84,
                                                                                    "end_token": 86,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 84,
                                                                                            "end_token": 84,
                                                                                            "children": [],
                                                                                            "label": "backend"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 86,
                                                                                            "end_token": 86,
                                                                                            "children": [],
                                                                                            "label": "server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 87,
                                                                                    "end_token": 89,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 87,
                                                                                            "end_token": 87,
                                                                                            "children": [],
                                                                                            "label": "."
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 89,
                                                                                            "end_token": 89,
                                                                                            "children": [],
                                                                                            "label": "."
                                                                                        }
                                                                                    ],
                                                                                    "label": ".v2."
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 90,
                                                                                    "end_token": 92,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 90,
                                                                                            "end_token": 90,
                                                                                            "children": [],
                                                                                            "label": "store"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 92,
                                                                                            "end_token": 92,
                                                                                            "children": [],
                                                                                            "label": "exceptions"
                                                                                        }
                                                                                    ],
                                                                                    "label": "store.exceptions"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 94,
                                                                                    "end_token": 94,
                                                                                    "children": [],
                                                                                    "label": "FileReadError"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.exceptions.FileReadError"
                                                                        }
                                                                    ],
                                                                    "label": "(backend.server.v2.store.exceptions.FileReadError)"
                                                                }
                                                            ],
                                                            "label": "pytest.raises(backend.server.v2.store.exceptions.FileReadError)"
                                                        }
                                                    ],
                                                    "label": "pytest.raises(backend.server.v2.store.exceptions.FileReadError)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 96,
                                                    "end_token": 114,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 98,
                                                            "end_token": 114,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 99,
                                                                    "end_token": 114,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 99,
                                                                            "end_token": 109,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 99,
                                                                                    "end_token": 101,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 99,
                                                                                            "end_token": 99,
                                                                                            "children": [],
                                                                                            "label": "backend"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 101,
                                                                                            "end_token": 101,
                                                                                            "children": [],
                                                                                            "label": "server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 102,
                                                                                    "end_token": 104,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 102,
                                                                                            "end_token": 102,
                                                                                            "children": [],
                                                                                            "label": "."
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 104,
                                                                                            "end_token": 104,
                                                                                            "children": [],
                                                                                            "label": "."
                                                                                        }
                                                                                    ],
                                                                                    "label": ".v2."
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 105,
                                                                                    "end_token": 107,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 105,
                                                                                            "end_token": 105,
                                                                                            "children": [],
                                                                                            "label": "store"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 107,
                                                                                            "end_token": 107,
                                                                                            "children": [],
                                                                                            "label": "media"
                                                                                        }
                                                                                    ],
                                                                                    "label": "store.media"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 109,
                                                                                    "end_token": 109,
                                                                                    "children": [],
                                                                                    "label": "upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 110,
                                                                            "end_token": 114,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 111,
                                                                                    "end_token": 111,
                                                                                    "children": [],
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 113,
                                                                                    "end_token": 113,
                                                                                    "children": [],
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": ":\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "with pytest.raises(backend.server.v2.store.exceptions.FileReadError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                        }
                                    ],
                                    "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\"),  # Empty file that will raise error on read\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n    test_file.read = unittest.mock.AsyncMock(side_effect=Exception(\"Read error\"))\n\n    with pytest.raises(backend.server.v2.store.exceptions.FileReadError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                }
                            ],
                            "label": "async def test_upload_media_file_read_error(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\"),  # Empty file that will raise error on read\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n    test_file.read = unittest.mock.AsyncMock(side_effect=Exception(\"Read error\"))\n\n    with pytest.raises(backend.server.v2.store.exceptions.FileReadError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                        }
                    ],
                    "label": "async def test_upload_media_file_read_error(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"laptop.jpeg\",\n        file=io.BytesIO(b\"\"),  # Empty file that will raise error on read\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n    test_file.read = unittest.mock.AsyncMock(side_effect=Exception(\"Read error\"))\n\n    with pytest.raises(backend.server.v2.store.exceptions.FileReadError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_png_success",
            "start_line": 127,
            "end_line": 135,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 81,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 81,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "async"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 81,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 53,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 12,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 15,
                                                            "end_token": 53,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 17,
                                                                    "end_token": 20,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "\"test.png\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"test.png\","
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 22,
                                                                    "end_token": 31,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 24,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 24,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "bytes",
                                                                                    "start_token": 28,
                                                                                    "end_token": 29,
                                                                                    "label": "b\"\\x89PNG\\r\\n\\x1a\\n\""
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\")"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 37,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 39,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 39,
                                                                                    "end_token": 43,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 39,
                                                                                            "end_token": 39,
                                                                                            "label": "starlette"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 41,
                                                                                            "end_token": 41,
                                                                                            "label": "datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 43,
                                                                                            "end_token": 43,
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 45,
                                                                                    "end_token": 49,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 46,
                                                                                            "end_token": 48,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 46,
                                                                                                    "end_token": 46,
                                                                                                    "label": "\"content-type\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 48,
                                                                                                    "end_token": 48,
                                                                                                    "label": "\"image/png\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "\"content-type\": \"image/png\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "{\"content-type\": \"image/png\"}"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/png\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/png\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"test.png\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # Valid PNG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/png\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"test.png\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # Valid PNG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/png\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"test.png\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # Valid PNG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/png\"}),\n    )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 56,
                                            "end_token": 74,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 56,
                                                    "end_token": 56,
                                                    "label": "result"
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 58,
                                                    "end_token": 74,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 59,
                                                            "end_token": 74,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 59,
                                                                    "end_token": 69,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 59,
                                                                            "end_token": 59,
                                                                            "label": "backend"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 61,
                                                                            "end_token": 61,
                                                                            "label": "server"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 63,
                                                                            "end_token": 63,
                                                                            "label": "v2"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 65,
                                                                            "end_token": 65,
                                                                            "label": "store"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 67,
                                                                            "end_token": 67,
                                                                            "label": "media"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 69,
                                                                            "end_token": 69,
                                                                            "label": "upload_media"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 70,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 71,
                                                                            "end_token": 71,
                                                                            "label": "\"test-user\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 73,
                                                                            "end_token": 73,
                                                                            "label": "test_file"
                                                                        }
                                                                    ],
                                                                    "label": "(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                        },
                                        {
                                            "type": "assert_statement",
                                            "start_token": 76,
                                            "end_token": 80,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 77,
                                                    "end_token": 80,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 77,
                                                            "end_token": 77,
                                                            "label": "result"
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 80,
                                                            "end_token": 80,
                                                            "label": "\"http://test-url/media/laptop.jpeg\""
                                                        }
                                                    ],
                                                    "label": "result == \"http://test-url/media/laptop.jpeg\""
                                                }
                                            ],
                                            "label": "assert result == \"http://test-url/media/laptop.jpeg\""
                                        }
                                    ],
                                    "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"test.png\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # Valid PNG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/png\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                                }
                            ],
                            "label": "async def test_upload_media_png_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.png\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # Valid PNG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/png\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                        }
                    ],
                    "label": "async def test_upload_media_png_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.png\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # Valid PNG signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/png\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_gif_success",
            "start_line": 138,
            "end_line": 146,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 81,
                    "children": [
                        {
                            "type": "decorated_definition",
                            "start_token": 0,
                            "end_token": 81,
                            "children": [
                                {
                                    "type": "function_definition",
                                    "start_token": 0,
                                    "end_token": 81,
                                    "children": [
                                        {
                                            "type": "async",
                                            "start_token": 0,
                                            "end_token": 0,
                                            "children": [],
                                            "label": "async"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 1,
                                            "end_token": 1,
                                            "children": [],
                                            "label": "def"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 2,
                                            "end_token": 2,
                                            "children": [],
                                            "label": "test_upload_media_gif_success"
                                        },
                                        {
                                            "type": "parameters",
                                            "start_token": 3,
                                            "end_token": 7,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "mock_settings"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 6,
                                                    "end_token": 6,
                                                    "children": [],
                                                    "label": "mock_storage_client"
                                                }
                                            ],
                                            "label": "(mock_settings, mock_storage_client)"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 9,
                                            "end_token": 81,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 10,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 10,
                                                            "end_token": 10,
                                                            "children": [],
                                                            "label": "test_file"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 12,
                                                            "end_token": 53,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 12,
                                                                    "end_token": 14,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "children": [],
                                                                            "label": "fastapi"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 14,
                                                                            "end_token": 14,
                                                                            "children": [],
                                                                            "label": "UploadFile"
                                                                        }
                                                                    ],
                                                                    "label": "fastapi.UploadFile"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 15,
                                                                    "end_token": 53,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 17,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "children": [],
                                                                                    "label": "filename"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "children": [],
                                                                                    "label": "\"test.gif\""
                                                                                }
                                                                            ],
                                                                            "label": "filename=\"test.gif\""
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 22,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 22,
                                                                                    "end_token": 22,
                                                                                    "children": [],
                                                                                    "label": "file"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 24,
                                                                                    "end_token": 30,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 24,
                                                                                            "end_token": 26,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 24,
                                                                                                    "end_token": 24,
                                                                                                    "children": [],
                                                                                                    "label": "io"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 26,
                                                                                                    "end_token": 26,
                                                                                                    "children": [],
                                                                                                    "label": "BytesIO"
                                                                                                }
                                                                                            ],
                                                                                            "label": "io.BytesIO"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 27,
                                                                                            "end_token": 30,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "binary_operator",
                                                                                                    "start_token": 28,
                                                                                                    "end_token": 29,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 29,
                                                                                                            "end_token": 29,
                                                                                                            "children": [],
                                                                                                            "label": "\"GIF89a\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "b\"GIF89a\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(b\"GIF89a\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO(b\"GIF89a\")"
                                                                                }
                                                                            ],
                                                                            "label": "file=io.BytesIO(b\"GIF89a\"),"
                                                                        },
                                                                        {
                                                                            "type": "comment",
                                                                            "start_token": 32,
                                                                            "end_token": 35,
                                                                            "children": [],
                                                                            "label": "# Valid GIF signature"
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 37,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 37,
                                                                                    "end_token": 37,
                                                                                    "children": [],
                                                                                    "label": "headers"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 39,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dotted_name",
                                                                                            "start_token": 39,
                                                                                            "end_token": 43,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 39,
                                                                                                    "end_token": 39,
                                                                                                    "children": [],
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 41,
                                                                                                    "end_token": 41,
                                                                                                    "children": [],
                                                                                                    "label": "datastructures"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 43,
                                                                                                    "end_token": 43,
                                                                                                    "children": [],
                                                                                                    "label": "Headers"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures.Headers"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 44,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary",
                                                                                                    "start_token": 45,
                                                                                                    "end_token": 49,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 46,
                                                                                                            "end_token": 48,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 46,
                                                                                                                    "end_token": 46,
                                                                                                                    "children": [],
                                                                                                                    "label": "\"content-type\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 48,
                                                                                                                    "end_token": 48,
                                                                                                                    "children": [],
                                                                                                                    "label": "\"image/gif\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"content-type\": \"image/gif\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "{\"content-type\": \"image/gif\"}"
                                                                                                }
                                                                                            ],
                                                                                            "label": "({\"content-type\": \"image/gif\"})"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers({\"content-type\": \"image/gif\"})"
                                                                                }
                                                                            ],
                                                                            "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"})"
                                                                        }
                                                                    ],
                                                                    "label": "(\n        filename=\"test.gif\",\n        file=io.BytesIO(b\"GIF89a\"),  # Valid GIF signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"}),\n    )"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile(\n        filename=\"test.gif\",\n        file=io.BytesIO(b\"GIF89a\"),  # Valid GIF signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "test_file = fastapi.UploadFile(\n        filename=\"test.gif\",\n        file=io.BytesIO(b\"GIF89a\"),  # Valid GIF signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"}),\n    )"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 56,
                                                    "end_token": 74,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 56,
                                                            "end_token": 56,
                                                            "children": [],
                                                            "label": "result"
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 58,
                                                            "end_token": 74,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 59,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 59,
                                                                            "end_token": 69,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 59,
                                                                                    "end_token": 59,
                                                                                    "children": [],
                                                                                    "label": "backend"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 61,
                                                                                    "end_token": 61,
                                                                                    "children": [],
                                                                                    "label": "server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "children": [],
                                                                                    "label": "v2"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 65,
                                                                                    "end_token": 65,
                                                                                    "children": [],
                                                                                    "label": "store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 67,
                                                                                    "children": [],
                                                                                    "label": "media"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 69,
                                                                                    "end_token": 69,
                                                                                    "children": [],
                                                                                    "label": "upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 70,
                                                                            "end_token": 74,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 71,
                                                                                    "end_token": 71,
                                                                                    "children": [],
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 73,
                                                                                    "end_token": 73,
                                                                                    "children": [],
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                },
                                                {
                                                    "type": "assert_statement",
                                                    "start_token": 76,
                                                    "end_token": 80,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 77,
                                                            "end_token": 80,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 77,
                                                                    "end_token": 77,
                                                                    "children": [],
                                                                    "label": "result"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 80,
                                                                    "end_token": 80,
                                                                    "children": [],
                                                                    "label": "\"http://test-url/media/laptop.jpeg\""
                                                                }
                                                            ],
                                                            "label": "result == \"http://test-url/media/laptop.jpeg\""
                                                        }
                                                    ],
                                                    "label": "assert result == \"http://test-url/media/laptop.jpeg\""
                                                }
                                            ],
                                            "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"test.gif\",\n        file=io.BytesIO(b\"GIF89a\"),  # Valid GIF signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                                        }
                                    ],
                                    "label": "async def test_upload_media_gif_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.gif\",\n        file=io.BytesIO(b\"GIF89a\"),  # Valid GIF signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                                }
                            ],
                            "label": "async def test_upload_media_gif_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.gif\",\n        file=io.BytesIO(b\"GIF89a\"),  # Valid GIF signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                        }
                    ],
                    "label": "async def test_upload_media_gif_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.gif\",\n        file=io.BytesIO(b\"GIF89a\"),  # Valid GIF signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/gif\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_webp_success",
            "start_line": 149,
            "end_line": 157,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 80,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 80,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "async"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "def"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 2,
                                    "end_token": 2,
                                    "label": "test_upload_media_webp_success"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 8,
                                    "end_token": 80,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 53,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 12,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 15,
                                                            "end_token": 53,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "\"test.webp\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"test.webp\""
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 22,
                                                                    "end_token": 30,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 24,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 24,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 27,
                                                                                    "end_token": 30,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 29,
                                                                                            "end_token": 29,
                                                                                            "label": "\"RIFF\\x00\\x00\\x00\\x00WEBP\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(b\"RIFF\\x00\\x00\\x00\\x00WEBP\")"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\")"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\")"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 37,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 39,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 39,
                                                                                    "end_token": 43,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 39,
                                                                                            "end_token": 41,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 39,
                                                                                                    "end_token": 39,
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 41,
                                                                                                    "end_token": 41,
                                                                                                    "label": "datastructures"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 43,
                                                                                            "end_token": 43,
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 44,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 45,
                                                                                            "end_token": 49,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 46,
                                                                                                    "end_token": 48,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 46,
                                                                                                            "end_token": 46,
                                                                                                            "label": "\"content-type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 48,
                                                                                                            "end_token": 48,
                                                                                                            "label": "\"image/webp\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"content-type\": \"image/webp\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"content-type\": \"image/webp\"}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"image/webp\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/webp\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/webp\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"test.webp\",\n        file=io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\"),  # Valid WebP signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/webp\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"test.webp\",\n        file=io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\"),  # Valid WebP signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/webp\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"test.webp\",\n        file=io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\"),  # Valid WebP signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/webp\"}),\n    )"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 56,
                                            "end_token": 74,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 56,
                                                    "end_token": 56,
                                                    "label": "result"
                                                },
                                                {
                                                    "type": "await",
                                                    "start_token": 58,
                                                    "end_token": 74,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 59,
                                                            "end_token": 74,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 59,
                                                                    "end_token": 69,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 59,
                                                                            "end_token": 67,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 59,
                                                                                    "end_token": 65,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 59,
                                                                                            "end_token": 63,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 59,
                                                                                                    "end_token": 61,
                                                                                                    "label": "backend.server"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 63,
                                                                                                    "end_token": 63,
                                                                                                    "label": "v2"
                                                                                                }
                                                                                            ],
                                                                                            "label": "backend.server.v2"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 65,
                                                                                            "end_token": 65,
                                                                                            "label": "store"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server.v2.store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 67,
                                                                                    "label": "media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 69,
                                                                            "end_token": 69,
                                                                            "label": "upload_media"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 70,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 71,
                                                                            "end_token": 71,
                                                                            "label": "\"test-user\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 73,
                                                                            "end_token": 73,
                                                                            "label": "test_file"
                                                                        }
                                                                    ],
                                                                    "label": "(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                        },
                                        {
                                            "type": "assert_statement",
                                            "start_token": 76,
                                            "end_token": 80,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 77,
                                                    "end_token": 79,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 77,
                                                            "end_token": 77,
                                                            "label": "result"
                                                        },
                                                        {
                                                            "type": "string",
                                                            "start_token": 80,
                                                            "end_token": 80,
                                                            "label": "\"http://test-url/media/laptop.jpeg\""
                                                        }
                                                    ],
                                                    "label": "result =="
                                                }
                                            ],
                                            "label": "assert result == \"http://test-url/media/laptop.jpeg\""
                                        }
                                    ],
                                    "label": ":\n    test_file = fastapi.UploadFile(\n        filename=\"test.webp\",\n        file=io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\"),  # Valid WebP signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/webp\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\""
                                }
                            ],
                            "label": "async def test_upload_media_webp_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.webp\",\n        file=io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\"),  # Valid WebP signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/webp\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\""
                        }
                    ],
                    "label": "async def test_upload_media_webp_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.webp\",\n        file=io.BytesIO(b\"RIFF\\x00\\x00\\x00\\x00WEBP\"),  # Valid WebP signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/webp\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\""
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_webm_success",
            "start_line": 160,
            "end_line": 168,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 81,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 81,
                            "children": [
                                {
                                    "type": "decorated_definition",
                                    "start_token": 0,
                                    "end_token": 81,
                                    "children": [
                                        {
                                            "type": "parameters",
                                            "start_token": 3,
                                            "end_token": 7,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "label": "mock_settings"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 6,
                                                    "end_token": 6,
                                                    "label": "mock_storage_client"
                                                }
                                            ],
                                            "label": "(mock_settings, mock_storage_client)"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 9,
                                            "end_token": 81,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 10,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 10,
                                                            "end_token": 10,
                                                            "label": "test_file"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 12,
                                                            "end_token": 53,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 12,
                                                                    "end_token": 14,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "label": "fastapi"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 14,
                                                                            "end_token": 14,
                                                                            "label": "UploadFile"
                                                                        }
                                                                    ],
                                                                    "label": "fastapi.UploadFile"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 15,
                                                                    "end_token": 53,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 17,
                                                                            "end_token": 20,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "label": "filename"
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "label": "\"test.webm\""
                                                                                }
                                                                            ],
                                                                            "label": "filename=\"test.webm\","
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 22,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 22,
                                                                                    "end_token": 22,
                                                                                    "label": "file"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 24,
                                                                                    "end_token": 30,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 24,
                                                                                            "end_token": 26,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 24,
                                                                                                    "end_token": 24,
                                                                                                    "label": "io"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 26,
                                                                                                    "end_token": 26,
                                                                                                    "label": "BytesIO"
                                                                                                }
                                                                                            ],
                                                                                            "label": "io.BytesIO"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 27,
                                                                                            "end_token": 30,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "bytes",
                                                                                                    "start_token": 28,
                                                                                                    "end_token": 29,
                                                                                                    "label": "b\"\\x1a\\x45\\xdf\\xa3\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(b\"\\x1a\\x45\\xdf\\xa3\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\")"
                                                                                }
                                                                            ],
                                                                            "label": "file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 37,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 37,
                                                                                    "end_token": 37,
                                                                                    "label": "headers"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 39,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 39,
                                                                                            "end_token": 43,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dotted_name",
                                                                                                    "start_token": 39,
                                                                                                    "end_token": 41,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 39,
                                                                                                            "end_token": 39,
                                                                                                            "label": "starlette"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 41,
                                                                                                            "end_token": 41,
                                                                                                            "label": "datastructures"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "starlette.datastructures"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 43,
                                                                                                    "end_token": 43,
                                                                                                    "label": "Headers"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures.Headers"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 44,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary",
                                                                                                    "start_token": 45,
                                                                                                    "end_token": 49,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 46,
                                                                                                            "end_token": 48,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 46,
                                                                                                                    "end_token": 46,
                                                                                                                    "label": "\"content-type\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 48,
                                                                                                                    "end_token": 48,
                                                                                                                    "label": "\"video/webm\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"content-type\": \"video/webm\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "{\"content-type\": \"video/webm\"}"
                                                                                                }
                                                                                            ],
                                                                                            "label": "({\"content-type\": \"video/webm\"})"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers({\"content-type\": \"video/webm\"})"
                                                                                }
                                                                            ],
                                                                            "label": "headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"})"
                                                                        }
                                                                    ],
                                                                    "label": "(\n        filename=\"test.webm\",\n        file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),  # Valid WebM signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"}),\n    )"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile(\n        filename=\"test.webm\",\n        file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),  # Valid WebM signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "test_file = fastapi.UploadFile(\n        filename=\"test.webm\",\n        file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),  # Valid WebM signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"}),\n    )"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 56,
                                                    "end_token": 74,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 56,
                                                            "end_token": 56,
                                                            "label": "result"
                                                        },
                                                        {
                                                            "type": "await",
                                                            "start_token": 58,
                                                            "end_token": 74,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 59,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 59,
                                                                            "end_token": 69,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 59,
                                                                                    "end_token": 67,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 59,
                                                                                            "end_token": 59,
                                                                                            "label": "backend"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 61,
                                                                                            "end_token": 61,
                                                                                            "label": "server"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 63,
                                                                                            "end_token": 63,
                                                                                            "label": "v2"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 65,
                                                                                            "end_token": 65,
                                                                                            "label": "store"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 67,
                                                                                            "end_token": 67,
                                                                                            "label": "media"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server.v2.store.media"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 69,
                                                                                    "end_token": 69,
                                                                                    "label": "upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 70,
                                                                            "end_token": 74,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 71,
                                                                                    "end_token": 71,
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 73,
                                                                                    "end_token": 73,
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                },
                                                {
                                                    "type": "assert_statement",
                                                    "start_token": 76,
                                                    "end_token": 80,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 77,
                                                            "end_token": 79,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 77,
                                                                    "end_token": 77,
                                                                    "label": "result"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 80,
                                                                    "end_token": 80,
                                                                    "label": "\"http://test-url/media/laptop.jpeg\""
                                                                }
                                                            ],
                                                            "label": "result =="
                                                        }
                                                    ],
                                                    "label": "assert result == \"http://test-url/media/laptop.jpeg\""
                                                }
                                            ],
                                            "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"test.webm\",\n        file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),  # Valid WebM signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                                        }
                                    ],
                                    "label": "async def test_upload_media_webm_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.webm\",\n        file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),  # Valid WebM signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                                }
                            ],
                            "label": "async def test_upload_media_webm_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.webm\",\n        file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),  # Valid WebM signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                        }
                    ],
                    "label": "async def test_upload_media_webm_success(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.webm\",\n        file=io.BytesIO(b\"\\x1a\\x45\\xdf\\xa3\"),  # Valid WebM signature\n        headers=starlette.datastructures.Headers({\"content-type\": \"video/webm\"}),\n    )\n\n    result = await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n    assert result == \"http://test-url/media/laptop.jpeg\"\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_mismatched_signature",
            "start_line": 171,
            "end_line": 179,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 95,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 95,
                            "children": [
                                {
                                    "type": "async",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "children": [],
                                    "label": "async"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "def"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 3,
                                    "end_token": 7,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 4,
                                            "end_token": 4,
                                            "children": [],
                                            "label": "mock_settings"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "children": [],
                                            "label": "mock_storage_client"
                                        }
                                    ],
                                    "label": "(mock_settings, mock_storage_client)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 95,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 56,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "children": [],
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 12,
                                                    "end_token": 56,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "children": [],
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 15,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 17,
                                                                    "end_token": 20,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "children": [],
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "children": [],
                                                                            "label": "\"test.jpeg\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"test.jpeg\","
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 22,
                                                                    "end_token": 37,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "children": [],
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 24,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 24,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "children": [],
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "children": [],
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 27,
                                                                                    "end_token": 30,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 29,
                                                                                            "end_token": 29,
                                                                                            "children": [],
                                                                                            "label": "\"\\x89PNG\\r\\n\\x1a\\n\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(b\"\\x89PNG\\r\\n\\x1a\\n\")"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\")"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # PNG signature with JPEG content"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 40,
                                                                    "end_token": 53,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 40,
                                                                            "end_token": 40,
                                                                            "children": [],
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 42,
                                                                            "end_token": 53,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 42,
                                                                                    "end_token": 46,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 42,
                                                                                            "end_token": 44,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 42,
                                                                                                    "end_token": 42,
                                                                                                    "children": [],
                                                                                                    "label": "starlette"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 44,
                                                                                                    "end_token": 44,
                                                                                                    "children": [],
                                                                                                    "label": "datastructures"
                                                                                                }
                                                                                            ],
                                                                                            "label": "starlette.datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 46,
                                                                                            "end_token": 46,
                                                                                            "children": [],
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 47,
                                                                                    "end_token": 53,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 48,
                                                                                            "end_token": 52,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 49,
                                                                                                    "end_token": 51,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 49,
                                                                                                            "end_token": 49,
                                                                                                            "children": [],
                                                                                                            "label": "\"content-type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 51,
                                                                                                            "end_token": 51,
                                                                                                            "children": [],
                                                                                                            "label": "\"image/jpeg\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"content-type\": \"image/jpeg\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"content-type\": \"image/jpeg\"}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"image/jpeg\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # PNG signature with JPEG content type\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # PNG signature with JPEG content type\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # PNG signature with JPEG content type\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                        },
                                        {
                                            "type": "with_statement",
                                            "start_token": 59,
                                            "end_token": 95,
                                            "children": [
                                                {
                                                    "type": "with_item",
                                                    "start_token": 59,
                                                    "end_token": 75,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 60,
                                                            "end_token": 75,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 60,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 60,
                                                                            "end_token": 62,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 60,
                                                                                    "end_token": 60,
                                                                                    "children": [],
                                                                                    "label": "pytest"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 62,
                                                                                    "end_token": 62,
                                                                                    "children": [],
                                                                                    "label": "raises"
                                                                                }
                                                                            ],
                                                                            "label": "pytest.raises"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 64,
                                                                            "end_token": 72,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 64,
                                                                                    "end_token": 66,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 64,
                                                                                            "end_token": 66,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 64,
                                                                                                    "end_token": 64,
                                                                                                    "children": [],
                                                                                                    "label": "backend"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 66,
                                                                                                    "end_token": 66,
                                                                                                    "children": [],
                                                                                                    "label": "server"
                                                                                                }
                                                                                            ],
                                                                                            "label": "backend.server"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 68,
                                                                                            "end_token": 68,
                                                                                            "children": [],
                                                                                            "label": "v2"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 70,
                                                                                    "end_token": 72,
                                                                                    "children": [],
                                                                                    "label": "store.exceptions"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.exceptions"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 74,
                                                                            "end_token": 74,
                                                                            "children": [],
                                                                            "label": "InvalidFileTypeError"
                                                                        }
                                                                    ],
                                                                    "label": "pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 63,
                                                                    "end_token": 75,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 74,
                                                                            "end_token": 74,
                                                                            "children": [],
                                                                            "label": "InvalidFileTypeError"
                                                                        }
                                                                    ],
                                                                    "label": "(backend.server.v2.store.exceptions.InvalidFileTypeError)"
                                                                }
                                                            ],
                                                            "label": "pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError)"
                                                        }
                                                    ],
                                                    "label": "with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 77,
                                                    "end_token": 95,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 78,
                                                            "end_token": 94,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 79,
                                                                    "end_token": 94,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 79,
                                                                            "end_token": 89,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 79,
                                                                                    "end_token": 81,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 79,
                                                                                            "end_token": 79,
                                                                                            "children": [],
                                                                                            "label": "backend"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 81,
                                                                                            "end_token": 81,
                                                                                            "children": [],
                                                                                            "label": "server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "backend.server"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 83,
                                                                                    "end_token": 85,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 83,
                                                                                            "end_token": 83,
                                                                                            "children": [],
                                                                                            "label": "v2"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 85,
                                                                                            "end_token": 85,
                                                                                            "children": [],
                                                                                            "label": "store"
                                                                                        }
                                                                                    ],
                                                                                    "label": "v2.store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 87,
                                                                                    "end_token": 89,
                                                                                    "children": [],
                                                                                    "label": "media.upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 90,
                                                                            "end_token": 94,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 91,
                                                                                    "end_token": 91,
                                                                                    "children": [],
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 93,
                                                                                    "end_token": 93,
                                                                                    "children": [],
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": "\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                                                }
                                            ],
                                            "label": "with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                                        }
                                    ],
                                    "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # PNG signature with JPEG content type\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                                }
                            ],
                            "label": "async def test_upload_media_mismatched_signature(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # PNG signature with JPEG content type\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                        }
                    ],
                    "label": "async def test_upload_media_mismatched_signature(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"\\x89PNG\\r\\n\\x1a\\n\"),  # PNG signature with JPEG content type\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "test_upload_media_invalid_signature",
            "start_line": 182,
            "end_line": 190,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 87,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 87,
                            "children": [
                                {
                                    "type": "block",
                                    "start_token": 9,
                                    "end_token": 87,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 10,
                                            "end_token": 49,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "label": "test_file"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 12,
                                                    "end_token": 49,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "label": "fastapi"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "UploadFile"
                                                                }
                                                            ],
                                                            "label": "fastapi.UploadFile"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 15,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "filename"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "\"test.jpeg\""
                                                                        }
                                                                    ],
                                                                    "label": "filename=\"test.jpeg\""
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 22,
                                                                    "end_token": 30,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "label": "file"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 24,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 24,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "label": "io"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "label": "BytesIO"
                                                                                        }
                                                                                    ],
                                                                                    "label": "io.BytesIO"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 27,
                                                                                    "end_token": 30,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 29,
                                                                                            "end_token": 29,
                                                                                            "label": "\"invalid signature\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(b\"invalid signature\")"
                                                                                }
                                                                            ],
                                                                            "label": "io.BytesIO(b\"invalid signature\")"
                                                                        }
                                                                    ],
                                                                    "label": "file=io.BytesIO(b\"invalid signature\")"
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 33,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 33,
                                                                            "end_token": 33,
                                                                            "label": "headers"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 35,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 35,
                                                                                    "end_token": 39,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 35,
                                                                                            "end_token": 35,
                                                                                            "label": "starlette"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 37,
                                                                                            "end_token": 37,
                                                                                            "label": "datastructures"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 39,
                                                                                            "end_token": 39,
                                                                                            "label": "Headers"
                                                                                        }
                                                                                    ],
                                                                                    "label": "starlette.datastructures.Headers"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 40,
                                                                                    "end_token": 46,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 41,
                                                                                            "end_token": 45,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 42,
                                                                                                    "end_token": 44,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 42,
                                                                                                            "end_token": 42,
                                                                                                            "label": "\"content-type\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 44,
                                                                                                            "end_token": 44,
                                                                                                            "label": "\"image/jpeg\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"content-type\": \"image/jpeg\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"content-type\": \"image/jpeg\"}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "({\"content-type\": \"image/jpeg\"})"
                                                                                }
                                                                            ],
                                                                            "label": "starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                        }
                                                                    ],
                                                                    "label": "headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"})"
                                                                }
                                                            ],
                                                            "label": "(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"invalid signature\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                        }
                                                    ],
                                                    "label": "fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"invalid signature\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                                }
                                            ],
                                            "label": "test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"invalid signature\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )"
                                        },
                                        {
                                            "type": "with_statement",
                                            "start_token": 52,
                                            "end_token": 87,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "start_token": 52,
                                                    "end_token": 68,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 53,
                                                            "end_token": 68,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 53,
                                                                    "end_token": 67,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 53,
                                                                            "end_token": 53,
                                                                            "label": "pytest"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 55,
                                                                            "end_token": 55,
                                                                            "label": "raises"
                                                                        },
                                                                        {
                                                                            "type": "dotted_name",
                                                                            "start_token": 57,
                                                                            "end_token": 67,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 57,
                                                                                    "end_token": 57,
                                                                                    "label": "backend"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 59,
                                                                                    "end_token": 59,
                                                                                    "label": "server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 61,
                                                                                    "end_token": 61,
                                                                                    "label": "v2"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "label": "store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 65,
                                                                                    "end_token": 67,
                                                                                    "label": "exceptions.InvalidFileTypeError"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.exceptions.InvalidFileTypeError"
                                                                        }
                                                                    ],
                                                                    "label": "pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError"
                                                                }
                                                            ],
                                                            "label": "pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError)"
                                                        }
                                                    ],
                                                    "label": "with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 69,
                                                    "end_token": 87,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 71,
                                                            "end_token": 87,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 72,
                                                                    "end_token": 87,
                                                                    "children": [
                                                                        {
                                                                            "type": "dotted_name",
                                                                            "start_token": 72,
                                                                            "end_token": 82,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 72,
                                                                                    "end_token": 72,
                                                                                    "label": "backend"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 74,
                                                                                    "end_token": 74,
                                                                                    "label": "server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 76,
                                                                                    "end_token": 76,
                                                                                    "label": "v2"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 78,
                                                                                    "end_token": 78,
                                                                                    "label": "store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 80,
                                                                                    "end_token": 82,
                                                                                    "label": "media.upload_media"
                                                                                }
                                                                            ],
                                                                            "label": "backend.server.v2.store.media.upload_media"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 83,
                                                                            "end_token": 87,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 84,
                                                                                    "end_token": 84,
                                                                                    "label": "\"test-user\""
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 86,
                                                                                    "end_token": 86,
                                                                                    "label": "test_file"
                                                                                }
                                                                            ],
                                                                            "label": "(\"test-user\", test_file)"
                                                                        }
                                                                    ],
                                                                    "label": "backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                                }
                                                            ],
                                                            "label": "await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                        }
                                                    ],
                                                    "label": ":\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                                }
                                            ],
                                            "label": "with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                        }
                                    ],
                                    "label": "\n    test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"invalid signature\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                                }
                            ],
                            "label": "async def test_upload_media_invalid_signature(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"invalid signature\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                        }
                    ],
                    "label": "async def test_upload_media_invalid_signature(mock_settings, mock_storage_client):\n    test_file = fastapi.UploadFile(\n        filename=\"test.jpeg\",\n        file=io.BytesIO(b\"invalid signature\"),\n        headers=starlette.datastructures.Headers({\"content-type\": \"image/jpeg\"}),\n    )\n\n    with pytest.raises(backend.server.v2.store.exceptions.InvalidFileTypeError):\n        await backend.server.v2.store.media.upload_media(\"test-user\", test_file)"
                }
            ]
        }
    ],
    "label": "import io\nimport unittest.mock\n\nimport fastapi\nimport pytest\nimport starlette.datastructures\n\nimport backend.server.v2.store.exceptions\nimport backend.server.v2.store.media\nfrom backend.util.settings import Settings\n\n\n@pytest.fixture\n\n\n@pytest.fixture\n"
}
{
    "type": "module",
    "start_token": 0,
    "end_token": 103,
    "children": [
        {
            "type": "import_statement",
            "start_token": 0,
            "end_token": 1,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 1,
                    "end_token": 1,
                    "children": [],
                    "label": "logging"
                }
            ],
            "label": "import logging"
        },
        {
            "type": "import_from_statement",
            "start_token": 4,
            "end_token": 18,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 5,
                    "end_token": 9,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 5,
                            "end_token": 5,
                            "children": [],
                            "label": "google"
                        },
                        {
                            "type": "identifier",
                            "start_token": 7,
                            "end_token": 7,
                            "children": [],
                            "label": "auth"
                        },
                        {
                            "type": "identifier",
                            "start_token": 9,
                            "end_token": 9,
                            "children": [],
                            "label": "external_account_authorized_user"
                        }
                    ],
                    "label": "google.auth.external_account_authorized_user"
                },
                {
                    "type": "aliased_import",
                    "start_token": 13,
                    "end_token": 15,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 13,
                            "end_token": 13,
                            "children": [],
                            "label": "Credentials"
                        },
                        {
                            "type": "identifier",
                            "start_token": 15,
                            "end_token": 15,
                            "children": [],
                            "label": "ExternalAccountCredentials"
                        }
                    ],
                    "label": "Credentials as ExternalAccountCredentials"
                }
            ],
            "label": "from google.auth.external_account_authorized_user import (\n    Credentials as ExternalAccountCredentials,\n)"
        },
        {
            "type": "import_from_statement",
            "start_token": 20,
            "end_token": 31,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 21,
                    "end_token": 27,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 21,
                            "end_token": 21,
                            "children": [],
                            "label": "google"
                        },
                        {
                            "type": "identifier",
                            "start_token": 23,
                            "end_token": 23,
                            "children": [],
                            "label": "auth"
                        },
                        {
                            "type": "identifier",
                            "start_token": 25,
                            "end_token": 25,
                            "children": [],
                            "label": "transport"
                        },
                        {
                            "type": "identifier",
                            "start_token": 27,
                            "end_token": 27,
                            "children": [],
                            "label": "requests"
                        }
                    ],
                    "label": "google.auth.transport.requests"
                },
                {
                    "type": "identifier",
                    "start_token": 29,
                    "end_token": 29,
                    "children": [],
                    "label": "AuthorizedSession"
                },
                {
                    "type": "identifier",
                    "start_token": 31,
                    "end_token": 31,
                    "children": [],
                    "label": "Request"
                }
            ],
            "label": "from google.auth.transport.requests import AuthorizedSession, Request"
        },
        {
            "type": "import_from_statement",
            "start_token": 33,
            "end_token": 40,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 34,
                    "end_token": 38,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 34,
                            "end_token": 34,
                            "children": [],
                            "label": "google"
                        },
                        {
                            "type": "identifier",
                            "start_token": 36,
                            "end_token": 36,
                            "children": [],
                            "label": "oauth2"
                        },
                        {
                            "type": "identifier",
                            "start_token": 38,
                            "end_token": 38,
                            "children": [],
                            "label": "credentials"
                        }
                    ],
                    "label": "google.oauth2.credentials"
                },
                {
                    "type": "identifier",
                    "start_token": 40,
                    "end_token": 40,
                    "children": [],
                    "label": "Credentials"
                }
            ],
            "label": "from google.oauth2.credentials import Credentials"
        },
        {
            "type": "import_from_statement",
            "start_token": 42,
            "end_token": 47,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 43,
                    "end_token": 45,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 43,
                            "end_token": 43,
                            "children": [],
                            "label": "google_auth_oauthlib"
                        },
                        {
                            "type": "identifier",
                            "start_token": 45,
                            "end_token": 45,
                            "children": [],
                            "label": "flow"
                        }
                    ],
                    "label": "google_auth_oauthlib.flow"
                },
                {
                    "type": "identifier",
                    "start_token": 47,
                    "end_token": 47,
                    "children": [],
                    "label": "Flow"
                }
            ],
            "label": "from google_auth_oauthlib.flow import Flow"
        },
        {
            "type": "import_from_statement",
            "start_token": 49,
            "end_token": 52,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 50,
                    "end_token": 50,
                    "children": [],
                    "label": "pydantic"
                },
                {
                    "type": "identifier",
                    "start_token": 52,
                    "end_token": 52,
                    "children": [],
                    "label": "SecretStr"
                }
            ],
            "label": "from pydantic import SecretStr"
        },
        {
            "type": "import_from_statement",
            "start_token": 55,
            "end_token": 62,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 56,
                    "end_token": 60,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 56,
                            "end_token": 56,
                            "children": [],
                            "label": "backend"
                        },
                        {
                            "type": "identifier",
                            "start_token": 58,
                            "end_token": 58,
                            "children": [],
                            "label": "data"
                        },
                        {
                            "type": "identifier",
                            "start_token": 60,
                            "end_token": 60,
                            "children": [],
                            "label": "model"
                        }
                    ],
                    "label": "backend.data.model"
                },
                {
                    "type": "identifier",
                    "start_token": 62,
                    "end_token": 62,
                    "children": [],
                    "label": "OAuth2Credentials"
                }
            ],
            "label": "from backend.data.model import OAuth2Credentials"
        },
        {
            "type": "import_from_statement",
            "start_token": 64,
            "end_token": 71,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 65,
                    "end_token": 69,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 65,
                            "end_token": 65,
                            "children": [],
                            "label": "backend"
                        },
                        {
                            "type": "identifier",
                            "start_token": 67,
                            "end_token": 67,
                            "children": [],
                            "label": "integrations"
                        },
                        {
                            "type": "identifier",
                            "start_token": 69,
                            "end_token": 69,
                            "children": [],
                            "label": "providers"
                        }
                    ],
                    "label": "backend.integrations.providers"
                },
                {
                    "type": "identifier",
                    "start_token": 71,
                    "end_token": 71,
                    "children": [],
                    "label": "ProviderName"
                }
            ],
            "label": "from backend.integrations.providers import ProviderName"
        },
        {
            "type": "relative_import",
            "start_token": 74,
            "end_token": 78,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 76,
                    "end_token": 76,
                    "children": [],
                    "label": "base"
                },
                {
                    "type": "identifier",
                    "start_token": 78,
                    "end_token": 78,
                    "children": [],
                    "label": "BaseOAuthHandler"
                }
            ],
            "label": "from .base import BaseOAuthHandler"
        },
        {
            "type": "assignment",
            "start_token": 81,
            "end_token": 88,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 81,
                    "end_token": 81,
                    "children": [],
                    "label": "logger"
                },
                {
                    "type": "call",
                    "start_token": 85,
                    "end_token": 88,
                    "children": [
                        {
                            "type": "attribute",
                            "start_token": 83,
                            "end_token": 85,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 83,
                                    "end_token": 83,
                                    "children": [],
                                    "label": "logging"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 85,
                                    "end_token": 85,
                                    "children": [],
                                    "label": "getLogger"
                                }
                            ],
                            "label": "logging.getLogger"
                        },
                        {
                            "type": "argument_list",
                            "start_token": 86,
                            "end_token": 87,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 87,
                                    "end_token": 87,
                                    "children": [],
                                    "label": "__name__"
                                }
                            ],
                            "label": "(__name__"
                        }
                    ],
                    "label": "getLogger(__name__)"
                }
            ],
            "label": "logger = logging.getLogger(__name__)"
        },
        {
            "type": "comment",
            "start_token": 92,
            "end_token": 103,
            "children": [],
            "label": "# --8<-- [start:GoogleOAuthHandlerExample]"
        },
        {
            "type": "class_placeholder",
            "name": "GoogleOAuthHandler",
            "start_line": 20,
            "end_line": 169,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 50,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 5,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "label": "class"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "GoogleOAuthHandler"
                                },
                                {
                                    "type": "argument_list",
                                    "start_token": 2,
                                    "end_token": 4,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 3,
                                            "end_token": 3,
                                            "label": "BaseOAuthHandler"
                                        }
                                    ],
                                    "label": "(BaseOAuthHandler)"
                                }
                            ],
                            "label": "class GoogleOAuthHandler(BaseOAuthHandler):"
                        },
                        {
                            "type": "string",
                            "start_token": 7,
                            "end_token": 9,
                            "label": "\"\"\"\n    Based on the documentation at https://developers.google.com/identity/protocols/oauth2/web-server\n    \"\"\""
                        },
                        {
                            "type": "comment",
                            "start_token": 10,
                            "end_token": 11,
                            "label": "# noqa"
                        },
                        {
                            "type": "assignment",
                            "start_token": 14,
                            "end_token": 18,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 14,
                                    "end_token": 14,
                                    "label": "PROVIDER_NAME"
                                },
                                {
                                    "type": "attribute",
                                    "start_token": 16,
                                    "end_token": 18,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 16,
                                            "end_token": 16,
                                            "label": "ProviderName"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 18,
                                            "end_token": 18,
                                            "label": "GOOGLE"
                                        }
                                    ],
                                    "label": "ProviderName.GOOGLE"
                                }
                            ],
                            "label": "PROVIDER_NAME = ProviderName.GOOGLE"
                        },
                        {
                            "type": "assignment",
                            "start_token": 20,
                            "end_token": 22,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 20,
                                    "end_token": 20,
                                    "label": "EMAIL_ENDPOINT"
                                },
                                {
                                    "type": "string",
                                    "start_token": 22,
                                    "end_token": 22,
                                    "label": "\"https://www.googleapis.com/oauth2/v2/userinfo\""
                                }
                            ],
                            "label": "EMAIL_ENDPOINT = \"https://www.googleapis.com/oauth2/v2/userinfo\""
                        },
                        {
                            "type": "assignment",
                            "start_token": 24,
                            "end_token": 37,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 24,
                                    "end_token": 24,
                                    "label": "DEFAULT_SCOPES"
                                },
                                {
                                    "type": "list",
                                    "start_token": 26,
                                    "end_token": 37,
                                    "children": [
                                        {
                                            "type": "string",
                                            "start_token": 28,
                                            "end_token": 28,
                                            "label": "\"https://www.googleapis.com/auth/userinfo.email\""
                                        },
                                        {
                                            "type": "string",
                                            "start_token": 31,
                                            "end_token": 31,
                                            "label": "\"https://www.googleapis.com/auth/userinfo.profile\""
                                        },
                                        {
                                            "type": "string",
                                            "start_token": 34,
                                            "end_token": 34,
                                            "label": "\"openid\""
                                        }
                                    ],
                                    "label": "[\n        \"https://www.googleapis.com/auth/userinfo.email\",\n        \"https://www.googleapis.com/auth/userinfo.profile\",\n        \"openid\",\n    ]"
                                }
                            ],
                            "label": "DEFAULT_SCOPES = [\n        \"https://www.googleapis.com/auth/userinfo.email\",\n        \"https://www.googleapis.com/auth/userinfo.profile\",\n        \"openid\",\n    ]"
                        },
                        {
                            "type": "comment",
                            "start_token": 39,
                            "end_token": 50,
                            "label": "# --8<-- [end:GoogleOAuthHandlerExample]"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__init__",
                            "start_line": 34,
                            "end_line": 39,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 47,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 47,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "__init__"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 16,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": "client_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "client_secret: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 13,
                                                            "end_token": 15,
                                                            "children": [],
                                                            "label": "redirect_uri: str"
                                                        }
                                                    ],
                                                    "label": "(self, client_id: str, client_secret: str, redirect_uri: str)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 18,
                                                    "end_token": 47,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 19,
                                                            "end_token": 23,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 19,
                                                                    "end_token": 21,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "children": [],
                                                                            "label": "client_id"
                                                                        }
                                                                    ],
                                                                    "label": "self.client_id"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "children": [],
                                                                    "label": "client_id"
                                                                }
                                                            ],
                                                            "label": "self.client_id = client_id"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 25,
                                                            "end_token": 29,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 25,
                                                                    "end_token": 27,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 25,
                                                                            "end_token": 25,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "children": [],
                                                                            "label": "client_secret"
                                                                        }
                                                                    ],
                                                                    "label": "self.client_secret"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 29,
                                                                    "end_token": 29,
                                                                    "children": [],
                                                                    "label": "client_secret"
                                                                }
                                                            ],
                                                            "label": "self.client_secret = client_secret"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 31,
                                                            "end_token": 35,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 31,
                                                                    "end_token": 33,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 31,
                                                                            "end_token": 31,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 33,
                                                                            "end_token": 33,
                                                                            "children": [],
                                                                            "label": "redirect_uri"
                                                                        }
                                                                    ],
                                                                    "label": "self.redirect_uri"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 35,
                                                                    "end_token": 35,
                                                                    "children": [],
                                                                    "label": "redirect_uri"
                                                                }
                                                            ],
                                                            "label": "self.redirect_uri = redirect_uri"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 37,
                                                            "end_token": 41,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 37,
                                                                    "end_token": 39,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 39,
                                                                            "end_token": 39,
                                                                            "children": [],
                                                                            "label": "token_uri"
                                                                        }
                                                                    ],
                                                                    "label": "self.token_uri"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 41,
                                                                    "end_token": 41,
                                                                    "children": [],
                                                                    "label": "\"https://oauth2.googleapis.com/token\""
                                                                }
                                                            ],
                                                            "label": "self.token_uri = \"https://oauth2.googleapis.com/token\""
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 43,
                                                            "end_token": 47,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 43,
                                                                    "end_token": 45,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 43,
                                                                            "end_token": 43,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 45,
                                                                            "end_token": 45,
                                                                            "children": [],
                                                                            "label": "revoke_uri"
                                                                        }
                                                                    ],
                                                                    "label": "self.revoke_uri"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 47,
                                                                    "end_token": 47,
                                                                    "children": [],
                                                                    "label": "\"https://oauth2.googleapis.com/revoke\""
                                                                }
                                                            ],
                                                            "label": "self.revoke_uri = \"https://oauth2.googleapis.com/revoke\""
                                                        }
                                                    ],
                                                    "label": "\n        self.client_id = client_id\n        self.client_secret = client_secret\n        self.redirect_uri = redirect_uri\n        self.token_uri = \"https://oauth2.googleapis.com/token\"\n        self.revoke_uri = \"https://oauth2.googleapis.com/revoke\""
                                                }
                                            ],
                                            "label": "def __init__(self, client_id: str, client_secret: str, redirect_uri: str):\n        self.client_id = client_id\n        self.client_secret = client_secret\n        self.redirect_uri = redirect_uri\n        self.token_uri = \"https://oauth2.googleapis.com/token\"\n        self.revoke_uri = \"https://oauth2.googleapis.com/revoke\""
                                        }
                                    ],
                                    "label": "def __init__(self, client_id: str, client_secret: str, redirect_uri: str):\n        self.client_id = client_id\n        self.client_secret = client_secret\n        self.redirect_uri = redirect_uri\n        self.token_uri = \"https://oauth2.googleapis.com/token\"\n        self.revoke_uri = \"https://oauth2.googleapis.com/revoke\""
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_login_url",
                            "start_line": 41,
                            "end_line": 52,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 92,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 92,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "get_login_url"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 15,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 10,
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "start_token": 7,
                                                                    "end_token": 10,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "label": "str"
                                                                        }
                                                                    ],
                                                                    "label": "list[str]"
                                                                }
                                                            ],
                                                            "label": "scopes: list[str]"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "state: str"
                                                        }
                                                    ],
                                                    "label": "(self, scopes: list[str], state: str)"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 17,
                                                    "end_token": 18,
                                                    "label": "> str"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 20,
                                                    "end_token": 92,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 21,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 21,
                                                                    "end_token": 21,
                                                                    "label": "all_scopes"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 23,
                                                                    "end_token": 33,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 23,
                                                                            "end_token": 23,
                                                                            "label": "list"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 25,
                                                                            "end_token": 32,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "label": "set"
                                                                                },
                                                                                {
                                                                                    "type": "binary_operator",
                                                                                    "start_token": 27,
                                                                                    "end_token": 31,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 27,
                                                                                            "end_token": 27,
                                                                                            "label": "scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 29,
                                                                                            "end_token": 31,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 29,
                                                                                                    "end_token": 29,
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 31,
                                                                                                    "end_token": 31,
                                                                                                    "label": "DEFAULT_SCOPES"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.DEFAULT_SCOPES"
                                                                                        }
                                                                                    ],
                                                                                    "label": "scopes + self.DEFAULT_SCOPES"
                                                                                }
                                                                            ],
                                                                            "label": "set(scopes + self.DEFAULT_SCOPES)"
                                                                        }
                                                                    ],
                                                                    "label": "list(set(scopes + self.DEFAULT_SCOPES))"
                                                                }
                                                            ],
                                                            "label": "all_scopes = list(set(scopes + self.DEFAULT_SCOPES))"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 35,
                                                            "end_token": 41,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 35,
                                                                    "end_token": 37,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 35,
                                                                            "end_token": 35,
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "label": "debug"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug"
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 39,
                                                                    "end_token": 40,
                                                                    "children": [
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 39,
                                                                            "end_token": 40,
                                                                            "label": "f\"Setting up OAuth flow with scopes: {all_scopes}\""
                                                                        }
                                                                    ],
                                                                    "label": "f\"Setting up OAuth flow with scopes: {all_scopes}\""
                                                                }
                                                            ],
                                                            "label": "logger.debug(f\"Setting up OAuth flow with scopes: {all_scopes}\")"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 43,
                                                            "end_token": 50,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 43,
                                                                    "end_token": 43,
                                                                    "label": "flow"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 45,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 45,
                                                                            "end_token": 47,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 45,
                                                                                    "end_token": 45,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 47,
                                                                                    "end_token": 47,
                                                                                    "label": "_setup_oauth_flow"
                                                                                }
                                                                            ],
                                                                            "label": "self._setup_oauth_flow"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 49,
                                                                            "end_token": 49,
                                                                            "label": "all_scopes"
                                                                        }
                                                                    ],
                                                                    "label": "self._setup_oauth_flow(all_scopes)"
                                                                }
                                                            ],
                                                            "label": "flow = self._setup_oauth_flow(all_scopes)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 52,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 52,
                                                                    "end_token": 54,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 52,
                                                                            "end_token": 52,
                                                                            "label": "flow"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 54,
                                                                            "end_token": 54,
                                                                            "label": "redirect_uri"
                                                                        }
                                                                    ],
                                                                    "label": "flow.redirect_uri"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 56,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 56,
                                                                            "end_token": 56,
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 58,
                                                                            "end_token": 58,
                                                                            "label": "redirect_uri"
                                                                        }
                                                                    ],
                                                                    "label": "self.redirect_uri"
                                                                }
                                                            ],
                                                            "label": "flow.redirect_uri = self.redirect_uri"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 60,
                                                            "end_token": 89,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 60,
                                                                    "end_token": 60,
                                                                    "label": "authorization_url"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 64,
                                                                    "end_token": 89,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 64,
                                                                            "end_token": 66,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 64,
                                                                                    "end_token": 64,
                                                                                    "label": "flow"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 66,
                                                                                    "end_token": 66,
                                                                                    "label": "authorization_url"
                                                                                }
                                                                            ],
                                                                            "label": "flow.authorization_url"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 68,
                                                                            "end_token": 89,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 69,
                                                                                    "end_token": 71,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 69,
                                                                                            "end_token": 69,
                                                                                            "label": "access_type"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 71,
                                                                                            "end_token": 71,
                                                                                            "label": "\"offline\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "access_type=\"offline\""
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 74,
                                                                                    "end_token": 76,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 74,
                                                                                            "end_token": 74,
                                                                                            "label": "include_granted_scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 76,
                                                                                            "end_token": 76,
                                                                                            "label": "\"true\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "include_granted_scopes=\"true\""
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 79,
                                                                                    "end_token": 81,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 79,
                                                                                            "end_token": 79,
                                                                                            "label": "state"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 81,
                                                                                            "end_token": 81,
                                                                                            "label": "state"
                                                                                        }
                                                                                    ],
                                                                                    "label": "state=state"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 84,
                                                                                    "end_token": 86,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 84,
                                                                                            "end_token": 84,
                                                                                            "label": "prompt"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 86,
                                                                                            "end_token": 86,
                                                                                            "label": "\"consent\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "prompt=\"consent\""
                                                                                }
                                                                            ],
                                                                            "label": "\n            access_type=\"offline\",\n            include_granted_scopes=\"true\",\n            state=state,\n            prompt=\"consent\",\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "flow.authorization_url(\n            access_type=\"offline\",\n            include_granted_scopes=\"true\",\n            state=state,\n            prompt=\"consent\",\n        )"
                                                                }
                                                            ],
                                                            "label": "authorization_url, _ = flow.authorization_url(\n            access_type=\"offline\",\n            include_granted_scopes=\"true\",\n            state=state,\n            prompt=\"consent\",\n        )"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 91,
                                                            "end_token": 92,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 92,
                                                                    "end_token": 92,
                                                                    "label": "authorization_url"
                                                                }
                                                            ],
                                                            "label": "return authorization_url"
                                                        }
                                                    ],
                                                    "label": "\n        all_scopes = list(set(scopes + self.DEFAULT_SCOPES))\n        logger.debug(f\"Setting up OAuth flow with scopes: {all_scopes}\")\n        flow = self._setup_oauth_flow(all_scopes)\n        flow.redirect_uri = self.redirect_uri\n        authorization_url, _ = flow.authorization_url(\n            access_type=\"offline\",\n            include_granted_scopes=\"true\",\n            state=state,\n            prompt=\"consent\",\n        )\n        return authorization_url"
                                                }
                                            ],
                                            "label": "def get_login_url(self, scopes: list[str], state: str) -> str:\n        all_scopes = list(set(scopes + self.DEFAULT_SCOPES))\n        logger.debug(f\"Setting up OAuth flow with scopes: {all_scopes}\")\n        flow = self._setup_oauth_flow(all_scopes)\n        flow.redirect_uri = self.redirect_uri\n        authorization_url, _ = flow.authorization_url(\n            access_type=\"offline\",\n            include_granted_scopes=\"true\",\n            state=state,\n            prompt=\"consent\",\n        )\n        return authorization_url"
                                        }
                                    ],
                                    "label": "def get_login_url(self, scopes: list[str], state: str) -> str:\n        all_scopes = list(set(scopes + self.DEFAULT_SCOPES))\n        logger.debug(f\"Setting up OAuth flow with scopes: {all_scopes}\")\n        flow = self._setup_oauth_flow(all_scopes)\n        flow.redirect_uri = self.redirect_uri\n        authorization_url, _ = flow.authorization_url(\n            access_type=\"offline\",\n            include_granted_scopes=\"true\",\n            state=state,\n            prompt=\"consent\",\n        )\n        return authorization_url"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "exchange_code_for_tokens",
                            "start_line": 54,
                            "end_line": 104,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 297,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 297,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "exchange_code_for_tokens"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 8,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 8,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 8,
                                                                            "end_token": 8,
                                                                            "children": [],
                                                                            "label": "str"
                                                                        }
                                                                    ],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "self, code: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 10,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 10,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": "scopes"
                                                                },
                                                                {
                                                                    "type": "generic_type",
                                                                    "start_token": 12,
                                                                    "end_token": 15,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "children": [],
                                                                            "label": "list"
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 14,
                                                                            "end_token": 15,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 14,
                                                                                    "end_token": 14,
                                                                                    "children": [],
                                                                                    "label": "str"
                                                                                }
                                                                            ],
                                                                            "label": "str]"
                                                                        }
                                                                    ],
                                                                    "label": "list[str]"
                                                                }
                                                            ],
                                                            "label": "scopes: list[str]"
                                                        }
                                                    ],
                                                    "label": "(\n        self, code: str, scopes: list[str]\n    )"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 19,
                                                    "end_token": 20,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 20,
                                                            "end_token": 20,
                                                            "children": [],
                                                            "label": "OAuth2Credentials"
                                                        }
                                                    ],
                                                    "label": "> OAuth2Credentials"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 21,
                                                    "end_token": 297,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 23,
                                                            "end_token": 29,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 23,
                                                                    "end_token": 29,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 23,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 26,
                                                                            "end_token": 29,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 28,
                                                                                            "end_token": 28,
                                                                                            "children": [],
                                                                                            "label": "\"Exchanging code for tokens with scopes: {scopes}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "\"Exchanging code for tokens with scopes: {scopes}\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"Exchanging code for tokens with scopes: {scopes}\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(f\"Exchanging code for tokens with scopes: {scopes}\")"
                                                                }
                                                            ],
                                                            "label": "logger.debug(f\"Exchanging code for tokens with scopes: {scopes}\")"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 32,
                                                            "end_token": 40,
                                                            "children": [],
                                                            "label": "# Use the scopes from the initial request\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 41,
                                                            "end_token": 48,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 41,
                                                                    "end_token": 41,
                                                                    "children": [],
                                                                    "label": "flow"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 43,
                                                                    "end_token": 48,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 43,
                                                                            "end_token": 45,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 43,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 45,
                                                                                    "end_token": 45,
                                                                                    "children": [],
                                                                                    "label": "_setup_oauth_flow"
                                                                                }
                                                                            ],
                                                                            "label": "self._setup_oauth_flow"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 46,
                                                                            "end_token": 48,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 47,
                                                                                    "end_token": 47,
                                                                                    "children": [],
                                                                                    "label": "scopes"
                                                                                }
                                                                            ],
                                                                            "label": "(scopes)"
                                                                        }
                                                                    ],
                                                                    "label": "self._setup_oauth_flow(scopes)"
                                                                }
                                                            ],
                                                            "label": "flow = self._setup_oauth_flow(scopes)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 50,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 50,
                                                                    "end_token": 52,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 50,
                                                                            "end_token": 50,
                                                                            "children": [],
                                                                            "label": "flow"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 52,
                                                                            "end_token": 52,
                                                                            "children": [],
                                                                            "label": "redirect_uri"
                                                                        }
                                                                    ],
                                                                    "label": "flow.redirect_uri"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 54,
                                                                    "end_token": 56,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 54,
                                                                            "end_token": 54,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 56,
                                                                            "end_token": 56,
                                                                            "children": [],
                                                                            "label": "redirect_uri"
                                                                        }
                                                                    ],
                                                                    "label": "self.redirect_uri"
                                                                }
                                                            ],
                                                            "label": "flow.redirect_uri = self.redirect_uri"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 59,
                                                            "end_token": 64,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 59,
                                                                    "end_token": 64,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 59,
                                                                            "end_token": 61,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 59,
                                                                                    "end_token": 59,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 61,
                                                                                    "end_token": 61,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 62,
                                                                            "end_token": 64,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "children": [],
                                                                                    "label": "\"Fetching token from Google\""
                                                                                }
                                                                            ],
                                                                            "label": "(\"Fetching token from Google\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(\"Fetching token from Google\")"
                                                                }
                                                            ],
                                                            "label": "logger.debug(\"Fetching token from Google\")"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 67,
                                                            "end_token": 73,
                                                            "children": [],
                                                            "label": "# Disable scope check in fetch_token\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 74,
                                                            "end_token": 80,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 74,
                                                                    "end_token": 78,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 74,
                                                                            "end_token": 76,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 74,
                                                                                    "end_token": 74,
                                                                                    "children": [],
                                                                                    "label": "flow"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 76,
                                                                                    "end_token": 76,
                                                                                    "children": [],
                                                                                    "label": "oauth2session"
                                                                                }
                                                                            ],
                                                                            "label": "flow.oauth2session"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 78,
                                                                            "end_token": 78,
                                                                            "children": [],
                                                                            "label": "scope"
                                                                        }
                                                                    ],
                                                                    "label": "flow.oauth2session.scope"
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 80,
                                                                    "end_token": 80,
                                                                    "children": [],
                                                                    "label": "None"
                                                                }
                                                            ],
                                                            "label": "flow.oauth2session.scope = None"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 82,
                                                            "end_token": 91,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 82,
                                                                    "end_token": 82,
                                                                    "children": [],
                                                                    "label": "token"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 84,
                                                                    "end_token": 91,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 84,
                                                                            "end_token": 86,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 84,
                                                                                    "end_token": 84,
                                                                                    "children": [],
                                                                                    "label": "flow"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 86,
                                                                                    "end_token": 86,
                                                                                    "children": [],
                                                                                    "label": "fetch_token"
                                                                                }
                                                                            ],
                                                                            "label": "flow.fetch_token"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 87,
                                                                            "end_token": 91,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 88,
                                                                                    "end_token": 90,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 88,
                                                                                            "end_token": 88,
                                                                                            "children": [],
                                                                                            "label": "code"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 90,
                                                                                            "end_token": 90,
                                                                                            "children": [],
                                                                                            "label": "code"
                                                                                        }
                                                                                    ],
                                                                                    "label": "code=code"
                                                                                }
                                                                            ],
                                                                            "label": "(code=code)"
                                                                        }
                                                                    ],
                                                                    "label": "flow.fetch_token(code=code)"
                                                                }
                                                            ],
                                                            "label": "token = flow.fetch_token(code=code)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 93,
                                                            "end_token": 98,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 93,
                                                                    "end_token": 98,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 93,
                                                                            "end_token": 95,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 93,
                                                                                    "end_token": 93,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 95,
                                                                                    "end_token": 95,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 96,
                                                                            "end_token": 98,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 97,
                                                                                    "end_token": 97,
                                                                                    "children": [],
                                                                                    "label": "\"Token fetched successfully\""
                                                                                }
                                                                            ],
                                                                            "label": "(\"Token fetched successfully\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(\"Token fetched successfully\")"
                                                                }
                                                            ],
                                                            "label": "logger.debug(\"Token fetched successfully\")"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 101,
                                                            "end_token": 109,
                                                            "children": [],
                                                            "label": "# Get the actual scopes granted by Google\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 110,
                                                            "end_token": 125,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 110,
                                                                    "end_token": 110,
                                                                    "children": [],
                                                                    "label": "granted_scopes"
                                                                },
                                                                {
                                                                    "type": "generic_type",
                                                                    "start_token": 112,
                                                                    "end_token": 115,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 112,
                                                                            "end_token": 112,
                                                                            "children": [],
                                                                            "label": "list"
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 114,
                                                                            "end_token": 115,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 114,
                                                                                    "end_token": 114,
                                                                                    "children": [],
                                                                                    "label": "str"
                                                                                }
                                                                            ],
                                                                            "label": "str]"
                                                                        }
                                                                    ],
                                                                    "label": "list[str]"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 117,
                                                                    "end_token": 125,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 117,
                                                                            "end_token": 119,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 117,
                                                                                    "end_token": 117,
                                                                                    "children": [],
                                                                                    "label": "token"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 119,
                                                                                    "end_token": 119,
                                                                                    "children": [],
                                                                                    "label": "get"
                                                                                }
                                                                            ],
                                                                            "label": "token.get"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 120,
                                                                            "end_token": 125,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 121,
                                                                                    "end_token": 121,
                                                                                    "children": [],
                                                                                    "label": "\"scope\""
                                                                                },
                                                                                {
                                                                                    "type": "list",
                                                                                    "start_token": 123,
                                                                                    "end_token": 124,
                                                                                    "children": [],
                                                                                    "label": "[]"
                                                                                }
                                                                            ],
                                                                            "label": "(\"scope\", [])"
                                                                        }
                                                                    ],
                                                                    "label": "token.get(\"scope\", [])"
                                                                }
                                                            ],
                                                            "label": "granted_scopes: list[str] = token.get(\"scope\", [])"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 128,
                                                            "end_token": 134,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 128,
                                                                    "end_token": 134,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 128,
                                                                            "end_token": 130,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 128,
                                                                                    "end_token": 128,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 130,
                                                                                    "end_token": 130,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 131,
                                                                            "end_token": 134,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 133,
                                                                                    "end_token": 133,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 133,
                                                                                            "end_token": 133,
                                                                                            "children": [],
                                                                                            "label": "\"Scopes granted by Google: {granted_scopes}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "\"Scopes granted by Google: {granted_scopes}\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"Scopes granted by Google: {granted_scopes}\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(f\"Scopes granted by Google: {granted_scopes}\")"
                                                                }
                                                            ],
                                                            "label": "logger.debug(f\"Scopes granted by Google: {granted_scopes}\")"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 137,
                                                            "end_token": 142,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 137,
                                                                    "end_token": 137,
                                                                    "children": [],
                                                                    "label": "google_creds"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 139,
                                                                    "end_token": 141,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 139,
                                                                            "end_token": 139,
                                                                            "children": [],
                                                                            "label": "flow"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 141,
                                                                            "end_token": 141,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        }
                                                                    ],
                                                                    "label": "flow.credentials"
                                                                }
                                                            ],
                                                            "label": "google_creds = flow.credentials\n"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 144,
                                                            "end_token": 149,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 144,
                                                                    "end_token": 149,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 144,
                                                                            "end_token": 146,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 144,
                                                                                    "end_token": 144,
                                                                                    "children": [],
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 146,
                                                                                    "end_token": 146,
                                                                                    "children": [],
                                                                                    "label": "("
                                                                                }
                                                                            ],
                                                                            "label": ".debug("
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 147,
                                                                            "end_token": 149,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 148,
                                                                                    "end_token": 148,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 148,
                                                                                            "end_token": 148,
                                                                                            "children": [],
                                                                                            "label": "\"Received credentials: {google_creds}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "\"Received credentials: {google_creds}\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"Received credentials: {google_creds}\")"
                                                                        }
                                                                    ],
                                                                    "label": ".debug(f\"Received credentials: {google_creds}\")"
                                                                }
                                                            ],
                                                            "label": ".debug(f\"Received credentials: {google_creds}\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 152,
                                                            "end_token": 157,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 152,
                                                                    "end_token": 157,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 152,
                                                                            "end_token": 154,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 152,
                                                                                    "end_token": 152,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 154,
                                                                                    "end_token": 154,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 155,
                                                                            "end_token": 157,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 156,
                                                                                    "end_token": 156,
                                                                                    "children": [],
                                                                                    "label": "\"Requesting user email\""
                                                                                }
                                                                            ],
                                                                            "label": "(\"Requesting user email\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(\"Requesting user email\")"
                                                                }
                                                            ],
                                                            "label": "logger.debug(\"Requesting user email\")"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 159,
                                                            "end_token": 166,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 159,
                                                                    "end_token": 159,
                                                                    "children": [],
                                                                    "label": "username"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 161,
                                                                    "end_token": 166,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 161,
                                                                            "end_token": 163,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 161,
                                                                                    "end_token": 161,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 163,
                                                                                    "end_token": 163,
                                                                                    "children": [],
                                                                                    "label": "_request_email"
                                                                                }
                                                                            ],
                                                                            "label": "self._request_email"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 164,
                                                                            "end_token": 166,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 165,
                                                                                    "end_token": 165,
                                                                                    "children": [],
                                                                                    "label": "google_creds"
                                                                                }
                                                                            ],
                                                                            "label": "(google_creds)"
                                                                        }
                                                                    ],
                                                                    "label": "self._request_email(google_creds)"
                                                                }
                                                            ],
                                                            "label": "username = self._request_email(google_creds)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 169,
                                                            "end_token": 174,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 169,
                                                                    "end_token": 174,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 169,
                                                                            "end_token": 171,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 169,
                                                                                    "end_token": 169,
                                                                                    "children": [],
                                                                                    "label": "."
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 171,
                                                                                    "end_token": 171,
                                                                                    "children": [],
                                                                                    "label": "("
                                                                                }
                                                                            ],
                                                                            "label": ".debug("
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 172,
                                                                            "end_token": 174,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 173,
                                                                                    "end_token": 173,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 173,
                                                                                            "end_token": 173,
                                                                                            "children": [],
                                                                                            "label": "\"User email retrieved: {username}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "\"User email retrieved: {username}\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"User email retrieved: {username}\")"
                                                                        }
                                                                    ],
                                                                    "label": ".debug(f\"User email retrieved: {username}\")"
                                                                }
                                                            ],
                                                            "label": ".debug(f\"User email retrieved: {username}\")"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 177,
                                                            "end_token": 181,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 178,
                                                                    "end_token": 180,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 178,
                                                                            "end_token": 178,
                                                                            "children": [],
                                                                            "label": "google_creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 180,
                                                                            "end_token": 180,
                                                                            "children": [],
                                                                            "label": "token"
                                                                        }
                                                                    ],
                                                                    "label": "google_creds.token"
                                                                }
                                                            ],
                                                            "label": "assert google_creds.token\n"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 182,
                                                            "end_token": 186,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 183,
                                                                    "end_token": 185,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 183,
                                                                            "end_token": 183,
                                                                            "children": [],
                                                                            "label": "google_creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 185,
                                                                            "end_token": 185,
                                                                            "children": [],
                                                                            "label": "refresh_token"
                                                                        }
                                                                    ],
                                                                    "label": "google_creds.refresh_token"
                                                                }
                                                            ],
                                                            "label": "assert google_creds.refresh_token\n"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 187,
                                                            "end_token": 191,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 188,
                                                                    "end_token": 190,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 188,
                                                                            "end_token": 188,
                                                                            "children": [],
                                                                            "label": "google_creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 190,
                                                                            "end_token": 190,
                                                                            "children": [],
                                                                            "label": "expiry"
                                                                        }
                                                                    ],
                                                                    "label": "google_creds.expiry"
                                                                }
                                                            ],
                                                            "label": "assert google_creds.expiry\n"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 192,
                                                            "end_token": 194,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 193,
                                                                    "end_token": 193,
                                                                    "children": [],
                                                                    "label": "granted_scopes"
                                                                }
                                                            ],
                                                            "label": "assert granted_scopes\n"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 196,
                                                            "end_token": 203,
                                                            "children": [],
                                                            "label": "# Create OAuth2Credentials with the granted scopes\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 204,
                                                            "end_token": 282,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 204,
                                                                    "end_token": 204,
                                                                    "children": [],
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 206,
                                                                    "end_token": 282,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 206,
                                                                            "end_token": 206,
                                                                            "children": [],
                                                                            "label": "OAuth2Credentials"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 207,
                                                                            "end_token": 282,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 209,
                                                                                    "end_token": 213,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 209,
                                                                                            "end_token": 209,
                                                                                            "children": [],
                                                                                            "label": "provider"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 211,
                                                                                            "end_token": 213,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 211,
                                                                                                    "end_token": 211,
                                                                                                    "children": [],
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 213,
                                                                                                    "end_token": 213,
                                                                                                    "children": [],
                                                                                                    "label": "PROVIDER_NAME"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.PROVIDER_NAME"
                                                                                        }
                                                                                    ],
                                                                                    "label": "provider=self.PROVIDER_NAME"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 216,
                                                                                    "end_token": 218,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 216,
                                                                                            "end_token": 216,
                                                                                            "children": [],
                                                                                            "label": "title"
                                                                                        },
                                                                                        {
                                                                                            "type": "none",
                                                                                            "start_token": 218,
                                                                                            "end_token": 218,
                                                                                            "children": [],
                                                                                            "label": "None"
                                                                                        }
                                                                                    ],
                                                                                    "label": "title=None"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 221,
                                                                                    "end_token": 223,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 221,
                                                                                            "end_token": 221,
                                                                                            "children": [],
                                                                                            "label": "username"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 223,
                                                                                            "end_token": 223,
                                                                                            "children": [],
                                                                                            "label": "username"
                                                                                        }
                                                                                    ],
                                                                                    "label": "username=username"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 226,
                                                                                    "end_token": 234,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 226,
                                                                                            "end_token": 226,
                                                                                            "children": [],
                                                                                            "label": "access_token"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 228,
                                                                                            "end_token": 234,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 228,
                                                                                                    "end_token": 228,
                                                                                                    "children": [],
                                                                                                    "label": "SecretStr"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 229,
                                                                                                    "end_token": 233,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 230,
                                                                                                            "end_token": 232,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 230,
                                                                                                                    "end_token": 230,
                                                                                                                    "children": [],
                                                                                                                    "label": "google_creds"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 232,
                                                                                                                    "end_token": 232,
                                                                                                                    "children": [],
                                                                                                                    "label": "token"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "google_creds.token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(google_creds.token)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "SecretStr(google_creds.token),"
                                                                                        }
                                                                                    ],
                                                                                    "label": "access_token=SecretStr(google_creds.token),"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 236,
                                                                                    "end_token": 245,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 236,
                                                                                            "end_token": 236,
                                                                                            "children": [],
                                                                                            "label": "refresh_token"
                                                                                        },
                                                                                        {
                                                                                            "type": "parenthesized_expression",
                                                                                            "start_token": 238,
                                                                                            "end_token": 245,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 240,
                                                                                                    "end_token": 244,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 240,
                                                                                                            "end_token": 240,
                                                                                                            "children": [],
                                                                                                            "label": "("
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 241,
                                                                                                            "end_token": 243,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 242,
                                                                                                                    "end_token": 242,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 242,
                                                                                                                            "end_token": 242,
                                                                                                                            "children": [],
                                                                                                                            "label": "."
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "."
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "google_creds.refresh_token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(google_creds.refresh_token)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(SecretStr(google_creds.refresh_token))"
                                                                                        }
                                                                                    ],
                                                                                    "label": "refresh_token=(SecretStr(google_creds.refresh_token))"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 248,
                                                                                    "end_token": 268,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 248,
                                                                                            "end_token": 248,
                                                                                            "children": [],
                                                                                            "label": "access_token_expires_at"
                                                                                        },
                                                                                        {
                                                                                            "type": "conditional_expression",
                                                                                            "start_token": 250,
                                                                                            "end_token": 267,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 252,
                                                                                                    "end_token": 261,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 252,
                                                                                                            "end_token": 258,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 252,
                                                                                                                    "end_token": 256,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 252,
                                                                                                                            "end_token": 252,
                                                                                                                            "children": [],
                                                                                                                            "label": "int"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 256,
                                                                                                                            "end_token": 256,
                                                                                                                            "children": [],
                                                                                                                            "label": "expiry"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "int(google_creds.expiry"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 258,
                                                                                                                    "end_token": 258,
                                                                                                                    "children": [],
                                                                                                                    "label": "timestamp"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "int(google_creds.expiry.timestamp"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 259,
                                                                                                            "end_token": 260,
                                                                                                            "children": [],
                                                                                                            "label": "()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "int(google_creds.expiry.timestamp())"
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 263,
                                                                                                    "end_token": 265,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 263,
                                                                                                            "end_token": 263,
                                                                                                            "children": [],
                                                                                                            "label": "google_creds"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 265,
                                                                                                            "end_token": 265,
                                                                                                            "children": [],
                                                                                                            "label": "expiry"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "google_creds.expiry"
                                                                                                },
                                                                                                {
                                                                                                    "type": "none",
                                                                                                    "start_token": 267,
                                                                                                    "end_token": 267,
                                                                                                    "children": [],
                                                                                                    "label": "None"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None"
                                                                                        }
                                                                                    ],
                                                                                    "label": "access_token_expires_at=(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None\n"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 272,
                                                                                    "end_token": 274,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 272,
                                                                                            "end_token": 272,
                                                                                            "children": [],
                                                                                            "label": "refresh_token_expires_at"
                                                                                        },
                                                                                        {
                                                                                            "type": "none",
                                                                                            "start_token": 274,
                                                                                            "end_token": 274,
                                                                                            "children": [],
                                                                                            "label": "None"
                                                                                        }
                                                                                    ],
                                                                                    "label": "refresh_token_expires_at=None"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 277,
                                                                                    "end_token": 280,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 277,
                                                                                            "end_token": 277,
                                                                                            "children": [],
                                                                                            "label": "scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 279,
                                                                                            "end_token": 279,
                                                                                            "children": [],
                                                                                            "label": "granted_scopes"
                                                                                        }
                                                                                    ],
                                                                                    "label": "scopes=granted_scopes,"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            provider=self.PROVIDER_NAME,\n            title=None,\n            username=username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=(SecretStr(google_creds.refresh_token)),\n            access_token_expires_at=(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None\n            ),\n            refresh_token_expires_at=None,\n            scopes=granted_scopes,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            title=None,\n            username=username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=(SecretStr(google_creds.refresh_token)),\n            access_token_expires_at=(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None\n            ),\n            refresh_token_expires_at=None,\n            scopes=granted_scopes,\n        )"
                                                                }
                                                            ],
                                                            "label": "credentials = OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            title=None,\n            username=username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=(SecretStr(google_creds.refresh_token)),\n            access_token_expires_at=(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None\n            ),\n            refresh_token_expires_at=None,\n            scopes=granted_scopes,\n        )"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 284,
                                                            "end_token": 291,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 284,
                                                                    "end_token": 291,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 284,
                                                                            "end_token": 286,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 284,
                                                                                    "end_token": 284,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 286,
                                                                                    "end_token": 286,
                                                                                    "children": [],
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 287,
                                                                            "end_token": 291,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 290,
                                                                                    "end_token": 290,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 290,
                                                                                            "end_token": 290,
                                                                                            "children": [],
                                                                                            "label": "\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\""
                                                                                }
                                                                            ],
                                                                            "label": "(\n            f\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\"\n"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(\n            f\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\"\n"
                                                                }
                                                            ],
                                                            "label": "logger.debug(\n            f\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\"\n"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 295,
                                                            "end_token": 296,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 296,
                                                                    "end_token": 296,
                                                                    "children": [],
                                                                    "label": "credentials"
                                                                }
                                                            ],
                                                            "label": "return credentials"
                                                        }
                                                    ],
                                                    "label": ":\n        logger.debug(f\"Exchanging code for tokens with scopes: {scopes}\")\n\n        # Use the scopes from the initial request\n        flow = self._setup_oauth_flow(scopes)\n        flow.redirect_uri = self.redirect_uri\n\n        logger.debug(\"Fetching token from Google\")\n\n        # Disable scope check in fetch_token\n        flow.oauth2session.scope = None\n        token = flow.fetch_token(code=code)\n        logger.debug(\"Token fetched successfully\")\n\n        # Get the actual scopes granted by Google\n        granted_scopes: list[str] = token.get(\"scope\", [])\n\n        logger.debug(f\"Scopes granted by Google: {granted_scopes}\")\n\n        google_creds = flow.credentials\n        logger.debug(f\"Received credentials: {google_creds}\")\n\n        logger.debug(\"Requesting user email\")\n        username = self._request_email(google_creds)\n        logger.debug(f\"User email retrieved: {username}\")\n\n        assert google_creds.token\n        assert google_creds.refresh_token\n        assert google_creds.expiry\n        assert granted_scopes\n\n        # Create OAuth2Credentials with the granted scopes\n        credentials = OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            title=None,\n            username=username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=(SecretStr(google_creds.refresh_token)),\n            access_token_expires_at=(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None\n            ),\n            refresh_token_expires_at=None,\n            scopes=granted_scopes,\n        )\n        logger.debug(\n            f\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\"\n        )\n\n        return credentials\n"
                                                }
                                            ],
                                            "label": "def exchange_code_for_tokens(\n        self, code: str, scopes: list[str]\n    ) -> OAuth2Credentials:\n        logger.debug(f\"Exchanging code for tokens with scopes: {scopes}\")\n\n        # Use the scopes from the initial request\n        flow = self._setup_oauth_flow(scopes)\n        flow.redirect_uri = self.redirect_uri\n\n        logger.debug(\"Fetching token from Google\")\n\n        # Disable scope check in fetch_token\n        flow.oauth2session.scope = None\n        token = flow.fetch_token(code=code)\n        logger.debug(\"Token fetched successfully\")\n\n        # Get the actual scopes granted by Google\n        granted_scopes: list[str] = token.get(\"scope\", [])\n\n        logger.debug(f\"Scopes granted by Google: {granted_scopes}\")\n\n        google_creds = flow.credentials\n        logger.debug(f\"Received credentials: {google_creds}\")\n\n        logger.debug(\"Requesting user email\")\n        username = self._request_email(google_creds)\n        logger.debug(f\"User email retrieved: {username}\")\n\n        assert google_creds.token\n        assert google_creds.refresh_token\n        assert google_creds.expiry\n        assert granted_scopes\n\n        # Create OAuth2Credentials with the granted scopes\n        credentials = OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            title=None,\n            username=username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=(SecretStr(google_creds.refresh_token)),\n            access_token_expires_at=(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None\n            ),\n            refresh_token_expires_at=None,\n            scopes=granted_scopes,\n        )\n        logger.debug(\n            f\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\"\n        )\n\n        return credentials\n"
                                        }
                                    ],
                                    "label": "def exchange_code_for_tokens(\n        self, code: str, scopes: list[str]\n    ) -> OAuth2Credentials:\n        logger.debug(f\"Exchanging code for tokens with scopes: {scopes}\")\n\n        # Use the scopes from the initial request\n        flow = self._setup_oauth_flow(scopes)\n        flow.redirect_uri = self.redirect_uri\n\n        logger.debug(\"Fetching token from Google\")\n\n        # Disable scope check in fetch_token\n        flow.oauth2session.scope = None\n        token = flow.fetch_token(code=code)\n        logger.debug(\"Token fetched successfully\")\n\n        # Get the actual scopes granted by Google\n        granted_scopes: list[str] = token.get(\"scope\", [])\n\n        logger.debug(f\"Scopes granted by Google: {granted_scopes}\")\n\n        google_creds = flow.credentials\n        logger.debug(f\"Received credentials: {google_creds}\")\n\n        logger.debug(\"Requesting user email\")\n        username = self._request_email(google_creds)\n        logger.debug(f\"User email retrieved: {username}\")\n\n        assert google_creds.token\n        assert google_creds.refresh_token\n        assert google_creds.expiry\n        assert granted_scopes\n\n        # Create OAuth2Credentials with the granted scopes\n        credentials = OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            title=None,\n            username=username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=(SecretStr(google_creds.refresh_token)),\n            access_token_expires_at=(\n                int(google_creds.expiry.timestamp()) if google_creds.expiry else None\n            ),\n            refresh_token_expires_at=None,\n            scopes=granted_scopes,\n        )\n        logger.debug(\n            f\"OAuth2Credentials object created successfully with scopes: {credentials.scopes}\"\n        )\n\n        return credentials\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "revoke_tokens",
                            "start_line": 106,
                            "end_line": 113,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 58,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 58,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "revoke_tokens"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 6,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 6,
                                                                    "label": ":"
                                                                }
                                                            ],
                                                            "label": "self, credentials:"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "OAuth2Credentials"
                                                                }
                                                            ],
                                                            "label": "credentials: OAuth2Credentials"
                                                        }
                                                    ],
                                                    "label": "(self, credentials: OAuth2Credentials)"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 10,
                                                    "end_token": 11,
                                                    "label": "> bool"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 12,
                                                    "end_token": 58,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 14,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "session"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 16,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 16,
                                                                            "end_token": 16,
                                                                            "label": "AuthorizedSession"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 17,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 18,
                                                                                    "end_token": 18,
                                                                                    "label": "credentials"
                                                                                }
                                                                            ],
                                                                            "label": "(credentials)"
                                                                        }
                                                                    ],
                                                                    "label": "AuthorizedSession(credentials)"
                                                                }
                                                            ],
                                                            "label": "session = AuthorizedSession(credentials)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 21,
                                                            "end_token": 55,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 21,
                                                                    "end_token": 55,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 21,
                                                                            "end_token": 23,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "session"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "post"
                                                                                }
                                                                            ],
                                                                            "label": "session.post"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 24,
                                                                            "end_token": 55,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 26,
                                                                                    "end_token": 28,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 28,
                                                                                            "end_token": 28,
                                                                                            "label": "revoke_uri"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.revoke_uri"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 31,
                                                                                    "end_token": 43,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 34,
                                                                                            "end_token": 42,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 34,
                                                                                                    "end_token": 34,
                                                                                                    "label": "\"token\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 36,
                                                                                                    "end_token": 42,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 36,
                                                                                                            "end_token": 40,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 36,
                                                                                                                    "end_token": 38,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 36,
                                                                                                                            "end_token": 36,
                                                                                                                            "label": "credentials"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 38,
                                                                                                                            "end_token": 38,
                                                                                                                            "label": "access_token"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "credentials.access_token"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 40,
                                                                                                                    "end_token": 40,
                                                                                                                    "label": "get_secret_value"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "credentials.access_token.get_secret_value"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 41,
                                                                                                            "end_token": 42,
                                                                                                            "label": "()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "credentials.access_token.get_secret_value()"
                                                                                                }
                                                                                            ],
                                                                                            "label": "\"token\": credentials.access_token.get_secret_value()"
                                                                                        }
                                                                                    ],
                                                                                    "label": "params={\"token\": credentials.access_token.get_secret_value()}"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 46,
                                                                                    "end_token": 52,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 49,
                                                                                            "end_token": 51,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 49,
                                                                                                    "end_token": 49,
                                                                                                    "label": "\"content-type\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 51,
                                                                                                    "end_token": 51,
                                                                                                    "label": "\"application/x-www-form-urlencoded\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "\"content-type\": \"application/x-www-form-urlencoded\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "headers={\"content-type\": \"application/x-www-form-urlencoded\"}"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            self.revoke_uri,\n            params={\"token\": credentials.access_token.get_secret_value()},\n            headers={\"content-type\": \"application/x-www-form-urlencoded\"},\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "session.post(\n            self.revoke_uri,\n            params={\"token\": credentials.access_token.get_secret_value()},\n            headers={\"content-type\": \"application/x-www-form-urlencoded\"},\n        )"
                                                                }
                                                            ],
                                                            "label": "session.post(\n            self.revoke_uri,\n            params={\"token\": credentials.access_token.get_secret_value()},\n            headers={\"content-type\": \"application/x-www-form-urlencoded\"},\n        )"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 57,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "true",
                                                                    "start_token": 58,
                                                                    "end_token": 58,
                                                                    "label": "True"
                                                                }
                                                            ],
                                                            "label": "return True"
                                                        }
                                                    ],
                                                    "label": ":\n        session = AuthorizedSession(credentials)\n        session.post(\n            self.revoke_uri,\n            params={\"token\": credentials.access_token.get_secret_value()},\n            headers={\"content-type\": \"application/x-www-form-urlencoded\"},\n        )\n        return True"
                                                }
                                            ],
                                            "label": "def revoke_tokens(self, credentials: OAuth2Credentials) -> bool:\n        session = AuthorizedSession(credentials)\n        session.post(\n            self.revoke_uri,\n            params={\"token\": credentials.access_token.get_secret_value()},\n            headers={\"content-type\": \"application/x-www-form-urlencoded\"},\n        )\n        return True"
                                        }
                                    ],
                                    "label": "def revoke_tokens(self, credentials: OAuth2Credentials) -> bool:\n        session = AuthorizedSession(credentials)\n        session.post(\n            self.revoke_uri,\n            params={\"token\": credentials.access_token.get_secret_value()},\n            headers={\"content-type\": \"application/x-www-form-urlencoded\"},\n        )\n        return True"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_request_email",
                            "start_line": 115,
                            "end_line": 125,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 67,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 66,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_request_email"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 8,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 8,
                                                                    "children": [],
                                                                    "label": ": Credentials"
                                                                }
                                                            ],
                                                            "label": "\n        self, creds: Credentials"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 10,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 6,
                                                                    "end_token": 6,
                                                                    "children": [],
                                                                    "label": "creds"
                                                                },
                                                                {
                                                                    "type": "union_type",
                                                                    "start_token": 8,
                                                                    "end_token": 10,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 8,
                                                                            "end_token": 8,
                                                                            "children": [],
                                                                            "label": "Credentials"
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 10,
                                                                            "end_token": 10,
                                                                            "children": [],
                                                                            "label": "ExternalAccountCredentials"
                                                                        }
                                                                    ],
                                                                    "label": "Credentials | ExternalAccountCredentials"
                                                                }
                                                            ],
                                                            "label": ", creds: Credentials | ExternalAccountCredentials"
                                                        }
                                                    ],
                                                    "label": "(\n        self, creds: Credentials | ExternalAccountCredentials\n    )"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 14,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "start_token": 15,
                                                            "end_token": 15,
                                                            "children": [],
                                                            "label": "str"
                                                        },
                                                        {
                                                            "type": "none",
                                                            "start_token": 17,
                                                            "end_token": 17,
                                                            "children": [],
                                                            "label": "None"
                                                        }
                                                    ],
                                                    "label": "> str | None"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 19,
                                                    "end_token": 66,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 20,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 20,
                                                                    "end_token": 20,
                                                                    "children": [],
                                                                    "label": "session"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 22,
                                                                    "end_token": 25,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "children": [],
                                                                            "label": "AuthorizedSession"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 23,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 24,
                                                                                    "end_token": 24,
                                                                                    "children": [],
                                                                                    "label": "creds"
                                                                                }
                                                                            ],
                                                                            "label": "(creds)"
                                                                        }
                                                                    ],
                                                                    "label": "AuthorizedSession(creds)"
                                                                }
                                                            ],
                                                            "label": "session = AuthorizedSession(creds)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 27,
                                                            "end_token": 36,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 27,
                                                                    "end_token": 27,
                                                                    "children": [],
                                                                    "label": "response"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 29,
                                                                    "end_token": 36,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 29,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "children": [],
                                                                                    "label": "session"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 31,
                                                                                    "end_token": 31,
                                                                                    "children": [],
                                                                                    "label": "get"
                                                                                }
                                                                            ],
                                                                            "label": "session.get"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 32,
                                                                            "end_token": 36,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 33,
                                                                                    "end_token": 35,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 33,
                                                                                            "end_token": 33,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 35,
                                                                                            "end_token": 35,
                                                                                            "children": [],
                                                                                            "label": "EMAIL_ENDPOINT"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.EMAIL_ENDPOINT"
                                                                                }
                                                                            ],
                                                                            "label": "(self.EMAIL_ENDPOINT)"
                                                                        }
                                                                    ],
                                                                    "label": "session.get(self.EMAIL_ENDPOINT)"
                                                                }
                                                            ],
                                                            "label": "response = session.get(self.EMAIL_ENDPOINT)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 38,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 39,
                                                                    "end_token": 42,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 40,
                                                                            "end_token": 42,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 40,
                                                                                    "end_token": 40,
                                                                                    "children": [],
                                                                                    "label": "response"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 42,
                                                                                    "end_token": 42,
                                                                                    "children": [],
                                                                                    "label": "ok"
                                                                                }
                                                                            ],
                                                                            "label": "response.ok"
                                                                        }
                                                                    ],
                                                                    "label": "not response.ok"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 44,
                                                                    "end_token": 56,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 45,
                                                                            "end_token": 53,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 45,
                                                                                    "end_token": 53,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 45,
                                                                                            "end_token": 47,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 45,
                                                                                                    "end_token": 45,
                                                                                                    "children": [],
                                                                                                    "label": "logger"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 47,
                                                                                                    "end_token": 47,
                                                                                                    "children": [],
                                                                                                    "label": "error"
                                                                                                }
                                                                                            ],
                                                                                            "label": "logger.error"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 48,
                                                                                            "end_token": 53,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "start_token": 50,
                                                                                                    "end_token": 52,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "start_token": 50,
                                                                                                            "end_token": 51,
                                                                                                            "children": [],
                                                                                                            "label": "f\"Failed to get user email. Status code: {response.status_code}\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 52,
                                                                                                            "end_token": 52,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 52,
                                                                                                                    "end_token": 52,
                                                                                                                    "children": [],
                                                                                                                    "label": "\n"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\n"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "f\"Failed to get user email. Status code: {response.status_code}\"\n"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )"
                                                                                        }
                                                                                    ],
                                                                                    "label": "logger.error(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "logger.error(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )"
                                                                        },
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 55,
                                                                            "end_token": 56,
                                                                            "children": [
                                                                                {
                                                                                    "type": "none",
                                                                                    "start_token": 56,
                                                                                    "end_token": 56,
                                                                                    "children": [],
                                                                                    "label": "None"
                                                                                }
                                                                            ],
                                                                            "label": "return None"
                                                                        }
                                                                    ],
                                                                    "label": "\n            logger.error(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )\n            return None"
                                                                }
                                                            ],
                                                            "label": "if not response.ok:\n            logger.error(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )\n            return None"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 58,
                                                            "end_token": 66,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 59,
                                                                    "end_token": 66,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 59,
                                                                            "end_token": 63,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 59,
                                                                                    "end_token": 61,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 59,
                                                                                            "end_token": 59,
                                                                                            "children": [],
                                                                                            "label": "response"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 61,
                                                                                            "end_token": 61,
                                                                                            "children": [],
                                                                                            "label": "json"
                                                                                        }
                                                                                    ],
                                                                                    "label": "response.json"
                                                                                }
                                                                            ],
                                                                            "label": "response.json()"
                                                                        },
                                                                        {
                                                                            "type": "expression_list",
                                                                            "start_token": 64,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 65,
                                                                                    "end_token": 65,
                                                                                    "children": [],
                                                                                    "label": "\"email\""
                                                                                }
                                                                            ],
                                                                            "label": "[\"email\""
                                                                        }
                                                                    ],
                                                                    "label": "response.json()[\"email\"]"
                                                                }
                                                            ],
                                                            "label": "return response.json()[\"email\"]"
                                                        }
                                                    ],
                                                    "label": "\n        session = AuthorizedSession(creds)\n        response = session.get(self.EMAIL_ENDPOINT)\n        if not response.ok:\n            logger.error(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )\n            return None\n        return response.json()[\"email\"]"
                                                }
                                            ],
                                            "label": "def _request_email(\n        self, creds: Credentials | ExternalAccountCredentials\n    ) -> str | None:\n        session = AuthorizedSession(creds)\n        response = session.get(self.EMAIL_ENDPOINT)\n        if not response.ok:\n            logger.error(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )\n            return None\n        return response.json()[\"email\"]"
                                        }
                                    ],
                                    "label": "def _request_email(\n        self, creds: Credentials | ExternalAccountCredentials\n    ) -> str | None:\n        session = AuthorizedSession(creds)\n        response = session.get(self.EMAIL_ENDPOINT)\n        if not response.ok:\n            logger.error(\n                f\"Failed to get user email. Status code: {response.status_code}\"\n            )\n            return None\n        return response.json()[\"email\"]\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_refresh_tokens",
                            "start_line": 127,
                            "end_line": 156,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 208,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 208,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [],
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_refresh_tokens"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 5,
                                                            "end_token": 5,
                                                            "children": [],
                                                            "label": "credentials"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 7,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": "OAuth2Credentials"
                                                        }
                                                    ],
                                                    "label": "(self, credentials: OAuth2Credentials) -> OAuth2Credentials:"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 11,
                                                    "end_token": 11,
                                                    "children": [],
                                                    "label": "OAuth2Credentials"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 13,
                                                    "end_token": 208,
                                                    "children": [
                                                        {
                                                            "type": "comment",
                                                            "start_token": 14,
                                                            "end_token": 22,
                                                            "children": [],
                                                            "label": "# Google credentials should ALWAYS have a refresh token"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 24,
                                                            "end_token": 27,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 25,
                                                                    "end_token": 27,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 25,
                                                                            "end_token": 25,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "children": [],
                                                                            "label": "refresh_token"
                                                                        }
                                                                    ],
                                                                    "label": "credentials.refresh_token"
                                                                }
                                                            ],
                                                            "label": "assert credentials.refresh_token"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 30,
                                                            "end_token": 85,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 30,
                                                                    "end_token": 30,
                                                                    "children": [],
                                                                    "label": "google_creds"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 32,
                                                                    "end_token": 85,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 32,
                                                                            "end_token": 32,
                                                                            "children": [],
                                                                            "label": "Credentials"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 33,
                                                                            "end_token": 85,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 35,
                                                                                    "end_token": 44,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 35,
                                                                                            "end_token": 35,
                                                                                            "children": [],
                                                                                            "label": "token"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 37,
                                                                                            "end_token": 43,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 39,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 37,
                                                                                                            "end_token": 38,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 37,
                                                                                                                    "end_token": 37,
                                                                                                                    "children": [],
                                                                                                                    "label": "credentials"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 39,
                                                                                                                    "end_token": 39,
                                                                                                                    "children": [],
                                                                                                                    "label": "access_token"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "credentials."
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 39,
                                                                                                            "end_token": 39,
                                                                                                            "children": [],
                                                                                                            "label": "access_token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "credentials.access_token"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 42,
                                                                                                    "end_token": 43,
                                                                                                    "children": [],
                                                                                                    "label": "()"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credentials.access_token.get_secret_value()"
                                                                                        }
                                                                                    ],
                                                                                    "label": "token=credentials.access_token.get_secret_value(),"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 46,
                                                                                    "end_token": 55,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 46,
                                                                                            "end_token": 46,
                                                                                            "children": [],
                                                                                            "label": "refresh_token"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 48,
                                                                                            "end_token": 54,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 48,
                                                                                                    "end_token": 50,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 48,
                                                                                                            "end_token": 49,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 48,
                                                                                                                    "end_token": 48,
                                                                                                                    "children": [],
                                                                                                                    "label": "credentials"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 50,
                                                                                                                    "end_token": 50,
                                                                                                                    "children": [],
                                                                                                                    "label": "refresh_token"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "credentials."
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 50,
                                                                                                            "end_token": 50,
                                                                                                            "children": [],
                                                                                                            "label": "refresh_token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "credentials.refresh_token"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 53,
                                                                                                    "end_token": 54,
                                                                                                    "children": [],
                                                                                                    "label": "()"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credentials.refresh_token.get_secret_value()"
                                                                                        }
                                                                                    ],
                                                                                    "label": "refresh_token=credentials.refresh_token.get_secret_value(),"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 57,
                                                                                    "end_token": 62,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 57,
                                                                                            "end_token": 57,
                                                                                            "children": [],
                                                                                            "label": "token_uri"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 59,
                                                                                            "end_token": 61,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 59,
                                                                                                    "end_token": 59,
                                                                                                    "children": [],
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 61,
                                                                                                    "end_token": 61,
                                                                                                    "children": [],
                                                                                                    "label": "token_uri"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.token_uri"
                                                                                        }
                                                                                    ],
                                                                                    "label": "token_uri=self.token_uri,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 64,
                                                                                    "end_token": 69,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 64,
                                                                                            "end_token": 64,
                                                                                            "children": [],
                                                                                            "label": "client_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 66,
                                                                                            "end_token": 68,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 66,
                                                                                                    "end_token": 66,
                                                                                                    "children": [],
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 68,
                                                                                                    "end_token": 68,
                                                                                                    "children": [],
                                                                                                    "label": "client_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.client_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "client_id=self.client_id,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 71,
                                                                                    "end_token": 76,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 71,
                                                                                            "end_token": 71,
                                                                                            "children": [],
                                                                                            "label": "client_secret"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 73,
                                                                                            "end_token": 75,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 73,
                                                                                                    "end_token": 73,
                                                                                                    "children": [],
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 75,
                                                                                                    "end_token": 75,
                                                                                                    "children": [],
                                                                                                    "label": "client_secret"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.client_secret"
                                                                                        }
                                                                                    ],
                                                                                    "label": "client_secret=self.client_secret,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 78,
                                                                                    "end_token": 83,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 78,
                                                                                            "end_token": 78,
                                                                                            "children": [],
                                                                                            "label": "scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 80,
                                                                                            "end_token": 82,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 80,
                                                                                                    "end_token": 80,
                                                                                                    "children": [],
                                                                                                    "label": "credentials"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 82,
                                                                                                    "end_token": 82,
                                                                                                    "children": [],
                                                                                                    "label": "scopes"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credentials.scopes"
                                                                                        }
                                                                                    ],
                                                                                    "label": "scopes=credentials.scopes,"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            token=credentials.access_token.get_secret_value(),\n            refresh_token=credentials.refresh_token.get_secret_value(),\n            token_uri=self.token_uri,\n            client_id=self.client_id,\n            client_secret=self.client_secret,\n            scopes=credentials.scopes,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "Credentials(\n            token=credentials.access_token.get_secret_value(),\n            refresh_token=credentials.refresh_token.get_secret_value(),\n            token_uri=self.token_uri,\n            client_id=self.client_id,\n            client_secret=self.client_secret,\n            scopes=credentials.scopes,\n        )"
                                                                }
                                                            ],
                                                            "label": "google_creds = Credentials(\n            token=credentials.access_token.get_secret_value(),\n            refresh_token=credentials.refresh_token.get_secret_value(),\n            token_uri=self.token_uri,\n            client_id=self.client_id,\n            client_secret=self.client_secret,\n            scopes=credentials.scopes,\n        )"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 87,
                                                            "end_token": 102,
                                                            "children": [],
                                                            "label": "# Google's OAuth library is poorly typed so we need some of these:"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 104,
                                                            "end_token": 107,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 105,
                                                                    "end_token": 107,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 105,
                                                                            "end_token": 105,
                                                                            "children": [],
                                                                            "label": "google_creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 107,
                                                                            "end_token": 107,
                                                                            "children": [],
                                                                            "label": "refresh_token"
                                                                        }
                                                                    ],
                                                                    "label": "google_creds.refresh_token"
                                                                }
                                                            ],
                                                            "label": "assert google_creds.refresh_token"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 109,
                                                            "end_token": 112,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 110,
                                                                    "end_token": 112,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 110,
                                                                            "end_token": 110,
                                                                            "children": [],
                                                                            "label": "google_creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 112,
                                                                            "end_token": 112,
                                                                            "children": [],
                                                                            "label": "scopes"
                                                                        }
                                                                    ],
                                                                    "label": "google_creds.scopes"
                                                                }
                                                            ],
                                                            "label": "assert google_creds.scopes"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 115,
                                                            "end_token": 122,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 115,
                                                                    "end_token": 117,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 115,
                                                                            "end_token": 115,
                                                                            "children": [],
                                                                            "label": "google_creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 117,
                                                                            "end_token": 117,
                                                                            "children": [],
                                                                            "label": "refresh"
                                                                        }
                                                                    ],
                                                                    "label": "google_creds.refresh"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 118,
                                                                    "end_token": 122,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 119,
                                                                            "end_token": 121,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 119,
                                                                                    "end_token": 119,
                                                                                    "children": [],
                                                                                    "label": "Request"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 120,
                                                                                    "end_token": 121,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "Request()"
                                                                        }
                                                                    ],
                                                                    "label": "(Request())"
                                                                }
                                                            ],
                                                            "label": "google_creds.refresh(Request())"
                                                        },
                                                        {
                                                            "type": "assert_statement",
                                                            "start_token": 124,
                                                            "end_token": 127,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 125,
                                                                    "end_token": 127,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 125,
                                                                            "end_token": 125,
                                                                            "children": [],
                                                                            "label": "google_creds"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 127,
                                                                            "end_token": 127,
                                                                            "children": [],
                                                                            "label": "expiry"
                                                                        }
                                                                    ],
                                                                    "label": "google_creds.expiry"
                                                                }
                                                            ],
                                                            "label": "assert google_creds.expiry"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 130,
                                                            "end_token": 208,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 131,
                                                                    "end_token": 208,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 131,
                                                                            "end_token": 131,
                                                                            "children": [],
                                                                            "label": "OAuth2Credentials"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 132,
                                                                            "end_token": 208,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 134,
                                                                                    "end_token": 139,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 134,
                                                                                            "end_token": 134,
                                                                                            "children": [],
                                                                                            "label": "provider"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 136,
                                                                                            "end_token": 138,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 136,
                                                                                                    "end_token": 136,
                                                                                                    "children": [],
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 138,
                                                                                                    "end_token": 138,
                                                                                                    "children": [],
                                                                                                    "label": "PROVIDER_NAME"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.PROVIDER_NAME"
                                                                                        }
                                                                                    ],
                                                                                    "label": "provider=self.PROVIDER_NAME,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 141,
                                                                                    "end_token": 146,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 141,
                                                                                            "end_token": 141,
                                                                                            "children": [],
                                                                                            "label": "id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 143,
                                                                                            "end_token": 145,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 143,
                                                                                                    "end_token": 143,
                                                                                                    "children": [],
                                                                                                    "label": "credentials"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 145,
                                                                                                    "end_token": 145,
                                                                                                    "children": [],
                                                                                                    "label": "id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credentials.id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "id=credentials.id,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 148,
                                                                                    "end_token": 153,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 148,
                                                                                            "end_token": 148,
                                                                                            "children": [],
                                                                                            "label": "title"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 150,
                                                                                            "end_token": 152,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 150,
                                                                                                    "end_token": 150,
                                                                                                    "children": [],
                                                                                                    "label": "credentials"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 152,
                                                                                                    "end_token": 152,
                                                                                                    "children": [],
                                                                                                    "label": "title"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credentials.title"
                                                                                        }
                                                                                    ],
                                                                                    "label": "title=credentials.title,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 155,
                                                                                    "end_token": 160,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 155,
                                                                                            "end_token": 155,
                                                                                            "children": [],
                                                                                            "label": "username"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 157,
                                                                                            "end_token": 159,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 157,
                                                                                                    "end_token": 157,
                                                                                                    "children": [],
                                                                                                    "label": "credentials"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 159,
                                                                                                    "end_token": 159,
                                                                                                    "children": [],
                                                                                                    "label": "username"
                                                                                                }
                                                                                            ],
                                                                                            "label": "credentials.username"
                                                                                        }
                                                                                    ],
                                                                                    "label": "username=credentials.username,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 162,
                                                                                    "end_token": 170,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 162,
                                                                                            "end_token": 162,
                                                                                            "children": [],
                                                                                            "label": "access_token"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 164,
                                                                                            "end_token": 169,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 164,
                                                                                                    "end_token": 164,
                                                                                                    "children": [],
                                                                                                    "label": "SecretStr"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 165,
                                                                                                    "end_token": 169,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 166,
                                                                                                            "end_token": 168,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 166,
                                                                                                                    "end_token": 166,
                                                                                                                    "children": [],
                                                                                                                    "label": "google_creds"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 168,
                                                                                                                    "end_token": 168,
                                                                                                                    "children": [],
                                                                                                                    "label": "token"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "google_creds.token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(google_creds.token)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "SecretStr(google_creds.token)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "access_token=SecretStr(google_creds.token),"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 172,
                                                                                    "end_token": 180,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 172,
                                                                                            "end_token": 172,
                                                                                            "children": [],
                                                                                            "label": "refresh_token"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 174,
                                                                                            "end_token": 179,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 174,
                                                                                                    "end_token": 174,
                                                                                                    "children": [],
                                                                                                    "label": "SecretStr"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 175,
                                                                                                    "end_token": 179,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 176,
                                                                                                            "end_token": 178,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 176,
                                                                                                                    "end_token": 176,
                                                                                                                    "children": [],
                                                                                                                    "label": "google_creds"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 178,
                                                                                                                    "end_token": 178,
                                                                                                                    "children": [],
                                                                                                                    "label": "refresh_token"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "google_creds.refresh_token"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(google_creds.refresh_token)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "SecretStr(google_creds.refresh_token)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "refresh_token=SecretStr(google_creds.refresh_token),"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 182,
                                                                                    "end_token": 194,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 182,
                                                                                            "end_token": 182,
                                                                                            "children": [],
                                                                                            "label": "access_token_expires_at"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 184,
                                                                                            "end_token": 193,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 184,
                                                                                                    "end_token": 184,
                                                                                                    "children": [],
                                                                                                    "label": "int"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 185,
                                                                                                    "end_token": 193,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 186,
                                                                                                            "end_token": 192,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 186,
                                                                                                                    "end_token": 189,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 186,
                                                                                                                            "end_token": 188,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 186,
                                                                                                                                    "end_token": 186,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "google_creds"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 188,
                                                                                                                                    "end_token": 188,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "expiry"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "google_creds.expiry"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 189,
                                                                                                                            "end_token": 189,
                                                                                                                            "children": [],
                                                                                                                            "label": "."
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "google_creds.expiry."
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 191,
                                                                                                                    "end_token": 192,
                                                                                                                    "children": [],
                                                                                                                    "label": "()"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "google_creds.expiry.timestamp()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(google_creds.expiry.timestamp())"
                                                                                                }
                                                                                            ],
                                                                                            "label": "int(google_creds.expiry.timestamp())"
                                                                                        }
                                                                                    ],
                                                                                    "label": "access_token_expires_at=int(google_creds.expiry.timestamp()),"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 196,
                                                                                    "end_token": 199,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 196,
                                                                                            "end_token": 196,
                                                                                            "children": [],
                                                                                            "label": "refresh_token_expires_at"
                                                                                        },
                                                                                        {
                                                                                            "type": "none",
                                                                                            "start_token": 198,
                                                                                            "end_token": 198,
                                                                                            "children": [],
                                                                                            "label": "None"
                                                                                        }
                                                                                    ],
                                                                                    "label": "refresh_token_expires_at=None,"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 201,
                                                                                    "end_token": 206,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 201,
                                                                                            "end_token": 201,
                                                                                            "children": [],
                                                                                            "label": "scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 203,
                                                                                            "end_token": 205,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 203,
                                                                                                    "end_token": 203,
                                                                                                    "children": [],
                                                                                                    "label": "google_creds"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 205,
                                                                                                    "end_token": 205,
                                                                                                    "children": [],
                                                                                                    "label": "scopes"
                                                                                                }
                                                                                            ],
                                                                                            "label": "google_creds.scopes"
                                                                                        }
                                                                                    ],
                                                                                    "label": "scopes=google_creds.scopes,"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            provider=self.PROVIDER_NAME,\n            id=credentials.id,\n            title=credentials.title,\n            username=credentials.username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=SecretStr(google_creds.refresh_token),\n            access_token_expires_at=int(google_creds.expiry.timestamp()),\n            refresh_token_expires_at=None,\n            scopes=google_creds.scopes,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            id=credentials.id,\n            title=credentials.title,\n            username=credentials.username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=SecretStr(google_creds.refresh_token),\n            access_token_expires_at=int(google_creds.expiry.timestamp()),\n            refresh_token_expires_at=None,\n            scopes=google_creds.scopes,\n        )"
                                                                }
                                                            ],
                                                            "label": "return OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            id=credentials.id,\n            title=credentials.title,\n            username=credentials.username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=SecretStr(google_creds.refresh_token),\n            access_token_expires_at=int(google_creds.expiry.timestamp()),\n            refresh_token_expires_at=None,\n            scopes=google_creds.scopes,\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        # Google credentials should ALWAYS have a refresh token\n        assert credentials.refresh_token\n\n        google_creds = Credentials(\n            token=credentials.access_token.get_secret_value(),\n            refresh_token=credentials.refresh_token.get_secret_value(),\n            token_uri=self.token_uri,\n            client_id=self.client_id,\n            client_secret=self.client_secret,\n            scopes=credentials.scopes,\n        )\n        # Google's OAuth library is poorly typed so we need some of these:\n        assert google_creds.refresh_token\n        assert google_creds.scopes\n\n        google_creds.refresh(Request())\n        assert google_creds.expiry\n\n        return OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            id=credentials.id,\n            title=credentials.title,\n            username=credentials.username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=SecretStr(google_creds.refresh_token),\n            access_token_expires_at=int(google_creds.expiry.timestamp()),\n            refresh_token_expires_at=None,\n            scopes=google_creds.scopes,\n        )"
                                                }
                                            ],
                                            "label": "def _refresh_tokens(self, credentials: OAuth2Credentials) -> OAuth2Credentials:\n        # Google credentials should ALWAYS have a refresh token\n        assert credentials.refresh_token\n\n        google_creds = Credentials(\n            token=credentials.access_token.get_secret_value(),\n            refresh_token=credentials.refresh_token.get_secret_value(),\n            token_uri=self.token_uri,\n            client_id=self.client_id,\n            client_secret=self.client_secret,\n            scopes=credentials.scopes,\n        )\n        # Google's OAuth library is poorly typed so we need some of these:\n        assert google_creds.refresh_token\n        assert google_creds.scopes\n\n        google_creds.refresh(Request())\n        assert google_creds.expiry\n\n        return OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            id=credentials.id,\n            title=credentials.title,\n            username=credentials.username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=SecretStr(google_creds.refresh_token),\n            access_token_expires_at=int(google_creds.expiry.timestamp()),\n            refresh_token_expires_at=None,\n            scopes=google_creds.scopes,\n        )"
                                        }
                                    ],
                                    "label": "def _refresh_tokens(self, credentials: OAuth2Credentials) -> OAuth2Credentials:\n        # Google credentials should ALWAYS have a refresh token\n        assert credentials.refresh_token\n\n        google_creds = Credentials(\n            token=credentials.access_token.get_secret_value(),\n            refresh_token=credentials.refresh_token.get_secret_value(),\n            token_uri=self.token_uri,\n            client_id=self.client_id,\n            client_secret=self.client_secret,\n            scopes=credentials.scopes,\n        )\n        # Google's OAuth library is poorly typed so we need some of these:\n        assert google_creds.refresh_token\n        assert google_creds.scopes\n\n        google_creds.refresh(Request())\n        assert google_creds.expiry\n\n        return OAuth2Credentials(\n            provider=self.PROVIDER_NAME,\n            id=credentials.id,\n            title=credentials.title,\n            username=credentials.username,\n            access_token=SecretStr(google_creds.token),\n            refresh_token=SecretStr(google_creds.refresh_token),\n            access_token_expires_at=int(google_creds.expiry.timestamp()),\n            refresh_token_expires_at=None,\n            scopes=google_creds.scopes,\n        )"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_setup_oauth_flow",
                            "start_line": 158,
                            "end_line": 169,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 65,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 65,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "_setup_oauth_flow"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 11,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 4,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "label": "self"
                                                                }
                                                            ],
                                                            "label": "self,"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 10,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "scopes"
                                                                },
                                                                {
                                                                    "type": "generic_type",
                                                                    "start_token": 6,
                                                                    "end_token": 10,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "label": "list"
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 9,
                                                                                    "end_token": 9,
                                                                                    "label": "str"
                                                                                }
                                                                            ],
                                                                            "label": "str"
                                                                        }
                                                                    ],
                                                                    "label": ": list[str]"
                                                                }
                                                            ],
                                                            "label": "scopes: list[str]"
                                                        }
                                                    ],
                                                    "label": "(self, scopes: list[str])"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 12,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 14,
                                                            "end_token": 14,
                                                            "label": "Flow"
                                                        }
                                                    ],
                                                    "label": "-> Flow"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 16,
                                                    "end_token": 65,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 17,
                                                            "end_token": 65,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 18,
                                                                    "end_token": 65,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 18,
                                                                            "end_token": 20,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 18,
                                                                                    "end_token": 18,
                                                                                    "label": "Flow"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 20,
                                                                                    "end_token": 20,
                                                                                    "label": "from_client_config"
                                                                                }
                                                                            ],
                                                                            "label": "Flow.from_client_config"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 21,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 23,
                                                                                    "end_token": 57,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 25,
                                                                                            "end_token": 55,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 25,
                                                                                                    "end_token": 25,
                                                                                                    "label": "\"web\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary",
                                                                                                    "start_token": 27,
                                                                                                    "end_token": 55,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 29,
                                                                                                            "end_token": 34,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 29,
                                                                                                                    "end_token": 29,
                                                                                                                    "label": "\"client_id\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 31,
                                                                                                                    "end_token": 33,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 31,
                                                                                                                            "end_token": 31,
                                                                                                                            "label": "self"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 33,
                                                                                                                            "end_token": 33,
                                                                                                                            "label": "client_id"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "self.client_id"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"client_id\": self.client_id,"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 36,
                                                                                                            "end_token": 41,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 36,
                                                                                                                    "end_token": 36,
                                                                                                                    "label": "\"client_secret\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 38,
                                                                                                                    "end_token": 40,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 38,
                                                                                                                            "end_token": 38,
                                                                                                                            "label": "self"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 40,
                                                                                                                            "end_token": 40,
                                                                                                                            "label": "client_secret"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "self.client_secret"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"client_secret\": self.client_secret,"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 43,
                                                                                                            "end_token": 46,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 43,
                                                                                                                    "end_token": 43,
                                                                                                                    "label": "\"auth_uri\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 45,
                                                                                                                    "end_token": 45,
                                                                                                                    "label": "\"https://accounts.google.com/o/oauth2/auth\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\","
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "start_token": 48,
                                                                                                            "end_token": 53,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 48,
                                                                                                                    "end_token": 48,
                                                                                                                    "label": "\"token_uri\""
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 50,
                                                                                                                    "end_token": 52,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 50,
                                                                                                                            "end_token": 50,
                                                                                                                            "label": "self"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 52,
                                                                                                                            "end_token": 52,
                                                                                                                            "label": "token_uri"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "self.token_uri"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "\"token_uri\": self.token_uri,"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "{\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }"
                                                                                                }
                                                                                            ],
                                                                                            "label": "\"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }"
                                                                                        }
                                                                                    ],
                                                                                    "label": "{\n                \"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }\n            }"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 60,
                                                                                    "end_token": 62,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 60,
                                                                                            "end_token": 60,
                                                                                            "label": "scopes"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 62,
                                                                                            "end_token": 62,
                                                                                            "label": "scopes"
                                                                                        }
                                                                                    ],
                                                                                    "label": "scopes=scopes"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            {\n                \"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }\n            },\n            scopes=scopes,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "Flow.from_client_config(\n            {\n                \"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }\n            },\n            scopes=scopes,\n        )"
                                                                }
                                                            ],
                                                            "label": "return Flow.from_client_config(\n            {\n                \"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }\n            },\n            scopes=scopes,\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        return Flow.from_client_config(\n            {\n                \"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }\n            },\n            scopes=scopes,\n        )"
                                                }
                                            ],
                                            "label": "def _setup_oauth_flow(self, scopes: list[str]) -> Flow:\n        return Flow.from_client_config(\n            {\n                \"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }\n            },\n            scopes=scopes,\n        )"
                                        }
                                    ],
                                    "label": "def _setup_oauth_flow(self, scopes: list[str]) -> Flow:\n        return Flow.from_client_config(\n            {\n                \"web\": {\n                    \"client_id\": self.client_id,\n                    \"client_secret\": self.client_secret,\n                    \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\n                    \"token_uri\": self.token_uri,\n                }\n            },\n            scopes=scopes,\n        )"
                                }
                            ]
                        }
                    ],
                    "label": "class GoogleOAuthHandler(BaseOAuthHandler):\n    \"\"\"\n    Based on the documentation at https://developers.google.com/identity/protocols/oauth2/web-server\n    \"\"\"  # noqa\n\n    PROVIDER_NAME = ProviderName.GOOGLE\n    EMAIL_ENDPOINT = \"https://www.googleapis.com/oauth2/v2/userinfo\"\n    DEFAULT_SCOPES = [\n        \"https://www.googleapis.com/auth/userinfo.email\",\n        \"https://www.googleapis.com/auth/userinfo.profile\",\n        \"openid\",\n    ]\n    # --8<-- [end:GoogleOAuthHandlerExample]"
                }
            ]
        }
    ],
    "label": "import logging\n\nfrom google.auth.external_account_authorized_user import (\n    Credentials as ExternalAccountCredentials,\n)\nfrom google.auth.transport.requests import AuthorizedSession, Request\nfrom google.oauth2.credentials import Credentials\nfrom google_auth_oauthlib.flow import Flow\nfrom pydantic import SecretStr\n\nfrom backend.data.model import OAuth2Credentials\nfrom backend.integrations.providers import ProviderName\n\nfrom .base import BaseOAuthHandler\n\nlogger = logging.getLogger(__name__)\n\n\n# --8<-- [start:GoogleOAuthHandlerExample]"
}
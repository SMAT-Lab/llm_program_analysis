{
    "type": "module",
    "start_token": 0,
    "end_token": 348,
    "children": [
        {
            "type": "import_statement",
            "start_token": 0,
            "end_token": 1,
            "children": [],
            "label": "import atexit"
        },
        {
            "type": "import_statement",
            "start_token": 3,
            "end_token": 4,
            "children": [],
            "label": "import logging"
        },
        {
            "type": "import_statement",
            "start_token": 6,
            "end_token": 7,
            "children": [],
            "label": "import multiprocessing"
        },
        {
            "type": "import_statement",
            "start_token": 9,
            "end_token": 10,
            "children": [],
            "label": "import os"
        },
        {
            "type": "import_statement",
            "start_token": 12,
            "end_token": 13,
            "children": [],
            "label": "import signal"
        },
        {
            "type": "import_statement",
            "start_token": 15,
            "end_token": 16,
            "children": [],
            "label": "import sys"
        },
        {
            "type": "import_statement",
            "start_token": 18,
            "end_token": 19,
            "children": [],
            "label": "import threading"
        },
        {
            "type": "import_from_statement",
            "start_token": 21,
            "end_token": 28,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 22,
                    "end_token": 24,
                    "children": [],
                    "label": "concurrent.futures"
                },
                {
                    "type": "identifier",
                    "start_token": 26,
                    "end_token": 26,
                    "children": [],
                    "label": "Future"
                },
                {
                    "type": "identifier",
                    "start_token": 28,
                    "end_token": 28,
                    "children": [],
                    "label": "ProcessPoolExecutor"
                }
            ],
            "label": "from concurrent.futures import Future, ProcessPoolExecutor"
        },
        {
            "type": "import_from_statement",
            "start_token": 30,
            "end_token": 33,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 31,
                    "end_token": 31,
                    "children": [],
                    "label": "contextlib"
                },
                {
                    "type": "identifier",
                    "start_token": 33,
                    "end_token": 33,
                    "children": [],
                    "label": "contextmanager"
                }
            ],
            "label": "from contextlib import contextmanager"
        },
        {
            "type": "import_from_statement",
            "start_token": 35,
            "end_token": 42,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 36,
                    "end_token": 38,
                    "children": [],
                    "label": "multiprocessing.pool"
                },
                {
                    "type": "identifier",
                    "start_token": 40,
                    "end_token": 40,
                    "children": [],
                    "label": "AsyncResult"
                },
                {
                    "type": "identifier",
                    "start_token": 42,
                    "end_token": 42,
                    "children": [],
                    "label": "Pool"
                }
            ],
            "label": "from multiprocessing.pool import AsyncResult, Pool"
        },
        {
            "type": "import_from_statement",
            "start_token": 44,
            "end_token": 55,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 45,
                    "end_token": 45,
                    "children": [],
                    "label": "typing"
                },
                {
                    "type": "identifier",
                    "start_token": 47,
                    "end_token": 47,
                    "children": [],
                    "label": "TYPE_CHECKING"
                },
                {
                    "type": "identifier",
                    "start_token": 49,
                    "end_token": 49,
                    "children": [],
                    "label": "Any"
                },
                {
                    "type": "identifier",
                    "start_token": 51,
                    "end_token": 51,
                    "children": [],
                    "label": "Generator"
                },
                {
                    "type": "identifier",
                    "start_token": 53,
                    "end_token": 53,
                    "children": [],
                    "label": "TypeVar"
                },
                {
                    "type": "identifier",
                    "start_token": 55,
                    "end_token": 55,
                    "children": [],
                    "label": "cast"
                }
            ],
            "label": "from typing import TYPE_CHECKING, Any, Generator, TypeVar, cast"
        },
        {
            "type": "import_from_statement",
            "start_token": 58,
            "end_token": 61,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 59,
                    "end_token": 59,
                    "children": [],
                    "label": "pydantic"
                },
                {
                    "type": "identifier",
                    "start_token": 61,
                    "end_token": 61,
                    "children": [],
                    "label": "BaseModel"
                }
            ],
            "label": "from pydantic import BaseModel"
        },
        {
            "type": "import_from_statement",
            "start_token": 63,
            "end_token": 70,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 64,
                    "end_token": 66,
                    "children": [],
                    "label": "redis.lock"
                },
                {
                    "type": "as_pattern",
                    "start_token": 68,
                    "end_token": 70,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 68,
                            "end_token": 68,
                            "children": [],
                            "label": "Lock"
                        },
                        {
                            "type": "identifier",
                            "start_token": 70,
                            "end_token": 70,
                            "children": [],
                            "label": "RedisLock"
                        }
                    ],
                    "label": "Lock as RedisLock"
                }
            ],
            "label": "from redis.lock import Lock as RedisLock"
        },
        {
            "type": "if_statement",
            "start_token": 73,
            "end_token": 83,
            "children": [
                {
                    "type": "boolean_operator",
                    "start_token": 74,
                    "end_token": 74,
                    "children": [],
                    "label": "TYPE_CHECKING"
                },
                {
                    "type": "import_from_statement",
                    "start_token": 77,
                    "end_token": 82,
                    "children": [
                        {
                            "type": "dotted_name",
                            "start_token": 78,
                            "end_token": 80,
                            "children": [],
                            "label": "backend.executor"
                        },
                        {
                            "type": "identifier",
                            "start_token": 82,
                            "end_token": 82,
                            "children": [],
                            "label": "DatabaseManager"
                        }
                    ],
                    "label": "from backend.executor import DatabaseManager"
                }
            ],
            "label": "if TYPE_CHECKING:\n    from backend.executor import DatabaseManager\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 85,
            "end_token": 92,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 86,
                    "end_token": 90,
                    "children": [],
                    "label": "autogpt_libs.utils.cache"
                },
                {
                    "type": "identifier",
                    "start_token": 92,
                    "end_token": 92,
                    "children": [],
                    "label": "thread_cached"
                }
            ],
            "label": "from autogpt_libs.utils.cache import thread_cached"
        },
        {
            "type": "import_from_statement",
            "start_token": 95,
            "end_token": 102,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 96,
                    "end_token": 100,
                    "children": [],
                    "label": "backend.blocks.agent"
                },
                {
                    "type": "identifier",
                    "start_token": 102,
                    "end_token": 102,
                    "children": [],
                    "label": "AgentExecutorBlock"
                }
            ],
            "label": "from backend.blocks.agent import AgentExecutorBlock"
        },
        {
            "type": "import_from_statement",
            "start_token": 104,
            "end_token": 109,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 105,
                    "end_token": 107,
                    "children": [],
                    "label": "backend.data"
                },
                {
                    "type": "identifier",
                    "start_token": 109,
                    "end_token": 109,
                    "children": [],
                    "label": "redis"
                }
            ],
            "label": "from backend.data import redis"
        },
        {
            "type": "import_from_statement",
            "start_token": 111,
            "end_token": 127,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 112,
                    "end_token": 116,
                    "children": [],
                    "label": "backend.data.block"
                },
                {
                    "type": "expression_list",
                    "start_token": 118,
                    "end_token": 126,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 118,
                            "end_token": 118,
                            "children": [],
                            "label": "Block"
                        },
                        {
                            "type": "identifier",
                            "start_token": 120,
                            "end_token": 120,
                            "children": [],
                            "label": "BlockData"
                        },
                        {
                            "type": "identifier",
                            "start_token": 122,
                            "end_token": 122,
                            "children": [],
                            "label": "BlockInput"
                        },
                        {
                            "type": "identifier",
                            "start_token": 124,
                            "end_token": 124,
                            "children": [],
                            "label": "BlockType"
                        },
                        {
                            "type": "identifier",
                            "start_token": 126,
                            "end_token": 126,
                            "children": [],
                            "label": "get_block"
                        }
                    ],
                    "label": "Block, BlockData, BlockInput, BlockType, get_block"
                }
            ],
            "label": "from backend.data.block import Block, BlockData, BlockInput, BlockType, get_block\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 129,
            "end_token": 172,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 130,
                    "end_token": 165,
                    "children": [],
                    "label": ".data.execution import (\n    ExecutionQueue,\n    ExecutionResult,\n    ExecutionStatus,\n    GraphExecutionEntry,\n    NodeExecutionEntry,\n    merge_execution_input,\n    parse_execution_output,\n)\nfrom backend.data.graph"
                },
                {
                    "type": "expression_list",
                    "start_token": 167,
                    "end_token": 171,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 167,
                            "end_token": 167,
                            "children": [],
                            "label": "GraphModel"
                        },
                        {
                            "type": "identifier",
                            "start_token": 169,
                            "end_token": 169,
                            "children": [],
                            "label": "Link"
                        },
                        {
                            "type": "identifier",
                            "start_token": 171,
                            "end_token": 171,
                            "children": [],
                            "label": "Node"
                        }
                    ],
                    "label": "GraphModel, Link, Node"
                }
            ],
            "label": "backend.data.execution import (\n    ExecutionQueue,\n    ExecutionResult,\n    ExecutionStatus,\n    GraphExecutionEntry,\n    NodeExecutionEntry,\n    merge_execution_input,\n    parse_execution_output,\n)\nfrom backend.data.graph import GraphModel, Link, Node\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 174,
            "end_token": 183,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 175,
                    "end_token": 178,
                    "children": [],
                    "label": ".data.model"
                },
                {
                    "type": "expression_list",
                    "start_token": 180,
                    "end_token": 182,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 180,
                            "end_token": 180,
                            "children": [],
                            "label": "CREDENTIALS_FIELD_NAME"
                        },
                        {
                            "type": "identifier",
                            "start_token": 182,
                            "end_token": 182,
                            "children": [],
                            "label": "CredentialsMetaInput"
                        }
                    ],
                    "label": "CREDENTIALS_FIELD_NAME, CredentialsMetaInput"
                }
            ],
            "label": "backend.data.model import CREDENTIALS_FIELD_NAME, CredentialsMetaInput\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 185,
            "end_token": 191,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 186,
                    "end_token": 189,
                    "children": [],
                    "label": ".integrations.creds_manager"
                },
                {
                    "type": "identifier",
                    "start_token": 191,
                    "end_token": 191,
                    "children": [],
                    "label": "IntegrationCredentialsManager"
                }
            ],
            "label": "backend.integrations.creds_manager import IntegrationCredentialsManager"
        },
        {
            "type": "import_from_statement",
            "start_token": 193,
            "end_token": 198,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 194,
                    "end_token": 196,
                    "children": [],
                    "label": "backend.util"
                },
                {
                    "type": "identifier",
                    "start_token": 198,
                    "end_token": 198,
                    "children": [],
                    "label": "json"
                }
            ],
            "label": "from backend.util import json"
        },
        {
            "type": "import_from_statement",
            "start_token": 200,
            "end_token": 209,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 201,
                    "end_token": 205,
                    "children": [],
                    "label": "backend.util.decorator"
                },
                {
                    "type": "expression_list",
                    "start_token": 207,
                    "end_token": 209,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 207,
                            "end_token": 207,
                            "children": [],
                            "label": "error_logged"
                        },
                        {
                            "type": "identifier",
                            "start_token": 209,
                            "end_token": 209,
                            "children": [],
                            "label": "time_measured"
                        }
                    ],
                    "label": "error_logged, time_measured"
                }
            ],
            "label": "from backend.util.decorator import error_logged, time_measured"
        },
        {
            "type": "import_from_statement",
            "start_token": 211,
            "end_token": 218,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 212,
                    "end_token": 216,
                    "children": [],
                    "label": "backend.util.logging"
                },
                {
                    "type": "identifier",
                    "start_token": 218,
                    "end_token": 218,
                    "children": [],
                    "label": "configure_logging"
                }
            ],
            "label": "from backend.util.logging import configure_logging"
        },
        {
            "type": "import_from_statement",
            "start_token": 220,
            "end_token": 227,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 221,
                    "end_token": 225,
                    "children": [],
                    "label": "backend.util.process"
                },
                {
                    "type": "identifier",
                    "start_token": 227,
                    "end_token": 227,
                    "children": [],
                    "label": "set_service_name"
                }
            ],
            "label": "from backend.util.process import set_service_name"
        },
        {
            "type": "import_from_statement",
            "start_token": 229,
            "end_token": 260,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 230,
                    "end_token": 234,
                    "children": [],
                    "label": "backend.util.service"
                },
                {
                    "type": "expression_list",
                    "start_token": 238,
                    "end_token": 259,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 238,
                            "end_token": 238,
                            "children": [],
                            "label": "AppService"
                        },
                        {
                            "type": "identifier",
                            "start_token": 241,
                            "end_token": 241,
                            "children": [],
                            "label": "close_service_client"
                        },
                        {
                            "type": "identifier",
                            "start_token": 244,
                            "end_token": 244,
                            "children": [],
                            "label": "expose"
                        },
                        {
                            "type": "identifier",
                            "start_token": 247,
                            "end_token": 247,
                            "children": [],
                            "label": "get_service_client"
                        }
                    ],
                    "label": "AppService,\n    close_service_client,\n    expose,\n    get_service_client,\n)\nfrom backend.util.settings import Settings"
                }
            ],
            "label": "from backend.util.service import (\n    AppService,\n    close_service_client,\n    expose,\n    get_service_client,\n)\nfrom backend.util.settings import Settings\n"
        },
        {
            "type": "import_from_statement",
            "start_token": 252,
            "end_token": 259,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 253,
                    "end_token": 257,
                    "children": [],
                    "label": "backend.util.settings"
                },
                {
                    "type": "identifier",
                    "start_token": 259,
                    "end_token": 259,
                    "children": [],
                    "label": "Settings"
                }
            ],
            "label": "from backend.util.settings import Settings"
        },
        {
            "type": "import_from_statement",
            "start_token": 261,
            "end_token": 265,
            "children": [
                {
                    "type": "dotted_name",
                    "start_token": 262,
                    "end_token": 266,
                    "children": [],
                    "label": "backend.util.type"
                },
                {
                    "type": "identifier",
                    "start_token": 268,
                    "end_token": 268,
                    "children": [],
                    "label": "convert"
                }
            ],
            "label": "from backend.util."
        },
        {
            "type": "assignment",
            "start_token": 271,
            "end_token": 278,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 271,
                    "end_token": 271,
                    "children": [],
                    "label": "logger"
                },
                {
                    "type": "call",
                    "start_token": 273,
                    "end_token": 278,
                    "children": [
                        {
                            "type": "dotted_name",
                            "start_token": 273,
                            "end_token": 275,
                            "children": [],
                            "label": "logging.getLogger"
                        },
                        {
                            "type": "expression_list",
                            "start_token": 276,
                            "end_token": 277,
                            "children": [],
                            "label": "(__name__"
                        }
                    ],
                    "label": "logging.getLogger(__name__)"
                }
            ],
            "label": "logger = logging.getLogger(__name__)"
        },
        {
            "type": "assignment",
            "start_token": 280,
            "end_token": 284,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 280,
                    "end_token": 280,
                    "children": [],
                    "label": "settings"
                },
                {
                    "type": "call",
                    "start_token": 282,
                    "end_token": 284,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 282,
                            "end_token": 282,
                            "children": [],
                            "label": "Settings"
                        },
                        {
                            "type": "expression_list",
                            "start_token": 283,
                            "end_token": 283,
                            "children": [],
                            "label": "("
                        }
                    ],
                    "label": "Settings()"
                }
            ],
            "label": "settings = Settings()"
        },
        {
            "type": "assignment",
            "start_token": 290,
            "end_token": 295,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 290,
                    "end_token": 290,
                    "children": [],
                    "label": "T"
                },
                {
                    "type": "call",
                    "start_token": 292,
                    "end_token": 295,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 292,
                            "end_token": 292,
                            "children": [],
                            "label": "TypeVar"
                        },
                        {
                            "type": "expression_list",
                            "start_token": 294,
                            "end_token": 294,
                            "children": [
                                {
                                    "type": "string",
                                    "start_token": 294,
                                    "end_token": 294,
                                    "children": [],
                                    "label": "\"T\""
                                }
                            ],
                            "label": "\"T\""
                        }
                    ],
                    "label": "TypeVar(\"T\")"
                }
            ],
            "label": "T = TypeVar(\"T\")"
        },
        {
            "type": "assignment",
            "start_token": 297,
            "end_token": 306,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 297,
                    "end_token": 297,
                    "children": [],
                    "label": "ExecutionStream"
                },
                {
                    "type": "generic_type",
                    "start_token": 299,
                    "end_token": 305,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 299,
                            "end_token": 299,
                            "children": [],
                            "label": "Generator"
                        },
                        {
                            "type": "type_parameter",
                            "start_token": 301,
                            "end_token": 303,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 301,
                                    "end_token": 301,
                                    "children": [],
                                    "label": "NodeExecutionEntry"
                                },
                                {
                                    "type": "none",
                                    "start_token": 303,
                                    "end_token": 303,
                                    "children": [],
                                    "label": "None"
                                }
                            ],
                            "label": "NodeExecutionEntry, None"
                        }
                    ],
                    "label": "Generator[NodeExecutionEntry, None, None"
                }
            ],
            "label": "ExecutionStream = Generator[NodeExecutionEntry, None, None]"
        },
        {
            "type": "comment",
            "start_token": 319,
            "end_token": 335,
            "children": [],
            "label": "# ------- UTILITIES ------- #"
        },
        {
            "type": "decorator",
            "start_token": 339,
            "end_token": 340,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 340,
                    "end_token": 340,
                    "children": [],
                    "label": "thread_cached"
                }
            ],
            "label": "@thread_cached"
        },
        {
            "type": "decorator",
            "start_token": 344,
            "end_token": 345,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 345,
                    "end_token": 345,
                    "children": [],
                    "label": "contextmanager"
                }
            ],
            "label": "@contextmanager"
        },
        {
            "type": "function_placeholder",
            "name": "execute_node",
            "start_line": 102,
            "end_line": 245,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 810,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 810,
                            "children": [
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 33,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 6,
                                            "label": "db_client: \"DatabaseManager\""
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 9,
                                            "end_token": 11,
                                            "label": "creds_manager: IntegrationCredentialsManager"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 14,
                                            "end_token": 16,
                                            "label": "data: NodeExecutionEntry"
                                        },
                                        {
                                            "type": "typed_default_parameter",
                                            "start_token": 19,
                                            "end_token": 30,
                                            "children": [
                                                {
                                                    "type": "none",
                                                    "start_token": 30,
                                                    "end_token": 30,
                                                    "label": "None"
                                                }
                                            ],
                                            "label": "execution_stats: dict[str, Any] | None = None"
                                        }
                                    ],
                                    "label": "(\n    db_client: \"DatabaseManager\",\n    creds_manager: IntegrationCredentialsManager,\n    data: NodeExecutionEntry,\n    execution_stats: dict[str, Any] | None = None,\n)"
                                },
                                {
                                    "type": "string",
                                    "start_token": 39,
                                    "end_token": 41,
                                    "label": "\"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\""
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 43,
                                    "end_token": 47,
                                    "label": "user_id = data.user_id"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 49,
                                    "end_token": 53,
                                    "label": "graph_exec_id = data.graph_exec_id"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 55,
                                    "end_token": 59,
                                    "label": "graph_id = data.graph_id"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 61,
                                    "end_token": 65,
                                    "label": "node_exec_id = data.node_exec_id"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 67,
                                    "end_token": 71,
                                    "label": "node_id = data.node_id"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 75,
                                    "end_token": 82,
                                    "label": "node = db_client.get_node(node_id)"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 85,
                                    "end_token": 92,
                                    "label": "node_block = get_block(node.block_id)"
                                },
                                {
                                    "type": "if_statement",
                                    "start_token": 94,
                                    "end_token": 108,
                                    "children": [
                                        {
                                            "type": "comparison_operator",
                                            "start_token": 95,
                                            "end_token": 96,
                                            "label": "not node_block"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 99,
                                            "end_token": 108,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 99,
                                                    "end_token": 105,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 103,
                                                            "end_token": 105,
                                                            "label": "f\"Block {node.block_id} not found.\")"
                                                        }
                                                    ],
                                                    "label": "logger.error(f\"Block {node.block_id} not found.\")"
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 107,
                                                    "end_token": 108,
                                                    "label": "return\n"
                                                }
                                            ],
                                            "label": "logger.error(f\"Block {node.block_id} not found.\")\n        return\n"
                                        }
                                    ],
                                    "label": "if not node_block:\n        logger.error(f\"Block {node.block_id} not found.\")\n        return\n"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 110,
                                    "end_token": 147,
                                    "children": [
                                        {
                                            "type": "argument_list",
                                            "start_token": 113,
                                            "end_token": 147,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 115,
                                                    "end_token": 117,
                                                    "label": "user_id=user_id"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 120,
                                                    "end_token": 122,
                                                    "label": "graph_eid=graph_exec_id"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 125,
                                                    "end_token": 127,
                                                    "label": "graph_id=graph_id"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 130,
                                                    "end_token": 132,
                                                    "label": "node_eid=node_exec_id"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 135,
                                                    "end_token": 137,
                                                    "label": "node_id=node_id"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 140,
                                                    "end_token": 145,
                                                    "label": "block_name=node_block.name,"
                                                }
                                            ],
                                            "label": "(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )"
                                        }
                                    ],
                                    "label": "log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )"
                                },
                                {
                                    "type": "call",
                                    "start_token": 160,
                                    "end_token": 175,
                                    "children": [
                                        {
                                            "type": "argument_list",
                                            "start_token": 165,
                                            "end_token": 175,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 169,
                                                    "end_token": 170,
                                                    "label": ".data"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 173,
                                                    "end_token": 174,
                                                    "label": "=False"
                                                }
                                            ],
                                            "label": "(node, data.data, resolve_input=False)"
                                        }
                                    ],
                                    "label": "input_data, error = validate_exec(node, data.data, resolve_input=False)"
                                },
                                {
                                    "type": "if_statement",
                                    "start_token": 177,
                                    "end_token": 209,
                                    "children": [
                                        {
                                            "type": "comparison_operator",
                                            "start_token": 179,
                                            "end_token": 180,
                                            "label": "is None"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 183,
                                            "end_token": 209,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 183,
                                                    "end_token": 189,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 187,
                                                            "end_token": 189,
                                                            "label": "f\"Skip execution, input validation error: {error}\")"
                                                        }
                                                    ],
                                                    "label": "log_metadata.error(f\"Skip execution, input validation error: {error}\")"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 191,
                                                    "end_token": 200,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 197,
                                                            "end_token": 199,
                                                            "label": "\"error\", error"
                                                        }
                                                    ],
                                                    "label": "db_client.upsert_execution_output(node_exec_id, \"error\", error)"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 202,
                                                    "end_token": 207,
                                                    "label": "update_execution(ExecutionStatus.FAILED)"
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "start_token": 209,
                                                    "end_token": 209,
                                                    "label": "return"
                                                }
                                            ],
                                            "label": "log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return"
                                        }
                                    ],
                                    "label": "if input_data is None:\n        log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return"
                                },
                                {
                                    "type": "if_statement",
                                    "start_token": 236,
                                    "end_token": 244,
                                    "children": [
                                        {
                                            "type": "call",
                                            "start_token": 237,
                                            "end_token": 239,
                                            "label": "isinstance(node_block"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 243,
                                            "end_token": 244,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 245,
                                                    "end_token": 257,
                                                    "children": [
                                                        {
                                                            "type": "dictionary",
                                                            "start_token": 247,
                                                            "end_token": 257,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 248,
                                                                    "end_token": 252,
                                                                    "label": "**node.input_default"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 254,
                                                                    "end_token": 256,
                                                                    "label": "\"data\": input_data"
                                                                }
                                                            ],
                                                            "label": "{**node.input_default, \"data\": input_data}"
                                                        }
                                                    ],
                                                    "label": "input_data = {**node.input_default, \"data\": input_data}"
                                                }
                                            ],
                                            "label": ":\n"
                                        }
                                    ],
                                    "label": "if isinstance(node_block, AgentExecutorBlock):\n"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 265,
                                    "end_token": 272,
                                    "children": [
                                        {
                                            "type": "call",
                                            "start_token": 268,
                                            "end_token": 272,
                                            "label": ".dumps(input_data)"
                                        }
                                    ],
                                    "label": "input_data_str = json.dumps(input_data)"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 274,
                                    "end_token": 280,
                                    "children": [
                                        {
                                            "type": "call",
                                            "start_token": 276,
                                            "end_token": 280,
                                            "label": "len(input_data_str)\n"
                                        }
                                    ],
                                    "label": "input_size = len(input_data_str)\n"
                                },
                                {
                                    "type": "call",
                                    "start_token": 281,
                                    "end_token": 290,
                                    "children": [
                                        {
                                            "type": "pair",
                                            "start_token": 286,
                                            "end_token": 289,
                                            "label": ", input=input_data_str"
                                        }
                                    ],
                                    "label": "log_metadata.info(\"Executed node with input\", input=input_data_str)"
                                },
                                {
                                    "type": "call",
                                    "start_token": 292,
                                    "end_token": 297,
                                    "label": "update_execution(ExecutionStatus.RUNNING)"
                                },
                                {
                                    "type": "assignment",
                                    "start_token": 300,
                                    "end_token": 303,
                                    "children": [
                                        {
                                            "type": "dictionary",
                                            "start_token": 302,
                                            "end_token": 303,
                                            "label": "{}"
                                        }
                                    ],
                                    "label": "extra_exec_kwargs = {}"
                                },
                                {
                                    "type": "if_statement",
                                    "start_token": 371,
                                    "end_token": 647,
                                    "children": [
                                        {
                                            "type": "comparison_operator",
                                            "start_token": 373,
                                            "end_token": 374,
                                            "label": "in input_data"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 377,
                                            "end_token": 647,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 377,
                                                    "end_token": 387,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 379,
                                                            "end_token": 387,
                                                            "label": "CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])"
                                                        }
                                                    ],
                                                    "label": "credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 389,
                                                    "end_token": 402,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 393,
                                                            "end_token": 402,
                                                            "label": "creds_manager.acquire(user_id, credentials_meta.id)"
                                                        }
                                                    ],
                                                    "label": "credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 404,
                                                    "end_token": 409,
                                                    "label": "extra_exec_kwargs[\"credentials\"] = credentials"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 412,
                                                    "end_token": 414,
                                                    "label": "output_size = 0"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 416,
                                                    "end_token": 420,
                                                    "label": "end_status = ExecutionStatus.COMPLETED"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 422,
                                                    "end_token": 429,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 426,
                                                            "end_token": 429,
                                                            "label": "get_or_refill_credit(user_id)"
                                                        }
                                                    ],
                                                    "label": "credit = db_client.get_or_refill_credit(user_id)"
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "start_token": 431,
                                                    "end_token": 442,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 433,
                                                            "end_token": 434,
                                                            "label": "< 0"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 437,
                                                            "end_token": 442,
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 437,
                                                                    "end_token": 442,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 439,
                                                                            "end_token": 442,
                                                                            "label": "(f\"Insufficient credit: {credit}\")"
                                                                        }
                                                                    ],
                                                                    "label": "raise ValueError(f\"Insufficient credit: {credit}\")"
                                                                }
                                                            ],
                                                            "label": "raise ValueError(f\"Insufficient credit: {credit}\")"
                                                        }
                                                    ],
                                                    "label": "if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")"
                                                },
                                                {
                                                    "type": "try_statement",
                                                    "start_token": 445,
                                                    "end_token": 652,
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "start_token": 446,
                                                            "end_token": 556,
                                                            "children": [
                                                                {
                                                                    "type": "for_statement",
                                                                    "start_token": 448,
                                                                    "end_token": 557,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 453,
                                                                            "end_token": 464,
                                                                            "children": [
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 458,
                                                                                    "end_token": 463,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 459,
                                                                                            "end_token": 460,
                                                                                            "label": ", *"
                                                                                        }
                                                                                    ],
                                                                                    "label": "input_data, **extra_exec_kwargs\n"
                                                                                }
                                                                            ],
                                                                            "label": "node_block.execute(\n            input_data, **extra_exec_kwargs\n        )"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 466,
                                                                            "end_token": 557,
                                                                            "children": [
                                                                                {
                                                                                    "type": "augmented_assignment",
                                                                                    "start_token": 467,
                                                                                    "end_token": 478,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 471,
                                                                                            "end_token": 478,
                                                                                            "label": "(json.dumps(output_data))"
                                                                                        }
                                                                                    ],
                                                                                    "label": "output_size += len(json.dumps(output_data))"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 480,
                                                                                    "end_token": 493,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 486,
                                                                                            "end_token": 492,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 489,
                                                                                                    "end_token": 491,
                                                                                                    "label": "output_name: output_data"
                                                                                                }
                                                                                            ],
                                                                                            "label": "**{output_name: output_data}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "log_metadata.info(\"Node produced output\", **{output_name: output_data})"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 495,
                                                                                    "end_token": 504,
                                                                                    "label": "db_client.upsert_execution_output(node_exec_id, output_name, output_data)"
                                                                                },
                                                                                {
                                                                                    "type": "for_statement",
                                                                                    "start_token": 507,
                                                                                    "end_token": 557,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 511,
                                                                                            "end_token": 552,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 514,
                                                                                                    "end_token": 549,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 514,
                                                                                                            "end_token": 515,
                                                                                                            "label": "=db_client"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 518,
                                                                                                            "end_token": 519,
                                                                                                            "label": "node="
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 523,
                                                                                                            "end_token": 525,
                                                                                                            "label": "output=("
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 533,
                                                                                                            "end_token": 534,
                                                                                                            "label": "=user_id"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 537,
                                                                                                            "end_token": 539,
                                                                                                            "label": "graph_exec_id=graph_exec_id"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 542,
                                                                                                            "end_token": 544,
                                                                                                            "label": "graph_id=graph_id"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 548,
                                                                                                            "end_token": 549,
                                                                                                            "label": "=log_metadata"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            )"
                                                                                        },
                                                                                        {
                                                                                            "type": "block",
                                                                                            "start_token": 553,
                                                                                            "end_token": 557,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "yield",
                                                                                                    "start_token": 555,
                                                                                                    "end_token": 557,
                                                                                                    "label": "yield execution\n"
                                                                                                }
                                                                                            ],
                                                                                            "label": ":\n                yield execution\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n"
                                                                                }
                                                                            ],
                                                                            "label": "\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n"
                                                                        }
                                                                    ],
                                                                    "label": "for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n"
                                                                }
                                                            ],
                                                            "label": ":\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution"
                                                        },
                                                        {
                                                            "type": "except_clause",
                                                            "start_token": 559,
                                                            "end_token": 652,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 563,
                                                                    "end_token": 648,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 565,
                                                                            "end_token": 569,
                                                                            "label": "end_status = ExecutionStatus.FAILED"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 571,
                                                                            "end_token": 576,
                                                                            "label": "error_msg = str(e)"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 578,
                                                                            "end_token": 584,
                                                                            "label": "log_metadata.exception(f\"Node execution failed with error {error_msg}\")"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 586,
                                                                            "end_token": 595,
                                                                            "label": "db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)"
                                                                        },
                                                                        {
                                                                            "type": "for_statement",
                                                                            "start_token": 598,
                                                                            "end_token": 648,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 602,
                                                                                    "end_token": 643,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 605,
                                                                                            "end_token": 640,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 605,
                                                                                                    "end_token": 606,
                                                                                                    "label": "=db_client"
                                                                                                },
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 609,
                                                                                                    "end_token": 611,
                                                                                                    "label": "node=node"
                                                                                                },
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 615,
                                                                                                    "end_token": 617,
                                                                                                    "label": "=(\"error\""
                                                                                                },
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 623,
                                                                                                    "end_token": 625,
                                                                                                    "label": "user_id=user_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 628,
                                                                                                    "end_token": 630,
                                                                                                    "label": "graph_exec_id=graph_exec_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 633,
                                                                                                    "end_token": 635,
                                                                                                    "label": "graph_id=graph_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "start_token": 639,
                                                                                                    "end_token": 640,
                                                                                                    "label": "=log_metadata"
                                                                                                }
                                                                                            ],
                                                                                            "label": "=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        )"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 644,
                                                                                    "end_token": 648,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "yield",
                                                                                            "start_token": 646,
                                                                                            "end_token": 648,
                                                                                            "label": "yield execution\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": ":\n            yield execution\n"
                                                                                }
                                                                            ],
                                                                            "label": "for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n"
                                                                        }
                                                                    ],
                                                                    "label": ":\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n"
                                                                }
                                                            ],
                                                            "label": "except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n"
                                                        },
                                                        {
                                                            "type": "finally_clause",
                                                            "start_token": 653,
                                                            "end_token": 810,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 655,
                                                                    "end_token": 810,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 666,
                                                                            "end_token": 692,
                                                                            "children": [
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 669,
                                                                                    "end_token": 692,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "try_statement",
                                                                                            "start_token": 670,
                                                                                            "end_token": 692,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": 672,
                                                                                                    "end_token": 678,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 673,
                                                                                                            "end_token": 677,
                                                                                                            "label": "creds_lock.release()"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\n                creds_lock.release()\n"
                                                                                                },
                                                                                                {
                                                                                                    "type": "except_clause",
                                                                                                    "start_token": 679,
                                                                                                    "end_token": 687,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "block",
                                                                                                            "start_token": 683,
                                                                                                            "end_token": 687,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "start_token": 685,
                                                                                                                    "end_token": 691,
                                                                                                                    "label": "log_metadata.error(f\"Failed to release credentials lock: {e}\")"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": ":\n                log_metadata.error"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "except Exception as e:\n                log_metadata.error"
                                                                                                }
                                                                                            ],
                                                                                            "label": "try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n"
                                                                                }
                                                                            ],
                                                                            "label": "if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 702,
                                                                            "end_token": 707,
                                                                            "label": "res = update_execution(end_status)"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 709,
                                                                            "end_token": 773,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 711,
                                                                                    "end_token": 713,
                                                                                    "label": "== ExecutionStatus"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 717,
                                                                                    "end_token": 773,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 718,
                                                                                            "end_token": 723,
                                                                                            "label": "s = input_size + output_size\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 725,
                                                                                            "end_token": 740,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "conditional_expression",
                                                                                                    "start_token": 729,
                                                                                                    "end_token": 750,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "binary_operator",
                                                                                                            "start_token": 731,
                                                                                                            "end_token": 736,
                                                                                                            "label": "end_time - res.start_time)"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "none",
                                                                                                            "start_token": 752,
                                                                                                            "end_token": 752,
                                                                                                            "label": "0"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n"
                                                                                                }
                                                                                            ],
                                                                                            "label": "= (\n                (res.end_time - res.start_time).total_seconds()"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 756,
                                                                                            "end_token": 773,
                                                                                            "label": "db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)"
                                                                                }
                                                                            ],
                                                                            "label": "if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 781,
                                                                            "end_token": 809,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 783,
                                                                                    "end_token": 784,
                                                                                    "label": "is not"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 787,
                                                                                    "end_token": 809,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 789,
                                                                                            "end_token": 795,
                                                                                            "label": ".update(node_block.execution_stats)"
                                                                                        },
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 797,
                                                                                            "end_token": 803,
                                                                                            "label": "execution_stats[\"input_size\"] = input_size\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 804,
                                                                                            "end_token": 809,
                                                                                            "label": "execution_stats[\"output_size\"] = output_size"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size"
                                                                                }
                                                                            ],
                                                                            "label": "if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size"
                                                                        }
                                                                    ],
                                                                    "label": "\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size\n"
                                                                }
                                                            ],
                                                            "label": "finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size\n"
                                                        }
                                                    ],
                                                    "label": "try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n"
                                                }
                                            ],
                                            "label": "credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials\n\n    output_size = 0\n    end_status = ExecutionStatus.COMPLETED\n    credit = db_client.get_or_refill_credit(user_id)\n    if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")\n\n    try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution"
                                        }
                                    ],
                                    "label": "if CREDENTIALS_FIELD_NAME in input_data:\n        credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials\n\n    output_size = 0\n    end_status = ExecutionStatus.COMPLETED\n    credit = db_client.get_or_refill_credit(user_id)\n    if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")\n\n    try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution"
                                }
                            ],
                            "label": "def execute_node(\n    db_client: \"DatabaseManager\",\n    creds_manager: IntegrationCredentialsManager,\n    data: NodeExecutionEntry,\n    execution_stats: dict[str, Any] | None = None,\n) -> ExecutionStream:\n    \"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\"\n    user_id = data.user_id\n    graph_exec_id = data.graph_exec_id\n    graph_id = data.graph_id\n    node_exec_id = data.node_exec_id\n    node_id = data.node_id\n\n\n    node = db_client.get_node(node_id)\n\n    node_block = get_block(node.block_id)\n    if not node_block:\n        logger.error(f\"Block {node.block_id} not found.\")\n        return\n\n    log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )\n\n    # Sanity check: validate the execution input.\n    input_data, error = validate_exec(node, data.data, resolve_input=False)\n    if input_data is None:\n        log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return\n\n    # Re-shape the input data for agent block.\n    # AgentExecutorBlock specially separate the node input_data & its input_default.\n    if isinstance(node_block, AgentExecutorBlock):\n        input_data = {**node.input_default, \"data\": input_data}\n\n    # Execute the node\n    input_data_str = json.dumps(input_data)\n    input_size = len(input_data_str)\n    log_metadata.info(\"Executed node with input\", input=input_data_str)\n    update_execution(ExecutionStatus.RUNNING)\n\n    extra_exec_kwargs = {}\n    # Last-minute fetch credentials + acquire a system-wide read-write lock to prevent\n    # changes during execution.  This means a set of credentials can only be used by\n    # one (running) block at a time; simultaneous execution of blocks using same\n    # credentials is not supported.\n    creds_lock = None\n    if CREDENTIALS_FIELD_NAME in input_data:\n        credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials\n\n    output_size = 0\n    end_status = ExecutionStatus.COMPLETED\n    credit = db_client.get_or_refill_credit(user_id)\n    if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")\n\n    try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n    finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size\n"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "update_execution",
                            "start_line": 127,
                            "end_line": 130,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 31,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 31,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 6,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 5,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "label": "status"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "ExecutionStatus"
                                                                }
                                                            ],
                                                            "label": "status: ExecutionStatus"
                                                        }
                                                    ],
                                                    "label": "(status: ExecutionStatus)"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 8,
                                                    "end_token": 9,
                                                    "label": "> ExecutionResult"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 11,
                                                    "end_token": 31,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 12,
                                                            "end_token": 21,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "label": "exec_update"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 14,
                                                                    "end_token": 21,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 14,
                                                                            "end_token": 16,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 14,
                                                                                    "end_token": 14,
                                                                                    "label": "db_client"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 16,
                                                                                    "end_token": 16,
                                                                                    "label": "update_execution_status"
                                                                                }
                                                                            ],
                                                                            "label": "db_client.update_execution_status"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 17,
                                                                            "end_token": 21,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 18,
                                                                                    "end_token": 18,
                                                                                    "label": "node_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 20,
                                                                                    "end_token": 20,
                                                                                    "label": "status"
                                                                                }
                                                                            ],
                                                                            "label": "(node_exec_id, status)"
                                                                        }
                                                                    ],
                                                                    "label": "db_client.update_execution_status(node_exec_id, status)"
                                                                }
                                                            ],
                                                            "label": "exec_update = db_client.update_execution_status(node_exec_id, status)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 23,
                                                            "end_token": 28,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 23,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 23,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "db_client"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "label": "send_execution_update"
                                                                                }
                                                                            ],
                                                                            "label": "db_client.send_execution_update"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 26,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "label": "exec_update"
                                                                                }
                                                                            ],
                                                                            "label": "(exec_update)"
                                                                        }
                                                                    ],
                                                                    "label": "db_client.send_execution_update(exec_update)"
                                                                }
                                                            ],
                                                            "label": "db_client.send_execution_update(exec_update)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 30,
                                                            "end_token": 31,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 31,
                                                                    "end_token": 31,
                                                                    "label": "exec_update"
                                                                }
                                                            ],
                                                            "label": "return exec_update"
                                                        }
                                                    ],
                                                    "label": "\n        exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update"
                                                }
                                            ],
                                            "label": "def update_execution(status: ExecutionStatus) -> ExecutionResult:\n        exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update"
                                        }
                                    ],
                                    "label": "def update_execution(status: ExecutionStatus) -> ExecutionResult:\n        exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update"
                                }
                            ]
                        }
                    ],
                    "label": "def execute_node(\n    db_client: \"DatabaseManager\",\n    creds_manager: IntegrationCredentialsManager,\n    data: NodeExecutionEntry,\n    execution_stats: dict[str, Any] | None = None,\n) -> ExecutionStream:\n    \"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\"\n    user_id = data.user_id\n    graph_exec_id = data.graph_exec_id\n    graph_id = data.graph_id\n    node_exec_id = data.node_exec_id\n    node_id = data.node_id\n\n\n    node = db_client.get_node(node_id)\n\n    node_block = get_block(node.block_id)\n    if not node_block:\n        logger.error(f\"Block {node.block_id} not found.\")\n        return\n\n    log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )\n\n    # Sanity check: validate the execution input.\n    input_data, error = validate_exec(node, data.data, resolve_input=False)\n    if input_data is None:\n        log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return\n\n    # Re-shape the input data for agent block.\n    # AgentExecutorBlock specially separate the node input_data & its input_default.\n    if isinstance(node_block, AgentExecutorBlock):\n        input_data = {**node.input_default, \"data\": input_data}\n\n    # Execute the node\n    input_data_str = json.dumps(input_data)\n    input_size = len(input_data_str)\n    log_metadata.info(\"Executed node with input\", input=input_data_str)\n    update_execution(ExecutionStatus.RUNNING)\n\n    extra_exec_kwargs = {}\n    # Last-minute fetch credentials + acquire a system-wide read-write lock to prevent\n    # changes during execution.  This means a set of credentials can only be used by\n    # one (running) block at a time; simultaneous execution of blocks using same\n    # credentials is not supported.\n    creds_lock = None\n    if CREDENTIALS_FIELD_NAME in input_data:\n        credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials\n\n    output_size = 0\n    end_status = ExecutionStatus.COMPLETED\n    credit = db_client.get_or_refill_credit(user_id)\n    if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")\n\n    try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n    finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "_enqueue_next_nodes",
            "start_line": 247,
            "end_line": 360,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 70,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 70,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "_enqueue_next_nodes"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 39,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 6,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "children": [],
                                                    "label": "db_client"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 6,
                                                    "end_token": 6,
                                                    "children": [],
                                                    "label": "\"DatabaseManager\""
                                                }
                                            ],
                                            "label": "db_client: \"DatabaseManager\""
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 9,
                                            "end_token": 11,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 9,
                                                    "end_token": 9,
                                                    "children": [],
                                                    "label": "node"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 11,
                                                    "end_token": 11,
                                                    "children": [],
                                                    "label": "Node"
                                                }
                                            ],
                                            "label": "node: Node"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 14,
                                            "end_token": 16,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 14,
                                                    "end_token": 14,
                                                    "children": [],
                                                    "label": "output"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 16,
                                                    "end_token": 16,
                                                    "children": [],
                                                    "label": "BlockData"
                                                }
                                            ],
                                            "label": "output: BlockData"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 19,
                                            "end_token": 21,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 19,
                                                    "end_token": 19,
                                                    "children": [],
                                                    "label": "user_id"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 21,
                                                    "end_token": 21,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "user_id: str"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 24,
                                            "end_token": 26,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 24,
                                                    "end_token": 24,
                                                    "children": [],
                                                    "label": "graph_exec_id"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 26,
                                                    "end_token": 26,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "graph_exec_id: str"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 29,
                                            "end_token": 31,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 29,
                                                    "end_token": 29,
                                                    "children": [],
                                                    "label": "graph_id"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 31,
                                                    "end_token": 31,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "graph_id: str"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 34,
                                            "end_token": 36,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 34,
                                                    "end_token": 34,
                                                    "children": [],
                                                    "label": "log_metadata"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 36,
                                                    "end_token": 36,
                                                    "children": [],
                                                    "label": "LogMetadata"
                                                }
                                            ],
                                            "label": "log_metadata: LogMetadata"
                                        }
                                    ],
                                    "label": "(\n    db_client: \"DatabaseManager\",\n    node: Node,\n    output: BlockData,\n    user_id: str,\n    graph_exec_id: str,\n    graph_id: str,\n    log_metadata: LogMetadata,\n)"
                                },
                                {
                                    "type": "generic_type",
                                    "start_token": 41,
                                    "end_token": 45,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 42,
                                            "end_token": 42,
                                            "children": [],
                                            "label": "list"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 44,
                                            "end_token": 44,
                                            "children": [],
                                            "label": "NodeExecutionEntry"
                                        }
                                    ],
                                    "label": "> list[NodeExecutionEntry]"
                                },
                                {
                                    "type": "block",
                                    "start_token": 47,
                                    "end_token": 70,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "start_token": 50,
                                            "end_token": 70,
                                            "children": [
                                                {
                                                    "type": "list_comprehension",
                                                    "start_token": 51,
                                                    "end_token": 70,
                                                    "children": [
                                                        {
                                                            "type": "expression_list",
                                                            "start_token": 53,
                                                            "end_token": 54,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 53,
                                                                    "end_token": 53,
                                                                    "children": [],
                                                                    "label": "execution"
                                                                }
                                                            ],
                                                            "label": "execution\n"
                                                        },
                                                        {
                                                            "type": "for_in_clause",
                                                            "start_token": 55,
                                                            "end_token": 61,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 56,
                                                                    "end_token": 56,
                                                                    "children": [],
                                                                    "label": "link"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 58,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 58,
                                                                            "end_token": 58,
                                                                            "children": [],
                                                                            "label": "node"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 60,
                                                                            "end_token": 60,
                                                                            "children": [],
                                                                            "label": "output_links"
                                                                        }
                                                                    ],
                                                                    "label": "node.output_links"
                                                                }
                                                            ],
                                                            "label": "for link in node.output_links\n"
                                                        },
                                                        {
                                                            "type": "for_in_clause",
                                                            "start_token": 62,
                                                            "end_token": 68,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 63,
                                                                    "end_token": 63,
                                                                    "children": [],
                                                                    "label": "execution"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 65,
                                                                    "end_token": 68,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 65,
                                                                            "end_token": 65,
                                                                            "children": [],
                                                                            "label": "register_next_executions"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 66,
                                                                            "end_token": 68,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 67,
                                                                                    "children": [],
                                                                                    "label": "link"
                                                                                }
                                                                            ],
                                                                            "label": "(link)"
                                                                        }
                                                                    ],
                                                                    "label": "register_next_executions(link)"
                                                                }
                                                            ],
                                                            "label": "for execution in register_next_executions(link)"
                                                        }
                                                    ],
                                                    "label": "[\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]"
                                                }
                                            ],
                                            "label": "return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]"
                                        }
                                    ],
                                    "label": "\n\n\n    return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]"
                                }
                            ],
                            "label": "def _enqueue_next_nodes(\n    db_client: \"DatabaseManager\",\n    node: Node,\n    output: BlockData,\n    user_id: str,\n    graph_exec_id: str,\n    graph_id: str,\n    log_metadata: LogMetadata,\n) -> list[NodeExecutionEntry]:\n\n\n    return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "add_enqueued_execution",
                            "start_line": 256,
                            "end_line": 270,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 80,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 80,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "add_enqueued_execution"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 16,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 6,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "node_exec_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 5,
                                                                    "end_token": 6,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "node_exec_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 8,
                                                            "end_token": 10,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "children": [],
                                                                    "label": "node_id"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 9,
                                                                    "end_token": 10,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "node_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 12,
                                                                    "end_token": 12,
                                                                    "children": [],
                                                                    "label": "data"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 13,
                                                                    "end_token": 14,
                                                                    "children": [],
                                                                    "label": ": BlockInput"
                                                                }
                                                            ],
                                                            "label": "data: BlockInput"
                                                        }
                                                    ],
                                                    "label": "(\n        node_exec_id: str, node_id: str, data: BlockInput\n    )"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 17,
                                                    "end_token": 19,
                                                    "children": [],
                                                    "label": "-> NodeExecutionEntry"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 20,
                                                    "end_token": 80,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 22,
                                                            "end_token": 36,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 22,
                                                                    "end_token": 22,
                                                                    "children": [],
                                                                    "label": "exec_update"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 24,
                                                                    "end_token": 36,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 24,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 24,
                                                                                    "end_token": 24,
                                                                                    "children": [],
                                                                                    "label": "db_client"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "children": [],
                                                                                    "label": "update_execution_status"
                                                                                }
                                                                            ],
                                                                            "label": "db_client.update_execution_status"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 27,
                                                                            "end_token": 36,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "children": [],
                                                                                    "label": "node_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 31,
                                                                                    "end_token": 33,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 31,
                                                                                            "end_token": 31,
                                                                                            "children": [],
                                                                                            "label": "ExecutionStatus"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 33,
                                                                                            "end_token": 33,
                                                                                            "children": [],
                                                                                            "label": "QUEUED"
                                                                                        }
                                                                                    ],
                                                                                    "label": "ExecutionStatus.QUEUED"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 35,
                                                                                    "end_token": 35,
                                                                                    "children": [],
                                                                                    "label": "data"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            node_exec_id, ExecutionStatus.QUEUED, data\n"
                                                                        }
                                                                    ],
                                                                    "label": "db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n"
                                                                }
                                                            ],
                                                            "label": "exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 39,
                                                            "end_token": 44,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 39,
                                                                    "end_token": 44,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 39,
                                                                            "end_token": 41,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 39,
                                                                                    "end_token": 39,
                                                                                    "children": [],
                                                                                    "label": "db_client"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 41,
                                                                                    "end_token": 41,
                                                                                    "children": [],
                                                                                    "label": "send_execution_update"
                                                                                }
                                                                            ],
                                                                            "label": "db_client.send_execution_update"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 42,
                                                                            "end_token": 44,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 43,
                                                                                    "children": [],
                                                                                    "label": "exec_update"
                                                                                }
                                                                            ],
                                                                            "label": "(exec_update)"
                                                                        }
                                                                    ],
                                                                    "label": "db_client.send_execution_update(exec_update)"
                                                                }
                                                            ],
                                                            "label": "db_client.send_execution_update(exec_update)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 46,
                                                            "end_token": 80,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 47,
                                                                    "end_token": 80,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 47,
                                                                            "end_token": 47,
                                                                            "children": [],
                                                                            "label": "NodeExecutionEntry"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 48,
                                                                            "end_token": 80,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 50,
                                                                                    "end_token": 52,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 50,
                                                                                            "end_token": 50,
                                                                                            "children": [],
                                                                                            "label": "user_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 52,
                                                                                            "end_token": 52,
                                                                                            "children": [],
                                                                                            "label": "user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_id=user_id"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 55,
                                                                                    "end_token": 57,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 55,
                                                                                            "end_token": 55,
                                                                                            "children": [],
                                                                                            "label": "graph_exec_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 57,
                                                                                            "end_token": 57,
                                                                                            "children": [],
                                                                                            "label": "graph_exec_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "graph_exec_id=graph_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 60,
                                                                                    "end_token": 62,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 60,
                                                                                            "end_token": 60,
                                                                                            "children": [],
                                                                                            "label": "graph_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 62,
                                                                                            "end_token": 62,
                                                                                            "children": [],
                                                                                            "label": "graph_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "graph_id=graph_id"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 65,
                                                                                    "end_token": 67,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 65,
                                                                                            "end_token": 65,
                                                                                            "children": [],
                                                                                            "label": "node_exec_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 67,
                                                                                            "end_token": 67,
                                                                                            "children": [],
                                                                                            "label": "node_exec_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "node_exec_id=node_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 70,
                                                                                    "end_token": 72,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 70,
                                                                                            "end_token": 70,
                                                                                            "children": [],
                                                                                            "label": "node_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 72,
                                                                                            "end_token": 72,
                                                                                            "children": [],
                                                                                            "label": "node_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "node_id=node_id"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 75,
                                                                                    "end_token": 77,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 75,
                                                                                            "end_token": 75,
                                                                                            "children": [],
                                                                                            "label": "data"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 77,
                                                                                            "end_token": 77,
                                                                                            "children": [],
                                                                                            "label": "data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "data=data"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )"
                                                                }
                                                            ],
                                                            "label": "return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )"
                                                        }
                                                    ],
                                                    "label": ":\n        exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )"
                                                }
                                            ],
                                            "label": "def add_enqueued_execution(\n        node_exec_id: str, node_id: str, data: BlockInput\n    ) -> NodeExecutionEntry:\n        exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )"
                                        }
                                    ],
                                    "label": "def add_enqueued_execution(\n        node_exec_id: str, node_id: str, data: BlockInput\n    ) -> NodeExecutionEntry:\n        exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "register_next_executions",
                            "start_line": 272,
                            "end_line": 354,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 536,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 535,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "register_next_executions"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 6,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 5,
                                                            "label": "node_link: Link"
                                                        }
                                                    ],
                                                    "label": "(node_link: Link)"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 8,
                                                    "end_token": 12,
                                                    "label": "> list[NodeExecutionEntry]"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 14,
                                                    "end_token": 535,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 18,
                                                            "label": "enqueued_executions = []"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 20,
                                                            "end_token": 24,
                                                            "label": "next_output_name = node_link.source_name"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 26,
                                                            "end_token": 30,
                                                            "label": "next_input_name = node_link.sink_name"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 32,
                                                            "end_token": 36,
                                                            "label": "next_node_id = node_link.sink_id"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 39,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 41,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 42,
                                                                            "end_token": 45,
                                                                            "label": "(output, next_output_name"
                                                                        }
                                                                    ],
                                                                    "label": "parse_execution_output(output, next_output_name)"
                                                                }
                                                            ],
                                                            "label": "next_data = parse_execution_output(output, next_output_name)"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 48,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "condition",
                                                                    "start_token": 48,
                                                                    "end_token": 51,
                                                                    "label": "if next_data is None"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 52,
                                                                    "end_token": 56,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 54,
                                                                            "end_token": 55,
                                                                            "label": "return enqueued_executions"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            return enqueued_executions\n"
                                                                }
                                                            ],
                                                            "label": "if next_data is None:\n            return enqueued_executions\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 58,
                                                            "end_token": 65,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 62,
                                                                    "end_token": 65,
                                                                    "children": [
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 63,
                                                                            "end_token": 64,
                                                                            "label": "(next_node_id"
                                                                        }
                                                                    ],
                                                                    "label": "get_node(next_node_id)"
                                                                }
                                                            ],
                                                            "label": "next_node = db_client.get_node(next_node_id)"
                                                        },
                                                        {
                                                            "type": "with_statement",
                                                            "start_token": 109,
                                                            "end_token": 163,
                                                            "children": [
                                                                {
                                                                    "type": "with_item",
                                                                    "start_token": 110,
                                                                    "end_token": 114,
                                                                    "label": "synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\")"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 115,
                                                                    "end_token": 163,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 134,
                                                                            "end_token": 161,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 138,
                                                                                    "end_token": 163,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 142,
                                                                                            "end_token": 161,
                                                                                            "label": "\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,"
                                                                                        }
                                                                                    ],
                                                                                    "label": "db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )"
                                                                }
                                                            ],
                                                            "label": "with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 180,
                                                            "end_token": 207,
                                                            "children": [
                                                                {
                                                                    "type": "dictionary_comprehension",
                                                                    "start_token": 182,
                                                                    "end_token": 206,
                                                                    "children": [
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "start_token": 188,
                                                                            "end_token": 206,
                                                                            "label": "for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n"
                                                                        }
                                                                    ],
                                                                    "label": "{\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n"
                                                                }
                                                            ],
                                                            "label": "static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 209,
                                                            "end_token": 305,
                                                            "children": [
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": 210,
                                                                    "end_token": 229,
                                                                    "label": "static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 230,
                                                                    "end_token": 305,
                                                                    "children": [
                                                                        {
                                                                            "type": "for_statement",
                                                                            "start_token": 231,
                                                                            "end_token": 249,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_list",
                                                                                    "start_token": 232,
                                                                                    "end_token": 235,
                                                                                    "label": "name in static_link_names:"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 236,
                                                                                    "end_token": 249,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 237,
                                                                                            "end_token": 249,
                                                                                            "label": "next_node_input[name] = latest_execution.input_data.get(name)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                    next_node_input[name] = latest_execution.input_data.get(name)"
                                                                                }
                                                                            ],
                                                                            "label": "for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)"
                                                                        }
                                                                    ],
                                                                    "label": "\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions"
                                                                }
                                                            ],
                                                            "label": "if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions"
                                                        },
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 263,
                                                            "end_token": 272,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 268,
                                                                    "end_token": 272,
                                                                    "children": [
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 269,
                                                                            "end_token": 271,
                                                                            "label": "next_node, next_node_input"
                                                                        }
                                                                    ],
                                                                    "label": "(next_node, next_node_input)"
                                                                }
                                                            ],
                                                            "label": "next_node_input, validation_msg = validate_exec(next_node, next_node_input)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 274,
                                                            "end_token": 277,
                                                            "label": "suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\""
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 291,
                                                            "end_token": 305,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 292,
                                                                    "end_token": 294,
                                                                    "label": "not next_node_input:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 295,
                                                                    "end_token": 305,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 296,
                                                                            "end_token": 302,
                                                                            "label": "log_metadata.warning(f\"Skipped queueing {suffix}\")"
                                                                        },
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 304,
                                                                            "end_token": 305,
                                                                            "label": "return enqueued_executions"
                                                                        }
                                                                    ],
                                                                    "label": "\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions"
                                                                }
                                                            ],
                                                            "label": "if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 318,
                                                            "end_token": 324,
                                                            "label": "log_metadata.info(f\"Enqueued {suffix}\")"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 326,
                                                            "end_token": 339,
                                                            "children": [
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 327,
                                                                    "end_token": 340,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 332,
                                                                            "end_token": 338,
                                                                            "children": [
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 333,
                                                                                    "end_token": 338,
                                                                                    "label": "next_node_exec_id, next_node_id, next_node_input)"
                                                                                }
                                                                            ],
                                                                            "label": "(next_node_exec_id, next_node_id, next_node_input)"
                                                                        }
                                                                    ],
                                                                    "label": ".append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )"
                                                                }
                                                            ],
                                                            "label": "enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 356,
                                                            "end_token": 364,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 357,
                                                                    "end_token": 361,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 358,
                                                                            "end_token": 360,
                                                                            "label": "node_link.is_static"
                                                                        }
                                                                    ],
                                                                    "label": "not node_link.is_static:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 362,
                                                                    "end_token": 365,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 363,
                                                                            "end_token": 364,
                                                                            "label": "return enqueued_executions"
                                                                        }
                                                                    ],
                                                                    "label": "\n                return enqueued_executions\n"
                                                                }
                                                            ],
                                                            "label": "if not node_link.is_static:\n                return enqueued_executions"
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 403,
                                                            "end_token": 531,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 406,
                                                                    "end_token": 415,
                                                                    "children": [
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 407,
                                                                            "end_token": 414,
                                                                            "label": ".get_incomplete_executions(\n                next_node_id, graph_exec_id\n"
                                                                        }
                                                                    ],
                                                                    "label": "db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            )"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 416,
                                                                    "end_token": 531,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 418,
                                                                            "end_token": 422,
                                                                            "label": "idata = iexec.input_data"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 424,
                                                                            "end_token": 428,
                                                                            "label": "ineid = iexec.node_exec_id"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 431,
                                                                            "end_token": 457,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dictionary_comprehension",
                                                                                    "start_token": 433,
                                                                                    "end_token": 457,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "for_in_clause",
                                                                                            "start_token": 439,
                                                                                            "end_token": 456,
                                                                                            "label": "for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata"
                                                                                        }
                                                                                    ],
                                                                                    "label": "{\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n"
                                                                                }
                                                                            ],
                                                                            "label": "static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n"
                                                                        },
                                                                        {
                                                                            "type": "for_statement",
                                                                            "start_token": 460,
                                                                            "end_token": 474,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_list",
                                                                                    "start_token": 461,
                                                                                    "end_token": 464,
                                                                                    "label": "input_name in static_link_names:"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 465,
                                                                                    "end_token": 474,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 466,
                                                                                            "end_token": 474,
                                                                                            "label": "idata[input_name] = next_node_input[input_name]"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                    idata[input_name] = next_node_input[input_name]"
                                                                                }
                                                                            ],
                                                                            "label": "for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]"
                                                                        },
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": 477,
                                                                            "end_token": 486,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 481,
                                                                                    "end_token": 486,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 482,
                                                                                            "end_token": 485,
                                                                                            "label": "(next_node, idata"
                                                                                        }
                                                                                    ],
                                                                                    "label": "validate_exec(next_node, idata)"
                                                                                }
                                                                            ],
                                                                            "label": "idata, msg = validate_exec(next_node, idata)"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 488,
                                                                            "end_token": 491,
                                                                            "label": "suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\""
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 493,
                                                                            "end_token": 507,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "start_token": 494,
                                                                                    "end_token": 496,
                                                                                    "label": "not idata:"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 497,
                                                                                    "end_token": 507,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "start_token": 498,
                                                                                            "end_token": 504,
                                                                                            "label": "log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n"
                                                                                }
                                                                            ],
                                                                            "label": "if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n"
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 508,
                                                                            "end_token": 514,
                                                                            "label": "log_metadata.info(f\"Enqueueing static-link execution {suffix}\")"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 516,
                                                                            "end_token": 530,
                                                                            "children": [
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 517,
                                                                                    "end_token": 531,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 522,
                                                                                            "end_token": 530,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 523,
                                                                                                    "end_token": 530,
                                                                                                    "label": "iexec.node_exec_id, next_node_id, idata)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(iexec.node_exec_id, next_node_id, idata)"
                                                                                        }
                                                                                    ],
                                                                                    "label": ".append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n"
                                                                                }
                                                                            ],
                                                                            "label": "enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)"
                                                                        }
                                                                    ],
                                                                    "label": ":\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n"
                                                                }
                                                            ],
                                                            "label": "for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n"
                                                        }
                                                    ],
                                                    "label": "\n        enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions"
                                                }
                                            ],
                                            "label": "def register_next_executions(node_link: Link) -> list[NodeExecutionEntry]:\n        enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions"
                                        }
                                    ],
                                    "label": "def register_next_executions(node_link: Link) -> list[NodeExecutionEntry]:\n        enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions\n"
                                }
                            ]
                        }
                    ],
                    "label": "def _enqueue_next_nodes(\n    db_client: \"DatabaseManager\",\n    node: Node,\n    output: BlockData,\n    user_id: str,\n    graph_exec_id: str,\n    graph_id: str,\n    log_metadata: LogMetadata,\n) -> list[NodeExecutionEntry]:\n\n\n    return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "validate_exec",
            "start_line": 363,
            "end_line": 430,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 421,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 421,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "validate_exec"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 21,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 4,
                                            "end_token": 6,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 4,
                                                    "end_token": 4,
                                                    "label": "node"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 6,
                                                    "end_token": 6,
                                                    "label": "Node"
                                                }
                                            ],
                                            "label": "node: Node"
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 9,
                                            "end_token": 11,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 9,
                                                    "end_token": 9,
                                                    "label": "data"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 11,
                                                    "end_token": 11,
                                                    "label": "BlockInput"
                                                }
                                            ],
                                            "label": "data: BlockInput"
                                        },
                                        {
                                            "type": "typed_default_parameter",
                                            "start_token": 14,
                                            "end_token": 18,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 14,
                                                    "end_token": 14,
                                                    "label": "resolve_input"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 16,
                                                    "end_token": 16,
                                                    "label": "bool"
                                                },
                                                {
                                                    "type": "true",
                                                    "start_token": 18,
                                                    "end_token": 18,
                                                    "label": "True"
                                                }
                                            ],
                                            "label": "resolve_input: bool = True"
                                        }
                                    ],
                                    "label": "(\n    node: Node,\n    data: BlockInput,\n    resolve_input: bool = True,\n)"
                                },
                                {
                                    "type": "generic_type",
                                    "start_token": 23,
                                    "end_token": 31,
                                    "children": [
                                        {
                                            "type": "type",
                                            "start_token": 24,
                                            "end_token": 28,
                                            "label": "tuple[BlockInput | None"
                                        },
                                        {
                                            "type": "type",
                                            "start_token": 30,
                                            "end_token": 30,
                                            "label": "str"
                                        }
                                    ],
                                    "label": "> tuple[BlockInput | None, str]"
                                },
                                {
                                    "type": "string",
                                    "start_token": 34,
                                    "end_token": 36,
                                    "label": "\"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\""
                                },
                                {
                                    "type": "block",
                                    "start_token": 37,
                                    "end_token": 421,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 38,
                                            "end_token": 49,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 38,
                                                    "end_token": 38,
                                                    "label": "node_block"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 44,
                                                    "end_token": 49,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 44,
                                                            "end_token": 44,
                                                            "label": "get_block"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 45,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 46,
                                                                    "end_token": 48,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 46,
                                                                            "end_token": 46,
                                                                            "label": "node"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 48,
                                                                            "end_token": 48,
                                                                            "label": "block_id"
                                                                        }
                                                                    ],
                                                                    "label": "node.block_id"
                                                                }
                                                            ],
                                                            "label": "(node.block_id)"
                                                        }
                                                    ],
                                                    "label": "get_block(node.block_id)"
                                                }
                                            ],
                                            "label": "node_block: Block | None = get_block(node.block_id)"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 51,
                                            "end_token": 61,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 52,
                                                    "end_token": 53,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 53,
                                                            "end_token": 53,
                                                            "label": "node_block"
                                                        }
                                                    ],
                                                    "label": "not node_block"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 54,
                                                    "end_token": 61,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 56,
                                                            "end_token": 60,
                                                            "children": [
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 57,
                                                                    "end_token": 57,
                                                                    "label": "None"
                                                                },
                                                                {
                                                                    "type": "f_string",
                                                                    "start_token": 59,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_content",
                                                                            "start_token": 59,
                                                                            "end_token": 60,
                                                                            "label": "f\"Block for {node.block_id} not found.\""
                                                                        }
                                                                    ],
                                                                    "label": "f\"Block for {node.block_id} not found.\""
                                                                }
                                                            ],
                                                            "label": "return None, f\"Block for {node.block_id} not found.\""
                                                        }
                                                    ],
                                                    "label": ":\n        return None, f\"Block for {node.block_id} not found.\"\n"
                                                }
                                            ],
                                            "label": "if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"\n"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 63,
                                            "end_token": 138,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 64,
                                                    "end_token": 69,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 64,
                                                            "end_token": 64,
                                                            "label": "isinstance"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 65,
                                                            "end_token": 69,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 66,
                                                                    "end_token": 66,
                                                                    "label": "node_block"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 68,
                                                                    "end_token": 68,
                                                                    "label": "AgentExecutorBlock"
                                                                }
                                                            ],
                                                            "label": "(node_block, AgentExecutorBlock)"
                                                        }
                                                    ],
                                                    "label": "isinstance(node_block, AgentExecutorBlock)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 70,
                                                    "end_token": 138,
                                                    "children": [
                                                        {
                                                            "type": "try_statement",
                                                            "start_token": 84,
                                                            "end_token": 111,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 85,
                                                                    "end_token": 99,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 87,
                                                                            "end_token": 98,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 87,
                                                                                    "end_token": 87,
                                                                                    "label": "exec_data"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 89,
                                                                                    "end_token": 98,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 89,
                                                                                            "end_token": 91,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "type",
                                                                                                    "start_token": 89,
                                                                                                    "end_token": 89,
                                                                                                    "label": "AgentExecutorBlock"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 91,
                                                                                                    "end_token": 91,
                                                                                                    "label": "Input"
                                                                                                }
                                                                                            ],
                                                                                            "label": "AgentExecutorBlock.Input"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 92,
                                                                                            "end_token": 98,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dotted_name",
                                                                                                    "start_token": 95,
                                                                                                    "end_token": 97,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 95,
                                                                                                            "end_token": 95,
                                                                                                            "label": "node"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 97,
                                                                                                            "end_token": 97,
                                                                                                            "label": "input_default"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "node.input_default"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(**node.input_default)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "AgentExecutorBlock.Input(**node.input_default)"
                                                                                }
                                                                            ],
                                                                            "label": "exec_data = AgentExecutorBlock.Input(**node.input_default)"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n"
                                                                },
                                                                {
                                                                    "type": "except_clause",
                                                                    "start_token": 100,
                                                                    "end_token": 111,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 102,
                                                                            "end_token": 103,
                                                                            "label": "as e"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 104,
                                                                            "end_token": 111,
                                                                            "children": [
                                                                                {
                                                                                    "type": "return_statement",
                                                                                    "start_token": 106,
                                                                                    "end_token": 110,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "none",
                                                                                            "start_token": 107,
                                                                                            "end_token": 107,
                                                                                            "label": "None"
                                                                                        },
                                                                                        {
                                                                                            "type": "f_string",
                                                                                            "start_token": 109,
                                                                                            "end_token": 110,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "start_token": 109,
                                                                                                    "end_token": 110,
                                                                                                    "label": "f\"Input data doesn't match {node_block.name}: {str(e)}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "f\"Input data doesn't match {node_block.name}: {str(e)}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "return None, f\"Input data doesn't match {node_block.name}: {str(e)}\""
                                                                                }
                                                                            ],
                                                                            "label": ":\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n"
                                                                        }
                                                                    ],
                                                                    "label": "except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n"
                                                                }
                                                            ],
                                                            "label": "try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 117,
                                                            "end_token": 121,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 117,
                                                                    "end_token": 117,
                                                                    "label": "input_schema"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 119,
                                                                    "end_token": 121,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 119,
                                                                            "end_token": 119,
                                                                            "label": "exec_data"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 121,
                                                                            "end_token": 121,
                                                                            "label": "input_schema"
                                                                        }
                                                                    ],
                                                                    "label": "exec_data.input_schema"
                                                                }
                                                            ],
                                                            "label": "input_schema = exec_data.input_schema"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 123,
                                                            "end_token": 131,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 123,
                                                                    "end_token": 123,
                                                                    "label": "required_fields"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 125,
                                                                    "end_token": 131,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 125,
                                                                            "end_token": 125,
                                                                            "label": "set"
                                                                        },
                                                                        {
                                                                            "type": "subscript",
                                                                            "start_token": 126,
                                                                            "end_token": 130,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 127,
                                                                                    "end_token": 129,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 127,
                                                                                            "end_token": 127,
                                                                                            "label": "input_schema"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 129,
                                                                                            "end_token": 129,
                                                                                            "label": "\"required\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "input_schema[\"required\""
                                                                                }
                                                                            ],
                                                                            "label": "(input_schema[\"required\"]"
                                                                        }
                                                                    ],
                                                                    "label": "set(input_schema[\"required\"])"
                                                                }
                                                            ],
                                                            "label": "required_fields = set(input_schema[\"required\"])"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 133,
                                                            "end_token": 137,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 133,
                                                                    "end_token": 133,
                                                                    "label": "input_default"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 135,
                                                                    "end_token": 137,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 135,
                                                                            "end_token": 135,
                                                                            "label": "exec_data"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 137,
                                                                            "end_token": 137,
                                                                            "label": "data"
                                                                        }
                                                                    ],
                                                                    "label": "exec_data.data"
                                                                }
                                                            ],
                                                            "label": "input_default = exec_data.data"
                                                        }
                                                    ],
                                                    "label": ":\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n"
                                                }
                                            ],
                                            "label": "if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n"
                                        },
                                        {
                                            "type": "else_clause",
                                            "start_token": 139,
                                            "end_token": 184,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 140,
                                                    "end_token": 184,
                                                    "children": [
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 156,
                                                            "end_token": 207,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 157,
                                                                    "end_token": 160,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 157,
                                                                            "end_token": 157,
                                                                            "label": "name"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 159,
                                                                            "end_token": 159,
                                                                            "label": "data_type"
                                                                        }
                                                                    ],
                                                                    "label": "name, data_type in"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 161,
                                                                    "end_token": 169,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 161,
                                                                            "end_token": 165,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 161,
                                                                                    "end_token": 161,
                                                                                    "label": "node_block"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 163,
                                                                                    "end_token": 163,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 163,
                                                                                            "end_token": 163,
                                                                                            "label": "input_schema"
                                                                                        }
                                                                                    ],
                                                                                    "label": "input_schema"
                                                                                }
                                                                            ],
                                                                            "label": "node_block.input_schema.__annotations__"
                                                                        }
                                                                    ],
                                                                    "label": "node_block.input_schema.__annotations__.items()"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 170,
                                                                    "end_token": 207,
                                                                    "children": [
                                                                        {
                                                                            "type": "and",
                                                                            "start_token": 184,
                                                                            "end_token": 195,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 192,
                                                                                    "end_token": 193,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 192,
                                                                                            "end_token": 192,
                                                                                            "label": "data_type"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 193,
                                                                                            "end_token": 193,
                                                                                            "label": ")"
                                                                                        },
                                                                                        {
                                                                                            "type": "not_operator",
                                                                                            "start_token": 191,
                                                                                            "end_token": 193,
                                                                                            "label": "not data_type)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "data_type)"
                                                                                }
                                                                            ],
                                                                            "label": "and (type(value) is not data_type):\n"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 196,
                                                                            "end_token": 206,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "start_token": 196,
                                                                                    "end_token": 198,
                                                                                    "label": "data[name"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 201,
                                                                                    "end_token": 206,
                                                                                    "label": "convert(value, data_type)"
                                                                                }
                                                                            ],
                                                                            "label": "data[name] = convert(value, data_type)"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n"
                                                                }
                                                            ],
                                                            "label": "for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n"
                                                        }
                                                    ],
                                                    "label": ":\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and"
                                                }
                                            ],
                                            "label": "else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 213,
                                            "end_token": 222,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 213,
                                                    "end_token": 213,
                                                    "label": "input_schema"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 215,
                                                    "end_token": 221,
                                                    "label": "node_block.input_schema.jsonschema()"
                                                }
                                            ],
                                            "label": "input_schema = node_block.input_schema.jsonschema()\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 223,
                                            "end_token": 232,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 223,
                                                    "end_token": 223,
                                                    "label": "required_fields"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 225,
                                                    "end_token": 231,
                                                    "label": "node_block.input_schema.get_required_fields()"
                                                }
                                            ],
                                            "label": "required_fields = node_block.input_schema.get_required_fields()\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 233,
                                            "end_token": 238,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 233,
                                                    "end_token": 233,
                                                    "label": "input_default"
                                                },
                                                {
                                                    "type": "attribute",
                                                    "start_token": 235,
                                                    "end_token": 237,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 235,
                                                            "end_token": 235,
                                                            "label": "node"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 237,
                                                            "end_token": 237,
                                                            "label": "input_default"
                                                        }
                                                    ],
                                                    "label": "node.input_default"
                                                }
                                            ],
                                            "label": "input_default = node.input_default\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 256,
                                            "end_token": 258,
                                            "label": "= f\"Input data missing or mismatch for `{node_block.name}`:\""
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 260,
                                            "end_token": 272,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 260,
                                                    "end_token": 260,
                                                    "label": "input_fields_from_nodes"
                                                },
                                                {
                                                    "type": "set",
                                                    "start_token": 261,
                                                    "end_token": 272,
                                                    "children": [
                                                        {
                                                            "type": "for_in_clause",
                                                            "start_token": 264,
                                                            "end_token": 271,
                                                            "label": ".sink_name for link in node.input_links"
                                                        }
                                                    ],
                                                    "label": "= {link.sink_name for link in node.input_links}"
                                                }
                                            ],
                                            "label": "input_fields_from_nodes = {link.sink_name for link in node.input_links}"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 274,
                                            "end_token": 289,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 275,
                                                    "end_token": 282,
                                                    "label": "not input_fields_from_nodes.issubset(data):"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 283,
                                                    "end_token": 289,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 284,
                                                            "end_token": 288,
                                                            "label": "return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\""
                                                        }
                                                    ],
                                                    "label": "\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n"
                                                }
                                            ],
                                            "label": "if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 309,
                                            "end_token": 319,
                                            "label": "data = {**input_default, **data}"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 321,
                                            "end_token": 330,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 322,
                                                    "end_token": 322,
                                                    "label": "resolve_input"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 323,
                                                    "end_token": 330,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 325,
                                                            "end_token": 329,
                                                            "label": "data = merge_execution_input(data"
                                                        }
                                                    ],
                                                    "label": ":\n        data = merge_execution_input(data)"
                                                }
                                            ],
                                            "label": "if resolve_input:\n        data = merge_execution_input(data)"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 349,
                                            "end_token": 364,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 350,
                                                    "end_token": 356,
                                                    "label": "not required_fields.issubset(data)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 357,
                                                    "end_token": 364,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 359,
                                                            "end_token": 363,
                                                            "label": "return None, f\"{error_prefix} {required_fields - set(data)}\""
                                                        }
                                                    ],
                                                    "label": ":\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n"
                                                }
                                            ],
                                            "label": "if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 379,
                                            "end_token": 413,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 380,
                                                    "end_token": 394,
                                                    "label": "error := json.validate_with_jsonschema(schema=input_schema, data=data)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 395,
                                                    "end_token": 413,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 397,
                                                            "end_token": 400,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 397,
                                                                    "end_token": 397,
                                                                    "label": "error_message"
                                                                },
                                                                {
                                                                    "type": "f_string",
                                                                    "start_token": 399,
                                                                    "end_token": 400,
                                                                    "label": "f\"{error_prefix} {error}\""
                                                                }
                                                            ],
                                                            "label": "error_message = f\"{error_prefix} {error}\""
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 402,
                                                            "end_token": 407,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 403,
                                                                    "end_token": 407,
                                                                    "label": ".error(error_message)"
                                                                }
                                                            ],
                                                            "label": "logger.error(error_message)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 409,
                                                            "end_token": 412,
                                                            "label": "return None, error_message"
                                                        }
                                                    ],
                                                    "label": ":\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n"
                                                }
                                            ],
                                            "label": "if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 415,
                                            "end_token": 420,
                                            "label": "return data, node_block.name"
                                        }
                                    ],
                                    "label": "\n    node_block: Block | None = get_block(node.block_id)\n    if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"\n\n    if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n    else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default\n\n    # Input data (without default values) should contain all required fields.\n    error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"\n    input_fields_from_nodes = {link.sink_name for link in node.input_links}\n    if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n\n    # Merge input data with default values and resolve dynamic dict/list/object pins.\n    data = {**input_default, **data}\n    if resolve_input:\n        data = merge_execution_input(data)\n\n    # Input data post-merge should contain all required fields from the schema.\n    if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n\n    # Last validation: Validate the input values against the schema.\n    if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n\n    return data, node_block.name\n"
                                }
                            ],
                            "label": "def validate_exec(\n    node: Node,\n    data: BlockInput,\n    resolve_input: bool = True,\n) -> tuple[BlockInput | None, str]:\n    \"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\"\n    node_block: Block | None = get_block(node.block_id)\n    if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"\n\n    if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n    else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default\n\n    # Input data (without default values) should contain all required fields.\n    error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"\n    input_fields_from_nodes = {link.sink_name for link in node.input_links}\n    if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n\n    # Merge input data with default values and resolve dynamic dict/list/object pins.\n    data = {**input_default, **data}\n    if resolve_input:\n        data = merge_execution_input(data)\n\n    # Input data post-merge should contain all required fields from the schema.\n    if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n\n    # Last validation: Validate the input values against the schema.\n    if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n\n    return data, node_block.name\n"
                        }
                    ],
                    "label": "def validate_exec(\n    node: Node,\n    data: BlockInput,\n    resolve_input: bool = True,\n) -> tuple[BlockInput | None, str]:\n    \"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\"\n    node_block: Block | None = get_block(node.block_id)\n    if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"\n\n    if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n    else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default\n\n    # Input data (without default values) should contain all required fields.\n    error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"\n    input_fields_from_nodes = {link.sink_name for link in node.input_links}\n    if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n\n    # Merge input data with default values and resolve dynamic dict/list/object pins.\n    data = {**input_default, **data}\n    if resolve_input:\n        data = merge_execution_input(data)\n\n    # Input data post-merge should contain all required fields from the schema.\n    if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n\n    # Last validation: Validate the input values against the schema.\n    if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n\n    return data, node_block.name\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "get_db_client",
            "start_line": 937,
            "end_line": 940,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 22,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 22,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "get_db_client"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 3,
                                    "children": [],
                                    "label": "()"
                                },
                                {
                                    "type": "union_type",
                                    "start_token": 5,
                                    "end_token": 6,
                                    "children": [
                                        {
                                            "type": "string",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "children": [],
                                            "label": "\"DatabaseManager\""
                                        }
                                    ],
                                    "label": "> \"DatabaseManager\""
                                },
                                {
                                    "type": "block",
                                    "start_token": 8,
                                    "end_token": 22,
                                    "children": [
                                        {
                                            "type": "import_from_statement",
                                            "start_token": 9,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "relative_import",
                                                    "start_token": 9,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 10,
                                                            "end_token": 12,
                                                            "children": [],
                                                            "label": "backend.executor"
                                                        }
                                                    ],
                                                    "label": "from backend.executor"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 14,
                                                    "end_token": 14,
                                                    "children": [],
                                                    "label": "DatabaseManager"
                                                }
                                            ],
                                            "label": "from backend.executor import DatabaseManager"
                                        },
                                        {
                                            "type": "return_statement",
                                            "start_token": 17,
                                            "end_token": 21,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "start_token": 18,
                                                    "end_token": 21,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 18,
                                                            "end_token": 18,
                                                            "children": [],
                                                            "label": "get_service_client"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 19,
                                                            "end_token": 20,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 20,
                                                                    "end_token": 20,
                                                                    "children": [],
                                                                    "label": "DatabaseManager"
                                                                }
                                                            ],
                                                            "label": "(DatabaseManager"
                                                        }
                                                    ],
                                                    "label": "get_service_client(DatabaseManager)"
                                                }
                                            ],
                                            "label": "return get_service_client(DatabaseManager)"
                                        }
                                    ],
                                    "label": "\n    from backend.executor import DatabaseManager\n\n    return get_service_client(DatabaseManager)\n"
                                }
                            ],
                            "label": "def get_db_client() -> \"DatabaseManager\":\n    from backend.executor import DatabaseManager\n\n    return get_service_client(DatabaseManager)\n"
                        }
                    ],
                    "label": "def get_db_client() -> \"DatabaseManager\":\n    from backend.executor import DatabaseManager\n\n    return get_service_client(DatabaseManager)\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "synchronized",
            "start_line": 944,
            "end_line": 951,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 62,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 61,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "synchronized"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 12,
                                    "children": [
                                        {
                                            "type": "typed_default_parameter",
                                            "start_token": 3,
                                            "end_token": 5,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 3,
                                                    "end_token": 3,
                                                    "children": [],
                                                    "label": "key"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 5,
                                                    "end_token": 5,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "key: str"
                                        },
                                        {
                                            "type": "typed_default_parameter",
                                            "start_token": 7,
                                            "end_token": 11,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 7,
                                                    "end_token": 7,
                                                    "children": [],
                                                    "label": "timeout"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 9,
                                                    "end_token": 9,
                                                    "children": [],
                                                    "label": "int"
                                                },
                                                {
                                                    "type": "integer",
                                                    "start_token": 11,
                                                    "end_token": 11,
                                                    "children": [],
                                                    "label": "60"
                                                }
                                            ],
                                            "label": "timeout: int = 60"
                                        }
                                    ],
                                    "label": "(key: str, timeout: int = 60)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 14,
                                    "end_token": 61,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 15,
                                            "end_token": 33,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 15,
                                                    "end_token": 15,
                                                    "children": [],
                                                    "label": "lock"
                                                },
                                                {
                                                    "type": "call",
                                                    "start_token": 19,
                                                    "end_token": 33,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 19,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 19,
                                                                    "end_token": 19,
                                                                    "children": [],
                                                                    "label": "redis"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 21,
                                                                    "end_token": 21,
                                                                    "children": [],
                                                                    "label": "get_redis"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 23,
                                                                    "end_token": 23,
                                                                    "children": [],
                                                                    "label": ")"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 25,
                                                                    "end_token": 25,
                                                                    "children": [],
                                                                    "label": "lock"
                                                                }
                                                            ],
                                                            "label": "redis.get_redis().lock"
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "start_token": 26,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "interpolation",
                                                                    "start_token": 27,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "children": [],
                                                                            "label": "f"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 28,
                                                                            "end_token": 28,
                                                                            "children": [],
                                                                            "label": "\"lock:{key}\""
                                                                        }
                                                                    ],
                                                                    "label": "f\"lock:{key}\""
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "start_token": 30,
                                                                    "end_token": 32,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 30,
                                                                            "end_token": 30,
                                                                            "children": [],
                                                                            "label": "timeout"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 32,
                                                                            "end_token": 32,
                                                                            "children": [],
                                                                            "label": "timeout"
                                                                        }
                                                                    ],
                                                                    "label": "timeout=timeout"
                                                                }
                                                            ],
                                                            "label": "(f\"lock:{key}\", timeout=timeout)"
                                                        }
                                                    ],
                                                    "label": "redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)"
                                                }
                                            ],
                                            "label": "lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)"
                                        },
                                        {
                                            "type": "try_statement",
                                            "start_token": 35,
                                            "end_token": 61,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "start_token": 36,
                                                    "end_token": 45,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 38,
                                                            "end_token": 42,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 38,
                                                                    "end_token": 40,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 38,
                                                                            "end_token": 38,
                                                                            "children": [],
                                                                            "label": "lock"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 40,
                                                                            "end_token": 40,
                                                                            "children": [],
                                                                            "label": "acquire"
                                                                        }
                                                                    ],
                                                                    "label": "lock.acquire"
                                                                }
                                                            ],
                                                            "label": "lock.acquire()"
                                                        },
                                                        {
                                                            "type": "yield",
                                                            "start_token": 44,
                                                            "end_token": 44,
                                                            "children": [],
                                                            "label": "yield"
                                                        }
                                                    ],
                                                    "label": ":\n        lock.acquire()\n        yield\n"
                                                },
                                                {
                                                    "type": "finally_clause",
                                                    "start_token": 46,
                                                    "end_token": 61,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 49,
                                                            "end_token": 61,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 50,
                                                                    "end_token": 54,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 50,
                                                                            "end_token": 52,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 50,
                                                                                    "end_token": 50,
                                                                                    "children": [],
                                                                                    "label": "lock"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 52,
                                                                                    "end_token": 52,
                                                                                    "children": [],
                                                                                    "label": "locked"
                                                                                }
                                                                            ],
                                                                            "label": "lock.locked"
                                                                        }
                                                                    ],
                                                                    "label": "lock.locked()"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 56,
                                                                    "end_token": 61,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 57,
                                                                            "end_token": 61,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 57,
                                                                                    "end_token": 59,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 57,
                                                                                            "end_token": 57,
                                                                                            "children": [],
                                                                                            "label": "lock"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 59,
                                                                                            "end_token": 59,
                                                                                            "children": [],
                                                                                            "label": "release"
                                                                                        }
                                                                                    ],
                                                                                    "label": "lock.release"
                                                                                }
                                                                            ],
                                                                            "label": "lock.release()"
                                                                        }
                                                                    ],
                                                                    "label": "\n            lock.release()"
                                                                }
                                                            ],
                                                            "label": "if lock.locked():\n            lock.release()"
                                                        }
                                                    ],
                                                    "label": "finally:\n        if lock.locked():\n            lock.release()"
                                                }
                                            ],
                                            "label": "try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()"
                                        }
                                    ],
                                    "label": "\n    lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)\n    try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()"
                                }
                            ],
                            "label": "def synchronized(key: str, timeout: int = 60):\n    lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)\n    try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()"
                        }
                    ],
                    "label": "def synchronized(key: str, timeout: int = 60):\n    lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)\n    try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()\n"
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "llprint",
            "start_line": 954,
            "end_line": 960,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 47,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 47,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "llprint"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 6,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 3,
                                            "end_token": 5,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 3,
                                                    "end_token": 3,
                                                    "children": [],
                                                    "label": "message"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 5,
                                                    "end_token": 5,
                                                    "children": [],
                                                    "label": "str"
                                                }
                                            ],
                                            "label": "message: str"
                                        }
                                    ],
                                    "label": "(message: str)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 8,
                                    "end_token": 47,
                                    "children": [
                                        {
                                            "type": "string",
                                            "start_token": 9,
                                            "end_token": 11,
                                            "children": [
                                                {
                                                    "type": "string_content",
                                                    "start_token": 10,
                                                    "end_token": 10,
                                                    "children": [],
                                                    "label": "\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \""
                                                }
                                            ],
                                            "label": "\"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\""
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 13,
                                            "end_token": 47,
                                            "children": [
                                                {
                                                    "type": "if_clause",
                                                    "start_token": 13,
                                                    "end_token": 24,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "start_token": 14,
                                                            "end_token": 23,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 14,
                                                                    "end_token": 18,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 14,
                                                                            "end_token": 16,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 14,
                                                                                    "end_token": 14,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 16,
                                                                                    "end_token": 16,
                                                                                    "children": [],
                                                                                    "label": "getEffectiveLevel"
                                                                                }
                                                                            ],
                                                                            "label": "logger.getEffectiveLevel"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 17,
                                                                            "end_token": 18,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "logger.getEffectiveLevel()"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 21,
                                                                    "end_token": 23,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "children": [],
                                                                            "label": "logging"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 23,
                                                                            "end_token": 23,
                                                                            "children": [],
                                                                            "label": "DEBUG"
                                                                        }
                                                                    ],
                                                                    "label": "logging.DEBUG"
                                                                }
                                                            ],
                                                            "label": "logger.getEffectiveLevel() == logging.DEBUG"
                                                        }
                                                    ],
                                                    "label": "if logger.getEffectiveLevel() == logging.DEBUG:"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 25,
                                                    "end_token": 47,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 26,
                                                            "end_token": 47,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 26,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 26,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "children": [],
                                                                                    "label": "os"
                                                                                }
                                                                            ],
                                                                            "label": "os"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 28,
                                                                            "end_token": 28,
                                                                            "children": [],
                                                                            "label": "write"
                                                                        }
                                                                    ],
                                                                    "label": "os.write"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 29,
                                                                    "end_token": 47,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 30,
                                                                            "end_token": 36,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 30,
                                                                                    "end_token": 34,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 30,
                                                                                            "end_token": 32,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 30,
                                                                                                    "end_token": 30,
                                                                                                    "children": [],
                                                                                                    "label": "sys"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 32,
                                                                                                    "end_token": 32,
                                                                                                    "children": [],
                                                                                                    "label": "stdout"
                                                                                                }
                                                                                            ],
                                                                                            "label": "sys.stdout"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 34,
                                                                                            "end_token": 34,
                                                                                            "children": [],
                                                                                            "label": "fileno"
                                                                                        }
                                                                                    ],
                                                                                    "label": "sys.stdout.fileno"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 35,
                                                                                    "end_token": 36,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "sys.stdout.fileno()"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 38,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "binary_operator",
                                                                                    "start_token": 39,
                                                                                    "end_token": 41,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 39,
                                                                                            "end_token": 39,
                                                                                            "children": [],
                                                                                            "label": "message"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 41,
                                                                                            "end_token": 41,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "start_token": 41,
                                                                                                    "end_token": 41,
                                                                                                    "children": [],
                                                                                                    "label": "\"\\n\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "\"\\n\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "message + \"\\n\""
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 43,
                                                                                    "end_token": 44,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 42,
                                                                                            "end_token": 42,
                                                                                            "children": [],
                                                                                            "label": ")"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 44,
                                                                                            "end_token": 44,
                                                                                            "children": [],
                                                                                            "label": "encode"
                                                                                        }
                                                                                    ],
                                                                                    "label": ".encode"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 45,
                                                                                    "end_token": 46,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "(message + \"\\n\").encode()"
                                                                        }
                                                                    ],
                                                                    "label": "(sys.stdout.fileno(), (message + \"\\n\").encode())"
                                                                }
                                                            ],
                                                            "label": "os.write(sys.stdout.fileno(), (message + \"\\n\").encode())"
                                                        }
                                                    ],
                                                    "label": "\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())"
                                                }
                                            ],
                                            "label": "if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())"
                                        }
                                    ],
                                    "label": "\n    \"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"\n    if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())"
                                }
                            ],
                            "label": "def llprint(message: str):\n    \"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"\n    if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())"
                        }
                    ],
                    "label": "def llprint(message: str):\n    \"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"\n    if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "LogMetadata",
            "start_line": 53,
            "end_line": 95,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 2,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 2,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 0,
                                    "children": [],
                                    "label": "class"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "LogMetadata"
                                },
                                {
                                    "type": "block",
                                    "start_token": 2,
                                    "end_token": 2,
                                    "children": [],
                                    "label": ":"
                                }
                            ],
                            "label": "class LogMetadata:"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__init__",
                            "start_line": 54,
                            "end_line": 72,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 88,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 37,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "__init__"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 37,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 7,
                                                            "end_token": 9,
                                                            "children": [],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [],
                                                            "label": "graph_eid: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 17,
                                                            "end_token": 19,
                                                            "children": [],
                                                            "label": "graph_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 22,
                                                            "end_token": 24,
                                                            "children": [],
                                                            "label": "node_eid: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 27,
                                                            "end_token": 29,
                                                            "children": [],
                                                            "label": "node_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 32,
                                                            "end_token": 34,
                                                            "children": [],
                                                            "label": "block_name: str"
                                                        }
                                                    ],
                                                    "label": "(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    )"
                                                }
                                            ],
                                            "label": "def __init__(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    )"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 39,
                                            "end_token": 88,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "start_token": 40,
                                                    "end_token": 81,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 40,
                                                            "end_token": 42,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 40,
                                                                    "end_token": 40,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 42,
                                                                    "end_token": 42,
                                                                    "children": [],
                                                                    "label": "metadata"
                                                                }
                                                            ],
                                                            "label": "self.metadata"
                                                        },
                                                        {
                                                            "type": "dictionary",
                                                            "start_token": 44,
                                                            "end_token": 81,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 46,
                                                                    "end_token": 48,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 46,
                                                                            "end_token": 46,
                                                                            "children": [],
                                                                            "label": "\"component\""
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 48,
                                                                            "end_token": 48,
                                                                            "children": [],
                                                                            "label": "\"ExecutionManager\""
                                                                        }
                                                                    ],
                                                                    "label": "\"component\": \"ExecutionManager\""
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 51,
                                                                    "end_token": 53,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 51,
                                                                            "end_token": 51,
                                                                            "children": [],
                                                                            "label": "\"user_id\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 53,
                                                                            "end_token": 53,
                                                                            "children": [],
                                                                            "label": "user_id"
                                                                        }
                                                                    ],
                                                                    "label": "\"user_id\": user_id"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 56,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 56,
                                                                            "end_token": 56,
                                                                            "children": [],
                                                                            "label": "\"graph_eid\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 58,
                                                                            "end_token": 58,
                                                                            "children": [],
                                                                            "label": "graph_eid"
                                                                        }
                                                                    ],
                                                                    "label": "\"graph_eid\": graph_eid"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 61,
                                                                    "end_token": 63,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 61,
                                                                            "end_token": 61,
                                                                            "children": [],
                                                                            "label": "\"graph_id\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 63,
                                                                            "end_token": 63,
                                                                            "children": [],
                                                                            "label": "graph_id"
                                                                        }
                                                                    ],
                                                                    "label": "\"graph_id\": graph_id"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 66,
                                                                    "end_token": 68,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 66,
                                                                            "end_token": 66,
                                                                            "children": [],
                                                                            "label": "\"node_eid\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 68,
                                                                            "end_token": 68,
                                                                            "children": [],
                                                                            "label": "node_eid"
                                                                        }
                                                                    ],
                                                                    "label": "\"node_eid\": node_eid"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 71,
                                                                    "end_token": 73,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 71,
                                                                            "end_token": 71,
                                                                            "children": [],
                                                                            "label": "\"node_id\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 73,
                                                                            "end_token": 73,
                                                                            "children": [],
                                                                            "label": "node_id"
                                                                        }
                                                                    ],
                                                                    "label": "\"node_id\": node_id"
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "start_token": 76,
                                                                    "end_token": 78,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 76,
                                                                            "end_token": 76,
                                                                            "children": [],
                                                                            "label": "\"block_name\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 78,
                                                                            "end_token": 78,
                                                                            "children": [],
                                                                            "label": "block_name"
                                                                        }
                                                                    ],
                                                                    "label": "\"block_name\": block_name"
                                                                }
                                                            ],
                                                            "label": "{\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }"
                                                        }
                                                    ],
                                                    "label": "self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }"
                                                },
                                                {
                                                    "type": "assignment",
                                                    "start_token": 83,
                                                    "end_token": 88,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 83,
                                                            "end_token": 85,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 83,
                                                                    "end_token": 83,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 85,
                                                                    "end_token": 85,
                                                                    "children": [],
                                                                    "label": "prefix"
                                                                }
                                                            ],
                                                            "label": "self.prefix"
                                                        },
                                                        {
                                                            "type": "concatenated_string",
                                                            "start_token": 87,
                                                            "end_token": 88,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "start_token": 87,
                                                                    "end_token": 87,
                                                                    "children": [],
                                                                    "label": "f"
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "start_token": 88,
                                                                    "end_token": 88,
                                                                    "children": [],
                                                                    "label": "\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\""
                                                                }
                                                            ],
                                                            "label": "f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\""
                                                        }
                                                    ],
                                                    "label": "self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\""
                                                }
                                            ],
                                            "label": "\n        self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }\n        self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\""
                                        }
                                    ],
                                    "label": "def __init__(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    ):\n        self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }\n        self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\""
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "info",
                            "start_line": 74,
                            "end_line": 76,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 52,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 51,
                                            "children": [
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 4,
                                                            "label": "self,"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 8,
                                                            "label": "msg: str,"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "label": "**extra"
                                                        }
                                                    ],
                                                    "label": "(self, msg: str, **extra)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 14,
                                                    "end_token": 51,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "label": "self._wrap"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 19,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 20,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary_splat",
                                                                                    "start_token": 23,
                                                                                    "end_token": 25,
                                                                                    "label": "**extra"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, **extra"
                                                                        }
                                                                    ],
                                                                    "label": "_wrap(msg, **extra)"
                                                                }
                                                            ],
                                                            "label": "msg = self._wrap(msg, **extra)"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 28,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 28,
                                                                    "end_token": 30,
                                                                    "label": "logger.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 31,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 32,
                                                                            "end_token": 32,
                                                                            "label": "msg"
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "start_token": 34,
                                                                            "end_token": 49,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 37,
                                                                                    "end_token": 37,
                                                                                    "label": "\"json_fields\""
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 39,
                                                                                    "end_token": 49,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary_splat",
                                                                                            "start_token": 40,
                                                                                            "end_token": 44,
                                                                                            "label": "**self.metadata"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary_splat",
                                                                                            "start_token": 46,
                                                                                            "end_token": 48,
                                                                                            "label": "**extra"
                                                                                        }
                                                                                    ],
                                                                                    "label": "{**self.metadata, **extra}"
                                                                                }
                                                                            ],
                                                                            "label": "extra={\"json_fields\": {**self.metadata, **extra}"
                                                                        }
                                                                    ],
                                                                    "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}}"
                                                                }
                                                            ],
                                                            "label": "logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                        }
                                                    ],
                                                    "label": "\n        msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                }
                                            ],
                                            "label": "def info(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                        }
                                    ],
                                    "label": "def info(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "warning",
                            "start_line": 78,
                            "end_line": 80,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 52,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 51,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "warning"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "self, msg: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "children": [],
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "msg: str"
                                                        },
                                                        {
                                                            "type": "parameters",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "children": [],
                                                                    "label": "extra"
                                                                }
                                                            ],
                                                            "label": "**extra"
                                                        }
                                                    ],
                                                    "label": "(self, msg: str, **extra)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 14,
                                                    "end_token": 51,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "children": [],
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 17,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 17,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "children": [],
                                                                                    "label": "_wrap"
                                                                                }
                                                                            ],
                                                                            "label": "self._wrap"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 20,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "children": [],
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary_splat",
                                                                                    "start_token": 23,
                                                                                    "end_token": 25,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 25,
                                                                                            "end_token": 25,
                                                                                            "children": [],
                                                                                            "label": "extra"
                                                                                        }
                                                                                    ],
                                                                                    "label": "**extra"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, **extra)"
                                                                        }
                                                                    ],
                                                                    "label": "self._wrap(msg, **extra)"
                                                                }
                                                            ],
                                                            "label": "msg = self._wrap(msg, **extra)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 28,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 28,
                                                                    "end_token": 51,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 28,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 30,
                                                                                    "end_token": 30,
                                                                                    "children": [],
                                                                                    "label": "warning"
                                                                                }
                                                                            ],
                                                                            "label": "logger.warning"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 31,
                                                                            "end_token": 51,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 32,
                                                                                    "end_token": 32,
                                                                                    "children": [],
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 34,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 34,
                                                                                            "end_token": 34,
                                                                                            "children": [],
                                                                                            "label": "extra"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 36,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 49,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 37,
                                                                                                            "end_token": 37,
                                                                                                            "children": [],
                                                                                                            "label": "\"json_fields\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "dictionary",
                                                                                                            "start_token": 39,
                                                                                                            "end_token": 49,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 40,
                                                                                                                    "end_token": 42,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 42,
                                                                                                                            "end_token": 44,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 42,
                                                                                                                                    "end_token": 42,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "self"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 44,
                                                                                                                                    "end_token": 44,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "metadata"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.metadata"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**self"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 46,
                                                                                                                    "end_token": 48,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 48,
                                                                                                                            "end_token": 48,
                                                                                                                            "children": [],
                                                                                                                            "label": "extra"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**extra"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "{**self.metadata, **extra}"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}"
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                        }
                                                                    ],
                                                                    "label": "logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                }
                                                            ],
                                                            "label": "logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                        }
                                                    ],
                                                    "label": "\n        msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                }
                                            ],
                                            "label": "def warning(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                        }
                                    ],
                                    "label": "def warning(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "error",
                            "start_line": 82,
                            "end_line": 84,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 51,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 51,
                                            "children": [
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "msg: str"
                                                        },
                                                        {
                                                            "type": "list_splat",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "label": "extra"
                                                                }
                                                            ],
                                                            "label": "**extra"
                                                        }
                                                    ],
                                                    "label": "(self, msg: str, **extra)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 14,
                                                    "end_token": 51,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 17,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 17,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "label": "_wrap"
                                                                                }
                                                                            ],
                                                                            "label": "self._wrap"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 20,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "list_splat",
                                                                                    "start_token": 23,
                                                                                    "end_token": 25,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 25,
                                                                                            "end_token": 25,
                                                                                            "label": "extra"
                                                                                        }
                                                                                    ],
                                                                                    "label": "**extra"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, **extra)"
                                                                        }
                                                                    ],
                                                                    "label": "self._wrap(msg, **extra)"
                                                                }
                                                            ],
                                                            "label": "msg = self._wrap(msg, **extra)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 28,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 28,
                                                                    "end_token": 51,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 28,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 30,
                                                                                    "end_token": 30,
                                                                                    "label": "error"
                                                                                }
                                                                            ],
                                                                            "label": "logger.error"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 31,
                                                                            "end_token": 51,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 32,
                                                                                    "end_token": 32,
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 34,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 34,
                                                                                            "end_token": 34,
                                                                                            "label": "extra"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 36,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 49,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 37,
                                                                                                            "end_token": 37,
                                                                                                            "children": [],
                                                                                                            "label": "\"json_fields\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "dictionary",
                                                                                                            "start_token": 39,
                                                                                                            "end_token": 49,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 40,
                                                                                                                    "end_token": 44,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 42,
                                                                                                                            "end_token": 44,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 42,
                                                                                                                                    "end_token": 42,
                                                                                                                                    "label": "self"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 44,
                                                                                                                                    "end_token": 44,
                                                                                                                                    "label": "metadata"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.metadata"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**self.metadata"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 46,
                                                                                                                    "end_token": 48,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 48,
                                                                                                                            "end_token": 48,
                                                                                                                            "label": "extra"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**extra"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "{**self.metadata, **extra}"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}"
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                        }
                                                                    ],
                                                                    "label": "logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                }
                                                            ],
                                                            "label": "logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                        }
                                                    ],
                                                    "label": "\n        msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                }
                                            ],
                                            "label": "def error(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                        }
                                    ],
                                    "label": "def error(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "debug",
                            "start_line": 86,
                            "end_line": 88,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 51,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 51,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "debug"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "str"
                                                                }
                                                            ],
                                                            "label": "msg: str"
                                                        },
                                                        {
                                                            "type": "list_splat",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "label": "extra"
                                                                }
                                                            ],
                                                            "label": "**extra"
                                                        }
                                                    ],
                                                    "label": "(self, msg: str, **extra)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 14,
                                                    "end_token": 51,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 17,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 17,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "label": "_wrap"
                                                                                }
                                                                            ],
                                                                            "label": "self._wrap"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 20,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary_splat",
                                                                                    "start_token": 23,
                                                                                    "end_token": 25,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 25,
                                                                                            "end_token": 25,
                                                                                            "label": "extra"
                                                                                        }
                                                                                    ],
                                                                                    "label": "**extra"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, **extra)"
                                                                        }
                                                                    ],
                                                                    "label": "self._wrap(msg, **extra)"
                                                                }
                                                            ],
                                                            "label": "msg = self._wrap(msg, **extra)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 28,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 28,
                                                                    "end_token": 51,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 28,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 30,
                                                                                    "end_token": 30,
                                                                                    "label": "debug"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 31,
                                                                            "end_token": 51,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 32,
                                                                                    "end_token": 32,
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "start_token": 34,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 34,
                                                                                            "end_token": 34,
                                                                                            "label": "extra"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 36,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 49,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 37,
                                                                                                            "end_token": 37,
                                                                                                            "label": "\"json_fields\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "dictionary",
                                                                                                            "start_token": 39,
                                                                                                            "end_token": 49,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 40,
                                                                                                                    "end_token": 42,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 42,
                                                                                                                            "end_token": 44,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 42,
                                                                                                                                    "end_token": 42,
                                                                                                                                    "label": "self"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 44,
                                                                                                                                    "end_token": 44,
                                                                                                                                    "label": "metadata"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.metadata"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**self"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 46,
                                                                                                                    "end_token": 48,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 48,
                                                                                                                            "end_token": 48,
                                                                                                                            "label": "extra"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**extra"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "{**self.metadata, **extra}"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}"
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                        }
                                                                    ],
                                                                    "label": "logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                }
                                                            ],
                                                            "label": "logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                        }
                                                    ],
                                                    "label": "\n        msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                }
                                            ],
                                            "label": "def debug(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                        }
                                    ],
                                    "label": "def debug(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "exception",
                            "start_line": 90,
                            "end_line": 92,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 51,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 51,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "exception"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 3,
                                                                    "end_token": 3,
                                                                    "children": [],
                                                                    "label": "self"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 5,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "msg: str"
                                                                }
                                                            ],
                                                            "label": "self, msg: str"
                                                        },
                                                        {
                                                            "type": "list_splat",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "children": [],
                                                                    "label": "extra"
                                                                }
                                                            ],
                                                            "label": "**extra"
                                                        }
                                                    ],
                                                    "label": "(self, msg: str, **extra)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 13,
                                                    "end_token": 51,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "children": [],
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 17,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 17,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 19,
                                                                                    "end_token": 19,
                                                                                    "children": [],
                                                                                    "label": "_wrap"
                                                                                }
                                                                            ],
                                                                            "label": "self._wrap"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 20,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "children": [],
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary_splat",
                                                                                    "start_token": 23,
                                                                                    "end_token": 25,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 25,
                                                                                            "end_token": 25,
                                                                                            "children": [],
                                                                                            "label": "extra"
                                                                                        }
                                                                                    ],
                                                                                    "label": "**extra"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, **extra)"
                                                                        }
                                                                    ],
                                                                    "label": "self._wrap(msg, **extra)"
                                                                }
                                                            ],
                                                            "label": "msg = self._wrap(msg, **extra)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 28,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 28,
                                                                    "end_token": 51,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 28,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 30,
                                                                                    "end_token": 30,
                                                                                    "children": [],
                                                                                    "label": "exception"
                                                                                }
                                                                            ],
                                                                            "label": "logger.exception"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 31,
                                                                            "end_token": 51,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 32,
                                                                                    "end_token": 32,
                                                                                    "children": [],
                                                                                    "label": "msg"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 34,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 34,
                                                                                            "end_token": 34,
                                                                                            "children": [],
                                                                                            "label": "extra"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "start_token": 36,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "start_token": 37,
                                                                                                    "end_token": 49,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 37,
                                                                                                            "end_token": 37,
                                                                                                            "children": [],
                                                                                                            "label": "\"json_fields\""
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "dictionary",
                                                                                                            "start_token": 39,
                                                                                                            "end_token": 49,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 40,
                                                                                                                    "end_token": 44,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 42,
                                                                                                                            "end_token": 44,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 42,
                                                                                                                                    "end_token": 42,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "self"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 44,
                                                                                                                                    "end_token": 44,
                                                                                                                                    "children": [],
                                                                                                                                    "label": "metadata"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.metadata"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**self.metadata"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "dictionary_splat",
                                                                                                                    "start_token": 46,
                                                                                                                    "end_token": 48,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 48,
                                                                                                                            "end_token": 48,
                                                                                                                            "children": [],
                                                                                                                            "label": "extra"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "**extra"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "{**self.metadata, **extra}"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}"
                                                                                                }
                                                                                            ],
                                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}"
                                                                                        }
                                                                                    ],
                                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}"
                                                                                }
                                                                            ],
                                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                        }
                                                                    ],
                                                                    "label": "logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                                }
                                                            ],
                                                            "label": "logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                        }
                                                    ],
                                                    "label": ":\n        msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                                }
                                            ],
                                            "label": "def exception(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                        }
                                    ],
                                    "label": "def exception(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_wrap",
                            "start_line": 94,
                            "end_line": 95,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 17,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 17,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [],
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_wrap"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 12,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 5,
                                                                    "end_token": 5,
                                                                    "children": [],
                                                                    "label": "msg"
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": ": str"
                                                                }
                                                            ],
                                                            "label": "msg: str"
                                                        },
                                                        {
                                                            "type": "list_splat",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "**extra"
                                                        }
                                                    ],
                                                    "label": "(self, msg: str, **extra)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 14,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 15,
                                                            "end_token": 17,
                                                            "children": [
                                                                {
                                                                    "type": "interpolation",
                                                                    "start_token": 16,
                                                                    "end_token": 17,
                                                                    "children": [],
                                                                    "label": "f\"{self.prefix} {msg} {extra}\""
                                                                }
                                                            ],
                                                            "label": "return f\"{self.prefix} {msg} {extra}\""
                                                        }
                                                    ],
                                                    "label": "\n        return f\"{self.prefix} {msg} {extra}\""
                                                }
                                            ],
                                            "label": "def _wrap(self, msg: str, **extra):\n        return f\"{self.prefix} {msg} {extra}\""
                                        }
                                    ],
                                    "label": "def _wrap(self, msg: str, **extra):\n        return f\"{self.prefix} {msg} {extra}\""
                                }
                            ]
                        }
                    ],
                    "label": "class LogMetadata:"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "Executor",
            "start_line": 433,
            "end_line": 713,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 57,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 5,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 0,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "class Executor"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "Executor"
                                },
                                {
                                    "type": "comment",
                                    "start_token": 4,
                                    "end_token": 5,
                                    "children": [],
                                    "label": "\"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \""
                                }
                            ],
                            "label": "class Executor:\n    \"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \""
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 9,
                            "end_token": 11,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 9,
                                    "end_token": 10,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 10,
                                    "end_token": 10,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 12,
                            "end_token": 14,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 12,
                                    "end_token": 13,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 13,
                                    "end_token": 13,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 16,
                            "end_token": 18,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 16,
                                    "end_token": 17,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 17,
                                    "end_token": 17,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 20,
                            "end_token": 22,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 20,
                                    "end_token": 21,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 21,
                                    "end_token": 21,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 23,
                            "end_token": 25,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 23,
                                    "end_token": 24,
                                    "children": [],
                                    "label": "@error_logged"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 24,
                                    "end_token": 24,
                                    "children": [],
                                    "label": "error_logged"
                                }
                            ],
                            "label": "@error_logged\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 27,
                            "end_token": 29,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 27,
                                    "end_token": 28,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 28,
                                    "end_token": 28,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 30,
                            "end_token": 32,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 30,
                                    "end_token": 31,
                                    "children": [],
                                    "label": "@time_measured"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 31,
                                    "end_token": 31,
                                    "children": [],
                                    "label": "time_measured"
                                }
                            ],
                            "label": "@time_measured\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 33,
                            "end_token": 35,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 33,
                                    "end_token": 34,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 34,
                                    "end_token": 34,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 37,
                            "end_token": 39,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 37,
                                    "end_token": 38,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 38,
                                    "end_token": 38,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 41,
                            "end_token": 43,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 41,
                                    "end_token": 42,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 42,
                                    "end_token": 42,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 45,
                            "end_token": 47,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 45,
                                    "end_token": 46,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 46,
                                    "end_token": 46,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 48,
                            "end_token": 50,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 48,
                                    "end_token": 49,
                                    "children": [],
                                    "label": "@error_logged"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 49,
                                    "end_token": 49,
                                    "children": [],
                                    "label": "error_logged"
                                }
                            ],
                            "label": "@error_logged\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 52,
                            "end_token": 54,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 52,
                                    "end_token": 53,
                                    "children": [],
                                    "label": "@classmethod"
                                },
                                {
                                    "type": "classmethod",
                                    "start_token": 53,
                                    "end_token": 53,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 55,
                            "end_token": 57,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 55,
                                    "end_token": 56,
                                    "children": [],
                                    "label": "@time_measured"
                                },
                                {
                                    "type": "identifier",
                                    "start_token": 56,
                                    "end_token": 56,
                                    "children": [],
                                    "label": "time_measured"
                                }
                            ],
                            "label": "@time_measured\n"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "on_node_executor_start",
                            "start_line": 459,
                            "end_line": 473,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 101,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 102,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "on_node_executor_start"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "cls"
                                                        }
                                                    ],
                                                    "label": "(cls)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 102,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 7,
                                                            "end_token": 9,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "configure_logging"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 8,
                                                                    "end_token": 9,
                                                                    "children": [],
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "configure_logging()"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 11,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "children": [],
                                                                    "label": "set_service_name"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 12,
                                                                    "end_token": 14,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "children": [],
                                                                            "label": "\"NodeExecutor\""
                                                                        }
                                                                    ],
                                                                    "label": "(\"NodeExecutor\")"
                                                                }
                                                            ],
                                                            "label": "set_service_name(\"NodeExecutor\")"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 16,
                                                            "end_token": 20,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 16,
                                                                    "end_token": 18,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 16,
                                                                            "end_token": 16,
                                                                            "children": [],
                                                                            "label": "redis"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 18,
                                                                            "end_token": 18,
                                                                            "children": [],
                                                                            "label": "connect"
                                                                        }
                                                                    ],
                                                                    "label": "redis.connect"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 19,
                                                                    "end_token": 20,
                                                                    "children": [],
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "redis.connect()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 22,
                                                            "end_token": 30,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 22,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "children": [],
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 24,
                                                                            "end_token": 24,
                                                                            "children": [],
                                                                            "label": "pid"
                                                                        }
                                                                    ],
                                                                    "label": "cls.pid"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 26,
                                                                    "end_token": 30,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 26,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "children": [],
                                                                                    "label": "os"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [],
                                                                                    "label": "getpid"
                                                                                }
                                                                            ],
                                                                            "label": "os.getpid"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 29,
                                                                            "end_token": 30,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "os.getpid()"
                                                                }
                                                            ],
                                                            "label": "cls.pid = os.getpid()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 32,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 32,
                                                                    "end_token": 34,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 32,
                                                                            "end_token": 32,
                                                                            "children": [],
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 34,
                                                                            "end_token": 34,
                                                                            "children": [],
                                                                            "label": "db_client"
                                                                        }
                                                                    ],
                                                                    "label": "cls.db_client"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 36,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 36,
                                                                            "end_token": 36,
                                                                            "children": [],
                                                                            "label": "get_db_client"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 37,
                                                                            "end_token": 38,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "get_db_client()"
                                                                }
                                                            ],
                                                            "label": "cls.db_client = get_db_client()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 40,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 40,
                                                                    "end_token": 42,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 40,
                                                                            "end_token": 40,
                                                                            "children": [],
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 42,
                                                                            "end_token": 42,
                                                                            "children": [],
                                                                            "label": "creds_manager"
                                                                        }
                                                                    ],
                                                                    "label": "cls.creds_manager"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 44,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 44,
                                                                            "end_token": 44,
                                                                            "children": [],
                                                                            "label": "IntegrationCredentialsManager"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 45,
                                                                            "end_token": 46,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "IntegrationCredentialsManager()"
                                                                }
                                                            ],
                                                            "label": "cls.creds_manager = IntegrationCredentialsManager()"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 49,
                                                            "end_token": 53,
                                                            "children": [],
                                                            "label": "# Set up shutdown handlers"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 55,
                                                            "end_token": 63,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 55,
                                                                    "end_token": 57,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 55,
                                                                            "end_token": 55,
                                                                            "children": [],
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 57,
                                                                            "end_token": 57,
                                                                            "children": [],
                                                                            "label": "shutdown_lock"
                                                                        }
                                                                    ],
                                                                    "label": "cls.shutdown_lock"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 59,
                                                                    "end_token": 63,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 59,
                                                                            "end_token": 61,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 59,
                                                                                    "end_token": 59,
                                                                                    "children": [],
                                                                                    "label": "threading"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 61,
                                                                                    "end_token": 61,
                                                                                    "children": [],
                                                                                    "label": "Lock"
                                                                                }
                                                                            ],
                                                                            "label": "threading.Lock"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 62,
                                                                            "end_token": 63,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "threading.Lock()"
                                                                }
                                                            ],
                                                            "label": "cls.shutdown_lock = threading.Lock()"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 65,
                                                            "end_token": 72,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 65,
                                                                    "end_token": 67,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 65,
                                                                            "end_token": 65,
                                                                            "children": [],
                                                                            "label": "atexit"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 67,
                                                                            "end_token": 67,
                                                                            "children": [],
                                                                            "label": "register"
                                                                        }
                                                                    ],
                                                                    "label": "atexit.register"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 68,
                                                                    "end_token": 72,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 69,
                                                                            "end_token": 71,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 69,
                                                                                    "end_token": 69,
                                                                                    "children": [],
                                                                                    "label": "cls"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 71,
                                                                                    "end_token": 71,
                                                                                    "children": [],
                                                                                    "label": "on_node_executor_stop"
                                                                                }
                                                                            ],
                                                                            "label": "cls.on_node_executor_stop"
                                                                        }
                                                                    ],
                                                                    "label": "(cls.on_node_executor_stop)"
                                                                }
                                                            ],
                                                            "label": "atexit.register(cls.on_node_executor_stop)"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 73,
                                                            "end_token": 77,
                                                            "children": [],
                                                            "label": "# handle regular shutdown\n"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 78,
                                                            "end_token": 101,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 78,
                                                                    "end_token": 80,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 78,
                                                                            "end_token": 78,
                                                                            "children": [],
                                                                            "label": "signal"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 80,
                                                                            "end_token": 80,
                                                                            "children": [],
                                                                            "label": "signal"
                                                                        }
                                                                    ],
                                                                    "label": "signal.signal"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 81,
                                                                    "end_token": 101,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 86,
                                                                            "end_token": 88,
                                                                            "children": [],
                                                                            "label": "signal.SIGTERM"
                                                                        },
                                                                        {
                                                                            "type": "lambda",
                                                                            "start_token": 90,
                                                                            "end_token": 99,
                                                                            "children": [
                                                                                {
                                                                                    "type": "lambda_parameters",
                                                                                    "start_token": 90,
                                                                                    "end_token": 94,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 91,
                                                                                            "end_token": 91,
                                                                                            "children": [],
                                                                                            "label": "_"
                                                                                        }
                                                                                    ],
                                                                                    "label": "lambda _, __:"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 95,
                                                                                    "end_token": 99,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 95,
                                                                                            "end_token": 97,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 95,
                                                                                                    "end_token": 95,
                                                                                                    "children": [],
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 97,
                                                                                                    "end_token": 97,
                                                                                                    "children": [],
                                                                                                    "label": "on_node_executor_sigterm"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.on_node_executor_sigterm"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 98,
                                                                                            "end_token": 99,
                                                                                            "children": [],
                                                                                            "label": "()"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls.on_node_executor_sigterm()"
                                                                                }
                                                                            ],
                                                                            "label": "lambda _, __: cls.on_node_executor_sigterm()"
                                                                        }
                                                                    ],
                                                                    "label": "(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )"
                                                                }
                                                            ],
                                                            "label": "signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )\n"
                                                }
                                            ],
                                            "label": "def on_node_executor_start(cls):\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )\n"
                                        }
                                    ],
                                    "label": "def on_node_executor_start(cls):\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "on_node_executor_stop",
                            "start_line": 475,
                            "end_line": 485,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 79,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 79,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "on_node_executor_stop"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "cls"
                                                        }
                                                    ],
                                                    "label": "(cls)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 79,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 7,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 8,
                                                                    "end_token": 8,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 9,
                                                                            "end_token": 18,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 9,
                                                                                    "end_token": 13,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 9,
                                                                                            "end_token": 11,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 9,
                                                                                                    "end_token": 9,
                                                                                                    "children": [],
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 10,
                                                                                                    "end_token": 11,
                                                                                                    "children": [],
                                                                                                    "label": ".shutdown_lock"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.shutdown_lock"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 12,
                                                                                            "end_token": 13,
                                                                                            "children": [],
                                                                                            "label": ".acquire"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls.shutdown_lock.acquire"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 14,
                                                                                    "end_token": 18,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 15,
                                                                                            "end_token": 17,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 15,
                                                                                                    "end_token": 15,
                                                                                                    "children": [],
                                                                                                    "label": "blocking"
                                                                                                },
                                                                                                {
                                                                                                    "type": "false",
                                                                                                    "start_token": 17,
                                                                                                    "end_token": 17,
                                                                                                    "children": [],
                                                                                                    "label": "False"
                                                                                                }
                                                                                            ],
                                                                                            "label": "blocking=False"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(blocking=False)"
                                                                                }
                                                                            ],
                                                                            "label": "cls.shutdown_lock.acquire(blocking=False)"
                                                                        }
                                                                    ],
                                                                    "label": "not"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 19,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 21,
                                                                            "end_token": 25,
                                                                            "children": [],
                                                                            "label": "return  # already shutting down"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            return  # already shutting down\n"
                                                                }
                                                            ],
                                                            "label": "if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 28,
                                                            "end_token": 34,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 28,
                                                                    "end_token": 34,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 28,
                                                                            "end_token": 30,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 30,
                                                                                    "children": [],
                                                                                    "label": ".info"
                                                                                }
                                                                            ],
                                                                            "label": "logger.info"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 31,
                                                                            "end_token": 34,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 32,
                                                                                    "end_token": 33,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "start_token": 33,
                                                                                            "end_token": 33,
                                                                                            "children": [],
                                                                                            "label": "\"[on_node_executor_stop {cls.pid}]  Releasing locks...\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 36,
                                                            "end_token": 42,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 36,
                                                                    "end_token": 42,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 36,
                                                                            "end_token": 40,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 36,
                                                                                    "end_token": 38,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 36,
                                                                                            "end_token": 36,
                                                                                            "children": [],
                                                                                            "label": "cls"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 37,
                                                                                            "end_token": 38,
                                                                                            "children": [],
                                                                                            "label": ".creds_manager"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls.creds_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 39,
                                                                                    "end_token": 40,
                                                                                    "children": [],
                                                                                    "label": ".release_all_locks"
                                                                                }
                                                                            ],
                                                                            "label": "cls.creds_manager.release_all_locks"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 41,
                                                                            "end_token": 42,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "cls.creds_manager.release_all_locks()"
                                                                }
                                                            ],
                                                            "label": "cls.creds_manager.release_all_locks()"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 44,
                                                            "end_token": 50,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 44,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 44,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 44,
                                                                                    "end_token": 44,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 45,
                                                                                    "end_token": 46,
                                                                                    "children": [],
                                                                                    "label": ".info"
                                                                                }
                                                                            ],
                                                                            "label": "logger.info"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 47,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 48,
                                                                                    "end_token": 49,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "start_token": 49,
                                                                                            "end_token": 49,
                                                                                            "children": [],
                                                                                            "label": "\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 52,
                                                            "end_token": 56,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 52,
                                                                    "end_token": 56,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 52,
                                                                            "end_token": 54,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 52,
                                                                                    "end_token": 52,
                                                                                    "children": [],
                                                                                    "label": "redis"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 53,
                                                                                    "end_token": 54,
                                                                                    "children": [],
                                                                                    "label": ".disconnect"
                                                                                }
                                                                            ],
                                                                            "label": "redis.disconnect"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 55,
                                                                            "end_token": 56,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "redis.disconnect()"
                                                                }
                                                            ],
                                                            "label": "redis.disconnect()"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 58,
                                                            "end_token": 64,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 58,
                                                                    "end_token": 64,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 58,
                                                                            "end_token": 60,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 58,
                                                                                    "end_token": 58,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 59,
                                                                                    "end_token": 60,
                                                                                    "children": [],
                                                                                    "label": ".info"
                                                                                }
                                                                            ],
                                                                            "label": "logger.info"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 61,
                                                                            "end_token": 64,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 62,
                                                                                    "end_token": 63,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "start_token": 63,
                                                                                            "end_token": 63,
                                                                                            "children": [],
                                                                                            "label": "\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "f\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 66,
                                                            "end_token": 71,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 66,
                                                                    "end_token": 71,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 66,
                                                                            "end_token": 66,
                                                                            "children": [],
                                                                            "label": "close_service_client"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 67,
                                                                            "end_token": 71,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 68,
                                                                                    "end_token": 70,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 68,
                                                                                            "end_token": 68,
                                                                                            "children": [],
                                                                                            "label": "cls"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 69,
                                                                                            "end_token": 70,
                                                                                            "children": [],
                                                                                            "label": ".db_client"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls.db_client"
                                                                                }
                                                                            ],
                                                                            "label": "(cls.db_client)"
                                                                        }
                                                                    ],
                                                                    "label": "close_service_client(cls.db_client)"
                                                                }
                                                            ],
                                                            "label": "close_service_client(cls.db_client)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 73,
                                                            "end_token": 79,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 73,
                                                                    "end_token": 79,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 73,
                                                                            "end_token": 75,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 73,
                                                                                    "end_token": 73,
                                                                                    "children": [],
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 74,
                                                                                    "end_token": 75,
                                                                                    "children": [],
                                                                                    "label": ".info"
                                                                                }
                                                                            ],
                                                                            "label": "logger.info"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 76,
                                                                            "end_token": 79,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 77,
                                                                                    "end_token": 78,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "start_token": 78,
                                                                                            "end_token": 78,
                                                                                            "children": [],
                                                                                            "label": "\"[on_node_executor_stop {cls.pid}]  Finished cleanup\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                                        }
                                                    ],
                                                    "label": "\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                                }
                                            ],
                                            "label": "def on_node_executor_stop(cls):\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                        }
                                    ],
                                    "label": "def on_node_executor_stop(cls):\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "on_node_executor_sigterm",
                            "start_line": 488,
                            "end_line": 498,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 71,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 71,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "on_node_executor_sigterm"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "cls"
                                                        }
                                                    ],
                                                    "label": "(cls)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 71,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 7,
                                                            "end_token": 11,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 7,
                                                                    "end_token": 11,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "children": [],
                                                                            "label": "llprint"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 8,
                                                                            "end_token": 11,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 9,
                                                                                    "end_token": 10,
                                                                                    "children": [],
                                                                                    "label": "f\"[on_node_executor_sigterm {cls.pid}]  SIGTERM received\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_sigterm {cls.pid}]  SIGTERM received\")"
                                                                        }
                                                                    ],
                                                                    "label": "llprint(f\"[on_node_executor_sigterm {cls.pid}]  SIGTERM received\")"
                                                                }
                                                            ],
                                                            "label": "llprint(f\"[on_node_executor_sigterm {cls.pid}]  SIGTERM received\")"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 13,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 14,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 15,
                                                                            "end_token": 24,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 15,
                                                                                    "end_token": 19,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 15,
                                                                                            "end_token": 17,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 15,
                                                                                                    "end_token": 15,
                                                                                                    "children": [],
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 16,
                                                                                                    "end_token": 17,
                                                                                                    "children": [],
                                                                                                    "label": ".shutdown_lock"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.shutdown_lock"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 18,
                                                                                            "end_token": 19,
                                                                                            "children": [],
                                                                                            "label": ".acquire"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls.shutdown_lock.acquire"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 20,
                                                                                    "end_token": 24,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "start_token": 21,
                                                                                            "end_token": 23,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 21,
                                                                                                    "end_token": 21,
                                                                                                    "children": [],
                                                                                                    "label": "blocking"
                                                                                                },
                                                                                                {
                                                                                                    "type": "false",
                                                                                                    "start_token": 23,
                                                                                                    "end_token": 23,
                                                                                                    "children": [],
                                                                                                    "label": "False"
                                                                                                }
                                                                                            ],
                                                                                            "label": "blocking=False"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(blocking=False)"
                                                                                }
                                                                            ],
                                                                            "label": "cls.shutdown_lock.acquire(blocking=False)"
                                                                        }
                                                                    ],
                                                                    "label": "not cls.shutdown_lock.acquire(blocking=False)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 26,
                                                                    "end_token": 31,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 27,
                                                                            "end_token": 31,
                                                                            "children": [],
                                                                            "label": "return  # already shutting down"
                                                                        }
                                                                    ],
                                                                    "label": "\n            return  # already shutting down"
                                                                }
                                                            ],
                                                            "label": "if not cls.shutdown_lock.acquire(blocking=False):"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 34,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 34,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 34,
                                                                            "end_token": 34,
                                                                            "children": [],
                                                                            "label": "llprint"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 35,
                                                                            "end_token": 38,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 36,
                                                                                    "end_token": 37,
                                                                                    "children": [],
                                                                                    "label": "f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")"
                                                                        }
                                                                    ],
                                                                    "label": "llprint(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")"
                                                                }
                                                            ],
                                                            "label": "llprint(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 40,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 40,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 40,
                                                                            "end_token": 44,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 40,
                                                                                    "end_token": 42,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 40,
                                                                                            "end_token": 40,
                                                                                            "children": [],
                                                                                            "label": "cls"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 41,
                                                                                            "end_token": 42,
                                                                                            "children": [],
                                                                                            "label": ".creds_manager"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls.creds_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 44,
                                                                                    "children": [],
                                                                                    "label": ".release_all_locks"
                                                                                }
                                                                            ],
                                                                            "label": "cls.creds_manager.release_all_locks"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 45,
                                                                            "end_token": 46,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "cls.creds_manager.release_all_locks()"
                                                                }
                                                            ],
                                                            "label": "cls.creds_manager.release_all_locks()"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 48,
                                                            "end_token": 52,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 48,
                                                                    "end_token": 52,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 48,
                                                                            "end_token": 48,
                                                                            "children": [],
                                                                            "label": "llprint"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 49,
                                                                            "end_token": 52,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 50,
                                                                                    "end_token": 51,
                                                                                    "children": [],
                                                                                    "label": "f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")"
                                                                        }
                                                                    ],
                                                                    "label": "llprint(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")"
                                                                }
                                                            ],
                                                            "label": "llprint(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 54,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 54,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 54,
                                                                            "end_token": 56,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 54,
                                                                                    "end_token": 54,
                                                                                    "children": [],
                                                                                    "label": "redis"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 55,
                                                                                    "end_token": 56,
                                                                                    "children": [],
                                                                                    "label": ".disconnect"
                                                                                }
                                                                            ],
                                                                            "label": "redis.disconnect"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 57,
                                                                            "end_token": 58,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "redis.disconnect()"
                                                                }
                                                            ],
                                                            "label": "redis.disconnect()"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 60,
                                                            "end_token": 64,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 60,
                                                                    "end_token": 64,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 60,
                                                                            "end_token": 60,
                                                                            "children": [],
                                                                            "label": "llprint"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 61,
                                                                            "end_token": 64,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 62,
                                                                                    "end_token": 63,
                                                                                    "children": [],
                                                                                    "label": "f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                                                        }
                                                                    ],
                                                                    "label": "llprint(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                                                }
                                                            ],
                                                            "label": "llprint(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 66,
                                                            "end_token": 71,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 66,
                                                                    "end_token": 71,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 66,
                                                                            "end_token": 68,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 66,
                                                                                    "end_token": 66,
                                                                                    "children": [],
                                                                                    "label": "sys"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 68,
                                                                                    "children": [],
                                                                                    "label": ".exit"
                                                                                }
                                                                            ],
                                                                            "label": "sys.exit"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 69,
                                                                            "end_token": 70,
                                                                            "children": [
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 70,
                                                                                    "end_token": 70,
                                                                                    "children": [],
                                                                                    "label": "0"
                                                                                }
                                                                            ],
                                                                            "label": "(0"
                                                                        }
                                                                    ],
                                                                    "label": "sys.exit(0)"
                                                                }
                                                            ],
                                                            "label": "sys.exit(0)"
                                                        }
                                                    ],
                                                    "label": "\n        llprint(f\"[on_node_executor_sigterm {cls.pid}]  SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")\n        sys.exit(0)"
                                                }
                                            ],
                                            "label": "def on_node_executor_sigterm(cls):\n        llprint(f\"[on_node_executor_sigterm {cls.pid}]  SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")\n        sys.exit(0)"
                                        }
                                    ],
                                    "label": "def on_node_executor_sigterm(cls):\n        llprint(f\"[on_node_executor_sigterm {cls.pid}]  SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}]  Finished cleanup\")\n        sys.exit(0)"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "on_node_execution",
                            "start_line": 502,
                            "end_line": 526,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 139,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 139,
                                            "children": [
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 20,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "label": "cls"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 7,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 9,
                                                                    "end_token": 11,
                                                                    "label": "ExecutionQueue[NodeExecutionEntry"
                                                                }
                                                            ],
                                                            "label": "q: ExecutionQueue[NodeExecutionEntry]"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 15,
                                                            "end_token": 17,
                                                            "label": "node_exec: NodeExecutionEntry"
                                                        }
                                                    ],
                                                    "label": "(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    )"
                                                },
                                                {
                                                    "type": "generic_type",
                                                    "start_token": 22,
                                                    "end_token": 28,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "start_token": 24,
                                                            "end_token": 27,
                                                            "label": "[str, Any"
                                                        }
                                                    ],
                                                    "label": "> dict[str, Any]"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 30,
                                                    "end_token": 139,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 31,
                                                            "end_token": 76,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 33,
                                                                    "end_token": 33,
                                                                    "label": "LogMetadata"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 34,
                                                                    "end_token": 76,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 36,
                                                                            "end_token": 41,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 38,
                                                                                    "end_token": 40,
                                                                                    "label": "node_exec.user_id"
                                                                                }
                                                                            ],
                                                                            "label": "user_id=node_exec.user_id,"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 43,
                                                                            "end_token": 48,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 45,
                                                                                    "end_token": 47,
                                                                                    "label": "node_exec.graph_exec_id"
                                                                                }
                                                                            ],
                                                                            "label": "graph_eid=node_exec.graph_exec_id,"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 50,
                                                                            "end_token": 55,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 52,
                                                                                    "end_token": 54,
                                                                                    "label": "node_exec.graph_id"
                                                                                }
                                                                            ],
                                                                            "label": "graph_id=node_exec.graph_id,"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 57,
                                                                            "end_token": 62,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 59,
                                                                                    "end_token": 61,
                                                                                    "label": "node_exec.node_exec_id"
                                                                                }
                                                                            ],
                                                                            "label": "node_eid=node_exec.node_exec_id,"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 64,
                                                                            "end_token": 69,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 66,
                                                                                    "end_token": 68,
                                                                                    "label": "node_exec.node_id"
                                                                                }
                                                                            ],
                                                                            "label": "node_id=node_exec.node_id,"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 71,
                                                                            "end_token": 74,
                                                                            "label": "block_name=\"-\","
                                                                        }
                                                                    ],
                                                                    "label": "(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )"
                                                                }
                                                            ],
                                                            "label": "log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 79,
                                                            "end_token": 83,
                                                            "label": "execution_stats = {}\n"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 86,
                                                            "end_token": 101,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 88,
                                                                    "end_token": 90,
                                                                    "label": "cls._on_node_execution"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 91,
                                                                    "end_token": 100,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 93,
                                                                            "end_token": 93,
                                                                            "label": "q"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 95,
                                                                            "end_token": 95,
                                                                            "label": "node_exec"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 97,
                                                                            "end_token": 97,
                                                                            "label": "log_metadata"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 99,
                                                                            "end_token": 99,
                                                                            "label": "execution_stats"
                                                                        }
                                                                    ],
                                                                    "label": "(\n            q, node_exec, log_metadata, execution_stats\n"
                                                                }
                                                            ],
                                                            "label": "_ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 103,
                                                            "end_token": 111,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 104,
                                                                    "end_token": 106,
                                                                    "label": "[\"walltime\"]"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 108,
                                                                    "end_token": 110,
                                                                    "label": "timing_info.wall_time"
                                                                }
                                                            ],
                                                            "label": "execution_stats[\"walltime\"] = timing_info.wall_time\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 112,
                                                            "end_token": 119,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 113,
                                                                    "end_token": 115,
                                                                    "label": "[\"cputime\"]"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 117,
                                                                    "end_token": 119,
                                                                    "label": "timing_info.cpu_time"
                                                                }
                                                            ],
                                                            "label": "execution_stats[\"cputime\"] = timing_info.cpu_time"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 122,
                                                            "end_token": 135,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 124,
                                                                    "end_token": 126,
                                                                    "label": "db_client.update_node_execution_stats"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 127,
                                                                    "end_token": 134,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 129,
                                                                            "end_token": 131,
                                                                            "label": "node_exec.node_exec_id"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 133,
                                                                            "end_token": 133,
                                                                            "label": "execution_stats"
                                                                        }
                                                                    ],
                                                                    "label": "(\n            node_exec.node_exec_id, execution_stats\n"
                                                                }
                                                            ],
                                                            "label": "cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 137,
                                                            "end_token": 138,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 138,
                                                                    "end_token": 138,
                                                                    "label": "execution_stats"
                                                                }
                                                            ],
                                                            "label": "return execution_stats"
                                                        }
                                                    ],
                                                    "label": "\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats\n"
                                                }
                                            ],
                                            "label": "def on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    ) -> dict[str, Any]:\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats\n"
                                        }
                                    ],
                                    "label": "def on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    ) -> dict[str, Any]:\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_on_node_execution",
                            "start_line": 530,
                            "end_line": 548,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 103,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 103,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_on_node_execution"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 39,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "cls"
                                                                }
                                                            ],
                                                            "label": "cls"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 7,
                                                            "end_token": 12,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "q"
                                                                },
                                                                {
                                                                    "type": "generic_type",
                                                                    "start_token": 9,
                                                                    "end_token": 12,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "children": [],
                                                                            "label": "ExecutionQueue"
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "start_token": 10,
                                                                            "end_token": 12,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 11,
                                                                                    "end_token": 11,
                                                                                    "children": [],
                                                                                    "label": "NodeExecutionEntry"
                                                                                }
                                                                            ],
                                                                            "label": "[NodeExecutionEntry]"
                                                                        }
                                                                    ],
                                                                    "label": "ExecutionQueue[NodeExecutionEntry]"
                                                                }
                                                            ],
                                                            "label": "q: ExecutionQueue[NodeExecutionEntry]"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 15,
                                                            "end_token": 17,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 15,
                                                                    "end_token": 15,
                                                                    "children": [],
                                                                    "label": "node_exec"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 17,
                                                                    "end_token": 17,
                                                                    "children": [],
                                                                    "label": "NodeExecutionEntry"
                                                                }
                                                            ],
                                                            "label": "node_exec: NodeExecutionEntry"
                                                        },
                                                        {
                                                            "type": "typed_default_parameter",
                                                            "start_token": 20,
                                                            "end_token": 37,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 20,
                                                                    "end_token": 20,
                                                                    "children": [],
                                                                    "label": "log_metadata"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 22,
                                                                    "end_token": 22,
                                                                    "children": [],
                                                                    "label": "LogMetadata"
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 34,
                                                                    "end_token": 36,
                                                                    "children": [],
                                                                    "label": "None = None"
                                                                }
                                                            ],
                                                            "label": "log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,"
                                                        }
                                                    ],
                                                    "label": "\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    )"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 41,
                                                    "end_token": 103,
                                                    "children": [
                                                        {
                                                            "type": "try_statement",
                                                            "start_token": 42,
                                                            "end_token": 103,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 44,
                                                                    "end_token": 87,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 45,
                                                                            "end_token": 51,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 45,
                                                                                    "end_token": 47,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 45,
                                                                                            "end_token": 45,
                                                                                            "children": [],
                                                                                            "label": "log_metadata"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 47,
                                                                                            "end_token": 47,
                                                                                            "children": [],
                                                                                            "label": "info"
                                                                                        }
                                                                                    ],
                                                                                    "label": "log_metadata.info"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 48,
                                                                                    "end_token": 51,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "start_token": 49,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 50,
                                                                                                    "end_token": 50,
                                                                                                    "children": [],
                                                                                                    "label": "\"Start node execution {node_exec.node_exec_id}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "f\"Start node execution {node_exec.node_exec_id}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(f\"Start node execution {node_exec.node_exec_id}\")"
                                                                                }
                                                                            ],
                                                                            "label": "log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")"
                                                                        },
                                                                        {
                                                                            "type": "for_statement",
                                                                            "start_token": 53,
                                                                            "end_token": 79,
                                                                            "children": [
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "start_token": 53,
                                                                                    "end_token": 56,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 54,
                                                                                            "end_token": 54,
                                                                                            "children": [],
                                                                                            "label": "execution"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 56,
                                                                                            "end_token": 56,
                                                                                            "children": [],
                                                                                            "label": "execute_node"
                                                                                        }
                                                                                    ],
                                                                                    "label": "for execution in execute_node"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 57,
                                                                                    "end_token": 71,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 59,
                                                                                            "end_token": 61,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 59,
                                                                                                    "end_token": 59,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 59,
                                                                                                            "end_token": 59,
                                                                                                            "children": [],
                                                                                                            "label": "cls"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 61,
                                                                                                    "end_token": 61,
                                                                                                    "children": [],
                                                                                                    "label": "db_client"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.db_client"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 63,
                                                                                            "end_token": 65,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 63,
                                                                                                    "end_token": 63,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 63,
                                                                                                            "end_token": 63,
                                                                                                            "children": [],
                                                                                                            "label": "cls"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 65,
                                                                                                    "end_token": 65,
                                                                                                    "children": [],
                                                                                                    "label": "creds_manager"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.creds_manager"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 67,
                                                                                            "end_token": 67,
                                                                                            "children": [],
                                                                                            "label": "node_exec"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 69,
                                                                                            "end_token": 69,
                                                                                            "children": [],
                                                                                            "label": "stats"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            )"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 74,
                                                                                    "end_token": 79,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 74,
                                                                                            "end_token": 76,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 74,
                                                                                                    "end_token": 74,
                                                                                                    "children": [],
                                                                                                    "label": "q"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 76,
                                                                                                    "end_token": 76,
                                                                                                    "children": [],
                                                                                                    "label": "add"
                                                                                                }
                                                                                            ],
                                                                                            "label": "q.add"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 77,
                                                                                            "end_token": 79,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 78,
                                                                                                    "end_token": 78,
                                                                                                    "children": [],
                                                                                                    "label": "execution"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(execution)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "q.add(execution)"
                                                                                }
                                                                            ],
                                                                            "label": "for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 81,
                                                                            "end_token": 87,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 81,
                                                                                    "end_token": 83,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 81,
                                                                                            "end_token": 81,
                                                                                            "children": [],
                                                                                            "label": "log_metadata"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 83,
                                                                                            "end_token": 83,
                                                                                            "children": [],
                                                                                            "label": "info"
                                                                                        }
                                                                                    ],
                                                                                    "label": "log_metadata.info"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 84,
                                                                                    "end_token": 87,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "start_token": 85,
                                                                                            "end_token": 86,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 86,
                                                                                                    "end_token": 86,
                                                                                                    "children": [],
                                                                                                    "label": "\"Finished node execution {node_exec.node_exec_id}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "f\"Finished node execution {node_exec.node_exec_id}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(f\"Finished node execution {node_exec.node_exec_id}\")"
                                                                                }
                                                                            ],
                                                                            "label": "log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")"
                                                                        }
                                                                    ],
                                                                    "label": "\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")"
                                                                },
                                                                {
                                                                    "type": "except_clause",
                                                                    "start_token": 89,
                                                                    "end_token": 103,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 90,
                                                                            "end_token": 90,
                                                                            "children": [],
                                                                            "label": "Exception"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 92,
                                                                            "end_token": 92,
                                                                            "children": [],
                                                                            "label": "e"
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 94,
                                                                            "end_token": 103,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 95,
                                                                                    "end_token": 103,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 95,
                                                                                            "end_token": 97,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 95,
                                                                                                    "end_token": 95,
                                                                                                    "children": [],
                                                                                                    "label": "log_metadata"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 97,
                                                                                                    "end_token": 97,
                                                                                                    "children": [],
                                                                                                    "label": "exception"
                                                                                                }
                                                                                            ],
                                                                                            "label": "log_metadata.exception"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 98,
                                                                                            "end_token": 102,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "start_token": 100,
                                                                                                    "end_token": 101,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "start_token": 101,
                                                                                                            "end_token": 101,
                                                                                                            "children": [],
                                                                                                            "label": "\"Failed node execution {node_exec.node_exec_id}: {e}\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "f\"Failed node execution {node_exec.node_exec_id}: {e}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )"
                                                                        }
                                                                    ],
                                                                    "label": "except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )"
                                                                }
                                                            ],
                                                            "label": "try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )"
                                                        }
                                                    ],
                                                    "label": "\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )"
                                                }
                                            ],
                                            "label": "def _on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    ):\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )"
                                        }
                                    ],
                                    "label": "def _on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    ):\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "on_graph_executor_start",
                            "start_line": 550,
                            "end_line": 563,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 75,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 75,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "on_graph_executor_start"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "cls"
                                                        }
                                                    ],
                                                    "label": "(cls)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 75,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 7,
                                                            "end_token": 9,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "configure_logging"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 8,
                                                                    "end_token": 9,
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "configure_logging()"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 11,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 11,
                                                                    "end_token": 11,
                                                                    "label": "set_service_name"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 12,
                                                                    "end_token": 14,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "label": "\"GraphExecutor\""
                                                                        }
                                                                    ],
                                                                    "label": "(\"GraphExecutor\")"
                                                                }
                                                            ],
                                                            "label": "set_service_name(\"GraphExecutor\")"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 17,
                                                            "end_token": 23,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "db_client"
                                                                        }
                                                                    ],
                                                                    "label": "cls.db_client"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 21,
                                                                    "end_token": 23,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "label": "get_db_client"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 23,
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "get_db_client()"
                                                                }
                                                            ],
                                                            "label": "cls.db_client = get_db_client()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 25,
                                                            "end_token": 34,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 25,
                                                                    "end_token": 27,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 25,
                                                                            "end_token": 25,
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "label": "pool_size"
                                                                        }
                                                                    ],
                                                                    "label": "cls.pool_size"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 29,
                                                                    "end_token": 33,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 29,
                                                                            "end_token": 31,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "label": "settings"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 31,
                                                                                    "end_token": 31,
                                                                                    "label": "config"
                                                                                }
                                                                            ],
                                                                            "label": "settings.config"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 33,
                                                                            "end_token": 33,
                                                                            "label": "num_node_workers"
                                                                        }
                                                                    ],
                                                                    "label": "settings.config.num_node_workers"
                                                                }
                                                            ],
                                                            "label": "cls.pool_size = settings.config.num_node_workers\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 35,
                                                            "end_token": 43,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 35,
                                                                    "end_token": 37,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 35,
                                                                            "end_token": 35,
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "label": "pid"
                                                                        }
                                                                    ],
                                                                    "label": "cls.pid"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 39,
                                                                    "end_token": 43,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 39,
                                                                            "end_token": 41,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 39,
                                                                                    "end_token": 39,
                                                                                    "label": "os"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 41,
                                                                                    "end_token": 41,
                                                                                    "label": "getpid"
                                                                                }
                                                                            ],
                                                                            "label": "os.getpid"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 42,
                                                                            "end_token": 43,
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "os.getpid()"
                                                                }
                                                            ],
                                                            "label": "cls.pid = os.getpid()"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 45,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 45,
                                                                    "end_token": 47,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 45,
                                                                            "end_token": 45,
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 47,
                                                                            "end_token": 47,
                                                                            "label": "_init_node_executor_pool"
                                                                        }
                                                                    ],
                                                                    "label": "cls._init_node_executor_pool"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 48,
                                                                    "end_token": 49,
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "cls._init_node_executor_pool()"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 51,
                                                            "end_token": 59,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 51,
                                                                    "end_token": 59,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 51,
                                                                            "end_token": 53,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 51,
                                                                                    "end_token": 51,
                                                                                    "label": "logger"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 53,
                                                                                    "end_token": 53,
                                                                                    "label": "info"
                                                                                }
                                                                            ],
                                                                            "label": "logger.info"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 54,
                                                                            "end_token": 59,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 56,
                                                                                    "end_token": 58,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 56,
                                                                                            "end_token": 56,
                                                                                            "label": "f"
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "start_token": 57,
                                                                                            "end_token": 57,
                                                                                            "label": "\"Graph executor {cls.pid} started with {cls.pool_size} node workers\""
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "start_token": 58,
                                                                                            "end_token": 58,
                                                                                            "label": "\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )"
                                                                }
                                                            ],
                                                            "label": "logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 62,
                                                            "end_token": 66,
                                                            "label": "# Set up shutdown handler"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 68,
                                                            "end_token": 75,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 68,
                                                                    "end_token": 70,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 68,
                                                                            "end_token": 68,
                                                                            "label": "atexit"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 70,
                                                                            "end_token": 70,
                                                                            "label": "register"
                                                                        }
                                                                    ],
                                                                    "label": "atexit.register"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 71,
                                                                    "end_token": 75,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 72,
                                                                            "end_token": 74,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 72,
                                                                                    "end_token": 72,
                                                                                    "label": "cls"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 74,
                                                                                    "end_token": 74,
                                                                                    "label": "on_graph_executor_stop"
                                                                                }
                                                                            ],
                                                                            "label": "cls.on_graph_executor_stop"
                                                                        }
                                                                    ],
                                                                    "label": "(cls.on_graph_executor_stop)"
                                                                }
                                                            ],
                                                            "label": "atexit.register(cls.on_graph_executor_stop)"
                                                        }
                                                    ],
                                                    "label": "\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)"
                                                }
                                            ],
                                            "label": "def on_graph_executor_start(cls):\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)"
                                        }
                                    ],
                                    "label": "def on_graph_executor_start(cls):\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "on_graph_executor_stop",
                            "start_line": 566,
                            "end_line": 572,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 49,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 49,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "on_graph_executor_stop"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "cls"
                                                        }
                                                    ],
                                                    "label": "(cls)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 49,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 7,
                                                            "end_token": 10,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "prefix"
                                                                },
                                                                {
                                                                    "type": "concatenated_string",
                                                                    "start_token": 9,
                                                                    "end_token": 10,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "children": [],
                                                                            "label": "f"
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "start_token": 10,
                                                                            "end_token": 10,
                                                                            "children": [],
                                                                            "label": "\"[on_graph_executor_stop {cls.pid}]\""
                                                                        }
                                                                    ],
                                                                    "label": "f\"[on_graph_executor_stop {cls.pid}]\""
                                                                }
                                                            ],
                                                            "label": "prefix = f\"[on_graph_executor_stop {cls.pid}]\""
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 12,
                                                            "end_token": 18,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 12,
                                                                    "end_token": 14,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "children": [],
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 14,
                                                                            "end_token": 14,
                                                                            "children": [],
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 15,
                                                                    "end_token": 18,
                                                                    "children": [
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 16,
                                                                            "end_token": 17,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "start_token": 16,
                                                                                    "end_token": 16,
                                                                                    "children": [],
                                                                                    "label": "f"
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "children": [],
                                                                                    "label": "\"{prefix}  Terminating node executor pool...\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"{prefix}  Terminating node executor pool...\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"{prefix}  Terminating node executor pool...\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"{prefix}  Terminating node executor pool...\")"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 20,
                                                            "end_token": 26,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 20,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 20,
                                                                            "end_token": 20,
                                                                            "children": [],
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "children": [],
                                                                            "label": "executor"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 24,
                                                                            "end_token": 24,
                                                                            "children": [],
                                                                            "label": "terminate"
                                                                        }
                                                                    ],
                                                                    "label": "cls.executor.terminate"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 25,
                                                                    "end_token": 26,
                                                                    "children": [],
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "cls.executor.terminate()"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 28,
                                                            "end_token": 34,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 28,
                                                                    "end_token": 30,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 28,
                                                                            "end_token": 28,
                                                                            "children": [],
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 30,
                                                                            "end_token": 30,
                                                                            "children": [],
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 31,
                                                                    "end_token": 34,
                                                                    "children": [
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 32,
                                                                            "end_token": 33,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "start_token": 32,
                                                                                    "end_token": 32,
                                                                                    "children": [],
                                                                                    "label": "f"
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "start_token": 33,
                                                                                    "end_token": 33,
                                                                                    "children": [],
                                                                                    "label": "\"{prefix}  Disconnecting DB manager...\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"{prefix}  Disconnecting DB manager...\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"{prefix}  Disconnecting DB manager...\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"{prefix}  Disconnecting DB manager...\")"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 36,
                                                            "end_token": 41,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 36,
                                                                    "end_token": 36,
                                                                    "children": [],
                                                                    "label": "close_service_client"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 37,
                                                                    "end_token": 41,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 38,
                                                                            "end_token": 40,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 38,
                                                                                    "end_token": 38,
                                                                                    "children": [],
                                                                                    "label": "cls"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 40,
                                                                                    "end_token": 40,
                                                                                    "children": [],
                                                                                    "label": "db_client"
                                                                                }
                                                                            ],
                                                                            "label": "cls.db_client"
                                                                        }
                                                                    ],
                                                                    "label": "(cls.db_client)"
                                                                }
                                                            ],
                                                            "label": "close_service_client(cls.db_client)"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 43,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 43,
                                                                    "end_token": 45,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 43,
                                                                            "end_token": 43,
                                                                            "children": [],
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 45,
                                                                            "end_token": 45,
                                                                            "children": [],
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 46,
                                                                    "end_token": 49,
                                                                    "children": [
                                                                        {
                                                                            "type": "concatenated_string",
                                                                            "start_token": 47,
                                                                            "end_token": 48,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "start_token": 47,
                                                                                    "end_token": 47,
                                                                                    "children": [],
                                                                                    "label": "f"
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "start_token": 48,
                                                                                    "end_token": 48,
                                                                                    "children": [],
                                                                                    "label": "\"{prefix}  Finished cleanup\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"{prefix}  Finished cleanup\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"{prefix}  Finished cleanup\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"{prefix}  Finished cleanup\")"
                                                        }
                                                    ],
                                                    "label": "\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix}  Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix}  Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix}  Finished cleanup\")"
                                                }
                                            ],
                                            "label": "def on_graph_executor_stop(cls):\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix}  Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix}  Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix}  Finished cleanup\")"
                                        }
                                    ],
                                    "label": "def on_graph_executor_stop(cls):\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix}  Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix}  Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix}  Finished cleanup\")"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_init_node_executor_pool",
                            "start_line": 575,
                            "end_line": 579,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 29,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 29,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "_init_node_executor_pool"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "cls"
                                                        }
                                                    ],
                                                    "label": "(cls)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 5,
                                                    "end_token": 29,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 7,
                                                            "end_token": 28,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 7,
                                                                    "end_token": 9,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "label": "executor"
                                                                        }
                                                                    ],
                                                                    "label": "cls.executor"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 11,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "label": "Pool"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 12,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 14,
                                                                                    "end_token": 19,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 14,
                                                                                            "end_token": 14,
                                                                                            "label": "processes"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 16,
                                                                                            "end_token": 18,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 16,
                                                                                                    "end_token": 16,
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 18,
                                                                                                    "end_token": 18,
                                                                                                    "label": "pool_size"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.pool_size"
                                                                                        }
                                                                                    ],
                                                                                    "label": "processes=cls.pool_size,"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 21,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 21,
                                                                                            "end_token": 21,
                                                                                            "label": "initializer"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 23,
                                                                                            "end_token": 25,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 23,
                                                                                                    "end_token": 23,
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 25,
                                                                                                    "end_token": 25,
                                                                                                    "label": "on_node_executor_start"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.on_node_executor_start"
                                                                                        }
                                                                                    ],
                                                                                    "label": "initializer=cls.on_node_executor_start,"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )"
                                                                }
                                                            ],
                                                            "label": "cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )"
                                                        }
                                                    ],
                                                    "label": ":\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )\n"
                                                }
                                            ],
                                            "label": "def _init_node_executor_pool(cls):\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )\n"
                                        }
                                    ],
                                    "label": "def _init_node_executor_pool(cls):\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "on_graph_execution",
                            "start_line": 583,
                            "end_line": 604,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 146,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 146,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "on_graph_execution"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 16,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "label": "cls"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 6,
                                                            "end_token": 8,
                                                            "label": "graph_exec: GraphExecutionEntry"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 10,
                                                            "end_token": 14,
                                                            "label": "cancel: threading.Event"
                                                        }
                                                    ],
                                                    "label": "(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    )"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 17,
                                                    "end_token": 146,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 19,
                                                            "end_token": 60,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 19,
                                                                    "end_token": 19,
                                                                    "label": "log_metadata"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 21,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "label": "LogMetadata"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 60,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 24,
                                                                                    "end_token": 28,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "label": "user_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 26,
                                                                                            "end_token": 28,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 26,
                                                                                                    "end_token": 26,
                                                                                                    "label": "graph_exec"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 28,
                                                                                                    "end_token": 28,
                                                                                                    "label": "user_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "graph_exec.user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "user_id=graph_exec.user_id"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 31,
                                                                                    "end_token": 35,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 31,
                                                                                            "end_token": 31,
                                                                                            "label": "graph_eid"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 33,
                                                                                            "end_token": 35,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 33,
                                                                                                    "end_token": 33,
                                                                                                    "label": "graph_exec"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 35,
                                                                                                    "end_token": 35,
                                                                                                    "label": "graph_exec_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "graph_exec.graph_exec_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "graph_eid=graph_exec.graph_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 38,
                                                                                    "end_token": 42,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 38,
                                                                                            "end_token": 38,
                                                                                            "label": "graph_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 40,
                                                                                            "end_token": 42,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 40,
                                                                                                    "end_token": 40,
                                                                                                    "label": "graph_exec"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 42,
                                                                                                    "end_token": 42,
                                                                                                    "label": "graph_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "graph_exec.graph_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "graph_id=graph_exec.graph_id"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 45,
                                                                                    "end_token": 47,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 45,
                                                                                            "end_token": 45,
                                                                                            "label": "node_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 47,
                                                                                            "end_token": 47,
                                                                                            "label": "\"*\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "node_id=\"*\""
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 50,
                                                                                    "end_token": 52,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 50,
                                                                                            "end_token": 50,
                                                                                            "label": "node_eid"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 52,
                                                                                            "end_token": 52,
                                                                                            "label": "\"*\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "node_eid=\"*\""
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 55,
                                                                                    "end_token": 57,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 55,
                                                                                            "end_token": 55,
                                                                                            "label": "block_name"
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 57,
                                                                                            "end_token": 57,
                                                                                            "label": "\"-\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "block_name=\"-\""
                                                                                }
                                                                            ],
                                                                            "label": "(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )"
                                                                }
                                                            ],
                                                            "label": "log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 62,
                                                            "end_token": 81,
                                                            "children": [
                                                                {
                                                                    "type": "tuple",
                                                                    "start_token": 62,
                                                                    "end_token": 68,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 62,
                                                                            "end_token": 62,
                                                                            "label": "timing_info"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 66,
                                                                            "end_token": 66,
                                                                            "label": ","
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 67,
                                                                            "end_token": 67,
                                                                            "label": "error"
                                                                        }
                                                                    ],
                                                                    "label": "timing_info, (exec_stats, error)"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 70,
                                                                    "end_token": 81,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 70,
                                                                            "end_token": 72,
                                                                            "label": "cls._on_graph_execution"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 73,
                                                                            "end_token": 81,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 75,
                                                                                    "end_token": 75,
                                                                                    "label": "graph_exec"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 77,
                                                                                    "end_token": 77,
                                                                                    "label": "cancel"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 79,
                                                                                    "end_token": 79,
                                                                                    "label": "log_metadata"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            graph_exec, cancel, log_metadata\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )"
                                                                }
                                                            ],
                                                            "label": "timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 83,
                                                            "end_token": 91,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 83,
                                                                    "end_token": 86,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 83,
                                                                            "end_token": 83,
                                                                            "label": "exec_stats"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 85,
                                                                            "end_token": 85,
                                                                            "label": "\"walltime\""
                                                                        }
                                                                    ],
                                                                    "label": "exec_stats[\"walltime\"]"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 88,
                                                                    "end_token": 90,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 88,
                                                                            "end_token": 88,
                                                                            "label": "timing_info"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 90,
                                                                            "end_token": 90,
                                                                            "label": "wall_time"
                                                                        }
                                                                    ],
                                                                    "label": "timing_info.wall_time"
                                                                }
                                                            ],
                                                            "label": "exec_stats[\"walltime\"] = timing_info.wall_time\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 92,
                                                            "end_token": 99,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 92,
                                                                    "end_token": 95,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 92,
                                                                            "end_token": 92,
                                                                            "label": "exec_stats"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 94,
                                                                            "end_token": 94,
                                                                            "label": "\"cputime\""
                                                                        }
                                                                    ],
                                                                    "label": "exec_stats[\"cputime\"]"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 97,
                                                                    "end_token": 99,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 97,
                                                                            "end_token": 97,
                                                                            "label": "timing_info"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 99,
                                                                            "end_token": 99,
                                                                            "label": "cpu_time"
                                                                        }
                                                                    ],
                                                                    "label": "timing_info.cpu_time"
                                                                }
                                                            ],
                                                            "label": "exec_stats[\"cputime\"] = timing_info.cpu_time"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 101,
                                                            "end_token": 113,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 101,
                                                                    "end_token": 104,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 101,
                                                                            "end_token": 101,
                                                                            "label": "exec_stats"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 103,
                                                                            "end_token": 103,
                                                                            "label": "\"error\""
                                                                        }
                                                                    ],
                                                                    "label": "exec_stats[\"error\"]"
                                                                },
                                                                {
                                                                    "type": "conditional_expression",
                                                                    "start_token": 106,
                                                                    "end_token": 113,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 106,
                                                                            "end_token": 109,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 106,
                                                                                    "end_token": 106,
                                                                                    "label": "str"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 107,
                                                                                    "end_token": 109,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 108,
                                                                                            "end_token": 108,
                                                                                            "label": "error"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(error)"
                                                                                }
                                                                            ],
                                                                            "label": "str(error)"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 111,
                                                                            "end_token": 111,
                                                                            "label": "error"
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "start_token": 113,
                                                                            "end_token": 113,
                                                                            "label": "None"
                                                                        }
                                                                    ],
                                                                    "label": "str(error) if error else None"
                                                                }
                                                            ],
                                                            "label": "exec_stats[\"error\"] = str(error) if error else None"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 115,
                                                            "end_token": 135,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 115,
                                                                    "end_token": 115,
                                                                    "label": "result"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 117,
                                                                    "end_token": 135,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 117,
                                                                            "end_token": 121,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 117,
                                                                                    "end_token": 117,
                                                                                    "label": "cls"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 119,
                                                                                    "end_token": 119,
                                                                                    "label": "db_client"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 121,
                                                                                    "end_token": 121,
                                                                                    "label": "update_graph_execution_stats"
                                                                                }
                                                                            ],
                                                                            "label": "cls.db_client.update_graph_execution_stats"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 122,
                                                                            "end_token": 135,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 124,
                                                                                    "end_token": 128,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 124,
                                                                                            "end_token": 124,
                                                                                            "label": "graph_exec_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 126,
                                                                                            "end_token": 128,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 126,
                                                                                                    "end_token": 126,
                                                                                                    "label": "graph_exec"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 128,
                                                                                                    "end_token": 128,
                                                                                                    "label": "graph_exec_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "graph_exec.graph_exec_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "graph_exec_id=graph_exec.graph_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 131,
                                                                                    "end_token": 133,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 131,
                                                                                            "end_token": 131,
                                                                                            "label": "stats"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 133,
                                                                                            "end_token": 133,
                                                                                            "label": "exec_stats"
                                                                                        }
                                                                                    ],
                                                                                    "label": "stats=exec_stats"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n"
                                                                        }
                                                                    ],
                                                                    "label": "cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n"
                                                                }
                                                            ],
                                                            "label": "result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 138,
                                                            "end_token": 145,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 138,
                                                                    "end_token": 142,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 138,
                                                                            "end_token": 138,
                                                                            "label": "cls"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 140,
                                                                            "end_token": 140,
                                                                            "label": "db_client"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 142,
                                                                            "end_token": 142,
                                                                            "label": "send_execution_update"
                                                                        }
                                                                    ],
                                                                    "label": "cls.db_client.send_execution_update"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 143,
                                                                    "end_token": 145,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 144,
                                                                            "end_token": 144,
                                                                            "label": "result"
                                                                        }
                                                                    ],
                                                                    "label": "(result)"
                                                                }
                                                            ],
                                                            "label": "cls.db_client.send_execution_update(result)"
                                                        }
                                                    ],
                                                    "label": ":\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)\n"
                                                }
                                            ],
                                            "label": "def on_graph_execution(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    ):\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)\n"
                                        }
                                    ],
                                    "label": "def on_graph_execution(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    ):\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_on_graph_execution",
                            "start_line": 608,
                            "end_line": 713,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 577,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 577,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "_on_graph_execution"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 24,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 9,
                                                            "label": "cls,\n        graph_exec: GraphExecutionEntry"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 12,
                                                            "end_token": 17,
                                                            "label": "cancel: threading.Event,"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 19,
                                                            "end_token": 21,
                                                            "label": "log_metadata: LogMetadata"
                                                        }
                                                    ],
                                                    "label": "(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    )"
                                                },
                                                {
                                                    "type": "union_type",
                                                    "start_token": 25,
                                                    "end_token": 39,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "start_token": 27,
                                                            "end_token": 34,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 29,
                                                                    "end_token": 34,
                                                                    "label": "dict[str, Any]"
                                                                }
                                                            ],
                                                            "label": "tuple[dict[str, Any]"
                                                        },
                                                        {
                                                            "type": "union_type",
                                                            "start_token": 36,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 36,
                                                                    "end_token": 36,
                                                                    "label": "Exception"
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 38,
                                                                    "end_token": 38,
                                                                    "label": "None"
                                                                }
                                                            ],
                                                            "label": "Exception | None"
                                                        }
                                                    ],
                                                    "label": "-> tuple[dict[str, Any], Exception | None]"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 42,
                                                    "end_token": 44,
                                                    "label": "\"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\""
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 45,
                                                    "end_token": 577,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 46,
                                                            "end_token": 52,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 46,
                                                                    "end_token": 48,
                                                                    "label": "log_metadata.info"
                                                                },
                                                                {
                                                                    "type": "format_specifier",
                                                                    "start_token": 50,
                                                                    "end_token": 51,
                                                                    "label": "f\"Start graph execution {graph_exec.graph_exec_id}\""
                                                                }
                                                            ],
                                                            "label": "log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 54,
                                                            "end_token": 73,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 54,
                                                                    "end_token": 54,
                                                                    "label": "exec_stats"
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "start_token": 56,
                                                                    "end_token": 73,
                                                                    "label": "{\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }"
                                                                }
                                                            ],
                                                            "label": "exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 75,
                                                            "end_token": 77,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 75,
                                                                    "end_token": 75,
                                                                    "label": "error"
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "start_token": 77,
                                                                    "end_token": 77,
                                                                    "label": "None"
                                                                }
                                                            ],
                                                            "label": "error = None"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 79,
                                                            "end_token": 81,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 79,
                                                                    "end_token": 79,
                                                                    "label": "finished"
                                                                },
                                                                {
                                                                    "type": "false",
                                                                    "start_token": 81,
                                                                    "end_token": 81,
                                                                    "label": "False"
                                                                }
                                                            ],
                                                            "label": "finished = False"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 84,
                                                            "end_token": 93,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 84,
                                                                    "end_token": 84,
                                                                    "label": "cancel_thread"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 86,
                                                                    "end_token": 93,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 86,
                                                                            "end_token": 88,
                                                                            "label": "threading.Thread"
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 90,
                                                                            "end_token": 92,
                                                                            "label": "target=cancel_handler"
                                                                        }
                                                                    ],
                                                                    "label": "threading.Thread(target=cancel_handler)"
                                                                }
                                                            ],
                                                            "label": "cancel_thread = threading.Thread(target=cancel_handler)"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 95,
                                                            "end_token": 99,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 95,
                                                                    "end_token": 97,
                                                                    "label": "cancel_thread.start"
                                                                }
                                                            ],
                                                            "label": "cancel_thread.start()"
                                                        },
                                                        {
                                                            "type": "try_statement",
                                                            "start_token": 102,
                                                            "end_token": 577,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 104,
                                                                    "end_token": 524,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 105,
                                                                            "end_token": 112,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 105,
                                                                                    "end_token": 105,
                                                                                    "label": "queue"
                                                                                },
                                                                                {
                                                                                    "type": "generic_type",
                                                                                    "start_token": 107,
                                                                                    "end_token": 110,
                                                                                    "label": "ExecutionQueue[NodeExecutionEntry]"
                                                                                }
                                                                            ],
                                                                            "label": "queue = ExecutionQueue[NodeExecutionEntry]()"
                                                                        },
                                                                        {
                                                                            "type": "for_statement",
                                                                            "start_token": 114,
                                                                            "end_token": 127,
                                                                            "children": [
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "start_token": 114,
                                                                                    "end_token": 120,
                                                                                    "label": "for node_exec in graph_exec.start_node_execs:"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 121,
                                                                                    "end_token": 127,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "start_token": 122,
                                                                                            "end_token": 127,
                                                                                            "label": "queue.add(node_exec)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                queue.add(node_exec)"
                                                                                }
                                                                            ],
                                                                            "label": "for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 130,
                                                                            "end_token": 141,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 130,
                                                                                    "end_token": 130,
                                                                                    "label": "running_executions"
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 139,
                                                                                    "end_token": 140,
                                                                                    "label": "{}"
                                                                                }
                                                                            ],
                                                                            "label": "running_executions: dict[str, AsyncResult] = {}\n"
                                                                        },
                                                                        {
                                                                            "type": "function_definition",
                                                                            "start_token": 143,
                                                                            "end_token": 228,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 144,
                                                                                    "end_token": 144,
                                                                                    "label": "make_exec_callback"
                                                                                },
                                                                                {
                                                                                    "type": "parameters",
                                                                                    "start_token": 145,
                                                                                    "end_token": 149,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "typed_parameter",
                                                                                            "start_token": 146,
                                                                                            "end_token": 148,
                                                                                            "label": "exec_data: NodeExecutionEntry"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(exec_data: NodeExecutionEntry)"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 150,
                                                                                    "end_token": 227,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 152,
                                                                                            "end_token": 156,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 152,
                                                                                                    "end_token": 152,
                                                                                                    "label": "node_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 154,
                                                                                                    "end_token": 156,
                                                                                                    "label": "exec_data.node_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "node_id = exec_data.node_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "function_definition",
                                                                                            "start_token": 159,
                                                                                            "end_token": 227,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 160,
                                                                                                    "end_token": 160,
                                                                                                    "label": "callback"
                                                                                                },
                                                                                                {
                                                                                                    "type": "parameters",
                                                                                                    "start_token": 161,
                                                                                                    "end_token": 165,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "typed_parameter",
                                                                                                            "start_token": 162,
                                                                                                            "end_token": 164,
                                                                                                            "label": "result: object"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(result: object)"
                                                                                                },
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": 166,
                                                                                                    "end_token": 226,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "expression_statement",
                                                                                                            "start_token": 168,
                                                                                                            "end_token": 173,
                                                                                                            "label": "running_executions.pop(node_id)"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "nonlocal_statement",
                                                                                                            "start_token": 175,
                                                                                                            "end_token": 176,
                                                                                                            "label": "nonlocal exec_stats"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "if_statement",
                                                                                                            "start_token": 178,
                                                                                                            "end_token": 223,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "if_clause",
                                                                                                                    "start_token": 178,
                                                                                                                    "end_token": 184,
                                                                                                                    "label": "if isinstance(result, dict)"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "block",
                                                                                                                    "start_token": 185,
                                                                                                                    "end_token": 223,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "augmented_assignment",
                                                                                                                            "start_token": 187,
                                                                                                                            "end_token": 193,
                                                                                                                            "label": "exec_stats[\"node_count\"] += 1"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "augmented_assignment",
                                                                                                                            "start_token": 195,
                                                                                                                            "end_token": 208,
                                                                                                                            "label": "exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "augmented_assignment",
                                                                                                                            "start_token": 210,
                                                                                                                            "end_token": 223,
                                                                                                                            "label": "exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": ":\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": ":\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return"
                                                                                                }
                                                                                            ],
                                                                                            "label": "def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback"
                                                                                        },
                                                                                        {
                                                                                            "type": "return_statement",
                                                                                            "start_token": 226,
                                                                                            "end_token": 227,
                                                                                            "label": "return callback"
                                                                                        }
                                                                                    ],
                                                                                    "label": ":\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback"
                                                                                }
                                                                            ],
                                                                            "label": "def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n"
                                                                        },
                                                                        {
                                                                            "type": "while_statement",
                                                                            "start_token": 230,
                                                                            "end_token": 258,
                                                                            "children": [
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 237,
                                                                                    "end_token": 258,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "if_statement",
                                                                                            "start_token": 239,
                                                                                            "end_token": 253,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "if_clause",
                                                                                                    "start_token": 239,
                                                                                                    "end_token": 245,
                                                                                                    "label": "if cancel.is_set():"
                                                                                                },
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": 246,
                                                                                                    "end_token": 253,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 247,
                                                                                                            "end_token": 252,
                                                                                                            "label": "error = RuntimeError(\"Execution is cancelled\")"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "return_statement",
                                                                                                            "start_token": 254,
                                                                                                            "end_token": 257,
                                                                                                            "label": "return exec_stats, error"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\n                    error = RuntimeError(\"Execution is cancelled\")\n"
                                                                                                }
                                                                                            ],
                                                                                            "label": "if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 260,
                                                                                            "end_token": 266,
                                                                                            "label": "exec_data = queue.get()"
                                                                                        }
                                                                                    ],
                                                                                    "label": ":\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n"
                                                                                }
                                                                            ],
                                                                            "label": "while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n"
                                                                        },
                                                                        {
                                                                            "type": "while_statement",
                                                                            "start_token": 424,
                                                                            "end_token": 510,
                                                                            "children": [
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 433,
                                                                                    "end_token": 510,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 434,
                                                                                            "end_token": 442,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 434,
                                                                                                    "end_token": 436,
                                                                                                    "label": "log_metadata.debug"
                                                                                                },
                                                                                                {
                                                                                                    "type": "format_specifier",
                                                                                                    "start_token": 439,
                                                                                                    "end_token": 440,
                                                                                                    "label": "f\"Queue empty; running nodes: {list(running_executions.keys())}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )"
                                                                                        },
                                                                                        {
                                                                                            "type": "for_statement",
                                                                                            "start_token": 444,
                                                                                            "end_token": 457,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "for_in_clause",
                                                                                                    "start_token": 444,
                                                                                                    "end_token": 448,
                                                                                                    "label": "for node_id, execution in"
                                                                                                },
                                                                                                {
                                                                                                    "type": "list",
                                                                                                    "start_token": 449,
                                                                                                    "end_token": 457,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 449,
                                                                                                            "end_token": 456,
                                                                                                            "label": "list(running_executions.items())"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "list(running_executions.items()):"
                                                                                                }
                                                                                            ],
                                                                                            "label": "for node_id, execution in list(running_executions.items()):"
                                                                                        },
                                                                                        {
                                                                                            "type": "if_statement",
                                                                                            "start_token": 459,
                                                                                            "end_token": 473,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "if_clause",
                                                                                                    "start_token": 459,
                                                                                                    "end_token": 465,
                                                                                                    "label": "if cancel.is_set():"
                                                                                                },
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": 466,
                                                                                                    "end_token": 473,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "start_token": 467,
                                                                                                            "end_token": 472,
                                                                                                            "label": "error = RuntimeError(\"Execution is cancelled\")"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "return_statement",
                                                                                                            "start_token": 474,
                                                                                                            "end_token": 477,
                                                                                                            "label": "return exec_stats, error"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "\n                            error = RuntimeError(\"Execution is cancelled\")\n"
                                                                                                }
                                                                                            ],
                                                                                            "label": "if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 502,
                                                                                            "end_token": 508,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 502,
                                                                                                    "end_token": 504,
                                                                                                    "label": "log_metadata.debug"
                                                                                                },
                                                                                                {
                                                                                                    "type": "format_specifier",
                                                                                                    "start_token": 507,
                                                                                                    "end_token": 507,
                                                                                                    "label": "\"Waiting on execution of node {node_id}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "log_metadata.debug(f\"Waiting on execution of node {node_id}\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution"
                                                                                }
                                                                            ],
                                                                            "label": "while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 518,
                                                                            "end_token": 524,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 518,
                                                                                    "end_token": 520,
                                                                                    "label": "log_metadata.info"
                                                                                },
                                                                                {
                                                                                    "type": "format_specifier",
                                                                                    "start_token": 523,
                                                                                    "end_token": 523,
                                                                                    "label": "\"Finished graph execution {graph_exec.graph_exec_id}\""
                                                                                }
                                                                            ],
                                                                            "label": "log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")"
                                                                        }
                                                                    ],
                                                                    "label": "\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")"
                                                                },
                                                                {
                                                                    "type": "except_clause",
                                                                    "start_token": 526,
                                                                    "end_token": 545,
                                                                    "children": [
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 531,
                                                                            "end_token": 544,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 532,
                                                                                    "end_token": 540,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 532,
                                                                                            "end_token": 534,
                                                                                            "label": "log_metadata.exception"
                                                                                        },
                                                                                        {
                                                                                            "type": "format_specifier",
                                                                                            "start_token": 537,
                                                                                            "end_token": 538,
                                                                                            "label": "f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 542,
                                                                                    "end_token": 544,
                                                                                    "label": "error = e"
                                                                                }
                                                                            ],
                                                                            "label": "\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e"
                                                                        }
                                                                    ],
                                                                    "label": "except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n"
                                                                },
                                                                {
                                                                    "type": "finally_clause",
                                                                    "start_token": 546,
                                                                    "end_token": 573,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 549,
                                                                            "end_token": 566,
                                                                            "children": [
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "start_token": 549,
                                                                                    "end_token": 555,
                                                                                    "label": "if not cancel.is_set()"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 556,
                                                                                    "end_token": 566,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "start_token": 558,
                                                                                            "end_token": 560,
                                                                                            "label": "finished = True"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 562,
                                                                                            "end_token": 565,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 562,
                                                                                                    "end_token": 564,
                                                                                                    "label": "cancel.set"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cancel.set("
                                                                                        }
                                                                                    ],
                                                                                    "label": ":\n                finished = True\n                cancel.set()"
                                                                                }
                                                                            ],
                                                                            "label": "if not cancel.is_set():\n                finished = True\n                cancel.set()"
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 568,
                                                                            "end_token": 572,
                                                                            "label": "cancel_thread.join()"
                                                                        }
                                                                    ],
                                                                    "label": "finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n"
                                                                }
                                                            ],
                                                            "label": "try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 574,
                                                            "end_token": 577,
                                                            "label": "return exec_stats, error"
                                                        }
                                                    ],
                                                    "label": "\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error"
                                                }
                                            ],
                                            "label": "def _on_graph_execution(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    ) -> tuple[dict[str, Any], Exception | None]:\n        \"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error"
                                        },
                                        {
                                            "type": "function_placeholder",
                                            "name": "cancel_handler",
                                            "start_line": 628,
                                            "end_line": 636,
                                            "children": [
                                                {
                                                    "type": "module",
                                                    "start_token": 0,
                                                    "end_token": 50,
                                                    "children": [
                                                        {
                                                            "type": "function_definition",
                                                            "start_token": 0,
                                                            "end_token": 48,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 1,
                                                                    "end_token": 1,
                                                                    "children": [],
                                                                    "label": "cancel_handler"
                                                                },
                                                                {
                                                                    "type": "parameters",
                                                                    "start_token": 2,
                                                                    "end_token": 3,
                                                                    "children": [],
                                                                    "label": "()"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 5,
                                                                    "end_token": 48,
                                                                    "children": [
                                                                        {
                                                                            "type": "while_statement",
                                                                            "start_token": 6,
                                                                            "end_token": 21,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "start_token": 7,
                                                                                    "end_token": 12,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 8,
                                                                                            "end_token": 12,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 8,
                                                                                                    "end_token": 8,
                                                                                                    "children": [],
                                                                                                    "label": "cancel"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 10,
                                                                                                    "end_token": 10,
                                                                                                    "children": [],
                                                                                                    "label": "is_set"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cancel.is_set()"
                                                                                        }
                                                                                    ],
                                                                                    "label": "not cancel.is_set()"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 15,
                                                                                    "end_token": 21,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 15,
                                                                                            "end_token": 20,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 15,
                                                                                                    "end_token": 17,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 15,
                                                                                                            "end_token": 15,
                                                                                                            "children": [],
                                                                                                            "label": "cancel"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 17,
                                                                                                            "end_token": 17,
                                                                                                            "children": [],
                                                                                                            "label": "wait"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "cancel.wait"
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 18,
                                                                                                    "end_token": 19,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "integer",
                                                                                                            "start_token": 19,
                                                                                                            "end_token": 19,
                                                                                                            "children": [],
                                                                                                            "label": "1"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "(1"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cancel.wait(1)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cancel.wait(1)\n"
                                                                                }
                                                                            ],
                                                                            "label": "while not cancel.is_set():\n                cancel.wait(1)\n"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 22,
                                                                            "end_token": 27,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "children": [],
                                                                                    "label": "finished"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 25,
                                                                                    "end_token": 27,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "return_statement",
                                                                                            "start_token": 26,
                                                                                            "end_token": 26,
                                                                                            "children": [],
                                                                                            "label": "return"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                return\n"
                                                                                }
                                                                            ],
                                                                            "label": "if finished:\n                return\n"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 28,
                                                                            "end_token": 34,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 28,
                                                                                    "end_token": 32,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 28,
                                                                                            "end_token": 30,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 28,
                                                                                                    "end_token": 28,
                                                                                                    "children": [],
                                                                                                    "label": "cls"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 30,
                                                                                                    "end_token": 30,
                                                                                                    "children": [],
                                                                                                    "label": "executor"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cls.executor"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 32,
                                                                                            "end_token": 32,
                                                                                            "children": [],
                                                                                            "label": "terminate"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls.executor.terminate"
                                                                                },
                                                                                {
                                                                                    "type": "parameters",
                                                                                    "start_token": 33,
                                                                                    "end_token": 34,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "cls.executor.terminate()"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 36,
                                                                            "end_token": 42,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 36,
                                                                                    "end_token": 38,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 36,
                                                                                            "end_token": 36,
                                                                                            "children": [],
                                                                                            "label": "log_metadata"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 38,
                                                                                            "end_token": 38,
                                                                                            "children": [],
                                                                                            "label": "info"
                                                                                        }
                                                                                    ],
                                                                                    "label": "log_metadata.info"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 39,
                                                                                    "end_token": 41,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 40,
                                                                                            "end_token": 41,
                                                                                            "children": [],
                                                                                            "label": "f\"Terminated graph execution {graph_exec.graph_exec_id}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(f\"Terminated graph execution {graph_exec.graph_exec_id}\""
                                                                                }
                                                                            ],
                                                                            "label": "log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 44,
                                                                            "end_token": 48,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 44,
                                                                                    "end_token": 46,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 44,
                                                                                            "end_token": 44,
                                                                                            "children": [],
                                                                                            "label": "cls"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 46,
                                                                                            "end_token": 46,
                                                                                            "children": [],
                                                                                            "label": "_init_node_executor_pool"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cls._init_node_executor_pool"
                                                                                },
                                                                                {
                                                                                    "type": "parameters",
                                                                                    "start_token": 47,
                                                                                    "end_token": 48,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "cls._init_node_executor_pool()"
                                                                        }
                                                                    ],
                                                                    "label": "\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()"
                                                                }
                                                            ],
                                                            "label": "def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()"
                                                        }
                                                    ],
                                                    "label": "def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()\n\n"
                                                }
                                            ]
                                        }
                                    ],
                                    "label": "def _on_graph_execution(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    ) -> tuple[dict[str, Any], Exception | None]:\n        \"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error"
                                }
                            ]
                        }
                    ],
                    "label": "class Executor:\n    \"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \"\"\"\n\n    @classmethod\n    @classmethod\n\n    @classmethod\n\n    @classmethod\n    @error_logged\n\n    @classmethod\n    @time_measured\n    @classmethod\n\n    @classmethod\n\n    @classmethod\n\n    @classmethod\n    @error_logged\n\n    @classmethod\n    @time_measured\n"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "ExecutionManager",
            "start_line": 716,
            "end_line": 930,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 24,
                    "children": [
                        {
                            "type": "decorated_definition",
                            "start_token": 0,
                            "end_token": 6,
                            "children": [
                                {
                                    "type": "class_definition",
                                    "start_token": 0,
                                    "end_token": 6,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 0,
                                            "end_token": 0,
                                            "children": [],
                                            "label": "class"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 1,
                                            "end_token": 1,
                                            "children": [],
                                            "label": "ExecutionManager"
                                        },
                                        {
                                            "type": "argument_list",
                                            "start_token": 2,
                                            "end_token": 4,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 3,
                                                    "end_token": 3,
                                                    "children": [],
                                                    "label": "AppService"
                                                }
                                            ],
                                            "label": "(AppService)"
                                        },
                                        {
                                            "type": "block",
                                            "start_token": 5,
                                            "end_token": 6,
                                            "children": [],
                                            "label": ":\n"
                                        }
                                    ],
                                    "label": "class ExecutionManager(AppService):\n"
                                }
                            ],
                            "label": "class ExecutionManager(AppService):\n"
                        },
                        {
                            "type": "decorator",
                            "start_token": 8,
                            "end_token": 9,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 9,
                                    "end_token": 9,
                                    "children": [],
                                    "label": "classmethod"
                                }
                            ],
                            "label": "@classmethod"
                        },
                        {
                            "type": "decorator",
                            "start_token": 13,
                            "end_token": 14,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 14,
                                    "end_token": 14,
                                    "children": [],
                                    "label": "property"
                                }
                            ],
                            "label": "@property"
                        },
                        {
                            "type": "decorator",
                            "start_token": 17,
                            "end_token": 18,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 18,
                                    "end_token": 18,
                                    "children": [],
                                    "label": "expose"
                                }
                            ],
                            "label": "@expose"
                        },
                        {
                            "type": "decorator",
                            "start_token": 21,
                            "end_token": 22,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 22,
                                    "end_token": 22,
                                    "children": [],
                                    "label": "expose"
                                }
                            ],
                            "label": "@expose"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__init__",
                            "start_line": 717,
                            "end_line": 723,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 68,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 68,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "__init__"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 68,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 7,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 7,
                                                                    "end_token": 11,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "children": [],
                                                                            "label": "super"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "children": [],
                                                                            "label": "__init__"
                                                                        }
                                                                    ],
                                                                    "label": "super().__init__"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 12,
                                                                    "end_token": 13,
                                                                    "children": [],
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "super().__init__()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 15,
                                                                    "end_token": 17,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "children": [],
                                                                            "label": "use_redis"
                                                                        }
                                                                    ],
                                                                    "label": "self.use_redis"
                                                                },
                                                                {
                                                                    "type": "true",
                                                                    "start_token": 19,
                                                                    "end_token": 19,
                                                                    "children": [],
                                                                    "label": "True"
                                                                }
                                                            ],
                                                            "label": "self.use_redis = True"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 21,
                                                            "end_token": 25,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 21,
                                                                    "end_token": 23,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 23,
                                                                            "end_token": 23,
                                                                            "children": [],
                                                                            "label": "use_supabase"
                                                                        }
                                                                    ],
                                                                    "label": "self.use_supabase"
                                                                },
                                                                {
                                                                    "type": "true",
                                                                    "start_token": 25,
                                                                    "end_token": 25,
                                                                    "children": [],
                                                                    "label": "True"
                                                                }
                                                            ],
                                                            "label": "self.use_supabase = True"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 27,
                                                            "end_token": 35,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 27,
                                                                    "end_token": 29,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 29,
                                                                            "end_token": 29,
                                                                            "children": [],
                                                                            "label": "pool_size"
                                                                        }
                                                                    ],
                                                                    "label": "self.pool_size"
                                                                },
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 31,
                                                                    "end_token": 35,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 31,
                                                                            "end_token": 31,
                                                                            "children": [],
                                                                            "label": "settings"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 33,
                                                                            "end_token": 33,
                                                                            "children": [],
                                                                            "label": "config"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 35,
                                                                            "end_token": 35,
                                                                            "children": [],
                                                                            "label": "num_graph_workers"
                                                                        }
                                                                    ],
                                                                    "label": "settings.config.num_graph_workers"
                                                                }
                                                            ],
                                                            "label": "self.pool_size = settings.config.num_graph_workers"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 37,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 37,
                                                                    "end_token": 39,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 37,
                                                                            "end_token": 37,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 39,
                                                                            "end_token": 39,
                                                                            "children": [],
                                                                            "label": "queue"
                                                                        }
                                                                    ],
                                                                    "label": "self.queue"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 41,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "generic_type",
                                                                            "start_token": 41,
                                                                            "end_token": 44,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 41,
                                                                                    "end_token": 41,
                                                                                    "children": [],
                                                                                    "label": "ExecutionQueue"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 43,
                                                                                    "children": [],
                                                                                    "label": "GraphExecutionEntry"
                                                                                }
                                                                            ],
                                                                            "label": "ExecutionQueue[GraphExecutionEntry]"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 45,
                                                                            "end_token": 46,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "ExecutionQueue[GraphExecutionEntry]()"
                                                                }
                                                            ],
                                                            "label": "self.queue = ExecutionQueue[GraphExecutionEntry]()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 48,
                                                            "end_token": 67,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 48,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 48,
                                                                            "end_token": 48,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 50,
                                                                            "end_token": 50,
                                                                            "children": [],
                                                                            "label": "active_graph_runs"
                                                                        }
                                                                    ],
                                                                    "label": "self.active_graph_runs"
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "start_token": 52,
                                                                    "end_token": 67,
                                                                    "children": [
                                                                        {
                                                                            "type": "generic_type",
                                                                            "start_token": 53,
                                                                            "end_token": 64,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 53,
                                                                                    "end_token": 53,
                                                                                    "children": [],
                                                                                    "label": "["
                                                                                },
                                                                                {
                                                                                    "type": "tuple",
                                                                                    "start_token": 56,
                                                                                    "end_token": 63,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 58,
                                                                                            "end_token": 58,
                                                                                            "children": [],
                                                                                            "label": "Future"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 60,
                                                                                            "end_token": 62,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 60,
                                                                                                    "end_token": 60,
                                                                                                    "children": [],
                                                                                                    "label": "threading"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 62,
                                                                                                    "end_token": 62,
                                                                                                    "children": [],
                                                                                                    "label": "Event"
                                                                                                }
                                                                                            ],
                                                                                            "label": "threading.Event"
                                                                                        }
                                                                                    ],
                                                                                    "label": "tuple[Future, threading.Event]"
                                                                                }
                                                                            ],
                                                                            "label": "[str, tuple[Future, threading.Event]]"
                                                                        },
                                                                        {
                                                                            "type": "dict",
                                                                            "start_token": 66,
                                                                            "end_token": 67,
                                                                            "children": [],
                                                                            "label": "{}"
                                                                        }
                                                                    ],
                                                                    "label": "dict[str, tuple[Future, threading.Event]] = {}"
                                                                }
                                                            ],
                                                            "label": "self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}"
                                                        }
                                                    ],
                                                    "label": "\n        super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}\n"
                                                }
                                            ],
                                            "label": "def __init__(self):\n        super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}\n"
                                        }
                                    ],
                                    "label": "def __init__(self):\n        super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "get_port",
                            "start_line": 726,
                            "end_line": 727,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 16,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 16,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [],
                                                    "label": "def"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "get_port"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "cls"
                                                        }
                                                    ],
                                                    "label": "(cls)"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 6,
                                                    "end_token": 7,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 7,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": "int"
                                                        }
                                                    ],
                                                    "label": "> int"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 9,
                                                    "end_token": 16,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 10,
                                                            "end_token": 15,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 11,
                                                                    "end_token": 15,
                                                                    "children": [
                                                                        {
                                                                            "type": "dotted_name",
                                                                            "start_token": 11,
                                                                            "end_token": 12,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 11,
                                                                                    "end_token": 11,
                                                                                    "children": [],
                                                                                    "label": "settings"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 13,
                                                                                    "end_token": 13,
                                                                                    "children": [],
                                                                                    "label": "config"
                                                                                }
                                                                            ],
                                                                            "label": "settings."
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "children": [],
                                                                            "label": "execution_manager_port"
                                                                        }
                                                                    ],
                                                                    "label": "settings.config.execution_manager_port"
                                                                }
                                                            ],
                                                            "label": "return settings.config.execution_manager_port"
                                                        }
                                                    ],
                                                    "label": "\n        return settings.config.execution_manager_port\n"
                                                }
                                            ],
                                            "label": "def get_port(cls) -> int:\n        return settings.config.execution_manager_port\n"
                                        }
                                    ],
                                    "label": "def get_port(cls) -> int:\n        return settings.config.execution_manager_port\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "run_service",
                            "start_line": 729,
                            "end_line": 755,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 155,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 155,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "run_service"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 5,
                                                    "end_token": 155,
                                                    "children": [
                                                        {
                                                            "type": "import_from_statement",
                                                            "start_token": 7,
                                                            "end_token": 14,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 8,
                                                                    "end_token": 12,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 8,
                                                                            "end_token": 8,
                                                                            "label": "backend"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 10,
                                                                            "end_token": 10,
                                                                            "label": "integrations"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "label": "credentials_store"
                                                                        }
                                                                    ],
                                                                    "label": "backend.integrations.credentials_store"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 14,
                                                                    "end_token": 14,
                                                                    "label": "IntegrationCredentialsStore"
                                                                }
                                                            ],
                                                            "label": "from backend.integrations.credentials_store import IntegrationCredentialsStore"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 17,
                                                            "end_token": 23,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "credentials_store"
                                                                        }
                                                                    ],
                                                                    "label": "self.credentials_store"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 21,
                                                                    "end_token": 23,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "label": "IntegrationCredentialsStore"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 23,
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "IntegrationCredentialsStore()"
                                                                }
                                                            ],
                                                            "label": "self.credentials_store = IntegrationCredentialsStore()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 25,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 25,
                                                                    "end_token": 27,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 25,
                                                                            "end_token": 25,
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "label": "executor"
                                                                        }
                                                                    ],
                                                                    "label": "self.executor"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 29,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 29,
                                                                            "end_token": 29,
                                                                            "label": "ProcessPoolExecutor"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 30,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 32,
                                                                                    "end_token": 37,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 32,
                                                                                            "end_token": 32,
                                                                                            "label": "max_workers"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 34,
                                                                                            "end_token": 36,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 34,
                                                                                                    "end_token": 34,
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 36,
                                                                                                    "end_token": 36,
                                                                                                    "label": "pool_size"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.pool_size"
                                                                                        }
                                                                                    ],
                                                                                    "label": "max_workers=self.pool_size,"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 39,
                                                                                    "end_token": 44,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 39,
                                                                                            "end_token": 39,
                                                                                            "label": "initializer"
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 41,
                                                                                            "end_token": 43,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 41,
                                                                                                    "end_token": 41,
                                                                                                    "label": "Executor"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 43,
                                                                                                    "end_token": 43,
                                                                                                    "label": "on_graph_executor_start"
                                                                                                }
                                                                                            ],
                                                                                            "label": "Executor.on_graph_executor_start"
                                                                                        }
                                                                                    ],
                                                                                    "label": "initializer=Executor.on_graph_executor_start,"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )"
                                                                }
                                                            ],
                                                            "label": "self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 48,
                                                            "end_token": 54,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 48,
                                                                    "end_token": 48,
                                                                    "label": "sync_manager"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 50,
                                                                    "end_token": 54,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 50,
                                                                            "end_token": 52,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 50,
                                                                                    "end_token": 50,
                                                                                    "label": "multiprocessing"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 52,
                                                                                    "end_token": 52,
                                                                                    "label": "Manager"
                                                                                }
                                                                            ],
                                                                            "label": "multiprocessing.Manager"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 53,
                                                                            "end_token": 54,
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "multiprocessing.Manager()"
                                                                }
                                                            ],
                                                            "label": "sync_manager = multiprocessing.Manager()"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 56,
                                                            "end_token": 64,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 56,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 56,
                                                                            "end_token": 56,
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 58,
                                                                            "end_token": 58,
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 59,
                                                                    "end_token": 64,
                                                                    "children": [
                                                                        {
                                                                            "type": "interpolation",
                                                                            "start_token": 61,
                                                                            "end_token": 62,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 62,
                                                                                    "end_token": 62,
                                                                                    "label": "\"[{self.service_name}] Started with max-{self.pool_size} graph workers\""
                                                                                }
                                                                            ],
                                                                            "label": "f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\""
                                                                        }
                                                                    ],
                                                                    "label": "(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )"
                                                                }
                                                            ],
                                                            "label": "logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )"
                                                        },
                                                        {
                                                            "type": "while_statement",
                                                            "start_token": 66,
                                                            "end_token": 154,
                                                            "children": [
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "start_token": 67,
                                                                    "end_token": 67,
                                                                    "label": "True"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 68,
                                                                    "end_token": 154,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 70,
                                                                            "end_token": 78,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 70,
                                                                                    "end_token": 70,
                                                                                    "label": "graph_exec_data"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 72,
                                                                                    "end_token": 78,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 72,
                                                                                            "end_token": 76,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 72,
                                                                                                    "end_token": 74,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 72,
                                                                                                            "end_token": 72,
                                                                                                            "label": "self"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 74,
                                                                                                            "end_token": 74,
                                                                                                            "label": "queue"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "self.queue"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 76,
                                                                                                    "end_token": 76,
                                                                                                    "label": "get"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.queue.get"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 77,
                                                                                            "end_token": 78,
                                                                                            "label": "()"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.queue.get()"
                                                                                }
                                                                            ],
                                                                            "label": "graph_exec_data = self.queue.get()"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 80,
                                                                            "end_token": 85,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 80,
                                                                                    "end_token": 80,
                                                                                    "label": "graph_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 82,
                                                                                    "end_token": 84,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 82,
                                                                                            "end_token": 82,
                                                                                            "label": "graph_exec_data"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 84,
                                                                                            "end_token": 84,
                                                                                            "label": "graph_exec_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "graph_exec_data.graph_exec_id"
                                                                                }
                                                                            ],
                                                                            "label": "graph_exec_id = graph_exec_data.graph_exec_id\n"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 86,
                                                                            "end_token": 94,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 86,
                                                                                    "end_token": 88,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 86,
                                                                                            "end_token": 86,
                                                                                            "label": "logger"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 88,
                                                                                            "end_token": 88,
                                                                                            "label": "debug"
                                                                                        }
                                                                                    ],
                                                                                    "label": "logger.debug"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 89,
                                                                                    "end_token": 94,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "start_token": 91,
                                                                                            "end_token": 92,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "start_token": 92,
                                                                                                    "end_token": 92,
                                                                                                    "label": "\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 96,
                                                                            "end_token": 102,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 96,
                                                                                    "end_token": 96,
                                                                                    "label": "cancel_event"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 98,
                                                                                    "end_token": 102,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 98,
                                                                                            "end_token": 100,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 98,
                                                                                                    "end_token": 98,
                                                                                                    "label": "sync_manager"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 100,
                                                                                                    "end_token": 100,
                                                                                                    "label": "Event"
                                                                                                }
                                                                                            ],
                                                                                            "label": "sync_manager.Event"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 101,
                                                                                            "end_token": 102,
                                                                                            "label": "()"
                                                                                        }
                                                                                    ],
                                                                                    "label": "sync_manager.Event()"
                                                                                }
                                                                            ],
                                                                            "label": "cancel_event = sync_manager.Event()"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 104,
                                                                            "end_token": 120,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 104,
                                                                                    "end_token": 104,
                                                                                    "label": "future"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 106,
                                                                                    "end_token": 120,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 106,
                                                                                            "end_token": 110,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 106,
                                                                                                    "end_token": 108,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 106,
                                                                                                            "end_token": 106,
                                                                                                            "label": "self"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 108,
                                                                                                            "end_token": 108,
                                                                                                            "label": "executor"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "self.executor"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 110,
                                                                                                    "end_token": 110,
                                                                                                    "label": "submit"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.executor.submit"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 111,
                                                                                            "end_token": 120,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 113,
                                                                                                    "end_token": 115,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 113,
                                                                                                            "end_token": 113,
                                                                                                            "label": "Executor"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 115,
                                                                                                            "end_token": 115,
                                                                                                            "label": "on_graph_execution"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "Executor.on_graph_execution"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 117,
                                                                                                    "end_token": 117,
                                                                                                    "label": "graph_exec_data"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 119,
                                                                                                    "end_token": 119,
                                                                                                    "label": "cancel_event"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n"
                                                                                }
                                                                            ],
                                                                            "label": "future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 123,
                                                                            "end_token": 134,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "start_token": 123,
                                                                                    "end_token": 128,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 123,
                                                                                            "end_token": 125,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 123,
                                                                                                    "end_token": 123,
                                                                                                    "label": "self"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 125,
                                                                                                    "end_token": 125,
                                                                                                    "label": "active_graph_runs"
                                                                                                }
                                                                                            ],
                                                                                            "label": "self.active_graph_runs"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 127,
                                                                                            "end_token": 127,
                                                                                            "label": "graph_exec_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.active_graph_runs[graph_exec_id]"
                                                                                },
                                                                                {
                                                                                    "type": "tuple",
                                                                                    "start_token": 130,
                                                                                    "end_token": 134,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 131,
                                                                                            "end_token": 131,
                                                                                            "label": "future"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 133,
                                                                                            "end_token": 133,
                                                                                            "label": "cancel_event"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(future, cancel_event)"
                                                                                }
                                                                            ],
                                                                            "label": "self.active_graph_runs[graph_exec_id] = (future, cancel_event)"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 136,
                                                                            "end_token": 155,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 136,
                                                                                    "end_token": 138,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 136,
                                                                                            "end_token": 136,
                                                                                            "label": "future"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 138,
                                                                                            "end_token": 138,
                                                                                            "label": "add_done_callback"
                                                                                        }
                                                                                    ],
                                                                                    "label": "future.add_done_callback"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 139,
                                                                                    "end_token": 155,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "lambda",
                                                                                            "start_token": 141,
                                                                                            "end_token": 153,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "lambda_parameters",
                                                                                                    "start_token": 141,
                                                                                                    "end_token": 142,
                                                                                                    "label": "lambda _"
                                                                                                },
                                                                                                {
                                                                                                    "type": "block",
                                                                                                    "start_token": 143,
                                                                                                    "end_token": 153,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "start_token": 144,
                                                                                                            "end_token": 153,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "start_token": 144,
                                                                                                                    "end_token": 148,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "start_token": 144,
                                                                                                                            "end_token": 146,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 144,
                                                                                                                                    "end_token": 144,
                                                                                                                                    "label": "self"
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "start_token": 146,
                                                                                                                                    "end_token": 146,
                                                                                                                                    "label": "active_graph_runs"
                                                                                                                                }
                                                                                                                            ],
                                                                                                                            "label": "self.active_graph_runs"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 148,
                                                                                                                            "end_token": 148,
                                                                                                                            "label": "pop"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "self.active_graph_runs.pop"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "start_token": 149,
                                                                                                                    "end_token": 153,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "start_token": 150,
                                                                                                                            "end_token": 150,
                                                                                                                            "label": "graph_exec_id"
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "none",
                                                                                                                            "start_token": 152,
                                                                                                                            "end_token": 152,
                                                                                                                            "label": "None"
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "(graph_exec_id, None)"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "self.active_graph_runs.pop(graph_exec_id, None)"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": ": self.active_graph_runs.pop(graph_exec_id, None)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "lambda _: self.active_graph_runs.pop(graph_exec_id, None)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n"
                                                                }
                                                            ],
                                                            "label": "while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n"
                                                        }
                                                    ],
                                                    "label": ":\n        from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )"
                                                }
                                            ],
                                            "label": "def run_service(self):\n        from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )"
                                        }
                                    ],
                                    "label": "def run_service(self):\n        from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "cleanup",
                            "start_line": 756,
                            "end_line": 760,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 34,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 34,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "cleanup"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 34,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 7,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 7,
                                                                    "end_token": 9,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "label": "logger"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "logger.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 10,
                                                                    "end_token": 13,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "label": "f"
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "start_token": 12,
                                                                            "end_token": 12,
                                                                            "label": "\"[{__class__.__name__}]  Shutting down graph executor pool...\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"[{__class__.__name__}]  Shutting down graph executor pool...\")"
                                                                }
                                                            ],
                                                            "label": "logger.info(f\"[{__class__.__name__}]  Shutting down graph executor pool...\")"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 15,
                                                            "end_token": 24,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 15,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 15,
                                                                            "end_token": 17,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 15,
                                                                                    "end_token": 15,
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "label": "executor"
                                                                                }
                                                                            ],
                                                                            "label": "self.executor"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "shutdown"
                                                                        }
                                                                    ],
                                                                    "label": "self.executor.shutdown"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 20,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "start_token": 21,
                                                                            "end_token": 23,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "cancel_futures"
                                                                                },
                                                                                {
                                                                                    "type": "true",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "True"
                                                                                }
                                                                            ],
                                                                            "label": "cancel_futures=True"
                                                                        }
                                                                    ],
                                                                    "label": "(cancel_futures=True)"
                                                                }
                                                            ],
                                                            "label": "self.executor.shutdown(cancel_futures=True)"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 27,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 27,
                                                                    "end_token": 31,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 27,
                                                                            "end_token": 29,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 27,
                                                                                    "end_token": 27,
                                                                                    "label": "super"
                                                                                }
                                                                            ],
                                                                            "label": "super()"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 31,
                                                                            "end_token": 31,
                                                                            "label": "cleanup"
                                                                        }
                                                                    ],
                                                                    "label": "super().cleanup"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 32,
                                                                    "end_token": 33,
                                                                    "children": [],
                                                                    "label": "()"
                                                                }
                                                            ],
                                                            "label": "super().cleanup()"
                                                        }
                                                    ],
                                                    "label": "\n        logger.info(f\"[{__class__.__name__}]  Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()\n"
                                                }
                                            ],
                                            "label": "def cleanup(self):\n        logger.info(f\"[{__class__.__name__}]  Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()\n"
                                        }
                                    ],
                                    "label": "def cleanup(self):\n        logger.info(f\"[{__class__.__name__}]  Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "db_client",
                            "start_line": 763,
                            "end_line": 764,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 14,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 14,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "label": "db_client"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 6,
                                                    "end_token": 7,
                                                    "label": "> \"DatabaseManager\""
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 8,
                                                    "end_token": 14,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 10,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 11,
                                                                    "end_token": 13,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "label": "get_db_client"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 12,
                                                                            "end_token": 13,
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "get_db_client()"
                                                                }
                                                            ],
                                                            "label": "return get_db_client()"
                                                        }
                                                    ],
                                                    "label": ":\n        return get_db_client()\n"
                                                }
                                            ],
                                            "label": "def db_client(self) -> \"DatabaseManager\":\n        return get_db_client()\n"
                                        }
                                    ],
                                    "label": "def db_client(self) -> \"DatabaseManager\":\n        return get_db_client()\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "add_execution",
                            "start_line": 767,
                            "end_line": 848,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 492,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 492,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "add_execution"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 31,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 7,
                                                            "end_token": 9,
                                                            "children": [],
                                                            "label": "graph_id: str"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 12,
                                                            "end_token": 14,
                                                            "children": [],
                                                            "label": "data: BlockInput"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 17,
                                                            "end_token": 19,
                                                            "children": [],
                                                            "label": "user_id: str"
                                                        },
                                                        {
                                                            "type": "typed_default_parameter",
                                                            "start_token": 22,
                                                            "end_token": 28,
                                                            "children": [],
                                                            "label": "graph_version: int | None = None"
                                                        }
                                                    ],
                                                    "label": "(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    )"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 35,
                                                    "end_token": 490,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 37,
                                                            "end_token": 62,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 43,
                                                                    "end_token": 62,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 43,
                                                                            "end_token": 47,
                                                                            "children": [],
                                                                            "label": "self.db_client.get_graph"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 48,
                                                                            "end_token": 62,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 50,
                                                                                    "end_token": 52,
                                                                                    "children": [],
                                                                                    "label": "graph_id=graph_id"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 54,
                                                                                    "end_token": 56,
                                                                                    "children": [],
                                                                                    "label": "user_id=user_id"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 58,
                                                                                    "end_token": 60,
                                                                                    "children": [],
                                                                                    "label": "version=graph_version"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )"
                                                                }
                                                            ],
                                                            "label": "graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 64,
                                                            "end_token": 74,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 65,
                                                                    "end_token": 66,
                                                                    "children": [],
                                                                    "label": "not graph"
                                                                },
                                                                {
                                                                    "type": "raise_statement",
                                                                    "start_token": 69,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 73,
                                                                            "end_token": 73,
                                                                            "children": [],
                                                                            "label": "\"Graph #{graph_id} not found.\""
                                                                        }
                                                                    ],
                                                                    "label": "raise ValueError(f\"Graph #{graph_id} not found.\")"
                                                                }
                                                            ],
                                                            "label": "if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 77,
                                                            "end_token": 84,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 77,
                                                                    "end_token": 80,
                                                                    "children": [],
                                                                    "label": "graph.validate_graph("
                                                                }
                                                            ],
                                                            "label": "graph.validate_graph(for_run=True)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 86,
                                                            "end_token": 93,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 86,
                                                                    "end_token": 93,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 86,
                                                                            "end_token": 88,
                                                                            "children": [],
                                                                            "label": "self._validate_node_input_credentials"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 89,
                                                                            "end_token": 93,
                                                                            "children": [],
                                                                            "label": "(graph, user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "self._validate_node_input_credentials(graph, user_id)"
                                                                }
                                                            ],
                                                            "label": "self._validate_node_input_credentials(graph, user_id)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 96,
                                                            "end_token": 99,
                                                            "children": [],
                                                            "label": "nodes_input = []"
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 101,
                                                            "end_token": 318,
                                                            "children": [
                                                                {
                                                                    "type": "in",
                                                                    "start_token": 103,
                                                                    "end_token": 106,
                                                                    "children": [],
                                                                    "label": "in graph.starting_nodes"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 109,
                                                                    "end_token": 318,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 109,
                                                                            "end_token": 112,
                                                                            "children": [],
                                                                            "label": "input_data = {}"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 115,
                                                                            "end_token": 121,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 116,
                                                                                    "end_token": 121,
                                                                                    "children": [],
                                                                                    "label": "get_block(node.block_id)"
                                                                                }
                                                                            ],
                                                                            "label": "= get_block(node.block_id)"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 136,
                                                                            "end_token": 150,
                                                                            "children": [
                                                                                {
                                                                                    "type": "or",
                                                                                    "start_token": 137,
                                                                                    "end_token": 139,
                                                                                    "children": [],
                                                                                    "label": "not block or"
                                                                                },
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 142,
                                                                                    "end_token": 147,
                                                                                    "children": [],
                                                                                    "label": "block_type == BlockType.NOTE"
                                                                                }
                                                                            ],
                                                                            "label": "if not block or block.block_type == BlockType.NOTE:\n                continue"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 168,
                                                                            "end_token": 207,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 171,
                                                                                    "end_token": 176,
                                                                                    "children": [],
                                                                                    "label": "block_type == BlockType.INPUT"
                                                                                },
                                                                                {
                                                                                    "type": "if_statement",
                                                                                    "start_token": 190,
                                                                                    "end_token": 196,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "start_token": 191,
                                                                                            "end_token": 193,
                                                                                            "children": [],
                                                                                            "label": "name and name"
                                                                                        },
                                                                                        {
                                                                                            "type": "in",
                                                                                            "start_token": 194,
                                                                                            "end_token": 195,
                                                                                            "children": [],
                                                                                            "label": "in data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "if name and name in data:"
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "start_token": 198,
                                                                                    "end_token": 207,
                                                                                    "children": [],
                                                                                    "label": "input_data = {\"value\": data[name]}"
                                                                                }
                                                                            ],
                                                                            "label": "if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 228,
                                                                            "end_token": 266,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 231,
                                                                                    "end_token": 243,
                                                                                    "children": [],
                                                                                    "label": "block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)"
                                                                                },
                                                                                {
                                                                                    "type": "and",
                                                                                    "start_token": 245,
                                                                                    "end_token": 248,
                                                                                    "children": [],
                                                                                    "label": "and node.webhook_id"
                                                                                },
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "start_token": 255,
                                                                                    "end_token": 256,
                                                                                    "children": [],
                                                                                    "label": "not in"
                                                                                },
                                                                                {
                                                                                    "type": "raise_statement",
                                                                                    "start_token": 260,
                                                                                    "end_token": 266,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 265,
                                                                                            "end_token": 265,
                                                                                            "children": [],
                                                                                            "label": "\"Node {block.name} #{node.id} webhook payload is missing\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n"
                                                                                }
                                                                            ],
                                                                            "label": "if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 269,
                                                                            "end_token": 278,
                                                                            "children": [],
                                                                            "label": "input_data = {\"payload\": data[webhook_payload_key]}"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 281,
                                                                            "end_token": 290,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 285,
                                                                                    "end_token": 290,
                                                                                    "children": [],
                                                                                    "label": "validate_exec(node, input_data)"
                                                                                }
                                                                            ],
                                                                            "label": "input_data, error = validate_exec(node, input_data)"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 292,
                                                                            "end_token": 302,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 294,
                                                                                    "end_token": 295,
                                                                                    "children": [],
                                                                                    "label": "is None"
                                                                                },
                                                                                {
                                                                                    "type": "else_clause",
                                                                                    "start_token": 304,
                                                                                    "end_token": 318,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 307,
                                                                                            "end_token": 316,
                                                                                            "children": [],
                                                                                            "label": "nodes_input.append((node.id, input_data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "else:\n                nodes_input.append((node.id, input_data))"
                                                                                }
                                                                            ],
                                                                            "label": "if input_data is None:\n                raise ValueError(error)"
                                                                        }
                                                                    ],
                                                                    "label": "input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))"
                                                                }
                                                            ],
                                                            "label": "for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 321,
                                                            "end_token": 354,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 325,
                                                                    "end_token": 354,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 325,
                                                                            "end_token": 329,
                                                                            "children": [],
                                                                            "label": "self.db_client.create_graph_execution"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 330,
                                                                            "end_token": 354,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 333,
                                                                                    "end_token": 334,
                                                                                    "children": [],
                                                                                    "label": "=graph_id"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 338,
                                                                                    "end_token": 342,
                                                                                    "children": [],
                                                                                    "label": "=graph.version,"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 345,
                                                                                    "end_token": 346,
                                                                                    "children": [],
                                                                                    "label": "=nodes_input"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 350,
                                                                                    "end_token": 351,
                                                                                    "children": [],
                                                                                    "label": "=user_id"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )"
                                                                }
                                                            ],
                                                            "label": "graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 357,
                                                            "end_token": 360,
                                                            "children": [],
                                                            "label": "starting_node_execs = []"
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 362,
                                                            "end_token": 487,
                                                            "children": [
                                                                {
                                                                    "type": "in",
                                                                    "start_token": 364,
                                                                    "end_token": 365,
                                                                    "children": [],
                                                                    "label": "in node_execs"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 368,
                                                                    "end_token": 487,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 369,
                                                                            "end_token": 370,
                                                                            "children": [],
                                                                            "label": ".append"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 371,
                                                                            "end_token": 417,
                                                                            "children": [
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 374,
                                                                                    "end_token": 416,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 377,
                                                                                            "end_token": 379,
                                                                                            "children": [],
                                                                                            "label": "=user_id,"
                                                                                        },
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 381,
                                                                                            "end_token": 386,
                                                                                            "children": [],
                                                                                            "label": "graph_exec_id=node_exec.graph_exec_id,"
                                                                                        },
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 388,
                                                                                            "end_token": 392,
                                                                                            "children": [],
                                                                                            "label": "graph_id=node_exec.graph_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 395,
                                                                                            "end_token": 399,
                                                                                            "children": [],
                                                                                            "label": "node_exec_id=node_exec.node_exec_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 403,
                                                                                            "end_token": 406,
                                                                                            "children": [],
                                                                                            "label": "=node_exec.node_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 409,
                                                                                            "end_token": 413,
                                                                                            "children": [],
                                                                                            "label": "data=node_exec.input_data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 420,
                                                                            "end_token": 441,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 422,
                                                                                    "end_token": 441,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 427,
                                                                                            "end_token": 440,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "start_token": 430,
                                                                                                    "end_token": 431,
                                                                                                    "children": [],
                                                                                                    "label": ".node_exec_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "start_token": 434,
                                                                                                    "end_token": 435,
                                                                                                    "children": [],
                                                                                                    "label": ".QUEUED"
                                                                                                },
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "start_token": 437,
                                                                                                    "end_token": 439,
                                                                                                    "children": [],
                                                                                                    "label": "node_exec.input_data"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )"
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 443,
                                                                            "end_token": 450,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 443,
                                                                                    "end_token": 449,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 443,
                                                                                            "end_token": 447,
                                                                                            "children": [],
                                                                                            "label": "self.db_client.send_execution_update"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 448,
                                                                                            "end_token": 449,
                                                                                            "children": [],
                                                                                            "label": "(exec_update"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.db_client.send_execution_update(exec_update"
                                                                                }
                                                                            ],
                                                                            "label": "self.db_client.send_execution_update(exec_update)"
                                                                        }
                                                                    ],
                                                                    "label": "starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)"
                                                                }
                                                            ],
                                                            "label": "for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 453,
                                                            "end_token": 478,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 455,
                                                                    "end_token": 478,
                                                                    "children": [
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 456,
                                                                            "end_token": 477,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 459,
                                                                                    "end_token": 461,
                                                                                    "children": [],
                                                                                    "label": "=user_id,"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 463,
                                                                                    "end_token": 465,
                                                                                    "children": [],
                                                                                    "label": "graph_id=graph_id"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 468,
                                                                                    "end_token": 470,
                                                                                    "children": [],
                                                                                    "label": "graph_exec_id=graph_exec_id"
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "start_token": 474,
                                                                                    "end_token": 475,
                                                                                    "children": [],
                                                                                    "label": "=starting_node_execs"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n"
                                                                        }
                                                                    ],
                                                                    "label": "GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )"
                                                                }
                                                            ],
                                                            "label": "graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 480,
                                                            "end_token": 487,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 480,
                                                                    "end_token": 486,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 480,
                                                                            "end_token": 484,
                                                                            "children": [],
                                                                            "label": "self.queue.add"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 485,
                                                                            "end_token": 486,
                                                                            "children": [],
                                                                            "label": "(graph_exec"
                                                                        }
                                                                    ],
                                                                    "label": "self.queue.add(graph_exec"
                                                                }
                                                            ],
                                                            "label": "self.queue.add(graph_exec)"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 490,
                                                            "end_token": 491,
                                                            "children": [],
                                                            "label": "return graph_exec"
                                                        }
                                                    ],
                                                    "label": ":\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return"
                                                }
                                            ],
                                            "label": "def add_execution(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    ) -> GraphExecutionEntry:\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec\n"
                                        }
                                    ],
                                    "label": "def add_execution(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    ) -> GraphExecutionEntry:\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "cancel_execution",
                            "start_line": 851,
                            "end_line": 885,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 168,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 168,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "cancel_execution"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": "graph_exec_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, graph_exec_id: str)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 13,
                                                    "end_token": 168,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 14,
                                                            "end_token": 18,
                                                            "children": [],
                                                            "label": "\"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\""
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 20,
                                                            "end_token": 38,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": 21,
                                                                    "end_token": 26,
                                                                    "children": [],
                                                                    "label": "graph_exec_id not in self.active_graph_runs"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 28,
                                                                    "end_token": 38,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 29,
                                                                            "end_token": 38,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 30,
                                                                                    "end_token": 38,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 30,
                                                                                            "end_token": 30,
                                                                                            "children": [],
                                                                                            "label": "Exception"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 31,
                                                                                            "end_token": 38,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "start_token": 33,
                                                                                                    "end_token": 36,
                                                                                                    "children": [],
                                                                                                    "label": "f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )"
                                                                                        }
                                                                                    ],
                                                                                    "label": "Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )"
                                                                        }
                                                                    ],
                                                                    "label": "\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )"
                                                                }
                                                            ],
                                                            "label": "if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 41,
                                                            "end_token": 50,
                                                            "children": [
                                                                {
                                                                    "type": "tuple",
                                                                    "start_token": 41,
                                                                    "end_token": 43,
                                                                    "children": [],
                                                                    "label": "future, cancel_event"
                                                                },
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 45,
                                                                    "end_token": 50,
                                                                    "children": [],
                                                                    "label": "self.active_graph_runs[graph_exec_id]"
                                                                }
                                                            ],
                                                            "label": "future, cancel_event = self.active_graph_runs[graph_exec_id]"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 52,
                                                            "end_token": 60,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 53,
                                                                    "end_token": 57,
                                                                    "children": [],
                                                                    "label": "cancel_event.is_set()"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 58,
                                                                    "end_token": 60,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 60,
                                                                            "end_token": 60,
                                                                            "children": [],
                                                                            "label": "return"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            return"
                                                                }
                                                            ],
                                                            "label": "if cancel_event.is_set():\n            return"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 63,
                                                            "end_token": 67,
                                                            "children": [],
                                                            "label": "cancel_event.set()"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 69,
                                                            "end_token": 73,
                                                            "children": [],
                                                            "label": "future.result()"
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "start_token": 76,
                                                            "end_token": 84,
                                                            "children": [],
                                                            "label": "# Update the status of the unfinished node executions"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 86,
                                                            "end_token": 95,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 86,
                                                                    "end_token": 86,
                                                                    "children": [],
                                                                    "label": "node_execs"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 88,
                                                                    "end_token": 95,
                                                                    "children": [],
                                                                    "label": "self.db_client.get_execution_results(graph_exec_id)"
                                                                }
                                                            ],
                                                            "label": "node_execs = self.db_client.get_execution_results(graph_exec_id)"
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 97,
                                                            "end_token": 167,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 98,
                                                                    "end_token": 98,
                                                                    "children": [],
                                                                    "label": "node_exec"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 100,
                                                                    "end_token": 100,
                                                                    "children": [],
                                                                    "label": "node_execs"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 102,
                                                                    "end_token": 167,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 103,
                                                                            "end_token": 122,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "start_token": 107,
                                                                                    "end_token": 109,
                                                                                    "children": [],
                                                                                    "label": "not in ("
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 123,
                                                                                    "end_token": 139,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 124,
                                                                                            "end_token": 139,
                                                                                            "children": [],
                                                                                            "label": "self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 141,
                                                                            "end_token": 158,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 141,
                                                                                    "end_token": 141,
                                                                                    "children": [],
                                                                                    "label": "exec_update"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 143,
                                                                                    "end_token": 157,
                                                                                    "children": [],
                                                                                    "label": "self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n"
                                                                                }
                                                                            ],
                                                                            "label": "exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 160,
                                                                            "end_token": 167,
                                                                            "children": [],
                                                                            "label": "self.db_client.send_execution_update(exec_update)"
                                                                        }
                                                                    ],
                                                                    "label": "\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)"
                                                                }
                                                            ],
                                                            "label": "for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)"
                                                        }
                                                    ],
                                                    "label": "\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)\n"
                                                }
                                            ],
                                            "label": "def cancel_execution(self, graph_exec_id: str) -> None:\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)\n"
                                        }
                                    ],
                                    "label": "def cancel_execution(self, graph_exec_id: str) -> None:\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "_validate_node_input_credentials",
                            "start_line": 887,
                            "end_line": 930,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 244,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 244,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "_validate_node_input_credentials"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 13,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 5,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "dotted_name",
                                                                    "start_token": 6,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": ": GraphModel"
                                                                }
                                                            ],
                                                            "label": "graph: GraphModel"
                                                        },
                                                        {
                                                            "type": "typed_parameter",
                                                            "start_token": 9,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "user_id: str"
                                                        }
                                                    ],
                                                    "label": "(self, graph: GraphModel, user_id: str):"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 15,
                                                    "end_token": 17,
                                                    "children": [
                                                        {
                                                            "type": "string_content",
                                                            "start_token": 16,
                                                            "end_token": 16,
                                                            "children": [],
                                                            "label": "\"Checks all credentials for all nodes of the graph\""
                                                        }
                                                    ],
                                                    "label": "\"\"\"Checks all credentials for all nodes of the graph\"\"\""
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 20,
                                                    "end_token": 244,
                                                    "children": [
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 20,
                                                            "end_token": 81,
                                                            "children": [
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "start_token": 20,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "children": [],
                                                                            "label": "node"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 22,
                                                                            "end_token": 25,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "children": [],
                                                                                    "label": "graph"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "children": [],
                                                                                    "label": "nodes"
                                                                                }
                                                                            ],
                                                                            "label": "in graph.nodes"
                                                                        }
                                                                    ],
                                                                    "label": "for node in graph.nodes:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 28,
                                                                    "end_token": 81,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 28,
                                                                            "end_token": 35,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [],
                                                                                    "label": "block"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 30,
                                                                                    "end_token": 35,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 30,
                                                                                            "end_token": 30,
                                                                                            "children": [],
                                                                                            "label": "get_block"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 31,
                                                                                            "end_token": 35,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 32,
                                                                                                    "end_token": 34,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 32,
                                                                                                            "end_token": 32,
                                                                                                            "children": [],
                                                                                                            "label": "node"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 34,
                                                                                                            "end_token": 34,
                                                                                                            "children": [],
                                                                                                            "label": "block_id"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "node.block_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(node.block_id)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "get_block(node.block_id)"
                                                                                }
                                                                            ],
                                                                            "label": "block = get_block(node.block_id)"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 37,
                                                                            "end_token": 47,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "start_token": 38,
                                                                                    "end_token": 39,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 39,
                                                                                            "end_token": 39,
                                                                                            "children": [],
                                                                                            "label": "block"
                                                                                        }
                                                                                    ],
                                                                                    "label": "not block"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 42,
                                                                                    "end_token": 47,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "start_token": 42,
                                                                                            "end_token": 47,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 43,
                                                                                                    "end_token": 47,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 43,
                                                                                                            "end_token": 43,
                                                                                                            "children": [],
                                                                                                            "label": "ValueError"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 44,
                                                                                                            "end_token": 47,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "f_string",
                                                                                                                    "start_token": 45,
                                                                                                                    "end_token": 46,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "concatenated_string",
                                                                                                                            "start_token": 46,
                                                                                                                            "end_token": 46,
                                                                                                                            "children": [],
                                                                                                                            "label": "\"Unknown block {node.block_id} for node #{node.id}\""
                                                                                                                        }
                                                                                                                    ],
                                                                                                                    "label": "f\"Unknown block {node.block_id} for node #{node.id}\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "(f\"Unknown block {node.block_id} for node #{node.id}\")"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")"
                                                                                                }
                                                                                            ],
                                                                                            "label": "raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")"
                                                                                }
                                                                            ],
                                                                            "label": "if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 58,
                                                                            "end_token": 73,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 58,
                                                                                    "end_token": 58,
                                                                                    "children": [],
                                                                                    "label": "model_fields"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 60,
                                                                                    "end_token": 73,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "cast",
                                                                                            "start_token": 60,
                                                                                            "end_token": 70,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "generic_type",
                                                                                                    "start_token": 62,
                                                                                                    "end_token": 66,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "dotted_name",
                                                                                                            "start_token": 64,
                                                                                                            "end_token": 64,
                                                                                                            "children": [],
                                                                                                            "label": "BaseModel"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "type[BaseModel],"
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 67,
                                                                                                    "end_token": 70,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 68,
                                                                                                            "end_token": 68,
                                                                                                            "children": [],
                                                                                                            "label": "."
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 70,
                                                                                                            "end_token": 70,
                                                                                                            "children": [],
                                                                                                            "label": ")"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "block.input_schema)"
                                                                                                }
                                                                                            ],
                                                                                            "label": "cast(type[BaseModel], block.input_schema)"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 72,
                                                                                            "end_token": 72,
                                                                                            "children": [],
                                                                                            "label": "model_fields"
                                                                                        }
                                                                                    ],
                                                                                    "label": "cast(type[BaseModel], block.input_schema).model_fields\n"
                                                                                }
                                                                            ],
                                                                            "label": "model_fields = cast(type[BaseModel], block.input_schema).model_fields\n"
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 74,
                                                                            "end_token": 81,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "start_token": 76,
                                                                                    "end_token": 77,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 76,
                                                                                            "end_token": 78,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 76,
                                                                                                    "end_token": 76,
                                                                                                    "children": [],
                                                                                                    "label": "not"
                                                                                                }
                                                                                            ],
                                                                                            "label": "not in model_fields"
                                                                                        }
                                                                                    ],
                                                                                    "label": "not in"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 81,
                                                                                    "end_token": 81,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "continue_statement",
                                                                                            "start_token": 81,
                                                                                            "end_token": 81,
                                                                                            "children": [],
                                                                                            "label": "continue"
                                                                                        }
                                                                                    ],
                                                                                    "label": "continue"
                                                                                }
                                                                            ],
                                                                            "label": "if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue"
                                                                        }
                                                                    ],
                                                                    "label": "block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue"
                                                                }
                                                            ],
                                                            "label": "for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 84,
                                                            "end_token": 129,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 84,
                                                                    "end_token": 84,
                                                                    "children": [],
                                                                    "label": "field"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 86,
                                                                    "end_token": 129,
                                                                    "children": [
                                                                        {
                                                                            "type": "cast",
                                                                            "start_token": 86,
                                                                            "end_token": 130,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dotted_name",
                                                                                    "start_token": 125,
                                                                                    "end_token": 125,
                                                                                    "children": [],
                                                                                    "label": "CredentialsMetaInput"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 127,
                                                                                    "end_token": 129,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 127,
                                                                                            "end_token": 127,
                                                                                            "children": [],
                                                                                            "label": "field"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 129,
                                                                                            "end_token": 129,
                                                                                            "children": [],
                                                                                            "label": "annotation"
                                                                                        }
                                                                                    ],
                                                                                    "label": "field.annotation"
                                                                                }
                                                                            ],
                                                                            "label": "model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)"
                                                                        }
                                                                    ],
                                                                    "label": "model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation"
                                                                }
                                                            ],
                                                            "label": "field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 132,
                                                            "end_token": 145,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 132,
                                                                    "end_token": 132,
                                                                    "children": [],
                                                                    "label": "credentials_meta"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 134,
                                                                    "end_token": 145,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 134,
                                                                            "end_token": 136,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 134,
                                                                                    "end_token": 134,
                                                                                    "children": [],
                                                                                    "label": "credentials_meta_type"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 136,
                                                                                    "end_token": 136,
                                                                                    "children": [],
                                                                                    "label": "model_validate"
                                                                                }
                                                                            ],
                                                                            "label": "credentials_meta_type.model_validate"
                                                                        },
                                                                        {
                                                                            "type": "subscript",
                                                                            "start_token": 138,
                                                                            "end_token": 144,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 139,
                                                                                    "end_token": 143,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 139,
                                                                                            "end_token": 139,
                                                                                            "children": [],
                                                                                            "label": "node"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 143,
                                                                                            "end_token": 143,
                                                                                            "children": [],
                                                                                            "label": "CREDENTIALS_FIELD_NAME"
                                                                                        }
                                                                                    ],
                                                                                    "label": "node.input_default[CREDENTIALS_FIELD_NAME"
                                                                                }
                                                                            ],
                                                                            "label": "\n                node.input_default[CREDENTIALS_FIELD_NAME]"
                                                                        }
                                                                    ],
                                                                    "label": "credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n"
                                                                }
                                                            ],
                                                            "label": "credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 158,
                                                            "end_token": 173,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 158,
                                                                    "end_token": 158,
                                                                    "children": [],
                                                                    "label": "credentials"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 160,
                                                                    "end_token": 173,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 160,
                                                                            "end_token": 164,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 160,
                                                                                    "end_token": 162,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 160,
                                                                                            "end_token": 160,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 162,
                                                                                            "end_token": 162,
                                                                                            "children": [],
                                                                                            "label": "credentials_store"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.credentials_store"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 164,
                                                                                    "end_token": 164,
                                                                                    "children": [],
                                                                                    "label": "get_creds_by_id"
                                                                                }
                                                                            ],
                                                                            "label": "self.credentials_store.get_creds_by_id"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 165,
                                                                            "end_token": 173,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 167,
                                                                                    "end_token": 167,
                                                                                    "children": [],
                                                                                    "label": "user_id"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 169,
                                                                                    "end_token": 171,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 169,
                                                                                            "end_token": 169,
                                                                                            "children": [],
                                                                                            "label": "credentials_meta"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 171,
                                                                                            "end_token": 171,
                                                                                            "children": [],
                                                                                            "label": "id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "credentials_meta.id"
                                                                                }
                                                                            ],
                                                                            "label": "(\n                user_id, credentials_meta.id\n            )"
                                                                        }
                                                                    ],
                                                                    "label": "self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )"
                                                                }
                                                            ],
                                                            "label": "credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 175,
                                                            "end_token": 190,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 176,
                                                                    "end_token": 177,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 177,
                                                                            "end_token": 177,
                                                                            "children": [],
                                                                            "label": "credentials"
                                                                        }
                                                                    ],
                                                                    "label": "not credentials"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 180,
                                                                    "end_token": 190,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 180,
                                                                            "end_token": 190,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "start_token": 184,
                                                                                    "end_token": 188,
                                                                                    "children": [],
                                                                                    "label": "f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\""
                                                                                }
                                                                            ],
                                                                            "label": "raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )"
                                                                        }
                                                                    ],
                                                                    "label": "raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )"
                                                                }
                                                            ],
                                                            "label": "if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 192,
                                                            "end_token": 244,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": 194,
                                                                    "end_token": 213,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 195,
                                                                            "end_token": 197,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 195,
                                                                                    "end_token": 195,
                                                                                    "children": [],
                                                                                    "label": "credentials"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 197,
                                                                                    "end_token": 197,
                                                                                    "children": [],
                                                                                    "label": "provider"
                                                                                }
                                                                            ],
                                                                            "label": "credentials.provider"
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 200,
                                                                            "end_token": 202,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 200,
                                                                                    "end_token": 200,
                                                                                    "children": [],
                                                                                    "label": "credentials_meta"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 202,
                                                                                    "end_token": 202,
                                                                                    "children": [],
                                                                                    "label": "provider"
                                                                                }
                                                                            ],
                                                                            "label": "credentials_meta.provider"
                                                                        },
                                                                        {
                                                                            "type": "binary_operator",
                                                                            "start_token": 204,
                                                                            "end_token": 213,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 205,
                                                                                    "end_token": 207,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 205,
                                                                                            "end_token": 205,
                                                                                            "children": [],
                                                                                            "label": "credentials"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 207,
                                                                                            "end_token": 207,
                                                                                            "children": [],
                                                                                            "label": "type"
                                                                                        }
                                                                                    ],
                                                                                    "label": "credentials.type"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 210,
                                                                                    "end_token": 212,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 210,
                                                                                            "end_token": 210,
                                                                                            "children": [],
                                                                                            "label": "credentials_meta"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 212,
                                                                                            "end_token": 212,
                                                                                            "children": [],
                                                                                            "label": "type"
                                                                                        }
                                                                                    ],
                                                                                    "label": "credentials_meta.type"
                                                                                }
                                                                            ],
                                                                            "label": "or credentials.type != credentials_meta.type\n"
                                                                        }
                                                                    ],
                                                                    "label": "\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 217,
                                                                    "end_token": 244,
                                                                    "children": [
                                                                        {
                                                                            "type": "logger",
                                                                            "start_token": 217,
                                                                            "end_token": 233,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 217,
                                                                                    "end_token": 219,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 217,
                                                                                            "end_token": 217,
                                                                                            "children": [],
                                                                                            "label": "logger"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 219,
                                                                                            "end_token": 219,
                                                                                            "children": [],
                                                                                            "label": "warning"
                                                                                        }
                                                                                    ],
                                                                                    "label": "logger.warning"
                                                                                },
                                                                                {
                                                                                    "type": "function_definition",
                                                                                    "start_token": 220,
                                                                                    "end_token": 233,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "start_token": 222,
                                                                                            "end_token": 231,
                                                                                            "children": [],
                                                                                            "label": "f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )"
                                                                        },
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 235,
                                                                            "end_token": 244,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 235,
                                                                                    "end_token": 244,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 235,
                                                                                            "end_token": 235,
                                                                                            "children": [],
                                                                                            "label": "raise"
                                                                                        },
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "start_token": 239,
                                                                                            "end_token": 242,
                                                                                            "children": [],
                                                                                            "label": "f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )"
                                                                                }
                                                                            ],
                                                                            "label": "raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )"
                                                                        }
                                                                    ],
                                                                    "label": "logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )"
                                                                }
                                                            ],
                                                            "label": "if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )"
                                                        }
                                                    ],
                                                    "label": "for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )"
                                                }
                                            ],
                                            "label": "def _validate_node_input_credentials(self, graph: GraphModel, user_id: str):\n        \"\"\"Checks all credentials for all nodes of the graph\"\"\"\n\n        for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )"
                                        }
                                    ],
                                    "label": "def _validate_node_input_credentials(self, graph: GraphModel, user_id: str):\n        \"\"\"Checks all credentials for all nodes of the graph\"\"\"\n\n        for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )"
                                }
                            ]
                        }
                    ],
                    "label": "class ExecutionManager(AppService):\n\n    @classmethod\n\n\n    @property\n\n    @expose\n\n    @expose\n\n"
                }
            ]
        }
    ],
    "label": "import atexit\nimport logging\nimport multiprocessing\nimport os\nimport signal\nimport sys\nimport threading\nfrom concurrent.futures import Future, ProcessPoolExecutor\nfrom contextlib import contextmanager\nfrom multiprocessing.pool import AsyncResult, Pool\nfrom typing import TYPE_CHECKING, Any, Generator, TypeVar, cast\n\nfrom pydantic import BaseModel\nfrom redis.lock import Lock as RedisLock\n\nif TYPE_CHECKING:\n    from backend.executor import DatabaseManager\n\nfrom autogpt_libs.utils.cache import thread_cached\n\nfrom backend.blocks.agent import AgentExecutorBlock\nfrom backend.data import redis\nfrom backend.data.block import Block, BlockData, BlockInput, BlockType, get_block\nfrom backend.data.execution import (\n    ExecutionQueue,\n    ExecutionResult,\n    ExecutionStatus,\n    GraphExecutionEntry,\n    NodeExecutionEntry,\n    merge_execution_input,\n    parse_execution_output,\n)\nfrom backend.data.graph import GraphModel, Link, Node\nfrom backend.data.model import CREDENTIALS_FIELD_NAME, CredentialsMetaInput\nfrom backend.integrations.creds_manager import IntegrationCredentialsManager\nfrom backend.util import json\nfrom backend.util.decorator import error_logged, time_measured\nfrom backend.util.logging import configure_logging\nfrom backend.util.process import set_service_name\nfrom backend.util.service import (\n    AppService,\n    close_service_client,\n    expose,\n    get_service_client,\n)\nfrom backend.util.settings import Settings\nfrom backend.util.type import convert\n\nlogger = logging.getLogger(__name__)\nsettings = Settings()\n\n\n\n\nT = TypeVar(\"T\")\nExecutionStream = Generator[NodeExecutionEntry, None, None]\n\n\n\n\n\n\n\n\n\n\n\n# ------- UTILITIES ------- #\n\n\n@thread_cached\n\n\n@contextmanager\n\n\n"
}
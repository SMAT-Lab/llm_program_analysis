{
    "type": "module",
    "start_token": 0,
    "end_token": 96,
    "children": [
        {
            "type": "import_statement",
            "start_token": 0,
            "end_token": 1,
            "children": [],
            "label": "import logging"
        },
        {
            "type": "import_statement",
            "start_token": 3,
            "end_token": 4,
            "children": [],
            "label": "import time"
        },
        {
            "type": "import_from_statement",
            "start_token": 6,
            "end_token": 9,
            "children": [],
            "label": "from typing import Sequence"
        },
        {
            "type": "relative_import",
            "start_token": 12,
            "end_token": 17,
            "children": [],
            "label": "from backend.data import db"
        },
        {
            "type": "relative_import",
            "start_token": 19,
            "end_token": 29,
            "children": [],
            "label": "from backend.data.block import Block, initialize_blocks\n"
        },
        {
            "type": "relative_import",
            "start_token": 30,
            "end_token": 39,
            "children": [],
            "label": "from backend.data.execution import ExecutionResult, ExecutionStatus"
        },
        {
            "type": "relative_import",
            "start_token": 41,
            "end_token": 48,
            "children": [],
            "label": "from backend.data.model import CREDENTIALS_FIELD_NAME"
        },
        {
            "type": "relative_import",
            "start_token": 50,
            "end_token": 57,
            "children": [],
            "label": "from backend.data.user import create_default_user"
        },
        {
            "type": "relative_import",
            "start_token": 59,
            "end_token": 68,
            "children": [],
            "label": "from backend.executor import DatabaseManager, ExecutionManager, ExecutionScheduler"
        },
        {
            "type": "relative_import",
            "start_token": 70,
            "end_token": 77,
            "children": [],
            "label": "from backend.server.rest_api import AgentServer"
        },
        {
            "type": "relative_import",
            "start_token": 79,
            "end_token": 86,
            "children": [],
            "label": "from backend.server.utils import get_user_id"
        },
        {
            "type": "assignment",
            "start_token": 89,
            "end_token": 96,
            "children": [
                {
                    "type": "identifier",
                    "start_token": 89,
                    "end_token": 89,
                    "label": "log"
                },
                {
                    "type": "attribute",
                    "start_token": 91,
                    "end_token": 95,
                    "children": [
                        {
                            "type": "identifier",
                            "start_token": 91,
                            "end_token": 91,
                            "label": "logging"
                        },
                        {
                            "type": "identifier",
                            "start_token": 93,
                            "end_token": 93,
                            "label": "getLogger"
                        },
                        {
                            "type": "call",
                            "start_token": 94,
                            "end_token": 95,
                            "children": [
                                {
                                    "type": "argument_list",
                                    "start_token": 95,
                                    "end_token": 95,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 95,
                                            "end_token": 95,
                                            "label": "__name__"
                                        }
                                    ],
                                    "label": "__name__"
                                }
                            ],
                            "label": "(__name__"
                        }
                    ],
                    "label": "logging.getLogger(__name__"
                }
            ],
            "label": "log = logging.getLogger(__name__)"
        },
        {
            "type": "function_placeholder",
            "name": "wait_execution",
            "start_line": 56,
            "end_line": 78,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 89,
                    "children": [
                        {
                            "type": "decorated_definition",
                            "start_token": 0,
                            "end_token": 89,
                            "children": [
                                {
                                    "type": "function_definition",
                                    "start_token": 0,
                                    "end_token": 28,
                                    "children": [
                                        {
                                            "type": "await",
                                            "start_token": 0,
                                            "end_token": 0,
                                            "children": [],
                                            "label": "async"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 1,
                                            "end_token": 1,
                                            "children": [],
                                            "label": "def"
                                        },
                                        {
                                            "type": "identifier",
                                            "start_token": 2,
                                            "end_token": 2,
                                            "children": [],
                                            "label": "wait_execution"
                                        },
                                        {
                                            "type": "parameters",
                                            "start_token": 3,
                                            "end_token": 27,
                                            "children": [
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 5,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 5,
                                                            "end_token": 5,
                                                            "children": [],
                                                            "label": "user_id"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 6,
                                                            "end_token": 7,
                                                            "children": [],
                                                            "label": ": str"
                                                        }
                                                    ],
                                                    "label": "user_id: str,"
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 10,
                                                    "end_token": 13,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 10,
                                                            "end_token": 10,
                                                            "children": [],
                                                            "label": "graph_id"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 11,
                                                            "end_token": 12,
                                                            "children": [],
                                                            "label": ": str"
                                                        }
                                                    ],
                                                    "label": "graph_id: str,"
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 15,
                                                    "end_token": 18,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 15,
                                                            "end_token": 15,
                                                            "children": [],
                                                            "label": "graph_exec_id"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 16,
                                                            "end_token": 17,
                                                            "children": [],
                                                            "label": ": str"
                                                        }
                                                    ],
                                                    "label": "graph_exec_id: str,"
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "start_token": 20,
                                                    "end_token": 24,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 20,
                                                            "end_token": 20,
                                                            "children": [],
                                                            "label": "timeout"
                                                        },
                                                        {
                                                            "type": "type",
                                                            "start_token": 21,
                                                            "end_token": 22,
                                                            "children": [],
                                                            "label": ": int"
                                                        },
                                                        {
                                                            "type": "integer",
                                                            "start_token": 23,
                                                            "end_token": 24,
                                                            "children": [],
                                                            "label": "= 20"
                                                        }
                                                    ],
                                                    "label": "timeout: int = 20"
                                                }
                                            ],
                                            "label": "(\n    user_id: str,\n    graph_id: str,\n    graph_exec_id: str,\n    timeout: int = 20,\n)"
                                        },
                                        {
                                            "type": "generic_type",
                                            "start_token": 28,
                                            "end_token": 34,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 30,
                                                    "end_token": 30,
                                                    "children": [],
                                                    "label": "Sequence"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 32,
                                                    "end_token": 32,
                                                    "children": [],
                                                    "label": "ExecutionResult"
                                                }
                                            ],
                                            "label": "-> Sequence[ExecutionResult]:"
                                        }
                                    ],
                                    "label": "async def wait_execution(\n    user_id: str,\n    graph_id: str,\n    graph_exec_id: str,\n    timeout: int = 20,\n) -"
                                },
                                {
                                    "type": "block",
                                    "start_token": 35,
                                    "end_token": 89,
                                    "children": [
                                        {
                                            "type": "comment",
                                            "start_token": 37,
                                            "end_token": 43,
                                            "children": [],
                                            "label": "# Wait for the executions to complete"
                                        },
                                        {
                                            "type": "for_statement",
                                            "start_token": 45,
                                            "end_token": 84,
                                            "children": [
                                                {
                                                    "type": "for_in_clause",
                                                    "start_token": 45,
                                                    "end_token": 51,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 46,
                                                            "end_token": 46,
                                                            "children": [],
                                                            "label": "i"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 48,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 48,
                                                                    "end_token": 48,
                                                                    "children": [],
                                                                    "label": "range"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 49,
                                                                    "end_token": 50,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 50,
                                                                            "end_token": 50,
                                                                            "children": [],
                                                                            "label": "timeout"
                                                                        }
                                                                    ],
                                                                    "label": "(timeout"
                                                                }
                                                            ],
                                                            "label": "range(timeout)"
                                                        }
                                                    ],
                                                    "label": "for i in range(timeout)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 52,
                                                    "end_token": 84,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 54,
                                                            "end_token": 76,
                                                            "children": [
                                                                {
                                                                    "type": "await",
                                                                    "start_token": 55,
                                                                    "end_token": 55,
                                                                    "children": [],
                                                                    "label": "await"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 56,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 56,
                                                                            "end_token": 56,
                                                                            "children": [],
                                                                            "label": "is_execution_completed"
                                                                        }
                                                                    ],
                                                                    "label": "is_execution_completed()"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 59,
                                                                    "end_token": 76,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "start_token": 61,
                                                                            "end_token": 76,
                                                                            "children": [
                                                                                {
                                                                                    "type": "await",
                                                                                    "start_token": 62,
                                                                                    "end_token": 62,
                                                                                    "children": [],
                                                                                    "label": "await"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 63,
                                                                                    "end_token": 76,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 63,
                                                                                            "end_token": 66,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 63,
                                                                                                    "end_token": 65,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 63,
                                                                                                            "end_token": 63,
                                                                                                            "children": [],
                                                                                                            "label": "AgentServer"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "AgentServer()"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 66,
                                                                                                    "end_token": 66,
                                                                                                    "children": [],
                                                                                                    "label": "."
                                                                                                }
                                                                                            ],
                                                                                            "label": "AgentServer()."
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 68,
                                                                                            "end_token": 76,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 70,
                                                                                                    "end_token": 70,
                                                                                                    "children": [],
                                                                                                    "label": "graph_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 72,
                                                                                                    "end_token": 72,
                                                                                                    "children": [],
                                                                                                    "label": "graph_exec_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 74,
                                                                                                    "end_token": 74,
                                                                                                    "children": [],
                                                                                                    "label": "user_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                graph_id, graph_exec_id, user_id\n            )"
                                                                                        }
                                                                                    ],
                                                                                    "label": "AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )"
                                                                                }
                                                                            ],
                                                                            "label": "return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )"
                                                                }
                                                            ],
                                                            "label": "if await is_execution_completed():\n            return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 78,
                                                            "end_token": 83,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 78,
                                                                    "end_token": 83,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 78,
                                                                            "end_token": 80,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 78,
                                                                                    "end_token": 78,
                                                                                    "children": [],
                                                                                    "label": "time"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 80,
                                                                                    "end_token": 80,
                                                                                    "children": [],
                                                                                    "label": "sleep"
                                                                                }
                                                                            ],
                                                                            "label": "time.sleep"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 81,
                                                                            "end_token": 82,
                                                                            "children": [
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 82,
                                                                                    "end_token": 82,
                                                                                    "children": [],
                                                                                    "label": "1"
                                                                                }
                                                                            ],
                                                                            "label": "(1"
                                                                        }
                                                                    ],
                                                                    "label": "time.sleep(1)"
                                                                }
                                                            ],
                                                            "label": "time.sleep(1)"
                                                        }
                                                    ],
                                                    "label": ":\n        if await is_execution_completed():\n            return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )\n        time.sleep(1)\n"
                                                }
                                            ],
                                            "label": "for i in range(timeout):\n        if await is_execution_completed():\n            return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )\n        time.sleep(1)\n"
                                        },
                                        {
                                            "type": "assert_statement",
                                            "start_token": 86,
                                            "end_token": 89,
                                            "children": [
                                                {
                                                    "type": "false",
                                                    "start_token": 87,
                                                    "end_token": 87,
                                                    "children": [],
                                                    "label": "False"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 89,
                                                    "end_token": 89,
                                                    "children": [],
                                                    "label": "\"Execution did not complete in time.\""
                                                }
                                            ],
                                            "label": "assert False, \"Execution did not complete in time.\""
                                        }
                                    ],
                                    "label": "\n\n    # Wait for the executions to complete\n    for i in range(timeout):\n        if await is_execution_completed():\n            return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )\n        time.sleep(1)\n\n    assert False, \"Execution did not complete in time.\""
                                }
                            ],
                            "label": "async def wait_execution(\n    user_id: str,\n    graph_id: str,\n    graph_exec_id: str,\n    timeout: int = 20,\n) -> Sequence[ExecutionResult]:\n\n    # Wait for the executions to complete\n    for i in range(timeout):\n        if await is_execution_completed():\n            return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )\n        time.sleep(1)\n\n    assert False, \"Execution did not complete in time.\""
                        },
                        {
                            "type": "function_placeholder",
                            "name": "is_execution_completed",
                            "start_line": 62,
                            "end_line": 68,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 58,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 52,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 2,
                                                    "label": "def is_execution_completed"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 4,
                                                    "label": "()"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 5,
                                                    "end_token": 52,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 7,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "label": "status"
                                                                },
                                                                {
                                                                    "type": "await",
                                                                    "start_token": 9,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 10,
                                                                            "end_token": 19,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 10,
                                                                                    "end_token": 14,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 10,
                                                                                            "end_token": 10,
                                                                                            "label": "AgentServer"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 14,
                                                                                            "end_token": 14,
                                                                                            "label": "test_get_graph_run_status"
                                                                                        }
                                                                                    ],
                                                                                    "label": "AgentServer().test_get_graph_run_status"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 15,
                                                                                    "end_token": 19,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 16,
                                                                                            "end_token": 16,
                                                                                            "label": "graph_exec_id"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 18,
                                                                                            "end_token": 18,
                                                                                            "label": "user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(graph_exec_id, user_id)"
                                                                                }
                                                                            ],
                                                                            "label": "AgentServer().test_get_graph_run_status(graph_exec_id, user_id)"
                                                                        }
                                                                    ],
                                                                    "label": "await AgentServer().test_get_graph_run_status(graph_exec_id, user_id)"
                                                                }
                                                            ],
                                                            "label": "status = await AgentServer().test_get_graph_run_status(graph_exec_id, user_id)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 21,
                                                            "end_token": 27,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 21,
                                                                    "end_token": 27,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 21,
                                                                            "end_token": 23,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 21,
                                                                                    "end_token": 21,
                                                                                    "label": "log"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "label": "info"
                                                                                }
                                                                            ],
                                                                            "label": "log.info"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 24,
                                                                            "end_token": 27,
                                                                            "children": [
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "start_token": 25,
                                                                                    "end_token": 26,
                                                                                    "label": "f\"Execution status: {status}\""
                                                                                }
                                                                            ],
                                                                            "label": "(f\"Execution status: {status}\")"
                                                                        }
                                                                    ],
                                                                    "label": "log.info(f\"Execution status: {status}\")"
                                                                }
                                                            ],
                                                            "label": "log.info(f\"Execution status: {status}\")"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 29,
                                                            "end_token": 49,
                                                            "children": [
                                                                {
                                                                    "type": "if_clause",
                                                                    "start_token": 29,
                                                                    "end_token": 36,
                                                                    "children": [
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "start_token": 30,
                                                                            "end_token": 35,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 30,
                                                                                    "end_token": 30,
                                                                                    "label": "status"
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 33,
                                                                                    "end_token": 35,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 33,
                                                                                            "end_token": 33,
                                                                                            "label": "ExecutionStatus"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 35,
                                                                                            "end_token": 35,
                                                                                            "label": "FAILED"
                                                                                        }
                                                                                    ],
                                                                                    "label": "ExecutionStatus.FAILED"
                                                                                }
                                                                            ],
                                                                            "label": "status == ExecutionStatus.FAILED"
                                                                        }
                                                                    ],
                                                                    "label": "if status == ExecutionStatus.FAILED:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 37,
                                                                    "end_token": 49,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "start_token": 38,
                                                                            "end_token": 43,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 38,
                                                                                    "end_token": 43,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 38,
                                                                                            "end_token": 40,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 38,
                                                                                                    "end_token": 38,
                                                                                                    "label": "log"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 40,
                                                                                                    "end_token": 40,
                                                                                                    "label": "info"
                                                                                                }
                                                                                            ],
                                                                                            "label": "log.info"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 41,
                                                                                            "end_token": 43,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 42,
                                                                                                    "end_token": 42,
                                                                                                    "label": "\"Execution failed\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\"Execution failed\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "log.info(\"Execution failed\")"
                                                                                }
                                                                            ],
                                                                            "label": "log.info(\"Execution failed\")"
                                                                        },
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 45,
                                                                            "end_token": 49,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 46,
                                                                                    "end_token": 49,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 46,
                                                                                            "end_token": 46,
                                                                                            "label": "Exception"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 47,
                                                                                            "end_token": 49,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 48,
                                                                                                    "end_token": 48,
                                                                                                    "label": "\"Execution failed\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\"Execution failed\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "Exception(\"Execution failed\")"
                                                                                }
                                                                            ],
                                                                            "label": "raise Exception(\"Execution failed\")"
                                                                        }
                                                                    ],
                                                                    "label": "\n            log.info(\"Execution failed\")\n            raise Exception(\"Execution failed\")"
                                                                }
                                                            ],
                                                            "label": "if status == ExecutionStatus.FAILED:\n            log.info(\"Execution failed\")\n            raise Exception(\"Execution failed\")"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 51,
                                                            "end_token": 52,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": 52,
                                                                    "end_token": 57,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 55,
                                                                            "end_token": 57,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 55,
                                                                                    "end_token": 55,
                                                                                    "label": "ExecutionStatus"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 57,
                                                                                    "end_token": 57,
                                                                                    "label": "COMPLETED"
                                                                                }
                                                                            ],
                                                                            "label": "ExecutionStatus.COMPLETED"
                                                                        }
                                                                    ],
                                                                    "label": "status == ExecutionStatus.COMPLETED"
                                                                }
                                                            ],
                                                            "label": "return status"
                                                        }
                                                    ],
                                                    "label": ":\n        status = await AgentServer().test_get_graph_run_status(graph_exec_id, user_id)\n        log.info(f\"Execution status: {status}\")\n        if status == ExecutionStatus.FAILED:\n            log.info(\"Execution failed\")\n            raise Exception(\"Execution failed\")\n        return status"
                                                }
                                            ],
                                            "label": "async def is_execution_completed():\n        status = await AgentServer().test_get_graph_run_status(graph_exec_id, user_id)\n        log.info(f\"Execution status: {status}\")\n        if status == ExecutionStatus.FAILED:\n            log.info(\"Execution failed\")\n            raise Exception(\"Execution failed\")\n        return status"
                                        }
                                    ],
                                    "label": "async def is_execution_completed():\n        status = await AgentServer().test_get_graph_run_status(graph_exec_id, user_id)\n        log.info(f\"Execution status: {status}\")\n        if status == ExecutionStatus.FAILED:\n            log.info(\"Execution failed\")\n            raise Exception(\"Execution failed\")\n        return status == ExecutionStatus.COMPLETED\n"
                                }
                            ]
                        }
                    ],
                    "label": "async def wait_execution(\n    user_id: str,\n    graph_id: str,\n    graph_exec_id: str,\n    timeout: int = 20,\n) -> Sequence[ExecutionResult]:\n\n    # Wait for the executions to complete\n    for i in range(timeout):\n        if await is_execution_completed():\n            return await AgentServer().test_get_graph_run_node_execution_results(\n                graph_id, graph_exec_id, user_id\n            )\n        time.sleep(1)\n\n    assert False, \"Execution did not complete in time.\""
                }
            ]
        },
        {
            "type": "function_placeholder",
            "name": "execute_block_test",
            "start_line": 81,
            "end_line": 144,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 306,
                    "children": [
                        {
                            "type": "function_definition",
                            "start_token": 0,
                            "end_token": 306,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "label": "execute_block_test"
                                },
                                {
                                    "type": "parameters",
                                    "start_token": 2,
                                    "end_token": 6,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "start_token": 3,
                                            "end_token": 5,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 3,
                                                    "end_token": 3,
                                                    "label": "block"
                                                },
                                                {
                                                    "type": "type",
                                                    "start_token": 5,
                                                    "end_token": 5,
                                                    "label": "Block"
                                                }
                                            ],
                                            "label": "block: Block"
                                        }
                                    ],
                                    "label": "(block: Block)"
                                },
                                {
                                    "type": "block",
                                    "start_token": 8,
                                    "end_token": 306,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "start_token": 9,
                                            "end_token": 12,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 9,
                                                    "end_token": 9,
                                                    "label": "prefix"
                                                },
                                                {
                                                    "type": "string",
                                                    "start_token": 11,
                                                    "end_token": 12,
                                                    "label": "f\"[Test-{block.name}]\""
                                                }
                                            ],
                                            "label": "prefix = f\"[Test-{block.name}]\""
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 15,
                                            "end_token": 35,
                                            "children": [
                                                {
                                                    "type": "boolean_operator",
                                                    "start_token": 16,
                                                    "end_token": 24,
                                                    "children": [
                                                        {
                                                            "type": "not_operator",
                                                            "start_token": 16,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 17,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "label": "test_input"
                                                                        }
                                                                    ],
                                                                    "label": "block.test_input"
                                                                }
                                                            ],
                                                            "label": "not block.test_input"
                                                        },
                                                        {
                                                            "type": "not_operator",
                                                            "start_token": 21,
                                                            "end_token": 24,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 22,
                                                                    "end_token": 24,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 22,
                                                                            "end_token": 22,
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 24,
                                                                            "end_token": 24,
                                                                            "label": "test_output"
                                                                        }
                                                                    ],
                                                                    "label": "block.test_output"
                                                                }
                                                            ],
                                                            "label": "not block.test_output"
                                                        }
                                                    ],
                                                    "label": "not block.test_input or not block.test_output"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 26,
                                                    "end_token": 35,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 27,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 27,
                                                                    "end_token": 29,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "label": "log"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 29,
                                                                            "end_token": 29,
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "log.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 30,
                                                                    "end_token": 32,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 31,
                                                                            "end_token": 32,
                                                                            "label": "f\"{prefix} No test data provided\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"{prefix} No test data provided\""
                                                                }
                                                            ],
                                                            "label": "log.info(f\"{prefix} No test data provided\")"
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 35,
                                                            "end_token": 35,
                                                            "label": "return"
                                                        }
                                                    ],
                                                    "label": "\n        log.info(f\"{prefix} No test data provided\")\n        return"
                                                }
                                            ],
                                            "label": "if not block.test_input or not block.test_output:\n        log.info(f\"{prefix} No test data provided\")\n        return"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 37,
                                            "end_token": 58,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 38,
                                                    "end_token": 46,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 39,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 39,
                                                                    "end_token": 39,
                                                                    "label": "isinstance"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 40,
                                                                    "end_token": 45,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 41,
                                                                            "end_token": 43,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 41,
                                                                                    "end_token": 41,
                                                                                    "label": "block"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 43,
                                                                                    "label": "test_input"
                                                                                }
                                                                            ],
                                                                            "label": "block.test_input"
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 45,
                                                                            "end_token": 45,
                                                                            "label": "list"
                                                                        }
                                                                    ],
                                                                    "label": "(block.test_input, list"
                                                                }
                                                            ],
                                                            "label": "isinstance(block.test_input, list)"
                                                        }
                                                    ],
                                                    "label": "not isinstance(block.test_input, list)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 47,
                                                    "end_token": 58,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 49,
                                                            "end_token": 57,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 49,
                                                                    "end_token": 51,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 49,
                                                                            "end_token": 49,
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 51,
                                                                            "end_token": 51,
                                                                            "label": "test_input"
                                                                        }
                                                                    ],
                                                                    "label": "block.test_input"
                                                                },
                                                                {
                                                                    "type": "list",
                                                                    "start_token": 53,
                                                                    "end_token": 57,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 54,
                                                                            "end_token": 56,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 54,
                                                                                    "end_token": 54,
                                                                                    "label": "block"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 56,
                                                                                    "end_token": 56,
                                                                                    "label": "test_input"
                                                                                }
                                                                            ],
                                                                            "label": "block.test_input"
                                                                        }
                                                                    ],
                                                                    "label": "[block.test_input]"
                                                                }
                                                            ],
                                                            "label": "block.test_input = [block.test_input]"
                                                        }
                                                    ],
                                                    "label": ":\n        block.test_input = [block.test_input]\n"
                                                }
                                            ],
                                            "label": "if not isinstance(block.test_input, list):\n        block.test_input = [block.test_input]\n"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 59,
                                            "end_token": 80,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "start_token": 60,
                                                    "end_token": 68,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 61,
                                                            "end_token": 68,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 61,
                                                                    "end_token": 61,
                                                                    "label": "isinstance"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 62,
                                                                    "end_token": 67,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 63,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 63,
                                                                                    "end_token": 63,
                                                                                    "label": "block"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 65,
                                                                                    "end_token": 65,
                                                                                    "label": "test_output"
                                                                                }
                                                                            ],
                                                                            "label": "block.test_output"
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "start_token": 67,
                                                                            "end_token": 67,
                                                                            "label": "list"
                                                                        }
                                                                    ],
                                                                    "label": "(block.test_output, list"
                                                                }
                                                            ],
                                                            "label": "isinstance(block.test_output, list)"
                                                        }
                                                    ],
                                                    "label": "not isinstance(block.test_output, list)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 69,
                                                    "end_token": 80,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 71,
                                                            "end_token": 79,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 71,
                                                                    "end_token": 73,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 71,
                                                                            "end_token": 71,
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 73,
                                                                            "end_token": 73,
                                                                            "label": "test_output"
                                                                        }
                                                                    ],
                                                                    "label": "block.test_output"
                                                                },
                                                                {
                                                                    "type": "list",
                                                                    "start_token": 75,
                                                                    "end_token": 79,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 76,
                                                                            "end_token": 78,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 76,
                                                                                    "end_token": 76,
                                                                                    "label": "block"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 78,
                                                                                    "end_token": 78,
                                                                                    "label": "test_output"
                                                                                }
                                                                            ],
                                                                            "label": "block.test_output"
                                                                        }
                                                                    ],
                                                                    "label": "[block.test_output]"
                                                                }
                                                            ],
                                                            "label": "block.test_output = [block.test_output]"
                                                        }
                                                    ],
                                                    "label": ":\n        block.test_output = [block.test_output]\n"
                                                }
                                            ],
                                            "label": "if not isinstance(block.test_output, list):\n        block.test_output = [block.test_output]\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 82,
                                            "end_token": 84,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 82,
                                                    "end_token": 82,
                                                    "label": "output_index"
                                                },
                                                {
                                                    "type": "integer",
                                                    "start_token": 84,
                                                    "end_token": 84,
                                                    "label": "0"
                                                }
                                            ],
                                            "label": "output_index = 0"
                                        },
                                        {
                                            "type": "call",
                                            "start_token": 86,
                                            "end_token": 92,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "start_token": 86,
                                                    "end_token": 88,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 86,
                                                            "end_token": 86,
                                                            "label": "log"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 88,
                                                            "end_token": 88,
                                                            "label": "info"
                                                        }
                                                    ],
                                                    "label": "log.info"
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "start_token": 89,
                                                    "end_token": 91,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 90,
                                                            "end_token": 91,
                                                            "label": "f\"{prefix} Executing {len(block.test_input)} tests...\""
                                                        }
                                                    ],
                                                    "label": "(f\"{prefix} Executing {len(block.test_input)} tests...\""
                                                }
                                            ],
                                            "label": "log.info(f\"{prefix} Executing {len(block.test_input)} tests...\")"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 94,
                                            "end_token": 100,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 94,
                                                    "end_token": 94,
                                                    "label": "prefix"
                                                },
                                                {
                                                    "type": "concatenated_string",
                                                    "start_token": 96,
                                                    "end_token": 100,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "start_token": 96,
                                                            "end_token": 98,
                                                            "label": "\" \" * 4"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 100,
                                                            "end_token": 100,
                                                            "label": "prefix"
                                                        }
                                                    ],
                                                    "label": "\" \" * 4 + prefix"
                                                }
                                            ],
                                            "label": "prefix = \" \" * 4 + prefix"
                                        },
                                        {
                                            "type": "for_statement",
                                            "start_token": 103,
                                            "end_token": 158,
                                            "children": [
                                                {
                                                    "type": "for_in_clause",
                                                    "start_token": 103,
                                                    "end_token": 120,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 104,
                                                            "end_token": 104,
                                                            "label": "mock_name"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 106,
                                                            "end_token": 106,
                                                            "label": "mock_obj"
                                                        },
                                                        {
                                                            "type": "conditional_expression",
                                                            "start_token": 108,
                                                            "end_token": 119,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 109,
                                                                    "end_token": 111,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 109,
                                                                            "end_token": 109,
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 111,
                                                                            "end_token": 111,
                                                                            "label": "test_mock"
                                                                        }
                                                                    ],
                                                                    "label": "block.test_mock"
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "start_token": 113,
                                                                    "end_token": 114,
                                                                    "label": "{}"
                                                                }
                                                            ],
                                                            "label": "(block.test_mock or {}).items()"
                                                        }
                                                    ],
                                                    "label": "for mock_name, mock_obj in (block.test_mock or {}).items():"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 121,
                                                    "end_token": 158,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 122,
                                                            "end_token": 128,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 122,
                                                                    "end_token": 124,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 122,
                                                                            "end_token": 122,
                                                                            "label": "log"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 124,
                                                                            "end_token": 124,
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "log.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 125,
                                                                    "end_token": 127,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 126,
                                                                            "end_token": 127,
                                                                            "label": "f\"{prefix} mocking {mock_name}...\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"{prefix} mocking {mock_name}...\""
                                                                }
                                                            ],
                                                            "label": "log.info(f\"{prefix} mocking {mock_name}...\")"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 130,
                                                            "end_token": 157,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 131,
                                                                    "end_token": 136,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 131,
                                                                            "end_token": 131,
                                                                            "label": "hasattr"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 132,
                                                                            "end_token": 135,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 133,
                                                                                    "end_token": 135,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 133,
                                                                                            "end_token": 133,
                                                                                            "label": "block"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 135,
                                                                                            "end_token": 135,
                                                                                            "label": "mock_name"
                                                                                        }
                                                                                    ],
                                                                                    "label": "block, mock_name"
                                                                                }
                                                                            ],
                                                                            "label": "(block, mock_name"
                                                                        }
                                                                    ],
                                                                    "label": "hasattr(block, mock_name)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 137,
                                                                    "end_token": 147,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 139,
                                                                            "end_token": 146,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 139,
                                                                                    "end_token": 139,
                                                                                    "label": "setattr"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 140,
                                                                                    "end_token": 145,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 141,
                                                                                            "end_token": 141,
                                                                                            "label": "block"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 143,
                                                                                            "end_token": 143,
                                                                                            "label": "mock_name"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 145,
                                                                                            "end_token": 145,
                                                                                            "label": "mock_obj"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(block, mock_name, mock_obj"
                                                                                }
                                                                            ],
                                                                            "label": "setattr(block, mock_name, mock_obj)"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            setattr(block, mock_name, mock_obj)\n"
                                                                },
                                                                {
                                                                    "type": "else_clause",
                                                                    "start_token": 148,
                                                                    "end_token": 157,
                                                                    "children": [
                                                                        {
                                                                            "type": "block",
                                                                            "start_token": 150,
                                                                            "end_token": 157,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 151,
                                                                                    "end_token": 157,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 151,
                                                                                            "end_token": 153,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 151,
                                                                                                    "end_token": 151,
                                                                                                    "label": "log"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 153,
                                                                                                    "end_token": 153,
                                                                                                    "label": "info"
                                                                                                }
                                                                                            ],
                                                                                            "label": "log.info"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 154,
                                                                                            "end_token": 156,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 155,
                                                                                                    "end_token": 156,
                                                                                                    "label": "f\"{prefix} mock {mock_name} not found in block\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(f\"{prefix} mock {mock_name} not found in block\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "log.info(f\"{prefix} mock {mock_name} not found in block\")"
                                                                                }
                                                                            ],
                                                                            "label": "\n            log.info(f\"{prefix} mock {mock_name} not found in block\")"
                                                                        }
                                                                    ],
                                                                    "label": "else:\n            log.info(f\"{prefix} mock {mock_name} not found in block\")"
                                                                }
                                                            ],
                                                            "label": "if hasattr(block, mock_name):\n            setattr(block, mock_name, mock_obj)\n        else:\n            log.info(f\"{prefix} mock {mock_name} not found in block\")"
                                                        }
                                                    ],
                                                    "label": "\n        log.info(f\"{prefix} mocking {mock_name}...\")\n        if hasattr(block, mock_name):\n            setattr(block, mock_name, mock_obj)\n        else:\n            log.info(f\"{prefix} mock {mock_name} not found in block\")\n"
                                                }
                                            ],
                                            "label": "for mock_name, mock_obj in (block.test_mock or {}).items():\n        log.info(f\"{prefix} mocking {mock_name}...\")\n        if hasattr(block, mock_name):\n            setattr(block, mock_name, mock_obj)\n        else:\n            log.info(f\"{prefix} mock {mock_name} not found in block\")\n"
                                        },
                                        {
                                            "type": "assignment",
                                            "start_token": 160,
                                            "end_token": 163,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 160,
                                                    "end_token": 160,
                                                    "label": "extra_exec_kwargs"
                                                },
                                                {
                                                    "type": "dictionary",
                                                    "start_token": 162,
                                                    "end_token": 163,
                                                    "label": "{}"
                                                }
                                            ],
                                            "label": "extra_exec_kwargs = {}"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 166,
                                            "end_token": 200,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 167,
                                                    "end_token": 174,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 167,
                                                            "end_token": 167,
                                                            "label": "CREDENTIALS_FIELD_NAME"
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 169,
                                                            "end_token": 173,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 169,
                                                                    "end_token": 171,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 169,
                                                                            "end_token": 169,
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 171,
                                                                            "end_token": 171,
                                                                            "label": "input_schema"
                                                                        }
                                                                    ],
                                                                    "label": "block.input_schema"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 173,
                                                                    "end_token": 173,
                                                                    "label": "model_fields"
                                                                }
                                                            ],
                                                            "label": "block.input_schema.model_fields"
                                                        }
                                                    ],
                                                    "label": "CREDENTIALS_FIELD_NAME in block.input_schema.model_fields:"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 175,
                                                    "end_token": 200,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 176,
                                                            "end_token": 190,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 177,
                                                                    "end_token": 181,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 178,
                                                                            "end_token": 180,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 178,
                                                                                    "end_token": 178,
                                                                                    "label": "block"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 180,
                                                                                    "end_token": 180,
                                                                                    "label": "test_credentials"
                                                                                }
                                                                            ],
                                                                            "label": "block.test_credentials"
                                                                        }
                                                                    ],
                                                                    "label": "not block.test_credentials:"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 182,
                                                                    "end_token": 190,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 183,
                                                                            "end_token": 189,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 184,
                                                                                    "end_token": 189,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 184,
                                                                                            "end_token": 184,
                                                                                            "label": "ValueError"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 185,
                                                                                            "end_token": 188,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "start_token": 187,
                                                                                                    "end_token": 188,
                                                                                                    "label": "f\"{prefix} requires credentials but has no test_credentials\""
                                                                                                }
                                                                                            ],
                                                                                            "label": "(\n                f\"{prefix} requires credentials but has no test_credentials\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n"
                                                                                }
                                                                            ],
                                                                            "label": "raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n"
                                                                        }
                                                                    ],
                                                                    "label": "\n            raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n            )"
                                                                }
                                                            ],
                                                            "label": "if not block.test_credentials:\n            raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n            )"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 192,
                                                            "end_token": 199,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "start_token": 192,
                                                                    "end_token": 195,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 192,
                                                                            "end_token": 192,
                                                                            "label": "extra_exec_kwargs"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 194,
                                                                            "end_token": 194,
                                                                            "label": "CREDENTIALS_FIELD_NAME"
                                                                        }
                                                                    ],
                                                                    "label": "extra_exec_kwargs[CREDENTIALS_FIELD_NAME]"
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 197,
                                                                    "end_token": 199,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 197,
                                                                            "end_token": 197,
                                                                            "label": "block"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 199,
                                                                            "end_token": 199,
                                                                            "label": "test_credentials"
                                                                        }
                                                                    ],
                                                                    "label": "block.test_credentials"
                                                                }
                                                            ],
                                                            "label": "extra_exec_kwargs[CREDENTIALS_FIELD_NAME] = block.test_credentials"
                                                        }
                                                    ],
                                                    "label": "\n        if not block.test_credentials:\n            raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n            )\n        extra_exec_kwargs[CREDENTIALS_FIELD_NAME] = block.test_credentials\n"
                                                }
                                            ],
                                            "label": "if CREDENTIALS_FIELD_NAME in block.input_schema.model_fields:\n        if not block.test_credentials:\n            raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n            )\n        extra_exec_kwargs[CREDENTIALS_FIELD_NAME] = block.test_credentials\n"
                                        },
                                        {
                                            "type": "for_statement",
                                            "start_token": 202,
                                            "end_token": 285,
                                            "children": [
                                                {
                                                    "type": "for_in_clause",
                                                    "start_token": 202,
                                                    "end_token": 208,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 203,
                                                            "end_token": 203,
                                                            "label": "input_data"
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "start_token": 205,
                                                            "end_token": 207,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 205,
                                                                    "end_token": 205,
                                                                    "label": "block"
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 207,
                                                                    "end_token": 207,
                                                                    "label": "test_input"
                                                                }
                                                            ],
                                                            "label": "block.test_input"
                                                        }
                                                    ],
                                                    "label": "for input_data in block.test_input:"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 209,
                                                    "end_token": 285,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "start_token": 210,
                                                            "end_token": 216,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 210,
                                                                    "end_token": 212,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 210,
                                                                            "end_token": 210,
                                                                            "label": "log"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 212,
                                                                            "end_token": 212,
                                                                            "label": "info"
                                                                        }
                                                                    ],
                                                                    "label": "log.info"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 213,
                                                                    "end_token": 215,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 214,
                                                                            "end_token": 215,
                                                                            "label": "f\"{prefix} in: {input_data}\""
                                                                        }
                                                                    ],
                                                                    "label": "(f\"{prefix} in: {input_data}\""
                                                                }
                                                            ],
                                                            "label": "log.info(f\"{prefix} in: {input_data}\")"
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "start_token": 219,
                                                            "end_token": 285,
                                                            "children": [
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "start_token": 219,
                                                                    "end_token": 233,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 220,
                                                                            "end_token": 220,
                                                                            "label": "output_name"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 222,
                                                                            "end_token": 222,
                                                                            "label": "output_data"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 224,
                                                                            "end_token": 233,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 224,
                                                                                    "end_token": 226,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 224,
                                                                                            "end_token": 224,
                                                                                            "label": "block"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 226,
                                                                                            "end_token": 226,
                                                                                            "label": "execute"
                                                                                        }
                                                                                    ],
                                                                                    "label": "block.execute"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 227,
                                                                                    "end_token": 232,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 228,
                                                                                            "end_token": 228,
                                                                                            "label": "input_data"
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary_splat",
                                                                                            "start_token": 230,
                                                                                            "end_token": 232,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 232,
                                                                                                    "end_token": 232,
                                                                                                    "label": "extra_exec_kwargs"
                                                                                                }
                                                                                            ],
                                                                                            "label": "**extra_exec_kwargs"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(input_data, **extra_exec_kwargs"
                                                                                }
                                                                            ],
                                                                            "label": "block.execute(input_data, **extra_exec_kwargs)"
                                                                        }
                                                                    ],
                                                                    "label": "for output_name, output_data in block.execute(input_data, **extra_exec_kwargs)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 234,
                                                                    "end_token": 285,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "start_token": 236,
                                                                            "end_token": 254,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "start_token": 237,
                                                                                    "end_token": 246,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 237,
                                                                                            "end_token": 237,
                                                                                            "label": "output_index"
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "start_token": 239,
                                                                                            "end_token": 245,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 239,
                                                                                                    "end_token": 239,
                                                                                                    "label": "="
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "start_token": 240,
                                                                                                    "end_token": 244,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "start_token": 242,
                                                                                                            "end_token": 244,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 242,
                                                                                                                    "end_token": 242,
                                                                                                                    "label": "block"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "start_token": 244,
                                                                                                                    "end_token": 244,
                                                                                                                    "label": "test_output"
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "block.test_output"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "len(block.test_output"
                                                                                                }
                                                                                            ],
                                                                                            "label": "= len(block.test_output)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "output_index >= len(block.test_output):"
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "start_token": 247,
                                                                                    "end_token": 254,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "start_token": 248,
                                                                                            "end_token": 253,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "start_token": 249,
                                                                                                    "end_token": 253,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 249,
                                                                                                            "end_token": 249,
                                                                                                            "label": "ValueError"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "start_token": 250,
                                                                                                            "end_token": 252,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "start_token": 251,
                                                                                                                    "end_token": 252,
                                                                                                                    "label": "f\"{prefix} produced output more than expected\""
                                                                                                                }
                                                                                                            ],
                                                                                                            "label": "(f\"{prefix} produced output more than expected\""
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "ValueError(f\"{prefix} produced output more than expected\")"
                                                                                                }
                                                                                            ],
                                                                                            "label": "raise ValueError(f\"{prefix} produced output more than expected\")"
                                                                                        }
                                                                                    ],
                                                                                    "label": "\n                raise ValueError(f\"{prefix} produced output more than expected\")\n"
                                                                                }
                                                                            ],
                                                                            "label": "if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n"
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 255,
                                                                            "end_token": 265,
                                                                            "children": [
                                                                                {
                                                                                    "type": "tuple",
                                                                                    "start_token": 255,
                                                                                    "end_token": 257,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 255,
                                                                                            "end_token": 255,
                                                                                            "label": "ex_output_name"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 257,
                                                                                            "end_token": 257,
                                                                                            "label": "ex_output_data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "ex_output_name, ex_output_data"
                                                                                },
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "start_token": 259,
                                                                                    "end_token": 263,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "start_token": 259,
                                                                                            "end_token": 261,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 259,
                                                                                                    "end_token": 259,
                                                                                                    "label": "block"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 261,
                                                                                                    "end_token": 261,
                                                                                                    "label": "test_output"
                                                                                                }
                                                                                            ],
                                                                                            "label": "block.test_output"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 263,
                                                                                            "end_token": 263,
                                                                                            "label": "output_index"
                                                                                        }
                                                                                    ],
                                                                                    "label": "block.test_output[output_index"
                                                                                }
                                                                            ],
                                                                            "label": "ex_output_name, ex_output_data = block.test_output[output_index]\n"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 268,
                                                                            "end_token": 273,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 268,
                                                                                    "end_token": 268,
                                                                                    "label": "compare"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 269,
                                                                                    "end_token": 272,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 270,
                                                                                            "end_token": 270,
                                                                                            "label": "output_data"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 272,
                                                                                            "end_token": 272,
                                                                                            "label": "ex_output_data"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(output_data, ex_output_data"
                                                                                }
                                                                            ],
                                                                            "label": "compare(output_data, ex_output_data)"
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 275,
                                                                            "end_token": 280,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 275,
                                                                                    "end_token": 275,
                                                                                    "label": "compare"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 276,
                                                                                    "end_token": 279,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 277,
                                                                                            "end_token": 277,
                                                                                            "label": "output_name"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 279,
                                                                                            "end_token": 279,
                                                                                            "label": "ex_output_name"
                                                                                        }
                                                                                    ],
                                                                                    "label": "(output_name, ex_output_name"
                                                                                }
                                                                            ],
                                                                            "label": "compare(output_name, ex_output_name)"
                                                                        },
                                                                        {
                                                                            "type": "augmented_assignment",
                                                                            "start_token": 282,
                                                                            "end_token": 285,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 282,
                                                                                    "end_token": 282,
                                                                                    "label": "output_index"
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "start_token": 285,
                                                                                    "end_token": 285,
                                                                                    "label": "1"
                                                                                }
                                                                            ],
                                                                            "label": "output_index += 1"
                                                                        }
                                                                    ],
                                                                    "label": ":\n            if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n            ex_output_name, ex_output_data = block.test_output[output_index]\n\n\n            compare(output_data, ex_output_data)\n            compare(output_name, ex_output_name)\n            output_index += 1"
                                                                }
                                                            ],
                                                            "label": "for output_name, output_data in block.execute(input_data, **extra_exec_kwargs):\n            if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n            ex_output_name, ex_output_data = block.test_output[output_index]\n\n\n            compare(output_data, ex_output_data)\n            compare(output_name, ex_output_name)\n            output_index += 1"
                                                        }
                                                    ],
                                                    "label": "\n        log.info(f\"{prefix} in: {input_data}\")\n\n        for output_name, output_data in block.execute(input_data, **extra_exec_kwargs):\n            if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n            ex_output_name, ex_output_data = block.test_output[output_index]\n\n\n            compare(output_data, ex_output_data)\n            compare(output_name, ex_output_name)\n            output_index += 1"
                                                }
                                            ],
                                            "label": "for input_data in block.test_input:\n        log.info(f\"{prefix} in: {input_data}\")\n\n        for output_name, output_data in block.execute(input_data, **extra_exec_kwargs):\n            if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n            ex_output_name, ex_output_data = block.test_output[output_index]\n\n\n            compare(output_data, ex_output_data)\n            compare(output_name, ex_output_name)\n            output_index += 1"
                                        },
                                        {
                                            "type": "if_statement",
                                            "start_token": 288,
                                            "end_token": 306,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "start_token": 289,
                                                    "end_token": 297,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 289,
                                                            "end_token": 289,
                                                            "label": "output_index"
                                                        },
                                                        {
                                                            "type": "call",
                                                            "start_token": 291,
                                                            "end_token": 296,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 291,
                                                                    "end_token": 293,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 291,
                                                                            "end_token": 291,
                                                                            "label": "len"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 293,
                                                                            "end_token": 293,
                                                                            "label": "block"
                                                                        }
                                                                    ],
                                                                    "label": "len(block"
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "start_token": 294,
                                                                    "end_token": 296,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 295,
                                                                            "end_token": 295,
                                                                            "label": "test_output"
                                                                        }
                                                                    ],
                                                                    "label": ".test_output)"
                                                                }
                                                            ],
                                                            "label": "len(block.test_output)"
                                                        }
                                                    ],
                                                    "label": "output_index < len(block.test_output):"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 298,
                                                    "end_token": 306,
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "start_token": 299,
                                                            "end_token": 306,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 300,
                                                                    "end_token": 306,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 300,
                                                                            "end_token": 300,
                                                                            "label": "ValueError"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 301,
                                                                            "end_token": 305,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "start_token": 303,
                                                                                    "end_token": 305,
                                                                                    "label": "f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n"
                                                                        }
                                                                    ],
                                                                    "label": "ValueError(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n        )"
                                                                }
                                                            ],
                                                            "label": "raise ValueError(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        raise ValueError(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n        )"
                                                }
                                            ],
                                            "label": "if output_index < len(block.test_output):\n        raise ValueError(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n        )"
                                        }
                                    ],
                                    "label": "\n    prefix = f\"[Test-{block.name}]\"\n\n    if not block.test_input or not block.test_output:\n        log.info(f\"{prefix} No test data provided\")\n        return\n    if not isinstance(block.test_input, list):\n        block.test_input = [block.test_input]\n    if not isinstance(block.test_output, list):\n        block.test_output = [block.test_output]\n\n    output_index = 0\n    log.info(f\"{prefix} Executing {len(block.test_input)} tests...\")\n    prefix = \" \" * 4 + prefix\n\n    for mock_name, mock_obj in (block.test_mock or {}).items():\n        log.info(f\"{prefix} mocking {mock_name}...\")\n        if hasattr(block, mock_name):\n            setattr(block, mock_name, mock_obj)\n        else:\n            log.info(f\"{prefix} mock {mock_name} not found in block\")\n\n    extra_exec_kwargs = {}\n\n    if CREDENTIALS_FIELD_NAME in block.input_schema.model_fields:\n        if not block.test_credentials:\n            raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n            )\n        extra_exec_kwargs[CREDENTIALS_FIELD_NAME] = block.test_credentials\n\n    for input_data in block.test_input:\n        log.info(f\"{prefix} in: {input_data}\")\n\n        for output_name, output_data in block.execute(input_data, **extra_exec_kwargs):\n            if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n            ex_output_name, ex_output_data = block.test_output[output_index]\n\n\n            compare(output_data, ex_output_data)\n            compare(output_name, ex_output_name)\n            output_index += 1\n\n    if output_index < len(block.test_output):\n        raise ValueError(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n        )"
                                }
                            ],
                            "label": "def execute_block_test(block: Block):\n    prefix = f\"[Test-{block.name}]\"\n\n    if not block.test_input or not block.test_output:\n        log.info(f\"{prefix} No test data provided\")\n        return\n    if not isinstance(block.test_input, list):\n        block.test_input = [block.test_input]\n    if not isinstance(block.test_output, list):\n        block.test_output = [block.test_output]\n\n    output_index = 0\n    log.info(f\"{prefix} Executing {len(block.test_input)} tests...\")\n    prefix = \" \" * 4 + prefix\n\n    for mock_name, mock_obj in (block.test_mock or {}).items():\n        log.info(f\"{prefix} mocking {mock_name}...\")\n        if hasattr(block, mock_name):\n            setattr(block, mock_name, mock_obj)\n        else:\n            log.info(f\"{prefix} mock {mock_name} not found in block\")\n\n    extra_exec_kwargs = {}\n\n    if CREDENTIALS_FIELD_NAME in block.input_schema.model_fields:\n        if not block.test_credentials:\n            raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n            )\n        extra_exec_kwargs[CREDENTIALS_FIELD_NAME] = block.test_credentials\n\n    for input_data in block.test_input:\n        log.info(f\"{prefix} in: {input_data}\")\n\n        for output_name, output_data in block.execute(input_data, **extra_exec_kwargs):\n            if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n            ex_output_name, ex_output_data = block.test_output[output_index]\n\n\n            compare(output_data, ex_output_data)\n            compare(output_name, ex_output_name)\n            output_index += 1\n\n    if output_index < len(block.test_output):\n        raise ValueError(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n        )"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "compare",
                            "start_line": 120,
                            "end_line": 135,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 88,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 75,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "compare"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 6,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "data"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 5,
                                                            "end_token": 5,
                                                            "children": [],
                                                            "label": "expected_data"
                                                        }
                                                    ],
                                                    "label": "(data, expected_data)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 8,
                                                    "end_token": 75,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 9,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "start_token": 9,
                                                                    "end_token": 13,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 10,
                                                                            "end_token": 10,
                                                                            "children": [],
                                                                            "label": "data"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 13,
                                                                            "end_token": 13,
                                                                            "children": [],
                                                                            "label": "expected_data"
                                                                        }
                                                                    ],
                                                                    "label": "if data == expected_data"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 15,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 16,
                                                                            "end_token": 18,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 16,
                                                                                    "end_token": 16,
                                                                                    "children": [],
                                                                                    "label": "is_matching"
                                                                                },
                                                                                {
                                                                                    "type": "true",
                                                                                    "start_token": 18,
                                                                                    "end_token": 18,
                                                                                    "children": [],
                                                                                    "label": "True"
                                                                                }
                                                                            ],
                                                                            "label": "is_matching = True"
                                                                        }
                                                                    ],
                                                                    "label": "\n                    is_matching = True\n"
                                                                }
                                                            ],
                                                            "label": "if data == expected_data:\n                    is_matching = True\n"
                                                        },
                                                        {
                                                            "type": "elif_clause",
                                                            "start_token": 20,
                                                            "end_token": 37,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 21,
                                                                    "end_token": 26,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 21,
                                                                            "end_token": 21,
                                                                            "children": [],
                                                                            "label": "isinstance"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 22,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 23,
                                                                                    "end_token": 23,
                                                                                    "children": [],
                                                                                    "label": "expected_data"
                                                                                },
                                                                                {
                                                                                    "type": "type",
                                                                                    "start_token": 25,
                                                                                    "end_token": 25,
                                                                                    "children": [],
                                                                                    "label": "type"
                                                                                }
                                                                            ],
                                                                            "label": "(expected_data, type)"
                                                                        }
                                                                    ],
                                                                    "label": "isinstance(expected_data, type)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 28,
                                                                    "end_token": 37,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 29,
                                                                            "end_token": 36,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 29,
                                                                                    "end_token": 29,
                                                                                    "children": [],
                                                                                    "label": "is_matching"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 31,
                                                                                    "end_token": 36,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 31,
                                                                                            "end_token": 31,
                                                                                            "children": [],
                                                                                            "label": "isinstance"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 32,
                                                                                            "end_token": 36,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 33,
                                                                                                    "end_token": 33,
                                                                                                    "children": [],
                                                                                                    "label": "data"
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 35,
                                                                                                    "end_token": 35,
                                                                                                    "children": [],
                                                                                                    "label": "expected_data"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(data, expected_data)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "isinstance(data, expected_data)"
                                                                                }
                                                                            ],
                                                                            "label": "is_matching = isinstance(data, expected_data)"
                                                                        }
                                                                    ],
                                                                    "label": "\n                    is_matching = isinstance(data, expected_data)\n"
                                                                }
                                                            ],
                                                            "label": "elif isinstance(expected_data, type):\n                    is_matching = isinstance(data, expected_data)\n"
                                                        },
                                                        {
                                                            "type": "elif_clause",
                                                            "start_token": 38,
                                                            "end_token": 51,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 39,
                                                                    "end_token": 42,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 39,
                                                                            "end_token": 39,
                                                                            "children": [],
                                                                            "label": "callable"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 40,
                                                                            "end_token": 42,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 41,
                                                                                    "end_token": 41,
                                                                                    "children": [],
                                                                                    "label": "expected_data"
                                                                                }
                                                                            ],
                                                                            "label": "(expected_data)"
                                                                        }
                                                                    ],
                                                                    "label": "callable(expected_data)"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 44,
                                                                    "end_token": 51,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 45,
                                                                            "end_token": 50,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 45,
                                                                                    "end_token": 45,
                                                                                    "children": [],
                                                                                    "label": "is_matching"
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "start_token": 47,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 47,
                                                                                            "end_token": 47,
                                                                                            "children": [],
                                                                                            "label": "expected_data"
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "start_token": 48,
                                                                                            "end_token": 50,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 49,
                                                                                                    "end_token": 49,
                                                                                                    "children": [],
                                                                                                    "label": "data"
                                                                                                }
                                                                                            ],
                                                                                            "label": "(data)"
                                                                                        }
                                                                                    ],
                                                                                    "label": "expected_data(data)"
                                                                                }
                                                                            ],
                                                                            "label": "is_matching = expected_data(data)"
                                                                        }
                                                                    ],
                                                                    "label": "\n                    is_matching = expected_data(data)\n"
                                                                }
                                                            ],
                                                            "label": "elif callable(expected_data):\n                    is_matching = expected_data(data)\n"
                                                        },
                                                        {
                                                            "type": "else_clause",
                                                            "start_token": 52,
                                                            "end_token": 58,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 54,
                                                                    "end_token": 58,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "start_token": 55,
                                                                            "end_token": 57,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 55,
                                                                                    "end_token": 55,
                                                                                    "children": [],
                                                                                    "label": "is_matching"
                                                                                },
                                                                                {
                                                                                    "type": "false",
                                                                                    "start_token": 57,
                                                                                    "end_token": 57,
                                                                                    "children": [],
                                                                                    "label": "False"
                                                                                }
                                                                            ],
                                                                            "label": "is_matching = False"
                                                                        }
                                                                    ],
                                                                    "label": "\n                    is_matching = False\n"
                                                                }
                                                            ],
                                                            "label": "else:\n                    is_matching = False\n"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 60,
                                                            "end_token": 66,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 60,
                                                                    "end_token": 60,
                                                                    "children": [],
                                                                    "label": "mark"
                                                                },
                                                                {
                                                                    "type": "conditional_expression",
                                                                    "start_token": 62,
                                                                    "end_token": 66,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 62,
                                                                            "end_token": 62,
                                                                            "children": [],
                                                                            "label": "\"✅\""
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 64,
                                                                            "end_token": 64,
                                                                            "children": [],
                                                                            "label": "is_matching"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 66,
                                                                            "end_token": 66,
                                                                            "children": [],
                                                                            "label": "\"❌\""
                                                                        }
                                                                    ],
                                                                    "label": "\"✅\" if is_matching else \"❌\""
                                                                }
                                                            ],
                                                            "label": "mark = \"✅\" if is_matching else \"❌\""
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 68,
                                                            "end_token": 74,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 68,
                                                                    "end_token": 74,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 68,
                                                                            "end_token": 70,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 68,
                                                                                    "end_token": 68,
                                                                                    "children": [],
                                                                                    "label": "log"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 70,
                                                                                    "end_token": 70,
                                                                                    "children": [],
                                                                                    "label": "info"
                                                                                }
                                                                            ],
                                                                            "label": "log.info"
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "start_token": 72,
                                                                            "end_token": 73,
                                                                            "children": [],
                                                                            "label": "f\"{prefix} {mark} comparing `{data}` vs `{expected_data}`\""
                                                                        }
                                                                    ],
                                                                    "label": "log.info(f\"{prefix} {mark} comparing `{data}` vs `{expected_data}`\")"
                                                                }
                                                            ],
                                                            "label": "log.info(f\"{prefix} {mark} comparing `{data}` vs `{expected_data}`\")"
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "start_token": 76,
                                                            "end_token": 88,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "start_token": 77,
                                                                    "end_token": 78,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 78,
                                                                            "end_token": 78,
                                                                            "children": [],
                                                                            "label": "is_matching"
                                                                        }
                                                                    ],
                                                                    "label": "not is_matching"
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "start_token": 79,
                                                                    "end_token": 88,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "start_token": 81,
                                                                            "end_token": 87,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 81,
                                                                                    "end_token": 81,
                                                                                    "children": [],
                                                                                    "label": "raise"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 83,
                                                                                    "end_token": 87,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "start_token": 85,
                                                                                            "end_token": 86,
                                                                                            "children": [],
                                                                                            "label": "f\"{prefix}: wrong output {data} vs {expected_data}\""
                                                                                        }
                                                                                    ],
                                                                                    "label": "(\n                        f\"{prefix}: wrong output {data} vs {expected_data}\"\n"
                                                                                }
                                                                            ],
                                                                            "label": "raise ValueError(\n                        f\"{prefix}: wrong output {data} vs {expected_data}\"\n"
                                                                        }
                                                                    ],
                                                                    "label": ":\n                    raise ValueError(\n                        f\"{prefix}: wrong output {data} vs {expected_data}\"\n                    )"
                                                                }
                                                            ],
                                                            "label": "if not is_matching:\n                    raise ValueError(\n                        f\"{prefix}: wrong output {data} vs {expected_data}\"\n                    )"
                                                        }
                                                    ],
                                                    "label": "\n                if data == expected_data:\n                    is_matching = True\n                elif isinstance(expected_data, type):\n                    is_matching = isinstance(data, expected_data)\n                elif callable(expected_data):\n                    is_matching = expected_data(data)\n                else:\n                    is_matching = False\n\n                mark = \"✅\" if is_matching else \"❌\"\n                log.info(f\"{prefix} {mark} comparing `{data}` vs `{expected_data}`\")\n"
                                                }
                                            ],
                                            "label": "def compare(data, expected_data):\n                if data == expected_data:\n                    is_matching = True\n                elif isinstance(expected_data, type):\n                    is_matching = isinstance(data, expected_data)\n                elif callable(expected_data):\n                    is_matching = expected_data(data)\n                else:\n                    is_matching = False\n\n                mark = \"✅\" if is_matching else \"❌\"\n                log.info(f\"{prefix} {mark} comparing `{data}` vs `{expected_data}`\")\n"
                                        }
                                    ],
                                    "label": "def compare(data, expected_data):\n                if data == expected_data:\n                    is_matching = True\n                elif isinstance(expected_data, type):\n                    is_matching = isinstance(data, expected_data)\n                elif callable(expected_data):\n                    is_matching = expected_data(data)\n                else:\n                    is_matching = False\n\n                mark = \"✅\" if is_matching else \"❌\"\n                log.info(f\"{prefix} {mark} comparing `{data}` vs `{expected_data}`\")\n                if not is_matching:\n                    raise ValueError(\n                        f\"{prefix}: wrong output {data} vs {expected_data}\"\n                    )"
                                }
                            ]
                        }
                    ],
                    "label": "def execute_block_test(block: Block):\n    prefix = f\"[Test-{block.name}]\"\n\n    if not block.test_input or not block.test_output:\n        log.info(f\"{prefix} No test data provided\")\n        return\n    if not isinstance(block.test_input, list):\n        block.test_input = [block.test_input]\n    if not isinstance(block.test_output, list):\n        block.test_output = [block.test_output]\n\n    output_index = 0\n    log.info(f\"{prefix} Executing {len(block.test_input)} tests...\")\n    prefix = \" \" * 4 + prefix\n\n    for mock_name, mock_obj in (block.test_mock or {}).items():\n        log.info(f\"{prefix} mocking {mock_name}...\")\n        if hasattr(block, mock_name):\n            setattr(block, mock_name, mock_obj)\n        else:\n            log.info(f\"{prefix} mock {mock_name} not found in block\")\n\n    extra_exec_kwargs = {}\n\n    if CREDENTIALS_FIELD_NAME in block.input_schema.model_fields:\n        if not block.test_credentials:\n            raise ValueError(\n                f\"{prefix} requires credentials but has no test_credentials\"\n            )\n        extra_exec_kwargs[CREDENTIALS_FIELD_NAME] = block.test_credentials\n\n    for input_data in block.test_input:\n        log.info(f\"{prefix} in: {input_data}\")\n\n        for output_name, output_data in block.execute(input_data, **extra_exec_kwargs):\n            if output_index >= len(block.test_output):\n                raise ValueError(f\"{prefix} produced output more than expected\")\n            ex_output_name, ex_output_data = block.test_output[output_index]\n\n\n            compare(output_data, ex_output_data)\n            compare(output_name, ex_output_name)\n            output_index += 1\n\n    if output_index < len(block.test_output):\n        raise ValueError(\n            f\"{prefix} produced output less than expected. output_index={output_index}, len(block.test_output)={len(block.test_output)}\"\n        )"
                }
            ]
        },
        {
            "type": "class_placeholder",
            "name": "SpinTestServer",
            "start_line": 17,
            "end_line": 54,
            "children": [
                {
                    "type": "module",
                    "start_token": 0,
                    "end_token": 11,
                    "children": [
                        {
                            "type": "class_definition",
                            "start_token": 0,
                            "end_token": 3,
                            "children": [
                                {
                                    "type": "identifier",
                                    "start_token": 1,
                                    "end_token": 1,
                                    "children": [],
                                    "label": "SpinTestServer"
                                },
                                {
                                    "type": "block",
                                    "start_token": 2,
                                    "end_token": 3,
                                    "children": [],
                                    "label": ":\n"
                                }
                            ],
                            "label": "class SpinTestServer:\n"
                        },
                        {
                            "type": "decorated_definition",
                            "start_token": 5,
                            "end_token": 8,
                            "children": [
                                {
                                    "type": "decorator",
                                    "start_token": 5,
                                    "end_token": 6,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "start_token": 6,
                                            "end_token": 6,
                                            "children": [],
                                            "label": "staticmethod"
                                        }
                                    ],
                                    "label": "@staticmethod"
                                }
                            ],
                            "label": "@staticmethod\n\n"
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__init__",
                            "start_line": 18,
                            "end_line": 22,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 38,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 38,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "__init__"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 38,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 7,
                                                            "end_token": 13,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 7,
                                                                    "end_token": 9,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 7,
                                                                            "end_token": 7,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 9,
                                                                            "end_token": 9,
                                                                            "children": [],
                                                                            "label": "db_api"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_api"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 11,
                                                                    "end_token": 13,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 11,
                                                                            "end_token": 11,
                                                                            "children": [],
                                                                            "label": "DatabaseManager"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 12,
                                                                            "end_token": 13,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "DatabaseManager()"
                                                                }
                                                            ],
                                                            "label": "self.db_api = DatabaseManager()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 15,
                                                            "end_token": 21,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 15,
                                                                    "end_token": 17,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 15,
                                                                            "end_token": 15,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 17,
                                                                            "end_token": 17,
                                                                            "children": [],
                                                                            "label": "exec_manager"
                                                                        }
                                                                    ],
                                                                    "label": "self.exec_manager"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 19,
                                                                    "end_token": 21,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 19,
                                                                            "end_token": 19,
                                                                            "children": [],
                                                                            "label": "ExecutionManager"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 20,
                                                                            "end_token": 21,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "ExecutionManager()"
                                                                }
                                                            ],
                                                            "label": "self.exec_manager = ExecutionManager()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 23,
                                                            "end_token": 29,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 23,
                                                                    "end_token": 25,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 23,
                                                                            "end_token": 23,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 25,
                                                                            "end_token": 25,
                                                                            "children": [],
                                                                            "label": "agent_server"
                                                                        }
                                                                    ],
                                                                    "label": "self.agent_server"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 27,
                                                                    "end_token": 29,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 27,
                                                                            "end_token": 27,
                                                                            "children": [],
                                                                            "label": "AgentServer"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 28,
                                                                            "end_token": 29,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "AgentServer()"
                                                                }
                                                            ],
                                                            "label": "self.agent_server = AgentServer()"
                                                        },
                                                        {
                                                            "type": "assignment",
                                                            "start_token": 31,
                                                            "end_token": 37,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "start_token": 31,
                                                                    "end_token": 33,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 31,
                                                                            "end_token": 31,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 33,
                                                                            "end_token": 33,
                                                                            "children": [],
                                                                            "label": "scheduler"
                                                                        }
                                                                    ],
                                                                    "label": "self.scheduler"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 35,
                                                                    "end_token": 37,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 35,
                                                                            "end_token": 35,
                                                                            "children": [],
                                                                            "label": "ExecutionScheduler"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 36,
                                                                            "end_token": 37,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "ExecutionScheduler()"
                                                                }
                                                            ],
                                                            "label": "self.scheduler = ExecutionScheduler()"
                                                        }
                                                    ],
                                                    "label": "\n        self.db_api = DatabaseManager()\n        self.exec_manager = ExecutionManager()\n        self.agent_server = AgentServer()\n        self.scheduler = ExecutionScheduler()\n"
                                                }
                                            ],
                                            "label": "def __init__(self):\n        self.db_api = DatabaseManager()\n        self.exec_manager = ExecutionManager()\n        self.agent_server = AgentServer()\n        self.scheduler = ExecutionScheduler()\n"
                                        }
                                    ],
                                    "label": "def __init__(self):\n        self.db_api = DatabaseManager()\n        self.exec_manager = ExecutionManager()\n        self.agent_server = AgentServer()\n        self.scheduler = ExecutionScheduler()\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "test_get_user_id",
                            "start_line": 25,
                            "end_line": 26,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 8,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 8,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "test_get_user_id"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 3,
                                                    "children": [],
                                                    "label": "()"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 4,
                                                    "end_token": 8,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "start_token": 6,
                                                            "end_token": 7,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "start_token": 7,
                                                                    "end_token": 7,
                                                                    "children": [],
                                                                    "label": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                                                                }
                                                            ],
                                                            "label": "return \"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                                                        }
                                                    ],
                                                    "label": ":\n        return \"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\n"
                                                }
                                            ],
                                            "label": "def test_get_user_id():\n        return \"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\n"
                                        }
                                    ],
                                    "label": "def test_get_user_id():\n        return \"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__aenter__",
                            "start_line": 28,
                            "end_line": 39,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 66,
                                    "children": [
                                        {
                                            "type": "decorated_definition",
                                            "start_token": 0,
                                            "end_token": 66,
                                            "children": [
                                                {
                                                    "type": "async",
                                                    "start_token": 0,
                                                    "end_token": 0,
                                                    "children": [],
                                                    "label": "async"
                                                },
                                                {
                                                    "type": "function_definition",
                                                    "start_token": 1,
                                                    "end_token": 66,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 1,
                                                            "end_token": 1,
                                                            "children": [],
                                                            "label": "def"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 2,
                                                            "end_token": 2,
                                                            "children": [],
                                                            "label": "__aenter__"
                                                        },
                                                        {
                                                            "type": "parameters",
                                                            "start_token": 3,
                                                            "end_token": 5,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "start_token": 4,
                                                                    "end_token": 4,
                                                                    "children": [],
                                                                    "label": "self"
                                                                }
                                                            ],
                                                            "label": "(self)"
                                                        },
                                                        {
                                                            "type": "block",
                                                            "start_token": 6,
                                                            "end_token": 66,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 8,
                                                                    "end_token": 12,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 8,
                                                                            "end_token": 10,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 8,
                                                                                    "end_token": 8,
                                                                                    "children": [],
                                                                                    "label": "self"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 10,
                                                                                    "end_token": 10,
                                                                                    "children": [],
                                                                                    "label": "setup_dependency_overrides"
                                                                                }
                                                                            ],
                                                                            "label": "self.setup_dependency_overrides"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 11,
                                                                            "end_token": 12,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "self.setup_dependency_overrides()"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 14,
                                                                    "end_token": 20,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 14,
                                                                            "end_token": 18,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 14,
                                                                                    "end_token": 16,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 14,
                                                                                            "end_token": 14,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 16,
                                                                                            "end_token": 16,
                                                                                            "children": [],
                                                                                            "label": "db_api"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.db_api"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 18,
                                                                                    "end_token": 18,
                                                                                    "children": [],
                                                                                    "label": "__enter__"
                                                                                }
                                                                            ],
                                                                            "label": "self.db_api.__enter__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 19,
                                                                            "end_token": 20,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_api.__enter__()"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 22,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 22,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 22,
                                                                                    "end_token": 24,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 22,
                                                                                            "end_token": 22,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "children": [],
                                                                                            "label": "agent_server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.agent_server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "children": [],
                                                                                    "label": "__enter__"
                                                                                }
                                                                            ],
                                                                            "label": "self.agent_server.__enter__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 27,
                                                                            "end_token": 28,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "self.agent_server.__enter__()"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 30,
                                                                    "end_token": 36,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 30,
                                                                            "end_token": 34,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 30,
                                                                                    "end_token": 32,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 30,
                                                                                            "end_token": 30,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 32,
                                                                                            "end_token": 32,
                                                                                            "children": [],
                                                                                            "label": "exec_manager"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.exec_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 34,
                                                                                    "end_token": 34,
                                                                                    "children": [],
                                                                                    "label": "__enter__"
                                                                                }
                                                                            ],
                                                                            "label": "self.exec_manager.__enter__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 35,
                                                                            "end_token": 36,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "self.exec_manager.__enter__()"
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 38,
                                                                    "end_token": 44,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 38,
                                                                            "end_token": 42,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 38,
                                                                                    "end_token": 40,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 38,
                                                                                            "end_token": 38,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 40,
                                                                                            "end_token": 40,
                                                                                            "children": [],
                                                                                            "label": "scheduler"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.scheduler"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 42,
                                                                                    "end_token": 42,
                                                                                    "children": [],
                                                                                    "label": "__enter__"
                                                                                }
                                                                            ],
                                                                            "label": "self.scheduler.__enter__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 43,
                                                                            "end_token": 44,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "self.scheduler.__enter__()"
                                                                },
                                                                {
                                                                    "type": "await",
                                                                    "start_token": 47,
                                                                    "end_token": 52,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 48,
                                                                            "end_token": 52,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 48,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 48,
                                                                                            "end_token": 48,
                                                                                            "children": [],
                                                                                            "label": "db"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 50,
                                                                                            "end_token": 50,
                                                                                            "children": [],
                                                                                            "label": "connect"
                                                                                        }
                                                                                    ],
                                                                                    "label": "db.connect"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 51,
                                                                                    "end_token": 52,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "db.connect()"
                                                                        }
                                                                    ],
                                                                    "label": "await db.connect()"
                                                                },
                                                                {
                                                                    "type": "await",
                                                                    "start_token": 54,
                                                                    "end_token": 57,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 55,
                                                                            "end_token": 57,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 55,
                                                                                    "end_token": 55,
                                                                                    "children": [],
                                                                                    "label": "initialize_blocks"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 56,
                                                                                    "end_token": 57,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "initialize_blocks()"
                                                                        }
                                                                    ],
                                                                    "label": "await initialize_blocks()"
                                                                },
                                                                {
                                                                    "type": "await",
                                                                    "start_token": 59,
                                                                    "end_token": 62,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "start_token": 60,
                                                                            "end_token": 62,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 60,
                                                                                    "end_token": 60,
                                                                                    "children": [],
                                                                                    "label": "create_default_user"
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "start_token": 61,
                                                                                    "end_token": 62,
                                                                                    "children": [],
                                                                                    "label": "()"
                                                                                }
                                                                            ],
                                                                            "label": "create_default_user()"
                                                                        }
                                                                    ],
                                                                    "label": "await create_default_user()"
                                                                },
                                                                {
                                                                    "type": "return_statement",
                                                                    "start_token": 65,
                                                                    "end_token": 66,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "start_token": 66,
                                                                            "end_token": 66,
                                                                            "children": [],
                                                                            "label": "self"
                                                                        }
                                                                    ],
                                                                    "label": "return self"
                                                                }
                                                            ],
                                                            "label": ":\n        self.setup_dependency_overrides()\n        self.db_api.__enter__()\n        self.agent_server.__enter__()\n        self.exec_manager.__enter__()\n        self.scheduler.__enter__()\n\n        await db.connect()\n        await initialize_blocks()\n        await create_default_user()\n\n        return self"
                                                        }
                                                    ],
                                                    "label": "def __aenter__(self):\n        self.setup_dependency_overrides()\n        self.db_api.__enter__()\n        self.agent_server.__enter__()\n        self.exec_manager.__enter__()\n        self.scheduler.__enter__()\n\n        await db.connect()\n        await initialize_blocks()\n        await create_default_user()\n\n        return self"
                                                }
                                            ],
                                            "label": "async def __aenter__(self):\n        self.setup_dependency_overrides()\n        self.db_api.__enter__()\n        self.agent_server.__enter__()\n        self.exec_manager.__enter__()\n        self.scheduler.__enter__()\n\n        await db.connect()\n        await initialize_blocks()\n        await create_default_user()\n\n        return self"
                                        }
                                    ],
                                    "label": "async def __aenter__(self):\n        self.setup_dependency_overrides()\n        self.db_api.__enter__()\n        self.agent_server.__enter__()\n        self.exec_manager.__enter__()\n        self.scheduler.__enter__()\n\n        await db.connect()\n        await initialize_blocks()\n        await create_default_user()\n\n        return self"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "__aexit__",
                            "start_line": 41,
                            "end_line": 47,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 73,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 73,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 2,
                                                    "end_token": 2,
                                                    "children": [],
                                                    "label": "__aexit__"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 3,
                                                    "end_token": 11,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 4,
                                                            "end_token": 4,
                                                            "children": [],
                                                            "label": "self"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 6,
                                                            "end_token": 6,
                                                            "children": [],
                                                            "label": "exc_type"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 8,
                                                            "end_token": 8,
                                                            "children": [],
                                                            "label": "exc_val"
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 10,
                                                            "end_token": 10,
                                                            "children": [],
                                                            "label": "exc_tb"
                                                        }
                                                    ],
                                                    "label": "(self, exc_type, exc_val, exc_tb)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 13,
                                                    "end_token": 73,
                                                    "children": [
                                                        {
                                                            "type": "await",
                                                            "start_token": 14,
                                                            "end_token": 19,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 15,
                                                                    "end_token": 19,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 15,
                                                                            "end_token": 17,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 15,
                                                                                    "end_token": 15,
                                                                                    "children": [],
                                                                                    "label": "db"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "children": [],
                                                                                    "label": "disconnect"
                                                                                }
                                                                            ],
                                                                            "label": "db.disconnect"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 18,
                                                                            "end_token": 19,
                                                                            "children": [],
                                                                            "label": "()"
                                                                        }
                                                                    ],
                                                                    "label": "db.disconnect()"
                                                                }
                                                            ],
                                                            "label": "await db.disconnect()"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 22,
                                                            "end_token": 33,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 22,
                                                                    "end_token": 33,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 22,
                                                                            "end_token": 26,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 22,
                                                                                    "end_token": 24,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 22,
                                                                                            "end_token": 22,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 24,
                                                                                            "end_token": 24,
                                                                                            "children": [],
                                                                                            "label": "scheduler"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.scheduler"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 26,
                                                                                    "end_token": 26,
                                                                                    "children": [],
                                                                                    "label": "__exit__"
                                                                                }
                                                                            ],
                                                                            "label": "self.scheduler.__exit__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 27,
                                                                            "end_token": 33,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 28,
                                                                                    "end_token": 28,
                                                                                    "children": [],
                                                                                    "label": "exc_type"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 30,
                                                                                    "end_token": 30,
                                                                                    "children": [],
                                                                                    "label": "exc_val"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 32,
                                                                                    "end_token": 32,
                                                                                    "children": [],
                                                                                    "label": "exc_tb"
                                                                                }
                                                                            ],
                                                                            "label": "(exc_type, exc_val, exc_tb)"
                                                                        }
                                                                    ],
                                                                    "label": "self.scheduler.__exit__(exc_type, exc_val, exc_tb)"
                                                                }
                                                            ],
                                                            "label": "self.scheduler.__exit__(exc_type, exc_val, exc_tb)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 35,
                                                            "end_token": 46,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 35,
                                                                    "end_token": 46,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 35,
                                                                            "end_token": 39,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 35,
                                                                                    "end_token": 37,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 35,
                                                                                            "end_token": 35,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 37,
                                                                                            "end_token": 37,
                                                                                            "children": [],
                                                                                            "label": "exec_manager"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.exec_manager"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 39,
                                                                                    "end_token": 39,
                                                                                    "children": [],
                                                                                    "label": "__exit__"
                                                                                }
                                                                            ],
                                                                            "label": "self.exec_manager.__exit__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 40,
                                                                            "end_token": 46,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 41,
                                                                                    "end_token": 41,
                                                                                    "children": [],
                                                                                    "label": "exc_type"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 43,
                                                                                    "end_token": 43,
                                                                                    "children": [],
                                                                                    "label": "exc_val"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 45,
                                                                                    "end_token": 45,
                                                                                    "children": [],
                                                                                    "label": "exc_tb"
                                                                                }
                                                                            ],
                                                                            "label": "(exc_type, exc_val, exc_tb)"
                                                                        }
                                                                    ],
                                                                    "label": "self.exec_manager.__exit__(exc_type, exc_val, exc_tb)"
                                                                }
                                                            ],
                                                            "label": "self.exec_manager.__exit__(exc_type, exc_val, exc_tb)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 48,
                                                            "end_token": 59,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 48,
                                                                    "end_token": 59,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 48,
                                                                            "end_token": 52,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 48,
                                                                                    "end_token": 50,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 48,
                                                                                            "end_token": 48,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 50,
                                                                                            "end_token": 50,
                                                                                            "children": [],
                                                                                            "label": "agent_server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.agent_server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 52,
                                                                                    "end_token": 52,
                                                                                    "children": [],
                                                                                    "label": "__exit__"
                                                                                }
                                                                            ],
                                                                            "label": "self.agent_server.__exit__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 53,
                                                                            "end_token": 59,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 54,
                                                                                    "end_token": 54,
                                                                                    "children": [],
                                                                                    "label": "exc_type"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 56,
                                                                                    "end_token": 56,
                                                                                    "children": [],
                                                                                    "label": "exc_val"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 58,
                                                                                    "end_token": 58,
                                                                                    "children": [],
                                                                                    "label": "exc_tb"
                                                                                }
                                                                            ],
                                                                            "label": "(exc_type, exc_val, exc_tb)"
                                                                        }
                                                                    ],
                                                                    "label": "self.agent_server.__exit__(exc_type, exc_val, exc_tb)"
                                                                }
                                                            ],
                                                            "label": "self.agent_server.__exit__(exc_type, exc_val, exc_tb)"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 61,
                                                            "end_token": 72,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 61,
                                                                    "end_token": 72,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 61,
                                                                            "end_token": 65,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 61,
                                                                                    "end_token": 63,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 61,
                                                                                            "end_token": 61,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 63,
                                                                                            "end_token": 63,
                                                                                            "children": [],
                                                                                            "label": "db_api"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.db_api"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 65,
                                                                                    "end_token": 65,
                                                                                    "children": [],
                                                                                    "label": "__exit__"
                                                                                }
                                                                            ],
                                                                            "label": "self.db_api.__exit__"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 66,
                                                                            "end_token": 72,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 67,
                                                                                    "end_token": 67,
                                                                                    "children": [],
                                                                                    "label": "exc_type"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 69,
                                                                                    "end_token": 69,
                                                                                    "children": [],
                                                                                    "label": "exc_val"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 71,
                                                                                    "end_token": 71,
                                                                                    "children": [],
                                                                                    "label": "exc_tb"
                                                                                }
                                                                            ],
                                                                            "label": "(exc_type, exc_val, exc_tb)"
                                                                        }
                                                                    ],
                                                                    "label": "self.db_api.__exit__(exc_type, exc_val, exc_tb)"
                                                                }
                                                            ],
                                                            "label": "self.db_api.__exit__(exc_type, exc_val, exc_tb)"
                                                        }
                                                    ],
                                                    "label": "\n        await db.disconnect()\n\n        self.scheduler.__exit__(exc_type, exc_val, exc_tb)\n        self.exec_manager.__exit__(exc_type, exc_val, exc_tb)\n        self.agent_server.__exit__(exc_type, exc_val, exc_tb)\n        self.db_api.__exit__(exc_type, exc_val, exc_tb)\n"
                                                }
                                            ],
                                            "label": "async def __aexit__(self, exc_type, exc_val, exc_tb):\n        await db.disconnect()\n\n        self.scheduler.__exit__(exc_type, exc_val, exc_tb)\n        self.exec_manager.__exit__(exc_type, exc_val, exc_tb)\n        self.agent_server.__exit__(exc_type, exc_val, exc_tb)\n        self.db_api.__exit__(exc_type, exc_val, exc_tb)\n"
                                        }
                                    ],
                                    "label": "async def __aexit__(self, exc_type, exc_val, exc_tb):\n        await db.disconnect()\n\n        self.scheduler.__exit__(exc_type, exc_val, exc_tb)\n        self.exec_manager.__exit__(exc_type, exc_val, exc_tb)\n        self.agent_server.__exit__(exc_type, exc_val, exc_tb)\n        self.db_api.__exit__(exc_type, exc_val, exc_tb)\n"
                                }
                            ]
                        },
                        {
                            "type": "function_placeholder",
                            "name": "setup_dependency_overrides",
                            "start_line": 49,
                            "end_line": 53,
                            "children": [
                                {
                                    "type": "module",
                                    "start_token": 0,
                                    "end_token": 29,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "start_token": 0,
                                            "end_token": 28,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "start_token": 1,
                                                    "end_token": 1,
                                                    "children": [],
                                                    "label": "setup_dependency_overrides"
                                                },
                                                {
                                                    "type": "parameters",
                                                    "start_token": 2,
                                                    "end_token": 4,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "start_token": 3,
                                                            "end_token": 3,
                                                            "children": [],
                                                            "label": "self"
                                                        }
                                                    ],
                                                    "label": "(self)"
                                                },
                                                {
                                                    "type": "block",
                                                    "start_token": 6,
                                                    "end_token": 28,
                                                    "children": [
                                                        {
                                                            "type": "comment",
                                                            "start_token": 7,
                                                            "end_token": 11,
                                                            "children": [],
                                                            "label": "# Override get_user_id for testing"
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "start_token": 13,
                                                            "end_token": 28,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "start_token": 13,
                                                                    "end_token": 28,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "start_token": 13,
                                                                            "end_token": 17,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "start_token": 13,
                                                                                    "end_token": 15,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 13,
                                                                                            "end_token": 13,
                                                                                            "children": [],
                                                                                            "label": "self"
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "start_token": 15,
                                                                                            "end_token": 15,
                                                                                            "children": [],
                                                                                            "label": "agent_server"
                                                                                        }
                                                                                    ],
                                                                                    "label": "self.agent_server"
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "start_token": 17,
                                                                                    "end_token": 17,
                                                                                    "children": [],
                                                                                    "label": "set_test_dependency_overrides"
                                                                                }
                                                                            ],
                                                                            "label": "self.agent_server.set_test_dependency_overrides"
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "start_token": 18,
                                                                            "end_token": 28,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "start_token": 20,
                                                                                    "end_token": 26,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "start_token": 21,
                                                                                            "end_token": 25,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "start_token": 21,
                                                                                                    "end_token": 21,
                                                                                                    "children": [],
                                                                                                    "label": "get_user_id"
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "start_token": 23,
                                                                                                    "end_token": 25,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 23,
                                                                                                            "end_token": 23,
                                                                                                            "children": [],
                                                                                                            "label": "self"
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "start_token": 25,
                                                                                                            "end_token": 25,
                                                                                                            "children": [],
                                                                                                            "label": "test_get_user_id"
                                                                                                        }
                                                                                                    ],
                                                                                                    "label": "self.test_get_user_id"
                                                                                                }
                                                                                            ],
                                                                                            "label": "get_user_id: self.test_get_user_id"
                                                                                        }
                                                                                    ],
                                                                                    "label": "{get_user_id: self.test_get_user_id}"
                                                                                }
                                                                            ],
                                                                            "label": "(\n            {get_user_id: self.test_get_user_id}\n        )"
                                                                        }
                                                                    ],
                                                                    "label": "self.agent_server.set_test_dependency_overrides(\n            {get_user_id: self.test_get_user_id}\n        )"
                                                                }
                                                            ],
                                                            "label": "self.agent_server.set_test_dependency_overrides(\n            {get_user_id: self.test_get_user_id}\n        )"
                                                        }
                                                    ],
                                                    "label": "\n        # Override get_user_id for testing\n        self.agent_server.set_test_dependency_overrides(\n            {get_user_id: self.test_get_user_id}\n        )"
                                                }
                                            ],
                                            "label": "def setup_dependency_overrides(self):\n        # Override get_user_id for testing\n        self.agent_server.set_test_dependency_overrides(\n            {get_user_id: self.test_get_user_id}\n        )"
                                        }
                                    ],
                                    "label": "def setup_dependency_overrides(self):\n        # Override get_user_id for testing\n        self.agent_server.set_test_dependency_overrides(\n            {get_user_id: self.test_get_user_id}\n        )\n"
                                }
                            ]
                        }
                    ],
                    "label": "class SpinTestServer:\n\n    @staticmethod\n\n\n\n\n"
                }
            ]
        }
    ],
    "label": "import logging\nimport time\nfrom typing import Sequence\n\nfrom backend.data import db\nfrom backend.data.block import Block, initialize_blocks\nfrom backend.data.execution import ExecutionResult, ExecutionStatus\nfrom backend.data.model import CREDENTIALS_FIELD_NAME\nfrom backend.data.user import create_default_user\nfrom backend.executor import DatabaseManager, ExecutionManager, ExecutionScheduler\nfrom backend.server.rest_api import AgentServer\nfrom backend.server.utils import get_user_id\n\nlog = logging.getLogger(__name__)"
}
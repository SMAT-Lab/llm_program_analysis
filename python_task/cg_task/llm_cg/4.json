{
    "main": [],
    "LogMetadata": [],
    "LogMetadata.info": [
        "self._wrap",
        "logger.info"
    ],
    "LogMetadata.warning": [
        "self._wrap",
        "logger.warning"
    ],
    "LogMetadata.error": [
        "self._wrap",
        "logger.error"
    ],
    "LogMetadata.debug": [
        "self._wrap",
        "logger.debug"
    ],
    "LogMetadata.exception": [
        "self._wrap",
        "logger.exception"
    ],
    "LogMetadata._wrap": [],
    "execute_node": [
        "db_client.update_execution_status",
        "db_client.send_execution_update",
        "db_client.get_node",
        "get_block",
        "logger.error",
        "LogMetadata",
        "validate_exec",
        "db_client.upsert_execution_output",
        "update_execution",
        "isinstance",
        "json.dumps",
        "len",
        "log_metadata.info",
        "update_execution",
        "creds_manager.acquire",
        "ExecutionStatus",
        "db_client.get_or_refill_credit",
        "ValueError",
        "node_block.execute",
        "json.dumps",
        "len",
        "log_metadata.info",
        "db_client.upsert_execution_output",
        "_enqueue_next_nodes",
        "update_execution",
        "ExecutionStatus",
        "str",
        "log_metadata.exception",
        "db_client.upsert_execution_output",
        "_enqueue_next_nodes",
        "update_execution",
        "creds_lock.release",
        "log_metadata.error",
        "update_execution",
        "ExecutionStatus",
        "int",
        "res.end_time",
        "res.start_time",
        "res.end_time",
        "res.start_time",
        "res.end_time - res.start_time",
        "db_client.spend_credits"
    ],
    "_enqueue_next_nodes": [
        "db_client.update_execution_status",
        "db_client.send_execution_update",
        "NodeExecutionEntry",
        "parse_execution_output",
        "db_client.get_node",
        "synchronized",
        "db_client.upsert_execution_input",
        "set",
        "getattr",
        "db_client.get_latest_execution",
        "validate_exec",
        "log_metadata.warning",
        "log_metadata.info",
        "add_enqueued_execution",
        "ExecutionStatus",
        "list"
    ],
    "validate_exec": [
        "get_block",
        "isinstance",
        "tuple",
        "Block.__annotations__",
        "set",
        "getattr",
        "list",
        "str",
        "convert",
        "Block.input_schema.jsonschema",
        "Block.input_schema.get_required_fields",
        "node.input_default",
        "dict.get",
        "setattr",
        "list",
        "set",
        "merge_execution_input",
        "json.validate_with_jsonschema",
        "logger.error",
        "tuple"
    ],
    "Executor": [],
    "Executor.on_node_executor_start": [
        "configure_logging",
        "set_service_name",
        "redis.connect",
        "os.getpid",
        "get_db_client",
        "IntegrationCredentialsManager",
        "atexit.register",
        "signal.signal"
    ],
    "Executor.on_node_executor_stop": [
        "cls.shutdown_lock.acquire",
        "logger.info",
        "cls.creds_manager.release_all_locks",
        "logger.info",
        "redis.disconnect",
        "logger.info",
        "close_service_client",
        "logger.info"
    ],
    "Executor.on_node_executor_sigterm": [
        "llprint",
        "cls.shutdown_lock.acquire",
        "llprint",
        "cls.creds_manager.release_all_locks",
        "llprint",
        "redis.disconnect",
        "llprint",
        "sys.exit"
    ],
    "Executor.on_node_execution": [
        "LogMetadata",
        "cls._on_node_execution",
        "cls.db_client.update_node_execution_stats",
        "dict"
    ],
    "Executor._on_node_execution": [
        "log_metadata.info",
        "execute_node",
        "q.add",
        "log_metadata.info",
        "log_metadata.exception"
    ],
    "Executor.on_graph_executor_start": [
        "configure_logging",
        "set_service_name",
        "get_db_client",
        "Pool",
        "settings.config.num_node_workers",
        "os.getpid",
        "logger.info",
        "atexit.register"
    ],
    "Executor.on_graph_executor_stop": [
        "logger.info",
        "cls.executor.terminate",
        "logger.info",
        "close_service_client",
        "logger.info"
    ],
    "Executor._init_node_executor_pool": [
        "Pool"
    ],
    "Executor.on_graph_execution": [
        "LogMetadata",
        "cls._on_graph_execution",
        "cls.db_client.update_graph_execution_stats",
        "cls.db_client.send_execution_update"
    ],
    "Executor._on_graph_execution": [
        "log_metadata.info",
        "dict",
        "float",
        "queue.Queue",
        "threading.Thread",
        "cancel_thread.start",
        "queue.Queue",
        "queue.Queue",
        "getattr",
        "db_client.get_node",
        "logger.info",
        "cancel_thread.join",
        "threading.Thread.join",
        "db_client.get_incomplete_executions",
        "list",
        "log_metadata.info",
        "log_metadata.exception"
    ],
    "ExecutionManager": [],
    "ExecutionManager.__init__": [
        "super().__init__",
        "settings.config.num_graph_workers",
        "ExecutionQueue"
    ],
    "ExecutionManager.get_port": [
        "settings.config.execution_manager_port"
    ],
    "ExecutionManager.run_service": [
        "IntegrationCredentialsStore",
        "ProcessPoolExecutor",
        "multiprocessing.Manager",
        "logger.info",
        "self.queue.get",
        "self.executor.submit",
        "exec_result.graph_exec_id",
        "self.active_graph_runs.pop",
        "self.active_graph_runs.pop"
    ],
    "ExecutionManager.cleanup": [
        "logger.info",
        "self.executor.shutdown",
        "super().cleanup"
    ],
    "ExecutionManager.db_client": [
        "get_db_client"
    ],
    "ExecutionManager.add_execution": [
        "self.db_client.get_graph",
        "graph.validate_graph",
        "self._validate_node_input_credentials",
        "list.append",
        "get_block",
        "validate_exec",
        "create_graph_execution",
        "self.db_client.update_execution_status",
        "self.db_client.send_execution_update",
        "list.append",
        "self.queue.add"
    ],
    "ExecutionManager.cancel_execution": [
        "setattr",
        "self.db_client.get_execution_results",
        "ExecutionStatus",
        "self.db_client.upsert_execution_output",
        "self.db_client.update_execution_status",
        "self.db_client.send_execution_update"
    ],
    "ExecutionManager._validate_node_input_credentials": [
        "get_block",
        "CredentialsMetaInput.model_validate",
        "self.credentials_store.get_creds_by_id",
        "logger.warning",
        "ValueError"
    ],
    "get_db_client": [
        "get_service_client"
    ],
    "synchronized": [
        "redis.get_redis",
        "redis.get_redis",
        "yield",
        "lock.release",
        "if"
    ],
    "llprint": [
        "logger.getEffectiveLevel",
        "sys.stdout.fileno",
        "os.write"
    ]
}
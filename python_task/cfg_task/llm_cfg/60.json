[
  {
    "decl_name": "GlobalBlock",
    "start_line": 0,
    "end_line": 17,
    "children": [],
    "code": "import json\nimport os\nfrom enum import Enum\nfrom typing import Any, Dict, Generic, List, Set, Tuple, Type, TypeVar\n\nfrom pydantic import BaseModel, Field, PrivateAttr, ValidationInfo, field_validator\nfrom pydantic_settings import (\n    BaseSettings,\n    JsonConfigSettingsSource,\n    PydanticBaseSettingsSource,\n    SettingsConfigDict,\n)\n\nfrom backend.util.data import get_data_path\n\nT = TypeVar(\"T\", bound=BaseSettings)\n\n\n",
    "cfg": {
      "nodes": [
        {
          "id": "GlobalBlock_1",
          "code": "import json\nimport os\nfrom enum import Enum\nfrom typing import Any, Dict, Generic, List, Set, Tuple, Type, TypeVar\n\n"
        },
        {
          "id": "GlobalBlock_2",
          "code": "from pydantic import BaseModel, Field, PrivateAttr, ValidationInfo, field_validator\nfrom pydantic_settings import (\n    BaseSettings,\n    JsonConfigSettingsSource,\n    PydanticBaseSettingsSource,\n    SettingsConfigDict,\n)\n"
        },
        {
          "id": "GlobalBlock_3",
          "code": "\nfrom backend.util.data import get_data_path\n\n"
        },
        {
          "id": "GlobalBlock_4",
          "code": "T = TypeVar(\"T\", bound=BaseSettings)\n"
        }
      ],
      "edges": [
        {
          "from": "GlobalBlock_1",
          "to": "GlobalBlock_2"
        },
        {
          "from": "GlobalBlock_2",
          "to": "GlobalBlock_3"
        },
        {
          "from": "GlobalBlock_3",
          "to": "GlobalBlock_4"
        }
      ]
    }
  },
  {
    "decl_name": "AppEnvironment",
    "start_line": 18,
    "end_line": 21,
    "children": [],
    "code": "class AppEnvironment(str, Enum):\n    LOCAL = \"local\"\n    DEVELOPMENT = \"dev\"\n    PRODUCTION = \"prod\"\n",
    "cfg": {
      "nodes": [
        {
          "id": "AppEnvironment_1",
          "code": "class AppEnvironment(str, Enum):\n    LOCAL = \"local\"\n    DEVELOPMENT = \"dev\"\n    PRODUCTION = \"prod\"\n"
        }
      ],
      "edges": []
    }
  },
  {
    "decl_name": "BehaveAs",
    "start_line": 24,
    "end_line": 26,
    "children": [],
    "code": "class BehaveAs(str, Enum):\n    LOCAL = \"local\"\n    CLOUD = \"cloud\"\n",
    "cfg": {
      "nodes": [
        {
          "id": "BehaveAs_1",
          "code": "class BehaveAs(str, Enum):\n    LOCAL = \"local\"\n    CLOUD = \"cloud\"\n"
        }
      ],
      "edges": []
    }
  },
  {
    "decl_name": "UpdateTrackingModel",
    "start_line": 29,
    "end_line": 49,
    "children": [
      {
        "decl_name": "UpdateTrackingModel.__setattr__",
        "start_line": 32,
        "end_line": 35,
        "children": [],
        "code": "    def __setattr__(self, name: str, value) -> None:\n        if name in self.model_fields:\n            self._updated_fields.add(name)\n        super().__setattr__(name, value)\n",
        "cfg": {
          "nodes": [
            {
              "id": "UpdateTrackingModel.__setattr___1",
              "code": "def __setattr__(self, name: str, value) -> None:\n"
            },
            {
              "id": "UpdateTrackingModel.__setattr___2",
              "code": "        if name in self.model_fields:\n            self._updated_fields.add(name)\n"
            },
            {
              "id": "UpdateTrackingModel.__setattr___3",
              "code": "        super().__setattr__(name, value)\n"
            }
          ],
          "edges": [
            {
              "from": "UpdateTrackingModel.__setattr___1",
              "to": "UpdateTrackingModel.__setattr___2"
            },
            {
              "from": "UpdateTrackingModel.__setattr___2",
              "to": "UpdateTrackingModel.__setattr___3"
            }
          ]
        }
      },
      {
        "decl_name": "UpdateTrackingModel.mark_updated",
        "start_line": 37,
        "end_line": 39,
        "children": [],
        "code": "    def mark_updated(self, field_name: str) -> None:\n        if field_name in self.model_fields:\n            self._updated_fields.add(field_name)\n",
        "cfg": {
          "nodes": [
            {
              "id": "UpdateTrackingModel.mark_updated_1",
              "code": "def mark_updated(self, field_name: str) -> None:\n"
            },
            {
              "id": "UpdateTrackingModel.mark_updated_2",
              "code": "        if field_name in self.model_fields:\n            self._updated_fields.add(field_name)\n"
            }
          ],
          "edges": [
            {
              "from": "UpdateTrackingModel.mark_updated_1",
              "to": "UpdateTrackingModel.mark_updated_2"
            }
          ]
        }
      },
      {
        "decl_name": "UpdateTrackingModel.clear_updates",
        "start_line": 41,
        "end_line": 42,
        "children": [],
        "code": "    def clear_updates(self) -> None:\n        self._updated_fields.clear()\n",
        "cfg": {
          "nodes": [
            {
              "id": "UpdateTrackingModel.clear_updates_1",
              "code": "def clear_updates(self) -> None:\n        self._updated_fields.clear()\n"
            }
          ],
          "edges": []
        }
      },
      {
        "decl_name": "UpdateTrackingModel.get_updates",
        "start_line": 44,
        "end_line": 45,
        "children": [],
        "code": "    def get_updates(self) -> Dict[str, Any]:\n        return {field: getattr(self, field) for field in self._updated_fields}\n",
        "cfg": {
          "nodes": [
            {
              "id": "UpdateTrackingModel.get_updates_1",
              "code": "def get_updates(self) -> Dict[str, Any]:\n        return {field: getattr(self, field) for field in self._updated_fields}\n"
            }
          ],
          "edges": []
        }
      },
      {
        "decl_name": "UpdateTrackingModel.updated_fields",
        "start_line": 48,
        "end_line": 49,
        "children": [],
        "code": "    def updated_fields(self):\n        return self._updated_fields\n",
        "cfg": {
          "nodes": [
            {
              "id": "UpdateTrackingModel.updated_fields_1",
              "code": "def updated_fields(self):\n        return self._updated_fields\n"
            }
          ],
          "edges": []
        }
      }
    ],
    "code": "class UpdateTrackingModel(BaseModel, Generic[T]):\n    _updated_fields: Set[str] = PrivateAttr(default_factory=set)\n\n\n\n\n\n    @property\n",
    "cfg": {
      "nodes": [
        {
          "id": "UpdateTrackingModel_1",
          "code": "class UpdateTrackingModel(BaseModel, Generic[T]):\n    _updated_fields: Set[str] = PrivateAttr(default_factory=set)\n"
        },
        {
          "id": "UpdateTrackingModel_2",
          "code": "    @property\n"
        }
      ],
      "edges": [
        {
          "from": "UpdateTrackingModel_1",
          "to": "UpdateTrackingModel_2"
        }
      ]
    }
  },
  {
    "decl_name": "Config",
    "start_line": 52,
    "end_line": 232,
    "children": [
      {
        "decl_name": "Config.validate_platform_base_url",
        "start_line": 157,
        "end_line": 167,
        "children": [],
        "code": "    def validate_platform_base_url(cls, v: str, info: ValidationInfo) -> str:\n        if not v:\n            return v\n        if not v.startswith((\"http://\", \"https://\")):\n            raise ValueError(\n                f\"{info.field_name} must be a full URL \"\n                \"including a http:// or https:// schema\"\n            )\n        if v.endswith(\"/\"):\n            return v.rstrip(\"/\")  # Remove trailing slash\n        return v\n",
        "cfg": {
          "nodes": [
            {
              "id": "Config.validate_platform_base_url_1",
              "code": "def validate_platform_base_url(cls, v: str, info: ValidationInfo) -> str:\n"
            },
            {
              "id": "Config.validate_platform_base_url_2",
              "code": "        if not v:\n            return v\n"
            },
            {
              "id": "Config.validate_platform_base_url_3",
              "code": "        if not v.startswith((\"http://\", \"https://\")):\n            raise ValueError(\n                f\"{info.field_name} must be a full URL \"\n                \"including a http:// or https:// schema\"\n            )\n"
            },
            {
              "id": "Config.validate_platform_base_url_4",
              "code": "        if v.endswith(\"/\"):\n            return v.rstrip(\"/\")  # Remove trailing slash\n"
            },
            {
              "id": "Config.validate_platform_base_url_5",
              "code": "        return v\n"
            }
          ],
          "edges": [
            {
              "from": "Config.validate_platform_base_url_1",
              "to": "Config.validate_platform_base_url_2"
            },
            {
              "from": "Config.validate_platform_base_url_2",
              "to": "Config.validate_platform_base_url_3"
            },
            {
              "from": "Config.validate_platform_base_url_2",
              "to": "Config.validate_platform_base_url_5"
            },
            {
              "from": "Config.validate_platform_base_url_3",
              "to": "Config.validate_platform_base_url_4"
            },
            {
              "from": "Config.validate_platform_base_url_3",
              "to": "Config.validate_platform_base_url_5"
            },
            {
              "from": "Config.validate_platform_base_url_4",
              "to": "Config.validate_platform_base_url_5"
            }
          ]
        }
      },
      {
        "decl_name": "Config.validate_cors_allow_origins",
        "start_line": 193,
        "end_line": 216,
        "children": [],
        "code": "    def validate_cors_allow_origins(cls, v: List[str]) -> List[str]:\n        out = []\n        port = None\n        has_localhost = False\n        has_127_0_0_1 = False\n        for url in v:\n            url = url.strip()\n            if url.startswith((\"http://\", \"https://\")):\n                if \"localhost\" in url:\n                    port = url.split(\":\")[2]\n                    has_localhost = True\n                if \"127.0.0.1\" in url:\n                    port = url.split(\":\")[2]\n                    has_127_0_0_1 = True\n                out.append(url)\n            else:\n                raise ValueError(f\"Invalid URL: {url}\")\n\n        if has_127_0_0_1 and not has_localhost:\n            out.append(f\"http://localhost:{port}\")\n        if has_localhost and not has_127_0_0_1:\n            out.append(f\"http://127.0.0.1:{port}\")\n\n        return out\n",
        "cfg": {
          "nodes": [
            {
              "id": "Config.validate_cors_allow_origins_1",
              "code": "def validate_cors_allow_origins(cls, v: List[str]) -> List[str]:\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_2",
              "code": "        out = []\n        port = None\n        has_localhost = False\n        has_127_0_0_1 = False\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_3",
              "code": "        for url in v:\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_4",
              "code": "            url = url.strip()\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_5",
              "code": "            if url.startswith((\"http://\", \"https://\")):\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_6",
              "code": "                if \"localhost\" in url:\n                    port = url.split(\":\")[2]\n                    has_localhost = True\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_7",
              "code": "                if \"127.0.0.1\" in url:\n                    port = url.split(\":\")[2]\n                    has_127_0_0_1 = True\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_8",
              "code": "                out.append(url)\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_9",
              "code": "            else:\n                raise ValueError(f\"Invalid URL: {url}\")\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_10",
              "code": "        if has_127_0_0_1 and not has_localhost:\n            out.append(f\"http://localhost:{port}\")\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_11",
              "code": "        if has_localhost and not has_127_0_0_1:\n            out.append(f\"http://127.0.0.1:{port}\")\n"
            },
            {
              "id": "Config.validate_cors_allow_origins_12",
              "code": "        return out\n"
            }
          ],
          "edges": [
            {
              "from": "Config.validate_cors_allow_origins_1",
              "to": "Config.validate_cors_allow_origins_2"
            },
            {
              "from": "Config.validate_cors_allow_origins_2",
              "to": "Config.validate_cors_allow_origins_3"
            },
            {
              "from": "Config.validate_cors_allow_origins_3",
              "to": "Config.validate_cors_allow_origins_4"
            },
            {
              "from": "Config.validate_cors_allow_origins_4",
              "to": "Config.validate_cors_allow_origins_5"
            },
            {
              "from": "Config.validate_cors_allow_origins_5",
              "to": "Config.validate_cors_allow_origins_6"
            },
            {
              "from": "Config.validate_cors_allow_origins_5",
              "to": "Config.validate_cors_allow_origins_9"
            },
            {
              "from": "Config.validate_cors_allow_origins_6",
              "to": "Config.validate_cors_allow_origins_7"
            },
            {
              "from": "Config.validate_cors_allow_origins_7",
              "to": "Config.validate_cors_allow_origins_8"
            },
            {
              "from": "Config.validate_cors_allow_origins_8",
              "to": "Config.validate_cors_allow_origins_3"
            },
            {
              "from": "Config.validate_cors_allow_origins_10",
              "to": "Config.validate_cors_allow_origins_11"
            },
            {
              "from": "Config.validate_cors_allow_origins_11",
              "to": "Config.validate_cors_allow_origins_12"
            }
          ]
        }
      },
      {
        "decl_name": "Config.settings_customise_sources",
        "start_line": 219,
        "end_line": 232,
        "children": [],
        "code": "    def settings_customise_sources(\n        cls,\n        settings_cls: Type[BaseSettings],\n        init_settings: PydanticBaseSettingsSource,\n        env_settings: PydanticBaseSettingsSource,\n        dotenv_settings: PydanticBaseSettingsSource,\n        file_secret_settings: PydanticBaseSettingsSource,\n    ) -> Tuple[PydanticBaseSettingsSource, ...]:\n        return (\n            env_settings,\n            file_secret_settings,\n            dotenv_settings,\n            JsonConfigSettingsSource(settings_cls),\n            init_settings,\n",
        "cfg": {
          "nodes": [
            {
              "id": "Config.settings_customise_sources_1",
              "code": "def settings_customise_sources(\n        cls,\n        settings_cls: Type[BaseSettings],\n        init_settings: PydanticBaseSettingsSource,\n        env_settings: PydanticBaseSettingsSource,\n        dotenv_settings: PydanticBaseSettingsSource,\n        file_secret_settings: PydanticBaseSettingsSource,\n    ) -> Tuple[PydanticBaseSettingsSource, ...]:\n"
            },
            {
              "id": "Config.settings_customise_sources_2",
              "code": "        return (\n            env_settings,\n            file_secret_settings,\n            dotenv_settings,\n            JsonConfigSettingsSource(settings_cls),\n            init_settings,\n"
            }
          ],
          "edges": [
            {
              "from": "Config.settings_customise_sources_1",
              "to": "Config.settings_customise_sources_2"
            }
          ]
        }
      }
    ],
    "code": "class Config(UpdateTrackingModel[\"Config\"], BaseSettings):\n    \"\"\"Config for the server.\"\"\"\n\n    num_graph_workers: int = Field(\n        default=10,\n        ge=1,\n        le=1000,\n        description=\"Maximum number of workers to use for graph execution.\",\n    )\n    num_node_workers: int = Field(\n        default=5,\n        ge=1,\n        le=1000,\n        description=\"Maximum number of workers to use for node execution within a single graph.\",\n    )\n    pyro_host: str = Field(\n        default=\"localhost\",\n        description=\"The default hostname of the Pyro server.\",\n    )\n    pyro_client_comm_timeout: float = Field(\n        default=15,\n        description=\"The default timeout in seconds, for Pyro client connections.\",\n    )\n    pyro_client_comm_retry: int = Field(\n        default=3,\n        description=\"The default number of retries for Pyro client connections.\",\n    )\n    enable_auth: bool = Field(\n        default=True,\n        description=\"If authentication is enabled or not\",\n    )\n    enable_credit: str = Field(\n        default=\"false\",\n        description=\"If user credit system is enabled or not\",\n    )\n    num_user_credits_refill: int = Field(\n        default=1500,\n        description=\"Number of credits to refill for each user\",\n    )\n    # Add more configuration fields as needed\n\n    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        extra=\"allow\",\n    )\n\n    websocket_server_host: str = Field(\n        default=\"0.0.0.0\",\n        description=\"The host for the websocket server to run on\",\n    )\n\n    websocket_server_port: int = Field(\n        default=8001,\n        description=\"The port for the websocket server to run on\",\n    )\n\n    execution_manager_port: int = Field(\n        default=8002,\n        description=\"The port for execution manager daemon to run on\",\n    )\n\n    execution_scheduler_port: int = Field(\n        default=8003,\n        description=\"The port for execution scheduler daemon to run on\",\n    )\n\n    agent_server_port: int = Field(\n        default=8004,\n        description=\"The port for agent server daemon to run on\",\n    )\n\n    database_api_port: int = Field(\n        default=8005,\n        description=\"The port for database server API to run on\",\n    )\n\n    agent_api_host: str = Field(\n        default=\"0.0.0.0\",\n        description=\"The host for agent server API to run on\",\n    )\n\n    agent_api_port: int = Field(\n        default=8006,\n        description=\"The port for agent server API to run on\",\n    )\n\n    platform_base_url: str = Field(\n        default=\"\",\n        description=\"Must be set so the application knows where it's hosted at. \"\n        \"This is necessary to make sure webhooks find their way.\",\n    )\n\n    frontend_base_url: str = Field(\n        default=\"\",\n        description=\"Can be used to explicitly set the base URL for the frontend. \"\n        \"This value is then used to generate redirect URLs for OAuth flows.\",\n    )\n\n    media_gcs_bucket_name: str = Field(\n        default=\"\",\n        description=\"The name of the Google Cloud Storage bucket for media files\",\n    )\n\n    @field_validator(\"platform_base_url\", \"frontend_base_url\")\n    @classmethod\n\n    app_env: AppEnvironment = Field(\n        default=AppEnvironment.LOCAL,\n        description=\"The name of the app environment: local or dev or prod\",\n    )\n\n    behave_as: BehaveAs = Field(\n        default=BehaveAs.LOCAL,\n        description=\"What environment to behave as: local or cloud\",\n    )\n\n    execution_event_bus_name: str = Field(\n        default=\"execution_event\",\n        description=\"Name of the event bus\",\n    )\n\n    trust_endpoints_for_requests: List[str] = Field(\n        default_factory=list,\n        description=\"A whitelist of trusted internal endpoints for the backend to make requests to.\",\n    )\n\n    backend_cors_allow_origins: List[str] = Field(default_factory=list)\n\n    @field_validator(\"backend_cors_allow_origins\")\n    @classmethod\n\n    @classmethod\n",
    "cfg": {
      "nodes": [
        {
          "id": "Config_1",
          "code": "class Config(UpdateTrackingModel[\"Config\"], BaseSettings):\n    \"\"\"Config for the server.\"\"\"\n\n"
        },
        {
          "id": "Config_2",
          "code": "    num_graph_workers: int = Field(\n        default=10,\n        ge=1,\n        le=1000,\n        description=\"Maximum number of workers to use for graph execution.\",\n    )\n"
        },
        {
          "id": "Config_3",
          "code": "    num_node_workers: int = Field(\n        default=5,\n        ge=1,\n        le=1000,\n        description=\"Maximum number of workers to use for node execution within a single graph.\",\n    )\n"
        },
        {
          "id": "Config_4",
          "code": "    pyro_host: str = Field(\n        default=\"localhost\",\n        description=\"The default hostname of the Pyro server.\",\n    )\n"
        },
        {
          "id": "Config_5",
          "code": "    pyro_client_comm_timeout: float = Field(\n        default=15,\n        description=\"The default timeout in seconds, for Pyro client connections.\",\n    )\n"
        },
        {
          "id": "Config_6",
          "code": "    pyro_client_comm_retry: int = Field(\n        default=3,\n        description=\"The default number of retries for Pyro client connections.\",\n    )\n"
        },
        {
          "id": "Config_7",
          "code": "    enable_auth: bool = Field(\n        default=True,\n        description=\"If authentication is enabled or not\",\n    )\n"
        },
        {
          "id": "Config_8",
          "code": "    enable_credit: str = Field(\n        default=\"false\",\n        description=\"If user credit system is enabled or not\",\n    )\n"
        },
        {
          "id": "Config_9",
          "code": "    num_user_credits_refill: int = Field(\n        default=1500,\n        description=\"Number of credits to refill for each user\",\n    )\n"
        },
        {
          "id": "Config_10",
          "code": "    # Add more configuration fields as needed\n\n"
        },
        {
          "id": "Config_11",
          "code": "    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        extra=\"allow\",\n    )\n"
        },
        {
          "id": "Config_12",
          "code": "\n"
        },
        {
          "id": "Config_13",
          "code": "    websocket_server_host: str = Field(\n        default=\"0.0.0.0\",\n        description=\"The host for the websocket server to run on\",\n    )\n"
        },
        {
          "id": "Config_14",
          "code": "\n"
        },
        {
          "id": "Config_15",
          "code": "    websocket_server_port: int = Field(\n        default=8001,\n        description=\"The port for the websocket server to run on\",\n    )\n"
        },
        {
          "id": "Config_16",
          "code": "\n"
        },
        {
          "id": "Config_17",
          "code": "    execution_manager_port: int = Field(\n        default=8002,\n        description=\"The port for execution manager daemon to run on\",\n    )\n"
        },
        {
          "id": "Config_18",
          "code": "\n"
        },
        {
          "id": "Config_19",
          "code": "    execution_scheduler_port: int = Field(\n        default=8003,\n        description=\"The port for execution scheduler daemon to run on\",\n    )\n"
        },
        {
          "id": "Config_20",
          "code": "\n"
        },
        {
          "id": "Config_21",
          "code": "    agent_server_port: int = Field(\n        default=8004,\n        description=\"The port for agent server daemon to run on\",\n    )\n"
        },
        {
          "id": "Config_22",
          "code": "\n"
        },
        {
          "id": "Config_23",
          "code": "    database_api_port: int = Field(\n        default=8005,\n        description=\"The port for database server API to run on\",\n    )\n"
        },
        {
          "id": "Config_24",
          "code": "\n"
        },
        {
          "id": "Config_25",
          "code": "    agent_api_host: str = Field(\n        default=\"0.0.0.0\",\n        description=\"The host for agent server API to run on\",\n    )\n"
        },
        {
          "id": "Config_26",
          "code": "\n"
        },
        {
          "id": "Config_27",
          "code": "    agent_api_port: int = Field(\n        default=8006,\n        description=\"The port for agent server API to run on\",\n    )\n"
        },
        {
          "id": "Config_28",
          "code": "\n"
        },
        {
          "id": "Config_29",
          "code": "    platform_base_url: str = Field(\n        default=\"\",\n        description=\"Must be set so the application knows where it's hosted at. \"\n        \"This is necessary to make sure webhooks find their way.\",\n    )\n"
        },
        {
          "id": "Config_30",
          "code": "\n"
        },
        {
          "id": "Config_31",
          "code": "    frontend_base_url: str = Field(\n        default=\"\",\n        description=\"Can be used to explicitly set the base URL for the frontend. \"\n        \"This value is then used to generate redirect URLs for OAuth flows.\",\n    )\n"
        },
        {
          "id": "Config_32",
          "code": "\n"
        },
        {
          "id": "Config_33",
          "code": "    media_gcs_bucket_name: str = Field(\n        default=\"\",\n        description=\"The name of the Google Cloud Storage bucket for media files\",\n    )\n"
        },
        {
          "id": "Config_34",
          "code": "\n"
        },
        {
          "id": "Config_35",
          "code": "    @field_validator(\"platform_base_url\", \"frontend_base_url\")\n    @classmethod\n\n"
        },
        {
          "id": "Config_36",
          "code": "    app_env: AppEnvironment = Field(\n        default=AppEnvironment.LOCAL,\n        description=\"The name of the app environment: local or dev or prod\",\n    )\n"
        },
        {
          "id": "Config_37",
          "code": "\n"
        },
        {
          "id": "Config_38",
          "code": "    behave_as: BehaveAs = Field(\n        default=BehaveAs.LOCAL,\n        description=\"What environment to behave as: local or cloud\",\n    )\n"
        },
        {
          "id": "Config_39",
          "code": "\n"
        },
        {
          "id": "Config_40",
          "code": "    execution_event_bus_name: str = Field(\n        default=\"execution_event\",\n        description=\"Name of the event bus\",\n    )\n"
        },
        {
          "id": "Config_41",
          "code": "\n"
        },
        {
          "id": "Config_42",
          "code": "    trust_endpoints_for_requests: List[str] = Field(\n        default_factory=list,\n        description=\"A whitelist of trusted internal endpoints for the backend to make requests to.\",\n    )\n"
        },
        {
          "id": "Config_43",
          "code": "\n"
        },
        {
          "id": "Config_44",
          "code": "    backend_cors_allow_origins: List[str] = Field(default_factory=list)\n\n"
        },
        {
          "id": "Config_45",
          "code": "    @field_validator(\"backend_cors_allow_origins\")\n    @classmethod\n\n"
        },
        {
          "id": "Config_46",
          "code": "    @classmethod\n"
        }
      ],
      "edges": [
        {
          "from": "Config_1",
          "to": "Config_2"
        },
        {
          "from": "Config_2",
          "to": "Config_3"
        },
        {
          "from": "Config_3",
          "to": "Config_4"
        },
        {
          "from": "Config_4",
          "to": "Config_5"
        },
        {
          "from": "Config_5",
          "to": "Config_6"
        },
        {
          "from": "Config_6",
          "to": "Config_7"
        },
        {
          "from": "Config_7",
          "to": "Config_8"
        },
        {
          "from": "Config_8",
          "to": "Config_9"
        },
        {
          "from": "Config_9",
          "to": "Config_10"
        },
        {
          "from": "Config_10",
          "to": "Config_11"
        },
        {
          "from": "Config_11",
          "to": "Config_12"
        },
        {
          "from": "Config_12",
          "to": "Config_13"
        },
        {
          "from": "Config_13",
          "to": "Config_14"
        },
        {
          "from": "Config_14",
          "to": "Config_15"
        },
        {
          "from": "Config_15",
          "to": "Config_16"
        },
        {
          "from": "Config_16",
          "to": "Config_17"
        },
        {
          "from": "Config_17",
          "to": "Config_18"
        },
        {
          "from": "Config_18",
          "to": "Config_19"
        },
        {
          "from": "Config_19",
          "to": "Config_20"
        },
        {
          "from": "Config_20",
          "to": "Config_21"
        },
        {
          "from": "Config_21",
          "to": "Config_22"
        },
        {
          "from": "Config_22",
          "to": "Config_23"
        },
        {
          "from": "Config_23",
          "to": "Config_24"
        },
        {
          "from": "Config_24",
          "to": "Config_25"
        },
        {
          "from": "Config_25",
          "to": "Config_26"
        },
        {
          "from": "Config_26",
          "to": "Config_27"
        },
        {
          "from": "Config_27",
          "to": "Config_28"
        },
        {
          "from": "Config_28",
          "to": "Config_29"
        },
        {
          "from": "Config_29",
          "to": "Config_30"
        },
        {
          "from": "Config_30",
          "to": "Config_31"
        },
        {
          "from": "Config_31",
          "to": "Config_32"
        },
        {
          "from": "Config_32",
          "to": "Config_33"
        },
        {
          "from": "Config_33",
          "to": "Config_34"
        },
        {
          "from": "Config_34",
          "to": "Config_35"
        },
        {
          "from": "Config_35",
          "to": "Config_36"
        },
        {
          "from": "Config_36",
          "to": "Config_37"
        },
        {
          "from": "Config_37",
          "to": "Config_38"
        },
        {
          "from": "Config_38",
          "to": "Config_39"
        },
        {
          "from": "Config_39",
          "to": "Config_40"
        },
        {
          "from": "Config_40",
          "to": "Config_41"
        },
        {
          "from": "Config_41",
          "to": "Config_42"
        },
        {
          "from": "Config_42",
          "to": "Config_43"
        },
        {
          "from": "Config_43",
          "to": "Config_44"
        },
        {
          "from": "Config_44",
          "to": "Config_45"
        },
        {
          "from": "Config_45",
          "to": "Config_46"
        }
      ]
    }
  },
  {
    "decl_name": "Secrets",
    "start_line": 236,
    "end_line": 305,
    "children": [],
    "code": "class Secrets(UpdateTrackingModel[\"Secrets\"], BaseSettings):\n    \"\"\"Secrets for the server.\"\"\"\n\n    supabase_url: str = Field(default=\"\", description=\"Supabase URL\")\n    supabase_service_role_key: str = Field(\n        default=\"\", description=\"Supabase service role key\"\n    )\n\n    encryption_key: str = Field(default=\"\", description=\"Encryption key\")\n\n    # OAuth server credentials for integrations\n    # --8<-- [start:OAuthServerCredentialsExample]\n    github_client_id: str = Field(default=\"\", description=\"GitHub OAuth client ID\")\n    github_client_secret: str = Field(\n        default=\"\", description=\"GitHub OAuth client secret\"\n    )\n    # --8<-- [end:OAuthServerCredentialsExample]\n    google_client_id: str = Field(default=\"\", description=\"Google OAuth client ID\")\n    google_client_secret: str = Field(\n        default=\"\", description=\"Google OAuth client secret\"\n    )\n    notion_client_id: str = Field(default=\"\", description=\"Notion OAuth client ID\")\n    notion_client_secret: str = Field(\n        default=\"\", description=\"Notion OAuth client secret\"\n    )\n\n    openai_api_key: str = Field(default=\"\", description=\"OpenAI API key\")\n    anthropic_api_key: str = Field(default=\"\", description=\"Anthropic API key\")\n    groq_api_key: str = Field(default=\"\", description=\"Groq API key\")\n    open_router_api_key: str = Field(default=\"\", description=\"Open Router API Key\")\n\n    reddit_client_id: str = Field(default=\"\", description=\"Reddit client ID\")\n    reddit_client_secret: str = Field(default=\"\", description=\"Reddit client secret\")\n    reddit_username: str = Field(default=\"\", description=\"Reddit username\")\n    reddit_password: str = Field(default=\"\", description=\"Reddit password\")\n\n    openweathermap_api_key: str = Field(\n        default=\"\", description=\"OpenWeatherMap API key\"\n    )\n\n    medium_api_key: str = Field(default=\"\", description=\"Medium API key\")\n    medium_author_id: str = Field(default=\"\", description=\"Medium author ID\")\n    did_api_key: str = Field(default=\"\", description=\"D-ID API Key\")\n    revid_api_key: str = Field(default=\"\", description=\"revid.ai API key\")\n    discord_bot_token: str = Field(default=\"\", description=\"Discord bot token\")\n\n    smtp_server: str = Field(default=\"\", description=\"SMTP server IP\")\n    smtp_port: str = Field(default=\"\", description=\"SMTP server port\")\n    smtp_username: str = Field(default=\"\", description=\"SMTP username\")\n    smtp_password: str = Field(default=\"\", description=\"SMTP password\")\n\n    sentry_dsn: str = Field(default=\"\", description=\"Sentry DSN\")\n\n    google_maps_api_key: str = Field(default=\"\", description=\"Google Maps API Key\")\n\n    replicate_api_key: str = Field(default=\"\", description=\"Replicate API Key\")\n    unreal_speech_api_key: str = Field(default=\"\", description=\"Unreal Speech API Key\")\n    ideogram_api_key: str = Field(default=\"\", description=\"Ideogram API Key\")\n    jina_api_key: str = Field(default=\"\", description=\"Jina API Key\")\n    unreal_speech_api_key: str = Field(default=\"\", description=\"Unreal Speech API Key\")\n\n    fal_key: str = Field(default=\"\", description=\"FAL API key\")\n\n    # Add more secret fields as needed\n\n    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        env_file_encoding=\"utf-8\",\n        extra=\"allow\",\n    )\n",
    "cfg": {
      "nodes": [
        {
          "id": "Secrets_1",
          "code": "class Secrets(UpdateTrackingModel[\"Secrets\"], BaseSettings):\n    \"\"\"Secrets for the server.\"\"\"\n\n"
        },
        {
          "id": "Secrets_2",
          "code": "    supabase_url: str = Field(default=\"\", description=\"Supabase URL\")\n    supabase_service_role_key: str = Field(\n        default=\"\", description=\"Supabase service role key\"\n    )\n"
        },
        {
          "id": "Secrets_3",
          "code": "\n    encryption_key: str = Field(default=\"\", description=\"Encryption key\")\n"
        },
        {
          "id": "Secrets_4",
          "code": "\n    # OAuth server credentials for integrations\n"
        },
        {
          "id": "Secrets_5",
          "code": "    # --8<-- [start:OAuthServerCredentialsExample]\n    github_client_id: str = Field(default=\"\", description=\"GitHub OAuth client ID\")\n    github_client_secret: str = Field(\n        default=\"\", description=\"GitHub OAuth client secret\"\n    )\n    # --8<-- [end:OAuthServerCredentialsExample]\n"
        },
        {
          "id": "Secrets_6",
          "code": "    google_client_id: str = Field(default=\"\", description=\"Google OAuth client ID\")\n    google_client_secret: str = Field(\n        default=\"\", description=\"Google OAuth client secret\"\n    )\n"
        },
        {
          "id": "Secrets_7",
          "code": "    notion_client_id: str = Field(default=\"\", description=\"Notion OAuth client ID\")\n    notion_client_secret: str = Field(\n        default=\"\", description=\"Notion OAuth client secret\"\n    )\n"
        },
        {
          "id": "Secrets_8",
          "code": "\n    openai_api_key: str = Field(default=\"\", description=\"OpenAI API key\")\n"
        },
        {
          "id": "Secrets_9",
          "code": "    anthropic_api_key: str = Field(default=\"\", description=\"Anthropic API key\")\n    groq_api_key: str = Field(default=\"\", description=\"Groq API key\")\n    open_router_api_key: str = Field(default=\"\", description=\"Open Router API Key\")\n"
        },
        {
          "id": "Secrets_10",
          "code": "\n    reddit_client_id: str = Field(default=\"\", description=\"Reddit client ID\")\n    reddit_client_secret: str = Field(default=\"\", description=\"Reddit client secret\")\n    reddit_username: str = Field(default=\"\", description=\"Reddit username\")\n    reddit_password: str = Field(default=\"\", description=\"Reddit password\")\n"
        },
        {
          "id": "Secrets_11",
          "code": "\n    openweathermap_api_key: str = Field(\n        default=\"\", description=\"OpenWeatherMap API key\"\n    )\n"
        },
        {
          "id": "Secrets_12",
          "code": "\n    medium_api_key: str = Field(default=\"\", description=\"Medium API key\")\n    medium_author_id: str = Field(default=\"\", description=\"Medium author ID\")\n    did_api_key: str = Field(default=\"\", description=\"D-ID API Key\")\n"
        },
        {
          "id": "Secrets_13",
          "code": "    revid_api_key: str = Field(default=\"\", description=\"revid.ai API key\")\n    discord_bot_token: str = Field(default=\"\", description=\"Discord bot token\")\n"
        },
        {
          "id": "Secrets_14",
          "code": "\n    smtp_server: str = Field(default=\"\", description=\"SMTP server IP\")\n    smtp_port: str = Field(default=\"\", description=\"SMTP server port\")\n    smtp_username: str = Field(default=\"\", description=\"SMTP username\")\n    smtp_password: str = Field(default=\"\", description=\"SMTP password\")\n"
        },
        {
          "id": "Secrets_15",
          "code": "\n    sentry_dsn: str = Field(default=\"\", description=\"Sentry DSN\")\n"
        },
        {
          "id": "Secrets_16",
          "code": "\n    google_maps_api_key: str = Field(default=\"\", description=\"Google Maps API Key\")\n"
        },
        {
          "id": "Secrets_17",
          "code": "\n    replicate_api_key: str = Field(default=\"\", description=\"Replicate API Key\")\n    unreal_speech_api_key: str = Field(default=\"\", description=\"Unreal Speech API Key\")\n    ideogram_api_key: str = Field(default=\"\", description=\"Ideogram API Key\")\n"
        },
        {
          "id": "Secrets_18",
          "code": "    jina_api_key: str = Field(default=\"\", description=\"Jina API Key\")\n    unreal_speech_api_key: str = Field(default=\"\", description=\"Unreal Speech API Key\")\n"
        },
        {
          "id": "Secrets_19",
          "code": "\n    fal_key: str = Field(default=\"\", description=\"FAL API key\")\n"
        },
        {
          "id": "Secrets_20",
          "code": "\n    # Add more secret fields as needed\n"
        },
        {
          "id": "Secrets_21",
          "code": "\n    model_config = SettingsConfigDict(\n        env_file=\".env\",\n        env_file_encoding=\"utf-8\",\n        extra=\"allow\",\n    )\n"
        }
      ],
      "edges": [
        {
          "from": "Secrets_1",
          "to": "Secrets_2"
        },
        {
          "from": "Secrets_2",
          "to": "Secrets_3"
        },
        {
          "from": "Secrets_3",
          "to": "Secrets_4"
        },
        {
          "from": "Secrets_4",
          "to": "Secrets_5"
        },
        {
          "from": "Secrets_5",
          "to": "Secrets_6"
        },
        {
          "from": "Secrets_6",
          "to": "Secrets_7"
        },
        {
          "from": "Secrets_7",
          "to": "Secrets_8"
        },
        {
          "from": "Secrets_8",
          "to": "Secrets_9"
        },
        {
          "from": "Secrets_9",
          "to": "Secrets_10"
        },
        {
          "from": "Secrets_10",
          "to": "Secrets_11"
        },
        {
          "from": "Secrets_11",
          "to": "Secrets_12"
        },
        {
          "from": "Secrets_12",
          "to": "Secrets_13"
        },
        {
          "from": "Secrets_13",
          "to": "Secrets_14"
        },
        {
          "from": "Secrets_14",
          "to": "Secrets_15"
        },
        {
          "from": "Secrets_15",
          "to": "Secrets_16"
        },
        {
          "from": "Secrets_16",
          "to": "Secrets_17"
        },
        {
          "from": "Secrets_17",
          "to": "Secrets_18"
        },
        {
          "from": "Secrets_18",
          "to": "Secrets_19"
        },
        {
          "from": "Secrets_19",
          "to": "Secrets_20"
        },
        {
          "from": "Secrets_20",
          "to": "Secrets_21"
        }
      ]
    }
  },
  {
    "decl_name": "Settings",
    "start_line": 308,
    "end_line": 327,
    "children": [
      {
        "decl_name": "Settings.save",
        "start_line": 312,
        "end_line": 327,
        "children": [],
        "code": "    def save(self) -> None:\n        # Save updated config to JSON file\n        if self.config.updated_fields:\n            config_to_save = self.config.get_updates()\n            config_path = os.path.join(get_data_path(), \"config.json\")\n            if os.path.exists(config_path):\n                with open(config_path, \"r+\") as f:\n                    existing_config: Dict[str, Any] = json.load(f)\n                    existing_config.update(config_to_save)\n                    f.seek(0)\n                    json.dump(existing_config, f, indent=2)\n                    f.truncate()\n            else:\n                with open(config_path, \"w\") as f:\n                    json.dump(config_to_save, f, indent=2)\n            self.config.clear_updates()\n",
        "cfg": {
          "nodes": [
            {
              "id": "Settings.save_1",
              "code": "def save(self) -> None:\n        # Save updated config to JSON file\n"
            },
            {
              "id": "Settings.save_2",
              "code": "        if self.config.updated_fields:\n"
            },
            {
              "id": "Settings.save_3",
              "code": "            config_to_save = self.config.get_updates()\n            config_path = os.path.join(get_data_path(), \"config.json\")\n"
            },
            {
              "id": "Settings.save_4",
              "code": "            if os.path.exists(config_path):\n"
            },
            {
              "id": "Settings.save_5",
              "code": "                with open(config_path, \"r+\") as f:\n                    existing_config: Dict[str, Any] = json.load(f)\n                    existing_config.update(config_to_save)\n                    f.seek(0)\n                    json.dump(existing_config, f, indent=2)\n                    f.truncate()\n"
            },
            {
              "id": "Settings.save_6",
              "code": "            else:\n"
            },
            {
              "id": "Settings.save_7",
              "code": "                with open(config_path, \"w\") as f:\n                    json.dump(config_to_save, f, indent=2)\n"
            },
            {
              "id": "Settings.save_8",
              "code": "            self.config.clear_updates()\n"
            }
          ],
          "edges": [
            {
              "from": "Settings.save_1",
              "to": "Settings.save_2"
            },
            {
              "from": "Settings.save_2",
              "to": "Settings.save_3"
            },
            {
              "from": "Settings.save_2",
              "to": "Settings.save_8"
            },
            {
              "from": "Settings.save_3",
              "to": "Settings.save_4"
            },
            {
              "from": "Settings.save_4",
              "to": "Settings.save_5"
            },
            {
              "from": "Settings.save_4",
              "to": "Settings.save_6"
            },
            {
              "from": "Settings.save_5",
              "to": "Settings.save_8"
            },
            {
              "from": "Settings.save_6",
              "to": "Settings.save_7"
            },
            {
              "from": "Settings.save_7",
              "to": "Settings.save_8"
            }
          ]
        }
      }
    ],
    "code": "class Settings(BaseModel):\n    config: Config = Config()\n    secrets: Secrets = Secrets()\n\n",
    "cfg": {
      "nodes": [
        {
          "id": "Settings_1",
          "code": "class Settings(BaseModel):\n    config: Config = Config()\n    secrets: Secrets = Secrets()\n"
        }
      ],
      "edges": []
    }
  }
]
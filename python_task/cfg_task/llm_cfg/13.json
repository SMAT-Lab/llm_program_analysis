[
  {
    "decl_name": "GlobalBlock",
    "start_line": 0,
    "end_line": 26,
    "children": [],
    "code": "from typing import Any, Literal\n\nfrom pydantic import SecretStr\n\nfrom backend.data.block import Block, BlockCategory, BlockOutput, BlockSchema\nfrom backend.data.model import (\n    APIKeyCredentials,\n    CredentialsField,\n    CredentialsMetaInput,\n    SchemaField,\n)\nfrom backend.integrations.providers import ProviderName\nfrom backend.util.request import requests\n\nTEST_CREDENTIALS = APIKeyCredentials(\n    id=\"01234567-89ab-cdef-0123-456789abcdef\",\n    provider=\"unreal_speech\",\n    api_key=SecretStr(\"mock-unreal-speech-api-key\"),\n    title=\"Mock Unreal Speech API key\",\n    expires_at=None,\n)\nTEST_CREDENTIALS_INPUT = {\n    \"provider\": TEST_CREDENTIALS.provider,\n    \"id\": TEST_CREDENTIALS.id,\n    \"type\": TEST_CREDENTIALS.type,\n    \"title\": TEST_CREDENTIALS.type,\n}\n",
    "cfg": {
      "nodes": [
        {
          "id": "GlobalBlock_1",
          "code": "from typing import Any, Literal\n"
        },
        {
          "id": "GlobalBlock_2",
          "code": "from pydantic import SecretStr\n"
        },
        {
          "id": "GlobalBlock_3",
          "code": "from backend.data.block import Block, BlockCategory, BlockOutput, BlockSchema\n"
        },
        {
          "id": "GlobalBlock_4",
          "code": "from backend.data.model import (\n    APIKeyCredentials,\n    CredentialsField,\n    CredentialsMetaInput,\n    SchemaField,\n)\n"
        },
        {
          "id": "GlobalBlock_5",
          "code": "from backend.integrations.providers import ProviderName\n"
        },
        {
          "id": "GlobalBlock_6",
          "code": "from backend.util.request import requests\n"
        },
        {
          "id": "GlobalBlock_7",
          "code": "TEST_CREDENTIALS = APIKeyCredentials(\n    id=\"01234567-89ab-cdef-0123-456789abcdef\",\n    provider=\"unreal_speech\",\n    api_key=SecretStr(\"mock-unreal-speech-api-key\"),\n    title=\"Mock Unreal Speech API key\",\n    expires_at=None,\n)\n"
        },
        {
          "id": "GlobalBlock_8",
          "code": "TEST_CREDENTIALS_INPUT = {\n    \"provider\": TEST_CREDENTIALS.provider,\n    \"id\": TEST_CREDENTIALS.id,\n    \"type\": TEST_CREDENTIALS.type,\n    \"title\": TEST_CREDENTIALS.type,\n}\n"
        }
      ],
      "edges": [
        {
          "from": "GlobalBlock_1",
          "to": "GlobalBlock_2"
        },
        {
          "from": "GlobalBlock_2",
          "to": "GlobalBlock_3"
        },
        {
          "from": "GlobalBlock_3",
          "to": "GlobalBlock_4"
        },
        {
          "from": "GlobalBlock_4",
          "to": "GlobalBlock_5"
        },
        {
          "from": "GlobalBlock_5",
          "to": "GlobalBlock_6"
        },
        {
          "from": "GlobalBlock_6",
          "to": "GlobalBlock_7"
        },
        {
          "from": "GlobalBlock_7",
          "to": "GlobalBlock_8"
        }
      ]
    }
  },
  {
    "decl_name": "UnrealTextToSpeechBlock",
    "start_line": 29,
    "end_line": 102,
    "children": [
      {
        "decl_name": "UnrealTextToSpeechBlock.Input",
        "start_line": 30,
        "end_line": 45,
        "children": [],
        "code": "    class Input(BlockSchema):\n        text: str = SchemaField(\n            description=\"The text to be converted to speech\",\n            placeholder=\"Enter the text you want to convert to speech\",\n        )\n        voice_id: str = SchemaField(\n            description=\"The voice ID to use for text-to-speech conversion\",\n            placeholder=\"Scarlett\",\n            default=\"Scarlett\",\n        )\n        credentials: CredentialsMetaInput[\n            Literal[ProviderName.UNREAL_SPEECH], Literal[\"api_key\"]\n        ] = CredentialsField(\n            description=\"The Unreal Speech integration can be used with \"\n            \"any API key with sufficient permissions for the blocks it is used on.\",\n        )\n",
        "cfg": {
          "nodes": [
            {
              "id": "UnrealTextToSpeechBlock.Input_1",
              "code": "class Input(BlockSchema):\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.Input_2",
              "code": "        text: str = SchemaField(\n            description=\"The text to be converted to speech\",\n            placeholder=\"Enter the text you want to convert to speech\",\n        )\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.Input_3",
              "code": "        voice_id: str = SchemaField(\n            description=\"The voice ID to use for text-to-speech conversion\",\n            placeholder=\"Scarlett\",\n            default=\"Scarlett\",\n        )\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.Input_4",
              "code": "        credentials: CredentialsMetaInput[\n            Literal[ProviderName.UNREAL_SPEECH], Literal[\"api_key\"]\n        ] = CredentialsField(\n            description=\"The Unreal Speech integration can be used with \"\n            \"any API key with sufficient permissions for the blocks it is used on.\",\n        )\n"
            }
          ],
          "edges": [
            {
              "from": "UnrealTextToSpeechBlock.Input_1",
              "to": "UnrealTextToSpeechBlock.Input_2"
            },
            {
              "from": "UnrealTextToSpeechBlock.Input_2",
              "to": "UnrealTextToSpeechBlock.Input_3"
            },
            {
              "from": "UnrealTextToSpeechBlock.Input_3",
              "to": "UnrealTextToSpeechBlock.Input_4"
            }
          ]
        }
      },
      {
        "decl_name": "UnrealTextToSpeechBlock.Output",
        "start_line": 47,
        "end_line": 49,
        "children": [],
        "code": "    class Output(BlockSchema):\n        mp3_url: str = SchemaField(description=\"The URL of the generated MP3 file\")\n        error: str = SchemaField(description=\"Error message if the API call failed\")\n",
        "cfg": {
          "nodes": [
            {
              "id": "UnrealTextToSpeechBlock.Output_1",
              "code": "class Output(BlockSchema):\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.Output_2",
              "code": "        mp3_url: str = SchemaField(description=\"The URL of the generated MP3 file\")\n        error: str = SchemaField(description=\"Error message if the API call failed\")\n"
            }
          ],
          "edges": [
            {
              "from": "UnrealTextToSpeechBlock.Output_1",
              "to": "UnrealTextToSpeechBlock.Output_2"
            }
          ]
        }
      },
      {
        "decl_name": "UnrealTextToSpeechBlock.__init__",
        "start_line": 51,
        "end_line": 70,
        "children": [],
        "code": "    def __init__(self):\n        super().__init__(\n            id=\"4ff1ff6d-cc40-4caa-ae69-011daa20c378\",\n            description=\"Converts text to speech using the Unreal Speech API\",\n            categories={BlockCategory.AI, BlockCategory.TEXT},\n            input_schema=UnrealTextToSpeechBlock.Input,\n            output_schema=UnrealTextToSpeechBlock.Output,\n            test_input={\n                \"text\": \"This is a test of the text to speech API.\",\n                \"voice_id\": \"Scarlett\",\n                \"credentials\": TEST_CREDENTIALS_INPUT,\n            },\n            test_output=[(\"mp3_url\", \"https://example.com/test.mp3\")],\n            test_mock={\n                \"call_unreal_speech_api\": lambda *args, **kwargs: {\n                    \"OutputUri\": \"https://example.com/test.mp3\"\n                }\n            },\n            test_credentials=TEST_CREDENTIALS,\n        )\n",
        "cfg": {
          "nodes": [
            {
              "id": "UnrealTextToSpeechBlock.__init___1",
              "code": "def __init__(self):\n        super().__init__(\n            id=\"4ff1ff6d-cc40-4caa-ae69-011daa20c378\",\n            description=\"Converts text to speech using the Unreal Speech API\",\n            categories={BlockCategory.AI, BlockCategory.TEXT},\n            input_schema=UnrealTextToSpeechBlock.Input,\n            output_schema=UnrealTextToSpeechBlock.Output,\n            test_input={\n                \"text\": \"This is a test of the text to speech API.\",\n                \"voice_id\": \"Scarlett\",\n                \"credentials\": TEST_CREDENTIALS_INPUT,\n            },\n            test_output=[(\"mp3_url\", \"https://example.com/test.mp3\")],\n            test_mock={\n                \"call_unreal_speech_api\": lambda *args, **kwargs: {\n                    \"OutputUri\": \"https://example.com/test.mp3\"\n                }\n            },\n            test_credentials=TEST_CREDENTIALS,\n        )\n"
            }
          ],
          "edges": []
        }
      },
      {
        "decl_name": "UnrealTextToSpeechBlock.call_unreal_speech_api",
        "start_line": 72,
        "end_line": 91,
        "children": [],
        "code": "    @staticmethod\n    def call_unreal_speech_api(\n        api_key: SecretStr, text: str, voice_id: str\n    ) -> dict[str, Any]:\n        url = \"https://api.v7.unrealspeech.com/speech\"\n        headers = {\n            \"Authorization\": f\"Bearer {api_key.get_secret_value()}\",\n            \"Content-Type\": \"application/json\",\n        }\n        data = {\n            \"Text\": text,\n            \"VoiceId\": voice_id,\n            \"Bitrate\": \"192k\",\n            \"Speed\": \"0\",\n            \"Pitch\": \"1\",\n            \"TimestampType\": \"sentence\",\n        }\n\n        response = requests.post(url, headers=headers, json=data)\n        return response.json()\n",
        "cfg": {
          "nodes": [
            {
              "id": "UnrealTextToSpeechBlock.call_unreal_speech_api_1",
              "code": "@staticmethod\n    def call_unreal_speech_api(\n        api_key: SecretStr, text: str, voice_id: str\n    ) -> dict[str, Any]:\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.call_unreal_speech_api_2",
              "code": "        url = \"https://api.v7.unrealspeech.com/speech\"\n        headers = {\n            \"Authorization\": f\"Bearer {api_key.get_secret_value()}\",\n            \"Content-Type\": \"application/json\",\n        }\n        data = {\n            \"Text\": text,\n            \"VoiceId\": voice_id,\n            \"Bitrate\": \"192k\",\n            \"Speed\": \"0\",\n            \"Pitch\": \"1\",\n            \"TimestampType\": \"sentence\",\n        }\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.call_unreal_speech_api_3",
              "code": "        response = requests.post(url, headers=headers, json=data)\n        return response.json()\n"
            }
          ],
          "edges": [
            {
              "from": "UnrealTextToSpeechBlock.call_unreal_speech_api_1",
              "to": "UnrealTextToSpeechBlock.call_unreal_speech_api_2"
            },
            {
              "from": "UnrealTextToSpeechBlock.call_unreal_speech_api_2",
              "to": "UnrealTextToSpeechBlock.call_unreal_speech_api_3"
            }
          ]
        }
      },
      {
        "decl_name": "UnrealTextToSpeechBlock.run",
        "start_line": 93,
        "end_line": 101,
        "children": [],
        "code": "    def run(\n        self, input_data: Input, *, credentials: APIKeyCredentials, **kwargs\n    ) -> BlockOutput:\n        api_response = self.call_unreal_speech_api(\n            credentials.api_key,\n            input_data.text,\n            input_data.voice_id,\n        )\n        yield \"mp3_url\", api_response[\"OutputUri\"]\n",
        "cfg": {
          "nodes": [
            {
              "id": "UnrealTextToSpeechBlock.run_1",
              "code": "def run(\n        self, input_data: Input, *, credentials: APIKeyCredentials, **kwargs\n    ) -> BlockOutput:\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.run_2",
              "code": "        api_response = self.call_unreal_speech_api(\n            credentials.api_key,\n            input_data.text,\n            input_data.voice_id,\n        )\n"
            },
            {
              "id": "UnrealTextToSpeechBlock.run_3",
              "code": "        yield \"mp3_url\", api_response[\"OutputUri\"]\n"
            }
          ],
          "edges": [
            {
              "from": "UnrealTextToSpeechBlock.run_1",
              "to": "UnrealTextToSpeechBlock.run_2"
            },
            {
              "from": "UnrealTextToSpeechBlock.run_2",
              "to": "UnrealTextToSpeechBlock.run_3"
            }
          ]
        }
      }
    ],
    "code": "class UnrealTextToSpeechBlock(Block):\n\n\n\n\n\n",
    "cfg": {
      "nodes": [
        {
          "id": "UnrealTextToSpeechBlock_1",
          "code": "class UnrealTextToSpeechBlock(Block):\n"
        }
      ],
      "edges": []
    }
  }
]
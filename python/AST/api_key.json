{
  "value": "import logging\nimport uuid\nfrom datetime import datetime, timezone\nfrom typing import List, Optional\n\nfrom autogpt_libs.api_key.key_manager import APIKeyManager\nfrom prisma.enums import APIKeyPermission, APIKeyStatus\nfrom prisma.errors import PrismaError\nfrom prisma.models import APIKey as PrismaAPIKey\nfrom prisma.types import (\n    APIKeyCreateInput,\n    APIKeyUpdateInput,\n    APIKeyWhereInput,\n    APIKeyWhereUniqueInput,\n)\nfrom pydantic import BaseModel\n\nfrom backend.data.db import BaseDbModel\n\nlogger = logging.getLogger(__name__)\n\n\n# Some basic exceptions\nclass APIKeyError(Exception):\n    \"\"\"Base exception for API key operations\"\"\"\n\n    pass\n\n\nclass APIKeyNotFoundError(APIKeyError):\n    \"\"\"Raised when an API key is not found\"\"\"\n\n    pass\n\n\nclass APIKeyPermissionError(APIKeyError):\n    \"\"\"Raised when there are permission issues with API key operations\"\"\"\n\n    pass\n\n\nclass APIKeyValidationError(APIKeyError):\n    \"\"\"Raised when API key validation fails\"\"\"\n\n    pass\n\n\nclass APIKey(BaseDbModel):\n    name: str\n    prefix: str\n    key: str\n    status: APIKeyStatus = APIKeyStatus.ACTIVE\n    permissions: List[APIKeyPermission]\n    postfix: str\n    created_at: datetime\n    last_used_at: Optional[datetime] = None\n    revoked_at: Optional[datetime] = None\n    description: Optional[str] = None\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")\n\n\nclass APIKeyWithoutHash(BaseModel):\n    id: str\n    name: str\n    prefix: str\n    postfix: str\n    status: APIKeyStatus\n    permissions: List[APIKeyPermission]\n    created_at: datetime\n    last_used_at: Optional[datetime]\n    revoked_at: Optional[datetime]\n    description: Optional[str]\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")\n\n\nasync def generate_api_key(\n    name: str,\n    user_id: str,\n    permissions: List[APIKeyPermission],\n    description: Optional[str] = None,\n) -> tuple[APIKeyWithoutHash, str]:\n    \"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"\n    try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n    except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n\n\nasync def validate_api_key(plain_text_key: str) -> Optional[APIKey]:\n    \"\"\"\n    Validate an API key and return the API key object if valid.\n    \"\"\"\n    try:\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)\n    except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")\n\n\nasync def revoke_api_key(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n\n\nasync def list_user_api_keys(user_id: str) -> List[APIKeyWithoutHash]:\n    try:\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n    except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n\n\nasync def suspend_api_key(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")\n\n\ndef has_permission(api_key: APIKey, required_permission: APIKeyPermission) -> bool:\n    try:\n        return required_permission in api_key.permissions\n    except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False\n\n\nasync def get_api_key_by_id(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)\n    except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n\n\nasync def update_api_key_permissions(\n    key_id: str, user_id: str, permissions: List[APIKeyPermission]\n) -> Optional[APIKeyWithoutHash]:\n    \"\"\"\n    Update the permissions of an API key.\n    \"\"\"\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
  "children": [
    {
      "value": "import logging",
      "children": [
        {
          "value": "logging",
          "children": [
            {
              "value": "logging",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "import uuid",
      "children": [
        {
          "value": "uuid",
          "children": [
            {
              "value": "uuid",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from datetime import datetime, timezone",
      "children": [
        {
          "value": "datetime",
          "children": [
            {
              "value": "datetime",
              "children": []
            }
          ]
        },
        {
          "value": "datetime",
          "children": [
            {
              "value": "datetime",
              "children": []
            }
          ]
        },
        {
          "value": "timezone",
          "children": [
            {
              "value": "timezone",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from typing import List, Optional",
      "children": [
        {
          "value": "typing",
          "children": [
            {
              "value": "typing",
              "children": []
            }
          ]
        },
        {
          "value": "List",
          "children": [
            {
              "value": "List",
              "children": []
            }
          ]
        },
        {
          "value": "Optional",
          "children": [
            {
              "value": "Optional",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from autogpt_libs.api_key.key_manager import APIKeyManager",
      "children": [
        {
          "value": "autogpt_libs.api_key.key_manager",
          "children": [
            {
              "value": "autogpt_libs",
              "children": []
            },
            {
              "value": "api_key",
              "children": []
            },
            {
              "value": "key_manager",
              "children": []
            }
          ]
        },
        {
          "value": "APIKeyManager",
          "children": [
            {
              "value": "APIKeyManager",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from prisma.enums import APIKeyPermission, APIKeyStatus",
      "children": [
        {
          "value": "prisma.enums",
          "children": [
            {
              "value": "prisma",
              "children": []
            },
            {
              "value": "enums",
              "children": []
            }
          ]
        },
        {
          "value": "APIKeyPermission",
          "children": [
            {
              "value": "APIKeyPermission",
              "children": []
            }
          ]
        },
        {
          "value": "APIKeyStatus",
          "children": [
            {
              "value": "APIKeyStatus",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from prisma.errors import PrismaError",
      "children": [
        {
          "value": "prisma.errors",
          "children": [
            {
              "value": "prisma",
              "children": []
            },
            {
              "value": "errors",
              "children": []
            }
          ]
        },
        {
          "value": "PrismaError",
          "children": [
            {
              "value": "PrismaError",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from prisma.models import APIKey as PrismaAPIKey",
      "children": [
        {
          "value": "prisma.models",
          "children": [
            {
              "value": "prisma",
              "children": []
            },
            {
              "value": "models",
              "children": []
            }
          ]
        },
        {
          "value": "APIKey as PrismaAPIKey",
          "children": [
            {
              "value": "APIKey",
              "children": [
                {
                  "value": "APIKey",
                  "children": []
                }
              ]
            },
            {
              "value": "PrismaAPIKey",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from prisma.types import (\n    APIKeyCreateInput,\n    APIKeyUpdateInput,\n    APIKeyWhereInput,\n    APIKeyWhereUniqueInput,\n)",
      "children": [
        {
          "value": "prisma.types",
          "children": [
            {
              "value": "prisma",
              "children": []
            },
            {
              "value": "types",
              "children": []
            }
          ]
        },
        {
          "value": "APIKeyCreateInput",
          "children": [
            {
              "value": "APIKeyCreateInput",
              "children": []
            }
          ]
        },
        {
          "value": "APIKeyUpdateInput",
          "children": [
            {
              "value": "APIKeyUpdateInput",
              "children": []
            }
          ]
        },
        {
          "value": "APIKeyWhereInput",
          "children": [
            {
              "value": "APIKeyWhereInput",
              "children": []
            }
          ]
        },
        {
          "value": "APIKeyWhereUniqueInput",
          "children": [
            {
              "value": "APIKeyWhereUniqueInput",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from pydantic import BaseModel",
      "children": [
        {
          "value": "pydantic",
          "children": [
            {
              "value": "pydantic",
              "children": []
            }
          ]
        },
        {
          "value": "BaseModel",
          "children": [
            {
              "value": "BaseModel",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "from backend.data.db import BaseDbModel",
      "children": [
        {
          "value": "backend.data.db",
          "children": [
            {
              "value": "backend",
              "children": []
            },
            {
              "value": "data",
              "children": []
            },
            {
              "value": "db",
              "children": []
            }
          ]
        },
        {
          "value": "BaseDbModel",
          "children": [
            {
              "value": "BaseDbModel",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "logger = logging.getLogger(__name__)",
      "children": [
        {
          "value": "logger = logging.getLogger(__name__)",
          "children": [
            {
              "value": "logger",
              "children": []
            },
            {
              "value": "logging.getLogger(__name__)",
              "children": [
                {
                  "value": "logging.getLogger",
                  "children": [
                    {
                      "value": "logging",
                      "children": []
                    },
                    {
                      "value": "getLogger",
                      "children": []
                    }
                  ]
                },
                {
                  "value": "(__name__)",
                  "children": [
                    {
                      "value": "__name__",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "# Some basic exceptions",
      "children": []
    },
    {
      "value": "class APIKeyError(Exception):\n    \"\"\"Base exception for API key operations\"\"\"\n\n    pass",
      "children": [
        {
          "value": "APIKeyError",
          "children": []
        },
        {
          "value": "(Exception)",
          "children": [
            {
              "value": "Exception",
              "children": []
            }
          ]
        },
        {
          "value": "\"\"\"Base exception for API key operations\"\"\"\n\n    pass",
          "children": [
            {
              "value": "\"\"\"Base exception for API key operations\"\"\"",
              "children": [
                {
                  "value": "\"\"\"Base exception for API key operations\"\"\"",
                  "children": [
                    {
                      "value": "\"\"\"",
                      "children": []
                    },
                    {
                      "value": "Base exception for API key operations",
                      "children": []
                    },
                    {
                      "value": "\"\"\"",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "pass",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "class APIKeyNotFoundError(APIKeyError):\n    \"\"\"Raised when an API key is not found\"\"\"\n\n    pass",
      "children": [
        {
          "value": "APIKeyNotFoundError",
          "children": []
        },
        {
          "value": "(APIKeyError)",
          "children": [
            {
              "value": "APIKeyError",
              "children": []
            }
          ]
        },
        {
          "value": "\"\"\"Raised when an API key is not found\"\"\"\n\n    pass",
          "children": [
            {
              "value": "\"\"\"Raised when an API key is not found\"\"\"",
              "children": [
                {
                  "value": "\"\"\"Raised when an API key is not found\"\"\"",
                  "children": [
                    {
                      "value": "\"\"\"",
                      "children": []
                    },
                    {
                      "value": "Raised when an API key is not found",
                      "children": []
                    },
                    {
                      "value": "\"\"\"",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "pass",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "class APIKeyPermissionError(APIKeyError):\n    \"\"\"Raised when there are permission issues with API key operations\"\"\"\n\n    pass",
      "children": [
        {
          "value": "APIKeyPermissionError",
          "children": []
        },
        {
          "value": "(APIKeyError)",
          "children": [
            {
              "value": "APIKeyError",
              "children": []
            }
          ]
        },
        {
          "value": "\"\"\"Raised when there are permission issues with API key operations\"\"\"\n\n    pass",
          "children": [
            {
              "value": "\"\"\"Raised when there are permission issues with API key operations\"\"\"",
              "children": [
                {
                  "value": "\"\"\"Raised when there are permission issues with API key operations\"\"\"",
                  "children": [
                    {
                      "value": "\"\"\"",
                      "children": []
                    },
                    {
                      "value": "Raised when there are permission issues with API key operations",
                      "children": []
                    },
                    {
                      "value": "\"\"\"",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "pass",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "class APIKeyValidationError(APIKeyError):\n    \"\"\"Raised when API key validation fails\"\"\"\n\n    pass",
      "children": [
        {
          "value": "APIKeyValidationError",
          "children": []
        },
        {
          "value": "(APIKeyError)",
          "children": [
            {
              "value": "APIKeyError",
              "children": []
            }
          ]
        },
        {
          "value": "\"\"\"Raised when API key validation fails\"\"\"\n\n    pass",
          "children": [
            {
              "value": "\"\"\"Raised when API key validation fails\"\"\"",
              "children": [
                {
                  "value": "\"\"\"Raised when API key validation fails\"\"\"",
                  "children": [
                    {
                      "value": "\"\"\"",
                      "children": []
                    },
                    {
                      "value": "Raised when API key validation fails",
                      "children": []
                    },
                    {
                      "value": "\"\"\"",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "pass",
              "children": []
            }
          ]
        }
      ]
    },
    {
      "value": "class APIKey(BaseDbModel):\n    name: str\n    prefix: str\n    key: str\n    status: APIKeyStatus = APIKeyStatus.ACTIVE\n    permissions: List[APIKeyPermission]\n    postfix: str\n    created_at: datetime\n    last_used_at: Optional[datetime] = None\n    revoked_at: Optional[datetime] = None\n    description: Optional[str] = None\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
      "children": [
        {
          "value": "APIKey",
          "children": []
        },
        {
          "value": "(BaseDbModel)",
          "children": [
            {
              "value": "BaseDbModel",
              "children": []
            }
          ]
        },
        {
          "value": "name: str\n    prefix: str\n    key: str\n    status: APIKeyStatus = APIKeyStatus.ACTIVE\n    permissions: List[APIKeyPermission]\n    postfix: str\n    created_at: datetime\n    last_used_at: Optional[datetime] = None\n    revoked_at: Optional[datetime] = None\n    description: Optional[str] = None\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
          "children": [
            {
              "value": "name: str",
              "children": [
                {
                  "value": "name: str",
                  "children": [
                    {
                      "value": "name",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "prefix: str",
              "children": [
                {
                  "value": "prefix: str",
                  "children": [
                    {
                      "value": "prefix",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "key: str",
              "children": [
                {
                  "value": "key: str",
                  "children": [
                    {
                      "value": "key",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "status: APIKeyStatus = APIKeyStatus.ACTIVE",
              "children": [
                {
                  "value": "status: APIKeyStatus = APIKeyStatus.ACTIVE",
                  "children": [
                    {
                      "value": "status",
                      "children": []
                    },
                    {
                      "value": "APIKeyStatus",
                      "children": [
                        {
                          "value": "APIKeyStatus",
                          "children": []
                        }
                      ]
                    },
                    {
                      "value": "APIKeyStatus.ACTIVE",
                      "children": [
                        {
                          "value": "APIKeyStatus",
                          "children": []
                        },
                        {
                          "value": "ACTIVE",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "permissions: List[APIKeyPermission]",
              "children": [
                {
                  "value": "permissions: List[APIKeyPermission]",
                  "children": [
                    {
                      "value": "permissions",
                      "children": []
                    },
                    {
                      "value": "List[APIKeyPermission]",
                      "children": [
                        {
                          "value": "List[APIKeyPermission]",
                          "children": [
                            {
                              "value": "List",
                              "children": []
                            },
                            {
                              "value": "[APIKeyPermission]",
                              "children": [
                                {
                                  "value": "APIKeyPermission",
                                  "children": [
                                    {
                                      "value": "APIKeyPermission",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "postfix: str",
              "children": [
                {
                  "value": "postfix: str",
                  "children": [
                    {
                      "value": "postfix",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "created_at: datetime",
              "children": [
                {
                  "value": "created_at: datetime",
                  "children": [
                    {
                      "value": "created_at",
                      "children": []
                    },
                    {
                      "value": "datetime",
                      "children": [
                        {
                          "value": "datetime",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "last_used_at: Optional[datetime] = None",
              "children": [
                {
                  "value": "last_used_at: Optional[datetime] = None",
                  "children": [
                    {
                      "value": "last_used_at",
                      "children": []
                    },
                    {
                      "value": "Optional[datetime]",
                      "children": [
                        {
                          "value": "Optional[datetime]",
                          "children": [
                            {
                              "value": "Optional",
                              "children": []
                            },
                            {
                              "value": "[datetime]",
                              "children": [
                                {
                                  "value": "datetime",
                                  "children": [
                                    {
                                      "value": "datetime",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "None",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "revoked_at: Optional[datetime] = None",
              "children": [
                {
                  "value": "revoked_at: Optional[datetime] = None",
                  "children": [
                    {
                      "value": "revoked_at",
                      "children": []
                    },
                    {
                      "value": "Optional[datetime]",
                      "children": [
                        {
                          "value": "Optional[datetime]",
                          "children": [
                            {
                              "value": "Optional",
                              "children": []
                            },
                            {
                              "value": "[datetime]",
                              "children": [
                                {
                                  "value": "datetime",
                                  "children": [
                                    {
                                      "value": "datetime",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "None",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "description: Optional[str] = None",
              "children": [
                {
                  "value": "description: Optional[str] = None",
                  "children": [
                    {
                      "value": "description",
                      "children": []
                    },
                    {
                      "value": "Optional[str]",
                      "children": [
                        {
                          "value": "Optional[str]",
                          "children": [
                            {
                              "value": "Optional",
                              "children": []
                            },
                            {
                              "value": "[str]",
                              "children": [
                                {
                                  "value": "str",
                                  "children": [
                                    {
                                      "value": "str",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "None",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id: str",
                  "children": [
                    {
                      "value": "user_id",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "@staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
              "children": [
                {
                  "value": "@staticmethod",
                  "children": [
                    {
                      "value": "staticmethod",
                      "children": []
                    }
                  ]
                },
                {
                  "value": "def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                  "children": [
                    {
                      "value": "from_db",
                      "children": []
                    },
                    {
                      "value": "(api_key: PrismaAPIKey)",
                      "children": [
                        {
                          "value": "api_key: PrismaAPIKey",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "PrismaAPIKey",
                              "children": [
                                {
                                  "value": "PrismaAPIKey",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                      "children": [
                        {
                          "value": "try:\n            return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                          "children": [
                            {
                              "value": "return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                              "children": [
                                {
                                  "value": "return APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                  "children": [
                                    {
                                      "value": "APIKey(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                      "children": [
                                        {
                                          "value": "APIKey",
                                          "children": []
                                        },
                                        {
                                          "value": "(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                key=api_key.key,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                          "children": [
                                            {
                                              "value": "id=api_key.id",
                                              "children": [
                                                {
                                                  "value": "id",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.id",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "id",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "name=api_key.name",
                                              "children": [
                                                {
                                                  "value": "name",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.name",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "name",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "prefix=api_key.prefix",
                                              "children": [
                                                {
                                                  "value": "prefix",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.prefix",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "prefix",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "postfix=api_key.postfix",
                                              "children": [
                                                {
                                                  "value": "postfix",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.postfix",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "postfix",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "key=api_key.key",
                                              "children": [
                                                {
                                                  "value": "key",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.key",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "key",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "status=APIKeyStatus(api_key.status)",
                                              "children": [
                                                {
                                                  "value": "status",
                                                  "children": []
                                                },
                                                {
                                                  "value": "APIKeyStatus(api_key.status)",
                                                  "children": [
                                                    {
                                                      "value": "APIKeyStatus",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "(api_key.status)",
                                                      "children": [
                                                        {
                                                          "value": "api_key.status",
                                                          "children": [
                                                            {
                                                              "value": "api_key",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "status",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "permissions=[APIKeyPermission(p) for p in api_key.permissions]",
                                              "children": [
                                                {
                                                  "value": "permissions",
                                                  "children": []
                                                },
                                                {
                                                  "value": "[APIKeyPermission(p) for p in api_key.permissions]",
                                                  "children": [
                                                    {
                                                      "value": "APIKeyPermission(p)",
                                                      "children": [
                                                        {
                                                          "value": "APIKeyPermission",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "(p)",
                                                          "children": [
                                                            {
                                                              "value": "p",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "for p in api_key.permissions",
                                                      "children": [
                                                        {
                                                          "value": "p",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "api_key.permissions",
                                                          "children": [
                                                            {
                                                              "value": "api_key",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "permissions",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "created_at=api_key.createdAt",
                                              "children": [
                                                {
                                                  "value": "created_at",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.createdAt",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "createdAt",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "last_used_at=api_key.lastUsedAt",
                                              "children": [
                                                {
                                                  "value": "last_used_at",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.lastUsedAt",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "lastUsedAt",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "revoked_at=api_key.revokedAt",
                                              "children": [
                                                {
                                                  "value": "revoked_at",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.revokedAt",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "revokedAt",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "description=api_key.description",
                                              "children": [
                                                {
                                                  "value": "description",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.description",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "description",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "user_id=api_key.userId",
                                              "children": [
                                                {
                                                  "value": "user_id",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.userId",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "userId",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "value": "except Exception as e:\n            logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                              "children": [
                                {
                                  "value": "Exception as e",
                                  "children": [
                                    {
                                      "value": "Exception",
                                      "children": []
                                    },
                                    {
                                      "value": "e",
                                      "children": [
                                        {
                                          "value": "e",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "value": "logger.error(f\"Error creating APIKey from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "logger.error(f\"Error creating APIKey from db: {str(e)}\")",
                                      "children": [
                                        {
                                          "value": "logger.error(f\"Error creating APIKey from db: {str(e)}\")",
                                          "children": [
                                            {
                                              "value": "logger.error",
                                              "children": [
                                                {
                                                  "value": "logger",
                                                  "children": []
                                                },
                                                {
                                                  "value": "error",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "(f\"Error creating APIKey from db: {str(e)}\")",
                                              "children": [
                                                {
                                                  "value": "f\"Error creating APIKey from db: {str(e)}\"",
                                                  "children": [
                                                    {
                                                      "value": "f\"",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "Error creating APIKey from db:",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "{str(e)}",
                                                      "children": [
                                                        {
                                                          "value": "str(e)",
                                                          "children": [
                                                            {
                                                              "value": "str",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "(e)",
                                                              "children": [
                                                                {
                                                                  "value": "e",
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "\"",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "value": "raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                      "children": [
                                        {
                                          "value": "APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                          "children": [
                                            {
                                              "value": "APIKeyError",
                                              "children": []
                                            },
                                            {
                                              "value": "(f\"Failed to create API key object: {str(e)}\")",
                                              "children": [
                                                {
                                                  "value": "f\"Failed to create API key object: {str(e)}\"",
                                                  "children": [
                                                    {
                                                      "value": "f\"",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "Failed to create API key object:",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "{str(e)}",
                                                      "children": [
                                                        {
                                                          "value": "str(e)",
                                                          "children": [
                                                            {
                                                              "value": "str",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "(e)",
                                                              "children": [
                                                                {
                                                                  "value": "e",
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "\"",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "class APIKeyWithoutHash(BaseModel):\n    id: str\n    name: str\n    prefix: str\n    postfix: str\n    status: APIKeyStatus\n    permissions: List[APIKeyPermission]\n    created_at: datetime\n    last_used_at: Optional[datetime]\n    revoked_at: Optional[datetime]\n    description: Optional[str]\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
      "children": [
        {
          "value": "APIKeyWithoutHash",
          "children": []
        },
        {
          "value": "(BaseModel)",
          "children": [
            {
              "value": "BaseModel",
              "children": []
            }
          ]
        },
        {
          "value": "id: str\n    name: str\n    prefix: str\n    postfix: str\n    status: APIKeyStatus\n    permissions: List[APIKeyPermission]\n    created_at: datetime\n    last_used_at: Optional[datetime]\n    revoked_at: Optional[datetime]\n    description: Optional[str]\n    user_id: str\n\n    @staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
          "children": [
            {
              "value": "id: str",
              "children": [
                {
                  "value": "id: str",
                  "children": [
                    {
                      "value": "id",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "name: str",
              "children": [
                {
                  "value": "name: str",
                  "children": [
                    {
                      "value": "name",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "prefix: str",
              "children": [
                {
                  "value": "prefix: str",
                  "children": [
                    {
                      "value": "prefix",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "postfix: str",
              "children": [
                {
                  "value": "postfix: str",
                  "children": [
                    {
                      "value": "postfix",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "status: APIKeyStatus",
              "children": [
                {
                  "value": "status: APIKeyStatus",
                  "children": [
                    {
                      "value": "status",
                      "children": []
                    },
                    {
                      "value": "APIKeyStatus",
                      "children": [
                        {
                          "value": "APIKeyStatus",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "permissions: List[APIKeyPermission]",
              "children": [
                {
                  "value": "permissions: List[APIKeyPermission]",
                  "children": [
                    {
                      "value": "permissions",
                      "children": []
                    },
                    {
                      "value": "List[APIKeyPermission]",
                      "children": [
                        {
                          "value": "List[APIKeyPermission]",
                          "children": [
                            {
                              "value": "List",
                              "children": []
                            },
                            {
                              "value": "[APIKeyPermission]",
                              "children": [
                                {
                                  "value": "APIKeyPermission",
                                  "children": [
                                    {
                                      "value": "APIKeyPermission",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "created_at: datetime",
              "children": [
                {
                  "value": "created_at: datetime",
                  "children": [
                    {
                      "value": "created_at",
                      "children": []
                    },
                    {
                      "value": "datetime",
                      "children": [
                        {
                          "value": "datetime",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "last_used_at: Optional[datetime]",
              "children": [
                {
                  "value": "last_used_at: Optional[datetime]",
                  "children": [
                    {
                      "value": "last_used_at",
                      "children": []
                    },
                    {
                      "value": "Optional[datetime]",
                      "children": [
                        {
                          "value": "Optional[datetime]",
                          "children": [
                            {
                              "value": "Optional",
                              "children": []
                            },
                            {
                              "value": "[datetime]",
                              "children": [
                                {
                                  "value": "datetime",
                                  "children": [
                                    {
                                      "value": "datetime",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "revoked_at: Optional[datetime]",
              "children": [
                {
                  "value": "revoked_at: Optional[datetime]",
                  "children": [
                    {
                      "value": "revoked_at",
                      "children": []
                    },
                    {
                      "value": "Optional[datetime]",
                      "children": [
                        {
                          "value": "Optional[datetime]",
                          "children": [
                            {
                              "value": "Optional",
                              "children": []
                            },
                            {
                              "value": "[datetime]",
                              "children": [
                                {
                                  "value": "datetime",
                                  "children": [
                                    {
                                      "value": "datetime",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "description: Optional[str]",
              "children": [
                {
                  "value": "description: Optional[str]",
                  "children": [
                    {
                      "value": "description",
                      "children": []
                    },
                    {
                      "value": "Optional[str]",
                      "children": [
                        {
                          "value": "Optional[str]",
                          "children": [
                            {
                              "value": "Optional",
                              "children": []
                            },
                            {
                              "value": "[str]",
                              "children": [
                                {
                                  "value": "str",
                                  "children": [
                                    {
                                      "value": "str",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id: str",
                  "children": [
                    {
                      "value": "user_id",
                      "children": []
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "@staticmethod\n    def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
              "children": [
                {
                  "value": "@staticmethod",
                  "children": [
                    {
                      "value": "staticmethod",
                      "children": []
                    }
                  ]
                },
                {
                  "value": "def from_db(api_key: PrismaAPIKey):\n        try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                  "children": [
                    {
                      "value": "from_db",
                      "children": []
                    },
                    {
                      "value": "(api_key: PrismaAPIKey)",
                      "children": [
                        {
                          "value": "api_key: PrismaAPIKey",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "PrismaAPIKey",
                              "children": [
                                {
                                  "value": "PrismaAPIKey",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                      "children": [
                        {
                          "value": "try:\n            return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )\n        except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                          "children": [
                            {
                              "value": "return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                              "children": [
                                {
                                  "value": "return APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                  "children": [
                                    {
                                      "value": "APIKeyWithoutHash(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                      "children": [
                                        {
                                          "value": "APIKeyWithoutHash",
                                          "children": []
                                        },
                                        {
                                          "value": "(\n                id=api_key.id,\n                name=api_key.name,\n                prefix=api_key.prefix,\n                postfix=api_key.postfix,\n                status=APIKeyStatus(api_key.status),\n                permissions=[APIKeyPermission(p) for p in api_key.permissions],\n                created_at=api_key.createdAt,\n                last_used_at=api_key.lastUsedAt,\n                revoked_at=api_key.revokedAt,\n                description=api_key.description,\n                user_id=api_key.userId,\n            )",
                                          "children": [
                                            {
                                              "value": "id=api_key.id",
                                              "children": [
                                                {
                                                  "value": "id",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.id",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "id",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "name=api_key.name",
                                              "children": [
                                                {
                                                  "value": "name",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.name",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "name",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "prefix=api_key.prefix",
                                              "children": [
                                                {
                                                  "value": "prefix",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.prefix",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "prefix",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "postfix=api_key.postfix",
                                              "children": [
                                                {
                                                  "value": "postfix",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.postfix",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "postfix",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "status=APIKeyStatus(api_key.status)",
                                              "children": [
                                                {
                                                  "value": "status",
                                                  "children": []
                                                },
                                                {
                                                  "value": "APIKeyStatus(api_key.status)",
                                                  "children": [
                                                    {
                                                      "value": "APIKeyStatus",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "(api_key.status)",
                                                      "children": [
                                                        {
                                                          "value": "api_key.status",
                                                          "children": [
                                                            {
                                                              "value": "api_key",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "status",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "permissions=[APIKeyPermission(p) for p in api_key.permissions]",
                                              "children": [
                                                {
                                                  "value": "permissions",
                                                  "children": []
                                                },
                                                {
                                                  "value": "[APIKeyPermission(p) for p in api_key.permissions]",
                                                  "children": [
                                                    {
                                                      "value": "APIKeyPermission(p)",
                                                      "children": [
                                                        {
                                                          "value": "APIKeyPermission",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "(p)",
                                                          "children": [
                                                            {
                                                              "value": "p",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "for p in api_key.permissions",
                                                      "children": [
                                                        {
                                                          "value": "p",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "api_key.permissions",
                                                          "children": [
                                                            {
                                                              "value": "api_key",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "permissions",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "created_at=api_key.createdAt",
                                              "children": [
                                                {
                                                  "value": "created_at",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.createdAt",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "createdAt",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "last_used_at=api_key.lastUsedAt",
                                              "children": [
                                                {
                                                  "value": "last_used_at",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.lastUsedAt",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "lastUsedAt",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "revoked_at=api_key.revokedAt",
                                              "children": [
                                                {
                                                  "value": "revoked_at",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.revokedAt",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "revokedAt",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "description=api_key.description",
                                              "children": [
                                                {
                                                  "value": "description",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.description",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "description",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "value": "user_id=api_key.userId",
                                              "children": [
                                                {
                                                  "value": "user_id",
                                                  "children": []
                                                },
                                                {
                                                  "value": "api_key.userId",
                                                  "children": [
                                                    {
                                                      "value": "api_key",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "userId",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "value": "except Exception as e:\n            logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                              "children": [
                                {
                                  "value": "Exception as e",
                                  "children": [
                                    {
                                      "value": "Exception",
                                      "children": []
                                    },
                                    {
                                      "value": "e",
                                      "children": [
                                        {
                                          "value": "e",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "value": "logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")\n            raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")",
                                      "children": [
                                        {
                                          "value": "logger.error(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")",
                                          "children": [
                                            {
                                              "value": "logger.error",
                                              "children": [
                                                {
                                                  "value": "logger",
                                                  "children": []
                                                },
                                                {
                                                  "value": "error",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "(f\"Error creating APIKeyWithoutHash from db: {str(e)}\")",
                                              "children": [
                                                {
                                                  "value": "f\"Error creating APIKeyWithoutHash from db: {str(e)}\"",
                                                  "children": [
                                                    {
                                                      "value": "f\"",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "Error creating APIKeyWithoutHash from db:",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "{str(e)}",
                                                      "children": [
                                                        {
                                                          "value": "str(e)",
                                                          "children": [
                                                            {
                                                              "value": "str",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "(e)",
                                                              "children": [
                                                                {
                                                                  "value": "e",
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "\"",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "value": "raise APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                      "children": [
                                        {
                                          "value": "APIKeyError(f\"Failed to create API key object: {str(e)}\")",
                                          "children": [
                                            {
                                              "value": "APIKeyError",
                                              "children": []
                                            },
                                            {
                                              "value": "(f\"Failed to create API key object: {str(e)}\")",
                                              "children": [
                                                {
                                                  "value": "f\"Failed to create API key object: {str(e)}\"",
                                                  "children": [
                                                    {
                                                      "value": "f\"",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "Failed to create API key object:",
                                                      "children": []
                                                    },
                                                    {
                                                      "value": "{str(e)}",
                                                      "children": [
                                                        {
                                                          "value": "str(e)",
                                                          "children": [
                                                            {
                                                              "value": "str",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "(e)",
                                                              "children": [
                                                                {
                                                                  "value": "e",
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "\"",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "async def generate_api_key(\n    name: str,\n    user_id: str,\n    permissions: List[APIKeyPermission],\n    description: Optional[str] = None,\n) -> tuple[APIKeyWithoutHash, str]:\n    \"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"\n    try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n    except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
      "children": [
        {
          "value": "generate_api_key",
          "children": []
        },
        {
          "value": "(\n    name: str,\n    user_id: str,\n    permissions: List[APIKeyPermission],\n    description: Optional[str] = None,\n)",
          "children": [
            {
              "value": "name: str",
              "children": [
                {
                  "value": "name",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "permissions: List[APIKeyPermission]",
              "children": [
                {
                  "value": "permissions",
                  "children": []
                },
                {
                  "value": "List[APIKeyPermission]",
                  "children": [
                    {
                      "value": "List[APIKeyPermission]",
                      "children": [
                        {
                          "value": "List",
                          "children": []
                        },
                        {
                          "value": "[APIKeyPermission]",
                          "children": [
                            {
                              "value": "APIKeyPermission",
                              "children": [
                                {
                                  "value": "APIKeyPermission",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "value": "description: Optional[str] = None",
              "children": [
                {
                  "value": "description",
                  "children": []
                },
                {
                  "value": "Optional[str]",
                  "children": [
                    {
                      "value": "Optional[str]",
                      "children": [
                        {
                          "value": "Optional",
                          "children": []
                        },
                        {
                          "value": "[str]",
                          "children": [
                            {
                              "value": "str",
                              "children": [
                                {
                                  "value": "str",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "None",
                  "children": []
                }
              ]
            }
          ]
        },
        {
          "value": "tuple[APIKeyWithoutHash, str]",
          "children": [
            {
              "value": "tuple[APIKeyWithoutHash, str]",
              "children": [
                {
                  "value": "tuple",
                  "children": []
                },
                {
                  "value": "[APIKeyWithoutHash, str]",
                  "children": [
                    {
                      "value": "APIKeyWithoutHash",
                      "children": [
                        {
                          "value": "APIKeyWithoutHash",
                          "children": []
                        }
                      ]
                    },
                    {
                      "value": "str",
                      "children": [
                        {
                          "value": "str",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "\"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"\n    try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n    except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
          "children": [
            {
              "value": "\"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"",
              "children": [
                {
                  "value": "\"\"\"\n    Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.\n    \"\"\"",
                  "children": [
                    {
                      "value": "\"\"\"",
                      "children": []
                    },
                    {
                      "value": "Generate a new API key and store it in the database.\n    Returns the API key object (without hash) and the plain text key.",
                      "children": []
                    },
                    {
                      "value": "\"\"\"",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "try:\n        api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw\n    except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
              "children": [
                {
                  "value": "api_manager = APIKeyManager()\n        key = api_manager.generate_api_key()\n\n        api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )\n\n        api_key_without_hash = APIKeyWithoutHash.from_db(api_key)\n        return api_key_without_hash, key.raw",
                  "children": [
                    {
                      "value": "api_manager = APIKeyManager()",
                      "children": [
                        {
                          "value": "api_manager = APIKeyManager()",
                          "children": [
                            {
                              "value": "api_manager",
                              "children": []
                            },
                            {
                              "value": "APIKeyManager()",
                              "children": [
                                {
                                  "value": "APIKeyManager",
                                  "children": []
                                },
                                {
                                  "value": "()",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "key = api_manager.generate_api_key()",
                      "children": [
                        {
                          "value": "key = api_manager.generate_api_key()",
                          "children": [
                            {
                              "value": "key",
                              "children": []
                            },
                            {
                              "value": "api_manager.generate_api_key()",
                              "children": [
                                {
                                  "value": "api_manager.generate_api_key",
                                  "children": [
                                    {
                                      "value": "api_manager",
                                      "children": []
                                    },
                                    {
                                      "value": "generate_api_key",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "()",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                      "children": [
                        {
                          "value": "api_key = await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().create(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().create",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "create",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\n            data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )\n        )",
                                      "children": [
                                        {
                                          "value": "data=APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )",
                                          "children": [
                                            {
                                              "value": "data",
                                              "children": []
                                            },
                                            {
                                              "value": "APIKeyCreateInput(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )",
                                              "children": [
                                                {
                                                  "value": "APIKeyCreateInput",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(\n                id=str(uuid.uuid4()),\n                name=name,\n                prefix=key.prefix,\n                postfix=key.postfix,\n                key=key.hash,\n                permissions=[p for p in permissions],\n                description=description,\n                userId=user_id,\n            )",
                                                  "children": [
                                                    {
                                                      "value": "id=str(uuid.uuid4())",
                                                      "children": [
                                                        {
                                                          "value": "id",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "str(uuid.uuid4())",
                                                          "children": [
                                                            {
                                                              "value": "str",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "(uuid.uuid4())",
                                                              "children": [
                                                                {
                                                                  "value": "uuid.uuid4()",
                                                                  "children": [
                                                                    {
                                                                      "value": "uuid.uuid4",
                                                                      "children": [
                                                                        {
                                                                          "value": "uuid",
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "value": "uuid4",
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "value": "()",
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "name=name",
                                                      "children": [
                                                        {
                                                          "value": "name",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "name",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "prefix=key.prefix",
                                                      "children": [
                                                        {
                                                          "value": "prefix",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "key.prefix",
                                                          "children": [
                                                            {
                                                              "value": "key",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "prefix",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "postfix=key.postfix",
                                                      "children": [
                                                        {
                                                          "value": "postfix",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "key.postfix",
                                                          "children": [
                                                            {
                                                              "value": "key",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "postfix",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "key=key.hash",
                                                      "children": [
                                                        {
                                                          "value": "key",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "key.hash",
                                                          "children": [
                                                            {
                                                              "value": "key",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "hash",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "permissions=[p for p in permissions]",
                                                      "children": [
                                                        {
                                                          "value": "permissions",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "[p for p in permissions]",
                                                          "children": [
                                                            {
                                                              "value": "p",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "for p in permissions",
                                                              "children": [
                                                                {
                                                                  "value": "p",
                                                                  "children": []
                                                                },
                                                                {
                                                                  "value": "permissions",
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "description=description",
                                                      "children": [
                                                        {
                                                          "value": "description",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "description",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "userId=user_id",
                                                      "children": [
                                                        {
                                                          "value": "userId",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "user_id",
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "api_key_without_hash = APIKeyWithoutHash.from_db(api_key)",
                      "children": [
                        {
                          "value": "api_key_without_hash = APIKeyWithoutHash.from_db(api_key)",
                          "children": [
                            {
                              "value": "api_key_without_hash",
                              "children": []
                            },
                            {
                              "value": "APIKeyWithoutHash.from_db(api_key)",
                              "children": [
                                {
                                  "value": "APIKeyWithoutHash.from_db",
                                  "children": [
                                    {
                                      "value": "APIKeyWithoutHash",
                                      "children": []
                                    },
                                    {
                                      "value": "from_db",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(api_key)",
                                  "children": [
                                    {
                                      "value": "api_key",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "return api_key_without_hash, key.raw",
                      "children": [
                        {
                          "value": "api_key_without_hash, key.raw",
                          "children": [
                            {
                              "value": "api_key_without_hash",
                              "children": []
                            },
                            {
                              "value": "key.raw",
                              "children": [
                                {
                                  "value": "key",
                                  "children": []
                                },
                                {
                                  "value": "raw",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except PrismaError as e:\n        logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "PrismaError as e",
                      "children": [
                        {
                          "value": "PrismaError",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Database error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Database error while generating API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Database error while generating API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Database error while generating API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Database error while generating API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Database error while generating API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to generate API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to generate API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to generate API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Unexpected error while generating API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Unexpected error while generating API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Unexpected error while generating API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Unexpected error while generating API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Unexpected error while generating API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Unexpected error while generating API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to generate API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to generate API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to generate API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to generate API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "async def validate_api_key(plain_text_key: str) -> Optional[APIKey]:\n    \"\"\"\n    Validate an API key and return the API key object if valid.\n    \"\"\"\n    try:\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)\n    except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
      "children": [
        {
          "value": "validate_api_key",
          "children": []
        },
        {
          "value": "(plain_text_key: str)",
          "children": [
            {
              "value": "plain_text_key: str",
              "children": [
                {
                  "value": "plain_text_key",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "Optional[APIKey]",
          "children": [
            {
              "value": "Optional[APIKey]",
              "children": [
                {
                  "value": "Optional",
                  "children": []
                },
                {
                  "value": "[APIKey]",
                  "children": [
                    {
                      "value": "APIKey",
                      "children": [
                        {
                          "value": "APIKey",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "\"\"\"\n    Validate an API key and return the API key object if valid.\n    \"\"\"\n    try:\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)\n    except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
          "children": [
            {
              "value": "\"\"\"\n    Validate an API key and return the API key object if valid.\n    \"\"\"",
              "children": [
                {
                  "value": "\"\"\"\n    Validate an API key and return the API key object if valid.\n    \"\"\"",
                  "children": [
                    {
                      "value": "\"\"\"",
                      "children": []
                    },
                    {
                      "value": "Validate an API key and return the API key object if valid.",
                      "children": []
                    },
                    {
                      "value": "\"\"\"",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "try:\n        if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)\n    except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
              "children": [
                {
                  "value": "if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None\n\n        prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]\n        api_manager = APIKeyManager()\n\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )\n\n        if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None\n\n        is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)\n        if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None\n\n        return APIKey.from_db(api_key)",
                  "children": [
                    {
                      "value": "if not plain_text_key.startswith(APIKeyManager.PREFIX):\n            logger.warning(\"Invalid API key format\")\n            return None",
                      "children": [
                        {
                          "value": "not plain_text_key.startswith(APIKeyManager.PREFIX)",
                          "children": [
                            {
                              "value": "plain_text_key.startswith(APIKeyManager.PREFIX)",
                              "children": [
                                {
                                  "value": "plain_text_key.startswith",
                                  "children": [
                                    {
                                      "value": "plain_text_key",
                                      "children": []
                                    },
                                    {
                                      "value": "startswith",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(APIKeyManager.PREFIX)",
                                  "children": [
                                    {
                                      "value": "APIKeyManager.PREFIX",
                                      "children": [
                                        {
                                          "value": "APIKeyManager",
                                          "children": []
                                        },
                                        {
                                          "value": "PREFIX",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "logger.warning(\"Invalid API key format\")\n            return None",
                          "children": [
                            {
                              "value": "logger.warning(\"Invalid API key format\")",
                              "children": [
                                {
                                  "value": "logger.warning(\"Invalid API key format\")",
                                  "children": [
                                    {
                                      "value": "logger.warning",
                                      "children": [
                                        {
                                          "value": "logger",
                                          "children": []
                                        },
                                        {
                                          "value": "warning",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\"Invalid API key format\")",
                                      "children": [
                                        {
                                          "value": "\"Invalid API key format\"",
                                          "children": [
                                            {
                                              "value": "\"",
                                              "children": []
                                            },
                                            {
                                              "value": "Invalid API key format",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "value": "return None",
                              "children": [
                                {
                                  "value": "None",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]",
                      "children": [
                        {
                          "value": "prefix = plain_text_key[: APIKeyManager.PREFIX_LENGTH]",
                          "children": [
                            {
                              "value": "prefix",
                              "children": []
                            },
                            {
                              "value": "plain_text_key[: APIKeyManager.PREFIX_LENGTH]",
                              "children": [
                                {
                                  "value": "plain_text_key",
                                  "children": []
                                },
                                {
                                  "value": ": APIKeyManager.PREFIX_LENGTH",
                                  "children": [
                                    {
                                      "value": "APIKeyManager.PREFIX_LENGTH",
                                      "children": [
                                        {
                                          "value": "APIKeyManager",
                                          "children": []
                                        },
                                        {
                                          "value": "PREFIX_LENGTH",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "api_manager = APIKeyManager()",
                      "children": [
                        {
                          "value": "api_manager = APIKeyManager()",
                          "children": [
                            {
                              "value": "api_manager",
                              "children": []
                            },
                            {
                              "value": "APIKeyManager()",
                              "children": [
                                {
                                  "value": "APIKeyManager",
                                  "children": []
                                },
                                {
                                  "value": "()",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                      "children": [
                        {
                          "value": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().find_first",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "find_first",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\n            where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))\n        )",
                                      "children": [
                                        {
                                          "value": "where=APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "APIKeyWhereInput(prefix=prefix, status=(APIKeyStatus.ACTIVE))",
                                              "children": [
                                                {
                                                  "value": "APIKeyWhereInput",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(prefix=prefix, status=(APIKeyStatus.ACTIVE))",
                                                  "children": [
                                                    {
                                                      "value": "prefix=prefix",
                                                      "children": [
                                                        {
                                                          "value": "prefix",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "prefix",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "status=(APIKeyStatus.ACTIVE)",
                                                      "children": [
                                                        {
                                                          "value": "status",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "(APIKeyStatus.ACTIVE)",
                                                          "children": [
                                                            {
                                                              "value": "APIKeyStatus.ACTIVE",
                                                              "children": [
                                                                {
                                                                  "value": "APIKeyStatus",
                                                                  "children": []
                                                                },
                                                                {
                                                                  "value": "ACTIVE",
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if not api_key:\n            logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None",
                      "children": [
                        {
                          "value": "not api_key",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "logger.warning(f\"No active API key found with prefix {prefix}\")\n            return None",
                          "children": [
                            {
                              "value": "logger.warning(f\"No active API key found with prefix {prefix}\")",
                              "children": [
                                {
                                  "value": "logger.warning(f\"No active API key found with prefix {prefix}\")",
                                  "children": [
                                    {
                                      "value": "logger.warning",
                                      "children": [
                                        {
                                          "value": "logger",
                                          "children": []
                                        },
                                        {
                                          "value": "warning",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(f\"No active API key found with prefix {prefix}\")",
                                      "children": [
                                        {
                                          "value": "f\"No active API key found with prefix {prefix}\"",
                                          "children": [
                                            {
                                              "value": "f\"",
                                              "children": []
                                            },
                                            {
                                              "value": "No active API key found with prefix",
                                              "children": []
                                            },
                                            {
                                              "value": "{prefix}",
                                              "children": [
                                                {
                                                  "value": "prefix",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "value": "return None",
                              "children": [
                                {
                                  "value": "None",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)",
                      "children": [
                        {
                          "value": "is_valid = api_manager.verify_api_key(plain_text_key, api_key.key)",
                          "children": [
                            {
                              "value": "is_valid",
                              "children": []
                            },
                            {
                              "value": "api_manager.verify_api_key(plain_text_key, api_key.key)",
                              "children": [
                                {
                                  "value": "api_manager.verify_api_key",
                                  "children": [
                                    {
                                      "value": "api_manager",
                                      "children": []
                                    },
                                    {
                                      "value": "verify_api_key",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(plain_text_key, api_key.key)",
                                  "children": [
                                    {
                                      "value": "plain_text_key",
                                      "children": []
                                    },
                                    {
                                      "value": "api_key.key",
                                      "children": [
                                        {
                                          "value": "api_key",
                                          "children": []
                                        },
                                        {
                                          "value": "key",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if not is_valid:\n            logger.warning(\"API key verification failed\")\n            return None",
                      "children": [
                        {
                          "value": "not is_valid",
                          "children": [
                            {
                              "value": "is_valid",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "logger.warning(\"API key verification failed\")\n            return None",
                          "children": [
                            {
                              "value": "logger.warning(\"API key verification failed\")",
                              "children": [
                                {
                                  "value": "logger.warning(\"API key verification failed\")",
                                  "children": [
                                    {
                                      "value": "logger.warning",
                                      "children": [
                                        {
                                          "value": "logger",
                                          "children": []
                                        },
                                        {
                                          "value": "warning",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\"API key verification failed\")",
                                      "children": [
                                        {
                                          "value": "\"API key verification failed\"",
                                          "children": [
                                            {
                                              "value": "\"",
                                              "children": []
                                            },
                                            {
                                              "value": "API key verification failed",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "value": "return None",
                              "children": [
                                {
                                  "value": "None",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "return APIKey.from_db(api_key)",
                      "children": [
                        {
                          "value": "APIKey.from_db(api_key)",
                          "children": [
                            {
                              "value": "APIKey.from_db",
                              "children": [
                                {
                                  "value": "APIKey",
                                  "children": []
                                },
                                {
                                  "value": "from_db",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "(api_key)",
                              "children": [
                                {
                                  "value": "api_key",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Error validating API key: {str(e)}\")\n        raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Error validating API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Error validating API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Error validating API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Error validating API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Error validating API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyValidationError(f\"Failed to validate API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyValidationError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to validate API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to validate API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to validate API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "async def revoke_api_key(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
      "children": [
        {
          "value": "revoke_api_key",
          "children": []
        },
        {
          "value": "(key_id: str, user_id: str)",
          "children": [
            {
              "value": "key_id: str",
              "children": [
                {
                  "value": "key_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "Optional[APIKeyWithoutHash]",
          "children": [
            {
              "value": "Optional[APIKeyWithoutHash]",
              "children": [
                {
                  "value": "Optional",
                  "children": []
                },
                {
                  "value": "[APIKeyWithoutHash]",
                  "children": [
                    {
                      "value": "APIKeyWithoutHash",
                      "children": [
                        {
                          "value": "APIKeyWithoutHash",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
          "children": [
            {
              "value": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
              "children": [
                {
                  "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None",
                  "children": [
                    {
                      "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                      "children": [
                        {
                          "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().find_unique",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "find_unique",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(where={\"id\": key_id})",
                                      "children": [
                                        {
                                          "value": "where={\"id\": key_id}",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "{\"id\": key_id}",
                                              "children": [
                                                {
                                                  "value": "\"id\": key_id",
                                                  "children": [
                                                    {
                                                      "value": "\"id\"",
                                                      "children": [
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "id",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "key_id",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                      "children": [
                        {
                          "value": "not api_key",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                          "children": [
                            {
                              "value": "raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                              "children": [
                                {
                                  "value": "APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                  "children": [
                                    {
                                      "value": "APIKeyNotFoundError",
                                      "children": []
                                    },
                                    {
                                      "value": "(f\"API key with id {key_id} not found\")",
                                      "children": [
                                        {
                                          "value": "f\"API key with id {key_id} not found\"",
                                          "children": [
                                            {
                                              "value": "f\"",
                                              "children": []
                                            },
                                            {
                                              "value": "API key with id",
                                              "children": []
                                            },
                                            {
                                              "value": "{key_id}",
                                              "children": [
                                                {
                                                  "value": "key_id",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "not found",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )",
                      "children": [
                        {
                          "value": "api_key.userId != user_id",
                          "children": [
                            {
                              "value": "api_key.userId",
                              "children": [
                                {
                                  "value": "api_key",
                                  "children": []
                                },
                                {
                                  "value": "userId",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "user_id",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )",
                          "children": [
                            {
                              "value": "raise APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )",
                              "children": [
                                {
                                  "value": "APIKeyPermissionError(\n                \"You do not have permission to revoke this API key.\"\n            )",
                                  "children": [
                                    {
                                      "value": "APIKeyPermissionError",
                                      "children": []
                                    },
                                    {
                                      "value": "(\n                \"You do not have permission to revoke this API key.\"\n            )",
                                      "children": [
                                        {
                                          "value": "\"You do not have permission to revoke this API key.\"",
                                          "children": [
                                            {
                                              "value": "\"",
                                              "children": []
                                            },
                                            {
                                              "value": "You do not have permission to revoke this API key.",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                      "children": [
                        {
                          "value": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                          "children": [
                            {
                              "value": "where_clause",
                              "children": []
                            },
                            {
                              "value": "APIKeyWhereUniqueInput",
                              "children": [
                                {
                                  "value": "APIKeyWhereUniqueInput",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "{\"id\": key_id}",
                              "children": [
                                {
                                  "value": "\"id\": key_id",
                                  "children": [
                                    {
                                      "value": "\"id\"",
                                      "children": [
                                        {
                                          "value": "\"",
                                          "children": []
                                        },
                                        {
                                          "value": "id",
                                          "children": []
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "key_id",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                      "children": [
                        {
                          "value": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                          "children": [
                            {
                              "value": "updated_api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().update",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "update",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\n            where=where_clause,\n            data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            ),\n        )",
                                      "children": [
                                        {
                                          "value": "where=where_clause",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "where_clause",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "data=APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            )",
                                          "children": [
                                            {
                                              "value": "data",
                                              "children": []
                                            },
                                            {
                                              "value": "APIKeyUpdateInput(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            )",
                                              "children": [
                                                {
                                                  "value": "APIKeyUpdateInput",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(\n                status=APIKeyStatus.REVOKED, revokedAt=datetime.now(timezone.utc)\n            )",
                                                  "children": [
                                                    {
                                                      "value": "status=APIKeyStatus.REVOKED",
                                                      "children": [
                                                        {
                                                          "value": "status",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "APIKeyStatus.REVOKED",
                                                          "children": [
                                                            {
                                                              "value": "APIKeyStatus",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "REVOKED",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "revokedAt=datetime.now(timezone.utc)",
                                                      "children": [
                                                        {
                                                          "value": "revokedAt",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "datetime.now(timezone.utc)",
                                                          "children": [
                                                            {
                                                              "value": "datetime.now",
                                                              "children": [
                                                                {
                                                                  "value": "datetime",
                                                                  "children": []
                                                                },
                                                                {
                                                                  "value": "now",
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "value": "(timezone.utc)",
                                                              "children": [
                                                                {
                                                                  "value": "timezone.utc",
                                                                  "children": [
                                                                    {
                                                                      "value": "timezone",
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "value": "utc",
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)",
                      "children": [
                        {
                          "value": "updated_api_key",
                          "children": []
                        },
                        {
                          "value": "return APIKeyWithoutHash.from_db(updated_api_key)",
                          "children": [
                            {
                              "value": "return APIKeyWithoutHash.from_db(updated_api_key)",
                              "children": [
                                {
                                  "value": "APIKeyWithoutHash.from_db(updated_api_key)",
                                  "children": [
                                    {
                                      "value": "APIKeyWithoutHash.from_db",
                                      "children": [
                                        {
                                          "value": "APIKeyWithoutHash",
                                          "children": []
                                        },
                                        {
                                          "value": "from_db",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(updated_api_key)",
                                      "children": [
                                        {
                                          "value": "updated_api_key",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "return None",
                      "children": [
                        {
                          "value": "None",
                          "children": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e",
                  "children": [
                    {
                      "value": "(APIKeyNotFoundError, APIKeyPermissionError) as e",
                      "children": [
                        {
                          "value": "(APIKeyNotFoundError, APIKeyPermissionError)",
                          "children": [
                            {
                              "value": "APIKeyNotFoundError",
                              "children": []
                            },
                            {
                              "value": "APIKeyPermissionError",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "raise e",
                      "children": [
                        {
                          "value": "raise e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except PrismaError as e:\n        logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "PrismaError as e",
                      "children": [
                        {
                          "value": "PrismaError",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Database error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Database error while revoking API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Database error while revoking API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Database error while revoking API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Database error while revoking API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Database error while revoking API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to revoke API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to revoke API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to revoke API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Unexpected error while revoking API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Unexpected error while revoking API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Unexpected error while revoking API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Unexpected error while revoking API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Unexpected error while revoking API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Unexpected error while revoking API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to revoke API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to revoke API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to revoke API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to revoke API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "async def list_user_api_keys(user_id: str) -> List[APIKeyWithoutHash]:\n    try:\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n    except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
      "children": [
        {
          "value": "list_user_api_keys",
          "children": []
        },
        {
          "value": "(user_id: str)",
          "children": [
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "List[APIKeyWithoutHash]",
          "children": [
            {
              "value": "List[APIKeyWithoutHash]",
              "children": [
                {
                  "value": "List",
                  "children": []
                },
                {
                  "value": "[APIKeyWithoutHash]",
                  "children": [
                    {
                      "value": "APIKeyWithoutHash",
                      "children": [
                        {
                          "value": "APIKeyWithoutHash",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "try:\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n    except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
          "children": [
            {
              "value": "try:\n        where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]\n    except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
              "children": [
                {
                  "value": "where_clause: APIKeyWhereInput = {\"userId\": user_id}\n\n        api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )\n\n        return [APIKeyWithoutHash.from_db(key) for key in api_keys]",
                  "children": [
                    {
                      "value": "where_clause: APIKeyWhereInput = {\"userId\": user_id}",
                      "children": [
                        {
                          "value": "where_clause: APIKeyWhereInput = {\"userId\": user_id}",
                          "children": [
                            {
                              "value": "where_clause",
                              "children": []
                            },
                            {
                              "value": "APIKeyWhereInput",
                              "children": [
                                {
                                  "value": "APIKeyWhereInput",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "{\"userId\": user_id}",
                              "children": [
                                {
                                  "value": "\"userId\": user_id",
                                  "children": [
                                    {
                                      "value": "\"userId\"",
                                      "children": [
                                        {
                                          "value": "\"",
                                          "children": []
                                        },
                                        {
                                          "value": "userId",
                                          "children": []
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "user_id",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                      "children": [
                        {
                          "value": "api_keys = await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                          "children": [
                            {
                              "value": "api_keys",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().find_many(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().find_many",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "find_many",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\n            where=where_clause, order={\"createdAt\": \"desc\"}\n        )",
                                      "children": [
                                        {
                                          "value": "where=where_clause",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "where_clause",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "order={\"createdAt\": \"desc\"}",
                                          "children": [
                                            {
                                              "value": "order",
                                              "children": []
                                            },
                                            {
                                              "value": "{\"createdAt\": \"desc\"}",
                                              "children": [
                                                {
                                                  "value": "\"createdAt\": \"desc\"",
                                                  "children": [
                                                    {
                                                      "value": "\"createdAt\"",
                                                      "children": [
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "createdAt",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "\"desc\"",
                                                      "children": [
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "desc",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "return [APIKeyWithoutHash.from_db(key) for key in api_keys]",
                      "children": [
                        {
                          "value": "[APIKeyWithoutHash.from_db(key) for key in api_keys]",
                          "children": [
                            {
                              "value": "APIKeyWithoutHash.from_db(key)",
                              "children": [
                                {
                                  "value": "APIKeyWithoutHash.from_db",
                                  "children": [
                                    {
                                      "value": "APIKeyWithoutHash",
                                      "children": []
                                    },
                                    {
                                      "value": "from_db",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(key)",
                                  "children": [
                                    {
                                      "value": "key",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "value": "for key in api_keys",
                              "children": [
                                {
                                  "value": "key",
                                  "children": []
                                },
                                {
                                  "value": "api_keys",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except PrismaError as e:\n        logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                  "children": [
                    {
                      "value": "PrismaError as e",
                      "children": [
                        {
                          "value": "PrismaError",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Database error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Database error while listing API keys: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Database error while listing API keys: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Database error while listing API keys: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Database error while listing API keys: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Database error while listing API keys:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to list API keys: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to list API keys: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to list API keys:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Unexpected error while listing API keys: {str(e)}\")\n        raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Unexpected error while listing API keys: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Unexpected error while listing API keys: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Unexpected error while listing API keys: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Unexpected error while listing API keys: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Unexpected error while listing API keys:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to list API keys: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to list API keys: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to list API keys: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to list API keys:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "async def suspend_api_key(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
      "children": [
        {
          "value": "suspend_api_key",
          "children": []
        },
        {
          "value": "(key_id: str, user_id: str)",
          "children": [
            {
              "value": "key_id: str",
              "children": [
                {
                  "value": "key_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "Optional[APIKeyWithoutHash]",
          "children": [
            {
              "value": "Optional[APIKeyWithoutHash]",
              "children": [
                {
                  "value": "Optional",
                  "children": []
                },
                {
                  "value": "[APIKeyWithoutHash]",
                  "children": [
                    {
                      "value": "APIKeyWithoutHash",
                      "children": [
                        {
                          "value": "APIKeyWithoutHash",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
          "children": [
            {
              "value": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
              "children": [
                {
                  "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None",
                  "children": [
                    {
                      "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                      "children": [
                        {
                          "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().find_unique",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "find_unique",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(where={\"id\": key_id})",
                                      "children": [
                                        {
                                          "value": "where={\"id\": key_id}",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "{\"id\": key_id}",
                                              "children": [
                                                {
                                                  "value": "\"id\": key_id",
                                                  "children": [
                                                    {
                                                      "value": "\"id\"",
                                                      "children": [
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "id",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "key_id",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if not api_key:\n            raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                      "children": [
                        {
                          "value": "not api_key",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                          "children": [
                            {
                              "value": "raise APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                              "children": [
                                {
                                  "value": "APIKeyNotFoundError(f\"API key with id {key_id} not found\")",
                                  "children": [
                                    {
                                      "value": "APIKeyNotFoundError",
                                      "children": []
                                    },
                                    {
                                      "value": "(f\"API key with id {key_id} not found\")",
                                      "children": [
                                        {
                                          "value": "f\"API key with id {key_id} not found\"",
                                          "children": [
                                            {
                                              "value": "f\"",
                                              "children": []
                                            },
                                            {
                                              "value": "API key with id",
                                              "children": []
                                            },
                                            {
                                              "value": "{key_id}",
                                              "children": [
                                                {
                                                  "value": "key_id",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "not found",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                      "children": [
                        {
                          "value": "api_key.userId != user_id",
                          "children": [
                            {
                              "value": "api_key.userId",
                              "children": [
                                {
                                  "value": "api_key",
                                  "children": []
                                },
                                {
                                  "value": "userId",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "user_id",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                          "children": [
                            {
                              "value": "raise APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                              "children": [
                                {
                                  "value": "APIKeyPermissionError(\n                \"You do not have permission to suspend this API key.\"\n            )",
                                  "children": [
                                    {
                                      "value": "APIKeyPermissionError",
                                      "children": []
                                    },
                                    {
                                      "value": "(\n                \"You do not have permission to suspend this API key.\"\n            )",
                                      "children": [
                                        {
                                          "value": "\"You do not have permission to suspend this API key.\"",
                                          "children": [
                                            {
                                              "value": "\"",
                                              "children": []
                                            },
                                            {
                                              "value": "You do not have permission to suspend this API key.",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                      "children": [
                        {
                          "value": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                          "children": [
                            {
                              "value": "where_clause",
                              "children": []
                            },
                            {
                              "value": "APIKeyWhereUniqueInput",
                              "children": [
                                {
                                  "value": "APIKeyWhereUniqueInput",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "{\"id\": key_id}",
                              "children": [
                                {
                                  "value": "\"id\": key_id",
                                  "children": [
                                    {
                                      "value": "\"id\"",
                                      "children": [
                                        {
                                          "value": "\"",
                                          "children": []
                                        },
                                        {
                                          "value": "id",
                                          "children": []
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "key_id",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                      "children": [
                        {
                          "value": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                          "children": [
                            {
                              "value": "updated_api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().update",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "update",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\n            where=where_clause,\n            data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED),\n        )",
                                      "children": [
                                        {
                                          "value": "where=where_clause",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "where_clause",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "data=APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED)",
                                          "children": [
                                            {
                                              "value": "data",
                                              "children": []
                                            },
                                            {
                                              "value": "APIKeyUpdateInput(status=APIKeyStatus.SUSPENDED)",
                                              "children": [
                                                {
                                                  "value": "APIKeyUpdateInput",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(status=APIKeyStatus.SUSPENDED)",
                                                  "children": [
                                                    {
                                                      "value": "status=APIKeyStatus.SUSPENDED",
                                                      "children": [
                                                        {
                                                          "value": "status",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "APIKeyStatus.SUSPENDED",
                                                          "children": [
                                                            {
                                                              "value": "APIKeyStatus",
                                                              "children": []
                                                            },
                                                            {
                                                              "value": "SUSPENDED",
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)",
                      "children": [
                        {
                          "value": "updated_api_key",
                          "children": []
                        },
                        {
                          "value": "return APIKeyWithoutHash.from_db(updated_api_key)",
                          "children": [
                            {
                              "value": "return APIKeyWithoutHash.from_db(updated_api_key)",
                              "children": [
                                {
                                  "value": "APIKeyWithoutHash.from_db(updated_api_key)",
                                  "children": [
                                    {
                                      "value": "APIKeyWithoutHash.from_db",
                                      "children": [
                                        {
                                          "value": "APIKeyWithoutHash",
                                          "children": []
                                        },
                                        {
                                          "value": "from_db",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(updated_api_key)",
                                      "children": [
                                        {
                                          "value": "updated_api_key",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "return None",
                      "children": [
                        {
                          "value": "None",
                          "children": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e",
                  "children": [
                    {
                      "value": "(APIKeyNotFoundError, APIKeyPermissionError) as e",
                      "children": [
                        {
                          "value": "(APIKeyNotFoundError, APIKeyPermissionError)",
                          "children": [
                            {
                              "value": "APIKeyNotFoundError",
                              "children": []
                            },
                            {
                              "value": "APIKeyPermissionError",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "raise e",
                      "children": [
                        {
                          "value": "raise e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except PrismaError as e:\n        logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "PrismaError as e",
                      "children": [
                        {
                          "value": "PrismaError",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Database error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Database error while suspending API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Database error while suspending API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Database error while suspending API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Database error while suspending API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Database error while suspending API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to suspend API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to suspend API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to suspend API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Unexpected error while suspending API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Unexpected error while suspending API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Unexpected error while suspending API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Unexpected error while suspending API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Unexpected error while suspending API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Unexpected error while suspending API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to suspend API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to suspend API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to suspend API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to suspend API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "def has_permission(api_key: APIKey, required_permission: APIKeyPermission) -> bool:\n    try:\n        return required_permission in api_key.permissions\n    except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
      "children": [
        {
          "value": "has_permission",
          "children": []
        },
        {
          "value": "(api_key: APIKey, required_permission: APIKeyPermission)",
          "children": [
            {
              "value": "api_key: APIKey",
              "children": [
                {
                  "value": "api_key",
                  "children": []
                },
                {
                  "value": "APIKey",
                  "children": [
                    {
                      "value": "APIKey",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "required_permission: APIKeyPermission",
              "children": [
                {
                  "value": "required_permission",
                  "children": []
                },
                {
                  "value": "APIKeyPermission",
                  "children": [
                    {
                      "value": "APIKeyPermission",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "bool",
          "children": [
            {
              "value": "bool",
              "children": []
            }
          ]
        },
        {
          "value": "try:\n        return required_permission in api_key.permissions\n    except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
          "children": [
            {
              "value": "try:\n        return required_permission in api_key.permissions\n    except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
              "children": [
                {
                  "value": "return required_permission in api_key.permissions",
                  "children": [
                    {
                      "value": "return required_permission in api_key.permissions",
                      "children": [
                        {
                          "value": "required_permission in api_key.permissions",
                          "children": [
                            {
                              "value": "required_permission",
                              "children": []
                            },
                            {
                              "value": "api_key.permissions",
                              "children": [
                                {
                                  "value": "api_key",
                                  "children": []
                                },
                                {
                                  "value": "permissions",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Error checking API key permissions: {str(e)}\")\n        return False",
                      "children": [
                        {
                          "value": "logger.error(f\"Error checking API key permissions: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Error checking API key permissions: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Error checking API key permissions: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Error checking API key permissions: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Error checking API key permissions:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "return False",
                          "children": [
                            {
                              "value": "False",
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "async def get_api_key_by_id(key_id: str, user_id: str) -> Optional[APIKeyWithoutHash]:\n    try:\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)\n    except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
      "children": [
        {
          "value": "get_api_key_by_id",
          "children": []
        },
        {
          "value": "(key_id: str, user_id: str)",
          "children": [
            {
              "value": "key_id: str",
              "children": [
                {
                  "value": "key_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "Optional[APIKeyWithoutHash]",
          "children": [
            {
              "value": "Optional[APIKeyWithoutHash]",
              "children": [
                {
                  "value": "Optional",
                  "children": []
                },
                {
                  "value": "[APIKeyWithoutHash]",
                  "children": [
                    {
                      "value": "APIKeyWithoutHash",
                      "children": [
                        {
                          "value": "APIKeyWithoutHash",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "try:\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)\n    except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
          "children": [
            {
              "value": "try:\n        api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)\n    except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
              "children": [
                {
                  "value": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )\n\n        if not api_key:\n            return None\n\n        return APIKeyWithoutHash.from_db(api_key)",
                  "children": [
                    {
                      "value": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )",
                      "children": [
                        {
                          "value": "api_key = await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().find_first(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().find_first",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "find_first",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\n            where=APIKeyWhereInput(id=key_id, userId=user_id)\n        )",
                                      "children": [
                                        {
                                          "value": "where=APIKeyWhereInput(id=key_id, userId=user_id)",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "APIKeyWhereInput(id=key_id, userId=user_id)",
                                              "children": [
                                                {
                                                  "value": "APIKeyWhereInput",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(id=key_id, userId=user_id)",
                                                  "children": [
                                                    {
                                                      "value": "id=key_id",
                                                      "children": [
                                                        {
                                                          "value": "id",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "key_id",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "userId=user_id",
                                                      "children": [
                                                        {
                                                          "value": "userId",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "user_id",
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if not api_key:\n            return None",
                      "children": [
                        {
                          "value": "not api_key",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "return None",
                          "children": [
                            {
                              "value": "return None",
                              "children": [
                                {
                                  "value": "None",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "return APIKeyWithoutHash.from_db(api_key)",
                      "children": [
                        {
                          "value": "APIKeyWithoutHash.from_db(api_key)",
                          "children": [
                            {
                              "value": "APIKeyWithoutHash.from_db",
                              "children": [
                                {
                                  "value": "APIKeyWithoutHash",
                                  "children": []
                                },
                                {
                                  "value": "from_db",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "(api_key)",
                              "children": [
                                {
                                  "value": "api_key",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except PrismaError as e:\n        logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "PrismaError as e",
                      "children": [
                        {
                          "value": "PrismaError",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Database error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Database error while getting API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Database error while getting API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Database error while getting API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Database error while getting API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Database error while getting API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to get API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to get API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to get API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to get API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Unexpected error while getting API key: {str(e)}\")\n        raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Unexpected error while getting API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Unexpected error while getting API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Unexpected error while getting API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Unexpected error while getting API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Unexpected error while getting API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to get API key: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to get API key: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to get API key: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to get API key: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to get API key:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "value": "async def update_api_key_permissions(\n    key_id: str, user_id: str, permissions: List[APIKeyPermission]\n) -> Optional[APIKeyWithoutHash]:\n    \"\"\"\n    Update the permissions of an API key.\n    \"\"\"\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
      "children": [
        {
          "value": "update_api_key_permissions",
          "children": []
        },
        {
          "value": "(\n    key_id: str, user_id: str, permissions: List[APIKeyPermission]\n)",
          "children": [
            {
              "value": "key_id: str",
              "children": [
                {
                  "value": "key_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "user_id: str",
              "children": [
                {
                  "value": "user_id",
                  "children": []
                },
                {
                  "value": "str",
                  "children": [
                    {
                      "value": "str",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "permissions: List[APIKeyPermission]",
              "children": [
                {
                  "value": "permissions",
                  "children": []
                },
                {
                  "value": "List[APIKeyPermission]",
                  "children": [
                    {
                      "value": "List[APIKeyPermission]",
                      "children": [
                        {
                          "value": "List",
                          "children": []
                        },
                        {
                          "value": "[APIKeyPermission]",
                          "children": [
                            {
                              "value": "APIKeyPermission",
                              "children": [
                                {
                                  "value": "APIKeyPermission",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "Optional[APIKeyWithoutHash]",
          "children": [
            {
              "value": "Optional[APIKeyWithoutHash]",
              "children": [
                {
                  "value": "Optional",
                  "children": []
                },
                {
                  "value": "[APIKeyWithoutHash]",
                  "children": [
                    {
                      "value": "APIKeyWithoutHash",
                      "children": [
                        {
                          "value": "APIKeyWithoutHash",
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "value": "\"\"\"\n    Update the permissions of an API key.\n    \"\"\"\n    try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
          "children": [
            {
              "value": "\"\"\"\n    Update the permissions of an API key.\n    \"\"\"",
              "children": [
                {
                  "value": "\"\"\"\n    Update the permissions of an API key.\n    \"\"\"",
                  "children": [
                    {
                      "value": "\"\"\"",
                      "children": []
                    },
                    {
                      "value": "Update the permissions of an API key.",
                      "children": []
                    },
                    {
                      "value": "\"\"\"",
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "value": "try:\n        api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None\n    except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e\n    except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")\n    except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
              "children": [
                {
                  "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})\n\n        if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")\n\n        if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )\n\n        where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}\n        updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )\n\n        if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)\n        return None",
                  "children": [
                    {
                      "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                      "children": [
                        {
                          "value": "api_key = await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().find_unique(where={\"id\": key_id})",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().find_unique",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "find_unique",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(where={\"id\": key_id})",
                                      "children": [
                                        {
                                          "value": "where={\"id\": key_id}",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "{\"id\": key_id}",
                                              "children": [
                                                {
                                                  "value": "\"id\": key_id",
                                                  "children": [
                                                    {
                                                      "value": "\"id\"",
                                                      "children": [
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "id",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "\"",
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "value": "key_id",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if api_key is None:\n            raise APIKeyNotFoundError(\"No such API key found.\")",
                      "children": [
                        {
                          "value": "api_key is None",
                          "children": [
                            {
                              "value": "api_key",
                              "children": []
                            },
                            {
                              "value": "None",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyNotFoundError(\"No such API key found.\")",
                          "children": [
                            {
                              "value": "raise APIKeyNotFoundError(\"No such API key found.\")",
                              "children": [
                                {
                                  "value": "APIKeyNotFoundError(\"No such API key found.\")",
                                  "children": [
                                    {
                                      "value": "APIKeyNotFoundError",
                                      "children": []
                                    },
                                    {
                                      "value": "(\"No such API key found.\")",
                                      "children": [
                                        {
                                          "value": "\"No such API key found.\"",
                                          "children": [
                                            {
                                              "value": "\"",
                                              "children": []
                                            },
                                            {
                                              "value": "No such API key found.",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if api_key.userId != user_id:\n            raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )",
                      "children": [
                        {
                          "value": "api_key.userId != user_id",
                          "children": [
                            {
                              "value": "api_key.userId",
                              "children": [
                                {
                                  "value": "api_key",
                                  "children": []
                                },
                                {
                                  "value": "userId",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "user_id",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )",
                          "children": [
                            {
                              "value": "raise APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )",
                              "children": [
                                {
                                  "value": "APIKeyPermissionError(\n                \"You do not have permission to update this API key.\"\n            )",
                                  "children": [
                                    {
                                      "value": "APIKeyPermissionError",
                                      "children": []
                                    },
                                    {
                                      "value": "(\n                \"You do not have permission to update this API key.\"\n            )",
                                      "children": [
                                        {
                                          "value": "\"You do not have permission to update this API key.\"",
                                          "children": [
                                            {
                                              "value": "\"",
                                              "children": []
                                            },
                                            {
                                              "value": "You do not have permission to update this API key.",
                                              "children": []
                                            },
                                            {
                                              "value": "\"",
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                      "children": [
                        {
                          "value": "where_clause: APIKeyWhereUniqueInput = {\"id\": key_id}",
                          "children": [
                            {
                              "value": "where_clause",
                              "children": []
                            },
                            {
                              "value": "APIKeyWhereUniqueInput",
                              "children": [
                                {
                                  "value": "APIKeyWhereUniqueInput",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "value": "{\"id\": key_id}",
                              "children": [
                                {
                                  "value": "\"id\": key_id",
                                  "children": [
                                    {
                                      "value": "\"id\"",
                                      "children": [
                                        {
                                          "value": "\"",
                                          "children": []
                                        },
                                        {
                                          "value": "id",
                                          "children": []
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "key_id",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                      "children": [
                        {
                          "value": "updated_api_key = await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                          "children": [
                            {
                              "value": "updated_api_key",
                              "children": []
                            },
                            {
                              "value": "await PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                              "children": [
                                {
                                  "value": "PrismaAPIKey.prisma().update(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                                  "children": [
                                    {
                                      "value": "PrismaAPIKey.prisma().update",
                                      "children": [
                                        {
                                          "value": "PrismaAPIKey.prisma()",
                                          "children": [
                                            {
                                              "value": "PrismaAPIKey.prisma",
                                              "children": [
                                                {
                                                  "value": "PrismaAPIKey",
                                                  "children": []
                                                },
                                                {
                                                  "value": "prisma",
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "value": "()",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "update",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(\n            where=where_clause,\n            data=APIKeyUpdateInput(permissions=permissions),\n        )",
                                      "children": [
                                        {
                                          "value": "where=where_clause",
                                          "children": [
                                            {
                                              "value": "where",
                                              "children": []
                                            },
                                            {
                                              "value": "where_clause",
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "value": "data=APIKeyUpdateInput(permissions=permissions)",
                                          "children": [
                                            {
                                              "value": "data",
                                              "children": []
                                            },
                                            {
                                              "value": "APIKeyUpdateInput(permissions=permissions)",
                                              "children": [
                                                {
                                                  "value": "APIKeyUpdateInput",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(permissions=permissions)",
                                                  "children": [
                                                    {
                                                      "value": "permissions=permissions",
                                                      "children": [
                                                        {
                                                          "value": "permissions",
                                                          "children": []
                                                        },
                                                        {
                                                          "value": "permissions",
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "if updated_api_key:\n            return APIKeyWithoutHash.from_db(updated_api_key)",
                      "children": [
                        {
                          "value": "updated_api_key",
                          "children": []
                        },
                        {
                          "value": "return APIKeyWithoutHash.from_db(updated_api_key)",
                          "children": [
                            {
                              "value": "return APIKeyWithoutHash.from_db(updated_api_key)",
                              "children": [
                                {
                                  "value": "APIKeyWithoutHash.from_db(updated_api_key)",
                                  "children": [
                                    {
                                      "value": "APIKeyWithoutHash.from_db",
                                      "children": [
                                        {
                                          "value": "APIKeyWithoutHash",
                                          "children": []
                                        },
                                        {
                                          "value": "from_db",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "value": "(updated_api_key)",
                                      "children": [
                                        {
                                          "value": "updated_api_key",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "return None",
                      "children": [
                        {
                          "value": "None",
                          "children": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except (APIKeyNotFoundError, APIKeyPermissionError) as e:\n        raise e",
                  "children": [
                    {
                      "value": "(APIKeyNotFoundError, APIKeyPermissionError) as e",
                      "children": [
                        {
                          "value": "(APIKeyNotFoundError, APIKeyPermissionError)",
                          "children": [
                            {
                              "value": "APIKeyNotFoundError",
                              "children": []
                            },
                            {
                              "value": "APIKeyPermissionError",
                              "children": []
                            }
                          ]
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "raise e",
                      "children": [
                        {
                          "value": "raise e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except PrismaError as e:\n        logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                  "children": [
                    {
                      "value": "PrismaError as e",
                      "children": [
                        {
                          "value": "PrismaError",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Database error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Database error while updating API key permissions: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Database error while updating API key permissions: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Database error while updating API key permissions: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Database error while updating API key permissions: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Database error while updating API key permissions:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to update API key permissions: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to update API key permissions: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to update API key permissions:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "value": "except Exception as e:\n        logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                  "children": [
                    {
                      "value": "Exception as e",
                      "children": [
                        {
                          "value": "Exception",
                          "children": []
                        },
                        {
                          "value": "e",
                          "children": [
                            {
                              "value": "e",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "value": "logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")\n        raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                      "children": [
                        {
                          "value": "logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")",
                          "children": [
                            {
                              "value": "logger.error(f\"Unexpected error while updating API key permissions: {str(e)}\")",
                              "children": [
                                {
                                  "value": "logger.error",
                                  "children": [
                                    {
                                      "value": "logger",
                                      "children": []
                                    },
                                    {
                                      "value": "error",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "value": "(f\"Unexpected error while updating API key permissions: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Unexpected error while updating API key permissions: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Unexpected error while updating API key permissions:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "value": "raise APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                          "children": [
                            {
                              "value": "APIKeyError(f\"Failed to update API key permissions: {str(e)}\")",
                              "children": [
                                {
                                  "value": "APIKeyError",
                                  "children": []
                                },
                                {
                                  "value": "(f\"Failed to update API key permissions: {str(e)}\")",
                                  "children": [
                                    {
                                      "value": "f\"Failed to update API key permissions: {str(e)}\"",
                                      "children": [
                                        {
                                          "value": "f\"",
                                          "children": []
                                        },
                                        {
                                          "value": "Failed to update API key permissions:",
                                          "children": []
                                        },
                                        {
                                          "value": "{str(e)}",
                                          "children": [
                                            {
                                              "value": "str(e)",
                                              "children": [
                                                {
                                                  "value": "str",
                                                  "children": []
                                                },
                                                {
                                                  "value": "(e)",
                                                  "children": [
                                                    {
                                                      "value": "e",
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "value": "\"",
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
函 解析JWT令牌(令牌: 字串) -> 字典[字串, 任意]:
    """
    解析并验证JWT令牌。

    :参数 令牌: 要解析的令牌
    :返回: 解码后的有效载荷
    :抛出 值错误: 如果令牌无效或已过期
    """
    试:
        有效载荷 = jwt.解码(
            令牌,
            设置.JWT_密钥,
            算法=[设置.JWT_算法],
            受众="已认证",
        )
        返回 有效载荷
    捕获 jwt.过期签名错误:
        抛出 值错误("令牌已过期")
    捕获 jwt.无效令牌错误 为 错误:
        抛出 值错误(f"无效令牌: {字串(错误)}")
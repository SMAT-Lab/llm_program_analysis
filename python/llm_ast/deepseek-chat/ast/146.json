{
    "type": "Program",
    "name": "Global",
    "range": [
        106,
        3155
    ],
    "children": [
        {
            "type": "FunctionDecl",
            "name": "get_profile",
            "range": [
                267,
                362
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "",
                    "range": [
                        267,
                        298
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "async",
                            "range": [
                                267,
                                272
                            ],
                            "children": [],
                            "content": "\nasync def get_profile(\n"
                        },
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                268,
                                271
                            ],
                            "children": [],
                            "content": "async def get_profile("
                        },
                        {
                            "type": "Identifier",
                            "name": "get_profile",
                            "range": [
                                269,
                                280
                            ],
                            "children": [],
                            "content": "def get_profile(\nuser_id:typing.Annotated[\nstr"
                        },
                        {
                            "type": "ParameterList",
                            "name": "",
                            "range": [
                                270,
                                296
                            ],
                            "children": [
                                {
                                    "type": "Parameter",
                                    "name": "user_id",
                                    "range": [
                                        272,
                                        294
                                    ],
                                    "children": [
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "",
                                            "range": [
                                                273,
                                                294
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "typing",
                                                    "range": [
                                                        274,
                                                        280
                                                    ],
                                                    "children": [],
                                                    "content": ":typing.Annotated[\nstr"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "Annotated",
                                                    "range": [
                                                        276,
                                                        285
                                                    ],
                                                    "children": [],
                                                    "content": ".Annotated[\nstr,fastapi.Depends("
                                                },
                                                {
                                                    "type": "TypeArgumentList",
                                                    "name": "",
                                                    "range": [
                                                        277,
                                                        293
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "str",
                                                            "range": [
                                                                279,
                                                                282
                                                            ],
                                                            "children": [],
                                                            "content": "\nstr,fastapi"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "fastapi",
                                                            "range": [
                                                                281,
                                                                288
                                                            ],
                                                            "children": [],
                                                            "content": ",fastapi.Depends(autogpt_libs.auth"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "Depends",
                                                            "range": [
                                                                283,
                                                                290
                                                            ],
                                                            "children": [],
                                                            "content": ".Depends(autogpt_libs.auth.depends"
                                                        },
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "",
                                                            "range": [
                                                                284,
                                                                292
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "autogpt_libs",
                                                                    "range": [
                                                                        285,
                                                                        296
                                                                    ],
                                                                    "children": [],
                                                                    "content": "(autogpt_libs.auth.depends.get_user_id)\n]\n"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "auth",
                                                                    "range": [
                                                                        287,
                                                                        291
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".auth.depends."
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "depends",
                                                                    "range": [
                                                                        289,
                                                                        296
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".depends.get_user_id)\n]\n"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "get_user_id",
                                                                    "range": [
                                                                        291,
                                                                        302
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".get_user_id)\n]\n):\n\"\"\" \\n     Get the profile details for the authenticated user. \\n     \"\"\""
                                                                }
                                                            ],
                                                            "content": "Depends(autogpt_libs.auth.depends.get_user_id"
                                                        }
                                                    ],
                                                    "content": "Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)"
                                                }
                                            ],
                                            "content": "user_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n"
                                        }
                                    ],
                                    "content": "\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n"
                                }
                            ],
                            "content": "get_profile(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n]\n"
                        }
                    ],
                    "content": "\nasync def get_profile(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n]\n):"
                },
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        298,
                        362
                    ],
                    "children": [
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                303,
                                362
                            ],
                            "children": [
                                {
                                    "type": "BlockStatement",
                                    "name": "",
                                    "range": [
                                        304,
                                        327
                                    ],
                                    "children": [
                                        {
                                            "type": "VariableDeclaration",
                                            "name": "",
                                            "range": [
                                                306,
                                                323
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "profile",
                                                    "range": [
                                                        306,
                                                        313
                                                    ],
                                                    "children": [],
                                                    "content": "\nprofile=await backend.server."
                                                },
                                                {
                                                    "type": "AssignmentExpression",
                                                    "name": "",
                                                    "range": [
                                                        307,
                                                        322
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Keyword",
                                                            "name": "await",
                                                            "range": [
                                                                308,
                                                                313
                                                            ],
                                                            "children": [],
                                                            "content": "=await backend.server."
                                                        },
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "",
                                                            "range": [
                                                                309,
                                                                322
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "backend",
                                                                    "range": [
                                                                        309,
                                                                        316
                                                                    ],
                                                                    "children": [],
                                                                    "content": "await backend.server.v2.store"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "server",
                                                                    "range": [
                                                                        311,
                                                                        317
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".server.v2.store."
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "v2",
                                                                    "range": [
                                                                        313,
                                                                        315
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".v2."
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "store",
                                                                    "range": [
                                                                        315,
                                                                        320
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".store.db.get_user_profile"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "db",
                                                                    "range": [
                                                                        317,
                                                                        319
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".db."
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "get_user_profile",
                                                                    "range": [
                                                                        319,
                                                                        335
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".get_user_profile(user_id)\nreturn profile\nexcept Exception:\nlogger.exception("
                                                                },
                                                                {
                                                                    "type": "ArgumentList",
                                                                    "name": "",
                                                                    "range": [
                                                                        320,
                                                                        322
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "user_id",
                                                                            "range": [
                                                                                321,
                                                                                327
                                                                            ],
                                                                            "children": [],
                                                                            "content": "(user_id)\nreturn profile\n"
                                                                        }
                                                                    ],
                                                                    "content": "get_user_profile(user_id"
                                                                }
                                                            ],
                                                            "content": "await backend.server.v2.store.db.get_user_profile(user_id"
                                                        }
                                                    ],
                                                    "content": "profile=await backend.server.v2.store.db.get_user_profile(user_id"
                                                }
                                            ],
                                            "content": "\nprofile=await backend.server.v2.store.db.get_user_profile(user_id)"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                324,
                                                326
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "profile",
                                                    "range": [
                                                        325,
                                                        331
                                                    ],
                                                    "children": [],
                                                    "content": "return profile\nexcept Exception:\n"
                                                }
                                            ],
                                            "content": "\nreturn profile"
                                        }
                                    ],
                                    "content": "try:\nprofile=await backend.server.v2.store.db.get_user_profile(user_id)\nreturn profile\n"
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "",
                                    "range": [
                                        327,
                                        362
                                    ],
                                    "children": [
                                        {
                                            "type": "BlockStatement",
                                            "name": "",
                                            "range": [
                                                329,
                                                362
                                            ],
                                            "children": [
                                                {
                                                    "type": "ExpressionStatement",
                                                    "name": "",
                                                    "range": [
                                                        331,
                                                        337
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "",
                                                            "range": [
                                                                331,
                                                                336
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "logger",
                                                                    "range": [
                                                                        331,
                                                                        337
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\nlogger.exception(\"Exception occurred whilst getting user profile\")"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "exception",
                                                                    "range": [
                                                                        333,
                                                                        342
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".exception(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses"
                                                                },
                                                                {
                                                                    "type": "ArgumentList",
                                                                    "name": "",
                                                                    "range": [
                                                                        334,
                                                                        336
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "StringLiteral",
                                                                            "name": "\"Exception occurred whilst getting user profile\"",
                                                                            "range": [
                                                                                335,
                                                                                377
                                                                            ],
                                                                            "children": [],
                                                                            "content": "(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n\n\n@router.post(\n\"/profile\",\ntags=[\"store\""
                                                                        }
                                                                    ],
                                                                    "content": "exception(\"Exception occurred whilst getting user profile\""
                                                                }
                                                            ],
                                                            "content": "\nlogger.exception(\"Exception occurred whilst getting user profile\""
                                                        }
                                                    ],
                                                    "content": "\nlogger.exception(\"Exception occurred whilst getting user profile\")"
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "",
                                                    "range": [
                                                        338,
                                                        361
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "",
                                                            "range": [
                                                                339,
                                                                360
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "fastapi",
                                                                    "range": [
                                                                        339,
                                                                        346
                                                                    ],
                                                                    "children": [],
                                                                    "content": "return fastapi.responses.JSONResponse(\n"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "responses",
                                                                    "range": [
                                                                        341,
                                                                        350
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".responses.JSONResponse(\nstatus_code=500,"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "JSONResponse",
                                                                    "range": [
                                                                        343,
                                                                        356
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".JSONResponse(\nstatus_code=500,\ncontent={\"detail\":"
                                                                },
                                                                {
                                                                    "type": "ArgumentList",
                                                                    "name": "",
                                                                    "range": [
                                                                        344,
                                                                        360
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "ObjectExpression",
                                                                            "name": "",
                                                                            "range": [
                                                                                345,
                                                                                359
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Property",
                                                                                    "name": "status_code",
                                                                                    "range": [
                                                                                        346,
                                                                                        348
                                                                                    ],
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "NumericLiteral",
                                                                                            "name": "500",
                                                                                            "range": [
                                                                                                347,
                                                                                                350
                                                                                            ],
                                                                                            "children": [],
                                                                                            "content": "status_code=500,"
                                                                                        }
                                                                                    ],
                                                                                    "content": "\nstatus_code="
                                                                                },
                                                                                {
                                                                                    "type": "Property",
                                                                                    "name": "content",
                                                                                    "range": [
                                                                                        351,
                                                                                        358
                                                                                    ],
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "ObjectExpression",
                                                                                            "name": "",
                                                                                            "range": [
                                                                                                353,
                                                                                                357
                                                                                            ],
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "Property",
                                                                                                    "name": "detail",
                                                                                                    "range": [
                                                                                                        354,
                                                                                                        356
                                                                                                    ],
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "StringLiteral",
                                                                                                            "name": "\"An error occurred while retrieving the user profile\"",
                                                                                                            "range": [
                                                                                                                355,
                                                                                                                417
                                                                                                            ],
                                                                                                            "children": [],
                                                                                                            "content": "\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n\n\n@router.post(\n\"/profile\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.CreatorDetails,\n)\n"
                                                                                                        }
                                                                                                    ],
                                                                                                    "content": "{\"detail\":"
                                                                                                }
                                                                                            ],
                                                                                            "content": "={\"detail\":\"An error occurred while retrieving the user profile\""
                                                                                        }
                                                                                    ],
                                                                                    "content": "\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"}"
                                                                                }
                                                                            ],
                                                                            "content": "(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},"
                                                                        }
                                                                    ],
                                                                    "content": "JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n"
                                                                }
                                                            ],
                                                            "content": "return fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n"
                                                        }
                                                    ],
                                                    "content": "\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)"
                                                }
                                            ],
                                            "content": "Exception:\nlogger.exception(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n"
                                        }
                                    ],
                                    "content": "\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n"
                                }
                            ],
                            "content": "\ntry:\nprofile=await backend.server.v2.store.db.get_user_profile(user_id)\nreturn profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n"
                        }
                    ],
                    "content": ":\n\"\"\" \\n     Get the profile details for the authenticated user. \\n     \"\"\"\ntry:\nprofile=await backend.server.v2.store.db.get_user_profile(user_id)\nreturn profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n"
                }
            ],
            "content": "\nasync def get_profile(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n]\n):\n\"\"\" \\n     Get the profile details for the authenticated user. \\n     \"\"\"\ntry:\nprofile=await backend.server.v2.store.db.get_user_profile(user_id)\nreturn profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n"
        },
        {
            "type": "FunctionDecl",
            "name": "update_or_create_profile",
            "range": [
                416,
                535
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "",
                    "range": [
                        416,
                        467
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "async",
                            "range": [
                                416,
                                421
                            ],
                            "children": [],
                            "content": ")\nasync def update_or_create_profile("
                        },
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                417,
                                420
                            ],
                            "children": [],
                            "content": "\nasync def update_or_create_profile"
                        },
                        {
                            "type": "Identifier",
                            "name": "update_or_create_profile",
                            "range": [
                                418,
                                442
                            ],
                            "children": [],
                            "content": "async def update_or_create_profile(\nprofile:backend.server.v2.store.model.Profile,\nuser_id:typing.Annotated"
                        },
                        {
                            "type": "ParameterList",
                            "name": "",
                            "range": [
                                419,
                                461
                            ],
                            "children": [
                                {
                                    "type": "Parameter",
                                    "name": "profile",
                                    "range": [
                                        421,
                                        434
                                    ],
                                    "children": [
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "",
                                            "range": [
                                                422,
                                                434
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "backend",
                                                    "range": [
                                                        423,
                                                        430
                                                    ],
                                                    "children": [],
                                                    "content": "profile:backend.server.v2."
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "server",
                                                    "range": [
                                                        425,
                                                        431
                                                    ],
                                                    "children": [],
                                                    "content": "backend.server.v2.store"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "v2",
                                                    "range": [
                                                        427,
                                                        429
                                                    ],
                                                    "children": [],
                                                    "content": "server.v2"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "store",
                                                    "range": [
                                                        429,
                                                        434
                                                    ],
                                                    "children": [],
                                                    "content": "v2.store.model."
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "model",
                                                    "range": [
                                                        431,
                                                        435
                                                    ],
                                                    "children": [],
                                                    "content": "store.model.Profile"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "Profile",
                                                    "range": [
                                                        433,
                                                        440
                                                    ],
                                                    "children": [],
                                                    "content": "model.Profile,\nuser_id:typing"
                                                }
                                            ],
                                            "content": "\nprofile:backend.server.v2.store.model."
                                        }
                                    ],
                                    "content": "(\nprofile:backend.server.v2.store.model."
                                },
                                {
                                    "type": "Parameter",
                                    "name": "user_id",
                                    "range": [
                                        436,
                                        459
                                    ],
                                    "children": [
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "",
                                            "range": [
                                                437,
                                                459
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "typing",
                                                    "range": [
                                                        438,
                                                        444
                                                    ],
                                                    "children": [],
                                                    "content": "user_id:typing.Annotated[\n"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "Annotated",
                                                    "range": [
                                                        440,
                                                        449
                                                    ],
                                                    "children": [],
                                                    "content": "typing.Annotated[\nstr,fastapi.Depends"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "str",
                                                    "range": [
                                                        443,
                                                        446
                                                    ],
                                                    "children": [],
                                                    "content": "[\nstr,"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "fastapi",
                                                    "range": [
                                                        445,
                                                        452
                                                    ],
                                                    "children": [],
                                                    "content": "str,fastapi.Depends(autogpt_libs."
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "Depends",
                                                    "range": [
                                                        447,
                                                        454
                                                    ],
                                                    "children": [],
                                                    "content": "fastapi.Depends(autogpt_libs.auth."
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "autogpt_libs",
                                                    "range": [
                                                        449,
                                                        461
                                                    ],
                                                    "children": [],
                                                    "content": "Depends(autogpt_libs.auth.depends.get_user_id)\n],"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "auth",
                                                    "range": [
                                                        451,
                                                        455
                                                    ],
                                                    "children": [],
                                                    "content": "autogpt_libs.auth.depends"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "depends",
                                                    "range": [
                                                        453,
                                                        460
                                                    ],
                                                    "children": [],
                                                    "content": "auth.depends.get_user_id)\n]"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "get_user_id",
                                                    "range": [
                                                        455,
                                                        466
                                                    ],
                                                    "children": [],
                                                    "content": "depends.get_user_id)\n],\n):\n\"\""
                                                }
                                            ],
                                            "content": "\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n"
                                        }
                                    ],
                                    "content": ",\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n"
                                }
                            ],
                            "content": "def update_or_create_profile(\nprofile:backend.server.v2.store.model.Profile,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],"
                        },
                        {
                            "type": "ReturnType",
                            "name": "",
                            "range": [
                                462,
                                467
                            ],
                            "children": [],
                            "content": "\n):\n\"\"\" \\n     Update the store profile for the authenticated user. \\n  \\n     Args: \\n         profile (Profile): The updated profile details \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         CreatorDetails: The updated profile \\n  \\n     Raises: \\n         HTTPException: If there is an error updating the profile \\n     \""
                        }
                    ],
                    "content": ")\nasync def update_or_create_profile(\nprofile:backend.server.v2.store.model.Profile,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Update the store profile for the authenticated user. \\n  \\n     Args: \\n         profile (Profile): The updated profile details \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         CreatorDetails: The updated profile \\n  \\n     Raises: \\n         HTTPException: If there is an error updating the profile \\n     \""
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        468,
                        535
                    ],
                    "children": [
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                468,
                                535
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "",
                                    "range": [
                                        470,
                                        499
                                    ],
                                    "children": [
                                        {
                                            "type": "VariableDecl",
                                            "name": "updated_profile",
                                            "range": [
                                                471,
                                                496
                                            ],
                                            "children": [
                                                {
                                                    "type": "Keyword",
                                                    "name": "await",
                                                    "range": [
                                                        473,
                                                        478
                                                    ],
                                                    "children": [],
                                                    "content": "updated_profile=await backend.server"
                                                },
                                                {
                                                    "type": "CallExpression",
                                                    "name": "update_or_create_profile",
                                                    "range": [
                                                        474,
                                                        495
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "backend",
                                                            "range": [
                                                                475,
                                                                482
                                                            ],
                                                            "children": [],
                                                            "content": "await backend.server.v2.store"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "server",
                                                            "range": [
                                                                477,
                                                                483
                                                            ],
                                                            "children": [],
                                                            "content": ".server.v2.store."
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "v2",
                                                            "range": [
                                                                479,
                                                                481
                                                            ],
                                                            "children": [],
                                                            "content": ".v2."
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "store",
                                                            "range": [
                                                                481,
                                                                486
                                                            ],
                                                            "children": [],
                                                            "content": ".store.db.update_or_create_profile"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "db",
                                                            "range": [
                                                                483,
                                                                485
                                                            ],
                                                            "children": [],
                                                            "content": ".db."
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "update_or_create_profile",
                                                            "range": [
                                                                485,
                                                                508
                                                            ],
                                                            "children": [],
                                                            "content": ".update_or_create_profile(\nuser_id=user_id,profile=profile\n)\nreturn updated_profile\nexcept Exception:\nlogger.exception"
                                                        },
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "",
                                                            "range": [
                                                                486,
                                                                494
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "user_id",
                                                                    "range": [
                                                                        487,
                                                                        490
                                                                    ],
                                                                    "children": [],
                                                                    "content": "(\nuser_id="
                                                                },
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "profile",
                                                                    "range": [
                                                                        492,
                                                                        493
                                                                    ],
                                                                    "children": [],
                                                                    "content": ",profile"
                                                                }
                                                            ],
                                                            "content": "update_or_create_profile(\nuser_id=user_id,profile="
                                                        }
                                                    ],
                                                    "content": "=await backend.server.v2.store.db.update_or_create_profile(\nuser_id=user_id,profile=profile"
                                                }
                                            ],
                                            "content": ":\nupdated_profile=await backend.server.v2.store.db.update_or_create_profile(\nuser_id=user_id,profile=profile\n"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                497,
                                                499
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "updated_profile",
                                                    "range": [
                                                        498,
                                                        512
                                                    ],
                                                    "children": [],
                                                    "content": "\nreturn updated_profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst updating profile\")\n"
                                                }
                                            ],
                                            "content": ")\nreturn"
                                        }
                                    ],
                                    "content": "try:\nupdated_profile=await backend.server.v2.store.db.update_or_create_profile(\nuser_id=user_id,profile=profile\n)\nreturn"
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "",
                                    "range": [
                                        500,
                                        535
                                    ],
                                    "children": [
                                        {
                                            "type": "Block",
                                            "name": "",
                                            "range": [
                                                502,
                                                535
                                            ],
                                            "children": [
                                                {
                                                    "type": "ExpressionStatement",
                                                    "name": "",
                                                    "range": [
                                                        504,
                                                        510
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "exception",
                                                            "range": [
                                                                505,
                                                                509
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "logger",
                                                                    "range": [
                                                                        504,
                                                                        510
                                                                    ],
                                                                    "children": [],
                                                                    "content": ":\nlogger.exception(\"Exception occurred whilst updating profile\""
                                                                },
                                                                {
                                                                    "type": "StringLiteral",
                                                                    "name": "\"Exception occurred whilst updating profile\"",
                                                                    "range": [
                                                                        508,
                                                                        541
                                                                    ],
                                                                    "children": [],
                                                                    "content": "exception(\"Exception occurred whilst updating profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)\n\n\n###"
                                                                }
                                                            ],
                                                            "content": "\nlogger.exception("
                                                        }
                                                    ],
                                                    "content": ":\nlogger.exception(\"Exception occurred whilst updating profile\""
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "",
                                                    "range": [
                                                        511,
                                                        535
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "JSONResponse",
                                                            "range": [
                                                                512,
                                                                533
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "fastapi",
                                                                    "range": [
                                                                        513,
                                                                        520
                                                                    ],
                                                                    "children": [],
                                                                    "content": "return fastapi.responses.JSONResponse(\n"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "responses",
                                                                    "range": [
                                                                        515,
                                                                        523
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".responses.JSONResponse(\nstatus_code=500"
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "JSONResponse",
                                                                    "range": [
                                                                        517,
                                                                        530
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".JSONResponse(\nstatus_code=500,\ncontent={\"detail\":"
                                                                },
                                                                {
                                                                    "type": "ArgumentList",
                                                                    "name": "",
                                                                    "range": [
                                                                        518,
                                                                        532
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Argument",
                                                                            "name": "status_code",
                                                                            "range": [
                                                                                519,
                                                                                521
                                                                            ],
                                                                            "children": [],
                                                                            "content": "(\nstatus_code"
                                                                        },
                                                                        {
                                                                            "type": "Argument",
                                                                            "name": "content",
                                                                            "range": [
                                                                                524,
                                                                                526
                                                                            ],
                                                                            "children": [],
                                                                            "content": ",\ncontent"
                                                                        }
                                                                    ],
                                                                    "content": "JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"}"
                                                                }
                                                            ],
                                                            "content": "\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},"
                                                        }
                                                    ],
                                                    "content": ")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)"
                                                }
                                            ],
                                            "content": "except Exception:\nlogger.exception(\"Exception occurred whilst updating profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)"
                                        }
                                    ],
                                    "content": "updated_profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst updating profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)"
                                }
                            ],
                            "content": "\"\"\ntry:\nupdated_profile=await backend.server.v2.store.db.update_or_create_profile(\nuser_id=user_id,profile=profile\n)\nreturn updated_profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst updating profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)"
                        }
                    ],
                    "content": "\"\"\ntry:\nupdated_profile=await backend.server.v2.store.db.update_or_create_profile(\nuser_id=user_id,profile=profile\n)\nreturn updated_profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst updating profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)"
                }
            ],
            "content": ")\nasync def update_or_create_profile(\nprofile:backend.server.v2.store.model.Profile,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Update the store profile for the authenticated user. \\n  \\n     Args: \\n         profile (Profile): The updated profile details \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         CreatorDetails: The updated profile \\n  \\n     Raises: \\n         HTTPException: If there is an error updating the profile \\n     \"\"\"\ntry:\nupdated_profile=await backend.server.v2.store.db.update_or_create_profile(\nuser_id=user_id,profile=profile\n)\nreturn updated_profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst updating profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)"
        },
        {
            "type": "FunctionDecl",
            "name": "get_agents",
            "range": [
                699,
                912
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "get_agents",
                    "range": [
                        699,
                        771
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "async",
                            "range": [
                                699,
                                704
                            ],
                            "children": [],
                            "content": "\n)\nasync def get_agents"
                        },
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                700,
                                703
                            ],
                            "children": [],
                            "content": ")\nasync def"
                        },
                        {
                            "type": "Identifier",
                            "name": "get_agents",
                            "range": [
                                701,
                                710
                            ],
                            "children": [],
                            "content": "\nasync def get_agents(\nfeatured:bool="
                        },
                        {
                            "type": "ParameterList",
                            "name": "parameters",
                            "range": [
                                702,
                                761
                            ],
                            "children": [
                                {
                                    "type": "Parameter",
                                    "name": "featured",
                                    "range": [
                                        704,
                                        709
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "featured",
                                            "range": [
                                                704,
                                                711
                                            ],
                                            "children": [],
                                            "content": "get_agents(\nfeatured:bool=False"
                                        },
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "bool",
                                            "range": [
                                                706,
                                                709
                                            ],
                                            "children": [],
                                            "content": "\nfeatured:bool"
                                        },
                                        {
                                            "type": "DefaultValue",
                                            "name": "False",
                                            "range": [
                                                707,
                                                709
                                            ],
                                            "children": [],
                                            "content": "featured:bool"
                                        }
                                    ],
                                    "content": "get_agents(\nfeatured:bool"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "creator",
                                    "range": [
                                        711,
                                        718
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "creator",
                                            "range": [
                                                711,
                                                717
                                            ],
                                            "children": [],
                                            "content": "False,\ncreator:str|"
                                        },
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "str | None",
                                            "range": [
                                                713,
                                                717
                                            ],
                                            "children": [],
                                            "content": "\ncreator:str|"
                                        },
                                        {
                                            "type": "DefaultValue",
                                            "name": "None",
                                            "range": [
                                                716,
                                                718
                                            ],
                                            "children": [],
                                            "content": "str|None"
                                        }
                                    ],
                                    "content": "False,\ncreator:str|None"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "sorted_by",
                                    "range": [
                                        720,
                                        727
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "sorted_by",
                                            "range": [
                                                720,
                                                728
                                            ],
                                            "children": [],
                                            "content": "None,\nsorted_by:str|None="
                                        },
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "str | None",
                                            "range": [
                                                722,
                                                726
                                            ],
                                            "children": [],
                                            "content": "\nsorted_by:str|"
                                        },
                                        {
                                            "type": "DefaultValue",
                                            "name": "None",
                                            "range": [
                                                725,
                                                727
                                            ],
                                            "children": [],
                                            "content": "str|None"
                                        }
                                    ],
                                    "content": "None,\nsorted_by:str|None"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "search_query",
                                    "range": [
                                        729,
                                        736
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "search_query",
                                            "range": [
                                                729,
                                                740
                                            ],
                                            "children": [],
                                            "content": "None,\nsearch_query:str|None=None,\n"
                                        },
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "str | None",
                                            "range": [
                                                731,
                                                735
                                            ],
                                            "children": [],
                                            "content": "\nsearch_query:str|"
                                        },
                                        {
                                            "type": "DefaultValue",
                                            "name": "None",
                                            "range": [
                                                734,
                                                736
                                            ],
                                            "children": [],
                                            "content": "str|None"
                                        }
                                    ],
                                    "content": "None,\nsearch_query:str|None"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "category",
                                    "range": [
                                        738,
                                        745
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "category",
                                            "range": [
                                                738,
                                                745
                                            ],
                                            "children": [],
                                            "content": "None,\ncategory:str|None"
                                        },
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "str | None",
                                            "range": [
                                                740,
                                                744
                                            ],
                                            "children": [],
                                            "content": "\ncategory:str|"
                                        },
                                        {
                                            "type": "DefaultValue",
                                            "name": "None",
                                            "range": [
                                                743,
                                                745
                                            ],
                                            "children": [],
                                            "content": "str|None"
                                        }
                                    ],
                                    "content": "None,\ncategory:str|None"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "page",
                                    "range": [
                                        747,
                                        752
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "page",
                                            "range": [
                                                747,
                                                750
                                            ],
                                            "children": [],
                                            "content": "None,\npage"
                                        },
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "int",
                                            "range": [
                                                749,
                                                752
                                            ],
                                            "children": [],
                                            "content": "\npage:int"
                                        },
                                        {
                                            "type": "DefaultValue",
                                            "name": "1",
                                            "range": [
                                                751,
                                                752
                                            ],
                                            "children": [],
                                            "content": ":int"
                                        }
                                    ],
                                    "content": "None,\npage:int"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "page_size",
                                    "range": [
                                        754,
                                        759
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "page_size",
                                            "range": [
                                                754,
                                                762
                                            ],
                                            "children": [],
                                            "content": "1,\npage_size:int=20,"
                                        },
                                        {
                                            "type": "TypeAnnotation",
                                            "name": "int",
                                            "range": [
                                                756,
                                                759
                                            ],
                                            "children": [],
                                            "content": "\npage_size:int"
                                        },
                                        {
                                            "type": "DefaultValue",
                                            "name": "20",
                                            "range": [
                                                758,
                                                759
                                            ],
                                            "children": [],
                                            "content": ":int"
                                        }
                                    ],
                                    "content": "1,\npage_size:int"
                                }
                            ],
                            "content": "async def get_agents(\nfeatured:bool=False,\ncreator:str|None=None,\nsorted_by:str|None=None,\nsearch_query:str|None=None,\ncategory:str|None=None,\npage:int=1,\npage_size:int=20"
                        },
                        {
                            "type": "ReturnType",
                            "name": "StoreAgentsResponse",
                            "range": [
                                763,
                                771
                            ],
                            "children": [],
                            "content": "\n):\n\"\"\" \\n     Get a paginated list of agents from the store with optional filtering and sorting. \\n  \\n     Args: \\n         featured (bool, optional): Filter to only show featured agents. Defaults to False. \\n         creator (str | None, optional): Filter agents by creator username. Defaults to None. \\n         sorted_by (str | None, optional): Sort agents by \" runs \" or \" rating"
                        }
                    ],
                    "content": "\n)\nasync def get_agents(\nfeatured:bool=False,\ncreator:str|None=None,\nsorted_by:str|None=None,\nsearch_query:str|None=None,\ncategory:str|None=None,\npage:int=1,\npage_size:int=20,\n):\n\"\"\" \\n     Get a paginated list of agents from the store with optional filtering and sorting. \\n  \\n     Args: \\n         featured (bool, optional): Filter to only show featured agents. Defaults to False. \\n         creator (str | None, optional): Filter agents by creator username. Defaults to None. \\n         sorted_by (str | None, optional): Sort agents by \" runs \" or \" rating"
                },
                {
                    "type": "FunctionBody",
                    "name": "body",
                    "range": [
                        772,
                        912
                    ],
                    "children": [
                        {
                            "type": "IfStatement",
                            "name": "if_page_less_than_1",
                            "range": [
                                772,
                                793
                            ],
                            "children": [
                                {
                                    "type": "Condition",
                                    "name": "page < 1",
                                    "range": [
                                        773,
                                        776
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "page",
                                            "range": [
                                                773,
                                                776
                                            ],
                                            "children": [],
                                            "content": "\"\"\nif page"
                                        },
                                        {
                                            "type": "BinaryExpression",
                                            "name": "<",
                                            "range": [
                                                774,
                                                775
                                            ],
                                            "children": [],
                                            "content": "\nif"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "1",
                                            "range": [
                                                775,
                                                776
                                            ],
                                            "children": [],
                                            "content": "if page"
                                        }
                                    ],
                                    "content": "\"\"\nif page"
                                },
                                {
                                    "type": "Block",
                                    "name": "raise_HTTPException",
                                    "range": [
                                        777,
                                        793
                                    ],
                                    "children": [
                                        {
                                            "type": "RaiseStatement",
                                            "name": "raise",
                                            "range": [
                                                778,
                                                793
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "HTTPException",
                                                    "range": [
                                                        779,
                                                        793
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "fastapi",
                                                            "range": [
                                                                779,
                                                                785
                                                            ],
                                                            "children": [],
                                                            "content": ":\nraise fastapi.HTTPException("
                                                        },
                                                        {
                                                            "type": "MemberExpression",
                                                            "name": "HTTPException",
                                                            "range": [
                                                                780,
                                                                793
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "HTTPException",
                                                                    "range": [
                                                                        781,
                                                                        793
                                                                    ],
                                                                    "children": [],
                                                                    "content": "raise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\""
                                                                }
                                                            ],
                                                            "content": "\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\""
                                                        },
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "arguments",
                                                            "range": [
                                                                782,
                                                                792
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "status_code",
                                                                    "range": [
                                                                        784,
                                                                        787
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Literal",
                                                                            "name": "422",
                                                                            "range": [
                                                                                786,
                                                                                787
                                                                            ],
                                                                            "children": [],
                                                                            "content": "\nstatus_code"
                                                                        }
                                                                    ],
                                                                    "content": "HTTPException(\nstatus_code"
                                                                },
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "detail",
                                                                    "range": [
                                                                        788,
                                                                        791
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Literal",
                                                                            "name": "\"Page must be greater than 0\"",
                                                                            "range": [
                                                                                790,
                                                                                791
                                                                            ],
                                                                            "children": [],
                                                                            "content": ",detail"
                                                                        }
                                                                    ],
                                                                    "content": "=422,detail"
                                                                }
                                                            ],
                                                            "content": "fastapi.HTTPException(\nstatus_code=422,detail="
                                                        }
                                                    ],
                                                    "content": ":\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\""
                                                }
                                            ],
                                            "content": "1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\""
                                        }
                                    ],
                                    "content": "<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\""
                                }
                            ],
                            "content": "\". Defaults to None. \\n         search_query (str | None, optional): Search agents by name, subheading and description. Defaults to None. \\n         category (str | None, optional): Filter agents by category. Defaults to None. \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of agents per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreAgentsResponse: Paginated list of agents matching the filters \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n  \\n     Used for: \\n     - Home Page Featured Agents \\n     - Home Page Top Agents \\n     - Search Results \\n     - Agent Details - Other Agents By Creator \\n     - Agent Details - Similar Agents \\n     - Creator Details - Agents By Creator \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\""
                        },
                        {
                            "type": "IfStatement",
                            "name": "if_page_size_less_than_1",
                            "range": [
                                795,
                                816
                            ],
                            "children": [
                                {
                                    "type": "Condition",
                                    "name": "page_size < 1",
                                    "range": [
                                        796,
                                        799
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "page_size",
                                            "range": [
                                                796,
                                                799
                                            ],
                                            "children": [],
                                            "content": "\n\nif page_size"
                                        },
                                        {
                                            "type": "BinaryExpression",
                                            "name": "<",
                                            "range": [
                                                797,
                                                798
                                            ],
                                            "children": [],
                                            "content": "\nif"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "1",
                                            "range": [
                                                798,
                                                799
                                            ],
                                            "children": [],
                                            "content": "if page_size"
                                        }
                                    ],
                                    "content": "\n\nif page_size"
                                },
                                {
                                    "type": "Block",
                                    "name": "raise_HTTPException",
                                    "range": [
                                        800,
                                        816
                                    ],
                                    "children": [
                                        {
                                            "type": "RaiseStatement",
                                            "name": "raise",
                                            "range": [
                                                801,
                                                816
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "HTTPException",
                                                    "range": [
                                                        802,
                                                        816
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "fastapi",
                                                            "range": [
                                                                802,
                                                                808
                                                            ],
                                                            "children": [],
                                                            "content": ":\nraise fastapi.HTTPException("
                                                        },
                                                        {
                                                            "type": "MemberExpression",
                                                            "name": "HTTPException",
                                                            "range": [
                                                                803,
                                                                816
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "HTTPException",
                                                                    "range": [
                                                                        804,
                                                                        816
                                                                    ],
                                                                    "children": [],
                                                                    "content": "raise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\""
                                                                }
                                                            ],
                                                            "content": "\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\""
                                                        },
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "arguments",
                                                            "range": [
                                                                805,
                                                                815
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "status_code",
                                                                    "range": [
                                                                        807,
                                                                        810
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Literal",
                                                                            "name": "422",
                                                                            "range": [
                                                                                809,
                                                                                810
                                                                            ],
                                                                            "children": [],
                                                                            "content": "\nstatus_code"
                                                                        }
                                                                    ],
                                                                    "content": "HTTPException(\nstatus_code"
                                                                },
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "detail",
                                                                    "range": [
                                                                        811,
                                                                        814
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Literal",
                                                                            "name": "\"Page size must be greater than 0\"",
                                                                            "range": [
                                                                                813,
                                                                                814
                                                                            ],
                                                                            "children": [],
                                                                            "content": ",detail"
                                                                        }
                                                                    ],
                                                                    "content": "=422,detail"
                                                                }
                                                            ],
                                                            "content": "fastapi.HTTPException(\nstatus_code=422,detail="
                                                        }
                                                    ],
                                                    "content": ":\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\""
                                                }
                                            ],
                                            "content": "1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\""
                                        }
                                    ],
                                    "content": "<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\""
                                }
                            ],
                            "content": ")\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\""
                        },
                        {
                            "type": "TryStatement",
                            "name": "try_get_store_agents",
                            "range": [
                                818,
                                912
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "try_block",
                                    "range": [
                                        820,
                                        877
                                    ],
                                    "children": [
                                        {
                                            "type": "VariableDeclaration",
                                            "name": "agents",
                                            "range": [
                                                821,
                                                876
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "agents",
                                                    "range": [
                                                        821,
                                                        826
                                                    ],
                                                    "children": [],
                                                    "content": "try:\nagents=await"
                                                },
                                                {
                                                    "type": "Assignment",
                                                    "name": "=",
                                                    "range": [
                                                        822,
                                                        823
                                                    ],
                                                    "children": [],
                                                    "content": ":\n"
                                                },
                                                {
                                                    "type": "AwaitExpression",
                                                    "name": "await",
                                                    "range": [
                                                        823,
                                                        876
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "get_store_agents",
                                                            "range": [
                                                                824,
                                                                876
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "backend",
                                                                    "range": [
                                                                        824,
                                                                        830
                                                                    ],
                                                                    "children": [],
                                                                    "content": "agents=await backend.server."
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "server",
                                                                    "range": [
                                                                        825,
                                                                        830
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "server",
                                                                            "range": [
                                                                                826,
                                                                                830
                                                                            ],
                                                                            "children": [],
                                                                            "content": "await backend.server."
                                                                        }
                                                                    ],
                                                                    "content": "=await backend.server."
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "v2",
                                                                    "range": [
                                                                        827,
                                                                        830
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "v2",
                                                                            "range": [
                                                                                828,
                                                                                830
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".server."
                                                                        }
                                                                    ],
                                                                    "content": "backend.server."
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "store",
                                                                    "range": [
                                                                        829,
                                                                        830
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "store",
                                                                            "range": [
                                                                                830,
                                                                                830
                                                                            ],
                                                                            "children": [],
                                                                            "content": "."
                                                                        }
                                                                    ],
                                                                    "content": "server."
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "db",
                                                                    "range": [
                                                                        831,
                                                                        830
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "db",
                                                                            "range": [
                                                                                832,
                                                                                830
                                                                            ],
                                                                            "children": [],
                                                                            "content": ""
                                                                        }
                                                                    ],
                                                                    "content": ""
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "get_store_agents",
                                                                    "range": [
                                                                        833,
                                                                        876
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "get_store_agents",
                                                                            "range": [
                                                                                834,
                                                                                876
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\n"
                                                                        }
                                                                    ],
                                                                    "content": "store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\n"
                                                                },
                                                                {
                                                                    "type": "ArgumentList",
                                                                    "name": "arguments",
                                                                    "range": [
                                                                        835,
                                                                        872
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "featured",
                                                                            "range": [
                                                                                837,
                                                                                840
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "featured",
                                                                                    "range": [
                                                                                        837,
                                                                                        840
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "get_store_agents(\nfeatured"
                                                                                }
                                                                            ],
                                                                            "content": "get_store_agents(\nfeatured"
                                                                        },
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "creator",
                                                                            "range": [
                                                                                842,
                                                                                845
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "creator",
                                                                                    "range": [
                                                                                        842,
                                                                                        845
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "featured,\ncreator"
                                                                                }
                                                                            ],
                                                                            "content": "featured,\ncreator"
                                                                        },
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "sorted_by",
                                                                            "range": [
                                                                                847,
                                                                                850
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "sorted_by",
                                                                                    "range": [
                                                                                        847,
                                                                                        850
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "creator,\nsorted_by"
                                                                                }
                                                                            ],
                                                                            "content": "creator,\nsorted_by"
                                                                        },
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "search_query",
                                                                            "range": [
                                                                                852,
                                                                                855
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "search_query",
                                                                                    "range": [
                                                                                        852,
                                                                                        855
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "sorted_by,\nsearch_query"
                                                                                }
                                                                            ],
                                                                            "content": "sorted_by,\nsearch_query"
                                                                        },
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "category",
                                                                            "range": [
                                                                                857,
                                                                                860
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "category",
                                                                                    "range": [
                                                                                        857,
                                                                                        860
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "search_query,\ncategory"
                                                                                }
                                                                            ],
                                                                            "content": "search_query,\ncategory"
                                                                        },
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "page",
                                                                            "range": [
                                                                                862,
                                                                                865
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "page",
                                                                                    "range": [
                                                                                        862,
                                                                                        865
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "category,\npage"
                                                                                }
                                                                            ],
                                                                            "content": "category,\npage"
                                                                        },
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "page_size",
                                                                            "range": [
                                                                                867,
                                                                                870
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "page_size",
                                                                                    "range": [
                                                                                        867,
                                                                                        870
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "page,\npage_size"
                                                                                }
                                                                            ],
                                                                            "content": "page,\npage_size"
                                                                        }
                                                                    ],
                                                                    "content": "db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size"
                                                                }
                                                            ],
                                                            "content": "agents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\n"
                                                        }
                                                    ],
                                                    "content": "\nagents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\n"
                                                }
                                            ],
                                            "content": "try:\nagents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\n"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return_agents",
                                            "range": [
                                                874,
                                                876
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "agents",
                                                    "range": [
                                                        875,
                                                        876
                                                    ],
                                                    "children": [],
                                                    "content": ")\n"
                                                }
                                            ],
                                            "content": "\n)\n"
                                        }
                                    ],
                                    "content": "\ntry:\nagents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\nreturn"
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "catch_exception",
                                    "range": [
                                        877,
                                        912
                                    ],
                                    "children": [
                                        {
                                            "type": "Block",
                                            "name": "catch_block",
                                            "range": [
                                                880,
                                                912
                                            ],
                                            "children": [
                                                {
                                                    "type": "ExpressionStatement",
                                                    "name": "logger_exception",
                                                    "range": [
                                                        881,
                                                        887
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "exception",
                                                            "range": [
                                                                882,
                                                                887
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "logger",
                                                                    "range": [
                                                                        881,
                                                                        887
                                                                    ],
                                                                    "children": [],
                                                                    "content": "Exception:\nlogger.exception("
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "exception",
                                                                    "range": [
                                                                        882,
                                                                        887
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "exception",
                                                                            "range": [
                                                                                883,
                                                                                887
                                                                            ],
                                                                            "children": [],
                                                                            "content": "\nlogger.exception("
                                                                        }
                                                                    ],
                                                                    "content": ":\nlogger.exception("
                                                                },
                                                                {
                                                                    "type": "ArgumentList",
                                                                    "name": "arguments",
                                                                    "range": [
                                                                        884,
                                                                        886
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Literal",
                                                                            "name": "\"Exception occured whilst getting store agents\"",
                                                                            "range": [
                                                                                885,
                                                                                886
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".exception"
                                                                        }
                                                                    ],
                                                                    "content": "logger.exception"
                                                                }
                                                            ],
                                                            "content": ":\nlogger.exception("
                                                        }
                                                    ],
                                                    "content": "Exception:\nlogger.exception("
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "return_JSONResponse",
                                                    "range": [
                                                        888,
                                                        912
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "JSONResponse",
                                                            "range": [
                                                                889,
                                                                912
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "fastapi",
                                                                    "range": [
                                                                        889,
                                                                        895
                                                                    ],
                                                                    "children": [],
                                                                    "content": ")\nreturn fastapi.responses."
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "responses",
                                                                    "range": [
                                                                        890,
                                                                        895
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "responses",
                                                                            "range": [
                                                                                891,
                                                                                895
                                                                            ],
                                                                            "children": [],
                                                                            "content": "return fastapi.responses."
                                                                        }
                                                                    ],
                                                                    "content": "\nreturn fastapi.responses."
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "JSONResponse",
                                                                    "range": [
                                                                        892,
                                                                        912
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "JSONResponse",
                                                                            "range": [
                                                                                893,
                                                                                912
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                                                                        }
                                                                    ],
                                                                    "content": "fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                                                                },
                                                                {
                                                                    "type": "ArgumentList",
                                                                    "name": "arguments",
                                                                    "range": [
                                                                        894,
                                                                        910
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "status_code",
                                                                            "range": [
                                                                                896,
                                                                                899
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "500",
                                                                                    "range": [
                                                                                        898,
                                                                                        899
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\nstatus_code"
                                                                                }
                                                                            ],
                                                                            "content": "JSONResponse(\nstatus_code"
                                                                        },
                                                                        {
                                                                            "type": "KeywordArgument",
                                                                            "name": "content",
                                                                            "range": [
                                                                                901,
                                                                                908
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "ObjectExpression",
                                                                                    "name": "content",
                                                                                    "range": [
                                                                                        903,
                                                                                        907
                                                                                    ],
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "Property",
                                                                                            "name": "detail",
                                                                                            "range": [
                                                                                                904,
                                                                                                906
                                                                                            ],
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "Literal",
                                                                                                    "name": "\"An error occurred while retrieving the store agents\"",
                                                                                                    "range": [
                                                                                                        906,
                                                                                                        906
                                                                                                    ],
                                                                                                    "children": [],
                                                                                                    "content": "{"
                                                                                                }
                                                                                            ],
                                                                                            "content": "content={"
                                                                                        }
                                                                                    ],
                                                                                    "content": "\ncontent={\"detail\""
                                                                                }
                                                                            ],
                                                                            "content": "500,\ncontent={\"detail\":"
                                                                        }
                                                                    ],
                                                                    "content": "responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"}"
                                                                }
                                                            ],
                                                            "content": ")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                                                        }
                                                    ],
                                                    "content": "\"Exception occured whilst getting store agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                                                }
                                            ],
                                            "content": "except Exception:\nlogger.exception(\"Exception occured whilst getting store agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                                        }
                                    ],
                                    "content": "return agents\nexcept Exception:\nlogger.exception(\"Exception occured whilst getting store agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                                }
                            ],
                            "content": ")\n\ntry:\nagents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occured whilst getting store agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                        }
                    ],
                    "content": "\". Defaults to None. \\n         search_query (str | None, optional): Search agents by name, subheading and description. Defaults to None. \\n         category (str | None, optional): Filter agents by category. Defaults to None. \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of agents per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreAgentsResponse: Paginated list of agents matching the filters \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n  \\n     Used for: \\n     - Home Page Featured Agents \\n     - Home Page Top Agents \\n     - Search Results \\n     - Agent Details - Other Agents By Creator \\n     - Agent Details - Similar Agents \\n     - Creator Details - Agents By Creator \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\n\ntry:\nagents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occured whilst getting store agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
                }
            ],
            "content": "\n)\nasync def get_agents(\nfeatured:bool=False,\ncreator:str|None=None,\nsorted_by:str|None=None,\nsearch_query:str|None=None,\ncategory:str|None=None,\npage:int=1,\npage_size:int=20,\n):\n\"\"\" \\n     Get a paginated list of agents from the store with optional filtering and sorting. \\n  \\n     Args: \\n         featured (bool, optional): Filter to only show featured agents. Defaults to False. \\n         creator (str | None, optional): Filter agents by creator username. Defaults to None. \\n         sorted_by (str | None, optional): Sort agents by \" runs \" or \" rating \". Defaults to None. \\n         search_query (str | None, optional): Search agents by name, subheading and description. Defaults to None. \\n         category (str | None, optional): Filter agents by category. Defaults to None. \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of agents per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreAgentsResponse: Paginated list of agents matching the filters \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n  \\n     Used for: \\n     - Home Page Featured Agents \\n     - Home Page Top Agents \\n     - Search Results \\n     - Agent Details - Other Agents By Creator \\n     - Agent Details - Similar Agents \\n     - Creator Details - Agents By Creator \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\n\ntry:\nagents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occured whilst getting store agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n"
        },
        {
            "type": "FunctionDecl",
            "name": "get_agent",
            "range": [
                948,
                1078
            ],
            "children": [
                {
                    "type": "Decorator",
                    "name": "@router.get",
                    "range": [
                        913,
                        946
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "\"/agents/{username}/{agent_name}\"",
                            "range": [
                                919,
                                919
                            ],
                            "children": [],
                            "content": "."
                        },
                        {
                            "type": "KeywordArgument",
                            "name": "tags",
                            "range": [
                                922,
                                928
                            ],
                            "children": [
                                {
                                    "type": "List",
                                    "name": "",
                                    "range": [
                                        924,
                                        928
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"store\"",
                                            "range": [
                                                925,
                                                925
                                            ],
                                            "children": [],
                                            "content": "\n"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"public\"",
                                            "range": [
                                                927,
                                                927
                                            ],
                                            "children": [],
                                            "content": "="
                                        }
                                    ],
                                    "content": ",\ntags=["
                                }
                            ],
                            "content": "\n\"/agents/{username}/{agent_name}\",\ntags=["
                        },
                        {
                            "type": "KeywordArgument",
                            "name": "response_model",
                            "range": [
                                931,
                                943
                            ],
                            "children": [
                                {
                                    "type": "AttributeAccess",
                                    "name": "backend.server.v2.store.model.StoreAgentDetails",
                                    "range": [
                                        933,
                                        943
                                    ],
                                    "children": [],
                                    "content": ",\nresponse_model=backend.server.v2.store"
                                }
                            ],
                            "content": "\"public\"],\nresponse_model=backend.server.v2.store"
                        }
                    ],
                    "content": ")\n\n\n@router.get(\n\"/agents/{username}/{agent_name}\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store.model."
                },
                {
                    "type": "FunctionSignature",
                    "name": "get_agent",
                    "range": [
                        949,
                        959
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "username",
                            "range": [
                                952,
                                954
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        954,
                                        954
                                    ],
                                    "children": [],
                                    "content": "get_agent"
                                }
                            ],
                            "content": "async def get_agent"
                        },
                        {
                            "type": "Parameter",
                            "name": "agent_name",
                            "range": [
                                956,
                                958
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        958,
                                        958
                                    ],
                                    "children": [],
                                    "content": "str"
                                }
                            ],
                            "content": "username:str"
                        }
                    ],
                    "content": "\n)\nasync def get_agent(username:str,"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        960,
                        1078
                    ],
                    "children": [
                        {
                            "type": "Docstring",
                            "name": "",
                            "range": [
                                962,
                                964
                            ],
                            "children": [],
                            "content": "str):"
                        },
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                966,
                                1078
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "",
                                    "range": [
                                        966,
                                        1041
                                    ],
                                    "children": [
                                        {
                                            "type": "Assignment",
                                            "name": "username",
                                            "range": [
                                                969,
                                                983
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "urllib.parse.unquote",
                                                    "range": [
                                                        971,
                                                        982
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "username",
                                                            "range": [
                                                                977,
                                                                977
                                                            ],
                                                            "children": [],
                                                            "content": "parse"
                                                        }
                                                    ],
                                                    "content": ":\nusername=urllib.parse.unquote(username)"
                                                }
                                            ],
                                            "content": "\ntry:\nusername=urllib.parse.unquote(username)."
                                        },
                                        {
                                            "type": "Comment",
                                            "name": "# URL decode the agent name since it comes from the URL path",
                                            "range": [
                                                984,
                                                997
                                            ],
                                            "children": [],
                                            "content": "lower()\n#URL decode the agent name since it comes from"
                                        },
                                        {
                                            "type": "Assignment",
                                            "name": "agent_name",
                                            "range": [
                                                998,
                                                1012
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "urllib.parse.unquote",
                                                    "range": [
                                                        1000,
                                                        1011
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "agent_name",
                                                            "range": [
                                                                1006,
                                                                1006
                                                            ],
                                                            "children": [],
                                                            "content": "parse"
                                                        }
                                                    ],
                                                    "content": "path\nagent_name=urllib.parse.unquote(agent_name)"
                                                }
                                            ],
                                            "content": "the URL path\nagent_name=urllib.parse.unquote(agent_name)."
                                        },
                                        {
                                            "type": "Assignment",
                                            "name": "agent",
                                            "range": [
                                                1013,
                                                1040
                                            ],
                                            "children": [
                                                {
                                                    "type": "AwaitExpression",
                                                    "name": "",
                                                    "range": [
                                                        1015,
                                                        1040
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "backend.server.v2.store.db.get_store_agent_details",
                                                            "range": [
                                                                1016,
                                                                1037
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "username",
                                                                    "range": [
                                                                        1029,
                                                                        1031
                                                                    ],
                                                                    "children": [],
                                                                    "content": ".get_store_agent_details("
                                                                },
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "agent_name",
                                                                    "range": [
                                                                        1033,
                                                                        1035
                                                                    ],
                                                                    "children": [],
                                                                    "content": "username=username"
                                                                }
                                                            ],
                                                            "content": "\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name"
                                                        }
                                                    ],
                                                    "content": ")\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name=agent_name\n"
                                                }
                                            ],
                                            "content": "lower()\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name=agent_name\n"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                1039,
                                                1041
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "agent",
                                                    "range": [
                                                        1040,
                                                        1040
                                                    ],
                                                    "children": [],
                                                    "content": "\n"
                                                }
                                            ],
                                            "content": "agent_name\n)"
                                        }
                                    ],
                                    "content": "\"\"\" \\n     This is only used on the AgentDetails Page \\n  \\n     It returns the store listing agents details. \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\n#URL decode the agent name since it comes from the URL path\nagent_name=urllib.parse.unquote(agent_name).lower()\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name=agent_name\n)"
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "",
                                    "range": [
                                        1042,
                                        1078
                                    ],
                                    "children": [
                                        {
                                            "type": "ExceptionType",
                                            "name": "Exception",
                                            "range": [
                                                1043,
                                                1043
                                            ],
                                            "children": [],
                                            "content": "return"
                                        },
                                        {
                                            "type": "CallExpression",
                                            "name": "logger.exception",
                                            "range": [
                                                1046,
                                                1051
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "\"Exception occurred whilst getting store agent details\"",
                                                    "range": [
                                                        1050,
                                                        1050
                                                    ],
                                                    "children": [],
                                                    "content": "logger"
                                                }
                                            ],
                                            "content": "except Exception:\nlogger."
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                1053,
                                                1078
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "fastapi.responses.JSONResponse",
                                                    "range": [
                                                        1054,
                                                        1077
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "status_code",
                                                            "range": [
                                                                1061,
                                                                1063
                                                            ],
                                                            "children": [],
                                                            "content": ".JSONResponse("
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "content",
                                                            "range": [
                                                                1066,
                                                                1074
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "ObjectExpression",
                                                                    "name": "",
                                                                    "range": [
                                                                        1068,
                                                                        1074
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Property",
                                                                            "name": "detail",
                                                                            "range": [
                                                                                1070,
                                                                                1072
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"An error occurred while retrieving the store agent details\"",
                                                                                    "range": [
                                                                                        1072,
                                                                                        1072
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "{"
                                                                                }
                                                                            ],
                                                                            "content": "content={"
                                                                        }
                                                                    ],
                                                                    "content": ",\ncontent={\n\"detail\""
                                                                }
                                                            ],
                                                            "content": "=500,\ncontent={\n\"detail\""
                                                        }
                                                    ],
                                                    "content": "\"Exception occurred whilst getting store agent details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store agent details\"\n"
                                                }
                                            ],
                                            "content": "(\"Exception occurred whilst getting store agent details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store agent details\"\n}"
                                        }
                                    ],
                                    "content": "\nreturn agent\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store agent details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store agent details\"\n}"
                                }
                            ],
                            "content": "\"\"\" \\n     This is only used on the AgentDetails Page \\n  \\n     It returns the store listing agents details. \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\n#URL decode the agent name since it comes from the URL path\nagent_name=urllib.parse.unquote(agent_name).lower()\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name=agent_name\n)\nreturn agent\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store agent details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store agent details\"\n}"
                        }
                    ],
                    "content": "agent_name:str):\n\"\"\" \\n     This is only used on the AgentDetails Page \\n  \\n     It returns the store listing agents details. \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\n#URL decode the agent name since it comes from the URL path\nagent_name=urllib.parse.unquote(agent_name).lower()\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name=agent_name\n)\nreturn agent\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store agent details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store agent details\"\n}"
                }
            ],
            "content": ",\n)\nasync def get_agent(username:str,agent_name:str):\n\"\"\" \\n     This is only used on the AgentDetails Page \\n  \\n     It returns the store listing agents details. \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\n#URL decode the agent name since it comes from the URL path\nagent_name=urllib.parse.unquote(agent_name).lower()\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name=agent_name\n)\nreturn agent\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store agent details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store agent details\"\n}"
        },
        {
            "type": "FunctionDecl",
            "name": "create_review",
            "range": [
                1080,
                1310
            ],
            "children": [
                {
                    "type": "Decorator",
                    "name": "@router.post",
                    "range": [
                        1080,
                        1129
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "path",
                            "range": [
                                1086,
                                1086
                            ],
                            "children": [],
                            "content": "router"
                        },
                        {
                            "type": "Argument",
                            "name": "tags",
                            "range": [
                                1089,
                                1093
                            ],
                            "children": [],
                            "content": "(\n\"/agents/{username}/{agent_name}/review\",\n"
                        },
                        {
                            "type": "Argument",
                            "name": "dependencies",
                            "range": [
                                1096,
                                1111
                            ],
                            "children": [],
                            "content": "[\"store\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth."
                        },
                        {
                            "type": "Argument",
                            "name": "response_model",
                            "range": [
                                1114,
                                1126
                            ],
                            "children": [],
                            "content": "auth_middleware)],\nresponse_model=backend.server.v2."
                        }
                    ],
                    "content": "\n)\n\n\n@router.post(\n\"/agents/{username}/{agent_name}/review\",\ntags=[\"store\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model"
                },
                {
                    "type": "FunctionSignature",
                    "name": "create_review",
                    "range": [
                        1131,
                        1191
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "username",
                            "range": [
                                1136,
                                1138
                            ],
                            "children": [],
                            "content": "async def create_review"
                        },
                        {
                            "type": "Parameter",
                            "name": "agent_name",
                            "range": [
                                1141,
                                1143
                            ],
                            "children": [],
                            "content": "username:str"
                        },
                        {
                            "type": "Parameter",
                            "name": "review",
                            "range": [
                                1146,
                                1158
                            ],
                            "children": [],
                            "content": "agent_name:str,\nreview:backend.server.v2."
                        },
                        {
                            "type": "Parameter",
                            "name": "user_id",
                            "range": [
                                1161,
                                1183
                            ],
                            "children": [],
                            "content": "model.StoreReviewCreate,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends"
                        }
                    ],
                    "content": "StoreReview,\n)\nasync def create_review(\nusername:str,\nagent_name:str,\nreview:backend.server.v2.store.model.StoreReviewCreate,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n)"
                },
                {
                    "type": "FunctionBody",
                    "name": "create_review",
                    "range": [
                        1193,
                        1309
                    ],
                    "children": [
                        {
                            "type": "TryStatement",
                            "name": "try",
                            "range": [
                                1193,
                                1309
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "try",
                                    "range": [
                                        1195,
                                        1274
                                    ],
                                    "children": [
                                        {
                                            "type": "ExpressionStatement",
                                            "name": "username",
                                            "range": [
                                                1196,
                                                1209
                                            ],
                                            "children": [],
                                            "content": "\"\"\ntry:\nusername=urllib.parse.unquote(username"
                                        },
                                        {
                                            "type": "ExpressionStatement",
                                            "name": "agent_name",
                                            "range": [
                                                1211,
                                                1221
                                            ],
                                            "children": [],
                                            "content": ".lower()\nagent_name=urllib.parse."
                                        },
                                        {
                                            "type": "ExpressionStatement",
                                            "name": "created_review",
                                            "range": [
                                                1227,
                                                1269
                                            ],
                                            "children": [],
                                            "content": "#Create the review\ncreated_review=await backend.server.v2.store.db.create_store_review(\nuser_id=user_id,\nstore_listing_version_id=review.store_listing_version_id,\nscore=review.score,\ncomments=review"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return",
                                            "range": [
                                                1272,
                                                1273
                                            ],
                                            "children": [],
                                            "content": ",\n"
                                        }
                                    ],
                                    "content": "\" \\n     Create a review for a store agent. \\n  \\n     Args: \\n         username: Creator's username \\n         agent_name: Name/slug of the agent \\n         review: Review details including score and optional comments \\n         user_id: ID of authenticated user creating the review \\n  \\n     Returns: \\n         The created review \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\nagent_name=urllib.parse.unquote(agent_name)\n#Create the review\ncreated_review=await backend.server.v2.store.db.create_store_review(\nuser_id=user_id,\nstore_listing_version_id=review.store_listing_version_id,\nscore=review.score,\ncomments=review.comments,\n)"
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "except",
                                    "range": [
                                        1275,
                                        1309
                                    ],
                                    "children": [
                                        {
                                            "type": "Block",
                                            "name": "except",
                                            "range": [
                                                1278,
                                                1309
                                            ],
                                            "children": [
                                                {
                                                    "type": "ExpressionStatement",
                                                    "name": "logger.exception",
                                                    "range": [
                                                        1279,
                                                        1284
                                                    ],
                                                    "children": [],
                                                    "content": "\nexcept Exception:\nlogger"
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "return",
                                                    "range": [
                                                        1286,
                                                        1308
                                                    ],
                                                    "children": [],
                                                    "content": "exception(\"Exception occurred whilst creating store review\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":"
                                                }
                                            ],
                                            "content": "created_review\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store review\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while creating the store review\""
                                        }
                                    ],
                                    "content": "\n\nreturn created_review\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store review\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while creating the store review\""
                                }
                            ],
                            "content": "\n\"\"\" \\n     Create a review for a store agent. \\n  \\n     Args: \\n         username: Creator's username \\n         agent_name: Name/slug of the agent \\n         review: Review details including score and optional comments \\n         user_id: ID of authenticated user creating the review \\n  \\n     Returns: \\n         The created review \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\nagent_name=urllib.parse.unquote(agent_name)\n#Create the review\ncreated_review=await backend.server.v2.store.db.create_store_review(\nuser_id=user_id,\nstore_listing_version_id=review.store_listing_version_id,\nscore=review.score,\ncomments=review.comments,\n)\n\nreturn created_review\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store review\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while creating the store review\""
                        }
                    ],
                    "content": "\n\"\"\" \\n     Create a review for a store agent. \\n  \\n     Args: \\n         username: Creator's username \\n         agent_name: Name/slug of the agent \\n         review: Review details including score and optional comments \\n         user_id: ID of authenticated user creating the review \\n  \\n     Returns: \\n         The created review \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\nagent_name=urllib.parse.unquote(agent_name)\n#Create the review\ncreated_review=await backend.server.v2.store.db.create_store_review(\nuser_id=user_id,\nstore_listing_version_id=review.store_listing_version_id,\nscore=review.score,\ncomments=review.comments,\n)\n\nreturn created_review\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store review\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while creating the store review\""
                }
            ],
            "content": "\n)\n\n\n@router.post(\n\"/agents/{username}/{agent_name}/review\",\ntags=[\"store\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.StoreReview,\n)\nasync def create_review(\nusername:str,\nagent_name:str,\nreview:backend.server.v2.store.model.StoreReviewCreate,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Create a review for a store agent. \\n  \\n     Args: \\n         username: Creator's username \\n         agent_name: Name/slug of the agent \\n         review: Review details including score and optional comments \\n         user_id: ID of authenticated user creating the review \\n  \\n     Returns: \\n         The created review \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\nagent_name=urllib.parse.unquote(agent_name)\n#Create the review\ncreated_review=await backend.server.v2.store.db.create_store_review(\nuser_id=user_id,\nstore_listing_version_id=review.store_listing_version_id,\nscore=review.score,\ncomments=review.comments,\n)\n\nreturn created_review\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store review\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while creating the store review\"}"
        },
        {
            "type": "FunctionDecl",
            "name": "get_creators",
            "range": [
                1436,
                1652
            ],
            "children": [
                {
                    "type": "Decorator",
                    "name": "@router.get",
                    "range": [
                        1436,
                        1469
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "\"/creators\"",
                            "range": [
                                1442,
                                1442
                            ],
                            "children": [],
                            "content": "@"
                        },
                        {
                            "type": "Argument",
                            "name": "tags",
                            "range": [
                                1445,
                                1451
                            ],
                            "children": [
                                {
                                    "type": "List",
                                    "name": "",
                                    "range": [
                                        1447,
                                        1451
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"store\"",
                                            "range": [
                                                1448,
                                                1448
                                            ],
                                            "children": [],
                                            "content": "\"/creators\""
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"public\"",
                                            "range": [
                                                1450,
                                                1450
                                            ],
                                            "children": [],
                                            "content": "\n"
                                        }
                                    ],
                                    "content": "\n\"/creators\",\ntags"
                                }
                            ],
                            "content": "get(\n\"/creators\",\ntags"
                        },
                        {
                            "type": "Argument",
                            "name": "response_model",
                            "range": [
                                1454,
                                1467
                            ],
                            "children": [
                                {
                                    "type": "AttributeAccess",
                                    "name": "backend.server.v2.store.model.CreatorsResponse",
                                    "range": [
                                        1456,
                                        1466
                                    ],
                                    "children": [],
                                    "content": "\"public\"],\nresponse_model=backend.server.v2"
                                }
                            ],
                            "content": "\"store\",\"public\"],\nresponse_model=backend.server.v2."
                        }
                    ],
                    "content": "###\n\n\n@router.get(\n\"/creators\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store."
                },
                {
                    "type": "FunctionSignature",
                    "name": "get_creators",
                    "range": [
                        1471,
                        1517
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "featured",
                            "range": [
                                1476,
                                1480
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "bool",
                                    "range": [
                                        1478,
                                        1478
                                    ],
                                    "children": [],
                                    "content": "def"
                                },
                                {
                                    "type": "DefaultValue",
                                    "name": "False",
                                    "range": [
                                        1480,
                                        1480
                                    ],
                                    "children": [],
                                    "content": "("
                                }
                            ],
                            "content": "\nasync def get_creators("
                        },
                        {
                            "type": "Parameter",
                            "name": "search_query",
                            "range": [
                                1483,
                                1489
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str | None",
                                    "range": [
                                        1485,
                                        1487
                                    ],
                                    "children": [],
                                    "content": "=False,"
                                },
                                {
                                    "type": "DefaultValue",
                                    "name": "None",
                                    "range": [
                                        1489,
                                        1489
                                    ],
                                    "children": [],
                                    "content": "search_query"
                                }
                            ],
                            "content": ":bool=False,\nsearch_query"
                        },
                        {
                            "type": "Parameter",
                            "name": "sorted_by",
                            "range": [
                                1492,
                                1498
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str | None",
                                    "range": [
                                        1494,
                                        1496
                                    ],
                                    "children": [],
                                    "content": "=None,"
                                },
                                {
                                    "type": "DefaultValue",
                                    "name": "None",
                                    "range": [
                                        1498,
                                        1498
                                    ],
                                    "children": [],
                                    "content": "sorted_by"
                                }
                            ],
                            "content": "|None=None,\nsorted_by"
                        },
                        {
                            "type": "Parameter",
                            "name": "page",
                            "range": [
                                1501,
                                1505
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "int",
                                    "range": [
                                        1503,
                                        1503
                                    ],
                                    "children": [],
                                    "content": "="
                                },
                                {
                                    "type": "DefaultValue",
                                    "name": "1",
                                    "range": [
                                        1505,
                                        1505
                                    ],
                                    "children": [],
                                    "content": ","
                                }
                            ],
                            "content": "|None=None,"
                        },
                        {
                            "type": "Parameter",
                            "name": "page_size",
                            "range": [
                                1508,
                                1512
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "int",
                                    "range": [
                                        1510,
                                        1510
                                    ],
                                    "children": [],
                                    "content": "="
                                },
                                {
                                    "type": "DefaultValue",
                                    "name": "20",
                                    "range": [
                                        1512,
                                        1512
                                    ],
                                    "children": [],
                                    "content": ","
                                }
                            ],
                            "content": ":int=1,"
                        }
                    ],
                    "content": ".CreatorsResponse,\n)\nasync def get_creators(\nfeatured:bool=False,\nsearch_query:str|None=None,\nsorted_by:str|None=None,\npage:int=1,\npage_size:int="
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        1518,
                        1652
                    ],
                    "children": [
                        {
                            "type": "Docstring",
                            "name": "",
                            "range": [
                                1518,
                                1520
                            ],
                            "children": [],
                            "content": "20,\n"
                        },
                        {
                            "type": "IfStatement",
                            "name": "",
                            "range": [
                                1522,
                                1543
                            ],
                            "children": [
                                {
                                    "type": "Condition",
                                    "name": "page < 1",
                                    "range": [
                                        1523,
                                        1525
                                    ],
                                    "children": [],
                                    "content": "\n\"\"\" \\n     This is needed for: \\n     - Home Page Featured Creators \\n     - Search Results Page \\n  \\n     --- \\n  \\n     To support this functionality we need: \\n     - featured: bool - to limit the list to just featured agents \\n     - search_query: str - vector search based on the creators profile description. \\n     - sorted_by: [agent_rating, agent_runs] - \\n     \""
                                },
                                {
                                    "type": "RaiseStatement",
                                    "name": "",
                                    "range": [
                                        1528,
                                        1542
                                    ],
                                    "children": [
                                        {
                                            "type": "Exception",
                                            "name": "fastapi.HTTPException",
                                            "range": [
                                                1529,
                                                1531
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "status_code=422",
                                                    "range": [
                                                        1534,
                                                        1536
                                                    ],
                                                    "children": [],
                                                    "content": "raise fastapi."
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "detail=\"Page must be greater than 0\"",
                                                    "range": [
                                                        1538,
                                                        1540
                                                    ],
                                                    "children": [],
                                                    "content": "(\nstatus_code"
                                                }
                                            ],
                                            "content": "page<1"
                                        }
                                    ],
                                    "content": "if page<1:\nraise fastapi.HTTPException(\nstatus_code=422"
                                }
                            ],
                            "content": ":\n\"\"\" \\n     This is needed for: \\n     - Home Page Featured Creators \\n     - Search Results Page \\n  \\n     --- \\n  \\n     To support this functionality we need: \\n     - featured: bool - to limit the list to just featured agents \\n     - search_query: str - vector search based on the creators profile description. \\n     - sorted_by: [agent_rating, agent_runs] - \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,"
                        },
                        {
                            "type": "IfStatement",
                            "name": "",
                            "range": [
                                1545,
                                1566
                            ],
                            "children": [
                                {
                                    "type": "Condition",
                                    "name": "page_size < 1",
                                    "range": [
                                        1546,
                                        1548
                                    ],
                                    "children": [],
                                    "content": "\"Page must be greater than 0\"\n)"
                                },
                                {
                                    "type": "RaiseStatement",
                                    "name": "",
                                    "range": [
                                        1551,
                                        1565
                                    ],
                                    "children": [
                                        {
                                            "type": "Exception",
                                            "name": "fastapi.HTTPException",
                                            "range": [
                                                1552,
                                                1554
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "status_code=422",
                                                    "range": [
                                                        1557,
                                                        1559
                                                    ],
                                                    "children": [],
                                                    "content": "raise fastapi."
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "detail=\"Page size must be greater than 0\"",
                                                    "range": [
                                                        1561,
                                                        1563
                                                    ],
                                                    "children": [],
                                                    "content": "(\nstatus_code"
                                                }
                                            ],
                                            "content": "page_size<1"
                                        }
                                    ],
                                    "content": "if page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422"
                                }
                            ],
                            "content": "=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,"
                        },
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                1568,
                                1651
                            ],
                            "children": [
                                {
                                    "type": "TryBlock",
                                    "name": "",
                                    "range": [
                                        1570,
                                        1616
                                    ],
                                    "children": [
                                        {
                                            "type": "Assignment",
                                            "name": "creators = await backend.server.v2.store.db.get_store_creators",
                                            "range": [
                                                1571,
                                                1612
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "get_store_creators",
                                                    "range": [
                                                        1584,
                                                        1612
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "featured=featured",
                                                            "range": [
                                                                1587,
                                                                1589
                                                            ],
                                                            "children": [],
                                                            "content": ".db."
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "search_query=search_query",
                                                            "range": [
                                                                1592,
                                                                1594
                                                            ],
                                                            "children": [],
                                                            "content": "\nfeatured="
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "sorted_by=sorted_by",
                                                            "range": [
                                                                1597,
                                                                1599
                                                            ],
                                                            "children": [],
                                                            "content": "\nsearch_query="
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "page=page",
                                                            "range": [
                                                                1602,
                                                                1604
                                                            ],
                                                            "children": [],
                                                            "content": "\nsorted_by="
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "page_size=page_size",
                                                            "range": [
                                                                1607,
                                                                1609
                                                            ],
                                                            "children": [],
                                                            "content": "\npage="
                                                        }
                                                    ],
                                                    "content": "v2.store.db.get_store_creators(\nfeatured=featured,\nsearch_query=search_query,\nsorted_by=sorted_by,\npage=page,\n"
                                                }
                                            ],
                                            "content": ")\n\ntry:\ncreators=await backend.server.v2.store.db.get_store_creators(\nfeatured=featured,\nsearch_query=search_query,\nsorted_by=sorted_by,\npage=page,\n"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return creators",
                                            "range": [
                                                1614,
                                                1615
                                            ],
                                            "children": [],
                                            "content": "=page_size"
                                        }
                                    ],
                                    "content": "\n)\n\ntry:\ncreators=await backend.server.v2.store.db.get_store_creators(\nfeatured=featured,\nsearch_query=search_query,\nsorted_by=sorted_by,\npage=page,\npage_size=page_size,"
                                },
                                {
                                    "type": "ExceptBlock",
                                    "name": "",
                                    "range": [
                                        1617,
                                        1651
                                    ],
                                    "children": [
                                        {
                                            "type": "Exception",
                                            "name": "Exception",
                                            "range": [
                                                1618,
                                                1618
                                            ],
                                            "children": [],
                                            "content": ")"
                                        },
                                        {
                                            "type": "LogStatement",
                                            "name": "logger.exception",
                                            "range": [
                                                1621,
                                                1626
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"Exception occurred whilst getting store creators\"",
                                                    "range": [
                                                        1625,
                                                        1625
                                                    ],
                                                    "children": [],
                                                    "content": ":"
                                                }
                                            ],
                                            "content": "creators\nexcept Exception:\n"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return fastapi.responses.JSONResponse",
                                            "range": [
                                                1628,
                                                1650
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "JSONResponse",
                                                    "range": [
                                                        1633,
                                                        1650
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "status_code=500",
                                                            "range": [
                                                                1636,
                                                                1638
                                                            ],
                                                            "children": [],
                                                            "content": ".responses."
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "content={\"detail\": \"An error occurred while retrieving the store creators\"}",
                                                            "range": [
                                                                1641,
                                                                1647
                                                            ],
                                                            "children": [],
                                                            "content": "\nstatus_code=500,\ncontent"
                                                        }
                                                    ],
                                                    "content": "\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\""
                                                }
                                            ],
                                            "content": ".exception(\"Exception occurred whilst getting store creators\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\""
                                        }
                                    ],
                                    "content": "\n)\nreturn creators\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store creators\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":"
                                }
                            ],
                            "content": "=\"Page size must be greater than 0\"\n)\n\ntry:\ncreators=await backend.server.v2.store.db.get_store_creators(\nfeatured=featured,\nsearch_query=search_query,\nsorted_by=sorted_by,\npage=page,\npage_size=page_size,\n)\nreturn creators\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store creators\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":"
                        }
                    ],
                    "content": "20,\n):\n\"\"\" \\n     This is needed for: \\n     - Home Page Featured Creators \\n     - Search Results Page \\n  \\n     --- \\n  \\n     To support this functionality we need: \\n     - featured: bool - to limit the list to just featured agents \\n     - search_query: str - vector search based on the creators profile description. \\n     - sorted_by: [agent_rating, agent_runs] - \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\n\ntry:\ncreators=await backend.server.v2.store.db.get_store_creators(\nfeatured=featured,\nsearch_query=search_query,\nsorted_by=sorted_by,\npage=page,\npage_size=page_size,\n)\nreturn creators\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store creators\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store creators\""
                }
            ],
            "content": "###\n\n\n@router.get(\n\"/creators\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store.model.CreatorsResponse,\n)\nasync def get_creators(\nfeatured:bool=False,\nsearch_query:str|None=None,\nsorted_by:str|None=None,\npage:int=1,\npage_size:int=20,\n):\n\"\"\" \\n     This is needed for: \\n     - Home Page Featured Creators \\n     - Search Results Page \\n  \\n     --- \\n  \\n     To support this functionality we need: \\n     - featured: bool - to limit the list to just featured agents \\n     - search_query: str - vector search based on the creators profile description. \\n     - sorted_by: [agent_rating, agent_runs] - \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\n\ntry:\ncreators=await backend.server.v2.store.db.get_store_creators(\nfeatured=featured,\nsearch_query=search_query,\nsorted_by=sorted_by,\npage=page,\npage_size=page_size,\n)\nreturn creators\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store creators\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store creators\""
        },
        {
            "type": "FunctionDecl",
            "name": "get_creator",
            "range": [
                1688,
                1788
            ],
            "children": [
                {
                    "type": "Decorator",
                    "name": "@router.get",
                    "range": [
                        1653,
                        1686
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "\"/creator/{username}\"",
                            "range": [
                                1659,
                                1659
                            ],
                            "children": [],
                            "content": "\n"
                        },
                        {
                            "type": "Argument",
                            "name": "tags",
                            "range": [
                                1662,
                                1668
                            ],
                            "children": [
                                {
                                    "type": "List",
                                    "name": "",
                                    "range": [
                                        1664,
                                        1668
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"store\"",
                                            "range": [
                                                1665,
                                                1665
                                            ],
                                            "children": [],
                                            "content": "\n"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"public\"",
                                            "range": [
                                                1667,
                                                1667
                                            ],
                                            "children": [],
                                            "content": ","
                                        }
                                    ],
                                    "content": "(\n\"/creator/{username}\",\n"
                                }
                            ],
                            "content": ".get(\n\"/creator/{username}\",\n"
                        },
                        {
                            "type": "Argument",
                            "name": "response_model",
                            "range": [
                                1671,
                                1683
                            ],
                            "children": [
                                {
                                    "type": "AttributeAccess",
                                    "name": "backend.server.v2.store.model.CreatorDetails",
                                    "range": [
                                        1673,
                                        1683
                                    ],
                                    "children": [],
                                    "content": ",\"public\"],\nresponse_model=backend.server."
                                }
                            ],
                            "content": "[\"store\",\"public\"],\nresponse_model=backend.server."
                        }
                    ],
                    "content": "},\n)\n\n\n@router.get(\n\"/creator/{username}\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store"
                },
                {
                    "type": "FunctionSignature",
                    "name": "get_creator",
                    "range": [
                        1689,
                        1704
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "username",
                            "range": [
                                1693,
                                1695
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        1695,
                                        1695
                                    ],
                                    "children": [],
                                    "content": "async"
                                }
                            ],
                            "content": ")\nasync"
                        }
                    ],
                    "content": ".CreatorDetails,\n)\nasync def get_creator(\nusername:str,\n"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        1705,
                        1788
                    ],
                    "children": [
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                1705,
                                1788
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "",
                                    "range": [
                                        1707,
                                        1751
                                    ],
                                    "children": [
                                        {
                                            "type": "Assignment",
                                            "name": "username",
                                            "range": [
                                                1708,
                                                1722
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "urllib.parse.unquote(username).lower",
                                                    "range": [
                                                        1710,
                                                        1721
                                                    ],
                                                    "children": [],
                                                    "content": "\"\"\ntry:\nusername=urllib.parse.unquote"
                                                }
                                            ],
                                            "content": "\"\"\" \\n     Get the details of a creator \\n     - Creator Details Page \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote("
                                        },
                                        {
                                            "type": "Assignment",
                                            "name": "creator",
                                            "range": [
                                                1723,
                                                1748
                                            ],
                                            "children": [
                                                {
                                                    "type": "AwaitExpression",
                                                    "name": "",
                                                    "range": [
                                                        1725,
                                                        1747
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "backend.server.v2.store.db.get_store_creator_details",
                                                            "range": [
                                                                1726,
                                                                1747
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "username",
                                                                    "range": [
                                                                        1739,
                                                                        1745
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "CallExpression",
                                                                            "name": "username.lower",
                                                                            "range": [
                                                                                1742,
                                                                                1745
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".get_store_creator_details(\n"
                                                                        }
                                                                    ],
                                                                    "content": "store.db.get_store_creator_details(\n"
                                                                }
                                                            ],
                                                            "content": "lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername="
                                                        }
                                                    ],
                                                    "content": ".lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername="
                                                }
                                            ],
                                            "content": "username).lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername=username"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                1749,
                                                1751
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "creator",
                                                    "range": [
                                                        1750,
                                                        1750
                                                    ],
                                                    "children": [],
                                                    "content": "lower"
                                                }
                                            ],
                                            "content": ".lower("
                                        }
                                    ],
                                    "content": "\n\"\"\" \\n     Get the details of a creator \\n     - Creator Details Page \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername=username.lower("
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "Exception",
                                    "range": [
                                        1752,
                                        1788
                                    ],
                                    "children": [
                                        {
                                            "type": "Block",
                                            "name": "",
                                            "range": [
                                                1755,
                                                1788
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "logger.exception",
                                                    "range": [
                                                        1756,
                                                        1761
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"Exception occurred whilst getting creator details\"",
                                                            "range": [
                                                                1760,
                                                                1760
                                                            ],
                                                            "children": [],
                                                            "content": "Exception"
                                                        }
                                                    ],
                                                    "content": "return creator\nexcept Exception:"
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "",
                                                    "range": [
                                                        1763,
                                                        1788
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "NewExpression",
                                                            "name": "fastapi.responses.JSONResponse",
                                                            "range": [
                                                                1764,
                                                                1787
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "status_code",
                                                                    "range": [
                                                                        1771,
                                                                        1773
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Literal",
                                                                            "name": "500",
                                                                            "range": [
                                                                                1773,
                                                                                1773
                                                                            ],
                                                                            "children": [],
                                                                            "content": "responses"
                                                                        }
                                                                    ],
                                                                    "content": "fastapi.responses"
                                                                },
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "content",
                                                                    "range": [
                                                                        1776,
                                                                        1784
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "ObjectLiteral",
                                                                            "name": "",
                                                                            "range": [
                                                                                1778,
                                                                                1784
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Property",
                                                                                    "name": "detail",
                                                                                    "range": [
                                                                                        1780,
                                                                                        1782
                                                                                    ],
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "Literal",
                                                                                            "name": "\"An error occurred while retrieving the creator details\"",
                                                                                            "range": [
                                                                                                1782,
                                                                                                1782
                                                                                            ],
                                                                                            "children": [],
                                                                                            "content": "\n"
                                                                                        }
                                                                                    ],
                                                                                    "content": "500,\n"
                                                                                }
                                                                            ],
                                                                            "content": "status_code=500,\ncontent="
                                                                        }
                                                                    ],
                                                                    "content": "(\nstatus_code=500,\ncontent="
                                                                }
                                                            ],
                                                            "content": ".exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\""
                                                        }
                                                    ],
                                                    "content": "logger.exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":"
                                                }
                                            ],
                                            "content": "\nreturn creator\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":"
                                        }
                                    ],
                                    "content": ")\n)\nreturn creator\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":"
                                }
                            ],
                            "content": "):\n\"\"\" \\n     Get the details of a creator \\n     - Creator Details Page \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername=username.lower()\n)\nreturn creator\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":"
                        }
                    ],
                    "content": "):\n\"\"\" \\n     Get the details of a creator \\n     - Creator Details Page \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername=username.lower()\n)\nreturn creator\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":"
                }
            ],
            "content": "model.CreatorDetails,\n)\nasync def get_creator(\nusername:str,\n):\n\"\"\" \\n     Get the details of a creator \\n     - Creator Details Page \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername=username.lower()\n)\nreturn creator\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":"
        },
        {
            "type": "FunctionDecl",
            "name": "get_my_agents",
            "range": [
                1911,
                2055
            ],
            "children": [
                {
                    "type": "Decorator",
                    "name": "@router.get",
                    "range": [
                        1911,
                        1962
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "\"/myagents\"",
                            "range": [
                                1917,
                                1917
                            ],
                            "children": [],
                            "content": "#"
                        },
                        {
                            "type": "Argument",
                            "name": "tags",
                            "range": [
                                1920,
                                1926
                            ],
                            "children": [
                                {
                                    "type": "List",
                                    "name": "",
                                    "range": [
                                        1922,
                                        1926
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"store\"",
                                            "range": [
                                                1923,
                                                1923
                                            ],
                                            "children": [],
                                            "content": "("
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"private\"",
                                            "range": [
                                                1925,
                                                1925
                                            ],
                                            "children": [],
                                            "content": "\"/myagents\""
                                        }
                                    ],
                                    "content": "get(\n\"/myagents\","
                                }
                            ],
                            "content": "router.get(\n\"/myagents\","
                        },
                        {
                            "type": "Argument",
                            "name": "dependencies",
                            "range": [
                                1929,
                                1944
                            ],
                            "children": [
                                {
                                    "type": "List",
                                    "name": "",
                                    "range": [
                                        1931,
                                        1944
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "fastapi.Depends",
                                            "range": [
                                                1932,
                                                1943
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "autogpt_libs.auth.middleware.auth_middleware",
                                                    "range": [
                                                        1936,
                                                        1942
                                                    ],
                                                    "children": [],
                                                    "content": "\ndependencies=[fastapi.Depends"
                                                }
                                            ],
                                            "content": ",\"private\"],\ndependencies=[fastapi.Depends("
                                        }
                                    ],
                                    "content": "\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs"
                                }
                            ],
                            "content": "=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs"
                        },
                        {
                            "type": "Argument",
                            "name": "response_model",
                            "range": [
                                1947,
                                1960
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "backend.server.v2.store.model.MyAgentsResponse",
                                    "range": [
                                        1949,
                                        1959
                                    ],
                                    "children": [],
                                    "content": ".auth_middleware)],\nresponse_model=backend.server"
                                }
                            ],
                            "content": ".middleware.auth_middleware)],\nresponse_model=backend.server."
                        }
                    ],
                    "content": "#######\n@router.get(\n\"/myagents\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2."
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        1964,
                        2055
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "user_id",
                            "range": [
                                1969,
                                1992
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "typing.Annotated[str, fastapi.Depends(autogpt_libs.auth.depends.get_user_id)]",
                                    "range": [
                                        1971,
                                        1991
                                    ],
                                    "children": [],
                                    "content": "\nasync def get_my_agents(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs."
                                }
                            ],
                            "content": "\n)\nasync def get_my_agents(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth"
                        },
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                1996,
                                2054
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "",
                                    "range": [
                                        1998,
                                        2019
                                    ],
                                    "children": [
                                        {
                                            "type": "VariableDeclaration",
                                            "name": "agents",
                                            "range": [
                                                1999,
                                                2016
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "await backend.server.v2.store.db.get_my_agents",
                                                    "range": [
                                                        2001,
                                                        2015
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "user_id",
                                                            "range": [
                                                                2014,
                                                                2014
                                                            ],
                                                            "children": [],
                                                            "content": "v2"
                                                        }
                                                    ],
                                                    "content": "):\ntry:\nagents=await backend.server.v2."
                                                }
                                            ],
                                            "content": "]\n):\ntry:\nagents=await backend.server.v2.store"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                2017,
                                                2018
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "agents",
                                                    "range": [
                                                        2018,
                                                        2018
                                                    ],
                                                    "children": [],
                                                    "content": "db"
                                                }
                                            ],
                                            "content": ".db"
                                        }
                                    ],
                                    "content": "\n]\n):\ntry:\nagents=await backend.server.v2.store.db."
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "",
                                    "range": [
                                        2020,
                                        2054
                                    ],
                                    "children": [
                                        {
                                            "type": "Block",
                                            "name": "",
                                            "range": [
                                                2023,
                                                2054
                                            ],
                                            "children": [
                                                {
                                                    "type": "ExpressionStatement",
                                                    "name": "logger.exception",
                                                    "range": [
                                                        2024,
                                                        2029
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "\"Exception occurred whilst getting my agents\"",
                                                            "range": [
                                                                2028,
                                                                2028
                                                            ],
                                                            "children": [],
                                                            "content": "except"
                                                        }
                                                    ],
                                                    "content": "\nreturn agents\nexcept Exception"
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "",
                                                    "range": [
                                                        2031,
                                                        2053
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "fastapi.responses.JSONResponse",
                                                            "range": [
                                                                2032,
                                                                2053
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "status_code=500",
                                                                    "range": [
                                                                        2039,
                                                                        2042
                                                                    ],
                                                                    "children": [],
                                                                    "content": "return fastapi.responses"
                                                                },
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "content={\"detail\": \"An error occurred while retrieving the my agents\"}",
                                                                    "range": [
                                                                        2044,
                                                                        2050
                                                                    ],
                                                                    "children": [],
                                                                    "content": "JSONResponse(\nstatus_code=500,"
                                                                }
                                                            ],
                                                            "content": "logger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent="
                                                        }
                                                    ],
                                                    "content": "\nlogger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent="
                                                }
                                            ],
                                            "content": ")\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={"
                                        }
                                    ],
                                    "content": "get_my_agents(user_id)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={"
                                }
                            ],
                            "content": "get_user_id)\n]\n):\ntry:\nagents=await backend.server.v2.store.db.get_my_agents(user_id)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={"
                        }
                    ],
                    "content": ".model.MyAgentsResponse,\n)\nasync def get_my_agents(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n]\n):\ntry:\nagents=await backend.server.v2.store.db.get_my_agents(user_id)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\""
                }
            ],
            "content": "#######\n@router.get(\n\"/myagents\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.MyAgentsResponse,\n)\nasync def get_my_agents(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n]\n):\ntry:\nagents=await backend.server.v2.store.db.get_my_agents(user_id)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\""
        },
        {
            "type": "FunctionDecl",
            "name": "delete_submission",
            "range": [
                2056,
                2210
            ],
            "children": [
                {
                    "type": "Decorator",
                    "name": "@router.delete",
                    "range": [
                        2056,
                        2097
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "path",
                            "range": [
                                2062,
                                2062
                            ],
                            "children": [],
                            "content": "\n"
                        },
                        {
                            "type": "Argument",
                            "name": "tags",
                            "range": [
                                2065,
                                2071
                            ],
                            "children": [],
                            "content": "@router.delete(\n\"/submissions/{submission_id}\""
                        },
                        {
                            "type": "Argument",
                            "name": "dependencies",
                            "range": [
                                2074,
                                2089
                            ],
                            "children": [],
                            "content": "tags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends("
                        },
                        {
                            "type": "Argument",
                            "name": "response_model",
                            "range": [
                                2092,
                                2094
                            ],
                            "children": [],
                            "content": "auth.middleware"
                        }
                    ],
                    "content": ":\"An error occurred while retrieving the my agents\"},\n)\n\n\n@router.delete(\n\"/submissions/{submission_id}\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)"
                },
                {
                    "type": "FunctionSignature",
                    "name": "delete_submission",
                    "range": [
                        2099,
                        2136
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "user_id",
                            "range": [
                                2104,
                                2126
                            ],
                            "children": [],
                            "content": ",\n)\nasync def delete_submission(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs"
                        },
                        {
                            "type": "Parameter",
                            "name": "submission_id",
                            "range": [
                                2129,
                                2131
                            ],
                            "children": [],
                            "content": ".depends."
                        }
                    ],
                    "content": ",\nresponse_model=bool,\n)\nasync def delete_submission(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],"
                },
                {
                    "type": "FunctionBody",
                    "name": "delete_submission",
                    "range": [
                        2137,
                        2210
                    ],
                    "children": [
                        {
                            "type": "Docstring",
                            "name": "delete_submission",
                            "range": [
                                2137,
                                2139
                            ],
                            "children": [],
                            "content": "\nsubmission_id:"
                        },
                        {
                            "type": "TryStatement",
                            "name": "try",
                            "range": [
                                2141,
                                2209
                            ],
                            "children": [
                                {
                                    "type": "BlockStatement",
                                    "name": "try",
                                    "range": [
                                        2141,
                                        2174
                                    ],
                                    "children": [
                                        {
                                            "type": "AssignmentExpression",
                                            "name": "result",
                                            "range": [
                                                2144,
                                                2170
                                            ],
                                            "children": [],
                                            "content": ":\n\"\"\" \\n     Delete a store listing submission. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         submission_id (str): ID of the submission to be deleted \\n  \\n     Returns: \\n         bool: True if the submission was successfully deleted, False otherwise \\n     \"\"\"\ntry:\nresult=await backend.server.v2.store.db.delete_store_submission(\nuser_id="
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return",
                                            "range": [
                                                2172,
                                                2173
                                            ],
                                            "children": [],
                                            "content": ",\n"
                                        }
                                    ],
                                    "content": ",\n):\n\"\"\" \\n     Delete a store listing submission. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         submission_id (str): ID of the submission to be deleted \\n  \\n     Returns: \\n         bool: True if the submission was successfully deleted, False otherwise \\n     \"\"\"\ntry:\nresult=await backend.server.v2.store.db.delete_store_submission(\nuser_id=user_id,\nsubmission_id"
                                },
                                {
                                    "type": "CatchClause",
                                    "name": "except",
                                    "range": [
                                        2175,
                                        2209
                                    ],
                                    "children": [
                                        {
                                            "type": "BlockStatement",
                                            "name": "except",
                                            "range": [
                                                2175,
                                                2185
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "logger.exception",
                                                    "range": [
                                                        2179,
                                                        2184
                                                    ],
                                                    "children": [],
                                                    "content": ")\nreturn result\nexcept"
                                                }
                                            ],
                                            "content": "=submission_id,\n)\nreturn result\nexcept Exception"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return",
                                            "range": [
                                                2186,
                                                2208
                                            ],
                                            "children": [],
                                            "content": ":\nlogger.exception(\"Exception occurred whilst deleting store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent"
                                        }
                                    ],
                                    "content": "=submission_id,\n)\nreturn result\nexcept Exception:\nlogger.exception(\"Exception occurred whilst deleting store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent="
                                }
                            ],
                            "content": ",\n):\n\"\"\" \\n     Delete a store listing submission. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         submission_id (str): ID of the submission to be deleted \\n  \\n     Returns: \\n         bool: True if the submission was successfully deleted, False otherwise \\n     \"\"\"\ntry:\nresult=await backend.server.v2.store.db.delete_store_submission(\nuser_id=user_id,\nsubmission_id=submission_id,\n)\nreturn result\nexcept Exception:\nlogger.exception(\"Exception occurred whilst deleting store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent="
                        }
                    ],
                    "content": "\nsubmission_id:str,\n):\n\"\"\" \\n     Delete a store listing submission. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         submission_id (str): ID of the submission to be deleted \\n  \\n     Returns: \\n         bool: True if the submission was successfully deleted, False otherwise \\n     \"\"\"\ntry:\nresult=await backend.server.v2.store.db.delete_store_submission(\nuser_id=user_id,\nsubmission_id=submission_id,\n)\nreturn result\nexcept Exception:\nlogger.exception(\"Exception occurred whilst deleting store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={"
                }
            ],
            "content": ":\"An error occurred while retrieving the my agents\"},\n)\n\n\n@router.delete(\n\"/submissions/{submission_id}\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=bool,\n)\nasync def delete_submission(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\nsubmission_id:str,\n):\n\"\"\" \\n     Delete a store listing submission. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         submission_id (str): ID of the submission to be deleted \\n  \\n     Returns: \\n         bool: True if the submission was successfully deleted, False otherwise \\n     \"\"\"\ntry:\nresult=await backend.server.v2.store.db.delete_store_submission(\nuser_id=user_id,\nsubmission_id=submission_id,\n)\nreturn result\nexcept Exception:\nlogger.exception(\"Exception occurred whilst deleting store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={"
        },
        {
            "type": "RouterDeclaration",
            "name": "router.get",
            "range": [
                2211,
                2262
            ],
            "children": [
                {
                    "type": "Path",
                    "name": "\"/submissions\"",
                    "range": [
                        2217,
                        2217
                    ],
                    "children": [],
                    "content": ")"
                },
                {
                    "type": "Tags",
                    "name": "tags",
                    "range": [
                        2220,
                        2226
                    ],
                    "children": [
                        {
                            "type": "Tag",
                            "name": "\"store\"",
                            "range": [
                                2223,
                                2223
                            ],
                            "children": [],
                            "content": "."
                        },
                        {
                            "type": "Tag",
                            "name": "\"private\"",
                            "range": [
                                2225,
                                2225
                            ],
                            "children": [],
                            "content": "("
                        }
                    ],
                    "content": "\n@router.get(\n"
                },
                {
                    "type": "Dependencies",
                    "name": "dependencies",
                    "range": [
                        2229,
                        2244
                    ],
                    "children": [
                        {
                            "type": "Dependency",
                            "name": "fastapi.Depends",
                            "range": [
                                2232,
                                2243
                            ],
                            "children": [
                                {
                                    "type": "Middleware",
                                    "name": "autogpt_libs.auth.middleware.auth_middleware",
                                    "range": [
                                        2236,
                                        2242
                                    ],
                                    "children": [],
                                    "content": "],\ndependencies=[fastapi"
                                }
                            ],
                            "content": "[\"store\",\"private\"],\ndependencies=[fastapi."
                        }
                    ],
                    "content": "\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends"
                },
                {
                    "type": "ResponseModel",
                    "name": "response_model",
                    "range": [
                        2247,
                        2259
                    ],
                    "children": [
                        {
                            "type": "Model",
                            "name": "backend.server.v2.store.model.StoreSubmissionsResponse",
                            "range": [
                                2249,
                                2259
                            ],
                            "children": [],
                            "content": ".middleware.auth_middleware)],\nresponse_model=backend"
                        }
                    ],
                    "content": ".auth.middleware.auth_middleware)],\nresponse_model=backend"
                }
            ],
            "content": "\"detail\":\"An error occurred while deleting the store submission\"},\n)\n\n\n@router.get(\n\"/submissions\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server."
        },
        {
            "type": "FunctionDecl",
            "name": "get_submissions",
            "range": [
                2264,
                2436
            ],
            "children": [
                {
                    "type": "Parameters",
                    "name": "parameters",
                    "range": [
                        2267,
                        2308
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "user_id",
                            "range": [
                                2269,
                                2291
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "typing.Annotated[str, fastapi.Depends(autogpt_libs.auth.depends.get_user_id)]",
                                    "range": [
                                        2271,
                                        2290
                                    ],
                                    "children": [],
                                    "content": "\n)\nasync def get_submissions(\nuser_id:typing.Annotated[\nstr,fastapi.Depends"
                                }
                            ],
                            "content": "StoreSubmissionsResponse,\n)\nasync def get_submissions(\nuser_id:typing.Annotated[\nstr,fastapi.Depends("
                        },
                        {
                            "type": "Parameter",
                            "name": "page",
                            "range": [
                                2294,
                                2298
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "int",
                                    "range": [
                                        2296,
                                        2296
                                    ],
                                    "children": [],
                                    "content": "depends"
                                },
                                {
                                    "type": "DefaultValue",
                                    "name": "1",
                                    "range": [
                                        2298,
                                        2298
                                    ],
                                    "children": [],
                                    "content": "get_user_id"
                                }
                            ],
                            "content": "auth.depends.get_user_id"
                        },
                        {
                            "type": "Parameter",
                            "name": "page_size",
                            "range": [
                                2301,
                                2305
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "int",
                                    "range": [
                                        2303,
                                        2303
                                    ],
                                    "children": [],
                                    "content": "\n"
                                },
                                {
                                    "type": "DefaultValue",
                                    "name": "20",
                                    "range": [
                                        2305,
                                        2305
                                    ],
                                    "children": [],
                                    "content": ":"
                                }
                            ],
                            "content": "],\npage:"
                        }
                    ],
                    "content": "model.StoreSubmissionsResponse,\n)\nasync def get_submissions(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\npage:int=1"
                },
                {
                    "type": "ReturnType",
                    "name": "StoreListingsResponse",
                    "range": [
                        2309,
                        2313
                    ],
                    "children": [],
                    "content": ",\npage_size:int"
                },
                {
                    "type": "Docstring",
                    "name": "docstring",
                    "range": [
                        2311,
                        2313
                    ],
                    "children": [],
                    "content": "page_size:int"
                },
                {
                    "type": "Body",
                    "name": "body",
                    "range": [
                        2315,
                        2436
                    ],
                    "children": [
                        {
                            "type": "IfStatement",
                            "name": "if page < 1",
                            "range": [
                                2315,
                                2336
                            ],
                            "children": [
                                {
                                    "type": "BinaryExpression",
                                    "name": "page < 1",
                                    "range": [
                                        2316,
                                        2318
                                    ],
                                    "children": [],
                                    "content": ",\n)"
                                },
                                {
                                    "type": "Body",
                                    "name": "body",
                                    "range": [
                                        2321,
                                        2335
                                    ],
                                    "children": [
                                        {
                                            "type": "RaiseStatement",
                                            "name": "raise fastapi.HTTPException",
                                            "range": [
                                                2321,
                                                2335
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "arguments",
                                                    "range": [
                                                        2325,
                                                        2334
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "status_code=422",
                                                            "range": [
                                                                2327,
                                                                2329
                                                            ],
                                                            "children": [],
                                                            "content": "<1:"
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "detail=\"Page must be greater than 0\"",
                                                            "range": [
                                                                2331,
                                                                2333
                                                            ],
                                                            "children": [],
                                                            "content": "raise fastapi."
                                                        }
                                                    ],
                                                    "content": "if page<1:\nraise fastapi.HTTPException"
                                                }
                                            ],
                                            "content": "\"\"\" \\n     Get a paginated list of store submissions for the authenticated user. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of submissions per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreListingsResponse: Paginated list of store submissions \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException("
                                        }
                                    ],
                                    "content": "\"\"\" \\n     Get a paginated list of store submissions for the authenticated user. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of submissions per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreListingsResponse: Paginated list of store submissions \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException("
                                }
                            ],
                            "content": "20,\n):\n\"\"\" \\n     Get a paginated list of store submissions for the authenticated user. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of submissions per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreListingsResponse: Paginated list of store submissions \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\n"
                        },
                        {
                            "type": "IfStatement",
                            "name": "if page_size < 1",
                            "range": [
                                2338,
                                2359
                            ],
                            "children": [
                                {
                                    "type": "BinaryExpression",
                                    "name": "page_size < 1",
                                    "range": [
                                        2339,
                                        2341
                                    ],
                                    "children": [],
                                    "content": "422,detail"
                                },
                                {
                                    "type": "Body",
                                    "name": "body",
                                    "range": [
                                        2344,
                                        2358
                                    ],
                                    "children": [
                                        {
                                            "type": "RaiseStatement",
                                            "name": "raise fastapi.HTTPException",
                                            "range": [
                                                2344,
                                                2358
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "arguments",
                                                    "range": [
                                                        2348,
                                                        2357
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "status_code=422",
                                                            "range": [
                                                                2350,
                                                                2352
                                                            ],
                                                            "children": [],
                                                            "content": "<1:"
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "detail=\"Page size must be greater than 0\"",
                                                            "range": [
                                                                2354,
                                                                2356
                                                            ],
                                                            "children": [],
                                                            "content": "raise fastapi."
                                                        }
                                                    ],
                                                    "content": "if page_size<1:\nraise fastapi.HTTPException"
                                                }
                                            ],
                                            "content": "\n)\n\nif page_size<1:\nraise fastapi.HTTPException("
                                        }
                                    ],
                                    "content": "\n)\n\nif page_size<1:\nraise fastapi.HTTPException("
                                }
                            ],
                            "content": "=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\n"
                        },
                        {
                            "type": "TryStatement",
                            "name": "try",
                            "range": [
                                2360,
                                2435
                            ],
                            "children": [
                                {
                                    "type": "Body",
                                    "name": "body",
                                    "range": [
                                        2363,
                                        2398
                                    ],
                                    "children": [
                                        {
                                            "type": "Assignment",
                                            "name": "listings = await backend.server.v2.store.db.get_store_submissions",
                                            "range": [
                                                2363,
                                                2394
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "arguments",
                                                    "range": [
                                                        2377,
                                                        2393
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "user_id=user_id",
                                                            "range": [
                                                                2379,
                                                                2381
                                                            ],
                                                            "children": [],
                                                            "content": ".v2."
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "page=page",
                                                            "range": [
                                                                2384,
                                                                2386
                                                            ],
                                                            "children": [],
                                                            "content": "db.get_store_submissions"
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "page_size=page_size",
                                                            "range": [
                                                                2389,
                                                                2391
                                                            ],
                                                            "children": [],
                                                            "content": "user_id=user_id"
                                                        }
                                                    ],
                                                    "content": ".server.v2.store.db.get_store_submissions(\nuser_id=user_id,\n"
                                                }
                                            ],
                                            "content": ",detail=\"Page size must be greater than 0\"\n)\ntry:\nlistings=await backend.server.v2.store.db.get_store_submissions(\nuser_id=user_id,\npage"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return listings",
                                            "range": [
                                                2396,
                                                2398
                                            ],
                                            "children": [],
                                            "content": "page,\n"
                                        }
                                    ],
                                    "content": ",detail=\"Page size must be greater than 0\"\n)\ntry:\nlistings=await backend.server.v2.store.db.get_store_submissions(\nuser_id=user_id,\npage=page,\n"
                                },
                                {
                                    "type": "ExceptClause",
                                    "name": "except Exception",
                                    "range": [
                                        2399,
                                        2435
                                    ],
                                    "children": [
                                        {
                                            "type": "Body",
                                            "name": "body",
                                            "range": [
                                                2403,
                                                2434
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "logger.exception",
                                                    "range": [
                                                        2403,
                                                        2408
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"Exception occurred whilst getting store submissions\"",
                                                            "range": [
                                                                2407,
                                                                2407
                                                            ],
                                                            "children": [],
                                                            "content": "listings"
                                                        }
                                                    ],
                                                    "content": "\n)\nreturn listings\n"
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "return fastapi.responses.JSONResponse",
                                                    "range": [
                                                        2410,
                                                        2434
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "arguments",
                                                            "range": [
                                                                2416,
                                                                2433
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "status_code=500",
                                                                    "range": [
                                                                        2418,
                                                                        2420
                                                                    ],
                                                                    "children": [],
                                                                    "content": ")\nreturn"
                                                                },
                                                                {
                                                                    "type": "Argument",
                                                                    "name": "content={\"detail\": \"An error occurred while retrieving the store submissions\"}",
                                                                    "range": [
                                                                        2423,
                                                                        2430
                                                                    ],
                                                                    "children": [],
                                                                    "content": "responses.JSONResponse(\nstatus_code=500"
                                                                }
                                                            ],
                                                            "content": "(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent"
                                                        }
                                                    ],
                                                    "content": "Exception:\nlogger.exception(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent="
                                                }
                                            ],
                                            "content": "\n)\nreturn listings\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent="
                                        }
                                    ],
                                    "content": "page_size=page_size,\n)\nreturn listings\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={"
                                }
                            ],
                            "content": "status_code=422,detail=\"Page size must be greater than 0\"\n)\ntry:\nlistings=await backend.server.v2.store.db.get_store_submissions(\nuser_id=user_id,\npage=page,\npage_size=page_size,\n)\nreturn listings\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={"
                        }
                    ],
                    "content": "20,\n):\n\"\"\" \\n     Get a paginated list of store submissions for the authenticated user. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of submissions per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreListingsResponse: Paginated list of store submissions \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\ntry:\nlistings=await backend.server.v2.store.db.get_store_submissions(\nuser_id=user_id,\npage=page,\npage_size=page_size,\n)\nreturn listings\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n"
                }
            ],
            "content": ".store.model.StoreSubmissionsResponse,\n)\nasync def get_submissions(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\npage:int=1,\npage_size:int=20,\n):\n\"\"\" \\n     Get a paginated list of store submissions for the authenticated user. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of submissions per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreListingsResponse: Paginated list of store submissions \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\ntry:\nlistings=await backend.server.v2.store.db.get_store_submissions(\nuser_id=user_id,\npage=page,\npage_size=page_size,\n)\nreturn listings\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n"
        },
        {
            "type": "FunctionDecl",
            "name": "create_submission",
            "range": [
                2490,
                2668
            ],
            "children": [
                {
                    "type": "Decorator",
                    "name": "@router.post",
                    "range": [
                        2437,
                        2488
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "\"/submissions\"",
                            "range": [
                                2443,
                                2443
                            ],
                            "children": [],
                            "content": "\n"
                        },
                        {
                            "type": "KeywordArgument",
                            "name": "tags",
                            "range": [
                                2446,
                                2452
                            ],
                            "children": [
                                {
                                    "type": "List",
                                    "name": "",
                                    "range": [
                                        2448,
                                        2452
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"store\"",
                                            "range": [
                                                2449,
                                                2449
                                            ],
                                            "children": [],
                                            "content": "router"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"private\"",
                                            "range": [
                                                2451,
                                                2451
                                            ],
                                            "children": [],
                                            "content": "post"
                                        }
                                    ],
                                    "content": "@router.post("
                                }
                            ],
                            "content": "\n\n@router.post("
                        },
                        {
                            "type": "KeywordArgument",
                            "name": "dependencies",
                            "range": [
                                2455,
                                2470
                            ],
                            "children": [
                                {
                                    "type": "List",
                                    "name": "",
                                    "range": [
                                        2457,
                                        2470
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "fastapi.Depends",
                                            "range": [
                                                2458,
                                                2469
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "autogpt_libs.auth.middleware.auth_middleware",
                                                    "range": [
                                                        2462,
                                                        2468
                                                    ],
                                                    "children": [],
                                                    "content": "\"private\"],\ndependencies=["
                                                }
                                            ],
                                            "content": "=[\"store\",\"private\"],\ndependencies=[fastapi"
                                        }
                                    ],
                                    "content": "tags=[\"store\",\"private\"],\ndependencies=[fastapi."
                                }
                            ],
                            "content": ",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi."
                        },
                        {
                            "type": "KeywordArgument",
                            "name": "response_model",
                            "range": [
                                2473,
                                2485
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "backend.server.v2.store.model.StoreSubmission",
                                    "range": [
                                        2475,
                                        2485
                                    ],
                                    "children": [],
                                    "content": "auth.middleware.auth_middleware)],\nresponse_model="
                                }
                            ],
                            "content": "autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model="
                        }
                    ],
                    "content": "\"detail\":\"An error occurred while retrieving the store submissions\"\n},\n)\n\n\n@router.post(\n\"/submissions\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server"
                },
                {
                    "type": "FunctionSignature",
                    "name": "",
                    "range": [
                        2490,
                        2536
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "submission_request",
                            "range": [
                                2495,
                                2507
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "backend.server.v2.store.model.StoreSubmissionRequest",
                                    "range": [
                                        2497,
                                        2507
                                    ],
                                    "children": [],
                                    "content": ",\n)\nasync def create_submission(\nsubmission_request:"
                                }
                            ],
                            "content": ".StoreSubmission,\n)\nasync def create_submission(\nsubmission_request:"
                        },
                        {
                            "type": "Parameter",
                            "name": "user_id",
                            "range": [
                                2510,
                                2532
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "typing.Annotated[str, fastapi.Depends(autogpt_libs.auth.depends.get_user_id)]",
                                    "range": [
                                        2512,
                                        2532
                                    ],
                                    "children": [],
                                    "content": "v2.store.model.StoreSubmissionRequest,\nuser_id:typing.Annotated[\nstr,fastapi.Depends"
                                }
                            ],
                            "content": "server.v2.store.model.StoreSubmissionRequest,\nuser_id:typing.Annotated[\nstr,fastapi.Depends"
                        }
                    ],
                    "content": "v2.store.model.StoreSubmission,\n)\nasync def create_submission(\nsubmission_request:backend.server.v2.store.model.StoreSubmissionRequest,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        2537,
                        2668
                    ],
                    "children": [
                        {
                            "type": "Docstring",
                            "name": "",
                            "range": [
                                2538,
                                2540
                            ],
                            "children": [],
                            "content": "depends.get_user_id"
                        },
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                2542,
                                2668
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "",
                                    "range": [
                                        2544,
                                        2633
                                    ],
                                    "children": [
                                        {
                                            "type": "Assignment",
                                            "name": "submission",
                                            "range": [
                                                2545,
                                                2629
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "await backend.server.v2.store.db.create_store_submission",
                                                    "range": [
                                                        2547,
                                                        2629
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "user_id",
                                                            "range": [
                                                                2561,
                                                                2563
                                                            ],
                                                            "children": [],
                                                            "content": "server.v2"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "agent_id",
                                                            "range": [
                                                                2566,
                                                                2570
                                                            ],
                                                            "children": [],
                                                            "content": ".db.create_store_submission("
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "agent_version",
                                                            "range": [
                                                                2573,
                                                                2577
                                                            ],
                                                            "children": [],
                                                            "content": "=user_id,\nagent_id"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "slug",
                                                            "range": [
                                                                2580,
                                                                2584
                                                            ],
                                                            "children": [],
                                                            "content": ".agent_id,\nagent_version"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "name",
                                                            "range": [
                                                                2587,
                                                                2591
                                                            ],
                                                            "children": [],
                                                            "content": ".agent_version,\nslug"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "video_url",
                                                            "range": [
                                                                2594,
                                                                2598
                                                            ],
                                                            "children": [],
                                                            "content": ".slug,\nname"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "image_urls",
                                                            "range": [
                                                                2601,
                                                                2605
                                                            ],
                                                            "children": [],
                                                            "content": ".name,\nvideo_url"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "description",
                                                            "range": [
                                                                2608,
                                                                2612
                                                            ],
                                                            "children": [],
                                                            "content": ".video_url,\nimage_urls"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "sub_heading",
                                                            "range": [
                                                                2615,
                                                                2619
                                                            ],
                                                            "children": [],
                                                            "content": ".image_urls,\ndescription"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "categories",
                                                            "range": [
                                                                2622,
                                                                2626
                                                            ],
                                                            "children": [],
                                                            "content": ".description,\nsub_heading"
                                                        }
                                                    ],
                                                    "content": ":\n\"\"\" \\n     Create a new store listing submission. \\n  \\n     Args: \\n         submission_request (StoreSubmissionRequest): The submission details \\n         user_id (str): ID of the authenticated user submitting the listing \\n  \\n     Returns: \\n         StoreSubmission: The created store submission \\n  \\n     Raises: \\n         HTTPException: If there is an error creating the submission \\n     \"\"\"\ntry:\nsubmission=await backend.server.v2.store.db.create_store_submission(\nuser_id=user_id,\nagent_id=submission_request.agent_id,\nagent_version=submission_request.agent_version,\nslug=submission_request.slug,\nname=submission_request.name,\nvideo_url=submission_request.video_url,\nimage_urls=submission_request.image_urls,\ndescription=submission_request.description,\nsub_heading=submission_request."
                                                }
                                            ],
                                            "content": "\n):\n\"\"\" \\n     Create a new store listing submission. \\n  \\n     Args: \\n         submission_request (StoreSubmissionRequest): The submission details \\n         user_id (str): ID of the authenticated user submitting the listing \\n  \\n     Returns: \\n         StoreSubmission: The created store submission \\n  \\n     Raises: \\n         HTTPException: If there is an error creating the submission \\n     \"\"\"\ntry:\nsubmission=await backend.server.v2.store.db.create_store_submission(\nuser_id=user_id,\nagent_id=submission_request.agent_id,\nagent_version=submission_request.agent_version,\nslug=submission_request.slug,\nname=submission_request.name,\nvideo_url=submission_request.video_url,\nimage_urls=submission_request.image_urls,\ndescription=submission_request.description,\nsub_heading=submission_request."
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                2631,
                                                2632
                                            ],
                                            "children": [],
                                            "content": ",\n"
                                        }
                                    ],
                                    "content": ",\n):\n\"\"\" \\n     Create a new store listing submission. \\n  \\n     Args: \\n         submission_request (StoreSubmissionRequest): The submission details \\n         user_id (str): ID of the authenticated user submitting the listing \\n  \\n     Returns: \\n         StoreSubmission: The created store submission \\n  \\n     Raises: \\n         HTTPException: If there is an error creating the submission \\n     \"\"\"\ntry:\nsubmission=await backend.server.v2.store.db.create_store_submission(\nuser_id=user_id,\nagent_id=submission_request.agent_id,\nagent_version=submission_request.agent_version,\nslug=submission_request.slug,\nname=submission_request.name,\nvideo_url=submission_request.video_url,\nimage_urls=submission_request.image_urls,\ndescription=submission_request.description,\nsub_heading=submission_request.sub_heading,\ncategories"
                                },
                                {
                                    "type": "ExceptClause",
                                    "name": "",
                                    "range": [
                                        2634,
                                        2668
                                    ],
                                    "children": [
                                        {
                                            "type": "Block",
                                            "name": "",
                                            "range": [
                                                2637,
                                                2668
                                            ],
                                            "children": [
                                                {
                                                    "type": "ExpressionStatement",
                                                    "name": "logger.exception",
                                                    "range": [
                                                        2638,
                                                        2643
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "\"Exception occurred whilst creating store submission\"",
                                                            "range": [
                                                                2642,
                                                                2642
                                                            ],
                                                            "children": [],
                                                            "content": "return"
                                                        }
                                                    ],
                                                    "content": ",\n)\nreturn submission"
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "",
                                                    "range": [
                                                        2645,
                                                        2667
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "fastapi.responses.JSONResponse",
                                                            "range": [
                                                                2646,
                                                                2667
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "status_code",
                                                                    "range": [
                                                                        2653,
                                                                        2655
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"Exception occurred whilst creating store submission\")\n"
                                                                },
                                                                {
                                                                    "type": "KeywordArgument",
                                                                    "name": "content",
                                                                    "range": [
                                                                        2658,
                                                                        2664
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Object",
                                                                            "name": "",
                                                                            "range": [
                                                                                2660,
                                                                                2664
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Property",
                                                                                    "name": "detail",
                                                                                    "range": [
                                                                                        2661,
                                                                                        2663
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "JSONResponse(\n"
                                                                                }
                                                                            ],
                                                                            "content": ".JSONResponse(\nstatus_code"
                                                                        }
                                                                    ],
                                                                    "content": ".responses.JSONResponse(\nstatus_code"
                                                                }
                                                            ],
                                                            "content": "Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,"
                                                        }
                                                    ],
                                                    "content": "except Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,"
                                                }
                                            ],
                                            "content": "categories,\n)\nreturn submission\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\n"
                                        }
                                    ],
                                    "content": "=submission_request.categories,\n)\nreturn submission\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\n"
                                }
                            ],
                            "content": "\n],\n):\n\"\"\" \\n     Create a new store listing submission. \\n  \\n     Args: \\n         submission_request (StoreSubmissionRequest): The submission details \\n         user_id (str): ID of the authenticated user submitting the listing \\n  \\n     Returns: \\n         StoreSubmission: The created store submission \\n  \\n     Raises: \\n         HTTPException: If there is an error creating the submission \\n     \"\"\"\ntry:\nsubmission=await backend.server.v2.store.db.create_store_submission(\nuser_id=user_id,\nagent_id=submission_request.agent_id,\nagent_version=submission_request.agent_version,\nslug=submission_request.slug,\nname=submission_request.name,\nvideo_url=submission_request.video_url,\nimage_urls=submission_request.image_urls,\ndescription=submission_request.description,\nsub_heading=submission_request.sub_heading,\ncategories=submission_request.categories,\n)\nreturn submission\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\n"
                        }
                    ],
                    "content": ".depends.get_user_id)\n],\n):\n\"\"\" \\n     Create a new store listing submission. \\n  \\n     Args: \\n         submission_request (StoreSubmissionRequest): The submission details \\n         user_id (str): ID of the authenticated user submitting the listing \\n  \\n     Returns: \\n         StoreSubmission: The created store submission \\n  \\n     Raises: \\n         HTTPException: If there is an error creating the submission \\n     \"\"\"\ntry:\nsubmission=await backend.server.v2.store.db.create_store_submission(\nuser_id=user_id,\nagent_id=submission_request.agent_id,\nagent_version=submission_request.agent_version,\nslug=submission_request.slug,\nname=submission_request.name,\nvideo_url=submission_request.video_url,\nimage_urls=submission_request.image_urls,\ndescription=submission_request.description,\nsub_heading=submission_request.sub_heading,\ncategories=submission_request.categories,\n)\nreturn submission\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\n"
                }
            ],
            "content": "v2.store.model.StoreSubmission,\n)\nasync def create_submission(\nsubmission_request:backend.server.v2.store.model.StoreSubmissionRequest,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Create a new store listing submission. \\n  \\n     Args: \\n         submission_request (StoreSubmissionRequest): The submission details \\n         user_id (str): ID of the authenticated user submitting the listing \\n  \\n     Returns: \\n         StoreSubmission: The created store submission \\n  \\n     Raises: \\n         HTTPException: If there is an error creating the submission \\n     \"\"\"\ntry:\nsubmission=await backend.server.v2.store.db.create_store_submission(\nuser_id=user_id,\nagent_id=submission_request.agent_id,\nagent_version=submission_request.agent_version,\nslug=submission_request.slug,\nname=submission_request.name,\nvideo_url=submission_request.video_url,\nimage_urls=submission_request.image_urls,\ndescription=submission_request.description,\nsub_heading=submission_request.sub_heading,\ncategories=submission_request.categories,\n)\nreturn submission\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\n"
        },
        {
            "type": "RouterDecl",
            "name": "router.post",
            "range": [
                2670,
                2706
            ],
            "children": [
                {
                    "type": "RoutePath",
                    "name": "\"/submissions/media\"",
                    "range": [
                        2676,
                        2676
                    ],
                    "children": [],
                    "content": ","
                },
                {
                    "type": "RouteTags",
                    "name": "tags",
                    "range": [
                        2679,
                        2685
                    ],
                    "children": [
                        {
                            "type": "Tag",
                            "name": "\"store\"",
                            "range": [
                                2682,
                                2682
                            ],
                            "children": [],
                            "content": "@"
                        },
                        {
                            "type": "Tag",
                            "name": "\"private\"",
                            "range": [
                                2684,
                                2684
                            ],
                            "children": [],
                            "content": "."
                        }
                    ],
                    "content": "\n\n\n@router.post"
                },
                {
                    "type": "RouteDependencies",
                    "name": "dependencies",
                    "range": [
                        2688,
                        2703
                    ],
                    "children": [
                        {
                            "type": "Dependency",
                            "name": "fastapi.Depends",
                            "range": [
                                2691,
                                2702
                            ],
                            "children": [
                                {
                                    "type": "DependencyPath",
                                    "name": "autogpt_libs.auth.middleware.auth_middleware",
                                    "range": [
                                        2695,
                                        2701
                                    ],
                                    "children": [],
                                    "content": ",\"private\"],\ndependencies="
                                }
                            ],
                            "content": "tags=[\"store\",\"private\"],\ndependencies=["
                        }
                    ],
                    "content": "\"/submissions/media\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi"
                }
            ],
            "content": "={\"detail\":\"An error occurred while creating the store submission\"},\n)\n\n\n@router.post(\n\"/submissions/media\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends("
        },
        {
            "type": "FunctionDecl",
            "name": "upload_submission_media",
            "range": [
                2708,
                2818
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "file",
                    "range": [
                        2713,
                        2717
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "fastapi.UploadFile",
                            "range": [
                                2715,
                                2717
                            ],
                            "children": [],
                            "content": "],\n"
                        }
                    ],
                    "content": "auth_middleware)],\n"
                },
                {
                    "type": "Parameter",
                    "name": "user_id",
                    "range": [
                        2720,
                        2742
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "typing.Annotated[str, fastapi.Depends]",
                            "range": [
                                2722,
                                2741
                            ],
                            "children": [
                                {
                                    "type": "DependencyPath",
                                    "name": "autogpt_libs.auth.depends.get_user_id",
                                    "range": [
                                        2733,
                                        2739
                                    ],
                                    "children": [],
                                    "content": ":typing.Annotated[\nstr"
                                }
                            ],
                            "content": "upload_submission_media(\nfile:fastapi.UploadFile,\nuser_id:typing.Annotated[\nstr,fastapi"
                        }
                    ],
                    "content": "async def upload_submission_media(\nfile:fastapi.UploadFile,\nuser_id:typing.Annotated[\nstr,fastapi."
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        2748,
                        2818
                    ],
                    "children": [
                        {
                            "type": "TryStatement",
                            "name": "",
                            "range": [
                                2752,
                                2818
                            ],
                            "children": [
                                {
                                    "type": "Block",
                                    "name": "",
                                    "range": [
                                        2754,
                                        2783
                                    ],
                                    "children": [
                                        {
                                            "type": "Assignment",
                                            "name": "media_url",
                                            "range": [
                                                2755,
                                                2779
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "backend.server.v2.store.media.upload_media",
                                                    "range": [
                                                        2758,
                                                        2778
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "user_id",
                                                            "range": [
                                                                2771,
                                                                2773
                                                            ],
                                                            "children": [],
                                                            "content": ".server."
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "file",
                                                            "range": [
                                                                2775,
                                                                2777
                                                            ],
                                                            "children": [],
                                                            "content": ".store."
                                                        }
                                                    ],
                                                    "content": ":\n\"\"\" \\n     Upload media (images/videos) for a store listing submission. \\n  \\n     Args: \\n         file (UploadFile): The media file to upload \\n         user_id (str): ID of the authenticated user uploading the media \\n  \\n     Returns: \\n         str: URL of the uploaded media file \\n  \\n     Raises: \\n         HTTPException: If there is an error uploading the media \\n     \"\"\"\ntry:\nmedia_url=await backend.server.v2.store.media"
                                                }
                                            ],
                                            "content": ",\n):\n\"\"\" \\n     Upload media (images/videos) for a store listing submission. \\n  \\n     Args: \\n         file (UploadFile): The media file to upload \\n         user_id (str): ID of the authenticated user uploading the media \\n  \\n     Returns: \\n         str: URL of the uploaded media file \\n  \\n     Raises: \\n         HTTPException: If there is an error uploading the media \\n     \"\"\"\ntry:\nmedia_url=await backend.server.v2.store.media."
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "media_url",
                                            "range": [
                                                2781,
                                                2782
                                            ],
                                            "children": [],
                                            "content": "(\n"
                                        }
                                    ],
                                    "content": "],\n):\n\"\"\" \\n     Upload media (images/videos) for a store listing submission. \\n  \\n     Args: \\n         file (UploadFile): The media file to upload \\n         user_id (str): ID of the authenticated user uploading the media \\n  \\n     Returns: \\n         str: URL of the uploaded media file \\n  \\n     Raises: \\n         HTTPException: If there is an error uploading the media \\n     \"\"\"\ntry:\nmedia_url=await backend.server.v2.store.media.upload_media(\nuser_id"
                                },
                                {
                                    "type": "CatchStatement",
                                    "name": "Exception",
                                    "range": [
                                        2784,
                                        2818
                                    ],
                                    "children": [
                                        {
                                            "type": "Block",
                                            "name": "",
                                            "range": [
                                                2787,
                                                2818
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "logger.exception",
                                                    "range": [
                                                        2788,
                                                        2793
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "\"Exception occurred whilst uploading submission media\"",
                                                            "range": [
                                                                2792,
                                                                2792
                                                            ],
                                                            "children": [],
                                                            "content": "\n"
                                                        }
                                                    ],
                                                    "content": "=file\n)\nreturn"
                                                },
                                                {
                                                    "type": "ReturnStatement",
                                                    "name": "fastapi.responses.JSONResponse",
                                                    "range": [
                                                        2795,
                                                        2817
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "status_code",
                                                            "range": [
                                                                2803,
                                                                2805
                                                            ],
                                                            "children": [],
                                                            "content": "(\"Exception occurred whilst uploading submission media\")"
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "content",
                                                            "range": [
                                                                2808,
                                                                2814
                                                            ],
                                                            "children": [],
                                                            "content": "fastapi.responses.JSONResponse(\n"
                                                        }
                                                    ],
                                                    "content": "\nexcept Exception:\nlogger.exception(\"Exception occurred whilst uploading submission media\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500"
                                                }
                                            ],
                                            "content": "file=file\n)\nreturn media_url\nexcept Exception:\nlogger.exception(\"Exception occurred whilst uploading submission media\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,"
                                        }
                                    ],
                                    "content": "=user_id,file=file\n)\nreturn media_url\nexcept Exception:\nlogger.exception(\"Exception occurred whilst uploading submission media\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,"
                                }
                            ],
                            "content": ")\n],\n):\n\"\"\" \\n     Upload media (images/videos) for a store listing submission. \\n  \\n     Args: \\n         file (UploadFile): The media file to upload \\n         user_id (str): ID of the authenticated user uploading the media \\n  \\n     Returns: \\n         str: URL of the uploaded media file \\n  \\n     Raises: \\n         HTTPException: If there is an error uploading the media \\n     \"\"\"\ntry:\nmedia_url=await backend.server.v2.store.media.upload_media(\nuser_id=user_id,file=file\n)\nreturn media_url\nexcept Exception:\nlogger.exception(\"Exception occurred whilst uploading submission media\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,"
                        }
                    ],
                    "content": ".depends.get_user_id)\n],\n):\n\"\"\" \\n     Upload media (images/videos) for a store listing submission. \\n  \\n     Args: \\n         file (UploadFile): The media file to upload \\n         user_id (str): ID of the authenticated user uploading the media \\n  \\n     Returns: \\n         str: URL of the uploaded media file \\n  \\n     Raises: \\n         HTTPException: If there is an error uploading the media \\n     \"\"\"\ntry:\nmedia_url=await backend.server.v2.store.media.upload_media(\nuser_id=user_id,file=file\n)\nreturn media_url\nexcept Exception:\nlogger.exception(\"Exception occurred whilst uploading submission media\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,"
                }
            ],
            "content": ".auth.middleware.auth_middleware)],\n)\nasync def upload_submission_media(\nfile:fastapi.UploadFile,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Upload media (images/videos) for a store listing submission. \\n  \\n     Args: \\n         file (UploadFile): The media file to upload \\n         user_id (str): ID of the authenticated user uploading the media \\n  \\n     Returns: \\n         str: URL of the uploaded media file \\n  \\n     Raises: \\n         HTTPException: If there is an error uploading the media \\n     \"\"\"\ntry:\nmedia_url=await backend.server.v2.store.media.upload_media(\nuser_id=user_id,file=file\n)\nreturn media_url\nexcept Exception:\nlogger.exception(\"Exception occurred whilst uploading submission media\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,"
        },
        {
            "type": "FunctionDecl",
            "name": "generate_image",
            "range": [
                2853,
                3155
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "agent_id",
                    "range": [
                        2858,
                        2860
                    ],
                    "children": [],
                    "content": "autogpt_libs.auth"
                },
                {
                    "type": "Parameter",
                    "name": "user_id",
                    "range": [
                        2863,
                        2885
                    ],
                    "children": [],
                    "content": ".auth_middleware)],\n)\nasync def generate_image(\nagent_id:str,\nuser_id:typing.Annotated"
                },
                {
                    "type": "ReturnType",
                    "name": "Response",
                    "range": [
                        2889,
                        2896
                    ],
                    "children": [],
                    "content": ",fastapi.Depends(autogpt_libs.auth"
                },
                {
                    "type": "Docstring",
                    "name": "Docstring",
                    "range": [
                        2898,
                        2900
                    ],
                    "children": [],
                    "content": "depends.get_user_id"
                },
                {
                    "type": "TryBlock",
                    "name": "TryBlock",
                    "range": [
                        2902,
                        3120
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "agent",
                            "range": [
                                2905,
                                2921
                            ],
                            "children": [],
                            "content": "\n)->fastapi.responses.Response:\n\"\"\" \\n     Generate an image for a store listing submission. \\n  \\n     Args: \\n         agent_id (str): ID of the agent to generate an image for \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         JSONResponse: JSON containing the URL of the generated image \\n     \"\"\"\ntry:"
                        },
                        {
                            "type": "IfStatement",
                            "name": "IfStatement",
                            "range": [
                                2924,
                                2945
                            ],
                            "children": [
                                {
                                    "type": "RaiseStatement",
                                    "name": "RaiseStatement",
                                    "range": [
                                        2929,
                                        2944
                                    ],
                                    "children": [],
                                    "content": ".graph.get_graph(agent_id,user_id=user_id)\n\nif not agent"
                                }
                            ],
                            "content": "=await backend.data.graph.get_graph(agent_id,user_id=user_id)\n\nif not agent:"
                        },
                        {
                            "type": "Assignment",
                            "name": "filename",
                            "range": [
                                2958,
                                2961
                            ],
                            "children": [],
                            "content": "=f \"Agent with ID {agent_id} not found\"\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "existing_url",
                            "range": [
                                2964,
                                2984
                            ],
                            "children": [],
                            "content": "#Use.jpeg here since we are generating JPEG images\nfilename=f \"agent_{agent_id}.jpeg\"\n\nexisting_url=await"
                        },
                        {
                            "type": "IfStatement",
                            "name": "IfStatement",
                            "range": [
                                2986,
                                3013
                            ],
                            "children": [
                                {
                                    "type": "ReturnStatement",
                                    "name": "ReturnStatement",
                                    "range": [
                                        2998,
                                        3012
                                    ],
                                    "children": [],
                                    "content": "user_id,filename\n)\nif existing_url:\nlogger.info(f"
                                }
                            ],
                            "content": ".server.v2.store.media.check_media_exists(\nuser_id,filename\n)\nif existing_url:\nlogger.info(f \"Using existing image for agent {agent_id}\""
                        },
                        {
                            "type": "Assignment",
                            "name": "image",
                            "range": [
                                3021,
                                3041
                            ],
                            "children": [],
                            "content": "JSONResponse(content={\"image_url\":existing_url})\n#Generate agent image as JPEG\nimage=await"
                        },
                        {
                            "type": "Assignment",
                            "name": "image_file",
                            "range": [
                                3054,
                                3071
                            ],
                            "children": [],
                            "content": "\nagent=agent\n)\n\n#Create UploadFile with the correct filename and content_type\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "image_url",
                            "range": [
                                3074,
                                3102
                            ],
                            "children": [],
                            "content": "fastapi.UploadFile(\nfile=image,\nfilename=filename,\n)\n\nimage_url=await backend.server.v2.store."
                        },
                        {
                            "type": "ReturnStatement",
                            "name": "ReturnStatement",
                            "range": [
                                3105,
                                3119
                            ],
                            "children": [],
                            "content": "upload_media(\nuser_id=user_id,file=image_file,use_file_name=True\n"
                        }
                    ],
                    "content": "\n],\n)->fastapi.responses.Response:\n\"\"\" \\n     Generate an image for a store listing submission. \\n  \\n     Args: \\n         agent_id (str): ID of the agent to generate an image for \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         JSONResponse: JSON containing the URL of the generated image \\n     \"\"\"\ntry:\nagent=await backend.data.graph.get_graph(agent_id,user_id=user_id)\n\nif not agent:\nraise fastapi.HTTPException(\nstatus_code=404,detail=f \"Agent with ID {agent_id} not found\"\n)\n#Use.jpeg here since we are generating JPEG images\nfilename=f \"agent_{agent_id}.jpeg\"\n\nexisting_url=await backend.server.v2.store.media.check_media_exists(\nuser_id,filename\n)\nif existing_url:\nlogger.info(f \"Using existing image for agent {agent_id}\")\nreturn fastapi.responses.JSONResponse(content={\"image_url\":existing_url})\n#Generate agent image as JPEG\nimage=await backend.server.v2.store.image_gen.generate_agent_image(\nagent=agent\n)\n\n#Create UploadFile with the correct filename and content_type\nimage_file=fastapi.UploadFile(\nfile=image,\nfilename=filename,\n)\n\nimage_url=await backend.server.v2.store.media.upload_media(\nuser_id=user_id,file=image_file,use_file_name=True\n)"
                },
                {
                    "type": "ExceptBlock",
                    "name": "ExceptBlock",
                    "range": [
                        3121,
                        3154
                    ],
                    "children": [
                        {
                            "type": "ReturnStatement",
                            "name": "ReturnStatement",
                            "range": [
                                3132,
                                3153
                            ],
                            "children": [],
                            "content": "{\"image_url\":image_url})\nexcept Exception:\nlogger.exception(\"Exception occurred whilst generating submission image\")\nreturn fastapi.responses"
                        }
                    ],
                    "content": "\n\nreturn fastapi.responses.JSONResponse(content={\"image_url\":image_url})\nexcept Exception:\nlogger.exception(\"Exception occurred whilst generating submission image\")\nreturn fastapi.responses."
                }
            ],
            "content": "[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\n)\nasync def generate_image(\nagent_id:str,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n)->fastapi.responses.Response:\n\"\"\" \\n     Generate an image for a store listing submission. \\n  \\n     Args: \\n         agent_id (str): ID of the agent to generate an image for \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         JSONResponse: JSON containing the URL of the generated image \\n     \"\"\"\ntry:\nagent=await backend.data.graph.get_graph(agent_id,user_id=user_id)\n\nif not agent:\nraise fastapi.HTTPException(\nstatus_code=404,detail=f \"Agent with ID {agent_id} not found\"\n)\n#Use.jpeg here since we are generating JPEG images\nfilename=f \"agent_{agent_id}.jpeg\"\n\nexisting_url=await backend.server.v2.store.media.check_media_exists(\nuser_id,filename\n)\nif existing_url:\nlogger.info(f \"Using existing image for agent {agent_id}\")\nreturn fastapi.responses.JSONResponse(content={\"image_url\":existing_url})\n#Generate agent image as JPEG\nimage=await backend.server.v2.store.image_gen.generate_agent_image(\nagent=agent\n)\n\n#Create UploadFile with the correct filename and content_type\nimage_file=fastapi.UploadFile(\nfile=image,\nfilename=filename,\n)\n\nimage_url=await backend.server.v2.store.media.upload_media(\nuser_id=user_id,file=image_file,use_file_name=True\n)\n\nreturn fastapi.responses.JSONResponse(content={\"image_url\":image_url})\nexcept Exception:\nlogger.exception(\"Exception occurred whilst generating submission image\")\nreturn fastapi.responses.JSONResponse"
        }
    ],
    "content": "\n##############################################\n###############Profile Endpoints############\n##############################################\n\n\n@router.get(\n\"/profile\",\ntags=[\"store\",\"private\"],\nresponse_model=backend.server.v2.store.model.ProfileDetails,\n)\nasync def get_profile(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n]\n):\n\"\"\" \\n     Get the profile details for the authenticated user. \\n     \"\"\"\ntry:\nprofile=await backend.server.v2.store.db.get_user_profile(user_id)\nreturn profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting user profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the user profile\"},\n)\n\n\n@router.post(\n\"/profile\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.CreatorDetails,\n)\nasync def update_or_create_profile(\nprofile:backend.server.v2.store.model.Profile,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Update the store profile for the authenticated user. \\n  \\n     Args: \\n         profile (Profile): The updated profile details \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         CreatorDetails: The updated profile \\n  \\n     Raises: \\n         HTTPException: If there is an error updating the profile \\n     \"\"\"\ntry:\nupdated_profile=await backend.server.v2.store.db.update_or_create_profile(\nuser_id=user_id,profile=profile\n)\nreturn updated_profile\nexcept Exception:\nlogger.exception(\"Exception occurred whilst updating profile\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while updating the user profile\"},\n)\n\n\n##############################################\n###############Agent Endpoints##############\n##############################################\n\n\n@router.get(\n\"/agents\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store.model.StoreAgentsResponse,\n)\nasync def get_agents(\nfeatured:bool=False,\ncreator:str|None=None,\nsorted_by:str|None=None,\nsearch_query:str|None=None,\ncategory:str|None=None,\npage:int=1,\npage_size:int=20,\n):\n\"\"\" \\n     Get a paginated list of agents from the store with optional filtering and sorting. \\n  \\n     Args: \\n         featured (bool, optional): Filter to only show featured agents. Defaults to False. \\n         creator (str | None, optional): Filter agents by creator username. Defaults to None. \\n         sorted_by (str | None, optional): Sort agents by \" runs \" or \" rating \". Defaults to None. \\n         search_query (str | None, optional): Search agents by name, subheading and description. Defaults to None. \\n         category (str | None, optional): Filter agents by category. Defaults to None. \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of agents per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreAgentsResponse: Paginated list of agents matching the filters \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n  \\n     Used for: \\n     - Home Page Featured Agents \\n     - Home Page Top Agents \\n     - Search Results \\n     - Agent Details - Other Agents By Creator \\n     - Agent Details - Similar Agents \\n     - Creator Details - Agents By Creator \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\n\ntry:\nagents=await backend.server.v2.store.db.get_store_agents(\nfeatured=featured,\ncreator=creator,\nsorted_by=sorted_by,\nsearch_query=search_query,\ncategory=category,\npage=page,\npage_size=page_size,\n)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occured whilst getting store agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store agents\"},\n)\n\n\n@router.get(\n\"/agents/{username}/{agent_name}\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store.model.StoreAgentDetails,\n)\nasync def get_agent(username:str,agent_name:str):\n\"\"\" \\n     This is only used on the AgentDetails Page \\n  \\n     It returns the store listing agents details. \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\n#URL decode the agent name since it comes from the URL path\nagent_name=urllib.parse.unquote(agent_name).lower()\nagent=await backend.server.v2.store.db.get_store_agent_details(\nusername=username,agent_name=agent_name\n)\nreturn agent\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store agent details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store agent details\"\n},\n)\n\n\n@router.post(\n\"/agents/{username}/{agent_name}/review\",\ntags=[\"store\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.StoreReview,\n)\nasync def create_review(\nusername:str,\nagent_name:str,\nreview:backend.server.v2.store.model.StoreReviewCreate,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Create a review for a store agent. \\n  \\n     Args: \\n         username: Creator's username \\n         agent_name: Name/slug of the agent \\n         review: Review details including score and optional comments \\n         user_id: ID of authenticated user creating the review \\n  \\n     Returns: \\n         The created review \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\nagent_name=urllib.parse.unquote(agent_name)\n#Create the review\ncreated_review=await backend.server.v2.store.db.create_store_review(\nuser_id=user_id,\nstore_listing_version_id=review.store_listing_version_id,\nscore=review.score,\ncomments=review.comments,\n)\n\nreturn created_review\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store review\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while creating the store review\"},\n)\n\n\n##############################################\n#############Creator Endpoints#############\n##############################################\n\n\n@router.get(\n\"/creators\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store.model.CreatorsResponse,\n)\nasync def get_creators(\nfeatured:bool=False,\nsearch_query:str|None=None,\nsorted_by:str|None=None,\npage:int=1,\npage_size:int=20,\n):\n\"\"\" \\n     This is needed for: \\n     - Home Page Featured Creators \\n     - Search Results Page \\n  \\n     --- \\n  \\n     To support this functionality we need: \\n     - featured: bool - to limit the list to just featured agents \\n     - search_query: str - vector search based on the creators profile description. \\n     - sorted_by: [agent_rating, agent_runs] - \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\n\ntry:\ncreators=await backend.server.v2.store.db.get_store_creators(\nfeatured=featured,\nsearch_query=search_query,\nsorted_by=sorted_by,\npage=page,\npage_size=page_size,\n)\nreturn creators\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store creators\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the store creators\"},\n)\n\n\n@router.get(\n\"/creator/{username}\",\ntags=[\"store\",\"public\"],\nresponse_model=backend.server.v2.store.model.CreatorDetails,\n)\nasync def get_creator(\nusername:str,\n):\n\"\"\" \\n     Get the details of a creator \\n     - Creator Details Page \\n     \"\"\"\ntry:\nusername=urllib.parse.unquote(username).lower()\ncreator=await backend.server.v2.store.db.get_store_creator_details(\nusername=username.lower()\n)\nreturn creator\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting creator details\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the creator details\"\n},\n)\n\n\n############################################\n#############Store Submissions###############\n############################################\n@router.get(\n\"/myagents\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.MyAgentsResponse,\n)\nasync def get_my_agents(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n]\n):\ntry:\nagents=await backend.server.v2.store.db.get_my_agents(user_id)\nreturn agents\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting my agents\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while retrieving the my agents\"},\n)\n\n\n@router.delete(\n\"/submissions/{submission_id}\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=bool,\n)\nasync def delete_submission(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\nsubmission_id:str,\n):\n\"\"\" \\n     Delete a store listing submission. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         submission_id (str): ID of the submission to be deleted \\n  \\n     Returns: \\n         bool: True if the submission was successfully deleted, False otherwise \\n     \"\"\"\ntry:\nresult=await backend.server.v2.store.db.delete_store_submission(\nuser_id=user_id,\nsubmission_id=submission_id,\n)\nreturn result\nexcept Exception:\nlogger.exception(\"Exception occurred whilst deleting store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while deleting the store submission\"},\n)\n\n\n@router.get(\n\"/submissions\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.StoreSubmissionsResponse,\n)\nasync def get_submissions(\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\npage:int=1,\npage_size:int=20,\n):\n\"\"\" \\n     Get a paginated list of store submissions for the authenticated user. \\n  \\n     Args: \\n         user_id (str): ID of the authenticated user \\n         page (int, optional): Page number for pagination. Defaults to 1. \\n         page_size (int, optional): Number of submissions per page. Defaults to 20. \\n  \\n     Returns: \\n         StoreListingsResponse: Paginated list of store submissions \\n  \\n     Raises: \\n         HTTPException: If page or page_size are less than 1 \\n     \"\"\"\nif page<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page must be greater than 0\"\n)\n\nif page_size<1:\nraise fastapi.HTTPException(\nstatus_code=422,detail=\"Page size must be greater than 0\"\n)\ntry:\nlistings=await backend.server.v2.store.db.get_store_submissions(\nuser_id=user_id,\npage=page,\npage_size=page_size,\n)\nreturn listings\nexcept Exception:\nlogger.exception(\"Exception occurred whilst getting store submissions\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\n\"detail\":\"An error occurred while retrieving the store submissions\"\n},\n)\n\n\n@router.post(\n\"/submissions\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\nresponse_model=backend.server.v2.store.model.StoreSubmission,\n)\nasync def create_submission(\nsubmission_request:backend.server.v2.store.model.StoreSubmissionRequest,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Create a new store listing submission. \\n  \\n     Args: \\n         submission_request (StoreSubmissionRequest): The submission details \\n         user_id (str): ID of the authenticated user submitting the listing \\n  \\n     Returns: \\n         StoreSubmission: The created store submission \\n  \\n     Raises: \\n         HTTPException: If there is an error creating the submission \\n     \"\"\"\ntry:\nsubmission=await backend.server.v2.store.db.create_store_submission(\nuser_id=user_id,\nagent_id=submission_request.agent_id,\nagent_version=submission_request.agent_version,\nslug=submission_request.slug,\nname=submission_request.name,\nvideo_url=submission_request.video_url,\nimage_urls=submission_request.image_urls,\ndescription=submission_request.description,\nsub_heading=submission_request.sub_heading,\ncategories=submission_request.categories,\n)\nreturn submission\nexcept Exception:\nlogger.exception(\"Exception occurred whilst creating store submission\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while creating the store submission\"},\n)\n\n\n@router.post(\n\"/submissions/media\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\n)\nasync def upload_submission_media(\nfile:fastapi.UploadFile,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n):\n\"\"\" \\n     Upload media (images/videos) for a store listing submission. \\n  \\n     Args: \\n         file (UploadFile): The media file to upload \\n         user_id (str): ID of the authenticated user uploading the media \\n  \\n     Returns: \\n         str: URL of the uploaded media file \\n  \\n     Raises: \\n         HTTPException: If there is an error uploading the media \\n     \"\"\"\ntry:\nmedia_url=await backend.server.v2.store.media.upload_media(\nuser_id=user_id,file=file\n)\nreturn media_url\nexcept Exception:\nlogger.exception(\"Exception occurred whilst uploading submission media\")\nreturn fastapi.responses.JSONResponse(\nstatus_code=500,\ncontent={\"detail\":\"An error occurred while uploading the media file\"},\n)\n\n\n@router.post(\n\"/submissions/generate_image\",\ntags=[\"store\",\"private\"],\ndependencies=[fastapi.Depends(autogpt_libs.auth.middleware.auth_middleware)],\n)\nasync def generate_image(\nagent_id:str,\nuser_id:typing.Annotated[\nstr,fastapi.Depends(autogpt_libs.auth.depends.get_user_id)\n],\n)->fastapi.responses.Response:\n\"\"\" \\n     Generate an image for a store listing submission. \\n  \\n     Args: \\n         agent_id (str): ID of the agent to generate an image for \\n         user_id (str): ID of the authenticated user \\n  \\n     Returns: \\n         JSONResponse: JSON containing the URL of the generated image \\n     \"\"\"\ntry:\nagent=await backend.data.graph.get_graph(agent_id,user_id=user_id)\n\nif not agent:\nraise fastapi.HTTPException(\nstatus_code=404,detail=f \"Agent with ID {agent_id} not found\"\n)\n#Use.jpeg here since we are generating JPEG images\nfilename=f \"agent_{agent_id}.jpeg\"\n\nexisting_url=await backend.server.v2.store.media.check_media_exists(\nuser_id,filename\n)\nif existing_url:\nlogger.info(f \"Using existing image for agent {agent_id}\")\nreturn fastapi.responses.JSONResponse(content={\"image_url\":existing_url})\n#Generate agent image as JPEG\nimage=await backend.server.v2.store.image_gen.generate_agent_image(\nagent=agent\n)\n\n#Create UploadFile with the correct filename and content_type\nimage_file=fastapi.UploadFile(\nfile=image,\nfilename=filename,\n)\n\nimage_url=await backend.server.v2.store.media.upload_media(\nuser_id=user_id,file=image_file,use_file_name=True\n)\n\nreturn fastapi.responses.JSONResponse(content={\"image_url\":image_url})\nexcept Exception:\nlogger.exception(\"Exception occurred whilst generating submission image\")\nreturn fastapi.responses.JSONResponse"
}
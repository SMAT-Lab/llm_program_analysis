{
    "type": "Program",
    "name": "Global",
    "range": [
        15,
        342
    ],
    "children": [
        {
            "type": "FunctionDecl",
            "name": "test_verify_user_no_payload",
            "range": [
                15,
                20
            ],
            "children": [],
            "content": "\ndef test_verify_user_no_payload():"
        },
        {
            "type": "AssignmentExpression",
            "name": "user",
            "range": [
                21,
                30
            ],
            "children": [
                {
                    "type": "CallExpression",
                    "name": "verify_user",
                    "range": [
                        23,
                        30
                    ],
                    "children": [
                        {
                            "type": "Literal",
                            "name": "None",
                            "range": [
                                25,
                                25
                            ],
                            "children": [],
                            "content": "("
                        },
                        {
                            "type": "Identifier",
                            "name": "admin_only",
                            "range": [
                                27,
                                29
                            ],
                            "children": [],
                            "content": ",admin_only="
                        }
                    ],
                    "content": "=verify_user(None,admin_only=False"
                }
            ],
            "content": "\nuser=verify_user(None,admin_only=False"
        },
        {
            "type": "ExpressionStatement",
            "name": "assert",
            "range": [
                32,
                38
            ],
            "children": [
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        36,
                        37
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.user_id",
                            "range": [
                                33,
                                35
                            ],
                            "children": [],
                            "content": "assert user."
                        },
                        {
                            "type": "Literal",
                            "name": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"",
                            "range": [
                                38,
                                38
                            ],
                            "children": [],
                            "content": "="
                        }
                    ],
                    "content": "user_id="
                }
            ],
            "content": "\nassert user.user_id=="
        },
        {
            "type": "ExpressionStatement",
            "name": "assert",
            "range": [
                40,
                46
            ],
            "children": [
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        44,
                        45
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.role",
                            "range": [
                                41,
                                43
                            ],
                            "children": [],
                            "content": "assert user."
                        },
                        {
                            "type": "Literal",
                            "name": "\"admin\"",
                            "range": [
                                46,
                                46
                            ],
                            "children": [],
                            "content": "="
                        }
                    ],
                    "content": "role="
                }
            ],
            "content": "\nassert user.role=="
        },
        {
            "type": "FunctionDecl",
            "name": "test_verify_user_no_user_id",
            "range": [
                49,
                77
            ],
            "children": [
                {
                    "type": "WithStatement",
                    "name": "",
                    "range": [
                        55,
                        75
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "pytest.raises",
                            "range": [
                                56,
                                61
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "Exception",
                                    "range": [
                                        60,
                                        60
                                    ],
                                    "children": [],
                                    "content": "raises"
                                }
                            ],
                            "content": "\nwith pytest.raises("
                        },
                        {
                            "type": "CallExpression",
                            "name": "verify_user",
                            "range": [
                                64,
                                75
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "{\"role\": \"admin\"}",
                                    "range": [
                                        66,
                                        70
                                    ],
                                    "children": [],
                                    "content": "verify_user({\"role\":"
                                },
                                {
                                    "type": "Keyword",
                                    "name": "admin_only",
                                    "range": [
                                        72,
                                        74
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "False",
                                            "range": [
                                                74,
                                                74
                                            ],
                                            "children": [],
                                            "content": "admin_only"
                                        }
                                    ],
                                    "content": "},admin_only"
                                }
                            ],
                            "content": ":\nverify_user({\"role\":\"admin\"},admin_only="
                        }
                    ],
                    "content": ":\nwith pytest.raises(Exception):\nverify_user({\"role\":\"admin\"},admin_only="
                }
            ],
            "content": "\n\ndef test_verify_user_no_user_id():\nwith pytest.raises(Exception):\nverify_user({\"role\":\"admin\"},admin_only=False)"
        },
        {
            "type": "FunctionDecl",
            "name": "test_verify_user_not_admin",
            "range": [
                78,
                114
            ],
            "children": [
                {
                    "type": "WithStatement",
                    "name": "",
                    "range": [
                        84,
                        113
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "pytest.raises",
                            "range": [
                                85,
                                90
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "Exception",
                                    "range": [
                                        89,
                                        89
                                    ],
                                    "children": [],
                                    "content": "."
                                }
                            ],
                            "content": ":\nwith pytest.raises"
                        },
                        {
                            "type": "CallExpression",
                            "name": "verify_user",
                            "range": [
                                93,
                                112
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        96,
                                        104
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "sub",
                                            "range": [
                                                97,
                                                99
                                            ],
                                            "children": [],
                                            "content": "(\n{"
                                        },
                                        {
                                            "type": "Property",
                                            "name": "role",
                                            "range": [
                                                101,
                                                103
                                            ],
                                            "children": [],
                                            "content": ":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\","
                                        }
                                    ],
                                    "content": "verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\""
                                },
                                {
                                    "type": "Identifier",
                                    "name": "admin_only",
                                    "range": [
                                        107,
                                        109
                                    ],
                                    "children": [],
                                    "content": "},\n"
                                }
                            ],
                            "content": "):\nverify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only=True"
                        }
                    ],
                    "content": "):\nwith pytest.raises(Exception):\nverify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only=True,"
                }
            ],
            "content": "\n\n\ndef test_verify_user_not_admin():\nwith pytest.raises(Exception):\nverify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only=True,\n"
        },
        {
            "type": "FunctionDecl",
            "name": "test_verify_user_with_admin_role",
            "range": [
                115,
                143
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        120,
                        143
                    ],
                    "children": [
                        {
                            "type": "AssignmentExpression",
                            "name": "user",
                            "range": [
                                121,
                                142
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "verify_user",
                                    "range": [
                                        123,
                                        142
                                    ],
                                    "children": [
                                        {
                                            "type": "ObjectExpression",
                                            "name": "",
                                            "range": [
                                                126,
                                                134
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "sub",
                                                    "range": [
                                                        127,
                                                        129
                                                    ],
                                                    "children": [],
                                                    "content": "verify_user(\n"
                                                },
                                                {
                                                    "type": "Property",
                                                    "name": "role",
                                                    "range": [
                                                        131,
                                                        133
                                                    ],
                                                    "children": [],
                                                    "content": "\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                                                }
                                            ],
                                            "content": "=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\","
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "admin_only",
                                            "range": [
                                                137,
                                                139
                                            ],
                                            "children": [],
                                            "content": "\"admin\"},"
                                        }
                                    ],
                                    "content": ":\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"admin\"},\nadmin_only="
                                }
                            ],
                            "content": "():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"admin\"},\nadmin_only="
                        }
                    ],
                    "content": "test_verify_user_with_admin_role():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"admin\"},\nadmin_only=True"
                }
            ],
            "content": ")\n\n\ndef test_verify_user_with_admin_role():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"admin\"},\nadmin_only=True"
        },
        {
            "type": "AssertStatement",
            "name": "",
            "range": [
                144,
                151
            ],
            "children": [
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        148,
                        150
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.user_id",
                            "range": [
                                145,
                                147
                            ],
                            "children": [],
                            "content": "\n)\n"
                        },
                        {
                            "type": "Literal",
                            "name": "3e53486c-cf57-477e-ba2a-cb02dc828e1a",
                            "range": [
                                150,
                                150
                            ],
                            "children": [],
                            "content": "."
                        }
                    ],
                    "content": "assert user."
                }
            ],
            "content": ",\n)\nassert user.user_id"
        },
        {
            "type": "AssertStatement",
            "name": "",
            "range": [
                152,
                159
            ],
            "children": [
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        156,
                        158
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.role",
                            "range": [
                                153,
                                155
                            ],
                            "children": [],
                            "content": "=\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\n"
                        },
                        {
                            "type": "Literal",
                            "name": "admin",
                            "range": [
                                158,
                                158
                            ],
                            "children": [],
                            "content": "."
                        }
                    ],
                    "content": "assert user."
                }
            ],
            "content": "==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user.role"
        },
        {
            "type": "FunctionDecl",
            "name": "test_verify_user_with_user_role",
            "range": [
                161,
                189
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        166,
                        189
                    ],
                    "children": [
                        {
                            "type": "AssignmentExpression",
                            "name": "user",
                            "range": [
                                167,
                                188
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "verify_user",
                                    "range": [
                                        169,
                                        188
                                    ],
                                    "children": [
                                        {
                                            "type": "ObjectExpression",
                                            "name": "",
                                            "range": [
                                                172,
                                                180
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "sub",
                                                    "range": [
                                                        173,
                                                        175
                                                    ],
                                                    "children": [],
                                                    "content": "=verify_user("
                                                },
                                                {
                                                    "type": "Property",
                                                    "name": "role",
                                                    "range": [
                                                        177,
                                                        179
                                                    ],
                                                    "children": [],
                                                    "content": "{\"sub\":"
                                                }
                                            ],
                                            "content": "user=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "admin_only",
                                            "range": [
                                                183,
                                                185
                                            ],
                                            "children": [],
                                            "content": ":\"user\"}"
                                        }
                                    ],
                                    "content": "):\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only"
                                }
                            ],
                            "content": "test_verify_user_with_user_role():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only"
                        }
                    ],
                    "content": "def test_verify_user_with_user_role():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only="
                }
            ],
            "content": "=\"admin\"\n\n\ndef test_verify_user_with_user_role():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only="
        },
        {
            "type": "ExpressionStatement",
            "name": "",
            "range": [
                190,
                197
            ],
            "children": [
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        194,
                        196
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.user_id",
                            "range": [
                                191,
                                193
                            ],
                            "children": [],
                            "content": ",\n)"
                        },
                        {
                            "type": "Literal",
                            "name": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"",
                            "range": [
                                196,
                                196
                            ],
                            "children": [],
                            "content": "user"
                        }
                    ],
                    "content": "\nassert user"
                }
            ],
            "content": "False,\n)\nassert user."
        },
        {
            "type": "ExpressionStatement",
            "name": "",
            "range": [
                198,
                205
            ],
            "children": [
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        202,
                        204
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.role",
                            "range": [
                                199,
                                201
                            ],
                            "children": [],
                            "content": "==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                        },
                        {
                            "type": "Literal",
                            "name": "\"user\"",
                            "range": [
                                204,
                                204
                            ],
                            "children": [],
                            "content": "user"
                        }
                    ],
                    "content": "\nassert user"
                }
            ],
            "content": "user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user."
        },
        {
            "type": "FunctionDecl",
            "name": "test_requires_user",
            "range": [
                207,
                229
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "test_requires_user",
                    "range": [
                        207,
                        211
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                207,
                                207
                            ],
                            "children": [],
                            "content": "="
                        },
                        {
                            "type": "Identifier",
                            "name": "test_requires_user",
                            "range": [
                                208,
                                208
                            ],
                            "children": [],
                            "content": "="
                        }
                    ],
                    "content": "==\"user\"\n\n"
                },
                {
                    "type": "FunctionBody",
                    "name": "test_requires_user",
                    "range": [
                        212,
                        229
                    ],
                    "children": [
                        {
                            "type": "AssignmentExpression",
                            "name": "user",
                            "range": [
                                213,
                                228
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "user",
                                    "range": [
                                        213,
                                        213
                                    ],
                                    "children": [],
                                    "content": "def"
                                },
                                {
                                    "type": "CallExpression",
                                    "name": "requires_user",
                                    "range": [
                                        215,
                                        228
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "requires_user",
                                            "range": [
                                                215,
                                                215
                                            ],
                                            "children": [],
                                            "content": "("
                                        },
                                        {
                                            "type": "ObjectExpression",
                                            "name": "",
                                            "range": [
                                                218,
                                                226
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "sub",
                                                    "range": [
                                                        219,
                                                        221
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"",
                                                            "range": [
                                                                221,
                                                                221
                                                            ],
                                                            "children": [],
                                                            "content": "requires_user"
                                                        }
                                                    ],
                                                    "content": "user=requires_user"
                                                },
                                                {
                                                    "type": "Property",
                                                    "name": "role",
                                                    "range": [
                                                        223,
                                                        225
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"user\"",
                                                            "range": [
                                                                225,
                                                                225
                                                            ],
                                                            "children": [],
                                                            "content": "\"sub\""
                                                        }
                                                    ],
                                                    "content": "\n{\"sub\""
                                                }
                                            ],
                                            "content": "\nuser=requires_user(\n{\"sub\":"
                                        }
                                    ],
                                    "content": "():\nuser=requires_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\","
                                }
                            ],
                            "content": "def test_requires_user():\nuser=requires_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\","
                        }
                    ],
                    "content": "\ndef test_requires_user():\nuser=requires_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\""
                }
            ],
            "content": "==\"user\"\n\n\ndef test_requires_user():\nuser=requires_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\""
        },
        {
            "type": "AssertStatement",
            "name": "",
            "range": [
                230,
                237
            ],
            "children": [
                {
                    "type": "Keyword",
                    "name": "assert",
                    "range": [
                        230,
                        230
                    ],
                    "children": [],
                    "content": ":"
                },
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        231,
                        236
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.user_id",
                            "range": [
                                231,
                                233
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "user",
                                    "range": [
                                        231,
                                        231
                                    ],
                                    "children": [],
                                    "content": "\"user\""
                                },
                                {
                                    "type": "Identifier",
                                    "name": "user_id",
                                    "range": [
                                        233,
                                        233
                                    ],
                                    "children": [],
                                    "content": "\n"
                                }
                            ],
                            "content": "\"user\"}\n"
                        },
                        {
                            "type": "Literal",
                            "name": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"",
                            "range": [
                                236,
                                236
                            ],
                            "children": [],
                            "content": "assert"
                        }
                    ],
                    "content": "\"user\"}\n)\nassert"
                }
            ],
            "content": ":\"user\"}\n)\nassert user"
        },
        {
            "type": "AssertStatement",
            "name": "",
            "range": [
                238,
                245
            ],
            "children": [
                {
                    "type": "Keyword",
                    "name": "assert",
                    "range": [
                        238,
                        238
                    ],
                    "children": [],
                    "content": "."
                },
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        239,
                        244
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.role",
                            "range": [
                                239,
                                241
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "user",
                                    "range": [
                                        239,
                                        239
                                    ],
                                    "children": [],
                                    "content": "user_id"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "role",
                                    "range": [
                                        241,
                                        241
                                    ],
                                    "children": [],
                                    "content": "="
                                }
                            ],
                            "content": "user_id=="
                        },
                        {
                            "type": "Literal",
                            "name": "\"user\"",
                            "range": [
                                244,
                                244
                            ],
                            "children": [],
                            "content": "assert"
                        }
                    ],
                    "content": "user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert"
                }
            ],
            "content": ".user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user"
        },
        {
            "type": "FunctionDecl",
            "name": "test_requires_user_no_user_id",
            "range": [
                247,
                271
            ],
            "children": [
                {
                    "type": "WithStatement",
                    "name": "",
                    "range": [
                        253,
                        271
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "pytest.raises",
                            "range": [
                                254,
                                260
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "Exception",
                                    "range": [
                                        258,
                                        259
                                    ],
                                    "children": [],
                                    "content": ":\n"
                                }
                            ],
                            "content": "def test_requires_user_no_user_id():\nwith"
                        },
                        {
                            "type": "CallExpression",
                            "name": "requires_user",
                            "range": [
                                262,
                                270
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        264,
                                        268
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "role",
                                            "range": [
                                                265,
                                                267
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "user",
                                                    "range": [
                                                        267,
                                                        267
                                                    ],
                                                    "children": [],
                                                    "content": ":"
                                                }
                                            ],
                                            "content": "Exception):"
                                        }
                                    ],
                                    "content": "(Exception):\n"
                                }
                            ],
                            "content": ".raises(Exception):\nrequires_user("
                        }
                    ],
                    "content": "\ndef test_requires_user_no_user_id():\nwith pytest.raises(Exception):\nrequires_user({"
                }
            ],
            "content": "role==\"user\"\n\n\ndef test_requires_user_no_user_id():\nwith pytest.raises(Exception):\nrequires_user({"
        },
        {
            "type": "FunctionDecl",
            "name": "test_requires_admin_user",
            "range": [
                272,
                294
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "test_requires_admin_user",
                    "range": [
                        272,
                        276
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                272,
                                272
                            ],
                            "children": [],
                            "content": "\"role\""
                        },
                        {
                            "type": "Identifier",
                            "name": "test_requires_admin_user",
                            "range": [
                                273,
                                273
                            ],
                            "children": [],
                            "content": ":"
                        }
                    ],
                    "content": "\"role\":\"user\"})"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        277,
                        294
                    ],
                    "children": [
                        {
                            "type": "AssignmentExpression",
                            "name": "user",
                            "range": [
                                278,
                                293
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "user",
                                    "range": [
                                        278,
                                        278
                                    ],
                                    "children": [],
                                    "content": "\n"
                                },
                                {
                                    "type": "CallExpression",
                                    "name": "requires_admin_user",
                                    "range": [
                                        280,
                                        293
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "requires_admin_user",
                                            "range": [
                                                280,
                                                280
                                            ],
                                            "children": [],
                                            "content": "def"
                                        },
                                        {
                                            "type": "ObjectExpression",
                                            "name": "",
                                            "range": [
                                                283,
                                                291
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "sub",
                                                    "range": [
                                                        284,
                                                        286
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"",
                                                            "range": [
                                                                286,
                                                                286
                                                            ],
                                                            "children": [],
                                                            "content": "user"
                                                        }
                                                    ],
                                                    "content": ":\nuser"
                                                },
                                                {
                                                    "type": "Property",
                                                    "name": "role",
                                                    "range": [
                                                        288,
                                                        290
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"admin\"",
                                                            "range": [
                                                                290,
                                                                290
                                                            ],
                                                            "children": [],
                                                            "content": "\n"
                                                        }
                                                    ],
                                                    "content": "requires_admin_user(\n"
                                                }
                                            ],
                                            "content": "):\nuser=requires_admin_user(\n{"
                                        }
                                    ],
                                    "content": "def test_requires_admin_user():\nuser=requires_admin_user(\n{\"sub\":"
                                }
                            ],
                            "content": "\n\ndef test_requires_admin_user():\nuser=requires_admin_user(\n{\"sub\":"
                        }
                    ],
                    "content": "\n\n\ndef test_requires_admin_user():\nuser=requires_admin_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                }
            ],
            "content": "\"role\":\"user\"})\n\n\ndef test_requires_admin_user():\nuser=requires_admin_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
        },
        {
            "type": "AssertStatement",
            "name": "",
            "range": [
                295,
                302
            ],
            "children": [
                {
                    "type": "Keyword",
                    "name": "assert",
                    "range": [
                        295,
                        295
                    ],
                    "children": [],
                    "content": ","
                },
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        296,
                        301
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.user_id",
                            "range": [
                                296,
                                298
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "user",
                                    "range": [
                                        296,
                                        296
                                    ],
                                    "children": [],
                                    "content": "\"role\""
                                },
                                {
                                    "type": "Identifier",
                                    "name": "user_id",
                                    "range": [
                                        298,
                                        298
                                    ],
                                    "children": [],
                                    "content": "\"admin\""
                                }
                            ],
                            "content": "\"role\":\"admin\""
                        },
                        {
                            "type": "Literal",
                            "name": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"",
                            "range": [
                                301,
                                301
                            ],
                            "children": [],
                            "content": ")"
                        }
                    ],
                    "content": "\"role\":\"admin\"}\n)"
                }
            ],
            "content": ",\"role\":\"admin\"}\n)\n"
        },
        {
            "type": "AssertStatement",
            "name": "",
            "range": [
                303,
                310
            ],
            "children": [
                {
                    "type": "Keyword",
                    "name": "assert",
                    "range": [
                        303,
                        303
                    ],
                    "children": [],
                    "content": "assert"
                },
                {
                    "type": "BinaryExpression",
                    "name": "==",
                    "range": [
                        304,
                        309
                    ],
                    "children": [
                        {
                            "type": "MemberExpression",
                            "name": "user.role",
                            "range": [
                                304,
                                306
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "user",
                                    "range": [
                                        304,
                                        304
                                    ],
                                    "children": [],
                                    "content": "user"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "role",
                                    "range": [
                                        306,
                                        306
                                    ],
                                    "children": [],
                                    "content": "user_id"
                                }
                            ],
                            "content": "user.user_id"
                        },
                        {
                            "type": "Literal",
                            "name": "\"admin\"",
                            "range": [
                                309,
                                309
                            ],
                            "children": [],
                            "content": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                        }
                    ],
                    "content": "user.user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
                }
            ],
            "content": "assert user.user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\n"
        },
        {
            "type": "FunctionDecl",
            "name": "test_requires_admin_user_not_admin",
            "range": [
                312,
                341
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "test_requires_admin_user_not_admin",
                    "range": [
                        312,
                        316
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                312,
                                315
                            ],
                            "content": "user.role="
                        },
                        {
                            "type": "Identifier",
                            "name": "test_requires_admin_user_not_admin",
                            "range": [
                                313,
                                315
                            ],
                            "content": ".role="
                        }
                    ],
                    "content": "user.role=="
                },
                {
                    "type": "Block",
                    "name": "FunctionBody",
                    "range": [
                        317,
                        341
                    ],
                    "children": [
                        {
                            "type": "WithStatement",
                            "name": "with",
                            "range": [
                                318,
                                325
                            ],
                            "children": [
                                {
                                    "type": "Keyword",
                                    "name": "with",
                                    "range": [
                                        318,
                                        322
                                    ],
                                    "content": "\n\n\ndef test_requires_admin_user_not_admin"
                                },
                                {
                                    "type": "CallExpression",
                                    "name": "pytest.raises",
                                    "range": [
                                        319,
                                        324
                                    ],
                                    "children": [
                                        {
                                            "type": "MemberExpression",
                                            "name": "pytest.raises",
                                            "range": [
                                                319,
                                                321
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "pytest",
                                                    "range": [
                                                        319,
                                                        320
                                                    ],
                                                    "content": "\n\n"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "raises",
                                                    "range": [
                                                        321,
                                                        322
                                                    ],
                                                    "content": "def test_requires_admin_user_not_admin"
                                                }
                                            ],
                                            "content": "\n\ndef"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "Exception",
                                            "range": [
                                                323,
                                                324
                                            ],
                                            "content": "()"
                                        }
                                    ],
                                    "content": "\n\ndef test_requires_admin_user_not_admin()"
                                }
                            ],
                            "content": "\n\n\ndef test_requires_admin_user_not_admin():"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "requires_admin_user",
                            "range": [
                                327,
                                340
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "requires_admin_user",
                                    "range": [
                                        327,
                                        340
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "requires_admin_user",
                                            "range": [
                                                327,
                                                328
                                            ],
                                            "content": "with pytest"
                                        },
                                        {
                                            "type": "ObjectExpression",
                                            "name": "Object",
                                            "range": [
                                                330,
                                                338
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "sub",
                                                    "range": [
                                                        331,
                                                        333
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"sub\"",
                                                            "range": [
                                                                331,
                                                                332
                                                            ],
                                                            "content": "(Exception"
                                                        },
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"",
                                                            "range": [
                                                                333,
                                                                334
                                                            ],
                                                            "content": "):"
                                                        }
                                                    ],
                                                    "content": "(Exception)"
                                                },
                                                {
                                                    "type": "Property",
                                                    "name": "role",
                                                    "range": [
                                                        335,
                                                        337
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"role\"",
                                                            "range": [
                                                                335,
                                                                336
                                                            ],
                                                            "content": "\nrequires_admin_user"
                                                        },
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"user\"",
                                                            "range": [
                                                                337,
                                                                338
                                                            ],
                                                            "content": "(\n"
                                                        }
                                                    ],
                                                    "content": "\nrequires_admin_user("
                                                }
                                            ],
                                            "content": "raises(Exception):\nrequires_admin_user(\n"
                                        }
                                    ],
                                    "content": "with pytest.raises(Exception):\nrequires_admin_user(\n{\"sub\""
                                }
                            ],
                            "content": "with pytest.raises(Exception):\nrequires_admin_user(\n{\"sub\""
                        }
                    ],
                    "content": "\"admin\"\n\n\ndef test_requires_admin_user_not_admin():\nwith pytest.raises(Exception):\nrequires_admin_user(\n{\"sub\":"
                }
            ],
            "content": "user.role==\"admin\"\n\n\ndef test_requires_admin_user_not_admin():\nwith pytest.raises(Exception):\nrequires_admin_user(\n{\"sub\":"
        }
    ],
    "content": "\ndef test_verify_user_no_payload():\nuser=verify_user(None,admin_only=False)\nassert user.user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user.role==\"admin\"\n\n\ndef test_verify_user_no_user_id():\nwith pytest.raises(Exception):\nverify_user({\"role\":\"admin\"},admin_only=False)\n\n\ndef test_verify_user_not_admin():\nwith pytest.raises(Exception):\nverify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only=True,\n)\n\n\ndef test_verify_user_with_admin_role():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"admin\"},\nadmin_only=True,\n)\nassert user.user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user.role==\"admin\"\n\n\ndef test_verify_user_with_user_role():\nuser=verify_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"},\nadmin_only=False,\n)\nassert user.user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user.role==\"user\"\n\n\ndef test_requires_user():\nuser=requires_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"user\"}\n)\nassert user.user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user.role==\"user\"\n\n\ndef test_requires_user_no_user_id():\nwith pytest.raises(Exception):\nrequires_user({\"role\":\"user\"})\n\n\ndef test_requires_admin_user():\nuser=requires_admin_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\",\"role\":\"admin\"}\n)\nassert user.user_id==\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\"\nassert user.role==\"admin\"\n\n\ndef test_requires_admin_user_not_admin():\nwith pytest.raises(Exception):\nrequires_admin_user(\n{\"sub\":\"3e53486c-cf57-477e-ba2a-cb02dc828e1a\""
}
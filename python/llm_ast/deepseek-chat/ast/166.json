{
    "type": "Program",
    "name": "Global",
    "range": [
        0,
        3203
    ],
    "children": [
        {
            "type": "ClassDecl",
            "name": "Attachment",
            "range": [
                63,
                86
            ],
            "children": [
                {
                    "type": "Inheritance",
                    "name": "BaseModel",
                    "range": [
                        65,
                        67
                    ],
                    "children": [],
                    "content": "_auth import("
                },
                {
                    "type": "ClassBody",
                    "name": "",
                    "range": [
                        68,
                        86
                    ],
                    "children": [
                        {
                            "type": "FieldDecl",
                            "name": "filename",
                            "range": [
                                70,
                                73
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        72,
                                        73
                                    ],
                                    "children": [],
                                    "content": "TEST_CREDENTIALS,"
                                }
                            ],
                            "content": ",\nTEST_CREDENTIALS,"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "content_type",
                            "range": [
                                74,
                                77
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        76,
                                        77
                                    ],
                                    "children": [],
                                    "content": ",\n"
                                }
                            ],
                            "content": "\nTEST_CREDENTIALS_INPUT,\n"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "size",
                            "range": [
                                78,
                                81
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "int",
                                    "range": [
                                        80,
                                        81
                                    ],
                                    "children": [],
                                    "content": "\nGoogleCredentialsField"
                                }
                            ],
                            "content": "GoogleCredentials,\nGoogleCredentialsField"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "attachment_id",
                            "range": [
                                82,
                                85
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        84,
                                        85
                                    ],
                                    "children": [],
                                    "content": "GoogleCredentialsInput,"
                                }
                            ],
                            "content": ",\nGoogleCredentialsInput,"
                        }
                    ],
                    "content": "\nGOOGLE_OAUTH_IS_CONFIGURED,\nTEST_CREDENTIALS,\nTEST_CREDENTIALS_INPUT,\nGoogleCredentials,\nGoogleCredentialsField,\nGoogleCredentialsInput,\n"
                }
            ],
            "content": "from._auth import(\nGOOGLE_OAUTH_IS_CONFIGURED,\nTEST_CREDENTIALS,\nTEST_CREDENTIALS_INPUT,\nGoogleCredentials,\nGoogleCredentialsField,\nGoogleCredentialsInput,\n"
        },
        {
            "type": "ClassDecl",
            "name": "Email",
            "range": [
                87,
                141
            ],
            "children": [
                {
                    "type": "Property",
                    "name": "id",
                    "range": [
                        94,
                        96
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                96,
                                96
                            ],
                            "content": ":"
                        }
                    ],
                    "content": "BaseModel):"
                },
                {
                    "type": "Property",
                    "name": "subject",
                    "range": [
                        98,
                        100
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                100,
                                100
                            ],
                            "content": "str"
                        }
                    ],
                    "content": "filename:str"
                },
                {
                    "type": "Property",
                    "name": "snippet",
                    "range": [
                        102,
                        104
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                104,
                                104
                            ],
                            "content": "str"
                        }
                    ],
                    "content": "content_type:str"
                },
                {
                    "type": "Property",
                    "name": "from_",
                    "range": [
                        106,
                        108
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                108,
                                108
                            ],
                            "content": "int"
                        }
                    ],
                    "content": "size:int"
                },
                {
                    "type": "Property",
                    "name": "to",
                    "range": [
                        110,
                        112
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                112,
                                112
                            ],
                            "content": "str"
                        }
                    ],
                    "content": "attachment_id:str"
                },
                {
                    "type": "Property",
                    "name": "date",
                    "range": [
                        114,
                        116
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                116,
                                116
                            ],
                            "content": "class"
                        }
                    ],
                    "content": "\n\nclass"
                },
                {
                    "type": "Property",
                    "name": "body",
                    "range": [
                        118,
                        122
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                120,
                                120
                            ],
                            "content": ")"
                        },
                        {
                            "type": "DefaultValue",
                            "name": "\"\"",
                            "range": [
                                122,
                                122
                            ],
                            "content": "\n"
                        }
                    ],
                    "content": "(BaseModel):\n"
                },
                {
                    "type": "Property",
                    "name": "sizeEstimate",
                    "range": [
                        130,
                        132
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "int",
                            "range": [
                                132,
                                132
                            ],
                            "content": ":"
                        }
                    ],
                    "content": "\nsnippet:"
                },
                {
                    "type": "Property",
                    "name": "attachments",
                    "range": [
                        134,
                        139
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "List",
                            "range": [
                                136,
                                136
                            ],
                            "children": [
                                {
                                    "type": "GenericType",
                                    "name": "Attachment",
                                    "range": [
                                        138,
                                        138
                                    ],
                                    "content": "\n"
                                }
                            ],
                            "content": ":"
                        }
                    ],
                    "content": "\nfrom_:str\nto"
                }
            ],
            "content": ")\n\n\nclass Attachment(BaseModel):\nfilename:str\ncontent_type:str\nsize:int\nattachment_id:str\n\n\nclass Email(BaseModel):\nid:str\nsubject:str\nsnippet:str\nfrom_:str\nto:str"
        },
        {
            "type": "ClassDecl",
            "name": "GmailSendBlock",
            "range": [
                1353,
                1422
            ],
            "children": [
                {
                    "type": "ClassDecl",
                    "name": "Input",
                    "range": [
                        1360,
                        1422
                    ],
                    "children": [
                        {
                            "type": "FieldDecl",
                            "name": "credentials",
                            "range": [
                                1367,
                                1378
                            ],
                            "children": [],
                            "content": "(attachment[\"data\"].encode(\"UTF-8\"))\n"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "to",
                            "range": [
                                1380,
                                1392
                            ],
                            "children": [],
                            "content": "file_data\n\n\nclass GmailSendBlock(Block):\nclass Input"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "subject",
                            "range": [
                                1394,
                                1406
                            ],
                            "children": [],
                            "content": "BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.send\""
                        },
                        {
                            "type": "FieldDecl",
                            "name": "body",
                            "range": [
                                1408,
                                1420
                            ],
                            "children": [],
                            "content": "\n)\nto:str=SchemaField(\ndescription=\"Recipient email address\""
                        }
                    ],
                    "content": ")\nfile_data=base64.urlsafe_b64decode(attachment[\"data\"].encode(\"UTF-8\"))\nreturn file_data\n\n\nclass GmailSendBlock(Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.send\"]\n)\nto:str=SchemaField(\ndescription=\"Recipient email address\",\n"
                }
            ],
            "content": ")\n.execute()\n)\nfile_data=base64.urlsafe_b64decode(attachment[\"data\"].encode(\"UTF-8\"))\nreturn file_data\n\n\nclass GmailSendBlock(Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.send\"]\n)\nto:str=SchemaField(\ndescription=\"Recipient email address\",\n"
        },
        {
            "type": "ClassDecl",
            "name": "Output",
            "range": [
                1423,
                1458
            ],
            "children": [
                {
                    "type": "FieldDecl",
                    "name": "result",
                    "range": [
                        1430,
                        1442
                    ],
                    "children": [],
                    "content": "(\ndescription=\"Email subject\",\n)\nbody:str="
                },
                {
                    "type": "FieldDecl",
                    "name": "error",
                    "range": [
                        1444,
                        1456
                    ],
                    "children": [],
                    "content": "(\ndescription=\"Email body\",\n)\n\nclass Output("
                }
            ],
            "content": ")\nsubject:str=SchemaField(\ndescription=\"Email subject\",\n)\nbody:str=SchemaField(\ndescription=\"Email body\",\n)\n\nclass Output(BlockSchema)"
        },
        {
            "type": "FunctionDecl",
            "name": "__init__",
            "range": [
                1459,
                1595
            ],
            "children": [
                {
                    "type": "ExpressionStatement",
                    "name": "super().__init__",
                    "range": [
                        1466,
                        1594
                    ],
                    "children": [],
                    "content": "(\ndescription=\"Send confirmation\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"6c27abc2-e51d-499e-a85f-5a0041ba94f0\",\ndescription=\"This block sends an email using Gmail.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailSendBlock.Input,\noutput_schema=GmailSendBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"to\":\"recipient@example.com\",\n\"subject\":\"Test Email\",\n\"body\":\"This is a test email sent from GmailSendBlock.\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\"result\",{\"id\":\"1\",\"status\":\"sent\"}),\n]"
                }
            ],
            "content": ":\nresult:dict=SchemaField(\ndescription=\"Send confirmation\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"6c27abc2-e51d-499e-a85f-5a0041ba94f0\",\ndescription=\"This block sends an email using Gmail.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailSendBlock.Input,\noutput_schema=GmailSendBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"to\":\"recipient@example.com\",\n\"subject\":\"Test Email\",\n\"body\":\"This is a test email sent from GmailSendBlock.\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\"result\",{\"id\":\"1\",\"status\":\"sent\"}),\n],"
        },
        {
            "type": "FunctionDecl",
            "name": "run",
            "range": [
                1597,
                1664
            ],
            "children": [
                {
                    "type": "VariableDecl",
                    "name": "service",
                    "range": [
                        1623,
                        1634
                    ],
                    "children": [],
                    "content": ",\n)\n\ndef run(\nself,input_data"
                },
                {
                    "type": "VariableDecl",
                    "name": "send_result",
                    "range": [
                        1636,
                        1657
                    ],
                    "children": [],
                    "content": "Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock."
                },
                {
                    "type": "YieldStatement",
                    "name": "yield",
                    "range": [
                        1659,
                        1662
                    ],
                    "children": [],
                    "content": "(credentials,*"
                }
            ],
            "content": "test_mock={\n\"_send_email\":lambda*args,**kwargs:{\"id\":\"1\",\"status\":\"sent\"},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock._build_service(credentials,**kwargs"
        },
        {
            "type": "FunctionDecl",
            "name": "_send_email",
            "range": [
                1665,
                1763
            ],
            "children": [
                {
                    "type": "IfStatement",
                    "name": "if",
                    "range": [
                        1689,
                        1704
                    ],
                    "children": [],
                    "content": "\nyield \"result\",send_result\n\ndef _send_email(self,service,to:"
                },
                {
                    "type": "VariableDecl",
                    "name": "message",
                    "range": [
                        1706,
                        1717
                    ],
                    "children": [],
                    "content": ",subject:str,body:str)->dict"
                },
                {
                    "type": "VariableDecl",
                    "name": "sent_message",
                    "range": [
                        1719,
                        1747
                    ],
                    "children": [],
                    "content": "\nif not to or not subject or not body:\nraise ValueError(\"To, subject, and body are required for sending an email\")\nmessage=self._create_message(to,subject,body"
                },
                {
                    "type": "ReturnStatement",
                    "name": "return",
                    "range": [
                        1750,
                        1762
                    ],
                    "children": [],
                    "content": "sent_message=(\nservice.users().messages()"
                }
            ],
            "content": ")\nsend_result=self._send_email(\nservice,input_data.to,input_data.subject,input_data.body\n)\nyield \"result\",send_result\n\ndef _send_email(self,service,to:str,subject:str,body:str)->dict:\nif not to or not subject or not body:\nraise ValueError(\"To, subject, and body are required for sending an email\")\nmessage=self._create_message(to,subject,body)\nsent_message=(\nservice.users().messages()."
        },
        {
            "type": "FunctionDecl",
            "name": "_create_message",
            "range": [
                1765,
                1845
            ],
            "children": [
                {
                    "type": "ImportStatement",
                    "name": "import",
                    "range": [
                        1787,
                        1788
                    ],
                    "children": [],
                    "content": "\"id\"]"
                },
                {
                    "type": "FromImportStatement",
                    "name": "from",
                    "range": [
                        1790,
                        1797
                    ],
                    "children": [],
                    "content": "\"status\":\"sent\"}\n\ndef _create_message"
                },
                {
                    "type": "VariableDecl",
                    "name": "message",
                    "range": [
                        1800,
                        1805
                    ],
                    "children": [],
                    "content": ",to:str,subject"
                },
                {
                    "type": "AssignmentExpression",
                    "name": "message[\"to\"]",
                    "range": [
                        1807,
                        1812
                    ],
                    "children": [],
                    "content": "str,body:str)"
                },
                {
                    "type": "AssignmentExpression",
                    "name": "message[\"subject\"]",
                    "range": [
                        1814,
                        1819
                    ],
                    "children": [],
                    "content": ">dict:\nimport base64"
                },
                {
                    "type": "VariableDecl",
                    "name": "raw_message",
                    "range": [
                        1821,
                        1837
                    ],
                    "children": [],
                    "content": "from email.mime.text import MIMEText\n\nmessage=MIMEText(body)\n"
                },
                {
                    "type": "ReturnStatement",
                    "name": "return",
                    "range": [
                        1839,
                        1844
                    ],
                    "children": [],
                    "content": "[\"to\"]=to\n"
                }
            ],
            "content": "(userId=\"me\",body=message).execute()\n)\nreturn{\"id\":sent_message[\"id\"],\"status\":\"sent\"}\n\ndef _create_message(self,to:str,subject:str,body:str)->dict:\nimport base64\nfrom email.mime.text import MIMEText\n\nmessage=MIMEText(body)\nmessage[\"to\"]=to\nmessage"
        },
        {
            "type": "ClassDecl",
            "name": "GmailListLabelsBlock",
            "range": [
                1847,
                1853
            ],
            "children": [
                {
                    "type": "Inheritance",
                    "name": "Block",
                    "range": [
                        1849,
                        1851
                    ],
                    "children": [],
                    "content": "=subject\n"
                }
            ],
            "content": "\"subject\"]=subject\nraw_message="
        },
        {
            "type": "ClassDecl",
            "name": "Input",
            "range": [
                1854,
                1860
            ],
            "children": [
                {
                    "type": "Inheritance",
                    "name": "BlockSchema",
                    "range": [
                        1856,
                        1858
                    ],
                    "children": [],
                    "content": "urlsafe_b64encode(message"
                }
            ],
            "content": "base64.urlsafe_b64encode(message.as_bytes"
        },
        {
            "type": "VariableDecl",
            "name": "credentials",
            "range": [
                1861,
                1873
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "GoogleCredentialsInput",
                    "range": [
                        1863,
                        1863
                    ],
                    "children": [],
                    "content": ")"
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        1864,
                        1864
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "GoogleCredentialsField",
                            "range": [
                                1865,
                                1872
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "[\"https://www.googleapis.com/auth/gmail.labels\"]",
                                    "range": [
                                        1868,
                                        1870
                                    ],
                                    "children": [],
                                    "content": ")\nreturn"
                                }
                            ],
                            "content": "decode(\"utf-8\")\nreturn{\"raw\""
                        }
                    ],
                    "content": "."
                }
            ],
            "content": "()).decode(\"utf-8\")\nreturn{\"raw\":"
        },
        {
            "type": "ClassDecl",
            "name": "Output",
            "range": [
                1875,
                1881
            ],
            "children": [
                {
                    "type": "Inheritance",
                    "name": "BlockSchema",
                    "range": [
                        1877,
                        1879
                    ],
                    "children": [],
                    "content": "\n\nclass"
                }
            ],
            "content": "}\n\n\nclass GmailListLabelsBlock("
        },
        {
            "type": "VariableDecl",
            "name": "result",
            "range": [
                1882,
                1898
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "list[dict]",
                    "range": [
                        1884,
                        1887
                    ],
                    "children": [],
                    "content": ":\nclass Input"
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        1888,
                        1888
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "SchemaField",
                            "range": [
                                1889,
                                1897
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "description=\"List of labels\"",
                                    "range": [
                                        1892,
                                        1894
                                    ],
                                    "children": [],
                                    "content": "\ncredentials:"
                                }
                            ],
                            "content": "BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField"
                        }
                    ],
                    "content": "("
                }
            ],
            "content": "Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField("
        },
        {
            "type": "VariableDecl",
            "name": "error",
            "range": [
                1899,
                1912
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "str",
                    "range": [
                        1901,
                        1901
                    ],
                    "children": [],
                    "content": "\"https://www.googleapis.com/auth/gmail.labels\""
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        1902,
                        1902
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "SchemaField",
                            "range": [
                                1903,
                                1911
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "description=\"Error message if any\"",
                                    "range": [
                                        1906,
                                        1908
                                    ],
                                    "children": [],
                                    "content": "\nclass Output"
                                }
                            ],
                            "content": "\n)\n\nclass Output(BlockSchema)"
                        }
                    ],
                    "content": "]"
                }
            ],
            "content": "\n[\"https://www.googleapis.com/auth/gmail.labels\"]\n)\n\nclass Output(BlockSchema):"
        },
        {
            "type": "FunctionDecl",
            "name": "__init__",
            "range": [
                1914,
                2071
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        1917,
                        1917
                    ],
                    "children": [],
                    "content": "["
                },
                {
                    "type": "CallExpression",
                    "name": "super",
                    "range": [
                        1921,
                        1923
                    ],
                    "children": [],
                    "content": "SchemaField(\n"
                },
                {
                    "type": "CallExpression",
                    "name": "__init__",
                    "range": [
                        1925,
                        2070
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "id=\"3e1c2c1c-c689-4520-b956-1f3bf4e02bb7\"",
                            "range": [
                                1928,
                                1930
                            ],
                            "children": [],
                            "content": "\n)\n"
                        },
                        {
                            "type": "Argument",
                            "name": "description=\"This block lists all labels in Gmail.\"",
                            "range": [
                                1933,
                                1935
                            ],
                            "children": [],
                            "content": "str=SchemaField"
                        },
                        {
                            "type": "Argument",
                            "name": "categories={BlockCategory.COMMUNICATION}",
                            "range": [
                                1938,
                                1944
                            ],
                            "children": [],
                            "content": "description=\"Error message if any\",\n)\n"
                        },
                        {
                            "type": "Argument",
                            "name": "input_schema=GmailListLabelsBlock.Input",
                            "range": [
                                1947,
                                1951
                            ],
                            "children": [],
                            "content": "__init__(self):"
                        },
                        {
                            "type": "Argument",
                            "name": "output_schema=GmailListLabelsBlock.Output",
                            "range": [
                                1954,
                                1958
                            ],
                            "children": [],
                            "content": "().__init__("
                        },
                        {
                            "type": "Argument",
                            "name": "disabled=not GOOGLE_OAUTH_IS_CONFIGURED",
                            "range": [
                                1961,
                                1964
                            ],
                            "children": [],
                            "content": "=\"3e1c2c1c-c689-4520-b956-1f3bf4e02bb7\",\n"
                        },
                        {
                            "type": "Argument",
                            "name": "test_input={\"credentials\": TEST_CREDENTIALS_INPUT}",
                            "range": [
                                1967,
                                1976
                            ],
                            "children": [],
                            "content": "\"This block lists all labels in Gmail.\",\ncategories={BlockCategory.COMMUNICATION}"
                        },
                        {
                            "type": "Argument",
                            "name": "test_credentials=TEST_CREDENTIALS",
                            "range": [
                                1979,
                                1981
                            ],
                            "children": [],
                            "content": "input_schema=GmailListLabelsBlock"
                        },
                        {
                            "type": "Argument",
                            "name": "test_output=[(\"result\", [{\"id\": \"Label_1\", \"name\": \"Important\"}, {\"id\": \"Label_2\", \"name\": \"Work\"}])]",
                            "range": [
                                1984,
                                2023
                            ],
                            "children": [],
                            "content": ",\noutput_schema=GmailListLabelsBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\","
                        },
                        {
                            "type": "Argument",
                            "name": "test_mock={\"_list_labels\": lambda *args, **kwargs: [{\"id\": \"Label_1\", \"name\": \"Important\"}, {\"id\": \"Label_2\", \"name\": \"Work\"}]}",
                            "range": [
                                2026,
                                2067
                            ],
                            "children": [],
                            "content": "\n{\"id\":\"Label_1\",\"name\":\"Important\"},\n{\"id\":\"Label_2\",\"name\":\"Work\"},\n],\n),\n],\ntest_mock={\n\"_list_labels\":lambda*args,"
                        }
                    ],
                    "content": "=\"List of labels\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"3e1c2c1c-c689-4520-b956-1f3bf4e02bb7\",\ndescription=\"This block lists all labels in Gmail.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailListLabelsBlock.Input,\noutput_schema=GmailListLabelsBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n[\n{\"id\":\"Label_1\",\"name\":\"Important\"},\n{\"id\":\"Label_2\",\"name\":\"Work\"},\n],\n),\n],\ntest_mock={\n\"_list_labels\":lambda*args,**kwargs"
                }
            ],
            "content": "result:list[dict]=SchemaField(\ndescription=\"List of labels\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"3e1c2c1c-c689-4520-b956-1f3bf4e02bb7\",\ndescription=\"This block lists all labels in Gmail.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailListLabelsBlock.Input,\noutput_schema=GmailListLabelsBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n[\n{\"id\":\"Label_1\",\"name\":\"Important\"},\n{\"id\":\"Label_2\",\"name\":\"Work\"},\n],\n),\n],\ntest_mock={\n\"_list_labels\":lambda*args,**kwargs:"
        },
        {
            "type": "FunctionDecl",
            "name": "run",
            "range": [
                2073,
                2126
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        2077,
                        2077
                    ],
                    "children": [],
                    "content": "\"Label_1\""
                },
                {
                    "type": "Parameter",
                    "name": "input_data",
                    "range": [
                        2079,
                        2081
                    ],
                    "children": [],
                    "content": "\"name\":\"Important\""
                },
                {
                    "type": "Parameter",
                    "name": "credentials",
                    "range": [
                        2085,
                        2087
                    ],
                    "children": [],
                    "content": "{\"id\":"
                },
                {
                    "type": "Parameter",
                    "name": "kwargs",
                    "range": [
                        2091,
                        2091
                    ],
                    "children": [],
                    "content": ":"
                },
                {
                    "type": "ReturnType",
                    "name": "BlockOutput",
                    "range": [
                        2096,
                        2096
                    ],
                    "children": [],
                    "content": "]"
                },
                {
                    "type": "VariableDecl",
                    "name": "service",
                    "range": [
                        2099,
                        2111
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2100,
                                2100
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "GmailReadBlock._build_service",
                                    "range": [
                                        2101,
                                        2110
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "credentials",
                                            "range": [
                                                2105,
                                                2105
                                            ],
                                            "children": [],
                                            "content": "def"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "kwargs",
                                            "range": [
                                                2109,
                                                2109
                                            ],
                                            "children": [],
                                            "content": "self"
                                        }
                                    ],
                                    "content": "\n)\n\ndef run(\nself,"
                                }
                            ],
                            "content": ","
                        }
                    ],
                    "content": "},\n)\n\ndef run(\nself,input_data"
                },
                {
                    "type": "VariableDecl",
                    "name": "labels",
                    "range": [
                        2112,
                        2120
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2113,
                                2113
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "self._list_labels",
                                    "range": [
                                        2114,
                                        2119
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "service",
                                            "range": [
                                                2118,
                                                2118
                                            ],
                                            "children": [],
                                            "content": ":"
                                        }
                                    ],
                                    "content": ",*,credentials:GoogleCredentials"
                                }
                            ],
                            "content": "Input"
                        }
                    ],
                    "content": ":Input,*,credentials:GoogleCredentials,"
                },
                {
                    "type": "Yield",
                    "name": "yield",
                    "range": [
                        2121,
                        2125
                    ],
                    "children": [
                        {
                            "type": "Argument",
                            "name": "\"result\"",
                            "range": [
                                2122,
                                2122
                            ],
                            "children": [],
                            "content": "*"
                        },
                        {
                            "type": "Argument",
                            "name": "labels",
                            "range": [
                                2124,
                                2124
                            ],
                            "children": [],
                            "content": "\n"
                        }
                    ],
                    "content": "**kwargs\n)"
                }
            ],
            "content": "\n{\"id\":\"Label_1\",\"name\":\"Important\"},\n{\"id\":\"Label_2\",\"name\":\"Work\"},\n],\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)-"
        },
        {
            "type": "FunctionDecl",
            "name": "_list_labels",
            "range": [
                2127,
                2199
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        2130,
                        2130
                    ],
                    "children": [],
                    "content": "\n"
                },
                {
                    "type": "Parameter",
                    "name": "service",
                    "range": [
                        2132,
                        2132
                    ],
                    "children": [],
                    "content": "="
                },
                {
                    "type": "ReturnType",
                    "name": "list[dict]",
                    "range": [
                        2136,
                        2139
                    ],
                    "children": [],
                    "content": "(credentials,*"
                },
                {
                    "type": "VariableDecl",
                    "name": "results",
                    "range": [
                        2142,
                        2164
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2143,
                                2143
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "service.users().labels().list",
                                    "range": [
                                        2144,
                                        2163
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "userId=\"me\"",
                                            "range": [
                                                2156,
                                                2158
                                            ],
                                            "children": [],
                                            "content": "labels\n\n"
                                        }
                                    ],
                                    "content": "labels=self._list_labels(service)\nyield \"result\",labels\n\ndef _list_labels(self,"
                                }
                            ],
                            "content": "\n"
                        }
                    ],
                    "content": ")\nlabels=self._list_labels(service)\nyield \"result\",labels\n\ndef _list_labels(self,service"
                },
                {
                    "type": "VariableDecl",
                    "name": "labels",
                    "range": [
                        2165,
                        2176
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2166,
                                2166
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "results.get",
                                    "range": [
                                        2167,
                                        2175
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "\"labels\"",
                                            "range": [
                                                2171,
                                                2171
                                            ],
                                            "children": [],
                                            "content": "]"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "[]",
                                            "range": [
                                                2173,
                                                2174
                                            ],
                                            "children": [],
                                            "content": "\nresults"
                                        }
                                    ],
                                    "content": ">list[dict]:\nresults="
                                }
                            ],
                            "content": "-"
                        }
                    ],
                    "content": ")->list[dict]:\nresults=service"
                },
                {
                    "type": "Return",
                    "name": "return",
                    "range": [
                        2177,
                        2199
                    ],
                    "children": [
                        {
                            "type": "ListComprehension",
                            "name": "[{\"id\": label[\"id\"], \"name\": label[\"name\"]} for label in labels]",
                            "range": [
                                2178,
                                2198
                            ],
                            "children": [],
                            "content": "users().labels().list(userId=\"me\").execute()\nlabels="
                        }
                    ],
                    "content": ".users().labels().list(userId=\"me\").execute()\nlabels=results"
                }
            ],
            "content": ">BlockOutput:\nservice=GmailReadBlock._build_service(credentials,**kwargs)\nlabels=self._list_labels(service)\nyield \"result\",labels\n\ndef _list_labels(self,service)->list[dict]:\nresults=service.users().labels().list(userId=\"me\").execute()\nlabels=results"
        },
        {
            "type": "ClassDecl",
            "name": "GmailAddLabelBlock",
            "range": [
                2201,
                2207
            ],
            "children": [
                {
                    "type": "Inheritance",
                    "name": "Block",
                    "range": [
                        2203,
                        2205
                    ],
                    "children": [],
                    "content": "\"labels\",["
                }
            ],
            "content": "get(\"labels\",[])"
        },
        {
            "type": "ClassDecl",
            "name": "Input",
            "range": [
                2208,
                2214
            ],
            "children": [
                {
                    "type": "Inheritance",
                    "name": "BlockSchema",
                    "range": [
                        2210,
                        2212
                    ],
                    "children": [],
                    "content": "[{\"id\""
                }
            ],
            "content": "\nreturn[{\"id\":label"
        },
        {
            "type": "VariableDecl",
            "name": "credentials",
            "range": [
                2215,
                2227
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "GoogleCredentialsInput",
                    "range": [
                        2217,
                        2217
                    ],
                    "children": [],
                    "content": "]"
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        2218,
                        2218
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "GoogleCredentialsField",
                            "range": [
                                2219,
                                2226
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "[\"https://www.googleapis.com/auth/gmail.modify\"]",
                                    "range": [
                                        2222,
                                        2224
                                    ],
                                    "children": [],
                                    "content": "[\"name\"]"
                                }
                            ],
                            "content": "\"name\":label[\"name\"]}for"
                        }
                    ],
                    "content": ","
                }
            ],
            "content": "[\"id\"],\"name\":label[\"name\"]}for label"
        },
        {
            "type": "VariableDecl",
            "name": "message_id",
            "range": [
                2228,
                2241
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "str",
                    "range": [
                        2230,
                        2230
                    ],
                    "children": [],
                    "content": "]"
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        2231,
                        2231
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "SchemaField",
                            "range": [
                                2232,
                                2240
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "description=\"Message ID to add label to\"",
                                    "range": [
                                        2235,
                                        2237
                                    ],
                                    "children": [],
                                    "content": "GmailAddLabelBlock(Block"
                                }
                            ],
                            "content": "\n\nclass GmailAddLabelBlock(Block):\n"
                        }
                    ],
                    "content": "\n"
                }
            ],
            "content": "in labels]\n\n\nclass GmailAddLabelBlock(Block):\nclass"
        },
        {
            "type": "VariableDecl",
            "name": "label_name",
            "range": [
                2242,
                2255
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "str",
                    "range": [
                        2244,
                        2244
                    ],
                    "children": [],
                    "content": "BlockSchema"
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        2245,
                        2245
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "SchemaField",
                            "range": [
                                2246,
                                2254
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "description=\"Label name to add\"",
                                    "range": [
                                        2249,
                                        2251
                                    ],
                                    "children": [],
                                    "content": ":GoogleCredentialsInput="
                                }
                            ],
                            "content": ":\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n"
                        }
                    ],
                    "content": ")"
                }
            ],
            "content": "Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n["
        },
        {
            "type": "ClassDecl",
            "name": "Output",
            "range": [
                2257,
                2263
            ],
            "children": [
                {
                    "type": "Inheritance",
                    "name": "BlockSchema",
                    "range": [
                        2259,
                        2261
                    ],
                    "children": [],
                    "content": ")\nmessage_id"
                }
            ],
            "content": "]\n)\nmessage_id:str"
        },
        {
            "type": "VariableDecl",
            "name": "result",
            "range": [
                2264,
                2277
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "dict",
                    "range": [
                        2266,
                        2266
                    ],
                    "children": [],
                    "content": "("
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        2267,
                        2267
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "SchemaField",
                            "range": [
                                2268,
                                2276
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "description=\"Label addition result\"",
                                    "range": [
                                        2271,
                                        2273
                                    ],
                                    "children": [],
                                    "content": ",\n)"
                                }
                            ],
                            "content": "description=\"Message ID to add label to\",\n)\nlabel_name:"
                        }
                    ],
                    "content": "\n"
                }
            ],
            "content": "=SchemaField(\ndescription=\"Message ID to add label to\",\n)\nlabel_name:str"
        },
        {
            "type": "VariableDecl",
            "name": "error",
            "range": [
                2278,
                2291
            ],
            "children": [
                {
                    "type": "TypeAnnotation",
                    "name": "str",
                    "range": [
                        2280,
                        2280
                    ],
                    "children": [],
                    "content": "("
                },
                {
                    "type": "Assignment",
                    "name": "=",
                    "range": [
                        2281,
                        2281
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "SchemaField",
                            "range": [
                                2282,
                                2290
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "description=\"Error message if any\"",
                                    "range": [
                                        2285,
                                        2287
                                    ],
                                    "children": [],
                                    "content": ",\n)"
                                }
                            ],
                            "content": "description=\"Label name to add\",\n)\n\nclass"
                        }
                    ],
                    "content": "\n"
                }
            ],
            "content": "=SchemaField(\ndescription=\"Label name to add\",\n)\n\nclass Output"
        },
        {
            "type": "FunctionDecl",
            "name": "__init__",
            "range": [
                2293,
                2432
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        2296,
                        2296
                    ],
                    "children": [],
                    "content": "\n"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        2299,
                        2432
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "super",
                            "range": [
                                2300,
                                2306
                            ],
                            "children": [],
                            "content": "=SchemaField(\ndescription=\"Label addition result\""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2308,
                                2308
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"f884b2fb-04f4-4265-9658-14f433926ac9\"",
                                    "range": [
                                        2309,
                                        2309
                                    ],
                                    "children": [],
                                    "content": ")"
                                }
                            ],
                            "content": "\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2313,
                                2313
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"This block adds a label to a Gmail message.\"",
                                    "range": [
                                        2314,
                                        2314
                                    ],
                                    "children": [],
                                    "content": "="
                                }
                            ],
                            "content": "str"
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2318,
                                2318
                            ],
                            "children": [
                                {
                                    "type": "ObjectLiteral",
                                    "name": "{BlockCategory.COMMUNICATION}",
                                    "range": [
                                        2319,
                                        2323
                                    ],
                                    "children": [],
                                    "content": "=\"Error message if any\",\n)"
                                }
                            ],
                            "content": "description"
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2327,
                                2327
                            ],
                            "children": [
                                {
                                    "type": "MemberExpression",
                                    "name": "GmailAddLabelBlock.Input",
                                    "range": [
                                        2328,
                                        2331
                                    ],
                                    "children": [],
                                    "content": "(self):"
                                }
                            ],
                            "content": "__init__"
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2334,
                                2334
                            ],
                            "children": [
                                {
                                    "type": "MemberExpression",
                                    "name": "GmailAddLabelBlock.Output",
                                    "range": [
                                        2335,
                                        2338
                                    ],
                                    "children": [],
                                    "content": ").__init__("
                                }
                            ],
                            "content": "("
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2341,
                                2341
                            ],
                            "children": [
                                {
                                    "type": "UnaryExpression",
                                    "name": "not",
                                    "range": [
                                        2342,
                                        2342
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "GOOGLE_OAUTH_IS_CONFIGURED",
                                            "range": [
                                                2343,
                                                2343
                                            ],
                                            "children": [],
                                            "content": ","
                                        }
                                    ],
                                    "content": "\"f884b2fb-04f4-4265-9658-14f433926ac9\""
                                }
                            ],
                            "content": "="
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2347,
                                2347
                            ],
                            "children": [
                                {
                                    "type": "ObjectLiteral",
                                    "name": "{\"message_id\": \"12345\", \"label_name\": \"Important\", \"credentials\": TEST_CREDENTIALS_INPUT}",
                                    "range": [
                                        2348,
                                        2365
                                    ],
                                    "children": [],
                                    "content": ",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailAddLabelBlock.Input,\n"
                                }
                            ],
                            "content": "\"This block adds a label to a Gmail message.\""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2369,
                                2369
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "TEST_CREDENTIALS",
                                    "range": [
                                        2370,
                                        2370
                                    ],
                                    "children": [],
                                    "content": "Output"
                                }
                            ],
                            "content": "."
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2374,
                                2374
                            ],
                            "children": [
                                {
                                    "type": "ArrayLiteral",
                                    "name": "[(\"result\", {\"status\": \"Label added successfully\", \"label_id\": \"Label_1\"})]",
                                    "range": [
                                        2375,
                                        2396
                                    ],
                                    "children": [],
                                    "content": "not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":\"Important\",\n\"credentials\":TEST_CREDENTIALS_INPUT,"
                                }
                            ],
                            "content": "="
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                2400,
                                2400
                            ],
                            "children": [
                                {
                                    "type": "ObjectLiteral",
                                    "name": "{\"_add_label\": lambda *args, **kwargs: {\"status\": \"Label added successfully\", \"label_id\": \"Label_1\"}}",
                                    "range": [
                                        2401,
                                        2428
                                    ],
                                    "children": [],
                                    "content": "test_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label added successfully\",\"label_id\":\"Label_1\"},\n),\n"
                                }
                            ],
                            "content": "\n"
                        }
                    ],
                    "content": "dict=SchemaField(\ndescription=\"Label addition result\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"f884b2fb-04f4-4265-9658-14f433926ac9\",\ndescription=\"This block adds a label to a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailAddLabelBlock.Input,\noutput_schema=GmailAddLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":\"Important\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label added successfully\",\"label_id\":\"Label_1\"},\n),\n],\ntest_mock"
                }
            ],
            "content": "BlockSchema):\nresult:dict=SchemaField(\ndescription=\"Label addition result\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"f884b2fb-04f4-4265-9658-14f433926ac9\",\ndescription=\"This block adds a label to a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailAddLabelBlock.Input,\noutput_schema=GmailAddLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":\"Important\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label added successfully\",\"label_id\":\"Label_1\"},\n),\n],\ntest_mock"
        },
        {
            "type": "FunctionDecl",
            "name": "run",
            "range": [
                2434,
                2495
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        2438,
                        2438
                    ],
                    "children": [],
                    "content": "lambda"
                },
                {
                    "type": "Parameter",
                    "name": "input_data",
                    "range": [
                        2440,
                        2440
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "Input",
                            "range": [
                                2442,
                                2442
                            ],
                            "children": [],
                            "content": "*"
                        }
                    ],
                    "content": "args"
                },
                {
                    "type": "Parameter",
                    "name": "credentials",
                    "range": [
                        2446,
                        2446
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "GoogleCredentials",
                            "range": [
                                2448,
                                2448
                            ],
                            "children": [],
                            "content": "\"status\""
                        }
                    ],
                    "content": "{"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        2455,
                        2495
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "service",
                            "range": [
                                2460,
                                2472
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        2461,
                                        2461
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "GmailReadBlock._build_service",
                                            "range": [
                                                2462,
                                                2471
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "credentials",
                                                    "range": [
                                                        2466,
                                                        2466
                                                    ],
                                                    "children": [],
                                                    "content": "\n"
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "**kwargs",
                                                    "range": [
                                                        2469,
                                                        2470
                                                    ],
                                                    "children": [],
                                                    "content": "(\n"
                                                }
                                            ],
                                            "content": ",\n)\n\ndef run(\nself"
                                        }
                                    ],
                                    "content": "}"
                                }
                            ],
                            "content": "\n},\n)\n\ndef run(\nself,"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "result",
                            "range": [
                                2473,
                                2489
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        2474,
                                        2474
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "self._add_label",
                                            "range": [
                                                2475,
                                                2488
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "service",
                                                    "range": [
                                                        2479,
                                                        2479
                                                    ],
                                                    "children": [],
                                                    "content": "credentials"
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "input_data.message_id",
                                                    "range": [
                                                        2481,
                                                        2483
                                                    ],
                                                    "children": [],
                                                    "content": "GoogleCredentials,*"
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "input_data.label_name",
                                                    "range": [
                                                        2485,
                                                        2487
                                                    ],
                                                    "children": [],
                                                    "content": "kwargs\n)"
                                                }
                                            ],
                                            "content": "Input,*,credentials:GoogleCredentials,**kwargs\n)-"
                                        }
                                    ],
                                    "content": ":"
                                }
                            ],
                            "content": "input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->"
                        },
                        {
                            "type": "YieldStatement",
                            "name": "yield",
                            "range": [
                                2490,
                                2494
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"result\"",
                                    "range": [
                                        2491,
                                        2491
                                    ],
                                    "children": [],
                                    "content": ":"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "result",
                                    "range": [
                                        2493,
                                        2493
                                    ],
                                    "children": [],
                                    "content": "service"
                                }
                            ],
                            "content": "BlockOutput:\nservice="
                        }
                    ],
                    "content": "\"Label_1\",\n},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock"
                }
            ],
            "content": "{\n\"_add_label\":lambda*args,**kwargs:{\n\"status\":\"Label added successfully\",\n\"label_id\":\"Label_1\",\n},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock"
        },
        {
            "type": "FunctionDecl",
            "name": "_add_label",
            "range": [
                2496,
                2575
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        2499,
                        2499
                    ],
                    "children": [],
                    "content": "credentials"
                },
                {
                    "type": "Parameter",
                    "name": "service",
                    "range": [
                        2501,
                        2501
                    ],
                    "children": [],
                    "content": "*"
                },
                {
                    "type": "Parameter",
                    "name": "message_id",
                    "range": [
                        2503,
                        2503
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                2505,
                                2505
                            ],
                            "children": [],
                            "content": "\n"
                        }
                    ],
                    "content": "kwargs"
                },
                {
                    "type": "Parameter",
                    "name": "label_name",
                    "range": [
                        2507,
                        2507
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                2509,
                                2509
                            ],
                            "children": [],
                            "content": "."
                        }
                    ],
                    "content": "="
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        2514,
                        2575
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "label_id",
                            "range": [
                                2516,
                                2526
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        2517,
                                        2517
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "self._get_or_create_label",
                                            "range": [
                                                2518,
                                                2525
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "service",
                                                    "range": [
                                                        2522,
                                                        2522
                                                    ],
                                                    "children": [],
                                                    "content": "\n"
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "label_name",
                                                    "range": [
                                                        2524,
                                                        2524
                                                    ],
                                                    "children": [],
                                                    "content": "\"result\""
                                                }
                                            ],
                                            "content": "input_data.label_name)\nyield \"result\","
                                        }
                                    ],
                                    "content": ","
                                }
                            ],
                            "content": "message_id,input_data.label_name)\nyield \"result\",result"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "service.users().messages().modify(userId=\"me\", id=message_id, body={\"addLabelIds\": [label_id]}).execute()",
                            "range": [
                                2527,
                                2563
                            ],
                            "children": [],
                            "content": "\n\ndef _add_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_or_create_label(service,label_name)\nservice.users("
                        },
                        {
                            "type": "ReturnStatement",
                            "name": "return",
                            "range": [
                                2564,
                                2574
                            ],
                            "children": [
                                {
                                    "type": "ObjectLiteral",
                                    "name": "{\"status\": \"Label added successfully\", \"label_id\": label_id}",
                                    "range": [
                                        2565,
                                        2573
                                    ],
                                    "children": [],
                                    "content": ".messages().modify(\nuserId"
                                }
                            ],
                            "content": ").messages().modify(\nuserId="
                        }
                    ],
                    "content": "input_data.message_id,input_data.label_name)\nyield \"result\",result\n\ndef _add_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_or_create_label(service,label_name)\nservice.users().messages().modify(\nuserId=\"me\""
                }
            ],
            "content": "._build_service(credentials,**kwargs)\nresult=self._add_label(service,input_data.message_id,input_data.label_name)\nyield \"result\",result\n\ndef _add_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_or_create_label(service,label_name)\nservice.users().messages().modify(\nuserId=\"me\""
        },
        {
            "type": "FunctionDecl",
            "name": "_get_or_create_label",
            "range": [
                2576,
                2656
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        2579,
                        2579
                    ],
                    "children": [],
                    "content": "message_id"
                },
                {
                    "type": "Parameter",
                    "name": "service",
                    "range": [
                        2581,
                        2581
                    ],
                    "children": [],
                    "content": "body"
                },
                {
                    "type": "Parameter",
                    "name": "label_name",
                    "range": [
                        2583,
                        2583
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                2585,
                                2585
                            ],
                            "children": [],
                            "content": ":"
                        }
                    ],
                    "content": "{"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        2590,
                        2656
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "label_id",
                            "range": [
                                2592,
                                2602
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        2593,
                                        2593
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "self._get_label_id",
                                            "range": [
                                                2594,
                                                2601
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "service",
                                                    "range": [
                                                        2598,
                                                        2598
                                                    ],
                                                    "children": [],
                                                    "content": "{"
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "label_name",
                                                    "range": [
                                                        2600,
                                                        2600
                                                    ],
                                                    "children": [],
                                                    "content": ":"
                                                }
                                            ],
                                            "content": "()\nreturn{\"status\":\"Label added successfully\""
                                        }
                                    ],
                                    "content": "execute"
                                }
                            ],
                            "content": ".execute()\nreturn{\"status\":\"Label added successfully\","
                        },
                        {
                            "type": "IfStatement",
                            "name": "if",
                            "range": [
                                2603,
                                2607
                            ],
                            "children": [
                                {
                                    "type": "UnaryExpression",
                                    "name": "not",
                                    "range": [
                                        2604,
                                        2604
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "label_id",
                                            "range": [
                                                2605,
                                                2605
                                            ],
                                            "children": [],
                                            "content": "label_id"
                                        }
                                    ],
                                    "content": ":"
                                },
                                {
                                    "type": "BlockStatement",
                                    "name": "",
                                    "range": [
                                        2608,
                                        2656
                                    ],
                                    "children": [
                                        {
                                            "type": "VariableDecl",
                                            "name": "label",
                                            "range": [
                                                2608,
                                                2645
                                            ],
                                            "children": [
                                                {
                                                    "type": "Assignment",
                                                    "name": "=",
                                                    "range": [
                                                        2609,
                                                        2609
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "service.users().labels().create(userId=\"me\", body={\"name\": label_name}).execute()",
                                                            "range": [
                                                                2610,
                                                                2644
                                                            ],
                                                            "children": [],
                                                            "content": "_get_or_create_label(self,service,label_name:str)->str:\nlabel_id=self._get_label_id(service,label_name)\nif not label_id:\nlabel=(\n"
                                                        }
                                                    ],
                                                    "content": "def"
                                                }
                                            ],
                                            "content": "\ndef _get_or_create_label(self,service,label_name:str)->str:\nlabel_id=self._get_label_id(service,label_name)\nif not label_id:\nlabel=(\nservice"
                                        },
                                        {
                                            "type": "Assignment",
                                            "name": "=",
                                            "range": [
                                                2646,
                                                2646
                                            ],
                                            "children": [
                                                {
                                                    "type": "MemberExpression",
                                                    "name": "label[\"id\"]",
                                                    "range": [
                                                        2647,
                                                        2651
                                                    ],
                                                    "children": [],
                                                    "content": "users()\n."
                                                }
                                            ],
                                            "content": "."
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "return",
                                            "range": [
                                                2653,
                                                2655
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "label_id",
                                                    "range": [
                                                        2654,
                                                        2654
                                                    ],
                                                    "children": [],
                                                    "content": ")"
                                                }
                                            ],
                                            "content": "()\n"
                                        }
                                    ],
                                    "content": "\ndef _get_or_create_label(self,service,label_name:str)->str:\nlabel_id=self._get_label_id(service,label_name)\nif not label_id:\nlabel=(\nservice.users()\n.labels()\n."
                                }
                            ],
                            "content": "\"label_id\":label_id}\n"
                        }
                    ],
                    "content": "\n).execute()\nreturn{\"status\":\"Label added successfully\",\"label_id\":label_id}\n\ndef _get_or_create_label(self,service,label_name:str)->str:\nlabel_id=self._get_label_id(service,label_name)\nif not label_id:\nlabel=(\nservice.users()\n.labels()\n."
                }
            ],
            "content": ",id=message_id,body={\"addLabelIds\":[label_id]}\n).execute()\nreturn{\"status\":\"Label added successfully\",\"label_id\":label_id}\n\ndef _get_or_create_label(self,service,label_name:str)->str:\nlabel_id=self._get_label_id(service,label_name)\nif not label_id:\nlabel=(\nservice.users()\n.labels()\n."
        },
        {
            "type": "FunctionDecl",
            "name": "_get_label_id",
            "range": [
                2657,
                2734
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "self",
                    "range": [
                        2660,
                        2660
                    ],
                    "children": [],
                    "content": "="
                },
                {
                    "type": "Parameter",
                    "name": "service",
                    "range": [
                        2662,
                        2662
                    ],
                    "children": [],
                    "content": ","
                },
                {
                    "type": "Parameter",
                    "name": "label_name",
                    "range": [
                        2664,
                        2664
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                2666,
                                2666
                            ],
                            "children": [],
                            "content": "\"name\""
                        }
                    ],
                    "content": "="
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        2673,
                        2734
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "results",
                            "range": [
                                2675,
                                2697
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        2676,
                                        2676
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "service.users().labels().list(userId=\"me\").execute()",
                                            "range": [
                                                2677,
                                                2696
                                            ],
                                            "children": [],
                                            "content": ")\nlabel_id=label[\"id\"]\nreturn label_id\n\ndef _get_label_id(self,service,"
                                        }
                                    ],
                                    "content": "\n"
                                }
                            ],
                            "content": ")\n)\nlabel_id=label[\"id\"]\nreturn label_id\n\ndef _get_label_id(self,service,label_name"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "labels",
                            "range": [
                                2698,
                                2709
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        2699,
                                        2699
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "results.get",
                                            "range": [
                                                2700,
                                                2708
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "\"labels\"",
                                                    "range": [
                                                        2704,
                                                        2704
                                                    ],
                                                    "children": [],
                                                    "content": "|"
                                                },
                                                {
                                                    "type": "Argument",
                                                    "name": "[]",
                                                    "range": [
                                                        2706,
                                                        2707
                                                    ],
                                                    "children": [],
                                                    "content": ":\n"
                                                }
                                            ],
                                            "content": ")->str|None:\nresults"
                                        }
                                    ],
                                    "content": "str"
                                }
                            ],
                            "content": ":str)->str|None:\nresults="
                        },
                        {
                            "type": "ForStatement",
                            "name": "for",
                            "range": [
                                2710,
                                2734
                            ],
                            "children": [
                                {
                                    "type": "VariableDecl",
                                    "name": "label",
                                    "range": [
                                        2711,
                                        2711
                                    ],
                                    "children": [],
                                    "content": "."
                                },
                                {
                                    "type": "BlockStatement",
                                    "name": "",
                                    "range": [
                                        2714,
                                        2734
                                    ],
                                    "children": [
                                        {
                                            "type": "IfStatement",
                                            "name": "if",
                                            "range": [
                                                2716,
                                                2724
                                            ],
                                            "children": [
                                                {
                                                    "type": "BinaryExpression",
                                                    "name": "==",
                                                    "range": [
                                                        2721,
                                                        2722
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "MemberExpression",
                                                            "name": "label[\"name\"]",
                                                            "range": [
                                                                2717,
                                                                2720
                                                            ],
                                                            "children": [],
                                                            "content": "().list"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "label_name",
                                                            "range": [
                                                                2723,
                                                                2723
                                                            ],
                                                            "children": [],
                                                            "content": "="
                                                        }
                                                    ],
                                                    "content": "(userId"
                                                },
                                                {
                                                    "type": "BlockStatement",
                                                    "name": "",
                                                    "range": [
                                                        2725,
                                                        2734
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "ReturnStatement",
                                                            "name": "return",
                                                            "range": [
                                                                2726,
                                                                2733
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "label[\"id\"]",
                                                                    "range": [
                                                                        2727,
                                                                        2731
                                                                    ],
                                                                    "children": [],
                                                                    "content": "execute()\nlabels"
                                                                }
                                                            ],
                                                            "content": ".execute()\nlabels=results"
                                                        }
                                                    ],
                                                    "content": ").execute()\nlabels=results."
                                                }
                                            ],
                                            "content": "labels().list(userId=\"me\""
                                        }
                                    ],
                                    "content": ").labels().list(userId=\"me\").execute()\nlabels=results."
                                }
                            ],
                            "content": "service.users().labels().list(userId=\"me\").execute()\nlabels=results."
                        }
                    ],
                    "content": "execute()\n)\nlabel_id=label[\"id\"]\nreturn label_id\n\ndef _get_label_id(self,service,label_name:str)->str|None:\nresults=service.users().labels().list(userId=\"me\").execute()\nlabels=results."
                }
            ],
            "content": "create(userId=\"me\",body={\"name\":label_name})\n.execute()\n)\nlabel_id=label[\"id\"]\nreturn label_id\n\ndef _get_label_id(self,service,label_name:str)->str|None:\nresults=service.users().labels().list(userId=\"me\").execute()\nlabels=results."
        },
        {
            "type": "ClassDecl",
            "name": "Input",
            "range": [
                2737,
                2784
            ],
            "children": [
                {
                    "type": "FieldDecl",
                    "name": "credentials",
                    "range": [
                        2744,
                        2755
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "GoogleCredentialsInput",
                            "range": [
                                2746,
                                2746
                            ],
                            "children": [],
                            "content": "labels"
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "=",
                            "range": [
                                2747,
                                2755
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "GoogleCredentialsField",
                                    "range": [
                                        2748,
                                        2755
                                    ],
                                    "children": [
                                        {
                                            "type": "ArrayExpression",
                                            "name": "",
                                            "range": [
                                                2751,
                                                2753
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"https://www.googleapis.com/auth/gmail.modify\"",
                                                    "range": [
                                                        2752,
                                                        2752
                                                    ],
                                                    "children": [],
                                                    "content": "\"name\""
                                                }
                                            ],
                                            "content": "[\"name\"]"
                                        }
                                    ],
                                    "content": "\nif label[\"name\"]=="
                                }
                            ],
                            "content": ":\nif label[\"name\"]=="
                        }
                    ],
                    "content": "label in labels:\nif label[\"name\"]=="
                },
                {
                    "type": "FieldDecl",
                    "name": "message_id",
                    "range": [
                        2757,
                        2769
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                2759,
                                2759
                            ],
                            "children": [],
                            "content": "return"
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "=",
                            "range": [
                                2760,
                                2769
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "SchemaField",
                                    "range": [
                                        2761,
                                        2769
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                2764,
                                                2766
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"Message ID to remove label from\"",
                                                    "range": [
                                                        2766,
                                                        2766
                                                    ],
                                                    "children": [],
                                                    "content": "None"
                                                }
                                            ],
                                            "content": "\nreturn None"
                                        }
                                    ],
                                    "content": "[\"id\"]\nreturn None\n\n\n"
                                }
                            ],
                            "content": "label[\"id\"]\nreturn None\n\n\n"
                        }
                    ],
                    "content": ":\nreturn label[\"id\"]\nreturn None\n\n\n"
                },
                {
                    "type": "FieldDecl",
                    "name": "label_name",
                    "range": [
                        2771,
                        2783
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                2773,
                                2773
                            ],
                            "children": [],
                            "content": "Block"
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "=",
                            "range": [
                                2774,
                                2783
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "SchemaField",
                                    "range": [
                                        2775,
                                        2783
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                2778,
                                                2780
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"Label name to remove\"",
                                                    "range": [
                                                        2780,
                                                        2780
                                                    ],
                                                    "children": [],
                                                    "content": "BlockSchema"
                                                }
                                            ],
                                            "content": "Input(BlockSchema"
                                        }
                                    ],
                                    "content": ":\nclass Input(BlockSchema):\n"
                                }
                            ],
                            "content": "):\nclass Input(BlockSchema):\n"
                        }
                    ],
                    "content": "GmailRemoveLabelBlock(Block):\nclass Input(BlockSchema):\n"
                }
            ],
            "content": "\"labels\",[])\nfor label in labels:\nif label[\"name\"]==label_name:\nreturn label[\"id\"]\nreturn None\n\n\nclass GmailRemoveLabelBlock(Block):\nclass Input(BlockSchema):\ncredentials"
        },
        {
            "type": "ClassDecl",
            "name": "Output",
            "range": [
                2786,
                2820
            ],
            "children": [
                {
                    "type": "FieldDecl",
                    "name": "result",
                    "range": [
                        2793,
                        2805
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "dict",
                            "range": [
                                2795,
                                2795
                            ],
                            "children": [],
                            "content": ")"
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "=",
                            "range": [
                                2796,
                                2805
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "SchemaField",
                                    "range": [
                                        2797,
                                        2805
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                2800,
                                                2802
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"Label removal result\"",
                                                    "range": [
                                                        2802,
                                                        2802
                                                    ],
                                                    "children": [],
                                                    "content": "("
                                                }
                                            ],
                                            "content": "=SchemaField("
                                        }
                                    ],
                                    "content": "message_id:str=SchemaField(\ndescription="
                                }
                            ],
                            "content": "\nmessage_id:str=SchemaField(\ndescription="
                        }
                    ],
                    "content": "]\n)\nmessage_id:str=SchemaField(\ndescription="
                },
                {
                    "type": "FieldDecl",
                    "name": "error",
                    "range": [
                        2807,
                        2819
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                2809,
                                2809
                            ],
                            "children": [],
                            "content": ")"
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "=",
                            "range": [
                                2810,
                                2819
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "SchemaField",
                                    "range": [
                                        2811,
                                        2819
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                2814,
                                                2816
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"Error message if any\"",
                                                    "range": [
                                                        2816,
                                                        2816
                                                    ],
                                                    "children": [],
                                                    "content": "("
                                                }
                                            ],
                                            "content": "=SchemaField("
                                        }
                                    ],
                                    "content": "label_name:str=SchemaField(\ndescription="
                                }
                            ],
                            "content": "\nlabel_name:str=SchemaField(\ndescription="
                        }
                    ],
                    "content": ",\n)\nlabel_name:str=SchemaField(\ndescription="
                }
            ],
            "content": "GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.modify\"]\n)\nmessage_id:str=SchemaField(\ndescription=\"Message ID to remove label from\",\n)\nlabel_name:str=SchemaField(\ndescription=\"Label name to remove\""
        },
        {
            "type": "FunctionDecl",
            "name": "__init__",
            "range": [
                2822,
                2961
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        2828,
                        2961
                    ],
                    "children": [
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2829,
                                2835
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "super",
                                    "range": [
                                        2829,
                                        2835
                                    ],
                                    "children": [],
                                    "content": "BlockSchema):\nresult:dict"
                                }
                            ],
                            "content": "BlockSchema):\nresult:dict"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2836,
                                2854
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2837,
                                        2854
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "id",
                                            "range": [
                                                2836,
                                                2836
                                            ],
                                            "children": [],
                                            "content": "="
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"0afc0526-aba1-4b2b-888e-a22b7c3f359d\"",
                                            "range": [
                                                2838,
                                                2838
                                            ],
                                            "children": [],
                                            "content": "("
                                        }
                                    ],
                                    "content": "SchemaField(\ndescription=\"Label removal result\",\n)\nerror:str=SchemaField(\ndescription"
                                }
                            ],
                            "content": "=SchemaField(\ndescription=\"Label removal result\",\n)\nerror:str=SchemaField(\ndescription"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2841,
                                2853
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2842,
                                        2853
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "description",
                                            "range": [
                                                2841,
                                                2841
                                            ],
                                            "children": [],
                                            "content": "="
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"This block removes a label from a Gmail message.\"",
                                            "range": [
                                                2843,
                                                2843
                                            ],
                                            "children": [],
                                            "content": ","
                                        }
                                    ],
                                    "content": "\"Label removal result\",\n)\nerror:str=SchemaField(\n"
                                }
                            ],
                            "content": "=\"Label removal result\",\n)\nerror:str=SchemaField(\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2846,
                                2852
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2847,
                                        2852
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "categories",
                                            "range": [
                                                2846,
                                                2846
                                            ],
                                            "children": [],
                                            "content": "\n"
                                        },
                                        {
                                            "type": "ObjectExpression",
                                            "name": "",
                                            "range": [
                                                2848,
                                                2852
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "BlockCategory.COMMUNICATION",
                                                    "range": [
                                                        2849,
                                                        2851
                                                    ],
                                                    "children": [],
                                                    "content": "str=SchemaField"
                                                }
                                            ],
                                            "content": ":str=SchemaField("
                                        }
                                    ],
                                    "content": "error:str=SchemaField("
                                }
                            ],
                            "content": "\nerror:str=SchemaField("
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2855,
                                2867
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2856,
                                        2867
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "input_schema",
                                            "range": [
                                                2855,
                                                2855
                                            ],
                                            "children": [],
                                            "content": "="
                                        },
                                        {
                                            "type": "MemberExpression",
                                            "name": "GmailRemoveLabelBlock.Input",
                                            "range": [
                                                2857,
                                                2860
                                            ],
                                            "children": [],
                                            "content": ",\n)\n"
                                        }
                                    ],
                                    "content": "\"Error message if any\",\n)\n\ndef __init__(self):"
                                }
                            ],
                            "content": "=\"Error message if any\",\n)\n\ndef __init__(self):"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2862,
                                2867
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2863,
                                        2867
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "output_schema",
                                            "range": [
                                                2862,
                                                2862
                                            ],
                                            "children": [],
                                            "content": "def"
                                        },
                                        {
                                            "type": "MemberExpression",
                                            "name": "GmailRemoveLabelBlock.Output",
                                            "range": [
                                                2864,
                                                2867
                                            ],
                                            "children": [],
                                            "content": "(self):"
                                        }
                                    ],
                                    "content": "__init__(self):"
                                }
                            ],
                            "content": "def __init__(self):"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2869,
                                2873
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2870,
                                        2873
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "disabled",
                                            "range": [
                                                2869,
                                                2869
                                            ],
                                            "children": [],
                                            "content": "super"
                                        },
                                        {
                                            "type": "UnaryExpression",
                                            "name": "not",
                                            "range": [
                                                2871,
                                                2873
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "GOOGLE_OAUTH_IS_CONFIGURED",
                                                    "range": [
                                                        2872,
                                                        2872
                                                    ],
                                                    "children": [],
                                                    "content": "."
                                                }
                                            ],
                                            "content": ").__init__"
                                        }
                                    ],
                                    "content": "().__init__"
                                }
                            ],
                            "content": "super().__init__"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2875,
                                2894
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2876,
                                        2894
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "test_input",
                                            "range": [
                                                2875,
                                                2875
                                            ],
                                            "children": [],
                                            "content": "\n"
                                        },
                                        {
                                            "type": "ObjectExpression",
                                            "name": "",
                                            "range": [
                                                2877,
                                                2894
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "message_id",
                                                    "range": [
                                                        2879,
                                                        2881
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"12345\"",
                                                            "range": [
                                                                2881,
                                                                2881
                                                            ],
                                                            "children": [],
                                                            "content": "description"
                                                        }
                                                    ],
                                                    "content": ",\ndescription"
                                                },
                                                {
                                                    "type": "Property",
                                                    "name": "label_name",
                                                    "range": [
                                                        2884,
                                                        2886
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"Important\"",
                                                            "range": [
                                                                2886,
                                                                2886
                                                            ],
                                                            "children": [],
                                                            "content": "categories"
                                                        }
                                                    ],
                                                    "content": ",\ncategories"
                                                },
                                                {
                                                    "type": "Property",
                                                    "name": "credentials",
                                                    "range": [
                                                        2889,
                                                        2891
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "TEST_CREDENTIALS_INPUT",
                                                            "range": [
                                                                2891,
                                                                2891
                                                            ],
                                                            "children": [],
                                                            "content": "COMMUNICATION"
                                                        }
                                                    ],
                                                    "content": "BlockCategory.COMMUNICATION"
                                                }
                                            ],
                                            "content": "=\"0afc0526-aba1-4b2b-888e-a22b7c3f359d\",\ndescription=\"This block removes a label from a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\n"
                                        }
                                    ],
                                    "content": "id=\"0afc0526-aba1-4b2b-888e-a22b7c3f359d\",\ndescription=\"This block removes a label from a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\n"
                                }
                            ],
                            "content": "\nid=\"0afc0526-aba1-4b2b-888e-a22b7c3f359d\",\ndescription=\"This block removes a label from a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2897,
                                2900
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2898,
                                        2900
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "test_credentials",
                                            "range": [
                                                2897,
                                                2897
                                            ],
                                            "children": [],
                                            "content": "GmailRemoveLabelBlock"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "TEST_CREDENTIALS",
                                            "range": [
                                                2899,
                                                2899
                                            ],
                                            "children": [],
                                            "content": "Input"
                                        }
                                    ],
                                    "content": ".Input,"
                                }
                            ],
                            "content": "GmailRemoveLabelBlock.Input,"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2902,
                                2925
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2903,
                                        2925
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "test_output",
                                            "range": [
                                                2902,
                                                2902
                                            ],
                                            "children": [],
                                            "content": "output_schema"
                                        },
                                        {
                                            "type": "ArrayExpression",
                                            "name": "",
                                            "range": [
                                                2904,
                                                2925
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        2906,
                                                        2920
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "result",
                                                            "range": [
                                                                2908,
                                                                2910
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "ObjectExpression",
                                                                    "name": "",
                                                                    "range": [
                                                                        2911,
                                                                        2919
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Property",
                                                                            "name": "status",
                                                                            "range": [
                                                                                2912,
                                                                                2914
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"Label removed successfully\"",
                                                                                    "range": [
                                                                                        2914,
                                                                                        2914
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\n"
                                                                                }
                                                                            ],
                                                                            "content": "GOOGLE_OAUTH_IS_CONFIGURED,\n"
                                                                        },
                                                                        {
                                                                            "type": "Property",
                                                                            "name": "label_id",
                                                                            "range": [
                                                                                2916,
                                                                                2918
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"Label_1\"",
                                                                                    "range": [
                                                                                        2918,
                                                                                        2918
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\n"
                                                                                }
                                                                            ],
                                                                            "content": "={\n"
                                                                        }
                                                                    ],
                                                                    "content": "not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\""
                                                                }
                                                            ],
                                                            "content": "\ndisabled="
                                                        }
                                                    ],
                                                    "content": "Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":"
                                                }
                                            ],
                                            "content": "GmailRemoveLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":"
                                        }
                                    ],
                                    "content": "=GmailRemoveLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":"
                                }
                            ],
                            "content": "output_schema=GmailRemoveLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                2928,
                                2957
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2929,
                                        2957
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "test_mock",
                                            "range": [
                                                2928,
                                                2928
                                            ],
                                            "children": [],
                                            "content": "\n"
                                        },
                                        {
                                            "type": "ObjectExpression",
                                            "name": "",
                                            "range": [
                                                2930,
                                                2957
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "_remove_label",
                                                    "range": [
                                                        2932,
                                                        2942
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "FunctionExpression",
                                                            "name": "lambda",
                                                            "range": [
                                                                2934,
                                                                2942
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "BlockStatement",
                                                                    "name": "",
                                                                    "range": [
                                                                        2942,
                                                                        2942
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "ReturnStatement",
                                                                            "name": "",
                                                                            "range": [
                                                                                2942,
                                                                                2942
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "ObjectExpression",
                                                                                    "name": "",
                                                                                    "range": [
                                                                                        2942,
                                                                                        2942
                                                                                    ],
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "Property",
                                                                                            "name": "status",
                                                                                            "range": [
                                                                                                2944,
                                                                                                2946
                                                                                            ],
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "Literal",
                                                                                                    "name": "\"Label removed successfully\"",
                                                                                                    "range": [
                                                                                                        2946,
                                                                                                        2946
                                                                                                    ],
                                                                                                    "children": [],
                                                                                                    "content": "("
                                                                                                }
                                                                                            ],
                                                                                            "content": "[\n("
                                                                                        },
                                                                                        {
                                                                                            "type": "Property",
                                                                                            "name": "label_id",
                                                                                            "range": [
                                                                                                2949,
                                                                                                2951
                                                                                            ],
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "Literal",
                                                                                                    "name": "\"Label_1\"",
                                                                                                    "range": [
                                                                                                        2951,
                                                                                                        2951
                                                                                                    ],
                                                                                                    "children": [],
                                                                                                    "content": "{"
                                                                                                }
                                                                                            ],
                                                                                            "content": ",\n{"
                                                                                        }
                                                                                    ],
                                                                                    "content": "test_output"
                                                                                }
                                                                            ],
                                                                            "content": "test_output"
                                                                        }
                                                                    ],
                                                                    "content": "test_output"
                                                                }
                                                            ],
                                                            "content": "},\ntest_credentials=TEST_CREDENTIALS,\ntest_output"
                                                        }
                                                    ],
                                                    "content": ",\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output"
                                                }
                                            ],
                                            "content": ":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label removed successfully\",\"label_id\":"
                                        }
                                    ],
                                    "content": "\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label removed successfully\",\"label_id\":"
                                }
                            ],
                            "content": "\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label removed successfully\",\"label_id\":"
                        }
                    ],
                    "content": "(BlockSchema):\nresult:dict=SchemaField(\ndescription=\"Label removal result\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"0afc0526-aba1-4b2b-888e-a22b7c3f359d\",\ndescription=\"This block removes a label from a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailRemoveLabelBlock.Input,\noutput_schema=GmailRemoveLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":\"Important\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label removed successfully\",\"label_id\":\"Label_1\"},\n"
                }
            ],
            "content": "\n)\n\nclass Output(BlockSchema):\nresult:dict=SchemaField(\ndescription=\"Label removal result\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"0afc0526-aba1-4b2b-888e-a22b7c3f359d\",\ndescription=\"This block removes a label from a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailRemoveLabelBlock.Input,\noutput_schema=GmailRemoveLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":\"Important\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label removed successfully\",\"label_id\":\"Label_1\"},\n"
        },
        {
            "type": "FunctionDecl",
            "name": "run",
            "range": [
                2963,
                3025
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        2988,
                        3025
                    ],
                    "children": [
                        {
                            "type": "VariableDeclaration",
                            "name": "service",
                            "range": [
                                2989,
                                3000
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        2990,
                                        3000
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "GmailReadBlock._build_service",
                                            "range": [
                                                2991,
                                                3000
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "credentials",
                                                    "range": [
                                                        2995,
                                                        2995
                                                    ],
                                                    "children": [],
                                                    "content": ","
                                                },
                                                {
                                                    "type": "SpreadElement",
                                                    "name": "kwargs",
                                                    "range": [
                                                        2997,
                                                        2999
                                                    ],
                                                    "children": [],
                                                    "content": "},\n"
                                                }
                                            ],
                                            "content": "\"Label_1\",\n},\n},\n)"
                                        }
                                    ],
                                    "content": ":\"Label_1\",\n},\n},\n)"
                                }
                            ],
                            "content": "\"label_id\":\"Label_1\",\n},\n},\n)"
                        },
                        {
                            "type": "VariableDeclaration",
                            "name": "result",
                            "range": [
                                3002,
                                3019
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        3003,
                                        3019
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "self._remove_label",
                                            "range": [
                                                3004,
                                                3019
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "service",
                                                    "range": [
                                                        3009,
                                                        3009
                                                    ],
                                                    "children": [],
                                                    "content": "input_data"
                                                },
                                                {
                                                    "type": "MemberExpression",
                                                    "name": "input_data.message_id",
                                                    "range": [
                                                        3011,
                                                        3013
                                                    ],
                                                    "children": [],
                                                    "content": "Input,*"
                                                },
                                                {
                                                    "type": "MemberExpression",
                                                    "name": "input_data.label_name",
                                                    "range": [
                                                        3015,
                                                        3017
                                                    ],
                                                    "children": [],
                                                    "content": "credentials:GoogleCredentials"
                                                }
                                            ],
                                            "content": "run(\nself,input_data:Input,*,credentials:GoogleCredentials,*"
                                        }
                                    ],
                                    "content": "def run(\nself,input_data:Input,*,credentials:GoogleCredentials,*"
                                }
                            ],
                            "content": "\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,*"
                        },
                        {
                            "type": "YieldExpression",
                            "name": "",
                            "range": [
                                3021,
                                3024
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"result\"",
                                    "range": [
                                        3022,
                                        3022
                                    ],
                                    "children": [],
                                    "content": "\n"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "result",
                                    "range": [
                                        3024,
                                        3024
                                    ],
                                    "children": [],
                                    "content": "-"
                                }
                            ],
                            "content": "kwargs\n)-"
                        }
                    ],
                    "content": "\n\"label_id\":\"Label_1\",\n},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->"
                }
            ],
            "content": ",\n],\ntest_mock={\n\"_remove_label\":lambda*args,**kwargs:{\n\"status\":\"Label removed successfully\",\n\"label_id\":\"Label_1\",\n},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->"
        },
        {
            "type": "FunctionDecl",
            "name": "_remove_label",
            "range": [
                3027,
                3123
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        3046,
                        3123
                    ],
                    "children": [
                        {
                            "type": "VariableDeclaration",
                            "name": "label_id",
                            "range": [
                                3047,
                                3057
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        3048,
                                        3057
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "self._get_label_id",
                                            "range": [
                                                3049,
                                                3057
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "service",
                                                    "range": [
                                                        3053,
                                                        3053
                                                    ],
                                                    "children": [],
                                                    "content": "message_id"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "label_name",
                                                    "range": [
                                                        3055,
                                                        3055
                                                    ],
                                                    "children": [],
                                                    "content": "input_data"
                                                }
                                            ],
                                            "content": "service,input_data.message_id,input_data.label_name"
                                        }
                                    ],
                                    "content": "\nservice,input_data.message_id,input_data.label_name"
                                }
                            ],
                            "content": "(\nservice,input_data.message_id,input_data.label_name"
                        },
                        {
                            "type": "IfStatement",
                            "name": "",
                            "range": [
                                3058,
                                3109
                            ],
                            "children": [
                                {
                                    "type": "ExpressionStatement",
                                    "name": "",
                                    "range": [
                                        3059,
                                        3060
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "label_id",
                                            "range": [
                                                3059,
                                                3059
                                            ],
                                            "children": [],
                                            "content": ")"
                                        }
                                    ],
                                    "content": ")\n"
                                },
                                {
                                    "type": "BlockStatement",
                                    "name": "",
                                    "range": [
                                        3061,
                                        3109
                                    ],
                                    "children": [
                                        {
                                            "type": "ExpressionStatement",
                                            "name": "",
                                            "range": [
                                                3062,
                                                3098
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "service.users().messages().modify",
                                                    "range": [
                                                        3062,
                                                        3098
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "userId",
                                                            "range": [
                                                                3075,
                                                                3077
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"me\"",
                                                                    "range": [
                                                                        3077,
                                                                        3077
                                                                    ],
                                                                    "children": [],
                                                                    "content": ","
                                                                }
                                                            ],
                                                            "content": ":str,"
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "id",
                                                            "range": [
                                                                3079,
                                                                3081
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "message_id",
                                                                    "range": [
                                                                        3081,
                                                                        3081
                                                                    ],
                                                                    "children": [],
                                                                    "content": ")"
                                                                }
                                                            ],
                                                            "content": ":str)"
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "body",
                                                            "range": [
                                                                3083,
                                                                3091
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "ObjectExpression",
                                                                    "name": "",
                                                                    "range": [
                                                                        3085,
                                                                        3091
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Property",
                                                                            "name": "removeLabelIds",
                                                                            "range": [
                                                                                3086,
                                                                                3088
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "ArrayExpression",
                                                                                    "name": "",
                                                                                    "range": [
                                                                                        3088,
                                                                                        3090
                                                                                    ],
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "Identifier",
                                                                                            "name": "label_id",
                                                                                            "range": [
                                                                                                3089,
                                                                                                3089
                                                                                            ],
                                                                                            "children": [],
                                                                                            "content": "self"
                                                                                        }
                                                                                    ],
                                                                                    "content": "=self."
                                                                                }
                                                                            ],
                                                                            "content": "\nlabel_id="
                                                                        }
                                                                    ],
                                                                    "content": ":\nlabel_id=self._get_label_id"
                                                                }
                                                            ],
                                                            "content": ">dict:\nlabel_id=self._get_label_id"
                                                        }
                                                    ],
                                                    "content": "\"result\",result\n\ndef _remove_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_label_id(service,label_name)\nif"
                                                }
                                            ],
                                            "content": "\"result\",result\n\ndef _remove_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_label_id(service,label_name)\nif"
                                        },
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                3099,
                                                3109
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        3100,
                                                        3108
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "status",
                                                            "range": [
                                                                3101,
                                                                3103
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"Label removed successfully\"",
                                                                    "range": [
                                                                        3103,
                                                                        3103
                                                                    ],
                                                                    "children": [],
                                                                    "content": "."
                                                                }
                                                            ],
                                                            "content": "\nservice."
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "label_id",
                                                            "range": [
                                                                3105,
                                                                3107
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "label_id",
                                                                    "range": [
                                                                        3107,
                                                                        3107
                                                                    ],
                                                                    "children": [],
                                                                    "content": "."
                                                                }
                                                            ],
                                                            "content": "()."
                                                        }
                                                    ],
                                                    "content": ":\nservice.users().messages"
                                                }
                                            ],
                                            "content": "label_id:\nservice.users().messages("
                                        }
                                    ],
                                    "content": "yield \"result\",result\n\ndef _remove_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_label_id(service,label_name)\nif label_id:\nservice.users().messages("
                                }
                            ],
                            "content": "\n)\nyield \"result\",result\n\ndef _remove_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_label_id(service,label_name)\nif label_id:\nservice.users().messages("
                        },
                        {
                            "type": "ElseStatement",
                            "name": "",
                            "range": [
                                3110,
                                3123
                            ],
                            "children": [
                                {
                                    "type": "BlockStatement",
                                    "name": "",
                                    "range": [
                                        3111,
                                        3123
                                    ],
                                    "children": [
                                        {
                                            "type": "ReturnStatement",
                                            "name": "",
                                            "range": [
                                                3113,
                                                3123
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        3114,
                                                        3122
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "status",
                                                            "range": [
                                                                3115,
                                                                3117
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"Label not found\"",
                                                                    "range": [
                                                                        3117,
                                                                        3117
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"me\""
                                                                }
                                                            ],
                                                            "content": "userId=\"me\""
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "label_name",
                                                            "range": [
                                                                3119,
                                                                3121
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "label_name",
                                                                    "range": [
                                                                        3121,
                                                                        3121
                                                                    ],
                                                                    "children": [],
                                                                    "content": "message_id"
                                                                }
                                                            ],
                                                            "content": "id=message_id"
                                                        }
                                                    ],
                                                    "content": "\nuserId=\"me\",id=message_id,"
                                                }
                                            ],
                                            "content": "(\nuserId=\"me\",id=message_id,body"
                                        }
                                    ],
                                    "content": ".modify(\nuserId=\"me\",id=message_id,body"
                                }
                            ],
                            "content": ").modify(\nuserId=\"me\",id=message_id,body"
                        }
                    ],
                    "content": "_remove_label(\nservice,input_data.message_id,input_data.label_name\n)\nyield \"result\",result\n\ndef _remove_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_label_id(service,label_name)\nif label_id:\nservice.users().messages().modify(\nuserId=\"me\",id=message_id,body"
                }
            ],
            "content": ":\nservice=GmailReadBlock._build_service(credentials,**kwargs)\nresult=self._remove_label(\nservice,input_data.message_id,input_data.label_name\n)\nyield \"result\",result\n\ndef _remove_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_label_id(service,label_name)\nif label_id:\nservice.users().messages().modify(\nuserId=\"me\",id=message_id,body"
        },
        {
            "type": "FunctionDecl",
            "name": "_get_label_id",
            "range": [
                3125,
                3202
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        3142,
                        3202
                    ],
                    "children": [
                        {
                            "type": "VariableDeclaration",
                            "name": "results",
                            "range": [
                                3143,
                                3165
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        3144,
                                        3165
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "service.users().labels().list",
                                            "range": [
                                                3145,
                                                3165
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "userId",
                                                    "range": [
                                                        3157,
                                                        3159
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"me\"",
                                                            "range": [
                                                                3159,
                                                                3159
                                                            ],
                                                            "children": [],
                                                            "content": "\"label_name\""
                                                        }
                                                    ],
                                                    "content": "\"Label not found\",\"label_name\""
                                                }
                                            ],
                                            "content": "\"label_id\":label_id}\nelse:\nreturn{\"status\":\"Label not found\",\"label_name\":label_name}\n\ndef"
                                        }
                                    ],
                                    "content": ",\"label_id\":label_id}\nelse:\nreturn{\"status\":\"Label not found\",\"label_name\":label_name}\n\ndef"
                                }
                            ],
                            "content": "\"Label removed successfully\",\"label_id\":label_id}\nelse:\nreturn{\"status\":\"Label not found\",\"label_name\":label_name}\n\ndef"
                        },
                        {
                            "type": "VariableDeclaration",
                            "name": "labels",
                            "range": [
                                3166,
                                3177
                            ],
                            "children": [
                                {
                                    "type": "AssignmentExpression",
                                    "name": "=",
                                    "range": [
                                        3167,
                                        3177
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "results.get",
                                            "range": [
                                                3168,
                                                3177
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"labels\"",
                                                    "range": [
                                                        3172,
                                                        3172
                                                    ],
                                                    "children": [],
                                                    "content": "label_name"
                                                },
                                                {
                                                    "type": "ArrayExpression",
                                                    "name": "",
                                                    "range": [
                                                        3174,
                                                        3176
                                                    ],
                                                    "children": [],
                                                    "content": "str)-"
                                                }
                                            ],
                                            "content": "self,service,label_name:str)->"
                                        }
                                    ],
                                    "content": "(self,service,label_name:str)->"
                                }
                            ],
                            "content": "_get_label_id(self,service,label_name:str)->"
                        },
                        {
                            "type": "ForStatement",
                            "name": "",
                            "range": [
                                3178,
                                3199
                            ],
                            "children": [
                                {
                                    "type": "VariableDeclaration",
                                    "name": "label",
                                    "range": [
                                        3179,
                                        3180
                                    ],
                                    "children": [],
                                    "content": "|None"
                                },
                                {
                                    "type": "ExpressionStatement",
                                    "name": "",
                                    "range": [
                                        3181,
                                        3182
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "labels",
                                            "range": [
                                                3181,
                                                3181
                                            ],
                                            "children": [],
                                            "content": ":"
                                        }
                                    ],
                                    "content": ":\n"
                                },
                                {
                                    "type": "BlockStatement",
                                    "name": "",
                                    "range": [
                                        3183,
                                        3199
                                    ],
                                    "children": [
                                        {
                                            "type": "IfStatement",
                                            "name": "",
                                            "range": [
                                                3184,
                                                3192
                                            ],
                                            "children": [
                                                {
                                                    "type": "ExpressionStatement",
                                                    "name": "",
                                                    "range": [
                                                        3185,
                                                        3191
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "BinaryExpression",
                                                            "name": "==",
                                                            "range": [
                                                                3185,
                                                                3191
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "label.name",
                                                                    "range": [
                                                                        3185,
                                                                        3188
                                                                    ],
                                                                    "children": [],
                                                                    "content": "service.users("
                                                                },
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "label_name",
                                                                    "range": [
                                                                        3190,
                                                                        3190
                                                                    ],
                                                                    "children": [],
                                                                    "content": "."
                                                                }
                                                            ],
                                                            "content": "service.users().labels"
                                                        }
                                                    ],
                                                    "content": "service.users().labels"
                                                },
                                                {
                                                    "type": "BlockStatement",
                                                    "name": "",
                                                    "range": [
                                                        3192,
                                                        3199
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "ReturnStatement",
                                                            "name": "",
                                                            "range": [
                                                                3194,
                                                                3199
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "label.id",
                                                                    "range": [
                                                                        3195,
                                                                        3198
                                                                    ],
                                                                    "children": [],
                                                                    "content": "list(userId="
                                                                }
                                                            ],
                                                            "content": ".list(userId=\"me\""
                                                        }
                                                    ],
                                                    "content": "().list(userId=\"me\""
                                                }
                                            ],
                                            "content": "=service.users().labels("
                                        }
                                    ],
                                    "content": "results=service.users().labels().list(userId=\"me\""
                                }
                            ],
                            "content": "str|None:\nresults=service.users().labels().list(userId=\"me\""
                        },
                        {
                            "type": "ReturnStatement",
                            "name": "",
                            "range": [
                                3200,
                                3202
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "None",
                                    "range": [
                                        3201,
                                        3201
                                    ],
                                    "children": [],
                                    "content": "."
                                }
                            ],
                            "content": ").execute"
                        }
                    ],
                    "content": ":\"Label removed successfully\",\"label_id\":label_id}\nelse:\nreturn{\"status\":\"Label not found\",\"label_name\":label_name}\n\ndef _get_label_id(self,service,label_name:str)->str|None:\nresults=service.users().labels().list(userId=\"me\").execute"
                }
            ],
            "content": "{\"removeLabelIds\":[label_id]}\n).execute()\nreturn{\"status\":\"Label removed successfully\",\"label_id\":label_id}\nelse:\nreturn{\"status\":\"Label not found\",\"label_name\":label_name}\n\ndef _get_label_id(self,service,label_name:str)->str|None:\nresults=service.users().labels().list(userId=\"me\").execute"
        }
    ],
    "content": "import base64\nfrom email.utils import parseaddr\nfrom typing import List\n\nfrom google.oauth2.credentials import Credentials\nfrom googleapiclient.discovery import build\nfrom pydantic import BaseModel\n\nfrom backend.data.block import Block,BlockCategory,BlockOutput,BlockSchema\nfrom backend.data.model import SchemaField\n\nfrom._auth import(\nGOOGLE_OAUTH_IS_CONFIGURED,\nTEST_CREDENTIALS,\nTEST_CREDENTIALS_INPUT,\nGoogleCredentials,\nGoogleCredentialsField,\nGoogleCredentialsInput,\n)\n\n\nclass Attachment(BaseModel):\nfilename:str\ncontent_type:str\nsize:int\nattachment_id:str\n\n\nclass Email(BaseModel):\nid:str\nsubject:str\nsnippet:str\nfrom_:str\nto:str\ndate:str\nbody:str=\"\"#Default to an empty string\nsizeEstimate:int\nattachments:List[Attachment]\n\n\nclass GmailReadBlock(Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.readonly\"]\n)\nquery:str=SchemaField(\ndescription=\"Search query for reading emails\",\ndefault=\"is:unread\",\n)\nmax_results:int=SchemaField(\ndescription=\"Maximum number of emails to retrieve\",\ndefault=10,\n)\n\nclass Output(BlockSchema):\nemail:Email=SchemaField(\ndescription=\"Email data\",\n)\nemails:list[Email]=SchemaField(\ndescription=\"List of email data\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"25310c70-b89b-43ba-b25c-4dfa7e2a481c\",\ndescription=\"This block reads emails from Gmail.\",\ncategories={BlockCategory.COMMUNICATION},\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ninput_schema=GmailReadBlock.Input,\noutput_schema=GmailReadBlock.Output,\ntest_input={\n\"query\":\"is:unread\",\n\"max_results\":5,\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"email\",\n{\n\"id\":\"1\",\n\"subject\":\"Test Email\",\n\"snippet\":\"This is a test email\",\n\"from_\":\"test@example.com\",\n\"to\":\"recipient@example.com\",\n\"date\":\"2024-01-01\",\n\"body\":\"This is a test email\",\n\"sizeEstimate\":100,\n\"attachments\":[],\n},\n),\n(\n\"emails\",\n[\n{\n\"id\":\"1\",\n\"subject\":\"Test Email\",\n\"snippet\":\"This is a test email\",\n\"from_\":\"test@example.com\",\n\"to\":\"recipient@example.com\",\n\"date\":\"2024-01-01\",\n\"body\":\"This is a test email\",\n\"sizeEstimate\":100,\n\"attachments\":[],\n}\n],\n),\n],\ntest_mock={\n\"_read_emails\":lambda*args,**kwargs:[\n{\n\"id\":\"1\",\n\"subject\":\"Test Email\",\n\"snippet\":\"This is a test email\",\n\"from_\":\"test@example.com\",\n\"to\":\"recipient@example.com\",\n\"date\":\"2024-01-01\",\n\"body\":\"This is a test email\",\n\"sizeEstimate\":100,\n\"attachments\":[],\n}\n],\n\"_send_email\":lambda*args,**kwargs:{\"id\":\"1\",\"status\":\"sent\"},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=self._build_service(credentials,**kwargs)\nmessages=self._read_emails(service,input_data.query,input_data.max_results)\nfor email in messages:\nyield \"email\",email\nyield \"emails\",messages\n\n@staticmethod\ndef _build_service(credentials:GoogleCredentials,**kwargs):\ncreds=Credentials(\ntoken=(\ncredentials.access_token.get_secret_value()\nif credentials.access_token\nelse None\n),\nrefresh_token=(\ncredentials.refresh_token.get_secret_value()\nif credentials.refresh_token\nelse None\n),\ntoken_uri=\"https://oauth2.googleapis.com/token\",\nclient_id=kwargs.get(\"client_id\"),\nclient_secret=kwargs.get(\"client_secret\"),\nscopes=credentials.scopes,\n)\nreturn build(\"gmail\",\"v1\",credentials=creds)\n\ndef _read_emails(\nself,service,query:str|None,max_results:int|None\n)->list[Email]:\nresults=(\nservice.users()\n.messages()\n.list(userId=\"me\",q=query or\"\",maxResults=max_results or10)\n.execute()\n)\nmessages=results.get(\"messages\",[])\n\nemail_data=[]\nfor message in messages:\nmsg=(\nservice.users()\n.messages()\n.get(userId=\"me\",id=message[\"id\"],format=\"full\")\n.execute()\n)\n\nheaders={\nheader[\"name\"].lower():header[\"value\"]\nfor header in msg[\"payload\"][\"headers\"]\n}\n\nattachments=self._get_attachments(service,msg)\n\nemail=Email(\nid=msg[\"id\"],\nsubject=headers.get(\"subject\",\"No Subject\"),\nsnippet=msg[\"snippet\"],\nfrom_=parseaddr(headers.get(\"from\",\"\"))[1],\nto=parseaddr(headers.get(\"to\",\"\"))[1],\ndate=headers.get(\"date\",\"\"),\nbody=self._get_email_body(msg),\nsizeEstimate=msg[\"sizeEstimate\"],\nattachments=attachments,\n)\nemail_data.append(email)\n\nreturn email_data\n\ndef _get_email_body(self,msg):\nif \"parts\" in msg[\"payload\"]:\nfor part in msg[\"payload\"][\"parts\"]:\nif part[\"mimeType\"]==\"text/plain\":\nreturn base64.urlsafe_b64decode(part[\"body\"][\"data\"]).decode(\n\"utf-8\"\n)\nelif msg[\"payload\"][\"mimeType\"]==\"text/plain\":\nreturn base64.urlsafe_b64decode(msg[\"payload\"][\"body\"][\"data\"]).decode(\n\"utf-8\"\n)\n\nreturn \"This email does not contain a text body.\"\n\ndef _get_attachments(self,service,message):\nattachments=[]\nif \"parts\" in message[\"payload\"]:\nfor part in message[\"payload\"][\"parts\"]:\nif part[\"filename\"]:\nattachment=Attachment(\nfilename=part[\"filename\"],\ncontent_type=part[\"mimeType\"],\nsize=int(part[\"body\"].get(\"size\",0)),\nattachment_id=part[\"body\"][\"attachmentId\"],\n)\nattachments.append(attachment)\nreturn attachments\n\n#Add a new method to download attachment content\ndef download_attachment(self,service,message_id:str,attachment_id:str):\nattachment=(\nservice.users()\n.messages()\n.attachments()\n.get(userId=\"me\",messageId=message_id,id=attachment_id)\n.execute()\n)\nfile_data=base64.urlsafe_b64decode(attachment[\"data\"].encode(\"UTF-8\"))\nreturn file_data\n\n\nclass GmailSendBlock(Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.send\"]\n)\nto:str=SchemaField(\ndescription=\"Recipient email address\",\n)\nsubject:str=SchemaField(\ndescription=\"Email subject\",\n)\nbody:str=SchemaField(\ndescription=\"Email body\",\n)\n\nclass Output(BlockSchema):\nresult:dict=SchemaField(\ndescription=\"Send confirmation\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"6c27abc2-e51d-499e-a85f-5a0041ba94f0\",\ndescription=\"This block sends an email using Gmail.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailSendBlock.Input,\noutput_schema=GmailSendBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"to\":\"recipient@example.com\",\n\"subject\":\"Test Email\",\n\"body\":\"This is a test email sent from GmailSendBlock.\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\"result\",{\"id\":\"1\",\"status\":\"sent\"}),\n],\ntest_mock={\n\"_send_email\":lambda*args,**kwargs:{\"id\":\"1\",\"status\":\"sent\"},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock._build_service(credentials,**kwargs)\nsend_result=self._send_email(\nservice,input_data.to,input_data.subject,input_data.body\n)\nyield \"result\",send_result\n\ndef _send_email(self,service,to:str,subject:str,body:str)->dict:\nif not to or not subject or not body:\nraise ValueError(\"To, subject, and body are required for sending an email\")\nmessage=self._create_message(to,subject,body)\nsent_message=(\nservice.users().messages().send(userId=\"me\",body=message).execute()\n)\nreturn{\"id\":sent_message[\"id\"],\"status\":\"sent\"}\n\ndef _create_message(self,to:str,subject:str,body:str)->dict:\nimport base64\nfrom email.mime.text import MIMEText\n\nmessage=MIMEText(body)\nmessage[\"to\"]=to\nmessage[\"subject\"]=subject\nraw_message=base64.urlsafe_b64encode(message.as_bytes()).decode(\"utf-8\")\nreturn{\"raw\":raw_message}\n\n\nclass GmailListLabelsBlock(Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.labels\"]\n)\n\nclass Output(BlockSchema):\nresult:list[dict]=SchemaField(\ndescription=\"List of labels\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"3e1c2c1c-c689-4520-b956-1f3bf4e02bb7\",\ndescription=\"This block lists all labels in Gmail.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailListLabelsBlock.Input,\noutput_schema=GmailListLabelsBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n[\n{\"id\":\"Label_1\",\"name\":\"Important\"},\n{\"id\":\"Label_2\",\"name\":\"Work\"},\n],\n),\n],\ntest_mock={\n\"_list_labels\":lambda*args,**kwargs:[\n{\"id\":\"Label_1\",\"name\":\"Important\"},\n{\"id\":\"Label_2\",\"name\":\"Work\"},\n],\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock._build_service(credentials,**kwargs)\nlabels=self._list_labels(service)\nyield \"result\",labels\n\ndef _list_labels(self,service)->list[dict]:\nresults=service.users().labels().list(userId=\"me\").execute()\nlabels=results.get(\"labels\",[])\nreturn[{\"id\":label[\"id\"],\"name\":label[\"name\"]}for label in labels]\n\n\nclass GmailAddLabelBlock(Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.modify\"]\n)\nmessage_id:str=SchemaField(\ndescription=\"Message ID to add label to\",\n)\nlabel_name:str=SchemaField(\ndescription=\"Label name to add\",\n)\n\nclass Output(BlockSchema):\nresult:dict=SchemaField(\ndescription=\"Label addition result\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"f884b2fb-04f4-4265-9658-14f433926ac9\",\ndescription=\"This block adds a label to a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailAddLabelBlock.Input,\noutput_schema=GmailAddLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":\"Important\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label added successfully\",\"label_id\":\"Label_1\"},\n),\n],\ntest_mock={\n\"_add_label\":lambda*args,**kwargs:{\n\"status\":\"Label added successfully\",\n\"label_id\":\"Label_1\",\n},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock._build_service(credentials,**kwargs)\nresult=self._add_label(service,input_data.message_id,input_data.label_name)\nyield \"result\",result\n\ndef _add_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_or_create_label(service,label_name)\nservice.users().messages().modify(\nuserId=\"me\",id=message_id,body={\"addLabelIds\":[label_id]}\n).execute()\nreturn{\"status\":\"Label added successfully\",\"label_id\":label_id}\n\ndef _get_or_create_label(self,service,label_name:str)->str:\nlabel_id=self._get_label_id(service,label_name)\nif not label_id:\nlabel=(\nservice.users()\n.labels()\n.create(userId=\"me\",body={\"name\":label_name})\n.execute()\n)\nlabel_id=label[\"id\"]\nreturn label_id\n\ndef _get_label_id(self,service,label_name:str)->str|None:\nresults=service.users().labels().list(userId=\"me\").execute()\nlabels=results.get(\"labels\",[])\nfor label in labels:\nif label[\"name\"]==label_name:\nreturn label[\"id\"]\nreturn None\n\n\nclass GmailRemoveLabelBlock(Block):\nclass Input(BlockSchema):\ncredentials:GoogleCredentialsInput=GoogleCredentialsField(\n[\"https://www.googleapis.com/auth/gmail.modify\"]\n)\nmessage_id:str=SchemaField(\ndescription=\"Message ID to remove label from\",\n)\nlabel_name:str=SchemaField(\ndescription=\"Label name to remove\",\n)\n\nclass Output(BlockSchema):\nresult:dict=SchemaField(\ndescription=\"Label removal result\",\n)\nerror:str=SchemaField(\ndescription=\"Error message if any\",\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"0afc0526-aba1-4b2b-888e-a22b7c3f359d\",\ndescription=\"This block removes a label from a Gmail message.\",\ncategories={BlockCategory.COMMUNICATION},\ninput_schema=GmailRemoveLabelBlock.Input,\noutput_schema=GmailRemoveLabelBlock.Output,\ndisabled=not GOOGLE_OAUTH_IS_CONFIGURED,\ntest_input={\n\"message_id\":\"12345\",\n\"label_name\":\"Important\",\n\"credentials\":TEST_CREDENTIALS_INPUT,\n},\ntest_credentials=TEST_CREDENTIALS,\ntest_output=[\n(\n\"result\",\n{\"status\":\"Label removed successfully\",\"label_id\":\"Label_1\"},\n),\n],\ntest_mock={\n\"_remove_label\":lambda*args,**kwargs:{\n\"status\":\"Label removed successfully\",\n\"label_id\":\"Label_1\",\n},\n},\n)\n\ndef run(\nself,input_data:Input,*,credentials:GoogleCredentials,**kwargs\n)->BlockOutput:\nservice=GmailReadBlock._build_service(credentials,**kwargs)\nresult=self._remove_label(\nservice,input_data.message_id,input_data.label_name\n)\nyield \"result\",result\n\ndef _remove_label(self,service,message_id:str,label_name:str)->dict:\nlabel_id=self._get_label_id(service,label_name)\nif label_id:\nservice.users().messages().modify(\nuserId=\"me\",id=message_id,body={\"removeLabelIds\":[label_id]}\n).execute()\nreturn{\"status\":\"Label removed successfully\",\"label_id\":label_id}\nelse:\nreturn{\"status\":\"Label not found\",\"label_name\":label_name}\n\ndef _get_label_id(self,service,label_name:str)->str|None:\nresults=service.users().labels().list(userId=\"me\").execute("
}
{
    "type": "Program",
    "name": "Global",
    "range": [
        28,
        1282
    ],
    "children": [
        {
            "type": "ClassDecl",
            "name": "ReadCsvBlock",
            "range": [
                28,
                174
            ],
            "children": [
                {
                    "type": "ClassDecl",
                    "name": "Input",
                    "range": [
                        35,
                        174
                    ],
                    "children": [
                        {
                            "type": "FieldDecl",
                            "name": "contents",
                            "range": [
                                42,
                                59
                            ],
                            "children": [],
                            "content": "contents:str=SchemaField(\ndescription=\"The contents of the CSV file to read\",\nplaceholder=\"a, b, c\\n1,2,3\\n4,5,6\",\n)"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "delimiter",
                            "range": [
                                61,
                                78
                            ],
                            "children": [],
                            "content": "delimiter:str=SchemaField(\ndescription=\"The delimiter used in the CSV file\",\ndefault=\",\",\n)"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "quotechar",
                            "range": [
                                80,
                                97
                            ],
                            "children": [],
                            "content": "quotechar:str=SchemaField(\ndescription=\"The character used to quote fields\",\ndefault='\"',\n)"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "escapechar",
                            "range": [
                                99,
                                116
                            ],
                            "children": [],
                            "content": "escapechar:str=SchemaField(\ndescription=\"The character used to escape the delimiter\",\ndefault=\"\\\\\",\n)"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "has_header",
                            "range": [
                                118,
                                135
                            ],
                            "children": [],
                            "content": "has_header:bool=SchemaField(\ndescription=\"Whether the CSV file has a header row\",\ndefault=True,\n)"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "skip_rows",
                            "range": [
                                137,
                                154
                            ],
                            "children": [],
                            "content": "skip_rows:int=SchemaField(\ndescription=\"The number of rows to skip from the start of the file\",\ndefault=0,\n)"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "strip",
                            "range": [
                                156,
                                173
                            ],
                            "children": [],
                            "content": "strip:bool=SchemaField(\ndescription=\"Whether to strip whitespace from the values\",\ndefault=True,\n)"
                        },
                        {
                            "type": "FieldDecl",
                            "name": "skip_columns",
                            "range": [
                                175,
                                196
                            ],
                            "children": [],
                            "content": "skip_columns:list[str]=SchemaField(\ndescription=\"The columns to skip from the start of the row\",\ndefault=[],\n)"
                        }
                    ],
                    "content": "class Input(BlockSchema):\ncontents:str=SchemaField(\ndescription=\"The contents of the CSV file to read\",\nplaceholder=\"a, b, c\\n1,2,3\\n4,5,6\",\n)\ndelimiter:str=SchemaField(\ndescription=\"The delimiter used in the CSV file\",\ndefault=\",\",\n)\nquotechar:str=SchemaField(\ndescription=\"The character used to quote fields\",\ndefault='\"',\n)\nescapechar:str=SchemaField(\ndescription=\"The character used to escape the delimiter\",\ndefault=\"\\\\\",\n)\nhas_header:bool=SchemaField(\ndescription=\"Whether the CSV file has a header row\",\ndefault=True,\n)\nskip_rows:int=SchemaField(\ndescription=\"The number of rows to skip from the start of the file\",\ndefault=0,\n)\nstrip:bool=SchemaField(\ndescription=\"Whether to strip whitespace from the values\",\ndefault=True,\n)\n"
                }
            ],
            "content": "class ReadCsvBlock(Block):\nclass Input(BlockSchema):\ncontents:str=SchemaField(\ndescription=\"The contents of the CSV file to read\",\nplaceholder=\"a, b, c\\n1,2,3\\n4,5,6\",\n)\ndelimiter:str=SchemaField(\ndescription=\"The delimiter used in the CSV file\",\ndefault=\",\",\n)\nquotechar:str=SchemaField(\ndescription=\"The character used to quote fields\",\ndefault='\"',\n)\nescapechar:str=SchemaField(\ndescription=\"The character used to escape the delimiter\",\ndefault=\"\\\\\",\n)\nhas_header:bool=SchemaField(\ndescription=\"Whether the CSV file has a header row\",\ndefault=True,\n)\nskip_rows:int=SchemaField(\ndescription=\"The number of rows to skip from the start of the file\",\ndefault=0,\n)\nstrip:bool=SchemaField(\ndescription=\"Whether to strip whitespace from the values\",\ndefault=True,\n)\n"
        },
        {
            "type": "ClassDecl",
            "name": "Output",
            "range": [
                199,
                244
            ],
            "children": [
                {
                    "type": "FieldDecl",
                    "name": "row",
                    "range": [
                        206,
                        222
                    ],
                    "children": [],
                    "content": "row:dict[str,str]=SchemaField(\ndescription=\"The data produced from each row in the CSV file\"\n)"
                },
                {
                    "type": "FieldDecl",
                    "name": "all_data",
                    "range": [
                        224,
                        243
                    ],
                    "children": [],
                    "content": "all_data:list[dict[str,str]]=SchemaField(\ndescription=\"All the data in the CSV file as a list of rows\"\n)"
                }
            ],
            "content": "class Output(BlockSchema):\nrow:dict[str,str]=SchemaField(\ndescription=\"The data produced from each row in the CSV file\"\n)\nall_data:list[dict[str,str]]=SchemaField(\ndescription=\"All the data in the CSV file as a list of rows\"\n)\n"
        },
        {
            "type": "FunctionDecl",
            "name": "__init__",
            "range": [
                246,
                410
            ],
            "children": [
                {
                    "type": "SuperCall",
                    "name": "",
                    "range": [
                        253,
                        259
                    ],
                    "children": [],
                    "content": "super().__init__(\n"
                },
                {
                    "type": "Assignment",
                    "name": "id",
                    "range": [
                        260,
                        262
                    ],
                    "children": [],
                    "content": "id=\"acf7625e-d2cb-4941-bfeb-2819fc6fc015\""
                },
                {
                    "type": "Assignment",
                    "name": "input_schema",
                    "range": [
                        265,
                        270
                    ],
                    "children": [],
                    "content": "input_schema=ReadCsvBlock.Input,"
                },
                {
                    "type": "Assignment",
                    "name": "output_schema",
                    "range": [
                        272,
                        276
                    ],
                    "children": [],
                    "content": "output_schema=ReadCsvBlock.Output"
                },
                {
                    "type": "Assignment",
                    "name": "description",
                    "range": [
                        279,
                        281
                    ],
                    "children": [],
                    "content": "description=\"Reads a CSV file and outputs the data as a list of dictionaries and individual rows via rows.\""
                },
                {
                    "type": "Assignment",
                    "name": "contributors",
                    "range": [
                        284,
                        293
                    ],
                    "children": [],
                    "content": "contributors=[ContributorDetails(name=\"Nicholas Tindle\")]"
                },
                {
                    "type": "Assignment",
                    "name": "categories",
                    "range": [
                        296,
                        306
                    ],
                    "children": [],
                    "content": "categories={BlockCategory.TEXT,BlockCategory.DATA}"
                },
                {
                    "type": "Assignment",
                    "name": "test_input",
                    "range": [
                        309,
                        318
                    ],
                    "children": [],
                    "content": "test_input={\n\"contents\":\"a, b, c\\n1,2,3\\n4,5,6\",\n}"
                },
                {
                    "type": "Assignment",
                    "name": "test_output",
                    "range": [
                        321,
                        406
                    ],
                    "children": [],
                    "content": "test_output=[\n(\"row\",{\"a\":\"1\",\"b\":\"2\",\"c\":\"3\"}),\n(\"row\",{\"a\":\"4\",\"b\":\"5\",\"c\":\"6\"}),\n(\n\"all_data\",\n[\n{\"a\":\"1\",\"b\":\"2\",\"c\":\"3\"},\n{\"a\":\"4\",\"b\":\"5\",\"c\":\"6\"},\n],\n),\n]"
                }
            ],
            "content": "def __init__(self):\nsuper().__init__(\nid=\"acf7625e-d2cb-4941-bfeb-2819fc6fc015\",\ninput_schema=ReadCsvBlock.Input,\noutput_schema=ReadCsvBlock.Output,\ndescription=\"Reads a CSV file and outputs the data as a list of dictionaries and individual rows via rows.\",\ncontributors=[ContributorDetails(name=\"Nicholas Tindle\")],\ncategories={BlockCategory.TEXT,BlockCategory.DATA},\ntest_input={\n\"contents\":\"a, b, c\\n1,2,3\\n4,5,6\",\n},\ntest_output=[\n(\"row\",{\"a\":\"1\",\"b\":\"2\",\"c\":\"3\"}),\n(\"row\",{\"a\":\"4\",\"b\":\"5\",\"c\":\"6\"}),\n(\n\"all_data\",\n[\n{\"a\":\"1\",\"b\":\"2\",\"c\":\"3\"},\n{\"a\":\"4\",\"b\":\"5\",\"c\":\"6\"},\n],\n),\n],\n)\n"
        },
        {
            "type": "FunctionDecl",
            "name": "run",
            "range": [
                412,
                660
            ],
            "children": [
                {
                    "type": "ImportStatement",
                    "name": "csv",
                    "range": [
                        430,
                        431
                    ],
                    "children": [],
                    "content": "import csv"
                },
                {
                    "type": "ImportStatement",
                    "name": "StringIO",
                    "range": [
                        433,
                        436
                    ],
                    "children": [],
                    "content": "from io import StringIO"
                },
                {
                    "type": "VariableDecl",
                    "name": "csv_file",
                    "range": [
                        439,
                        446
                    ],
                    "children": [],
                    "content": "csv_file=StringIO(input_data.contents)"
                },
                {
                    "type": "VariableDecl",
                    "name": "reader",
                    "range": [
                        448,
                        479
                    ],
                    "children": [],
                    "content": "reader=csv.reader(\ncsv_file,\ndelimiter=input_data.delimiter,\nquotechar=input_data.quotechar,\nescapechar=input_data.escapechar,\n)"
                },
                {
                    "type": "VariableDecl",
                    "name": "header",
                    "range": [
                        482,
                        484
                    ],
                    "children": [],
                    "content": "header=None"
                },
                {
                    "type": "IfStatement",
                    "name": "",
                    "range": [
                        486,
                        498
                    ],
                    "children": [],
                    "content": "if input_data.has_header:\nheader=next(reader)\n"
                },
                {
                    "type": "IfStatement",
                    "name": "",
                    "range": [
                        499,
                        518
                    ],
                    "children": [],
                    "content": "if input_data.strip:\nheader=[h.strip()for h in header]\n"
                },
                {
                    "type": "ForStatement",
                    "name": "",
                    "range": [
                        520,
                        535
                    ],
                    "children": [],
                    "content": "for _ in range(input_data.skip_rows):\nnext(reader)\n"
                },
                {
                    "type": "FunctionDecl",
                    "name": "process_row",
                    "range": [
                        537,
                        622
                    ],
                    "children": [],
                    "content": "def process_row(row):\ndata={}\nfor i,value in enumerate(row):\nif i not in input_data.skip_columns:\nif input_data.has_header and header:\ndata[header[i]]=value.strip()if input_data.strip else value\nelse:\ndata[str(i)]=value.strip()if input_data.strip else value\nreturn data\n"
                },
                {
                    "type": "VariableDecl",
                    "name": "all_data",
                    "range": [
                        624,
                        626
                    ],
                    "children": [],
                    "content": "all_data=["
                },
                {
                    "type": "ForStatement",
                    "name": "",
                    "range": [
                        629,
                        648
                    ],
                    "children": [],
                    "content": "for row in reader:\nprocessed_row=process_row(row)\nall_data.append(processed_row)\n"
                },
                {
                    "type": "YieldStatement",
                    "name": "",
                    "range": [
                        649,
                        653
                    ],
                    "children": [],
                    "content": "yield \"row\",processed_row\n"
                },
                {
                    "type": "YieldStatement",
                    "name": "",
                    "range": [
                        655,
                        659
                    ],
                    "children": [],
                    "content": "yield \"all_data\",all_data\n"
                }
            ],
            "content": "def run(self,input_data:Input,**kwargs)->BlockOutput:\nimport csv\nfrom io import StringIO\n\ncsv_file=StringIO(input_data.contents)\nreader=csv.reader(\ncsv_file,\ndelimiter=input_data.delimiter,\nquotechar=input_data.quotechar,\nescapechar=input_data.escapechar,\n)\n\nheader=None\nif input_data.has_header:\nheader=next(reader)\nif input_data.strip:\nheader=[h.strip()for h in header]\n\nfor _ in range(input_data.skip_rows):\nnext(reader)\n\ndef process_row(row):\ndata={}\nfor i,value in enumerate(row):\nif i not in input_data.skip_columns:\nif input_data.has_header and header:\ndata[header[i]]=value.strip()if input_data.strip else value\nelse:\ndata[str(i)]=value.strip()if input_data.strip else value\nreturn data\n\nall_data=[]\nfor row in reader:\nprocessed_row=process_row(row)\nall_data.append(processed_row)\nyield \"row\",processed_row\n\nyield \"all_data\",all_data\n"
        },
        {
            "type": "ClassDecl",
            "name": "Input",
            "range": [
                661,
                823
            ],
            "children": [
                {
                    "type": "FieldDecl",
                    "name": "contents",
                    "range": [
                        668,
                        685
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                669,
                                670
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                671,
                                672
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        672,
                                        685
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                675,
                                                677
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "placeholder",
                                            "range": [
                                                680,
                                                682
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "FieldDecl",
                    "name": "delimiter",
                    "range": [
                        687,
                        704
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                688,
                                689
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                690,
                                691
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        691,
                                        704
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                694,
                                                696
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "default",
                                            "range": [
                                                699,
                                                701
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "FieldDecl",
                    "name": "quotechar",
                    "range": [
                        706,
                        723
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                707,
                                708
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                709,
                                710
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        710,
                                        723
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                713,
                                                715
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "default",
                                            "range": [
                                                718,
                                                720
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "FieldDecl",
                    "name": "escapechar",
                    "range": [
                        725,
                        742
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "str",
                            "range": [
                                726,
                                727
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                728,
                                729
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        729,
                                        742
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                732,
                                                734
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "default",
                                            "range": [
                                                737,
                                                739
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "FieldDecl",
                    "name": "has_header",
                    "range": [
                        744,
                        761
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "bool",
                            "range": [
                                745,
                                746
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                747,
                                748
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        748,
                                        761
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                751,
                                                753
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "default",
                                            "range": [
                                                756,
                                                758
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "FieldDecl",
                    "name": "skip_rows",
                    "range": [
                        763,
                        780
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "int",
                            "range": [
                                764,
                                765
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                766,
                                767
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        767,
                                        780
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                770,
                                                772
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "default",
                                            "range": [
                                                775,
                                                777
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "FieldDecl",
                    "name": "strip",
                    "range": [
                        782,
                        799
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "bool",
                            "range": [
                                783,
                                784
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                785,
                                786
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        786,
                                        799
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                789,
                                                791
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "default",
                                            "range": [
                                                794,
                                                796
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "FieldDecl",
                    "name": "skip_columns",
                    "range": [
                        801,
                        822
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "list",
                            "range": [
                                802,
                                806
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Assignment",
                            "name": "=",
                            "range": [
                                807,
                                808
                            ],
                            "children": [
                                {
                                    "type": "SchemaField",
                                    "name": "SchemaField",
                                    "range": [
                                        808,
                                        822
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                811,
                                                813
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "default",
                                            "range": [
                                                816,
                                                818
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "ClassDecl",
            "name": "Output",
            "range": [
                824,
                869
            ],
            "children": [
                {
                    "type": "VariableDecl",
                    "name": "row",
                    "range": [
                        831,
                        847
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "dict[str, str]",
                            "range": [
                                833,
                                838
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "=",
                            "range": [
                                839,
                                847
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "SchemaField",
                                    "range": [
                                        840,
                                        847
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                843,
                                                845
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"The data produced from each row in the CSV file\"",
                                                    "range": [
                                                        845,
                                                        845
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "VariableDecl",
                    "name": "all_data",
                    "range": [
                        849,
                        868
                    ],
                    "children": [
                        {
                            "type": "TypeAnnotation",
                            "name": "list[dict[str, str]]",
                            "range": [
                                851,
                                859
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "=",
                            "range": [
                                860,
                                868
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "SchemaField",
                                    "range": [
                                        861,
                                        868
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                864,
                                                866
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"All the data in the CSV file as a list of rows\"",
                                                    "range": [
                                                        866,
                                                        866
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "FunctionDecl",
            "name": "__init__",
            "range": [
                870,
                1034
            ],
            "children": [
                {
                    "type": "ParameterList",
                    "name": "self",
                    "range": [
                        872,
                        874
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        875,
                        1034
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "SuperCall",
                            "range": [
                                877,
                                882
                            ],
                            "children": [
                                {
                                    "type": "ArgumentList",
                                    "name": "",
                                    "range": [
                                        878,
                                        879
                                    ],
                                    "children": [],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "id",
                            "range": [
                                884,
                                886
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "input_schema",
                            "range": [
                                889,
                                894
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "output_schema",
                            "range": [
                                896,
                                901
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "description",
                            "range": [
                                903,
                                906
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "contributors",
                            "range": [
                                908,
                                918
                            ],
                            "children": [
                                {
                                    "type": "ArrayExpression",
                                    "name": "",
                                    "range": [
                                        910,
                                        917
                                    ],
                                    "children": [
                                        {
                                            "type": "ObjectExpression",
                                            "name": "ContributorDetails",
                                            "range": [
                                                911,
                                                916
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "name",
                                                    "range": [
                                                        913,
                                                        915
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "categories",
                            "range": [
                                920,
                                931
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        922,
                                        930
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "BlockCategory.TEXT",
                                            "range": [
                                                923,
                                                925
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "Property",
                                            "name": "BlockCategory.DATA",
                                            "range": [
                                                927,
                                                929
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "test_input",
                            "range": [
                                933,
                                943
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        935,
                                        942
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "contents",
                                            "range": [
                                                937,
                                                939
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "AssignmentExpression",
                            "name": "test_output",
                            "range": [
                                945,
                                1031
                            ],
                            "children": [
                                {
                                    "type": "ArrayExpression",
                                    "name": "",
                                    "range": [
                                        947,
                                        1030
                                    ],
                                    "children": [
                                        {
                                            "type": "TupleExpression",
                                            "name": "",
                                            "range": [
                                                949,
                                                965
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "row",
                                                    "range": [
                                                        950,
                                                        950
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                },
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        952,
                                                        964
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "a",
                                                            "range": [
                                                                953,
                                                                955
                                                            ],
                                                            "children": [],
                                                            "content": ""
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "b",
                                                            "range": [
                                                                957,
                                                                959
                                                            ],
                                                            "children": [],
                                                            "content": ""
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "c",
                                                            "range": [
                                                                961,
                                                                963
                                                            ],
                                                            "children": [],
                                                            "content": ""
                                                        }
                                                    ],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        },
                                        {
                                            "type": "TupleExpression",
                                            "name": "",
                                            "range": [
                                                968,
                                                984
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "row",
                                                    "range": [
                                                        969,
                                                        969
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                },
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        971,
                                                        983
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "a",
                                                            "range": [
                                                                972,
                                                                974
                                                            ],
                                                            "children": [],
                                                            "content": ""
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "b",
                                                            "range": [
                                                                976,
                                                                978
                                                            ],
                                                            "children": [],
                                                            "content": ""
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "c",
                                                            "range": [
                                                                980,
                                                                982
                                                            ],
                                                            "children": [],
                                                            "content": ""
                                                        }
                                                    ],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        },
                                        {
                                            "type": "TupleExpression",
                                            "name": "",
                                            "range": [
                                                987,
                                                1027
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "all_data",
                                                    "range": [
                                                        989,
                                                        989
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                },
                                                {
                                                    "type": "ArrayExpression",
                                                    "name": "",
                                                    "range": [
                                                        992,
                                                        1024
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "ObjectExpression",
                                                            "name": "",
                                                            "range": [
                                                                994,
                                                                1006
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Property",
                                                                    "name": "a",
                                                                    "range": [
                                                                        995,
                                                                        997
                                                                    ],
                                                                    "children": [],
                                                                    "content": ""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "b",
                                                                    "range": [
                                                                        999,
                                                                        1001
                                                                    ],
                                                                    "children": [],
                                                                    "content": ""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "c",
                                                                    "range": [
                                                                        1003,
                                                                        1005
                                                                    ],
                                                                    "children": [],
                                                                    "content": ""
                                                                }
                                                            ],
                                                            "content": ""
                                                        },
                                                        {
                                                            "type": "ObjectExpression",
                                                            "name": "",
                                                            "range": [
                                                                1009,
                                                                1021
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Property",
                                                                    "name": "a",
                                                                    "range": [
                                                                        1010,
                                                                        1012
                                                                    ],
                                                                    "children": [],
                                                                    "content": ""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "b",
                                                                    "range": [
                                                                        1014,
                                                                        1016
                                                                    ],
                                                                    "children": [],
                                                                    "content": ""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "c",
                                                                    "range": [
                                                                        1018,
                                                                        1020
                                                                    ],
                                                                    "children": [],
                                                                    "content": ""
                                                                }
                                                            ],
                                                            "content": ""
                                                        }
                                                    ],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "FunctionDecl",
            "name": "run",
            "range": [
                1035,
                1051
            ],
            "children": [
                {
                    "type": "ParameterList",
                    "name": "",
                    "range": [
                        1037,
                        1047
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "self",
                            "range": [
                                1038,
                                1038
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Parameter",
                            "name": "input_data",
                            "range": [
                                1040,
                                1040
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "Parameter",
                            "name": "kwargs",
                            "range": [
                                1046,
                                1046
                            ],
                            "children": [],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "ReturnType",
                    "name": "BlockOutput",
                    "range": [
                        1048,
                        1050
                    ],
                    "children": [],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "ImportDecl",
            "name": "",
            "range": [
                1053,
                1055
            ],
            "children": [
                {
                    "type": "ImportedModule",
                    "name": "csv",
                    "range": [
                        1054,
                        1054
                    ],
                    "children": [],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "ImportDecl",
            "name": "",
            "range": [
                1056,
                1060
            ],
            "children": [
                {
                    "type": "ImportedModule",
                    "name": "io",
                    "range": [
                        1057,
                        1057
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "ImportedModule",
                    "name": "StringIO",
                    "range": [
                        1059,
                        1059
                    ],
                    "children": [],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "VariableDecl",
            "name": "csv_file",
            "range": [
                1062,
                1069
            ],
            "children": [
                {
                    "type": "Assignment",
                    "name": "",
                    "range": [
                        1063,
                        1069
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "StringIO",
                            "range": [
                                1064,
                                1069
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "input_data.contents",
                                    "range": [
                                        1066,
                                        1068
                                    ],
                                    "children": [],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "VariableDecl",
            "name": "reader",
            "range": [
                1071,
                1102
            ],
            "children": [
                {
                    "type": "Assignment",
                    "name": "",
                    "range": [
                        1072,
                        1102
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "csv.reader",
                            "range": [
                                1073,
                                1102
                            ],
                            "children": [
                                {
                                    "type": "Argument",
                                    "name": "csv_file",
                                    "range": [
                                        1078,
                                        1078
                                    ],
                                    "children": [],
                                    "content": ""
                                },
                                {
                                    "type": "KeywordArgument",
                                    "name": "delimiter",
                                    "range": [
                                        1081,
                                        1085
                                    ],
                                    "children": [],
                                    "content": ""
                                },
                                {
                                    "type": "KeywordArgument",
                                    "name": "quotechar",
                                    "range": [
                                        1088,
                                        1092
                                    ],
                                    "children": [],
                                    "content": ""
                                },
                                {
                                    "type": "KeywordArgument",
                                    "name": "escapechar",
                                    "range": [
                                        1095,
                                        1099
                                    ],
                                    "children": [],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "VariableDecl",
            "name": "header",
            "range": [
                1105,
                1107
            ],
            "children": [
                {
                    "type": "Assignment",
                    "name": "",
                    "range": [
                        1106,
                        1107
                    ],
                    "children": [
                        {
                            "type": "Literal",
                            "name": "None",
                            "range": [
                                1107,
                                1107
                            ],
                            "children": [],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "IfStatement",
            "name": "",
            "range": [
                1109,
                1121
            ],
            "children": [
                {
                    "type": "Condition",
                    "name": "input_data.has_header",
                    "range": [
                        1110,
                        1112
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        1113,
                        1121
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "header",
                            "range": [
                                1115,
                                1120
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "next",
                                    "range": [
                                        1117,
                                        1120
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "reader",
                                            "range": [
                                                1119,
                                                1119
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "IfStatement",
            "name": "",
            "range": [
                1122,
                1141
            ],
            "children": [
                {
                    "type": "Condition",
                    "name": "input_data.strip",
                    "range": [
                        1123,
                        1125
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        1126,
                        1141
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "header",
                            "range": [
                                1128,
                                1140
                            ],
                            "children": [
                                {
                                    "type": "ListComprehension",
                                    "name": "",
                                    "range": [
                                        1130,
                                        1140
                                    ],
                                    "children": [
                                        {
                                            "type": "Expression",
                                            "name": "h.strip()",
                                            "range": [
                                                1131,
                                                1135
                                            ],
                                            "children": [],
                                            "content": ""
                                        },
                                        {
                                            "type": "ForStatement",
                                            "name": "",
                                            "range": [
                                                1136,
                                                1139
                                            ],
                                            "children": [
                                                {
                                                    "type": "VariableDecl",
                                                    "name": "h",
                                                    "range": [
                                                        1137,
                                                        1137
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                },
                                                {
                                                    "type": "Expression",
                                                    "name": "header",
                                                    "range": [
                                                        1139,
                                                        1139
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "ForStatement",
            "name": "",
            "range": [
                1143,
                1158
            ],
            "children": [
                {
                    "type": "Initialization",
                    "name": "_",
                    "range": [
                        1144,
                        1144
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "Condition",
                    "name": "range(input_data.skip_rows)",
                    "range": [
                        1146,
                        1151
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        1152,
                        1158
                    ],
                    "children": [
                        {
                            "type": "ExpressionStatement",
                            "name": "next(reader)",
                            "range": [
                                1154,
                                1157
                            ],
                            "children": [],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "FunctionDecl",
            "name": "process_row",
            "range": [
                1160,
                1245
            ],
            "children": [
                {
                    "type": "ParameterList",
                    "name": "",
                    "range": [
                        1162,
                        1164
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "row",
                            "range": [
                                1163,
                                1163
                            ],
                            "children": [],
                            "content": ""
                        }
                    ],
                    "content": ""
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        1165,
                        1245
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "data",
                            "range": [
                                1167,
                                1170
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "",
                                    "range": [
                                        1168,
                                        1170
                                    ],
                                    "children": [
                                        {
                                            "type": "ObjectLiteral",
                                            "name": "",
                                            "range": [
                                                1169,
                                                1170
                                            ],
                                            "children": [],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "ForStatement",
                            "name": "",
                            "range": [
                                1172,
                                1242
                            ],
                            "children": [
                                {
                                    "type": "Initialization",
                                    "name": "i, value",
                                    "range": [
                                        1173,
                                        1175
                                    ],
                                    "children": [],
                                    "content": ""
                                },
                                {
                                    "type": "Condition",
                                    "name": "enumerate(row)",
                                    "range": [
                                        1177,
                                        1180
                                    ],
                                    "children": [],
                                    "content": ""
                                },
                                {
                                    "type": "Block",
                                    "name": "",
                                    "range": [
                                        1181,
                                        1242
                                    ],
                                    "children": [
                                        {
                                            "type": "IfStatement",
                                            "name": "",
                                            "range": [
                                                1183,
                                                1190
                                            ],
                                            "children": [
                                                {
                                                    "type": "Condition",
                                                    "name": "i not in input_data.skip_columns",
                                                    "range": [
                                                        1184,
                                                        1189
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                },
                                                {
                                                    "type": "Block",
                                                    "name": "",
                                                    "range": [
                                                        1190,
                                                        1242
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "IfStatement",
                                                            "name": "",
                                                            "range": [
                                                                1192,
                                                                1198
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Condition",
                                                                    "name": "input_data.has_header and header",
                                                                    "range": [
                                                                        1193,
                                                                        1197
                                                                    ],
                                                                    "children": [],
                                                                    "content": ""
                                                                },
                                                                {
                                                                    "type": "Block",
                                                                    "name": "",
                                                                    "range": [
                                                                        1198,
                                                                        1219
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Assignment",
                                                                            "name": "data[header[i]]",
                                                                            "range": [
                                                                                1200,
                                                                                1218
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Expression",
                                                                                    "name": "value.strip() if input_data.strip else value",
                                                                                    "range": [
                                                                                        1207,
                                                                                        1218
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": ""
                                                                                }
                                                                            ],
                                                                            "content": ""
                                                                        }
                                                                    ],
                                                                    "content": ""
                                                                }
                                                            ],
                                                            "content": ""
                                                        },
                                                        {
                                                            "type": "ElseStatement",
                                                            "name": "",
                                                            "range": [
                                                                1220,
                                                                1242
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Block",
                                                                    "name": "",
                                                                    "range": [
                                                                        1221,
                                                                        1242
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Assignment",
                                                                            "name": "data[str(i)]",
                                                                            "range": [
                                                                                1223,
                                                                                1241
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Expression",
                                                                                    "name": "value.strip() if input_data.strip else value",
                                                                                    "range": [
                                                                                        1230,
                                                                                        1241
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": ""
                                                                                }
                                                                            ],
                                                                            "content": ""
                                                                        }
                                                                    ],
                                                                    "content": ""
                                                                }
                                                            ],
                                                            "content": ""
                                                        }
                                                    ],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "ReturnStatement",
                            "name": "",
                            "range": [
                                1243,
                                1245
                            ],
                            "children": [
                                {
                                    "type": "Expression",
                                    "name": "data",
                                    "range": [
                                        1244,
                                        1244
                                    ],
                                    "children": [],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "VariableDecl",
            "name": "all_data",
            "range": [
                1247,
                1250
            ],
            "children": [
                {
                    "type": "Assignment",
                    "name": "",
                    "range": [
                        1248,
                        1250
                    ],
                    "children": [
                        {
                            "type": "ArrayLiteral",
                            "name": "",
                            "range": [
                                1249,
                                1250
                            ],
                            "children": [],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "ForStatement",
            "name": "",
            "range": [
                1252,
                1276
            ],
            "children": [
                {
                    "type": "Initialization",
                    "name": "row",
                    "range": [
                        1253,
                        1253
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "Condition",
                    "name": "reader",
                    "range": [
                        1255,
                        1255
                    ],
                    "children": [],
                    "content": ""
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        1256,
                        1276
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "processed_row",
                            "range": [
                                1258,
                                1263
                            ],
                            "children": [
                                {
                                    "type": "Assignment",
                                    "name": "",
                                    "range": [
                                        1259,
                                        1263
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "process_row",
                                            "range": [
                                                1260,
                                                1263
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "row",
                                                    "range": [
                                                        1262,
                                                        1262
                                                    ],
                                                    "children": [],
                                                    "content": ""
                                                }
                                            ],
                                            "content": ""
                                        }
                                    ],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "all_data.append(processed_row)",
                            "range": [
                                1265,
                                1270
                            ],
                            "children": [],
                            "content": ""
                        },
                        {
                            "type": "YieldStatement",
                            "name": "",
                            "range": [
                                1272,
                                1276
                            ],
                            "children": [
                                {
                                    "type": "Expression",
                                    "name": "\"row\", processed_row",
                                    "range": [
                                        1273,
                                        1275
                                    ],
                                    "children": [],
                                    "content": ""
                                }
                            ],
                            "content": ""
                        }
                    ],
                    "content": ""
                }
            ],
            "content": ""
        },
        {
            "type": "YieldStatement",
            "name": "",
            "range": [
                1278,
                1282
            ],
            "children": [
                {
                    "type": "Expression",
                    "name": "\"all_data\", all_data",
                    "range": [
                        1279,
                        1281
                    ],
                    "children": [],
                    "content": ""
                }
            ],
            "content": ""
        }
    ],
    "content": "class ReadCsvBlock(Block):\nclass Input(BlockSchema):\ncontents:str=SchemaField(\ndescription=\"The contents of the CSV file to read\",\nplaceholder=\"a, b, c\\n1,2,3\\n4,5,6\",\n)\ndelimiter:str=SchemaField(\ndescription=\"The delimiter used in the CSV file\",\ndefault=\",\",\n)\nquotechar:str=SchemaField(\ndescription=\"The character used to quote fields\",\ndefault='\"',\n)\nescapechar:str=SchemaField(\ndescription=\"The character used to escape the delimiter\",\ndefault=\"\\\\\",\n)\nhas_header:bool=SchemaField(\ndescription=\"Whether the CSV file has a header row\",\ndefault=True,\n)\nskip_rows:int=SchemaField(\ndescription=\"The number of rows to skip from the start of the file\",\ndefault=0,\n)\nstrip:bool=SchemaField(\ndescription=\"Whether to strip whitespace from the values\",\ndefault=True,\n)\nskip_columns:list[str]=SchemaField(\ndescription=\"The columns to skip from the start of the row\",\ndefault=[],\n)\n\nclass Output(BlockSchema):\nrow:dict[str,str]=SchemaField(\ndescription=\"The data produced from each row in the CSV file\"\n)\nall_data:list[dict[str,str]]=SchemaField(\ndescription=\"All the data in the CSV file as a list of rows\"\n)\n\ndef __init__(self):\nsuper().__init__(\nid=\"acf7625e-d2cb-4941-bfeb-2819fc6fc015\",\ninput_schema=ReadCsvBlock.Input,\noutput_schema=ReadCsvBlock.Output,\ndescription=\"Reads a CSV file and outputs the data as a list of dictionaries and individual rows via rows.\",\ncontributors=[ContributorDetails(name=\"Nicholas Tindle\")],\ncategories={BlockCategory.TEXT,BlockCategory.DATA},\ntest_input={\n\"contents\":\"a, b, c\\n1,2,3\\n4,5,6\",\n},\ntest_output=[\n(\"row\",{\"a\":\"1\",\"b\":\"2\",\"c\":\"3\"}),\n(\"row\",{\"a\":\"4\",\"b\":\"5\",\"c\":\"6\"}),\n(\n\"all_data\",\n[\n{\"a\":\"1\",\"b\":\"2\",\"c\":\"3\"},\n{\"a\":\"4\",\"b\":\"5\",\"c\":\"6\"},\n],\n),\n],\n)\n\ndef run(self,input_data:Input,**kwargs)->BlockOutput:\nimport csv\nfrom io import StringIO\n\ncsv_file=StringIO(input_data.contents)\nreader=csv.reader(\ncsv_file,\ndelimiter=input_data.delimiter,\nquotechar=input_data.quotechar,\nescapechar=input_data.escapechar,\n)\n\nheader=None\nif input_data.has_header:\nheader=next(reader)\nif input_data.strip:\nheader=[h.strip()for h in header]\n\nfor _ in range(input_data.skip_rows):\nnext(reader)\n\ndef process_row(row):\ndata={}\nfor i,value in enumerate(row):\nif i not in input_data.skip_columns:\nif input_data.has_header and header:\ndata[header[i]]=value.strip()if input_data.strip else value\nelse:\ndata[str(i)]=value.strip()if input_data.strip else value\nreturn data\n\nall_data=[]\nfor row in reader:\nprocessed_row=process_row(row)\nall_data.append(processed_row)\nyield \"row\",processed_row\n\nyield \"all_data\",all_data\n"
}
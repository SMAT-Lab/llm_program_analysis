{
    "type": "Program",
    "name": "Global",
    "range": [
        56,
        659
    ],
    "children": [
        {
            "type": "FunctionDecl",
            "name": "connection_manager",
            "range": [
                61,
                74
            ],
            "children": [
                {
                    "type": "ReturnStatement",
                    "range": [
                        70,
                        73
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "ConnectionManager",
                            "range": [
                                71,
                                73
                            ],
                            "children": [],
                            "content": "return ConnectionManager("
                        }
                    ],
                    "content": "\nreturn ConnectionManager("
                }
            ],
            "content": "\ndef connection_manager()->ConnectionManager:\nreturn ConnectionManager()"
        },
        {
            "type": "FunctionDecl",
            "name": "mock_websocket",
            "range": [
                81,
                111
            ],
            "children": [
                {
                    "type": "ReturnStatement",
                    "range": [
                        109,
                        111
                    ],
                    "children": [
                        {
                            "type": "Identifier",
                            "name": "websocket",
                            "range": [
                                110,
                                111
                            ],
                            "content": "\nreturn"
                        }
                    ],
                    "content": ")\nreturn"
                },
                {
                    "type": "VariableDecl",
                    "name": "websocket",
                    "range": [
                        90,
                        99
                    ],
                    "children": [
                        {
                            "type": "AssignmentExpression",
                            "range": [
                                93,
                                99
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "AsyncMock",
                                    "range": [
                                        94,
                                        99
                                    ],
                                    "content": "AsyncMock=AsyncMock(spec="
                                }
                            ],
                            "content": ":AsyncMock=AsyncMock(spec="
                        }
                    ],
                    "content": ":\nwebsocket:AsyncMock=AsyncMock(spec="
                },
                {
                    "type": "ExpressionStatement",
                    "range": [
                        101,
                        108
                    ],
                    "children": [
                        {
                            "type": "AssignmentExpression",
                            "range": [
                                104,
                                108
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "AsyncMock",
                                    "range": [
                                        105,
                                        108
                                    ],
                                    "content": "send_text=AsyncMock("
                                }
                            ],
                            "content": ".send_text=AsyncMock("
                        }
                    ],
                    "content": ")\nwebsocket.send_text=AsyncMock("
                }
            ],
            "content": "fixture\ndef mock_websocket()->AsyncMock:\nwebsocket:AsyncMock=AsyncMock(spec=WebSocket)\nwebsocket.send_text=AsyncMock()\nreturn"
        },
        {
            "type": "FunctionDecl",
            "name": "test_connect",
            "range": [
                120,
                161
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "test_connect",
                    "range": [
                        120,
                        137
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "async",
                            "range": [
                                120,
                                125
                            ],
                            "children": [],
                            "content": ".asyncio\nasync def test_connect"
                        },
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                121,
                                124
                            ],
                            "children": [],
                            "content": "asyncio\nasync def"
                        },
                        {
                            "type": "Identifier",
                            "name": "test_connect",
                            "range": [
                                122,
                                133
                            ],
                            "children": [],
                            "content": "\nasync def test_connect(\nconnection_manager:ConnectionManager,mock_websocket:"
                        },
                        {
                            "type": "ParameterList",
                            "name": "",
                            "range": [
                                123,
                                133
                            ],
                            "children": [
                                {
                                    "type": "Parameter",
                                    "name": "connection_manager",
                                    "range": [
                                        125,
                                        127
                                    ],
                                    "children": [],
                                    "content": "test_connect(\n"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "mock_websocket",
                                    "range": [
                                        129,
                                        131
                                    ],
                                    "children": [],
                                    "content": ":ConnectionManager,"
                                }
                            ],
                            "content": "async def test_connect(\nconnection_manager:ConnectionManager,mock_websocket:"
                        },
                        {
                            "type": "ReturnType",
                            "name": "None",
                            "range": [
                                134,
                                136
                            ],
                            "children": [],
                            "content": "AsyncMock\n)"
                        }
                    ],
                    "content": ".asyncio\nasync def test_connect(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)-"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        138,
                        161
                    ],
                    "children": [
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                139,
                                145
                            ],
                            "children": [
                                {
                                    "type": "AwaitExpression",
                                    "name": "",
                                    "range": [
                                        139,
                                        145
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "connect",
                                            "range": [
                                                140,
                                                145
                                            ],
                                            "children": [
                                                {
                                                    "type": "MemberExpression",
                                                    "name": "connection_manager.connect",
                                                    "range": [
                                                        140,
                                                        142
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "connection_manager",
                                                            "range": [
                                                                140,
                                                                141
                                                            ],
                                                            "children": [],
                                                            "content": ":\n"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "connect",
                                                            "range": [
                                                                142,
                                                                143
                                                            ],
                                                            "children": [],
                                                            "content": "await connection_manager"
                                                        }
                                                    ],
                                                    "content": ":\nawait"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "mock_websocket",
                                                    "range": [
                                                        144,
                                                        145
                                                    ],
                                                    "children": [],
                                                    "content": ".connect"
                                                }
                                            ],
                                            "content": ":\nawait connection_manager.connect"
                                        }
                                    ],
                                    "content": "None:\nawait connection_manager.connect"
                                }
                            ],
                            "content": "None:\nawait connection_manager.connect"
                        },
                        {
                            "type": "AssertStatement",
                            "name": "",
                            "range": [
                                147,
                                153
                            ],
                            "children": [
                                {
                                    "type": "BinaryExpression",
                                    "name": "in",
                                    "range": [
                                        148,
                                        150
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                148,
                                                149
                                            ],
                                            "children": [],
                                            "content": ")\n"
                                        },
                                        {
                                            "type": "MemberExpression",
                                            "name": "connection_manager.active_connections",
                                            "range": [
                                                150,
                                                152
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "connection_manager",
                                                    "range": [
                                                        150,
                                                        151
                                                    ],
                                                    "children": [],
                                                    "content": "assert mock_websocket"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "active_connections",
                                                    "range": [
                                                        152,
                                                        153
                                                    ],
                                                    "children": [],
                                                    "content": "in connection_manager"
                                                }
                                            ],
                                            "content": "assert mock_websocket in"
                                        }
                                    ],
                                    "content": ")\nassert"
                                }
                            ],
                            "content": "mock_websocket)\nassert mock_websocket in connection_manager"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                154,
                                161
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "assert_called_once",
                                    "range": [
                                        155,
                                        161
                                    ],
                                    "children": [
                                        {
                                            "type": "MemberExpression",
                                            "name": "mock_websocket.accept.assert_called_once",
                                            "range": [
                                                155,
                                                158
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "mock_websocket",
                                                    "range": [
                                                        155,
                                                        156
                                                    ],
                                                    "children": [],
                                                    "content": "active_connections\n"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "accept",
                                                    "range": [
                                                        156,
                                                        157
                                                    ],
                                                    "children": [],
                                                    "content": "\nmock_websocket"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "assert_called_once",
                                                    "range": [
                                                        158,
                                                        159
                                                    ],
                                                    "children": [],
                                                    "content": ".accept"
                                                }
                                            ],
                                            "content": "active_connections\nmock_websocket."
                                        }
                                    ],
                                    "content": "active_connections\nmock_websocket.accept.assert_called_once"
                                }
                            ],
                            "content": ".active_connections\nmock_websocket.accept.assert_called_once"
                        }
                    ],
                    "content": ">None:\nawait connection_manager.connect(mock_websocket)\nassert mock_websocket in connection_manager.active_connections\nmock_websocket.accept.assert_called_once"
                }
            ],
            "content": ".asyncio\nasync def test_connect(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nawait connection_manager.connect(mock_websocket)\nassert mock_websocket in connection_manager.active_connections\nmock_websocket.accept.assert_called_once"
        },
        {
            "type": "FunctionDecl",
            "name": "test_disconnect",
            "range": [
                163,
                229
            ],
            "children": [
                {
                    "type": "ParameterList",
                    "name": "parameters",
                    "range": [
                        165,
                        174
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "connection_manager",
                            "range": [
                                167,
                                169
                            ],
                            "children": [],
                            "content": "def test_disconnect("
                        },
                        {
                            "type": "Parameter",
                            "name": "mock_websocket",
                            "range": [
                                171,
                                173
                            ],
                            "children": [],
                            "content": "connection_manager:ConnectionManager"
                        }
                    ],
                    "content": "\n\ndef test_disconnect(\nconnection_manager:ConnectionManager,"
                },
                {
                    "type": "ReturnType",
                    "name": "None",
                    "range": [
                        176,
                        178
                    ],
                    "children": [],
                    "content": ":AsyncMock\n"
                },
                {
                    "type": "FunctionBody",
                    "name": "body",
                    "range": [
                        180,
                        229
                    ],
                    "children": [
                        {
                            "type": "ExpressionStatement",
                            "name": "CallExpression",
                            "range": [
                                181,
                                188
                            ],
                            "children": [
                                {
                                    "type": "MemberExpression",
                                    "name": "connection_manager.active_connections.add",
                                    "range": [
                                        181,
                                        188
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "connection_manager",
                                            "range": [
                                                181,
                                                183
                                            ],
                                            "children": [],
                                            "content": ">None:"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "active_connections",
                                            "range": [
                                                184,
                                                186
                                            ],
                                            "children": [],
                                            "content": "\nconnection_manager."
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "add",
                                            "range": [
                                                187,
                                                188
                                            ],
                                            "children": [],
                                            "content": "active_connections."
                                        }
                                    ],
                                    "content": ">None:\nconnection_manager.active_connections."
                                },
                                {
                                    "type": "Identifier",
                                    "name": "mock_websocket",
                                    "range": [
                                        189,
                                        190
                                    ],
                                    "children": [],
                                    "content": "add("
                                }
                            ],
                            "content": ">None:\nconnection_manager.active_connections."
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "AssignmentExpression",
                            "range": [
                                190,
                                199
                            ],
                            "children": [
                                {
                                    "type": "MemberExpression",
                                    "name": "connection_manager.subscriptions[\"test_graph\"]",
                                    "range": [
                                        190,
                                        199
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "connection_manager",
                                            "range": [
                                                190,
                                                192
                                            ],
                                            "children": [],
                                            "content": "(mock_websocket)"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "subscriptions",
                                            "range": [
                                                193,
                                                195
                                            ],
                                            "children": [],
                                            "content": "\nconnection_manager."
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"test_graph\"",
                                            "range": [
                                                196,
                                                198
                                            ],
                                            "children": [],
                                            "content": "subscriptions[\"test_graph\""
                                        }
                                    ],
                                    "content": "(mock_websocket)\nconnection_manager.subscriptions[\"test_graph\"]"
                                },
                                {
                                    "type": "ObjectExpression",
                                    "name": "{mock_websocket}",
                                    "range": [
                                        199,
                                        200
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                199,
                                                200
                                            ],
                                            "children": [],
                                            "content": "]="
                                        }
                                    ],
                                    "content": "]="
                                }
                            ],
                            "content": "(mock_websocket)\nconnection_manager.subscriptions[\"test_graph\"]"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "CallExpression",
                            "range": [
                                202,
                                207
                            ],
                            "children": [
                                {
                                    "type": "MemberExpression",
                                    "name": "connection_manager.disconnect",
                                    "range": [
                                        202,
                                        207
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "connection_manager",
                                            "range": [
                                                202,
                                                204
                                            ],
                                            "children": [],
                                            "content": "mock_websocket}\n"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "disconnect",
                                            "range": [
                                                205,
                                                207
                                            ],
                                            "children": [],
                                            "content": "\nconnection_manager."
                                        }
                                    ],
                                    "content": "mock_websocket}\n\nconnection_manager."
                                },
                                {
                                    "type": "Identifier",
                                    "name": "mock_websocket",
                                    "range": [
                                        208,
                                        209
                                    ],
                                    "children": [],
                                    "content": "disconnect("
                                }
                            ],
                            "content": "mock_websocket}\n\nconnection_manager."
                        },
                        {
                            "type": "AssertStatement",
                            "name": "assert",
                            "range": [
                                210,
                                217
                            ],
                            "children": [
                                {
                                    "type": "BinaryExpression",
                                    "name": "not in",
                                    "range": [
                                        211,
                                        217
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                211,
                                                213
                                            ],
                                            "children": [],
                                            "content": ")\n\n"
                                        },
                                        {
                                            "type": "MemberExpression",
                                            "name": "connection_manager.active_connections",
                                            "range": [
                                                214,
                                                217
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "connection_manager",
                                                    "range": [
                                                        214,
                                                        216
                                                    ],
                                                    "children": [],
                                                    "content": "assert mock_websocket not"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "active_connections",
                                                    "range": [
                                                        217,
                                                        218
                                                    ],
                                                    "children": [],
                                                    "content": "in connection_manager"
                                                }
                                            ],
                                            "content": "assert mock_websocket not in"
                                        }
                                    ],
                                    "content": ")\n\nassert mock_websocket not in"
                                }
                            ],
                            "content": "mock_websocket)\n\nassert mock_websocket not in"
                        },
                        {
                            "type": "AssertStatement",
                            "name": "assert",
                            "range": [
                                218,
                                228
                            ],
                            "children": [
                                {
                                    "type": "BinaryExpression",
                                    "name": "not in",
                                    "range": [
                                        219,
                                        228
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                219,
                                                221
                                            ],
                                            "children": [],
                                            "content": ".active_connections\n"
                                        },
                                        {
                                            "type": "MemberExpression",
                                            "name": "connection_manager.subscriptions[\"test_graph\"]",
                                            "range": [
                                                222,
                                                228
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "connection_manager",
                                                    "range": [
                                                        222,
                                                        224
                                                    ],
                                                    "children": [],
                                                    "content": "assert mock_websocket not"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "subscriptions",
                                                    "range": [
                                                        225,
                                                        227
                                                    ],
                                                    "children": [],
                                                    "content": "in connection_manager."
                                                },
                                                {
                                                    "type": "Literal",
                                                    "name": "\"test_graph\"",
                                                    "range": [
                                                        228,
                                                        229
                                                    ],
                                                    "children": [],
                                                    "content": "subscriptions["
                                                }
                                            ],
                                            "content": "assert mock_websocket not in connection_manager.subscriptions"
                                        }
                                    ],
                                    "content": ".active_connections\nassert mock_websocket not in connection_manager.subscriptions"
                                }
                            ],
                            "content": "connection_manager.active_connections\nassert mock_websocket not in connection_manager.subscriptions"
                        }
                    ],
                    "content": "->None:\nconnection_manager.active_connections.add(mock_websocket)\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\n\nconnection_manager.disconnect(mock_websocket)\n\nassert mock_websocket not in connection_manager.active_connections\nassert mock_websocket not in connection_manager.subscriptions["
                }
            ],
            "content": ")\n\n\ndef test_disconnect(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.active_connections.add(mock_websocket)\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\n\nconnection_manager.disconnect(mock_websocket)\n\nassert mock_websocket not in connection_manager.active_connections\nassert mock_websocket not in connection_manager.subscriptions["
        },
        {
            "type": "FunctionDecl",
            "name": "test_subscribe",
            "range": [
                237,
                275
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "test_subscribe",
                    "range": [
                        237,
                        254
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "async",
                            "range": [
                                237,
                                237
                            ],
                            "children": [],
                            "content": "."
                        },
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                238,
                                238
                            ],
                            "children": [],
                            "content": "mark"
                        },
                        {
                            "type": "Identifier",
                            "name": "test_subscribe",
                            "range": [
                                239,
                                239
                            ],
                            "children": [],
                            "content": "."
                        },
                        {
                            "type": "ParameterList",
                            "name": "",
                            "range": [
                                240,
                                249
                            ],
                            "children": [
                                {
                                    "type": "Parameter",
                                    "name": "connection_manager",
                                    "range": [
                                        242,
                                        244
                                    ],
                                    "children": [],
                                    "content": "async def test_subscribe"
                                },
                                {
                                    "type": "Parameter",
                                    "name": "mock_websocket",
                                    "range": [
                                        246,
                                        248
                                    ],
                                    "children": [],
                                    "content": "\nconnection_manager:"
                                }
                            ],
                            "content": "asyncio\nasync def test_subscribe(\nconnection_manager:ConnectionManager"
                        },
                        {
                            "type": "ReturnType",
                            "name": "None",
                            "range": [
                                251,
                                253
                            ],
                            "children": [],
                            "content": "mock_websocket:AsyncMock"
                        }
                    ],
                    "content": ".mark.asyncio\nasync def test_subscribe(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        255,
                        275
                    ],
                    "children": [
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                256,
                                264
                            ],
                            "children": [
                                {
                                    "type": "AwaitExpression",
                                    "name": "",
                                    "range": [
                                        256,
                                        264
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "subscribe",
                                            "range": [
                                                257,
                                                264
                                            ],
                                            "children": [
                                                {
                                                    "type": "MemberExpression",
                                                    "name": "connection_manager.subscribe",
                                                    "range": [
                                                        257,
                                                        259
                                                    ],
                                                    "children": [],
                                                    "content": ">None:"
                                                },
                                                {
                                                    "type": "Literal",
                                                    "name": "\"test_graph\"",
                                                    "range": [
                                                        261,
                                                        261
                                                    ],
                                                    "children": [],
                                                    "content": "await"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "mock_websocket",
                                                    "range": [
                                                        263,
                                                        263
                                                    ],
                                                    "children": [],
                                                    "content": "."
                                                }
                                            ],
                                            "content": ">None:\nawait connection_manager.subscribe"
                                        }
                                    ],
                                    "content": "->None:\nawait connection_manager.subscribe"
                                }
                            ],
                            "content": "->None:\nawait connection_manager.subscribe"
                        },
                        {
                            "type": "AssertStatement",
                            "name": "",
                            "range": [
                                266,
                                275
                            ],
                            "children": [
                                {
                                    "type": "BinaryExpression",
                                    "name": "in",
                                    "range": [
                                        267,
                                        269
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                267,
                                                267
                                            ],
                                            "children": [],
                                            "content": ","
                                        },
                                        {
                                            "type": "MemberExpression",
                                            "name": "connection_manager.subscriptions[\"test_graph\"]",
                                            "range": [
                                                269,
                                                274
                                            ],
                                            "children": [],
                                            "content": ")\nassert mock_websocket in connection_manager"
                                        }
                                    ],
                                    "content": ",mock_websocket)"
                                }
                            ],
                            "content": "\"test_graph\",mock_websocket)\nassert mock_websocket in connection_manager."
                        }
                    ],
                    "content": ")->None:\nawait connection_manager.subscribe(\"test_graph\",mock_websocket)\nassert mock_websocket in connection_manager."
                }
            ],
            "content": ".mark.asyncio\nasync def test_subscribe(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nawait connection_manager.subscribe(\"test_graph\",mock_websocket)\nassert mock_websocket in connection_manager."
        },
        {
            "type": "FunctionDecl",
            "name": "test_unsubscribe",
            "range": [
                278,
                318
            ],
            "children": [
                {
                    "type": "Keyword",
                    "name": "async",
                    "range": [
                        278,
                        278
                    ],
                    "children": [],
                    "content": "\"test_graph\""
                },
                {
                    "type": "Keyword",
                    "name": "def",
                    "range": [
                        279,
                        279
                    ],
                    "children": [],
                    "content": "]"
                },
                {
                    "type": "Identifier",
                    "name": "test_unsubscribe",
                    "range": [
                        280,
                        280
                    ],
                    "children": [],
                    "content": "\n"
                },
                {
                    "type": "Parameter",
                    "name": "connection_manager",
                    "range": [
                        283,
                        285
                    ],
                    "children": [
                        {
                            "type": "Identifier",
                            "name": "connection_manager",
                            "range": [
                                283,
                                283
                            ],
                            "children": [],
                            "content": "@"
                        },
                        {
                            "type": "TypeAnnotation",
                            "name": "ConnectionManager",
                            "range": [
                                285,
                                285
                            ],
                            "children": [],
                            "content": "."
                        }
                    ],
                    "content": "@pytest."
                },
                {
                    "type": "Parameter",
                    "name": "mock_websocket",
                    "range": [
                        287,
                        289
                    ],
                    "children": [
                        {
                            "type": "Identifier",
                            "name": "mock_websocket",
                            "range": [
                                287,
                                287
                            ],
                            "children": [],
                            "content": "."
                        },
                        {
                            "type": "TypeAnnotation",
                            "name": "AsyncMock",
                            "range": [
                                289,
                                289
                            ],
                            "children": [],
                            "content": "\n"
                        }
                    ],
                    "content": ".asyncio\n"
                },
                {
                    "type": "ReturnType",
                    "name": "None",
                    "range": [
                        292,
                        294
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "None",
                            "range": [
                                294,
                                294
                            ],
                            "children": [],
                            "content": "\n"
                        }
                    ],
                    "content": "test_unsubscribe(\n"
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        296,
                        318
                    ],
                    "children": [
                        {
                            "type": "AssignmentExpression",
                            "name": "",
                            "range": [
                                297,
                                306
                            ],
                            "children": [
                                {
                                    "type": "MemberExpression",
                                    "name": "connection_manager.subscriptions",
                                    "range": [
                                        297,
                                        299
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "connection_manager",
                                            "range": [
                                                297,
                                                297
                                            ],
                                            "children": [],
                                            "content": "ConnectionManager"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "subscriptions",
                                            "range": [
                                                299,
                                                299
                                            ],
                                            "children": [],
                                            "content": "mock_websocket"
                                        }
                                    ],
                                    "content": "ConnectionManager,mock_websocket"
                                },
                                {
                                    "type": "Literal",
                                    "name": "\"test_graph\"",
                                    "range": [
                                        301,
                                        301
                                    ],
                                    "children": [],
                                    "content": "AsyncMock"
                                },
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        304,
                                        306
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                305,
                                                305
                                            ],
                                            "children": [],
                                            "content": ">"
                                        }
                                    ],
                                    "content": "->None"
                                }
                            ],
                            "content": "ConnectionManager,mock_websocket:AsyncMock\n)->None"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                309,
                                317
                            ],
                            "children": [
                                {
                                    "type": "Keyword",
                                    "name": "await",
                                    "range": [
                                        309,
                                        309
                                    ],
                                    "children": [],
                                    "content": "connection_manager"
                                },
                                {
                                    "type": "CallExpression",
                                    "name": "connection_manager.unsubscribe",
                                    "range": [
                                        310,
                                        317
                                    ],
                                    "children": [
                                        {
                                            "type": "MemberExpression",
                                            "name": "connection_manager.unsubscribe",
                                            "range": [
                                                310,
                                                312
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "connection_manager",
                                                    "range": [
                                                        310,
                                                        310
                                                    ],
                                                    "children": [],
                                                    "content": "."
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "unsubscribe",
                                                    "range": [
                                                        312,
                                                        312
                                                    ],
                                                    "children": [],
                                                    "content": "["
                                                }
                                            ],
                                            "content": ".subscriptions["
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"test_graph\"",
                                            "range": [
                                                314,
                                                314
                                            ],
                                            "children": [],
                                            "content": "]"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                316,
                                                316
                                            ],
                                            "children": [],
                                            "content": "{"
                                        }
                                    ],
                                    "content": ".subscriptions[\"test_graph\"]={mock_websocket"
                                }
                            ],
                            "content": "connection_manager.subscriptions[\"test_graph\"]={mock_websocket"
                        }
                    ],
                    "content": ":ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}"
                }
            ],
            "content": "\"test_graph\"]\n\n\n@pytest.mark.asyncio\nasync def test_unsubscribe(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}"
        },
        {
            "type": "AssertStatement",
            "name": "",
            "range": [
                320,
                327
            ],
            "children": [
                {
                    "type": "Keyword",
                    "name": "assert",
                    "range": [
                        320,
                        320
                    ],
                    "children": [],
                    "content": "\n"
                },
                {
                    "type": "BinaryExpression",
                    "name": "",
                    "range": [
                        321,
                        326
                    ],
                    "children": [
                        {
                            "type": "Literal",
                            "name": "\"test_graph\"",
                            "range": [
                                321,
                                321
                            ],
                            "children": [],
                            "content": "await"
                        },
                        {
                            "type": "Keyword",
                            "name": "not",
                            "range": [
                                322,
                                322
                            ],
                            "children": [],
                            "content": "connection_manager"
                        },
                        {
                            "type": "Keyword",
                            "name": "in",
                            "range": [
                                323,
                                323
                            ],
                            "children": [],
                            "content": "."
                        },
                        {
                            "type": "MemberExpression",
                            "name": "connection_manager.subscriptions",
                            "range": [
                                324,
                                326
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "connection_manager",
                                    "range": [
                                        324,
                                        324
                                    ],
                                    "children": [],
                                    "content": "unsubscribe"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "subscriptions",
                                    "range": [
                                        326,
                                        326
                                    ],
                                    "children": [],
                                    "content": "\"test_graph\""
                                }
                            ],
                            "content": "unsubscribe(\"test_graph\""
                        }
                    ],
                    "content": "await connection_manager.unsubscribe(\"test_graph\""
                }
            ],
            "content": "\nawait connection_manager.unsubscribe(\"test_graph\","
        },
        {
            "type": "FunctionDecl",
            "name": "test_send_execution_result",
            "range": [
                330,
                523
            ],
            "children": [
                {
                    "type": "FunctionSignature",
                    "name": "test_send_execution_result",
                    "range": [
                        330,
                        347
                    ],
                    "children": [
                        {
                            "type": "Keyword",
                            "name": "async",
                            "range": [
                                330,
                                334
                            ],
                            "children": [],
                            "content": "\n\nassert \"test_graph\" not"
                        },
                        {
                            "type": "Keyword",
                            "name": "def",
                            "range": [
                                331,
                                334
                            ],
                            "children": [],
                            "content": "\nassert \"test_graph\" not"
                        },
                        {
                            "type": "Identifier",
                            "name": "test_send_execution_result",
                            "range": [
                                332,
                                353
                            ],
                            "children": [],
                            "content": "assert \"test_graph\" not in connection_manager.subscriptions\n\n\n@pytest.mark.asyncio\nasync def test_send_execution_result(\n"
                        },
                        {
                            "type": "ParameterList",
                            "name": "",
                            "range": [
                                353,
                                347
                            ],
                            "children": [
                                {
                                    "type": "Parameter",
                                    "name": "connection_manager",
                                    "range": [
                                        335,
                                        337
                                    ],
                                    "children": [],
                                    "content": "in connection_manager."
                                },
                                {
                                    "type": "Parameter",
                                    "name": "mock_websocket",
                                    "range": [
                                        339,
                                        341
                                    ],
                                    "children": [],
                                    "content": "\n\n\n"
                                }
                            ],
                            "content": ""
                        },
                        {
                            "type": "ReturnType",
                            "name": "None",
                            "range": [
                                344,
                                347
                            ],
                            "children": [],
                            "content": ".mark.asyncio"
                        }
                    ],
                    "content": "\n\nassert \"test_graph\" not in connection_manager.subscriptions\n\n\n@pytest.mark.asyncio"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        348,
                        523
                    ],
                    "children": [
                        {
                            "type": "Assignment",
                            "name": "",
                            "range": [
                                349,
                                359
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "connection_manager",
                                    "range": [
                                        349,
                                        365
                                    ],
                                    "children": [],
                                    "content": "async def test_send_execution_result(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "subscriptions",
                                    "range": [
                                        351,
                                        365
                                    ],
                                    "children": [],
                                    "content": "test_send_execution_result(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None"
                                },
                                {
                                    "type": "StringLiteral",
                                    "name": "test_graph",
                                    "range": [
                                        353,
                                        365
                                    ],
                                    "children": [],
                                    "content": "\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None"
                                },
                                {
                                    "type": "ObjectLiteral",
                                    "name": "",
                                    "range": [
                                        356,
                                        358
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                357,
                                                358
                                            ],
                                            "children": [],
                                            "content": ",mock_websocket"
                                        }
                                    ],
                                    "content": "ConnectionManager,mock_websocket"
                                }
                            ],
                            "content": "async def test_send_execution_result(\nconnection_manager:ConnectionManager,mock_websocket:"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "result",
                            "range": [
                                360,
                                471
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "ExecutionResult",
                                    "range": [
                                        361,
                                        362
                                    ],
                                    "children": [],
                                    "content": "\n)"
                                },
                                {
                                    "type": "ObjectLiteral",
                                    "name": "",
                                    "range": [
                                        364,
                                        471
                                    ],
                                    "children": [
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "graph_id",
                                            "range": [
                                                367,
                                                369
                                            ],
                                            "children": [
                                                {
                                                    "type": "StringLiteral",
                                                    "name": "test_graph",
                                                    "range": [
                                                        369,
                                                        369
                                                    ],
                                                    "children": [],
                                                    "content": "."
                                                }
                                            ],
                                            "content": "\nconnection_manager."
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "graph_version",
                                            "range": [
                                                372,
                                                374
                                            ],
                                            "children": [
                                                {
                                                    "type": "NumericLiteral",
                                                    "name": "1",
                                                    "range": [
                                                        374,
                                                        374
                                                    ],
                                                    "children": [],
                                                    "content": "="
                                                }
                                            ],
                                            "content": "\"test_graph\"]="
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "graph_exec_id",
                                            "range": [
                                                377,
                                                379
                                            ],
                                            "children": [
                                                {
                                                    "type": "StringLiteral",
                                                    "name": "test_exec_id",
                                                    "range": [
                                                        379,
                                                        379
                                                    ],
                                                    "children": [],
                                                    "content": "result"
                                                }
                                            ],
                                            "content": "}\nresult"
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "node_exec_id",
                                            "range": [
                                                382,
                                                384
                                            ],
                                            "children": [
                                                {
                                                    "type": "StringLiteral",
                                                    "name": "test_node_exec_id",
                                                    "range": [
                                                        384,
                                                        384
                                                    ],
                                                    "children": [],
                                                    "content": "("
                                                }
                                            ],
                                            "content": "=ExecutionResult("
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "node_id",
                                            "range": [
                                                387,
                                                389
                                            ],
                                            "children": [
                                                {
                                                    "type": "StringLiteral",
                                                    "name": "test_node_id",
                                                    "range": [
                                                        389,
                                                        389
                                                    ],
                                                    "children": [],
                                                    "content": ","
                                                }
                                            ],
                                            "content": "=\"test_graph\","
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "block_id",
                                            "range": [
                                                392,
                                                394
                                            ],
                                            "children": [
                                                {
                                                    "type": "StringLiteral",
                                                    "name": "test_block_id",
                                                    "range": [
                                                        394,
                                                        394
                                                    ],
                                                    "children": [],
                                                    "content": ","
                                                }
                                            ],
                                            "content": "=1,"
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "status",
                                            "range": [
                                                397,
                                                402
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "ExecutionStatus",
                                                    "range": [
                                                        399,
                                                        402
                                                    ],
                                                    "children": [],
                                                    "content": ",\nnode_exec_id="
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "COMPLETED",
                                                    "range": [
                                                        401,
                                                        402
                                                    ],
                                                    "children": [],
                                                    "content": "node_exec_id="
                                                }
                                            ],
                                            "content": "=\"test_exec_id\",\nnode_exec_id="
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "input_data",
                                            "range": [
                                                404,
                                                410
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectLiteral",
                                                    "name": "",
                                                    "range": [
                                                        406,
                                                        410
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "PropertyAssignment",
                                                            "name": "input1",
                                                            "range": [
                                                                407,
                                                                409
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "StringLiteral",
                                                                    "name": "value1",
                                                                    "range": [
                                                                        409,
                                                                        409
                                                                    ],
                                                                    "children": [],
                                                                    "content": ","
                                                                }
                                                            ],
                                                            "content": "=\"test_node_id\","
                                                        }
                                                    ],
                                                    "content": "node_id=\"test_node_id\",\n"
                                                }
                                            ],
                                            "content": ",\nnode_id=\"test_node_id\",\n"
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "output_data",
                                            "range": [
                                                413,
                                                421
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectLiteral",
                                                    "name": "",
                                                    "range": [
                                                        415,
                                                        421
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "PropertyAssignment",
                                                            "name": "output1",
                                                            "range": [
                                                                416,
                                                                420
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "ArrayLiteral",
                                                                    "name": "",
                                                                    "range": [
                                                                        418,
                                                                        420
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "StringLiteral",
                                                                            "name": "result1",
                                                                            "range": [
                                                                                419,
                                                                                420
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".COMPLETED"
                                                                        }
                                                                    ],
                                                                    "content": "ExecutionStatus.COMPLETED"
                                                                }
                                                            ],
                                                            "content": "status=ExecutionStatus.COMPLETED"
                                                        }
                                                    ],
                                                    "content": "\nstatus=ExecutionStatus.COMPLETED,"
                                                }
                                            ],
                                            "content": "\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,"
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "add_time",
                                            "range": [
                                                424,
                                                435
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "datetime.now",
                                                    "range": [
                                                        426,
                                                        435
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "datetime",
                                                            "range": [
                                                                426,
                                                                427
                                                            ],
                                                            "children": [],
                                                            "content": "\"input1\":"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "now",
                                                            "range": [
                                                                428,
                                                                429
                                                            ],
                                                            "children": [],
                                                            "content": "\"value1\"}"
                                                        },
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "",
                                                            "range": [
                                                                429,
                                                                435
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "NamedArgument",
                                                                    "name": "tz",
                                                                    "range": [
                                                                        430,
                                                                        434
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "timezone",
                                                                            "range": [
                                                                                432,
                                                                                433
                                                                            ],
                                                                            "children": [],
                                                                            "content": "output_data="
                                                                        },
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "utc",
                                                                            "range": [
                                                                                434,
                                                                                434
                                                                            ],
                                                                            "children": [],
                                                                            "content": "{"
                                                                        }
                                                                    ],
                                                                    "content": ",\noutput_data={"
                                                                }
                                                            ],
                                                            "content": "},\noutput_data={\"output1\""
                                                        }
                                                    ],
                                                    "content": "\"input1\":\"value1\"},\noutput_data={\"output1\""
                                                }
                                            ],
                                            "content": "={\"input1\":\"value1\"},\noutput_data={\"output1\""
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "queue_time",
                                            "range": [
                                                438,
                                                440
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "None",
                                                    "range": [
                                                        440,
                                                        440
                                                    ],
                                                    "children": [],
                                                    "content": "}"
                                                }
                                            ],
                                            "content": "\"result1\"]}"
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "start_time",
                                            "range": [
                                                443,
                                                454
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "datetime.now",
                                                    "range": [
                                                        445,
                                                        454
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "datetime",
                                                            "range": [
                                                                445,
                                                                446
                                                            ],
                                                            "children": [],
                                                            "content": "datetime."
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "now",
                                                            "range": [
                                                                447,
                                                                448
                                                            ],
                                                            "children": [],
                                                            "content": "now("
                                                        },
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "",
                                                            "range": [
                                                                448,
                                                                454
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "NamedArgument",
                                                                    "name": "tz",
                                                                    "range": [
                                                                        449,
                                                                        453
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "timezone",
                                                                            "range": [
                                                                                451,
                                                                                452
                                                                            ],
                                                                            "children": [],
                                                                            "content": "timezone."
                                                                        },
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "utc",
                                                                            "range": [
                                                                                453,
                                                                                453
                                                                            ],
                                                                            "children": [],
                                                                            "content": "utc"
                                                                        }
                                                                    ],
                                                                    "content": "tz=timezone.utc"
                                                                }
                                                            ],
                                                            "content": "(tz=timezone.utc)"
                                                        }
                                                    ],
                                                    "content": "datetime.now(tz=timezone.utc)"
                                                }
                                            ],
                                            "content": "add_time=datetime.now(tz=timezone.utc)"
                                        },
                                        {
                                            "type": "PropertyAssignment",
                                            "name": "end_time",
                                            "range": [
                                                457,
                                                468
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "datetime.now",
                                                    "range": [
                                                        459,
                                                        468
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "datetime",
                                                            "range": [
                                                                459,
                                                                460
                                                            ],
                                                            "children": [],
                                                            "content": "None,"
                                                        },
                                                        {
                                                            "type": "Identifier",
                                                            "name": "now",
                                                            "range": [
                                                                461,
                                                                462
                                                            ],
                                                            "children": [],
                                                            "content": "\nstart_time"
                                                        },
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "",
                                                            "range": [
                                                                462,
                                                                468
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "NamedArgument",
                                                                    "name": "tz",
                                                                    "range": [
                                                                        463,
                                                                        467
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "timezone",
                                                                            "range": [
                                                                                465,
                                                                                466
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".now"
                                                                        },
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "utc",
                                                                            "range": [
                                                                                467,
                                                                                467
                                                                            ],
                                                                            "children": [],
                                                                            "content": "("
                                                                        }
                                                                    ],
                                                                    "content": "=datetime.now("
                                                                }
                                                            ],
                                                            "content": "start_time=datetime.now(tz"
                                                        }
                                                    ],
                                                    "content": "None,\nstart_time=datetime.now(tz"
                                                }
                                            ],
                                            "content": "queue_time=None,\nstart_time=datetime.now(tz"
                                        }
                                    ],
                                    "content": ">None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(tz=timezone.utc),\nqueue_time=None,\nstart_time=datetime.now(tz=timezone."
                                }
                            ],
                            "content": "AsyncMock\n)->None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(tz=timezone.utc),\nqueue_time=None,\nstart_time=datetime.now(tz=timezone."
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                474,
                                481
                            ],
                            "children": [
                                {
                                    "type": "AwaitExpression",
                                    "name": "",
                                    "range": [
                                        474,
                                        481
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "connection_manager.send_execution_result",
                                            "range": [
                                                475,
                                                480
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "connection_manager",
                                                    "range": [
                                                        475,
                                                        476
                                                    ],
                                                    "children": [],
                                                    "content": "\nend_time"
                                                },
                                                {
                                                    "type": "Identifier",
                                                    "name": "send_execution_result",
                                                    "range": [
                                                        477,
                                                        478
                                                    ],
                                                    "children": [],
                                                    "content": "=datetime"
                                                },
                                                {
                                                    "type": "ArgumentList",
                                                    "name": "",
                                                    "range": [
                                                        478,
                                                        480
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "result",
                                                            "range": [
                                                                479,
                                                                480
                                                            ],
                                                            "children": [],
                                                            "content": ".now"
                                                        }
                                                    ],
                                                    "content": "datetime.now"
                                                }
                                            ],
                                            "content": "\nend_time=datetime.now"
                                        }
                                    ],
                                    "content": ",\nend_time=datetime.now("
                                }
                            ],
                            "content": ",\nend_time=datetime.now("
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                483,
                                521
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "mock_websocket.send_text.assert_called_once_with",
                                    "range": [
                                        483,
                                        520
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                483,
                                                484
                                            ],
                                            "children": [],
                                            "content": "=timezone"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "send_text",
                                            "range": [
                                                485,
                                                486
                                            ],
                                            "children": [],
                                            "content": ".utc"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "assert_called_once_with",
                                            "range": [
                                                487,
                                                488
                                            ],
                                            "children": [],
                                            "content": "),"
                                        },
                                        {
                                            "type": "ArgumentList",
                                            "name": "",
                                            "range": [
                                                488,
                                                520
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "WsMessage.model_dump_json",
                                                    "range": [
                                                        490,
                                                        519
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Identifier",
                                                            "name": "WsMessage",
                                                            "range": [
                                                                490,
                                                                491
                                                            ],
                                                            "children": [],
                                                            "content": ")\n"
                                                        },
                                                        {
                                                            "type": "ObjectLiteral",
                                                            "name": "",
                                                            "range": [
                                                                491,
                                                                514
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "PropertyAssignment",
                                                                    "name": "method",
                                                                    "range": [
                                                                        493,
                                                                        498
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "Methods",
                                                                            "range": [
                                                                                495,
                                                                                496
                                                                            ],
                                                                            "children": [],
                                                                            "content": ".send_execution_result"
                                                                        },
                                                                        {
                                                                            "type": "Identifier",
                                                                            "name": "EXECUTION_EVENT",
                                                                            "range": [
                                                                                497,
                                                                                498
                                                                            ],
                                                                            "children": [],
                                                                            "content": "(result"
                                                                        }
                                                                    ],
                                                                    "content": "await connection_manager.send_execution_result(result"
                                                                },
                                                                {
                                                                    "type": "PropertyAssignment",
                                                                    "name": "channel",
                                                                    "range": [
                                                                        500,
                                                                        502
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "StringLiteral",
                                                                            "name": "test_graph",
                                                                            "range": [
                                                                                502,
                                                                                502
                                                                            ],
                                                                            "children": [],
                                                                            "content": "mock_websocket"
                                                                        }
                                                                    ],
                                                                    "content": "\n\nmock_websocket"
                                                                },
                                                                {
                                                                    "type": "PropertyAssignment",
                                                                    "name": "data",
                                                                    "range": [
                                                                        505,
                                                                        512
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "CallExpression",
                                                                            "name": "result.model_dump",
                                                                            "range": [
                                                                                507,
                                                                                511
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "result",
                                                                                    "range": [
                                                                                        507,
                                                                                        508
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "(\n"
                                                                                },
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "model_dump",
                                                                                    "range": [
                                                                                        509,
                                                                                        510
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "WsMessage("
                                                                                }
                                                                            ],
                                                                            "content": "(\nWsMessage(\n"
                                                                        }
                                                                    ],
                                                                    "content": ".assert_called_once_with(\nWsMessage(\nmethod"
                                                                }
                                                            ],
                                                            "content": "\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods"
                                                        },
                                                        {
                                                            "type": "CallExpression",
                                                            "name": "model_dump_json",
                                                            "range": [
                                                                516,
                                                                519
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "model_dump_json",
                                                                    "range": [
                                                                        517,
                                                                        518
                                                                    ],
                                                                    "children": [],
                                                                    "content": ",\n"
                                                                }
                                                            ],
                                                            "content": "EXECUTION_EVENT,\nchannel"
                                                        }
                                                    ],
                                                    "content": ")\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods.EXECUTION_EVENT,\nchannel"
                                                }
                                            ],
                                            "content": ",\n)\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods.EXECUTION_EVENT,\nchannel="
                                        }
                                    ],
                                    "content": "=timezone.utc),\n)\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods.EXECUTION_EVENT,\nchannel="
                                }
                            ],
                            "content": "=timezone.utc),\n)\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods.EXECUTION_EVENT,\nchannel=\"test_graph\""
                        }
                    ],
                    "content": "\nasync def test_send_execution_result(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(tz=timezone.utc),\nqueue_time=None,\nstart_time=datetime.now(tz=timezone.utc),\nend_time=datetime.now(tz=timezone.utc),\n)\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods.EXECUTION_EVENT,\nchannel=\"test_graph\",\n"
                }
            ],
            "content": "\n\nassert \"test_graph\" not in connection_manager.subscriptions\n\n\n@pytest.mark.asyncio\nasync def test_send_execution_result(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(tz=timezone.utc),\nqueue_time=None,\nstart_time=datetime.now(tz=timezone.utc),\nend_time=datetime.now(tz=timezone.utc),\n)\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods.EXECUTION_EVENT,\nchannel=\"test_graph\",\n"
        },
        {
            "type": "FunctionDecl",
            "name": "test_send_execution_result_no_subscribers",
            "range": [
                524,
                659
            ],
            "children": [
                {
                    "type": "Keyword",
                    "name": "async",
                    "range": [
                        524,
                        528
                    ],
                    "children": [],
                    "content": "data=result.model_dump"
                },
                {
                    "type": "Keyword",
                    "name": "def",
                    "range": [
                        525,
                        528
                    ],
                    "children": [],
                    "content": "=result.model_dump"
                },
                {
                    "type": "Identifier",
                    "name": "test_send_execution_result_no_subscribers",
                    "range": [
                        526,
                        527
                    ],
                    "children": [],
                    "content": "result."
                },
                {
                    "type": "Parameter",
                    "name": "connection_manager",
                    "range": [
                        529,
                        536
                    ],
                    "children": [
                        {
                            "type": "Identifier",
                            "name": "connection_manager",
                            "range": [
                                529,
                                530
                            ],
                            "children": [],
                            "content": "()"
                        },
                        {
                            "type": "Type",
                            "name": "ConnectionManager",
                            "range": [
                                531,
                                532
                            ],
                            "children": [],
                            "content": ",\n"
                        }
                    ],
                    "content": "(),\n).model_dump_json("
                },
                {
                    "type": "Parameter",
                    "name": "mock_websocket",
                    "range": [
                        533,
                        536
                    ],
                    "children": [
                        {
                            "type": "Identifier",
                            "name": "mock_websocket",
                            "range": [
                                533,
                                534
                            ],
                            "children": [],
                            "content": ")."
                        },
                        {
                            "type": "Type",
                            "name": "AsyncMock",
                            "range": [
                                535,
                                536
                            ],
                            "children": [],
                            "content": "model_dump_json("
                        }
                    ],
                    "content": ").model_dump_json("
                },
                {
                    "type": "Type",
                    "name": "None",
                    "range": [
                        540,
                        541
                    ],
                    "children": [],
                    "content": "\n\n"
                },
                {
                    "type": "Block",
                    "name": "",
                    "range": [
                        542,
                        659
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "result",
                            "range": [
                                543,
                                639
                            ],
                            "children": [
                                {
                                    "type": "Identifier",
                                    "name": "result",
                                    "range": [
                                        543,
                                        544
                                    ],
                                    "children": [],
                                    "content": "@pytest"
                                },
                                {
                                    "type": "Type",
                                    "name": "ExecutionResult",
                                    "range": [
                                        545,
                                        546
                                    ],
                                    "children": [],
                                    "content": ".mark"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "ExecutionResult",
                                    "range": [
                                        547,
                                        548
                                    ],
                                    "children": [],
                                    "content": ".asyncio"
                                },
                                {
                                    "type": "Argument",
                                    "name": "graph_id",
                                    "range": [
                                        550,
                                        553
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "graph_id",
                                            "range": [
                                                550,
                                                551
                                            ],
                                            "children": [],
                                            "content": "async def"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"test_graph\"",
                                            "range": [
                                                552,
                                                553
                                            ],
                                            "children": [],
                                            "content": "test_send_execution_result_no_subscribers("
                                        }
                                    ],
                                    "content": "async def test_send_execution_result_no_subscribers("
                                },
                                {
                                    "type": "Argument",
                                    "name": "graph_version",
                                    "range": [
                                        555,
                                        558
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "graph_version",
                                            "range": [
                                                555,
                                                556
                                            ],
                                            "children": [],
                                            "content": "connection_manager:"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "1",
                                            "range": [
                                                557,
                                                558
                                            ],
                                            "children": [],
                                            "content": "ConnectionManager,"
                                        }
                                    ],
                                    "content": "connection_manager:ConnectionManager,"
                                },
                                {
                                    "type": "Argument",
                                    "name": "graph_exec_id",
                                    "range": [
                                        560,
                                        563
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "graph_exec_id",
                                            "range": [
                                                560,
                                                561
                                            ],
                                            "children": [],
                                            "content": ":AsyncMock"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"test_exec_id\"",
                                            "range": [
                                                562,
                                                563
                                            ],
                                            "children": [],
                                            "content": "\n)"
                                        }
                                    ],
                                    "content": ":AsyncMock\n)"
                                },
                                {
                                    "type": "Argument",
                                    "name": "node_exec_id",
                                    "range": [
                                        565,
                                        568
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "node_exec_id",
                                            "range": [
                                                565,
                                                566
                                            ],
                                            "children": [],
                                            "content": ">None"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"test_node_exec_id\"",
                                            "range": [
                                                567,
                                                568
                                            ],
                                            "children": [],
                                            "content": ":\n"
                                        }
                                    ],
                                    "content": ">None:\n"
                                },
                                {
                                    "type": "Argument",
                                    "name": "node_id",
                                    "range": [
                                        570,
                                        573
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "node_id",
                                            "range": [
                                                570,
                                                571
                                            ],
                                            "children": [],
                                            "content": ":ExecutionResult"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"test_node_id\"",
                                            "range": [
                                                572,
                                                573
                                            ],
                                            "children": [],
                                            "content": "=ExecutionResult"
                                        }
                                    ],
                                    "content": ":ExecutionResult=ExecutionResult"
                                },
                                {
                                    "type": "Argument",
                                    "name": "block_id",
                                    "range": [
                                        575,
                                        578
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "block_id",
                                            "range": [
                                                575,
                                                576
                                            ],
                                            "children": [],
                                            "content": "\ngraph_id"
                                        },
                                        {
                                            "type": "Literal",
                                            "name": "\"test_block_id\"",
                                            "range": [
                                                577,
                                                578
                                            ],
                                            "children": [],
                                            "content": "=\"test_graph\""
                                        }
                                    ],
                                    "content": "\ngraph_id=\"test_graph\""
                                },
                                {
                                    "type": "Argument",
                                    "name": "status",
                                    "range": [
                                        580,
                                        585
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "status",
                                            "range": [
                                                580,
                                                581
                                            ],
                                            "children": [],
                                            "content": "\ngraph_version"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "ExecutionStatus",
                                            "range": [
                                                582,
                                                583
                                            ],
                                            "children": [],
                                            "content": "=1"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "COMPLETED",
                                            "range": [
                                                584,
                                                585
                                            ],
                                            "children": [],
                                            "content": ",\n"
                                        }
                                    ],
                                    "content": "\ngraph_version=1,\n"
                                },
                                {
                                    "type": "Argument",
                                    "name": "input_data",
                                    "range": [
                                        587,
                                        594
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "input_data",
                                            "range": [
                                                587,
                                                588
                                            ],
                                            "children": [],
                                            "content": "=\"test_exec_id\""
                                        },
                                        {
                                            "type": "ObjectLiteral",
                                            "name": "",
                                            "range": [
                                                589,
                                                594
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "input1",
                                                    "range": [
                                                        590,
                                                        593
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"input1\"",
                                                            "range": [
                                                                590,
                                                                591
                                                            ],
                                                            "children": [],
                                                            "content": "\nnode_exec_id"
                                                        },
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"value1\"",
                                                            "range": [
                                                                592,
                                                                593
                                                            ],
                                                            "children": [],
                                                            "content": "=\"test_node_exec_id\""
                                                        }
                                                    ],
                                                    "content": "\nnode_exec_id=\"test_node_exec_id\""
                                                }
                                            ],
                                            "content": ",\nnode_exec_id=\"test_node_exec_id\","
                                        }
                                    ],
                                    "content": "=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\","
                                },
                                {
                                    "type": "Argument",
                                    "name": "output_data",
                                    "range": [
                                        596,
                                        604
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "output_data",
                                            "range": [
                                                596,
                                                597
                                            ],
                                            "children": [],
                                            "content": "node_id="
                                        },
                                        {
                                            "type": "ObjectLiteral",
                                            "name": "",
                                            "range": [
                                                598,
                                                604
                                            ],
                                            "children": [
                                                {
                                                    "type": "Property",
                                                    "name": "output1",
                                                    "range": [
                                                        599,
                                                        603
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"output1\"",
                                                            "range": [
                                                                599,
                                                                600
                                                            ],
                                                            "children": [],
                                                            "content": ",\n"
                                                        },
                                                        {
                                                            "type": "ArrayLiteral",
                                                            "name": "",
                                                            "range": [
                                                                601,
                                                                603
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"result1\"",
                                                                    "range": [
                                                                        602,
                                                                        603
                                                                    ],
                                                                    "children": [],
                                                                    "content": "=\"test_block_id\""
                                                                }
                                                            ],
                                                            "content": "block_id=\"test_block_id\""
                                                        }
                                                    ],
                                                    "content": ",\nblock_id=\"test_block_id\""
                                                }
                                            ],
                                            "content": "\"test_node_id\",\nblock_id=\"test_block_id\","
                                        }
                                    ],
                                    "content": "node_id=\"test_node_id\",\nblock_id=\"test_block_id\","
                                },
                                {
                                    "type": "Argument",
                                    "name": "add_time",
                                    "range": [
                                        607,
                                        614
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "add_time",
                                            "range": [
                                                607,
                                                608
                                            ],
                                            "children": [],
                                            "content": "=ExecutionStatus"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "datetime",
                                            "range": [
                                                609,
                                                610
                                            ],
                                            "children": [],
                                            "content": ".COMPLETED"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "now",
                                            "range": [
                                                611,
                                                612
                                            ],
                                            "children": [],
                                            "content": ",\n"
                                        }
                                    ],
                                    "content": "=ExecutionStatus.COMPLETED,\ninput_data="
                                },
                                {
                                    "type": "Argument",
                                    "name": "queue_time",
                                    "range": [
                                        616,
                                        619
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "queue_time",
                                            "range": [
                                                616,
                                                617
                                            ],
                                            "children": [],
                                            "content": "\"input1\":"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "None",
                                            "range": [
                                                618,
                                                619
                                            ],
                                            "children": [],
                                            "content": "\"value1\"}"
                                        }
                                    ],
                                    "content": "\"input1\":\"value1\"}"
                                },
                                {
                                    "type": "Argument",
                                    "name": "start_time",
                                    "range": [
                                        621,
                                        628
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "start_time",
                                            "range": [
                                                621,
                                                622
                                            ],
                                            "children": [],
                                            "content": "\noutput_data"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "datetime",
                                            "range": [
                                                623,
                                                624
                                            ],
                                            "children": [],
                                            "content": "={"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "now",
                                            "range": [
                                                625,
                                                626
                                            ],
                                            "children": [],
                                            "content": "\"output1\":"
                                        }
                                    ],
                                    "content": "\noutput_data={\"output1\":[\"result1\""
                                },
                                {
                                    "type": "Argument",
                                    "name": "end_time",
                                    "range": [
                                        630,
                                        637
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "end_time",
                                            "range": [
                                                630,
                                                631
                                            ],
                                            "children": [],
                                            "content": "},"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "datetime",
                                            "range": [
                                                632,
                                                633
                                            ],
                                            "children": [],
                                            "content": "\nadd_time"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "now",
                                            "range": [
                                                634,
                                                635
                                            ],
                                            "children": [],
                                            "content": "=datetime"
                                        }
                                    ],
                                    "content": "},\nadd_time=datetime.now"
                                }
                            ],
                            "content": "@pytest.mark.asyncio\nasync def test_send_execution_result_no_subscribers(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now()"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                642,
                                649
                            ],
                            "children": [
                                {
                                    "type": "Keyword",
                                    "name": "await",
                                    "range": [
                                        642,
                                        643
                                    ],
                                    "children": [],
                                    "content": "queue_time="
                                },
                                {
                                    "type": "CallExpression",
                                    "name": "send_execution_result",
                                    "range": [
                                        643,
                                        648
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "connection_manager",
                                            "range": [
                                                643,
                                                644
                                            ],
                                            "children": [],
                                            "content": "=None"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "result",
                                            "range": [
                                                647,
                                                648
                                            ],
                                            "children": [],
                                            "content": "start_time="
                                        }
                                    ],
                                    "content": "=None,\nstart_time="
                                }
                            ],
                            "content": "queue_time=None,\nstart_time=datetime"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                651,
                                658
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "assert_not_called",
                                    "range": [
                                        651,
                                        656
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "mock_websocket",
                                            "range": [
                                                651,
                                                652
                                            ],
                                            "children": [],
                                            "content": "now("
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "send_text",
                                            "range": [
                                                653,
                                                654
                                            ],
                                            "children": [],
                                            "content": "),"
                                        }
                                    ],
                                    "content": "now(),\nend_time"
                                }
                            ],
                            "content": "now(),\nend_time=datetime"
                        }
                    ],
                    "content": "\n@pytest.mark.asyncio\nasync def test_send_execution_result_no_subscribers(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(),\nqueue_time=None,\nstart_time=datetime.now(),\nend_time=datetime."
                }
            ],
            "content": "data=result.model_dump(),\n).model_dump_json()\n)\n\n\n@pytest.mark.asyncio\nasync def test_send_execution_result_no_subscribers(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(),\nqueue_time=None,\nstart_time=datetime.now(),\nend_time=datetime."
        }
    ],
    "content": "\n@pytest.fixture\ndef connection_manager()->ConnectionManager:\nreturn ConnectionManager()\n\n\n@pytest.fixture\ndef mock_websocket()->AsyncMock:\nwebsocket:AsyncMock=AsyncMock(spec=WebSocket)\nwebsocket.send_text=AsyncMock()\nreturn websocket\n\n\n@pytest.mark.asyncio\nasync def test_connect(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nawait connection_manager.connect(mock_websocket)\nassert mock_websocket in connection_manager.active_connections\nmock_websocket.accept.assert_called_once()\n\n\ndef test_disconnect(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.active_connections.add(mock_websocket)\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\n\nconnection_manager.disconnect(mock_websocket)\n\nassert mock_websocket not in connection_manager.active_connections\nassert mock_websocket not in connection_manager.subscriptions[\"test_graph\"]\n\n\n@pytest.mark.asyncio\nasync def test_subscribe(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nawait connection_manager.subscribe(\"test_graph\",mock_websocket)\nassert mock_websocket in connection_manager.subscriptions[\"test_graph\"]\n\n\n@pytest.mark.asyncio\nasync def test_unsubscribe(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\n\nawait connection_manager.unsubscribe(\"test_graph\",mock_websocket)\n\nassert \"test_graph\" not in connection_manager.subscriptions\n\n\n@pytest.mark.asyncio\nasync def test_send_execution_result(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nconnection_manager.subscriptions[\"test_graph\"]={mock_websocket}\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(tz=timezone.utc),\nqueue_time=None,\nstart_time=datetime.now(tz=timezone.utc),\nend_time=datetime.now(tz=timezone.utc),\n)\n\nawait connection_manager.send_execution_result(result)\n\nmock_websocket.send_text.assert_called_once_with(\nWsMessage(\nmethod=Methods.EXECUTION_EVENT,\nchannel=\"test_graph\",\ndata=result.model_dump(),\n).model_dump_json()\n)\n\n\n@pytest.mark.asyncio\nasync def test_send_execution_result_no_subscribers(\nconnection_manager:ConnectionManager,mock_websocket:AsyncMock\n)->None:\nresult:ExecutionResult=ExecutionResult(\ngraph_id=\"test_graph\",\ngraph_version=1,\ngraph_exec_id=\"test_exec_id\",\nnode_exec_id=\"test_node_exec_id\",\nnode_id=\"test_node_id\",\nblock_id=\"test_block_id\",\nstatus=ExecutionStatus.COMPLETED,\ninput_data={\"input1\":\"value1\"},\noutput_data={\"output1\":[\"result1\"]},\nadd_time=datetime.now(),\nqueue_time=None,\nstart_time=datetime.now(),\nend_time=datetime."
}
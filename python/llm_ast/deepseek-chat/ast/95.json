{
    "type": "Program",
    "name": "Global",
    "range": [
        100,
        882
    ],
    "children": [
        {
            "type": "FunctionDecl",
            "name": "test_graph_creation",
            "range": [
                100,
                431
            ],
            "children": [
                {
                    "type": "Parameter",
                    "name": "server",
                    "range": [
                        104,
                        107
                    ],
                    "children": [],
                    "content": "server:SpinTestServer)"
                },
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        108,
                        431
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "value_block",
                            "range": [
                                114,
                                121
                            ],
                            "children": [],
                            "content": "value_block=StoreValueBlock().id\n"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "input_block",
                            "range": [
                                122,
                                129
                            ],
                            "children": [],
                            "content": "input_block=AgentInputBlock().id\n"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "graph",
                            "range": [
                                131,
                                235
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        133,
                                        235
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "id",
                                            "range": [
                                                136,
                                                138
                                            ],
                                            "children": [],
                                            "content": "id=\"test_graph\""
                                        },
                                        {
                                            "type": "Property",
                                            "name": "name",
                                            "range": [
                                                141,
                                                143
                                            ],
                                            "children": [],
                                            "content": "name=\"TestGraph\""
                                        },
                                        {
                                            "type": "Property",
                                            "name": "description",
                                            "range": [
                                                146,
                                                148
                                            ],
                                            "children": [],
                                            "content": "description=\"Test graph\""
                                        },
                                        {
                                            "type": "Property",
                                            "name": "nodes",
                                            "range": [
                                                151,
                                                199
                                            ],
                                            "children": [
                                                {
                                                    "type": "ArrayExpression",
                                                    "name": "",
                                                    "range": [
                                                        153,
                                                        199
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "ObjectExpression",
                                                            "name": "",
                                                            "range": [
                                                                155,
                                                                164
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Property",
                                                                    "name": "id",
                                                                    "range": [
                                                                        157,
                                                                        159
                                                                    ],
                                                                    "children": [],
                                                                    "content": "id=\"node_1\""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "block_id",
                                                                    "range": [
                                                                        161,
                                                                        163
                                                                    ],
                                                                    "children": [],
                                                                    "content": "block_id=value_block"
                                                                }
                                                            ],
                                                            "content": "Node(id=\"node_1\",block_id=value_block)"
                                                        },
                                                        {
                                                            "type": "ObjectExpression",
                                                            "name": "",
                                                            "range": [
                                                                167,
                                                                184
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Property",
                                                                    "name": "id",
                                                                    "range": [
                                                                        169,
                                                                        171
                                                                    ],
                                                                    "children": [],
                                                                    "content": "id=\"node_2\""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "block_id",
                                                                    "range": [
                                                                        173,
                                                                        175
                                                                    ],
                                                                    "children": [],
                                                                    "content": "block_id=input_block"
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "input_default",
                                                                    "range": [
                                                                        177,
                                                                        183
                                                                    ],
                                                                    "children": [],
                                                                    "content": "input_default={\"name\":\"input\"}"
                                                                }
                                                            ],
                                                            "content": "Node(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"})"
                                                        },
                                                        {
                                                            "type": "ObjectExpression",
                                                            "name": "",
                                                            "range": [
                                                                187,
                                                                196
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Property",
                                                                    "name": "id",
                                                                    "range": [
                                                                        189,
                                                                        191
                                                                    ],
                                                                    "children": [],
                                                                    "content": "id=\"node_3\""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "block_id",
                                                                    "range": [
                                                                        193,
                                                                        195
                                                                    ],
                                                                    "children": [],
                                                                    "content": "block_id=value_block"
                                                                }
                                                            ],
                                                            "content": "Node(id=\"node_3\",block_id=value_block)"
                                                        }
                                                    ],
                                                    "content": "[\nNode(id=\"node_1\",block_id=value_block),\nNode(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"}),\nNode(id=\"node_3\",block_id=value_block),\n]"
                                                }
                                            ],
                                            "content": "nodes=[\nNode(id=\"node_1\",block_id=value_block),\nNode(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"}),\nNode(id=\"node_3\",block_id=value_block),\n]"
                                        },
                                        {
                                            "type": "Property",
                                            "name": "links",
                                            "range": [
                                                202,
                                                232
                                            ],
                                            "children": [
                                                {
                                                    "type": "ArrayExpression",
                                                    "name": "",
                                                    "range": [
                                                        204,
                                                        232
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "ObjectExpression",
                                                            "name": "",
                                                            "range": [
                                                                206,
                                                                229
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Property",
                                                                    "name": "source_id",
                                                                    "range": [
                                                                        209,
                                                                        211
                                                                    ],
                                                                    "children": [],
                                                                    "content": "source_id=\"node_1\""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "sink_id",
                                                                    "range": [
                                                                        214,
                                                                        216
                                                                    ],
                                                                    "children": [],
                                                                    "content": "sink_id=\"node_2\""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "source_name",
                                                                    "range": [
                                                                        219,
                                                                        221
                                                                    ],
                                                                    "children": [],
                                                                    "content": "source_name=\"output\""
                                                                },
                                                                {
                                                                    "type": "Property",
                                                                    "name": "sink_name",
                                                                    "range": [
                                                                        224,
                                                                        226
                                                                    ],
                                                                    "children": [],
                                                                    "content": "sink_name=\"name\""
                                                                }
                                                            ],
                                                            "content": "Link(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n)"
                                                        }
                                                    ],
                                                    "content": "[\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n),\n]"
                                                }
                                            ],
                                            "content": "links=[\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n),\n]"
                                        }
                                    ],
                                    "content": "Graph(\nid=\"test_graph\",\nname=\"TestGraph\",\ndescription=\"Test graph\",\nnodes=[\nNode(id=\"node_1\",block_id=value_block),\nNode(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"}),\nNode(id=\"node_3\",block_id=value_block),\n],\nlinks=[\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n),\n],\n)"
                                }
                            ],
                            "content": "graph=Graph(\nid=\"test_graph\",\nname=\"TestGraph\",\ndescription=\"Test graph\",\nnodes=[\nNode(id=\"node_1\",block_id=value_block),\nNode(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"}),\nNode(id=\"node_3\",block_id=value_block),\n],\nlinks=[\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n),\n],\n)"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "create_graph",
                            "range": [
                                237,
                                245
                            ],
                            "children": [],
                            "content": "create_graph=CreateGraph(graph=graph)\n"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "created_graph",
                            "range": [
                                246,
                                261
                            ],
                            "children": [],
                            "content": "created_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                263,
                                270
                            ],
                            "children": [],
                            "content": "assert UUID(created_graph.id)\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                271,
                                278
                            ],
                            "children": [],
                            "content": "assert created_graph.name==\"TestGraph\"\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                280,
                                290
                            ],
                            "children": [],
                            "content": "assert len(created_graph.nodes)==3\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                291,
                                303
                            ],
                            "children": [],
                            "content": "assert UUID(created_graph.nodes[0].id)\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                304,
                                316
                            ],
                            "children": [],
                            "content": "assert UUID(created_graph.nodes[1].id)\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                317,
                                329
                            ],
                            "children": [],
                            "content": "assert UUID(created_graph.nodes[2].id)\n"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "nodes",
                            "range": [
                                331,
                                336
                            ],
                            "children": [],
                            "content": "nodes=created_graph.nodes\n"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "links",
                            "range": [
                                337,
                                342
                            ],
                            "children": [],
                            "content": "links=created_graph.links\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                343,
                                351
                            ],
                            "children": [],
                            "content": "assert len(links)==1\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                352,
                                367
                            ],
                            "children": [],
                            "content": "assert links[0].source_id!=links[0].sink_id\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                368,
                                398
                            ],
                            "children": [],
                            "content": "assert links[0].source_id in{nodes[0].id,nodes[1].id,nodes[2].id}\n"
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                399,
                                429
                            ],
                            "children": [],
                            "content": "assert links[0].sink_id in{nodes[0].id,nodes[1].id,nodes[2].id}\n"
                        }
                    ],
                    "content": ":\n\"\"\" \\n     Test the creation of a graph with nodes and links. \\n  \\n     This test ensures that: \\n     1. A graph can be successfully created with valid connections. \\n     2. The created graph has the correct structure and properties. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id\ninput_block=AgentInputBlock().id\n\ngraph=Graph(\nid=\"test_graph\",\nname=\"TestGraph\",\ndescription=\"Test graph\",\nnodes=[\nNode(id=\"node_1\",block_id=value_block),\nNode(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"}),\nNode(id=\"node_3\",block_id=value_block),\n],\nlinks=[\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n),\n],\n)\ncreate_graph=CreateGraph(graph=graph)\ncreated_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)\n\nassert UUID(created_graph.id)\nassert created_graph.name==\"TestGraph\"\n\nassert len(created_graph.nodes)==3\nassert UUID(created_graph.nodes[0].id)\nassert UUID(created_graph.nodes[1].id)\nassert UUID(created_graph.nodes[2].id)\n\nnodes=created_graph.nodes\nlinks=created_graph.links\nassert len(links)==1\nassert links[0].source_id!=links[0].sink_id\nassert links[0].source_id in{nodes[0].id,nodes[1].id,nodes[2].id}\nassert links[0].sink_id in{nodes[0].id,nodes[1].id,nodes[2].id}\n\n\n"
                }
            ],
            "content": "async def test_graph_creation(server:SpinTestServer):\n\"\"\" \\n     Test the creation of a graph with nodes and links. \\n  \\n     This test ensures that: \\n     1. A graph can be successfully created with valid connections. \\n     2. The created graph has the correct structure and properties. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id\ninput_block=AgentInputBlock().id\n\ngraph=Graph(\nid=\"test_graph\",\nname=\"TestGraph\",\ndescription=\"Test graph\",\nnodes=[\nNode(id=\"node_1\",block_id=value_block),\nNode(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"}),\nNode(id=\"node_3\",block_id=value_block),\n],\nlinks=[\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n),\n],\n)\ncreate_graph=CreateGraph(graph=graph)\ncreated_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)\n\nassert UUID(created_graph.id)\nassert created_graph.name==\"TestGraph\"\n\nassert len(created_graph.nodes)==3\nassert UUID(created_graph.nodes[0].id)\nassert UUID(created_graph.nodes[1].id)\nassert UUID(created_graph.nodes[2].id)\n\nnodes=created_graph.nodes\nlinks=created_graph.links\nassert len(links)==1\nassert links[0].source_id!=links[0].sink_id\nassert links[0].source_id in{nodes[0].id,nodes[1].id,nodes[2].id}\nassert links[0].sink_id in{nodes[0].id,nodes[1].id,nodes[2].id}\n\n\n"
        },
        {
            "type": "Decorator",
            "name": "@pytest.mark.asyncio",
            "range": [
                432,
                442
            ],
            "children": [],
            "content": "@pytest.mark.asyncio(scope=\"session\")"
        },
        {
            "type": "FunctionDecl",
            "name": "test_get_input_schema",
            "range": [
                444,
                882
            ],
            "children": [
                {
                    "type": "Async",
                    "name": "async",
                    "range": [
                        444,
                        449
                    ],
                    "children": [],
                    "content": "async def test_get_input_schema(server:"
                },
                {
                    "type": "Def",
                    "name": "def",
                    "range": [
                        445,
                        448
                    ],
                    "children": [],
                    "content": "def test_get_input_schema(server"
                },
                {
                    "type": "FunctionName",
                    "name": "test_get_input_schema",
                    "range": [
                        446,
                        466
                    ],
                    "children": [],
                    "content": "test_get_input_schema(server:SpinTestServer):\n\"\"\" \\n     Test the get_input_schema method of a created graph. \\n  \\n     This test ensures that: \\n     1. A graph can be created with a single node. \\n     2. The input schema of the created graph is correctly generated. \\n     3. The input schema contains the expected input name and node id. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id\ninput_block"
                },
                {
                    "type": "Parameters",
                    "name": "",
                    "range": [
                        447,
                        451
                    ],
                    "children": [
                        {
                            "type": "Parameter",
                            "name": "server",
                            "range": [
                                448,
                                450
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": ":",
                                    "range": [
                                        449,
                                        450
                                    ],
                                    "children": [
                                        {
                                            "type": "Type",
                                            "name": "SpinTestServer",
                                            "range": [
                                                450,
                                                464
                                            ],
                                            "children": [],
                                            "content": "SpinTestServer):\n\"\"\" \\n     Test the get_input_schema method of a created graph. \\n  \\n     This test ensures that: \\n     1. A graph can be created with a single node. \\n     2. The input schema of the created graph is correctly generated. \\n     3. The input schema contains the expected input name and node id. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id"
                                        }
                                    ],
                                    "content": ":SpinTestServer"
                                }
                            ],
                            "content": "server:SpinTestServer"
                        }
                    ],
                    "content": "(server:SpinTestServer)"
                },
                {
                    "type": "FunctionBody",
                    "name": "",
                    "range": [
                        452,
                        882
                    ],
                    "children": [
                        {
                            "type": "Docstring",
                            "name": "",
                            "range": [
                                453,
                                456
                            ],
                            "children": [],
                            "content": "\n\"\"\" \\n     Test the get_input_schema method of a created graph. \\n  \\n     This test ensures that: \\n     1. A graph can be created with a single node. \\n     2. The input schema of the created graph is correctly generated. \\n     3. The input schema contains the expected input name and node id. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\""
                        },
                        {
                            "type": "Assignment",
                            "name": "value_block = StoreValueBlock().id",
                            "range": [
                                458,
                                465
                            ],
                            "children": [],
                            "content": "value_block=StoreValueBlock().id\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "input_block = AgentInputBlock().id",
                            "range": [
                                466,
                                473
                            ],
                            "children": [],
                            "content": "input_block=AgentInputBlock().id\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "output_block = AgentOutputBlock().id",
                            "range": [
                                474,
                                481
                            ],
                            "children": [],
                            "content": "output_block=AgentOutputBlock().id\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "graph = Graph",
                            "range": [
                                483,
                                732
                            ],
                            "children": [
                                {
                                    "type": "KeywordArgument",
                                    "name": "name",
                                    "range": [
                                        488,
                                        490
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"TestInputSchema\"",
                                            "range": [
                                                490,
                                                504
                                            ],
                                            "children": [],
                                            "content": "\"TestInputSchema\",\ndescription=\"Test input schema\",\nnodes=[\nNode(\n"
                                        }
                                    ],
                                    "content": "name=\"TestInputSchema\""
                                },
                                {
                                    "type": "KeywordArgument",
                                    "name": "description",
                                    "range": [
                                        493,
                                        495
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"Test input schema\"",
                                            "range": [
                                                495,
                                                513
                                            ],
                                            "children": [],
                                            "content": "\"Test input schema\",\nnodes=[\nNode(\nid=\"node_0_a\",\nblock_id=input_block,"
                                        }
                                    ],
                                    "content": "description=\"Test input schema\""
                                },
                                {
                                    "type": "KeywordArgument",
                                    "name": "nodes",
                                    "range": [
                                        498,
                                        500
                                    ],
                                    "children": [
                                        {
                                            "type": "List",
                                            "name": "",
                                            "range": [
                                                500,
                                                644
                                            ],
                                            "children": [
                                                {
                                                    "type": "Node",
                                                    "name": "Node",
                                                    "range": [
                                                        502,
                                                        541
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "id",
                                                            "range": [
                                                                505,
                                                                507
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_0_a\"",
                                                                    "range": [
                                                                        507,
                                                                        517
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_0_a\",\nblock_id=input_block,\ninput_default={"
                                                                }
                                                            ],
                                                            "content": "id=\"node_0_a\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "block_id",
                                                            "range": [
                                                                510,
                                                                512
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "input_block",
                                                                    "range": [
                                                                        512,
                                                                        523
                                                                    ],
                                                                    "children": [],
                                                                    "content": "input_block,\ninput_default={\"name\":\"in_key_a\",\"title\":"
                                                                }
                                                            ],
                                                            "content": "block_id=input_block"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "input_default",
                                                            "range": [
                                                                515,
                                                                517
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Dict",
                                                                    "name": "",
                                                                    "range": [
                                                                        517,
                                                                        529
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "name",
                                                                            "range": [
                                                                                518,
                                                                                520
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"in_key_a\"",
                                                                                    "range": [
                                                                                        520,
                                                                                        530
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"},"
                                                                                }
                                                                            ],
                                                                            "content": "\"name\":\"in_key_a\""
                                                                        },
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "title",
                                                                            "range": [
                                                                                522,
                                                                                524
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"Key A\"",
                                                                                    "range": [
                                                                                        524,
                                                                                        531
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"Key A\",\"value\":\"A\"},\n"
                                                                                }
                                                                            ],
                                                                            "content": "\"title\":\"Key A\""
                                                                        },
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "value",
                                                                            "range": [
                                                                                526,
                                                                                528
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"A\"",
                                                                                    "range": [
                                                                                        528,
                                                                                        529
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"A\"}"
                                                                                }
                                                                            ],
                                                                            "content": "\"value\":\"A\""
                                                                        }
                                                                    ],
                                                                    "content": "{\"name\":\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"}"
                                                                }
                                                            ],
                                                            "content": "input_default={"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "metadata",
                                                            "range": [
                                                                532,
                                                                534
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Dict",
                                                                    "name": "",
                                                                    "range": [
                                                                        534,
                                                                        538
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "id",
                                                                            "range": [
                                                                                535,
                                                                                537
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"node_0_a\"",
                                                                                    "range": [
                                                                                        537,
                                                                                        538
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"node_0_a\"}"
                                                                                }
                                                                            ],
                                                                            "content": "\"id\":\"node_0_a\""
                                                                        }
                                                                    ],
                                                                    "content": "{\"id\":\"node_0_a\"}"
                                                                }
                                                            ],
                                                            "content": "metadata={"
                                                        }
                                                    ],
                                                    "content": "Node(\nid=\"node_0_a\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"},\nmetadata={\"id\":\"node_0_a\"},\n)"
                                                },
                                                {
                                                    "type": "Node",
                                                    "name": "Node",
                                                    "range": [
                                                        544,
                                                        579
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "id",
                                                            "range": [
                                                                547,
                                                                549
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_0_b\"",
                                                                    "range": [
                                                                        549,
                                                                        559
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_0_b\",\nblock_id=input_block,\ninput_default={"
                                                                }
                                                            ],
                                                            "content": "id=\"node_0_b\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "block_id",
                                                            "range": [
                                                                552,
                                                                554
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "input_block",
                                                                    "range": [
                                                                        554,
                                                                        565
                                                                    ],
                                                                    "children": [],
                                                                    "content": "input_block,\ninput_default={\"name\":\"in_key_b\",\"advanced\":"
                                                                }
                                                            ],
                                                            "content": "block_id=input_block"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "input_default",
                                                            "range": [
                                                                557,
                                                                559
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Dict",
                                                                    "name": "",
                                                                    "range": [
                                                                        559,
                                                                        567
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "name",
                                                                            "range": [
                                                                                560,
                                                                                562
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"in_key_b\"",
                                                                                    "range": [
                                                                                        562,
                                                                                        572
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"in_key_b\",\"advanced\":True},\nmetadata={"
                                                                                }
                                                                            ],
                                                                            "content": "\"name\":\"in_key_b\""
                                                                        },
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "advanced",
                                                                            "range": [
                                                                                564,
                                                                                566
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "True",
                                                                                    "range": [
                                                                                        566,
                                                                                        567
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "True}"
                                                                                }
                                                                            ],
                                                                            "content": "\"advanced\":True"
                                                                        }
                                                                    ],
                                                                    "content": "{\"name\":\"in_key_b\",\"advanced\":True}"
                                                                }
                                                            ],
                                                            "content": "input_default={"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "metadata",
                                                            "range": [
                                                                570,
                                                                572
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Dict",
                                                                    "name": "",
                                                                    "range": [
                                                                        572,
                                                                        576
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "id",
                                                                            "range": [
                                                                                573,
                                                                                575
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"node_0_b\"",
                                                                                    "range": [
                                                                                        575,
                                                                                        576
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"node_0_b\"}"
                                                                                }
                                                                            ],
                                                                            "content": "\"id\":\"node_0_b\""
                                                                        }
                                                                    ],
                                                                    "content": "{\"id\":\"node_0_b\"}"
                                                                }
                                                            ],
                                                            "content": "metadata={"
                                                        }
                                                    ],
                                                    "content": "Node(\nid=\"node_0_b\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_b\",\"advanced\":True},\nmetadata={\"id\":\"node_0_b\"},\n)"
                                                },
                                                {
                                                    "type": "Node",
                                                    "name": "Node",
                                                    "range": [
                                                        582,
                                                        599
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "id",
                                                            "range": [
                                                                585,
                                                                587
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_1\"",
                                                                    "range": [
                                                                        587,
                                                                        597
                                                                    ],
                                                                    "children": [],
                                                                    "content": ",block_id=value_block,metadata={\"id\":\"node_1\""
                                                                }
                                                            ],
                                                            "content": "=\"node_1\","
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "block_id",
                                                            "range": [
                                                                590,
                                                                592
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "value_block",
                                                                    "range": [
                                                                        592,
                                                                        603
                                                                    ],
                                                                    "children": [],
                                                                    "content": "metadata={\"id\":\"node_1\"}),\nNode("
                                                                }
                                                            ],
                                                            "content": "value_block,metadata"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "metadata",
                                                            "range": [
                                                                593,
                                                                595
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Dict",
                                                                    "name": "",
                                                                    "range": [
                                                                        595,
                                                                        598
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "id",
                                                                            "range": [
                                                                                596,
                                                                                598
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"node_1\"",
                                                                                    "range": [
                                                                                        598,
                                                                                        599
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "})"
                                                                                }
                                                                            ],
                                                                            "content": ":\"node_1\"}"
                                                                        }
                                                                    ],
                                                                    "content": "\"id\":\"node_1\"}"
                                                                }
                                                            ],
                                                            "content": "={\"id\""
                                                        }
                                                    ],
                                                    "content": "Node(id=\"node_1\",block_id=value_block,metadata={\"id\":\"node_1\"})"
                                                },
                                                {
                                                    "type": "Node",
                                                    "name": "Node",
                                                    "range": [
                                                        602,
                                                        641
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "id",
                                                            "range": [
                                                                605,
                                                                607
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_2\"",
                                                                    "range": [
                                                                        607,
                                                                        617
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_2\",\nblock_id=output_block,\ninput_default={"
                                                                }
                                                            ],
                                                            "content": "id=\"node_2\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "block_id",
                                                            "range": [
                                                                610,
                                                                612
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "output_block",
                                                                    "range": [
                                                                        612,
                                                                        623
                                                                    ],
                                                                    "children": [],
                                                                    "content": "output_block,\ninput_default={\n\"name\":\"out_key\",\n"
                                                                }
                                                            ],
                                                            "content": "block_id=output_block"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "input_default",
                                                            "range": [
                                                                615,
                                                                617
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Dict",
                                                                    "name": "",
                                                                    "range": [
                                                                        617,
                                                                        629
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "name",
                                                                            "range": [
                                                                                619,
                                                                                621
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"out_key\"",
                                                                                    "range": [
                                                                                        621,
                                                                                        631
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"out_key\",\n\"description\":\"This is an output key\",\n},\n"
                                                                                }
                                                                            ],
                                                                            "content": "\"name\":\"out_key\""
                                                                        },
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "description",
                                                                            "range": [
                                                                                624,
                                                                                626
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"This is an output key\"",
                                                                                    "range": [
                                                                                        626,
                                                                                        647
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"This is an output key\",\n},\nmetadata={\"id\":\"node_2\"},\n),\n],\nlinks"
                                                                                }
                                                                            ],
                                                                            "content": "\"description\":\"This is an output key\""
                                                                        }
                                                                    ],
                                                                    "content": "{\n\"name\":\"out_key\",\n\"description\":\"This is an output key\",\n}"
                                                                }
                                                            ],
                                                            "content": "input_default={"
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "metadata",
                                                            "range": [
                                                                632,
                                                                634
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Dict",
                                                                    "name": "",
                                                                    "range": [
                                                                        634,
                                                                        638
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "KeyValuePair",
                                                                            "name": "id",
                                                                            "range": [
                                                                                635,
                                                                                637
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Literal",
                                                                                    "name": "\"node_2\"",
                                                                                    "range": [
                                                                                        637,
                                                                                        638
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"node_2\"}"
                                                                                }
                                                                            ],
                                                                            "content": "\"id\":\"node_2\""
                                                                        }
                                                                    ],
                                                                    "content": "{\"id\":\"node_2\"}"
                                                                }
                                                            ],
                                                            "content": "metadata={"
                                                        }
                                                    ],
                                                    "content": "Node(\nid=\"node_2\",\nblock_id=output_block,\ninput_default={\n\"name\":\"out_key\",\n\"description\":\"This is an output key\",\n},\nmetadata={\"id\":\"node_2\"},\n)"
                                                }
                                            ],
                                            "content": "[\nNode(\nid=\"node_0_a\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"},\nmetadata={\"id\":\"node_0_a\"},\n),\nNode(\nid=\"node_0_b\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_b\",\"advanced\":True},\nmetadata={\"id\":\"node_0_b\"},\n),\nNode(id=\"node_1\",block_id=value_block,metadata={\"id\":\"node_1\"}),\nNode(\nid=\"node_2\",\nblock_id=output_block,\ninput_default={\n\"name\":\"out_key\",\n\"description\":\"This is an output key\",\n},\nmetadata={\"id\":\"node_2\"},\n),\n]"
                                        }
                                    ],
                                    "content": "nodes=["
                                },
                                {
                                    "type": "KeywordArgument",
                                    "name": "links",
                                    "range": [
                                        647,
                                        649
                                    ],
                                    "children": [
                                        {
                                            "type": "List",
                                            "name": "",
                                            "range": [
                                                649,
                                                729
                                            ],
                                            "children": [
                                                {
                                                    "type": "Link",
                                                    "name": "Link",
                                                    "range": [
                                                        651,
                                                        674
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "source_id",
                                                            "range": [
                                                                654,
                                                                656
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_0_a\"",
                                                                    "range": [
                                                                        656,
                                                                        666
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_0_a\",\nsink_id=\"node_1\",\nsource_name=\"result\""
                                                                }
                                                            ],
                                                            "content": "source_id=\"node_0_a\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "sink_id",
                                                            "range": [
                                                                659,
                                                                661
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_1\"",
                                                                    "range": [
                                                                        661,
                                                                        671
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\""
                                                                }
                                                            ],
                                                            "content": "sink_id=\"node_1\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "source_name",
                                                            "range": [
                                                                664,
                                                                666
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"result\"",
                                                                    "range": [
                                                                        666,
                                                                        674
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"result\",\nsink_name=\"input\",\n)"
                                                                }
                                                            ],
                                                            "content": "source_name=\"result\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "sink_name",
                                                            "range": [
                                                                669,
                                                                671
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"input\"",
                                                                    "range": [
                                                                        671,
                                                                        678
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"input\",\n),\nLink("
                                                                }
                                                            ],
                                                            "content": "sink_name=\"input\""
                                                        }
                                                    ],
                                                    "content": "Link(\nsource_id=\"node_0_a\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n)"
                                                },
                                                {
                                                    "type": "Link",
                                                    "name": "Link",
                                                    "range": [
                                                        677,
                                                        700
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "source_id",
                                                            "range": [
                                                                680,
                                                                682
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_0_b\"",
                                                                    "range": [
                                                                        682,
                                                                        692
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_0_b\",\nsink_id=\"node_1\",\nsource_name=\"result\""
                                                                }
                                                            ],
                                                            "content": "source_id=\"node_0_b\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "sink_id",
                                                            "range": [
                                                                685,
                                                                687
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_1\"",
                                                                    "range": [
                                                                        687,
                                                                        697
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\""
                                                                }
                                                            ],
                                                            "content": "sink_id=\"node_1\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "source_name",
                                                            "range": [
                                                                690,
                                                                692
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"result\"",
                                                                    "range": [
                                                                        692,
                                                                        700
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"result\",\nsink_name=\"input\",\n)"
                                                                }
                                                            ],
                                                            "content": "source_name=\"result\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "sink_name",
                                                            "range": [
                                                                695,
                                                                697
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"input\"",
                                                                    "range": [
                                                                        697,
                                                                        704
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"input\",\n),\nLink("
                                                                }
                                                            ],
                                                            "content": "sink_name=\"input\""
                                                        }
                                                    ],
                                                    "content": "Link(\nsource_id=\"node_0_b\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n)"
                                                },
                                                {
                                                    "type": "Link",
                                                    "name": "Link",
                                                    "range": [
                                                        703,
                                                        726
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "source_id",
                                                            "range": [
                                                                706,
                                                                708
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_1\"",
                                                                    "range": [
                                                                        708,
                                                                        718
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\""
                                                                }
                                                            ],
                                                            "content": "source_id=\"node_1\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "sink_id",
                                                            "range": [
                                                                711,
                                                                713
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"node_2\"",
                                                                    "range": [
                                                                        713,
                                                                        723
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"node_2\",\nsource_name=\"output\",\nsink_name=\"value\""
                                                                }
                                                            ],
                                                            "content": "sink_id=\"node_2\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "source_name",
                                                            "range": [
                                                                716,
                                                                718
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"output\"",
                                                                    "range": [
                                                                        718,
                                                                        726
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"output\",\nsink_name=\"value\",\n)"
                                                                }
                                                            ],
                                                            "content": "source_name=\"output\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "sink_name",
                                                            "range": [
                                                                721,
                                                                723
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"value\"",
                                                                    "range": [
                                                                        723,
                                                                        730
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"value\",\n),\n],"
                                                                }
                                                            ],
                                                            "content": "sink_name=\"value\""
                                                        }
                                                    ],
                                                    "content": "Link(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"value\",\n)"
                                                }
                                            ],
                                            "content": "[\nLink(\nsource_id=\"node_0_a\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_0_b\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"value\",\n),\n]"
                                        }
                                    ],
                                    "content": "links=["
                                }
                            ],
                            "content": "graph=Graph(\nname=\"TestInputSchema\",\ndescription=\"Test input schema\",\nnodes=[\nNode(\nid=\"node_0_a\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"},\nmetadata={\"id\":\"node_0_a\"},\n),\nNode(\nid=\"node_0_b\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_b\",\"advanced\":True},\nmetadata={\"id\":\"node_0_b\"},\n),\nNode(id=\"node_1\",block_id=value_block,metadata={\"id\":\"node_1\"}),\nNode(\nid=\"node_2\",\nblock_id=output_block,\ninput_default={\n\"name\":\"out_key\",\n\"description\":\"This is an output key\",\n},\nmetadata={\"id\":\"node_2\"},\n),\n],\nlinks=[\nLink(\nsource_id=\"node_0_a\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_0_b\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"value\",\n),\n],\n)"
                        },
                        {
                            "type": "Assignment",
                            "name": "create_graph = CreateGraph",
                            "range": [
                                735,
                                742
                            ],
                            "children": [
                                {
                                    "type": "KeywordArgument",
                                    "name": "graph",
                                    "range": [
                                        739,
                                        741
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "graph",
                                            "range": [
                                                741,
                                                746
                                            ],
                                            "children": [],
                                            "content": "graph)\ncreated_graph=await"
                                        }
                                    ],
                                    "content": "graph=graph"
                                }
                            ],
                            "content": "create_graph=CreateGraph(graph=graph)"
                        },
                        {
                            "type": "Assignment",
                            "name": "created_graph = await server.agent_server.test_create_graph",
                            "range": [
                                744,
                                758
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "",
                                    "range": [
                                        751,
                                        757
                                    ],
                                    "children": [
                                        {
                                            "type": "Identifier",
                                            "name": "create_graph",
                                            "range": [
                                                754,
                                                766
                                            ],
                                            "children": [],
                                            "content": "create_graph,DEFAULT_USER_ID\n)\n\nclass ExpectedInputSchema(BlockSchema):"
                                        },
                                        {
                                            "type": "Identifier",
                                            "name": "DEFAULT_USER_ID",
                                            "range": [
                                                756,
                                                770
                                            ],
                                            "children": [],
                                            "content": "DEFAULT_USER_ID\n)\n\nclass ExpectedInputSchema(BlockSchema):\nin_key_a:Any"
                                        }
                                    ],
                                    "content": "test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n"
                                }
                            ],
                            "content": "created_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)"
                        },
                        {
                            "type": "ClassDecl",
                            "name": "ExpectedInputSchema",
                            "range": [
                                761,
                                801
                            ],
                            "children": [
                                {
                                    "type": "ClassBody",
                                    "name": "",
                                    "range": [
                                        767,
                                        801
                                    ],
                                    "children": [
                                        {
                                            "type": "ClassVariable",
                                            "name": "in_key_a: Any = SchemaField",
                                            "range": [
                                                768,
                                                785
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "",
                                                    "range": [
                                                        772,
                                                        785
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "title",
                                                            "range": [
                                                                774,
                                                                776
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"Key A\"",
                                                                    "range": [
                                                                        776,
                                                                        785
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"Key A\",default=\"A\",advanced=False)"
                                                                }
                                                            ],
                                                            "content": "title=\"Key A\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "default",
                                                            "range": [
                                                                778,
                                                                780
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"A\"",
                                                                    "range": [
                                                                        780,
                                                                        785
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"A\",advanced=False)"
                                                                }
                                                            ],
                                                            "content": "default=\"A\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "advanced",
                                                            "range": [
                                                                782,
                                                                784
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "False",
                                                                    "range": [
                                                                        784,
                                                                        785
                                                                    ],
                                                                    "children": [],
                                                                    "content": "False)"
                                                                }
                                                            ],
                                                            "content": "advanced=False"
                                                        }
                                                    ],
                                                    "content": "SchemaField(title=\"Key A\",default=\"A\",advanced=False)"
                                                }
                                            ],
                                            "content": "in_key_a:Any=SchemaField(title=\"Key A\",default=\"A\",advanced=False)"
                                        },
                                        {
                                            "type": "ClassVariable",
                                            "name": "in_key_b: Any = SchemaField",
                                            "range": [
                                                787,
                                                800
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "",
                                                    "range": [
                                                        791,
                                                        800
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "title",
                                                            "range": [
                                                                793,
                                                                795
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"in_key_b\"",
                                                                    "range": [
                                                                        795,
                                                                        805
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"in_key_b\",advanced=True)\n\nclass ExpectedOutputSchema("
                                                                }
                                                            ],
                                                            "content": "title=\"in_key_b\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "advanced",
                                                            "range": [
                                                                797,
                                                                799
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "True",
                                                                    "range": [
                                                                        799,
                                                                        800
                                                                    ],
                                                                    "children": [],
                                                                    "content": "True)"
                                                                }
                                                            ],
                                                            "content": "advanced=True"
                                                        }
                                                    ],
                                                    "content": "SchemaField(title=\"in_key_b\",advanced=True)"
                                                }
                                            ],
                                            "content": "in_key_b:Any=SchemaField(title=\"in_key_b\",advanced=True)"
                                        }
                                    ],
                                    "content": "\nin_key_a:Any=SchemaField(title=\"Key A\",default=\"A\",advanced=False)\nin_key_b:Any=SchemaField(title=\"in_key_b\",advanced=True)\n"
                                }
                            ],
                            "content": "class ExpectedInputSchema(BlockSchema):\nin_key_a:Any=SchemaField(title=\"Key A\",default=\"A\",advanced=False)\nin_key_b:Any=SchemaField(title=\"in_key_b\",advanced=True)\n"
                        },
                        {
                            "type": "ClassDecl",
                            "name": "ExpectedOutputSchema",
                            "range": [
                                803,
                                833
                            ],
                            "children": [
                                {
                                    "type": "ClassBody",
                                    "name": "",
                                    "range": [
                                        809,
                                        833
                                    ],
                                    "children": [
                                        {
                                            "type": "ClassVariable",
                                            "name": "out_key: Any = SchemaField",
                                            "range": [
                                                810,
                                                832
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "",
                                                    "range": [
                                                        814,
                                                        832
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "description",
                                                            "range": [
                                                                817,
                                                                819
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"This is an output key\"",
                                                                    "range": [
                                                                        819,
                                                                        840
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)\n\ninput_schema=created_graph.input_schema\n"
                                                                }
                                                            ],
                                                            "content": "description=\"This is an output key\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "title",
                                                            "range": [
                                                                822,
                                                                824
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"out_key\"",
                                                                    "range": [
                                                                        824,
                                                                        833
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"out_key\",\nadvanced=False,\n)\n"
                                                                }
                                                            ],
                                                            "content": "title=\"out_key\""
                                                        },
                                                        {
                                                            "type": "KeywordArgument",
                                                            "name": "advanced",
                                                            "range": [
                                                                827,
                                                                829
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "False",
                                                                    "range": [
                                                                        829,
                                                                        832
                                                                    ],
                                                                    "children": [],
                                                                    "content": "False,\n)"
                                                                }
                                                            ],
                                                            "content": "advanced=False"
                                                        }
                                                    ],
                                                    "content": "SchemaField(\ndescription=\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)"
                                                }
                                            ],
                                            "content": "out_key:Any=SchemaField(\ndescription=\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)"
                                        }
                                    ],
                                    "content": "\nout_key:Any=SchemaField(\ndescription=\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)\n"
                                }
                            ],
                            "content": "class ExpectedOutputSchema(BlockSchema):\nout_key:Any=SchemaField(\ndescription=\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "input_schema = created_graph.input_schema",
                            "range": [
                                835,
                                840
                            ],
                            "children": [],
                            "content": "input_schema=created_graph.input_schema\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "input_schema[\"title\"] = \"ExpectedInputSchema\"",
                            "range": [
                                841,
                                847
                            ],
                            "children": [],
                            "content": "input_schema[\"title\"]=\"ExpectedInputSchema\"\n"
                        },
                        {
                            "type": "Assert",
                            "name": "assert input_schema == ExpectedInputSchema.jsonschema()",
                            "range": [
                                848,
                                857
                            ],
                            "children": [],
                            "content": "assert input_schema==ExpectedInputSchema.jsonschema()\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "output_schema = created_graph.output_schema",
                            "range": [
                                859,
                                864
                            ],
                            "children": [],
                            "content": "output_schema=created_graph.output_schema\n"
                        },
                        {
                            "type": "Assignment",
                            "name": "output_schema[\"title\"] = \"ExpectedOutputSchema\"",
                            "range": [
                                865,
                                871
                            ],
                            "children": [],
                            "content": "output_schema[\"title\"]=\"ExpectedOutputSchema\"\n"
                        },
                        {
                            "type": "Assert",
                            "name": "assert output_schema == ExpectedOutputSchema.jsonschema()",
                            "range": [
                                872,
                                881
                            ],
                            "children": [],
                            "content": "assert output_schema==ExpectedOutputSchema.jsonschema()\n"
                        }
                    ],
                    "content": ":\n\"\"\" \\n     Test the get_input_schema method of a created graph. \\n  \\n     This test ensures that: \\n     1. A graph can be created with a single node. \\n     2. The input schema of the created graph is correctly generated. \\n     3. The input schema contains the expected input name and node id. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id\ninput_block=AgentInputBlock().id\noutput_block=AgentOutputBlock().id\n\ngraph=Graph(\nname=\"TestInputSchema\",\ndescription=\"Test input schema\",\nnodes=[\nNode(\nid=\"node_0_a\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"},\nmetadata={\"id\":\"node_0_a\"},\n),\nNode(\nid=\"node_0_b\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_b\",\"advanced\":True},\nmetadata={\"id\":\"node_0_b\"},\n),\nNode(id=\"node_1\",block_id=value_block,metadata={\"id\":\"node_1\"}),\nNode(\nid=\"node_2\",\nblock_id=output_block,\ninput_default={\n\"name\":\"out_key\",\n\"description\":\"This is an output key\",\n},\nmetadata={\"id\":\"node_2\"},\n),\n],\nlinks=[\nLink(\nsource_id=\"node_0_a\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_0_b\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"value\",\n),\n],\n)\n\ncreate_graph=CreateGraph(graph=graph)\ncreated_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)\n\nclass ExpectedInputSchema(BlockSchema):\nin_key_a:Any=SchemaField(title=\"Key A\",default=\"A\",advanced=False)\nin_key_b:Any=SchemaField(title=\"in_key_b\",advanced=True)\n\nclass ExpectedOutputSchema(BlockSchema):\nout_key:Any=SchemaField(\ndescription=\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)\n\ninput_schema=created_graph.input_schema\ninput_schema[\"title\"]=\"ExpectedInputSchema\"\nassert input_schema==ExpectedInputSchema.jsonschema()\n\noutput_schema=created_graph.output_schema\noutput_schema[\"title\"]=\"ExpectedOutputSchema\"\nassert output_schema==ExpectedOutputSchema.jsonschema()\n"
                }
            ],
            "content": "async def test_get_input_schema(server:SpinTestServer):\n\"\"\" \\n     Test the get_input_schema method of a created graph. \\n  \\n     This test ensures that: \\n     1. A graph can be created with a single node. \\n     2. The input schema of the created graph is correctly generated. \\n     3. The input schema contains the expected input name and node id. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id\ninput_block=AgentInputBlock().id\noutput_block=AgentOutputBlock().id\n\ngraph=Graph(\nname=\"TestInputSchema\",\ndescription=\"Test input schema\",\nnodes=[\nNode(\nid=\"node_0_a\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"},\nmetadata={\"id\":\"node_0_a\"},\n),\nNode(\nid=\"node_0_b\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_b\",\"advanced\":True},\nmetadata={\"id\":\"node_0_b\"},\n),\nNode(id=\"node_1\",block_id=value_block,metadata={\"id\":\"node_1\"}),\nNode(\nid=\"node_2\",\nblock_id=output_block,\ninput_default={\n\"name\":\"out_key\",\n\"description\":\"This is an output key\",\n},\nmetadata={\"id\":\"node_2\"},\n),\n],\nlinks=[\nLink(\nsource_id=\"node_0_a\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_0_b\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"value\",\n),\n],\n)\n\ncreate_graph=CreateGraph(graph=graph)\ncreated_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)\n\nclass ExpectedInputSchema(BlockSchema):\nin_key_a:Any=SchemaField(title=\"Key A\",default=\"A\",advanced=False)\nin_key_b:Any=SchemaField(title=\"in_key_b\",advanced=True)\n\nclass ExpectedOutputSchema(BlockSchema):\nout_key:Any=SchemaField(\ndescription=\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)\n\ninput_schema=created_graph.input_schema\ninput_schema[\"title\"]=\"ExpectedInputSchema\"\nassert input_schema==ExpectedInputSchema.jsonschema()\n\noutput_schema=created_graph.output_schema\noutput_schema[\"title\"]=\"ExpectedOutputSchema\"\nassert output_schema==ExpectedOutputSchema.jsonschema()\n"
        }
    ],
    "content": "async def test_graph_creation(server:SpinTestServer):\n\"\"\" \\n     Test the creation of a graph with nodes and links. \\n  \\n     This test ensures that: \\n     1. A graph can be successfully created with valid connections. \\n     2. The created graph has the correct structure and properties. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id\ninput_block=AgentInputBlock().id\n\ngraph=Graph(\nid=\"test_graph\",\nname=\"TestGraph\",\ndescription=\"Test graph\",\nnodes=[\nNode(id=\"node_1\",block_id=value_block),\nNode(id=\"node_2\",block_id=input_block,input_default={\"name\":\"input\"}),\nNode(id=\"node_3\",block_id=value_block),\n],\nlinks=[\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"name\",\n),\n],\n)\ncreate_graph=CreateGraph(graph=graph)\ncreated_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)\n\nassert UUID(created_graph.id)\nassert created_graph.name==\"TestGraph\"\n\nassert len(created_graph.nodes)==3\nassert UUID(created_graph.nodes[0].id)\nassert UUID(created_graph.nodes[1].id)\nassert UUID(created_graph.nodes[2].id)\n\nnodes=created_graph.nodes\nlinks=created_graph.links\nassert len(links)==1\nassert links[0].source_id!=links[0].sink_id\nassert links[0].source_id in{nodes[0].id,nodes[1].id,nodes[2].id}\nassert links[0].sink_id in{nodes[0].id,nodes[1].id,nodes[2].id}\n\n\n@pytest.mark.asyncio(scope=\"session\")\nasync def test_get_input_schema(server:SpinTestServer):\n\"\"\" \\n     Test the get_input_schema method of a created graph. \\n  \\n     This test ensures that: \\n     1. A graph can be created with a single node. \\n     2. The input schema of the created graph is correctly generated. \\n     3. The input schema contains the expected input name and node id. \\n  \\n     Args: \\n         server (SpinTestServer): The test server instance. \\n     \"\"\"\nvalue_block=StoreValueBlock().id\ninput_block=AgentInputBlock().id\noutput_block=AgentOutputBlock().id\n\ngraph=Graph(\nname=\"TestInputSchema\",\ndescription=\"Test input schema\",\nnodes=[\nNode(\nid=\"node_0_a\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_a\",\"title\":\"Key A\",\"value\":\"A\"},\nmetadata={\"id\":\"node_0_a\"},\n),\nNode(\nid=\"node_0_b\",\nblock_id=input_block,\ninput_default={\"name\":\"in_key_b\",\"advanced\":True},\nmetadata={\"id\":\"node_0_b\"},\n),\nNode(id=\"node_1\",block_id=value_block,metadata={\"id\":\"node_1\"}),\nNode(\nid=\"node_2\",\nblock_id=output_block,\ninput_default={\n\"name\":\"out_key\",\n\"description\":\"This is an output key\",\n},\nmetadata={\"id\":\"node_2\"},\n),\n],\nlinks=[\nLink(\nsource_id=\"node_0_a\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_0_b\",\nsink_id=\"node_1\",\nsource_name=\"result\",\nsink_name=\"input\",\n),\nLink(\nsource_id=\"node_1\",\nsink_id=\"node_2\",\nsource_name=\"output\",\nsink_name=\"value\",\n),\n],\n)\n\ncreate_graph=CreateGraph(graph=graph)\ncreated_graph=await server.agent_server.test_create_graph(\ncreate_graph,DEFAULT_USER_ID\n)\n\nclass ExpectedInputSchema(BlockSchema):\nin_key_a:Any=SchemaField(title=\"Key A\",default=\"A\",advanced=False)\nin_key_b:Any=SchemaField(title=\"in_key_b\",advanced=True)\n\nclass ExpectedOutputSchema(BlockSchema):\nout_key:Any=SchemaField(\ndescription=\"This is an output key\",\ntitle=\"out_key\",\nadvanced=False,\n)\n\ninput_schema=created_graph.input_schema\ninput_schema[\"title\"]=\"ExpectedInputSchema\"\nassert input_schema==ExpectedInputSchema.jsonschema()\n\noutput_schema=created_graph.output_schema\noutput_schema[\"title\"]=\"ExpectedOutputSchema\"\nassert output_schema==ExpectedOutputSchema.jsonschema()\n"
}
{
    "type": "Program",
    "name": "Global",
    "range": [
        72,
        1009
    ],
    "children": [
        {
            "type": "VariableDeclaration",
            "name": "TEST_CREDENTIALS",
            "range": [
                72,
                106
            ],
            "children": [
                {
                    "type": "AssignmentExpression",
                    "name": "",
                    "range": [
                        73,
                        105
                    ],
                    "children": [
                        {
                            "type": "CallExpression",
                            "name": "APIKeyCredentials",
                            "range": [
                                74,
                                105
                            ],
                            "children": [
                                {
                                    "type": "ArgumentList",
                                    "name": "",
                                    "range": [
                                        75,
                                        105
                                    ],
                                    "children": [
                                        {
                                            "type": "NamedArgument",
                                            "name": "id",
                                            "range": [
                                                77,
                                                79
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"01234567-89ab-cdef-0123-456789abcdef\"",
                                                    "range": [
                                                        79,
                                                        79
                                                    ],
                                                    "children": [],
                                                    "content": "\"01234567-89ab-cdef-0123-456789abcdef\""
                                                }
                                            ],
                                            "content": "id=\"01234567-89ab-cdef-0123-456789abcdef\""
                                        },
                                        {
                                            "type": "NamedArgument",
                                            "name": "provider",
                                            "range": [
                                                82,
                                                84
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"d_id\"",
                                                    "range": [
                                                        84,
                                                        84
                                                    ],
                                                    "children": [],
                                                    "content": "\"d_id\""
                                                }
                                            ],
                                            "content": "provider=\"d_id\""
                                        },
                                        {
                                            "type": "NamedArgument",
                                            "name": "api_key",
                                            "range": [
                                                87,
                                                92
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "SecretStr",
                                                    "range": [
                                                        89,
                                                        92
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "ArgumentList",
                                                            "name": "",
                                                            "range": [
                                                                90,
                                                                92
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"mock-d-id-api-key\"",
                                                                    "range": [
                                                                        91,
                                                                        91
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"mock-d-id-api-key\""
                                                                }
                                                            ],
                                                            "content": "(\"mock-d-id-api-key\")"
                                                        }
                                                    ],
                                                    "content": "SecretStr(\"mock-d-id-api-key\")"
                                                }
                                            ],
                                            "content": "api_key=SecretStr(\"mock-d-id-api-key\")"
                                        },
                                        {
                                            "type": "NamedArgument",
                                            "name": "title",
                                            "range": [
                                                95,
                                                97
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"Mock D-ID API key\"",
                                                    "range": [
                                                        97,
                                                        97
                                                    ],
                                                    "children": [],
                                                    "content": "\"Mock D-ID API key\""
                                                }
                                            ],
                                            "content": "title=\"Mock D-ID API key\""
                                        },
                                        {
                                            "type": "NamedArgument",
                                            "name": "expires_at",
                                            "range": [
                                                100,
                                                102
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "None",
                                                    "range": [
                                                        102,
                                                        102
                                                    ],
                                                    "children": [],
                                                    "content": "None"
                                                }
                                            ],
                                            "content": "expires_at=None"
                                        }
                                    ],
                                    "content": "(\nid=\"01234567-89ab-cdef-0123-456789abcdef\",\nprovider=\"d_id\",\napi_key=SecretStr(\"mock-d-id-api-key\"),\ntitle=\"Mock D-ID API key\",\nexpires_at=None,\n)"
                                }
                            ],
                            "content": "APIKeyCredentials(\nid=\"01234567-89ab-cdef-0123-456789abcdef\",\nprovider=\"d_id\",\napi_key=SecretStr(\"mock-d-id-api-key\"),\ntitle=\"Mock D-ID API key\",\nexpires_at=None,\n)"
                        }
                    ],
                    "content": "=APIKeyCredentials(\nid=\"01234567-89ab-cdef-0123-456789abcdef\",\nprovider=\"d_id\",\napi_key=SecretStr(\"mock-d-id-api-key\"),\ntitle=\"Mock D-ID API key\",\nexpires_at=None,\n)"
                }
            ],
            "content": "TEST_CREDENTIALS=APIKeyCredentials(\nid=\"01234567-89ab-cdef-0123-456789abcdef\",\nprovider=\"d_id\",\napi_key=SecretStr(\"mock-d-id-api-key\"),\ntitle=\"Mock D-ID API key\",\nexpires_at=None,\n)\n"
        },
        {
            "type": "VariableDeclaration",
            "name": "TEST_CREDENTIALS_INPUT",
            "range": [
                107,
                139
            ],
            "children": [
                {
                    "type": "ObjectExpression",
                    "name": "",
                    "range": [
                        109,
                        139
                    ],
                    "children": [
                        {
                            "type": "Property",
                            "name": "provider",
                            "range": [
                                111,
                                115
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"provider\"",
                                    "range": [
                                        111,
                                        111
                                    ],
                                    "children": [],
                                    "content": "\"provider\""
                                },
                                {
                                    "type": "Identifier",
                                    "name": "TEST_CREDENTIALS",
                                    "range": [
                                        113,
                                        113
                                    ],
                                    "children": [],
                                    "content": "TEST_CREDENTIALS"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "provider",
                                    "range": [
                                        115,
                                        115
                                    ],
                                    "children": [],
                                    "content": "provider"
                                }
                            ],
                            "content": "\"provider\":TEST_CREDENTIALS.provider"
                        },
                        {
                            "type": "Property",
                            "name": "id",
                            "range": [
                                118,
                                122
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"id\"",
                                    "range": [
                                        118,
                                        118
                                    ],
                                    "children": [],
                                    "content": "\"id\""
                                },
                                {
                                    "type": "Identifier",
                                    "name": "TEST_CREDENTIALS",
                                    "range": [
                                        120,
                                        120
                                    ],
                                    "children": [],
                                    "content": "TEST_CREDENTIALS"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "id",
                                    "range": [
                                        122,
                                        122
                                    ],
                                    "children": [],
                                    "content": "id"
                                }
                            ],
                            "content": "\"id\":TEST_CREDENTIALS.id"
                        },
                        {
                            "type": "Property",
                            "name": "type",
                            "range": [
                                125,
                                129
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"type\"",
                                    "range": [
                                        125,
                                        125
                                    ],
                                    "children": [],
                                    "content": "\"type\""
                                },
                                {
                                    "type": "Identifier",
                                    "name": "TEST_CREDENTIALS",
                                    "range": [
                                        127,
                                        127
                                    ],
                                    "children": [],
                                    "content": "TEST_CREDENTIALS"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "type",
                                    "range": [
                                        129,
                                        129
                                    ],
                                    "children": [],
                                    "content": "type"
                                }
                            ],
                            "content": "\"type\":TEST_CREDENTIALS.type"
                        },
                        {
                            "type": "Property",
                            "name": "title",
                            "range": [
                                132,
                                136
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"title\"",
                                    "range": [
                                        132,
                                        132
                                    ],
                                    "children": [],
                                    "content": "\"title\""
                                },
                                {
                                    "type": "Identifier",
                                    "name": "TEST_CREDENTIALS",
                                    "range": [
                                        134,
                                        134
                                    ],
                                    "children": [],
                                    "content": "TEST_CREDENTIALS"
                                },
                                {
                                    "type": "Identifier",
                                    "name": "type",
                                    "range": [
                                        136,
                                        136
                                    ],
                                    "children": [],
                                    "content": "type"
                                }
                            ],
                            "content": "\"title\":TEST_CREDENTIALS.type"
                        }
                    ],
                    "content": "{\n\"provider\":TEST_CREDENTIALS.provider,\n\"id\":TEST_CREDENTIALS.id,\n\"type\":TEST_CREDENTIALS.type,\n\"title\":TEST_CREDENTIALS.type,\n}"
                }
            ],
            "content": "TEST_CREDENTIALS_INPUT={\n\"provider\":TEST_CREDENTIALS.provider,\n\"id\":TEST_CREDENTIALS.id,\n\"type\":TEST_CREDENTIALS.type,\n\"title\":TEST_CREDENTIALS.type,\n}"
        },
        {
            "type": "ClassDecl",
            "name": "CreateTalkingAvatarVideoBlock",
            "range": [
                141,
                185
            ],
            "children": [
                {
                    "type": "ClassBody",
                    "name": "",
                    "range": [
                        147,
                        185
                    ],
                    "children": [
                        {
                            "type": "FieldDecl",
                            "name": "credentials",
                            "range": [
                                155,
                                184
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "CredentialsMetaInput",
                                    "range": [
                                        157,
                                        172
                                    ],
                                    "children": [],
                                    "content": "credentials:CredentialsMetaInput[\nLiteral[ProviderName.D_ID],Literal[\"api_key\"]"
                                },
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        173,
                                        184
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "CredentialsField",
                                            "range": [
                                                174,
                                                184
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "description",
                                                    "range": [
                                                        177,
                                                        182
                                                    ],
                                                    "children": [],
                                                    "content": "(\ndescription=\"The D-ID integration can be used with \"\n"
                                                }
                                            ],
                                            "content": "]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\","
                                        }
                                    ],
                                    "content": "\n]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\","
                                }
                            ],
                            "content": ":\ncredentials:CredentialsMetaInput[\nLiteral[ProviderName.D_ID],Literal[\"api_key\"]\n]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\","
                        }
                    ],
                    "content": "):\nclass Input(BlockSchema):\ncredentials:CredentialsMetaInput[\nLiteral[ProviderName.D_ID],Literal[\"api_key\"]\n]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\",\n"
                }
            ],
            "content": "\n\nclass CreateTalkingAvatarVideoBlock(Block):\nclass Input(BlockSchema):\ncredentials:CredentialsMetaInput[\nLiteral[ProviderName.D_ID],Literal[\"api_key\"]\n]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\",\n"
        },
        {
            "type": "ClassDecl",
            "name": "Input",
            "range": [
                148,
                185
            ],
            "children": [
                {
                    "type": "ClassBody",
                    "name": "",
                    "range": [
                        154,
                        185
                    ],
                    "children": [],
                    "content": "):\ncredentials:CredentialsMetaInput[\nLiteral[ProviderName.D_ID],Literal[\"api_key\"]\n]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\",\n"
                }
            ],
            "content": ":\nclass Input(BlockSchema):\ncredentials:CredentialsMetaInput[\nLiteral[ProviderName.D_ID],Literal[\"api_key\"]\n]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\",\n"
        },
        {
            "type": "ClassDecl",
            "name": "Output",
            "range": [
                405,
                433
            ],
            "children": [
                {
                    "type": "ClassBody",
                    "name": "",
                    "range": [
                        411,
                        433
                    ],
                    "children": [
                        {
                            "type": "FieldDecl",
                            "name": "video_url",
                            "range": [
                                412,
                                421
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        414,
                                        417
                                    ],
                                    "children": [],
                                    "content": "video_url:str="
                                },
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        415,
                                        421
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "SchemaField",
                                            "range": [
                                                416,
                                                421
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "description",
                                                    "range": [
                                                        418,
                                                        420
                                                    ],
                                                    "children": [],
                                                    "content": "SchemaField(description"
                                                }
                                            ],
                                            "content": "str=SchemaField(description="
                                        }
                                    ],
                                    "content": ":str=SchemaField(description="
                                }
                            ],
                            "content": ":\nvideo_url:str=SchemaField(description="
                        },
                        {
                            "type": "FieldDecl",
                            "name": "error",
                            "range": [
                                423,
                                432
                            ],
                            "children": [
                                {
                                    "type": "TypeAnnotation",
                                    "name": "str",
                                    "range": [
                                        425,
                                        428
                                    ],
                                    "children": [],
                                    "content": "error:str="
                                },
                                {
                                    "type": "Assignment",
                                    "name": "=",
                                    "range": [
                                        426,
                                        432
                                    ],
                                    "children": [
                                        {
                                            "type": "CallExpression",
                                            "name": "SchemaField",
                                            "range": [
                                                427,
                                                432
                                            ],
                                            "children": [
                                                {
                                                    "type": "Argument",
                                                    "name": "description",
                                                    "range": [
                                                        429,
                                                        431
                                                    ],
                                                    "children": [],
                                                    "content": "SchemaField(description"
                                                }
                                            ],
                                            "content": "str=SchemaField(description="
                                        }
                                    ],
                                    "content": ":str=SchemaField(description="
                                }
                            ],
                            "content": ")\nerror:str=SchemaField(description="
                        }
                    ],
                    "content": "):\nvideo_url:str=SchemaField(description=\"The URL of the created video\")\nerror:str=SchemaField(description=\"Error message if the request failed\""
                }
            ],
            "content": "\n\nclass Output(BlockSchema):\nvideo_url:str=SchemaField(description=\"The URL of the created video\")\nerror:str=SchemaField(description=\"Error message if the request failed\""
        },
        {
            "type": "FunctionDecl",
            "name": "__init__",
            "range": [
                435,
                625
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        441,
                        625
                    ],
                    "children": [
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                442,
                                445
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "super",
                                    "range": [
                                        442,
                                        445
                                    ],
                                    "children": [],
                                    "content": ":\nsuper("
                                }
                            ],
                            "content": ":\nsuper("
                        },
                        {
                            "type": "ExpressionStatement",
                            "name": "",
                            "range": [
                                446,
                                624
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "__init__",
                                    "range": [
                                        446,
                                        624
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "id",
                                            "range": [
                                                449,
                                                451
                                            ],
                                            "children": [],
                                            "content": "(\nid"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "description",
                                            "range": [
                                                454,
                                                456
                                            ],
                                            "children": [],
                                            "content": ",\ndescription"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "categories",
                                            "range": [
                                                459,
                                                465
                                            ],
                                            "children": [],
                                            "content": ",\ncategories={BlockCategory."
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "input_schema",
                                            "range": [
                                                468,
                                                472
                                            ],
                                            "children": [],
                                            "content": ",\ninput_schema=CreateTalkingAvatarVideoBlock"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "output_schema",
                                            "range": [
                                                475,
                                                479
                                            ],
                                            "children": [],
                                            "content": ",\noutput_schema=CreateTalkingAvatarVideoBlock"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "test_input",
                                            "range": [
                                                482,
                                                541
                                            ],
                                            "children": [],
                                            "content": ",\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n\"script_input\":\"Welcome to AutoGPT\",\n\"voice_id\":\"en-US-JennyNeural\",\n\"presenter_id\":\"amy-Aq6OmGZnMt\",\n\"driver_id\":\"Vcq0R4a8F0\",\n\"result_format\":\"mp4\",\n\"crop_type\":\"wide\",\n\"subtitles\":False,\n\"ssml\":False,\n\"max_polling_attempts\":5,\n\"polling_interval\":5,"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "test_output",
                                            "range": [
                                                544,
                                                559
                                            ],
                                            "children": [],
                                            "content": ",\ntest_output=[\n(\n\"video_url\",\n\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n),"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "test_mock",
                                            "range": [
                                                562,
                                                616
                                            ],
                                            "children": [],
                                            "content": ",\ntest_mock={\n\"create_clip\":lambda*args,**kwargs:{\n\"id\":\"abcd1234-5678-efgh-ijkl-mnopqrstuvwx\",\n\"status\":\"created\",\n},\n\"get_clip_status\":lambda*args,**kwargs:{\n\"status\":\"done\",\n\"result_url\":\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n},"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "test_credentials",
                                            "range": [
                                                619,
                                                621
                                            ],
                                            "children": [],
                                            "content": ",\ntest_credentials"
                                        }
                                    ],
                                    "content": ").__init__(\nid=\"98c6f503-8c47-4b1c-a96d-351fc7c87dab\",\ndescription=\"This block integrates with D-ID to create video clips and retrieve their URLs.\",\ncategories={BlockCategory.AI},\ninput_schema=CreateTalkingAvatarVideoBlock.Input,\noutput_schema=CreateTalkingAvatarVideoBlock.Output,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n\"script_input\":\"Welcome to AutoGPT\",\n\"voice_id\":\"en-US-JennyNeural\",\n\"presenter_id\":\"amy-Aq6OmGZnMt\",\n\"driver_id\":\"Vcq0R4a8F0\",\n\"result_format\":\"mp4\",\n\"crop_type\":\"wide\",\n\"subtitles\":False,\n\"ssml\":False,\n\"max_polling_attempts\":5,\n\"polling_interval\":5,\n},\ntest_output=[\n(\n\"video_url\",\n\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n),\n],\ntest_mock={\n\"create_clip\":lambda*args,**kwargs:{\n\"id\":\"abcd1234-5678-efgh-ijkl-mnopqrstuvwx\",\n\"status\":\"created\",\n},\n\"get_clip_status\":lambda*args,**kwargs:{\n\"status\":\"done\",\n\"result_url\":\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n},\n},\ntest_credentials=TEST_CREDENTIALS,"
                                }
                            ],
                            "content": ").__init__(\nid=\"98c6f503-8c47-4b1c-a96d-351fc7c87dab\",\ndescription=\"This block integrates with D-ID to create video clips and retrieve their URLs.\",\ncategories={BlockCategory.AI},\ninput_schema=CreateTalkingAvatarVideoBlock.Input,\noutput_schema=CreateTalkingAvatarVideoBlock.Output,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n\"script_input\":\"Welcome to AutoGPT\",\n\"voice_id\":\"en-US-JennyNeural\",\n\"presenter_id\":\"amy-Aq6OmGZnMt\",\n\"driver_id\":\"Vcq0R4a8F0\",\n\"result_format\":\"mp4\",\n\"crop_type\":\"wide\",\n\"subtitles\":False,\n\"ssml\":False,\n\"max_polling_attempts\":5,\n\"polling_interval\":5,\n},\ntest_output=[\n(\n\"video_url\",\n\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n),\n],\ntest_mock={\n\"create_clip\":lambda*args,**kwargs:{\n\"id\":\"abcd1234-5678-efgh-ijkl-mnopqrstuvwx\",\n\"status\":\"created\",\n},\n\"get_clip_status\":lambda*args,**kwargs:{\n\"status\":\"done\",\n\"result_url\":\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n},\n},\ntest_credentials=TEST_CREDENTIALS,"
                        }
                    ],
                    "content": "):\nsuper().__init__(\nid=\"98c6f503-8c47-4b1c-a96d-351fc7c87dab\",\ndescription=\"This block integrates with D-ID to create video clips and retrieve their URLs.\",\ncategories={BlockCategory.AI},\ninput_schema=CreateTalkingAvatarVideoBlock.Input,\noutput_schema=CreateTalkingAvatarVideoBlock.Output,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n\"script_input\":\"Welcome to AutoGPT\",\n\"voice_id\":\"en-US-JennyNeural\",\n\"presenter_id\":\"amy-Aq6OmGZnMt\",\n\"driver_id\":\"Vcq0R4a8F0\",\n\"result_format\":\"mp4\",\n\"crop_type\":\"wide\",\n\"subtitles\":False,\n\"ssml\":False,\n\"max_polling_attempts\":5,\n\"polling_interval\":5,\n},\ntest_output=[\n(\n\"video_url\",\n\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n),\n],\ntest_mock={\n\"create_clip\":lambda*args,**kwargs:{\n\"id\":\"abcd1234-5678-efgh-ijkl-mnopqrstuvwx\",\n\"status\":\"created\",\n},\n\"get_clip_status\":lambda*args,**kwargs:{\n\"status\":\"done\",\n\"result_url\":\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n},\n},\ntest_credentials=TEST_CREDENTIALS,\n"
                }
            ],
            "content": "\n\ndef __init__(self):\nsuper().__init__(\nid=\"98c6f503-8c47-4b1c-a96d-351fc7c87dab\",\ndescription=\"This block integrates with D-ID to create video clips and retrieve their URLs.\",\ncategories={BlockCategory.AI},\ninput_schema=CreateTalkingAvatarVideoBlock.Input,\noutput_schema=CreateTalkingAvatarVideoBlock.Output,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n\"script_input\":\"Welcome to AutoGPT\",\n\"voice_id\":\"en-US-JennyNeural\",\n\"presenter_id\":\"amy-Aq6OmGZnMt\",\n\"driver_id\":\"Vcq0R4a8F0\",\n\"result_format\":\"mp4\",\n\"crop_type\":\"wide\",\n\"subtitles\":False,\n\"ssml\":False,\n\"max_polling_attempts\":5,\n\"polling_interval\":5,\n},\ntest_output=[\n(\n\"video_url\",\n\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n),\n],\ntest_mock={\n\"create_clip\":lambda*args,**kwargs:{\n\"id\":\"abcd1234-5678-efgh-ijkl-mnopqrstuvwx\",\n\"status\":\"created\",\n},\n\"get_clip_status\":lambda*args,**kwargs:{\n\"status\":\"done\",\n\"result_url\":\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n},\n},\ntest_credentials=TEST_CREDENTIALS,\n"
        },
        {
            "type": "FunctionDecl",
            "name": "create_clip",
            "range": [
                627,
                694
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        644,
                        694
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "url",
                            "range": [
                                645,
                                647
                            ],
                            "children": [
                                {
                                    "type": "Literal",
                                    "name": "\"https://api.d-id.com/clips\"",
                                    "range": [
                                        647,
                                        647
                                    ],
                                    "children": [],
                                    "content": "url"
                                }
                            ],
                            "content": ":\nurl"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "headers",
                            "range": [
                                649,
                                669
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        651,
                                        669
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "accept",
                                            "range": [
                                                653,
                                                656
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"application/json\"",
                                                    "range": [
                                                        655,
                                                        655
                                                    ],
                                                    "children": [],
                                                    "content": "\"accept\""
                                                }
                                            ],
                                            "content": "{\n\"accept\":"
                                        },
                                        {
                                            "type": "Property",
                                            "name": "content-type",
                                            "range": [
                                                658,
                                                661
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"application/json\"",
                                                    "range": [
                                                        660,
                                                        660
                                                    ],
                                                    "children": [],
                                                    "content": "\"content-type\""
                                                }
                                            ],
                                            "content": ",\n\"content-type\":"
                                        },
                                        {
                                            "type": "Property",
                                            "name": "authorization",
                                            "range": [
                                                663,
                                                667
                                            ],
                                            "children": [
                                                {
                                                    "type": "TemplateLiteral",
                                                    "name": "",
                                                    "range": [
                                                        665,
                                                        666
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "TemplateElement",
                                                            "name": "Basic ",
                                                            "range": [
                                                                665,
                                                                665
                                                            ],
                                                            "children": [],
                                                            "content": "\"authorization\""
                                                        },
                                                        {
                                                            "type": "Expression",
                                                            "name": "api_key.get_secret_value()",
                                                            "range": [
                                                                666,
                                                                666
                                                            ],
                                                            "children": [],
                                                            "content": ":"
                                                        }
                                                    ],
                                                    "content": "\"authorization\":"
                                                }
                                            ],
                                            "content": ",\n\"authorization\":f"
                                        }
                                    ],
                                    "content": "headers={\n\"accept\":\"application/json\",\n\"content-type\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\","
                                }
                            ],
                            "content": "\"https://api.d-id.com/clips\"\nheaders={\n\"accept\":\"application/json\",\n\"content-type\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\","
                        },
                        {
                            "type": "VariableDecl",
                            "name": "response",
                            "range": [
                                671,
                                686
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "requests.post",
                                    "range": [
                                        673,
                                        686
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "url",
                                            "range": [
                                                677,
                                                677
                                            ],
                                            "children": [],
                                            "content": "post"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "json",
                                            "range": [
                                                679,
                                                681
                                            ],
                                            "children": [],
                                            "content": "url,json"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "headers",
                                            "range": [
                                                683,
                                                685
                                            ],
                                            "children": [],
                                            "content": "payload,headers"
                                        }
                                    ],
                                    "content": "response=requests.post(url,json=payload,headers="
                                }
                            ],
                            "content": "}\nresponse=requests.post(url,json=payload,headers="
                        },
                        {
                            "type": "ReturnStatement",
                            "name": "",
                            "range": [
                                688,
                                694
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "response.json",
                                    "range": [
                                        690,
                                        694
                                    ],
                                    "children": [],
                                    "content": "return response.json("
                                }
                            ],
                            "content": ")\nreturn response.json("
                        }
                    ],
                    "content": "dict:\nurl=\"https://api.d-id.com/clips\"\nheaders={\n\"accept\":\"application/json\",\n\"content-type\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\",\n}\nresponse=requests.post(url,json=payload,headers=headers)\nreturn response.json("
                }
            ],
            "content": "\n\ndef create_clip(self,api_key:SecretStr,payload:dict)->dict:\nurl=\"https://api.d-id.com/clips\"\nheaders={\n\"accept\":\"application/json\",\n\"content-type\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\",\n}\nresponse=requests.post(url,json=payload,headers=headers)\nreturn response.json("
        },
        {
            "type": "FunctionDecl",
            "name": "get_clip_status",
            "range": [
                696,
                755
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        713,
                        755
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "url",
                            "range": [
                                714,
                                717
                            ],
                            "children": [
                                {
                                    "type": "TemplateLiteral",
                                    "name": "",
                                    "range": [
                                        716,
                                        717
                                    ],
                                    "children": [
                                        {
                                            "type": "TemplateElement",
                                            "name": "https://api.d-id.com/clips/",
                                            "range": [
                                                716,
                                                716
                                            ],
                                            "children": [],
                                            "content": "url"
                                        },
                                        {
                                            "type": "Expression",
                                            "name": "clip_id",
                                            "range": [
                                                717,
                                                717
                                            ],
                                            "children": [],
                                            "content": "="
                                        }
                                    ],
                                    "content": "url="
                                }
                            ],
                            "content": ":\nurl="
                        },
                        {
                            "type": "VariableDecl",
                            "name": "headers",
                            "range": [
                                719,
                                734
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        721,
                                        734
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "accept",
                                            "range": [
                                                723,
                                                726
                                            ],
                                            "children": [
                                                {
                                                    "type": "Literal",
                                                    "name": "\"application/json\"",
                                                    "range": [
                                                        725,
                                                        725
                                                    ],
                                                    "children": [],
                                                    "content": "\"accept\""
                                                }
                                            ],
                                            "content": "{\n\"accept\":"
                                        },
                                        {
                                            "type": "Property",
                                            "name": "authorization",
                                            "range": [
                                                728,
                                                732
                                            ],
                                            "children": [
                                                {
                                                    "type": "TemplateLiteral",
                                                    "name": "",
                                                    "range": [
                                                        730,
                                                        731
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "TemplateElement",
                                                            "name": "Basic ",
                                                            "range": [
                                                                730,
                                                                730
                                                            ],
                                                            "children": [],
                                                            "content": "\"authorization\""
                                                        },
                                                        {
                                                            "type": "Expression",
                                                            "name": "api_key.get_secret_value()",
                                                            "range": [
                                                                731,
                                                                731
                                                            ],
                                                            "children": [],
                                                            "content": ":"
                                                        }
                                                    ],
                                                    "content": "\"authorization\":"
                                                }
                                            ],
                                            "content": ",\n\"authorization\":f"
                                        }
                                    ],
                                    "content": "headers={\n\"accept\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\","
                                }
                            ],
                            "content": "\"https://api.d-id.com/clips/{clip_id}\"\nheaders={\n\"accept\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\","
                        },
                        {
                            "type": "VariableDecl",
                            "name": "response",
                            "range": [
                                736,
                                747
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "requests.get",
                                    "range": [
                                        738,
                                        747
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "url",
                                            "range": [
                                                742,
                                                742
                                            ],
                                            "children": [],
                                            "content": "get"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "headers",
                                            "range": [
                                                744,
                                                746
                                            ],
                                            "children": [],
                                            "content": "url,headers"
                                        }
                                    ],
                                    "content": "response=requests.get(url,headers="
                                }
                            ],
                            "content": "}\nresponse=requests.get(url,headers="
                        },
                        {
                            "type": "ReturnStatement",
                            "name": "",
                            "range": [
                                749,
                                755
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "response.json",
                                    "range": [
                                        751,
                                        755
                                    ],
                                    "children": [],
                                    "content": "return response.json("
                                }
                            ],
                            "content": ")\nreturn response.json("
                        }
                    ],
                    "content": "dict:\nurl=f \"https://api.d-id.com/clips/{clip_id}\"\nheaders={\n\"accept\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\",\n}\nresponse=requests.get(url,headers=headers)\nreturn response.json("
                }
            ],
            "content": "\n\ndef get_clip_status(self,api_key:SecretStr,clip_id:str)->dict:\nurl=f \"https://api.d-id.com/clips/{clip_id}\"\nheaders={\n\"accept\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\",\n}\nresponse=requests.get(url,headers=headers)\nreturn response.json("
        },
        {
            "type": "FunctionDecl",
            "name": "run",
            "range": [
                757,
                1009
            ],
            "children": [
                {
                    "type": "BlockStatement",
                    "name": "",
                    "range": [
                        782,
                        1009
                    ],
                    "children": [
                        {
                            "type": "VariableDecl",
                            "name": "payload",
                            "range": [
                                788,
                                901
                            ],
                            "children": [
                                {
                                    "type": "ObjectExpression",
                                    "name": "",
                                    "range": [
                                        790,
                                        901
                                    ],
                                    "children": [
                                        {
                                            "type": "Property",
                                            "name": "script",
                                            "range": [
                                                792,
                                                857
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        794,
                                                        857
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "type",
                                                            "range": [
                                                                796,
                                                                799
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"text\"",
                                                                    "range": [
                                                                        798,
                                                                        798
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"type\""
                                                                }
                                                            ],
                                                            "content": "{\n\"type\":"
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "subtitles",
                                                            "range": [
                                                                801,
                                                                813
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "CallExpression",
                                                                    "name": "str",
                                                                    "range": [
                                                                        803,
                                                                        813
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Argument",
                                                                            "name": "input_data.subtitles",
                                                                            "range": [
                                                                                805,
                                                                                807
                                                                            ],
                                                                            "children": [],
                                                                            "content": "str(input_data"
                                                                        }
                                                                    ],
                                                                    "content": "\"subtitles\":str(input_data.subtitles).lower("
                                                                }
                                                            ],
                                                            "content": ",\n\"subtitles\":str(input_data.subtitles).lower("
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "provider",
                                                            "range": [
                                                                815,
                                                                833
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "ObjectExpression",
                                                                    "name": "",
                                                                    "range": [
                                                                        817,
                                                                        833
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Property",
                                                                            "name": "type",
                                                                            "range": [
                                                                                819,
                                                                                824
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "input_data.provider",
                                                                                    "range": [
                                                                                        821,
                                                                                        823
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"type\":input_data"
                                                                                }
                                                                            ],
                                                                            "content": "{\n\"type\":input_data."
                                                                        },
                                                                        {
                                                                            "type": "Property",
                                                                            "name": "voice_id",
                                                                            "range": [
                                                                                826,
                                                                                831
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "input_data.voice_id",
                                                                                    "range": [
                                                                                        828,
                                                                                        830
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"voice_id\":input_data"
                                                                                }
                                                                            ],
                                                                            "content": ",\n\"voice_id\":input_data."
                                                                        }
                                                                    ],
                                                                    "content": "\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,"
                                                                }
                                                            ],
                                                            "content": ",\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,"
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "ssml",
                                                            "range": [
                                                                835,
                                                                848
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "CallExpression",
                                                                    "name": "str",
                                                                    "range": [
                                                                        837,
                                                                        848
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Argument",
                                                                            "name": "input_data.ssml",
                                                                            "range": [
                                                                                839,
                                                                                842
                                                                            ],
                                                                            "children": [],
                                                                            "content": ":str(input_data"
                                                                        }
                                                                    ],
                                                                    "content": "\n\"ssml\":str(input_data.ssml).lower("
                                                                }
                                                            ],
                                                            "content": "},\n\"ssml\":str(input_data.ssml).lower("
                                                        },
                                                        {
                                                            "type": "Property",
                                                            "name": "input",
                                                            "range": [
                                                                850,
                                                                855
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "input_data.script_input",
                                                                    "range": [
                                                                        852,
                                                                        854
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"input\":input_data"
                                                                }
                                                            ],
                                                            "content": ",\n\"input\":input_data."
                                                        }
                                                    ],
                                                    "content": "\"script\":{\n\"type\":\"text\",\n\"subtitles\":str(input_data.subtitles).lower(),\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,\n},\n\"ssml\":str(input_data.ssml).lower(),\n\"input\":input_data.script_input,"
                                                }
                                            ],
                                            "content": "{\n\"script\":{\n\"type\":\"text\",\n\"subtitles\":str(input_data.subtitles).lower(),\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,\n},\n\"ssml\":str(input_data.ssml).lower(),\n\"input\":input_data.script_input,"
                                        },
                                        {
                                            "type": "Property",
                                            "name": "config",
                                            "range": [
                                                860,
                                                868
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        862,
                                                        868
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "result_format",
                                                            "range": [
                                                                863,
                                                                867
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Identifier",
                                                                    "name": "input_data.result_format",
                                                                    "range": [
                                                                        865,
                                                                        867
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"result_format\":input_data"
                                                                }
                                                            ],
                                                            "content": ":{\"result_format\":input_data"
                                                        }
                                                    ],
                                                    "content": "\"config\":{\"result_format\":input_data."
                                                }
                                            ],
                                            "content": ",\n\"config\":{\"result_format\":input_data."
                                        },
                                        {
                                            "type": "Property",
                                            "name": "presenter_config",
                                            "range": [
                                                871,
                                                883
                                            ],
                                            "children": [
                                                {
                                                    "type": "ObjectExpression",
                                                    "name": "",
                                                    "range": [
                                                        873,
                                                        883
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Property",
                                                            "name": "crop",
                                                            "range": [
                                                                874,
                                                                882
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "ObjectExpression",
                                                                    "name": "",
                                                                    "range": [
                                                                        876,
                                                                        882
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "Property",
                                                                            "name": "type",
                                                                            "range": [
                                                                                877,
                                                                                881
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "Identifier",
                                                                                    "name": "input_data.crop_type",
                                                                                    "range": [
                                                                                        879,
                                                                                        881
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\"type\":input_data"
                                                                                }
                                                                            ],
                                                                            "content": ":{\"type\":input_data"
                                                                        }
                                                                    ],
                                                                    "content": "\"crop\":{\"type\":input_data."
                                                                }
                                                            ],
                                                            "content": ":{\"crop\":{\"type\":input_data."
                                                        }
                                                    ],
                                                    "content": "\"presenter_config\":{\"crop\":{\"type\":input_data.crop_type"
                                                }
                                            ],
                                            "content": ",\n\"presenter_config\":{\"crop\":{\"type\":input_data.crop_type"
                                        },
                                        {
                                            "type": "Property",
                                            "name": "presenter_id",
                                            "range": [
                                                886,
                                                891
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "input_data.presenter_id",
                                                    "range": [
                                                        888,
                                                        890
                                                    ],
                                                    "children": [],
                                                    "content": "\"presenter_id\":input_data"
                                                }
                                            ],
                                            "content": ",\n\"presenter_id\":input_data."
                                        },
                                        {
                                            "type": "Property",
                                            "name": "driver_id",
                                            "range": [
                                                893,
                                                898
                                            ],
                                            "children": [
                                                {
                                                    "type": "Identifier",
                                                    "name": "input_data.driver_id",
                                                    "range": [
                                                        895,
                                                        897
                                                    ],
                                                    "children": [],
                                                    "content": "\"driver_id\":input_data"
                                                }
                                            ],
                                            "content": ",\n\"driver_id\":input_data."
                                        }
                                    ],
                                    "content": "payload={\n\"script\":{\n\"type\":\"text\",\n\"subtitles\":str(input_data.subtitles).lower(),\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,\n},\n\"ssml\":str(input_data.ssml).lower(),\n\"input\":input_data.script_input,\n},\n\"config\":{\"result_format\":input_data.result_format},\n\"presenter_config\":{\"crop\":{\"type\":input_data.crop_type}},\n\"presenter_id\":input_data.presenter_id,\n\"driver_id\":input_data.driver_id,\n"
                                }
                            ],
                            "content": "clip\npayload={\n\"script\":{\n\"type\":\"text\",\n\"subtitles\":str(input_data.subtitles).lower(),\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,\n},\n\"ssml\":str(input_data.ssml).lower(),\n\"input\":input_data.script_input,\n},\n\"config\":{\"result_format\":input_data.result_format},\n\"presenter_config\":{\"crop\":{\"type\":input_data.crop_type}},\n\"presenter_id\":input_data.presenter_id,\n\"driver_id\":input_data.driver_id,\n"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "response",
                            "range": [
                                903,
                                914
                            ],
                            "children": [
                                {
                                    "type": "CallExpression",
                                    "name": "self.create_clip",
                                    "range": [
                                        905,
                                        914
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "credentials.api_key",
                                            "range": [
                                                909,
                                                911
                                            ],
                                            "children": [],
                                            "content": "create_clip(credentials"
                                        },
                                        {
                                            "type": "Argument",
                                            "name": "payload",
                                            "range": [
                                                913,
                                                913
                                            ],
                                            "children": [],
                                            "content": "api_key"
                                        }
                                    ],
                                    "content": "response=self.create_clip(credentials.api_key,"
                                }
                            ],
                            "content": "\n\nresponse=self.create_clip(credentials.api_key,"
                        },
                        {
                            "type": "VariableDecl",
                            "name": "clip_id",
                            "range": [
                                916,
                                922
                            ],
                            "children": [
                                {
                                    "type": "MemberExpression",
                                    "name": "response.id",
                                    "range": [
                                        918,
                                        921
                                    ],
                                    "children": [],
                                    "content": "clip_id=response["
                                }
                            ],
                            "content": ")\nclip_id=response[\"id\""
                        },
                        {
                            "type": "ForStatement",
                            "name": "",
                            "range": [
                                930,
                                1002
                            ],
                            "children": [
                                {
                                    "type": "VariableDecl",
                                    "name": "_",
                                    "range": [
                                        931,
                                        931
                                    ],
                                    "children": [],
                                    "content": "\n"
                                },
                                {
                                    "type": "CallExpression",
                                    "name": "range",
                                    "range": [
                                        933,
                                        938
                                    ],
                                    "children": [
                                        {
                                            "type": "Argument",
                                            "name": "input_data.max_polling_attempts",
                                            "range": [
                                                935,
                                                937
                                            ],
                                            "children": [],
                                            "content": "range(input_data"
                                        }
                                    ],
                                    "content": "_ in range(input_data."
                                },
                                {
                                    "type": "BlockStatement",
                                    "name": "",
                                    "range": [
                                        940,
                                        1002
                                    ],
                                    "children": [
                                        {
                                            "type": "VariableDecl",
                                            "name": "status_response",
                                            "range": [
                                                941,
                                                952
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "self.get_clip_status",
                                                    "range": [
                                                        943,
                                                        952
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "credentials.api_key",
                                                            "range": [
                                                                947,
                                                                949
                                                            ],
                                                            "children": [],
                                                            "content": "get_clip_status(credentials"
                                                        },
                                                        {
                                                            "type": "Argument",
                                                            "name": "clip_id",
                                                            "range": [
                                                                951,
                                                                951
                                                            ],
                                                            "children": [],
                                                            "content": "api_key"
                                                        }
                                                    ],
                                                    "content": "status_response=self.get_clip_status(credentials.api_key,"
                                                }
                                            ],
                                            "content": ":\nstatus_response=self.get_clip_status(credentials.api_key,"
                                        },
                                        {
                                            "type": "IfStatement",
                                            "name": "",
                                            "range": [
                                                954,
                                                962
                                            ],
                                            "children": [
                                                {
                                                    "type": "BinaryExpression",
                                                    "name": "==",
                                                    "range": [
                                                        955,
                                                        961
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "MemberExpression",
                                                            "name": "status_response.status",
                                                            "range": [
                                                                956,
                                                                958
                                                            ],
                                                            "children": [],
                                                            "content": "if status_response["
                                                        },
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"done\"",
                                                            "range": [
                                                                960,
                                                                960
                                                            ],
                                                            "children": [],
                                                            "content": "]"
                                                        }
                                                    ],
                                                    "content": "\nif status_response[\"status\"]="
                                                },
                                                {
                                                    "type": "BlockStatement",
                                                    "name": "",
                                                    "range": [
                                                        963,
                                                        971
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "YieldExpression",
                                                            "name": "",
                                                            "range": [
                                                                964,
                                                                971
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "Literal",
                                                                    "name": "\"video_url\"",
                                                                    "range": [
                                                                        965,
                                                                        965
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\n"
                                                                },
                                                                {
                                                                    "type": "MemberExpression",
                                                                    "name": "status_response.result_url",
                                                                    "range": [
                                                                        967,
                                                                        970
                                                                    ],
                                                                    "children": [],
                                                                    "content": "\"video_url\",status_response["
                                                                }
                                                            ],
                                                            "content": ":\nyield \"video_url\",status_response[\"result_url\""
                                                        }
                                                    ],
                                                    "content": "\"done\":\nyield \"video_url\",status_response[\"result_url\""
                                                }
                                            ],
                                            "content": ")\nif status_response[\"status\"]=="
                                        },
                                        {
                                            "type": "IfStatement",
                                            "name": "",
                                            "range": [
                                                974,
                                                982
                                            ],
                                            "children": [
                                                {
                                                    "type": "BinaryExpression",
                                                    "name": "==",
                                                    "range": [
                                                        975,
                                                        981
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "MemberExpression",
                                                            "name": "status_response.status",
                                                            "range": [
                                                                976,
                                                                978
                                                            ],
                                                            "children": [],
                                                            "content": "elif status_response["
                                                        },
                                                        {
                                                            "type": "Literal",
                                                            "name": "\"error\"",
                                                            "range": [
                                                                980,
                                                                980
                                                            ],
                                                            "children": [],
                                                            "content": "]"
                                                        }
                                                    ],
                                                    "content": "\nelif status_response[\"status\"]="
                                                },
                                                {
                                                    "type": "BlockStatement",
                                                    "name": "",
                                                    "range": [
                                                        983,
                                                        992
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "ThrowStatement",
                                                            "name": "",
                                                            "range": [
                                                                984,
                                                                992
                                                            ],
                                                            "children": [
                                                                {
                                                                    "type": "NewExpression",
                                                                    "name": "RuntimeError",
                                                                    "range": [
                                                                        985,
                                                                        992
                                                                    ],
                                                                    "children": [
                                                                        {
                                                                            "type": "TemplateLiteral",
                                                                            "name": "",
                                                                            "range": [
                                                                                987,
                                                                                990
                                                                            ],
                                                                            "children": [
                                                                                {
                                                                                    "type": "TemplateElement",
                                                                                    "name": "Clip creation failed: ",
                                                                                    "range": [
                                                                                        987,
                                                                                        987
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "RuntimeError"
                                                                                },
                                                                                {
                                                                                    "type": "Expression",
                                                                                    "name": "status_response.get('error', 'Unknown error')",
                                                                                    "range": [
                                                                                        989,
                                                                                        989
                                                                                    ],
                                                                                    "children": [],
                                                                                    "content": "\n"
                                                                                }
                                                                            ],
                                                                            "content": "RuntimeError(\nf"
                                                                        }
                                                                    ],
                                                                    "content": "\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n"
                                                                }
                                                            ],
                                                            "content": ":\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n"
                                                        }
                                                    ],
                                                    "content": "\"error\":\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n"
                                                }
                                            ],
                                            "content": "return\nelif status_response[\"status\"]=="
                                        },
                                        {
                                            "type": "ExpressionStatement",
                                            "name": "",
                                            "range": [
                                                994,
                                                1002
                                            ],
                                            "children": [
                                                {
                                                    "type": "CallExpression",
                                                    "name": "time.sleep",
                                                    "range": [
                                                        995,
                                                        1001
                                                    ],
                                                    "children": [
                                                        {
                                                            "type": "Argument",
                                                            "name": "input_data.polling_interval",
                                                            "range": [
                                                                998,
                                                                1000
                                                            ],
                                                            "children": [],
                                                            "content": "sleep(input_data"
                                                        }
                                                    ],
                                                    "content": "\ntime.sleep(input_data."
                                                }
                                            ],
                                            "content": "\n\ntime.sleep(input_data.polling_interval"
                                        }
                                    ],
                                    "content": "):\nstatus_response=self.get_clip_status(credentials.api_key,clip_id)\nif status_response[\"status\"]==\"done\":\nyield \"video_url\",status_response[\"result_url\"]\nreturn\nelif status_response[\"status\"]==\"error\":\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n)\n\ntime.sleep(input_data.polling_interval"
                                }
                            ],
                            "content": "status\nfor _ in range(input_data.max_polling_attempts):\nstatus_response=self.get_clip_status(credentials.api_key,clip_id)\nif status_response[\"status\"]==\"done\":\nyield \"video_url\",status_response[\"result_url\"]\nreturn\nelif status_response[\"status\"]==\"error\":\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n)\n\ntime.sleep(input_data.polling_interval"
                        },
                        {
                            "type": "ThrowStatement",
                            "name": "",
                            "range": [
                                1004,
                                1009
                            ],
                            "children": [
                                {
                                    "type": "NewExpression",
                                    "name": "TimeoutError",
                                    "range": [
                                        1005,
                                        1009
                                    ],
                                    "children": [
                                        {
                                            "type": "Literal",
                                            "name": "\"Clip creation timed out\"",
                                            "range": [
                                                1007,
                                                1007
                                            ],
                                            "children": [],
                                            "content": "TimeoutError"
                                        }
                                    ],
                                    "content": "\nraise TimeoutError(\"Clip creation timed out\""
                                }
                            ],
                            "content": "\n\nraise TimeoutError(\"Clip creation timed out\""
                        }
                    ],
                    "content": "BlockOutput:\n#Create the clip\npayload={\n\"script\":{\n\"type\":\"text\",\n\"subtitles\":str(input_data.subtitles).lower(),\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,\n},\n\"ssml\":str(input_data.ssml).lower(),\n\"input\":input_data.script_input,\n},\n\"config\":{\"result_format\":input_data.result_format},\n\"presenter_config\":{\"crop\":{\"type\":input_data.crop_type}},\n\"presenter_id\":input_data.presenter_id,\n\"driver_id\":input_data.driver_id,\n}\n\nresponse=self.create_clip(credentials.api_key,payload)\nclip_id=response[\"id\"]\n\n#Poll for clip status\nfor _ in range(input_data.max_polling_attempts):\nstatus_response=self.get_clip_status(credentials.api_key,clip_id)\nif status_response[\"status\"]==\"done\":\nyield \"video_url\",status_response[\"result_url\"]\nreturn\nelif status_response[\"status\"]==\"error\":\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n)\n\ntime.sleep(input_data.polling_interval)\n\nraise TimeoutError(\"Clip creation timed out\""
                }
            ],
            "content": "\n\ndef run(\nself,input_data:Input,*,credentials:APIKeyCredentials,**kwargs\n)->BlockOutput:\n#Create the clip\npayload={\n\"script\":{\n\"type\":\"text\",\n\"subtitles\":str(input_data.subtitles).lower(),\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,\n},\n\"ssml\":str(input_data.ssml).lower(),\n\"input\":input_data.script_input,\n},\n\"config\":{\"result_format\":input_data.result_format},\n\"presenter_config\":{\"crop\":{\"type\":input_data.crop_type}},\n\"presenter_id\":input_data.presenter_id,\n\"driver_id\":input_data.driver_id,\n}\n\nresponse=self.create_clip(credentials.api_key,payload)\nclip_id=response[\"id\"]\n\n#Poll for clip status\nfor _ in range(input_data.max_polling_attempts):\nstatus_response=self.get_clip_status(credentials.api_key,clip_id)\nif status_response[\"status\"]==\"done\":\nyield \"video_url\",status_response[\"result_url\"]\nreturn\nelif status_response[\"status\"]==\"error\":\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n)\n\ntime.sleep(input_data.polling_interval)\n\nraise TimeoutError(\"Clip creation timed out\""
        }
    ],
    "content": "TEST_CREDENTIALS=APIKeyCredentials(\nid=\"01234567-89ab-cdef-0123-456789abcdef\",\nprovider=\"d_id\",\napi_key=SecretStr(\"mock-d-id-api-key\"),\ntitle=\"Mock D-ID API key\",\nexpires_at=None,\n)\nTEST_CREDENTIALS_INPUT={\n\"provider\":TEST_CREDENTIALS.provider,\n\"id\":TEST_CREDENTIALS.id,\n\"type\":TEST_CREDENTIALS.type,\n\"title\":TEST_CREDENTIALS.type,\n}\n\n\nclass CreateTalkingAvatarVideoBlock(Block):\nclass Input(BlockSchema):\ncredentials:CredentialsMetaInput[\nLiteral[ProviderName.D_ID],Literal[\"api_key\"]\n]=CredentialsField(\ndescription=\"The D-ID integration can be used with \"\n\"any API key with sufficient permissions for the blocks it is used on.\",\n)\nscript_input:str=SchemaField(\ndescription=\"The text input for the script\",\nplaceholder=\"Welcome to AutoGPT\",\n)\nprovider:Literal[\"microsoft\",\"elevenlabs\",\"amazon\"]=SchemaField(\ndescription=\"The voice provider to use\",default=\"microsoft\"\n)\nvoice_id:str=SchemaField(\ndescription=\"The voice ID to use, get list of voices [here](https://docs.agpt.co/server/d_id)\",\ndefault=\"en-US-JennyNeural\",\n)\npresenter_id:str=SchemaField(\ndescription=\"The presenter ID to use\",default=\"amy-Aq6OmGZnMt\"\n)\ndriver_id:str=SchemaField(\ndescription=\"The driver ID to use\",default=\"Vcq0R4a8F0\"\n)\nresult_format:Literal[\"mp4\",\"gif\",\"wav\"]=SchemaField(\ndescription=\"The desired result format\",default=\"mp4\"\n)\ncrop_type:Literal[\"wide\",\"square\",\"vertical\"]=SchemaField(\ndescription=\"The crop type for the presenter\",default=\"wide\"\n)\nsubtitles:bool=SchemaField(\ndescription=\"Whether to include subtitles\",default=False\n)\nssml:bool=SchemaField(description=\"Whether the input is SSML\",default=False)\nmax_polling_attempts:int=SchemaField(\ndescription=\"Maximum number of polling attempts\",default=30,ge=5\n)\npolling_interval:int=SchemaField(\ndescription=\"Interval between polling attempts in seconds\",default=10,ge=5\n)\n\nclass Output(BlockSchema):\nvideo_url:str=SchemaField(description=\"The URL of the created video\")\nerror:str=SchemaField(description=\"Error message if the request failed\")\n\ndef __init__(self):\nsuper().__init__(\nid=\"98c6f503-8c47-4b1c-a96d-351fc7c87dab\",\ndescription=\"This block integrates with D-ID to create video clips and retrieve their URLs.\",\ncategories={BlockCategory.AI},\ninput_schema=CreateTalkingAvatarVideoBlock.Input,\noutput_schema=CreateTalkingAvatarVideoBlock.Output,\ntest_input={\n\"credentials\":TEST_CREDENTIALS_INPUT,\n\"script_input\":\"Welcome to AutoGPT\",\n\"voice_id\":\"en-US-JennyNeural\",\n\"presenter_id\":\"amy-Aq6OmGZnMt\",\n\"driver_id\":\"Vcq0R4a8F0\",\n\"result_format\":\"mp4\",\n\"crop_type\":\"wide\",\n\"subtitles\":False,\n\"ssml\":False,\n\"max_polling_attempts\":5,\n\"polling_interval\":5,\n},\ntest_output=[\n(\n\"video_url\",\n\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n),\n],\ntest_mock={\n\"create_clip\":lambda*args,**kwargs:{\n\"id\":\"abcd1234-5678-efgh-ijkl-mnopqrstuvwx\",\n\"status\":\"created\",\n},\n\"get_clip_status\":lambda*args,**kwargs:{\n\"status\":\"done\",\n\"result_url\":\"https://d-id.com/api/clips/abcd1234-5678-efgh-ijkl-mnopqrstuvwx/video\",\n},\n},\ntest_credentials=TEST_CREDENTIALS,\n)\n\ndef create_clip(self,api_key:SecretStr,payload:dict)->dict:\nurl=\"https://api.d-id.com/clips\"\nheaders={\n\"accept\":\"application/json\",\n\"content-type\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\",\n}\nresponse=requests.post(url,json=payload,headers=headers)\nreturn response.json()\n\ndef get_clip_status(self,api_key:SecretStr,clip_id:str)->dict:\nurl=f \"https://api.d-id.com/clips/{clip_id}\"\nheaders={\n\"accept\":\"application/json\",\n\"authorization\":f \"Basic {api_key.get_secret_value()}\",\n}\nresponse=requests.get(url,headers=headers)\nreturn response.json()\n\ndef run(\nself,input_data:Input,*,credentials:APIKeyCredentials,**kwargs\n)->BlockOutput:\n#Create the clip\npayload={\n\"script\":{\n\"type\":\"text\",\n\"subtitles\":str(input_data.subtitles).lower(),\n\"provider\":{\n\"type\":input_data.provider,\n\"voice_id\":input_data.voice_id,\n},\n\"ssml\":str(input_data.ssml).lower(),\n\"input\":input_data.script_input,\n},\n\"config\":{\"result_format\":input_data.result_format},\n\"presenter_config\":{\"crop\":{\"type\":input_data.crop_type}},\n\"presenter_id\":input_data.presenter_id,\n\"driver_id\":input_data.driver_id,\n}\n\nresponse=self.create_clip(credentials.api_key,payload)\nclip_id=response[\"id\"]\n\n#Poll for clip status\nfor _ in range(input_data.max_polling_attempts):\nstatus_response=self.get_clip_status(credentials.api_key,clip_id)\nif status_response[\"status\"]==\"done\":\nyield \"video_url\",status_response[\"result_url\"]\nreturn\nelif status_response[\"status\"]==\"error\":\nraise RuntimeError(\nf \"Clip creation failed: {status_response.get('error', 'Unknown error')}\"\n)\n\ntime.sleep(input_data.polling_interval)\n\nraise TimeoutError(\"Clip creation timed out\""
}
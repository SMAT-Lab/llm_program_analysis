2025-01-08 10:01:34,614 - INFO - Processing sample 108
2025-01-08 10:01:34,615 - INFO - Starting Step 0: Splitting code into top-level declarations
2025-01-08 10:01:37,063 - INFO - Successfully split code into 2 top-level declarations
2025-01-08 10:01:37,065 - INFO - Processing chunk #0 (size=250 chars, start_index=0)
2025-01-08 10:01:37,066 - INFO - Processing chunk with 250 chars starting at index 0
2025-01-08 10:01:37,066 - INFO - Starting main AST analysis flow
2025-01-08 10:01:37,067 - INFO - Tokenized code into 49 tokens
2025-01-08 10:01:37,067 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:01:37,071 - INFO - Processing chunk #1 (size=2995 chars, start_index=49)
2025-01-08 10:01:37,078 - INFO - Processing chunk with 2995 chars starting at index 49
2025-01-08 10:01:37,079 - INFO - Starting main AST analysis flow
2025-01-08 10:01:37,079 - INFO - Tokenized code into 369 tokens
2025-01-08 10:01:37,079 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:01:43,353 - INFO - Step 1 result: {'type': 'Program', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'ClassDeclaration', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'MethodDeclaration', 'name': '__init__', 'range': [68, 116], 'children': []}, {'type': 'MethodDeclaration', 'name': 'get_login_url', 'range': [118, 177], 'children': []}, {'type': 'MethodDeclaration', 'name': 'exchange_code_for_tokens', 'range': [179, 334], 'children': []}, {'type': 'MethodDeclaration', 'name': 'revoke_tokens', 'range': [383, 390], 'children': []}, {'type': 'MethodDeclaration', 'name': '_refresh_tokens', 'range': [393, 415], 'children': []}]}]}
2025-01-08 10:01:43,354 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:01:43,641 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [0, 48], 'children': [{'type': 'ImportDeclaration', 'name': 'b64encode', 'range': [0, 4], 'children': []}, {'type': 'ImportDeclaration', 'name': 'urlencode', 'range': [5, 11], 'children': []}, {'type': 'ImportDeclaration', 'name': 'OAuth2Credentials', 'range': [13, 21], 'children': []}, {'type': 'ImportDeclaration', 'name': 'ProviderName', 'range': [22, 30], 'children': []}, {'type': 'ImportDeclaration', 'name': 'requests', 'range': [31, 39], 'children': []}, {'type': 'ImportDeclaration', 'name': 'BaseOAuthHandler', 'range': [41, 46], 'children': []}]}
2025-01-08 10:01:43,641 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:01:58,094 - INFO - Step 2 result: {'nodes': [{'type': 'ImportDeclaration', 'name': 'b64encode', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'base64', 'range': [0, 1], 'children': []}, {'type': 'ImportSpecifier', 'name': 'b64encode', 'range': [3, 4], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'urlencode', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'urllib.parse', 'range': [5, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'urlencode', 'range': [10, 11], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'OAuth2Credentials', 'range': [13, 21], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [13, 18], 'children': []}, {'type': 'ImportSpecifier', 'name': 'OAuth2Credentials', 'range': [20, 21], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'ProviderName', 'range': [22, 30], 'children': [{'type': 'FromImport', 'name': 'backend.integrations.providers', 'range': [22, 27], 'children': []}, {'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [29, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'requests', 'range': [31, 39], 'children': [{'type': 'FromImport', 'name': 'backend.util.request', 'range': [31, 36], 'children': []}, {'type': 'ImportSpecifier', 'name': 'requests', 'range': [38, 39], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseOAuthHandler', 'range': [41, 46], 'children': [{'type': 'FromImport', 'name': '.base', 'range': [41, 43], 'children': []}, {'type': 'ImportSpecifier', 'name': 'BaseOAuthHandler', 'range': [45, 46], 'children': []}]}]}
2025-01-08 10:01:58,094 - INFO - Starting Step 3: AST simplification
2025-01-08 10:02:13,563 - INFO - Step 3 result: {'nodes': [{'type': 'ImportDeclaration', 'name': 'b64encode', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'base64', 'range': [0, 1], 'children': []}, {'type': 'ImportSpecifier', 'name': 'b64encode', 'range': [3, 4], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'urlencode', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'urllib.parse', 'range': [5, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'urlencode', 'range': [10, 11], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'OAuth2Credentials', 'range': [13, 21], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [13, 18], 'children': []}, {'type': 'ImportSpecifier', 'name': 'OAuth2Credentials', 'range': [20, 21], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'ProviderName', 'range': [22, 30], 'children': [{'type': 'FromImport', 'name': 'backend.integrations.providers', 'range': [22, 27], 'children': []}, {'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [29, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'requests', 'range': [31, 39], 'children': [{'type': 'FromImport', 'name': 'backend.util.request', 'range': [31, 36], 'children': []}, {'type': 'ImportSpecifier', 'name': 'requests', 'range': [38, 39], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseOAuthHandler', 'range': [41, 46], 'children': [{'type': 'FromImport', 'name': '.base', 'range': [41, 43], 'children': []}, {'type': 'ImportSpecifier', 'name': 'BaseOAuthHandler', 'range': [45, 46], 'children': []}]}]}
2025-01-08 10:02:13,563 - INFO - Starting Step 4: AST normalization
2025-01-08 10:02:28,387 - INFO - Step 4 result: {'nodes': [{'type': 'ImportDeclaration', 'name': 'b64encode', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'base64', 'range': [0, 1], 'children': []}, {'type': 'ImportSpecifier', 'name': 'b64encode', 'range': [3, 4], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'urlencode', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'urllib.parse', 'range': [5, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'urlencode', 'range': [10, 11], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'OAuth2Credentials', 'range': [13, 21], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [13, 18], 'children': []}, {'type': 'ImportSpecifier', 'name': 'OAuth2Credentials', 'range': [20, 21], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'ProviderName', 'range': [22, 30], 'children': [{'type': 'FromImport', 'name': 'backend.integrations.providers', 'range': [22, 27], 'children': []}, {'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [29, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'requests', 'range': [31, 39], 'children': [{'type': 'FromImport', 'name': 'backend.util.request', 'range': [31, 36], 'children': []}, {'type': 'ImportSpecifier', 'name': 'requests', 'range': [38, 39], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseOAuthHandler', 'range': [41, 46], 'children': [{'type': 'FromImport', 'name': '.base', 'range': [41, 43], 'children': []}, {'type': 'ImportSpecifier', 'name': 'BaseOAuthHandler', 'range': [45, 46], 'children': []}]}]}
2025-01-08 10:02:28,388 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:02:43,960 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'MainOrSomething', 'range': [0, 46], 'children': [{'type': 'ImportDeclaration', 'name': 'b64encode', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'base64', 'range': [0, 1], 'children': []}, {'type': 'ImportSpecifier', 'name': 'b64encode', 'range': [3, 4], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'urlencode', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'urllib.parse', 'range': [5, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'urlencode', 'range': [10, 11], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'OAuth2Credentials', 'range': [13, 21], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [13, 18], 'children': []}, {'type': 'ImportSpecifier', 'name': 'OAuth2Credentials', 'range': [20, 21], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'ProviderName', 'range': [22, 30], 'children': [{'type': 'FromImport', 'name': 'backend.integrations.providers', 'range': [22, 27], 'children': []}, {'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [29, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'requests', 'range': [31, 39], 'children': [{'type': 'FromImport', 'name': 'backend.util.request', 'range': [31, 36], 'children': []}, {'type': 'ImportSpecifier', 'name': 'requests', 'range': [38, 39], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseOAuthHandler', 'range': [41, 46], 'children': [{'type': 'FromImport', 'name': '.base', 'range': [41, 43], 'children': []}, {'type': 'ImportSpecifier', 'name': 'BaseOAuthHandler', 'range': [45, 46], 'children': []}]}]}]}
2025-01-08 10:02:43,960 - INFO - Completed main AST analysis flow
2025-01-08 10:02:43,961 - INFO - Successfully processed chunk
2025-01-08 10:03:03,930 - INFO - Step 2 result: {'type': 'Program', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'ClassDeclaration', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'MethodDeclaration', 'name': '__init__', 'range': [68, 116], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [70, 84], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [71, 71], 'children': []}, {'type': 'Parameter', 'name': 'client_id', 'range': [73, 75], 'children': []}, {'type': 'Parameter', 'name': 'client_secret', 'range': [77, 79], 'children': []}, {'type': 'Parameter', 'name': 'redirect_uri', 'range': [81, 83], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [86, 116], 'children': [{'type': 'Assignment', 'name': 'assignment', 'range': [87, 91], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [87, 89], 'children': []}, {'type': 'Identifier', 'name': 'client_id', 'range': [91, 91], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [93, 97], 'children': [{'type': 'Identifier', 'name': 'self.client_secret', 'range': [93, 95], 'children': []}, {'type': 'Identifier', 'name': 'client_secret', 'range': [97, 97], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [99, 103], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [99, 101], 'children': []}, {'type': 'Identifier', 'name': 'redirect_uri', 'range': [103, 103], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [105, 109], 'children': [{'type': 'Identifier', 'name': 'self.auth_base_url', 'range': [105, 107], 'children': []}, {'type': 'StringLiteral', 'name': '"https://api.notion.com/v1/oauth/authorize"', 'range': [109, 109], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [111, 115], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [111, 113], 'children': []}, {'type': 'StringLiteral', 'name': '"https://api.notion.com/v1/oauth/token"', 'range': [115, 115], 'children': []}]}]}]}, {'type': 'MethodDeclaration', 'name': 'get_login_url', 'range': [118, 177], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [120, 133], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [121, 121], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [123, 125], 'children': []}, {'type': 'Parameter', 'name': 'state', 'range': [130, 132], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [138, 177], 'children': [{'type': 'VariableDeclaration', 'name': 'params', 'range': [139, 172], 'children': [{'type': 'ObjectLiteral', 'name': 'params', 'range': [141, 172], 'children': [{'type': 'Property', 'name': 'client_id', 'range': [143, 147], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [145, 147], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [150, 154], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [152, 154], 'children': []}]}, {'type': 'Property', 'name': 'response_type', 'range': [157, 159], 'children': [{'type': 'StringLiteral', 'name': '"code"', 'range': [159, 159], 'children': []}]}, {'type': 'Property', 'name': 'owner', 'range': [162, 164], 'children': [{'type': 'StringLiteral', 'name': '"user"', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'state', 'range': [167, 169], 'children': [{'type': 'Identifier', 'name': 'state', 'range': [169, 169], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [174, 176], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.auth_base_url}?{urlencode(params)}"', 'range': [176, 176], 'children': []}]}]}]}, {'type': 'MethodDeclaration', 'name': 'exchange_code_for_tokens', 'range': [179, 334], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [181, 195], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [183, 183], 'children': []}, {'type': 'Parameter', 'name': 'code', 'range': [185, 187], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [189, 191], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [201, 334], 'children': [{'type': 'VariableDeclaration', 'name': 'request_body', 'range': [202, 223], 'children': [{'type': 'ObjectLiteral', 'name': 'request_body', 'range': [204, 223], 'children': [{'type': 'Property', 'name': 'grant_type', 'range': [206, 208], 'children': [{'type': 'StringLiteral', 'name': '"authorization_code"', 'range': [208, 208], 'children': []}]}, {'type': 'Property', 'name': 'code', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'code', 'range': [213, 213], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [216, 218], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [218, 218], 'children': []}]}]}]}, {'type': 'VariableDeclaration', 'name': 'auth_str', 'range': [225, 240], 'children': [{'type': 'CallExpression', 'name': 'b64encode', 'range': [227, 235], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.client_id}:{self.client_secret}"', 'range': [230, 230], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'headers', 'range': [241, 256], 'children': [{'type': 'ObjectLiteral', 'name': 'headers', 'range': [243, 256], 'children': [{'type': 'Property', 'name': 'Authorization', 'range': [245, 247], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Basic {auth_str}"', 'range': [248, 248], 'children': []}]}, {'type': 'Property', 'name': 'Accept', 'range': [251, 253], 'children': [{'type': 'StringLiteral', 'name': '"application/json"', 'range': [253, 253], 'children': []}]}]}]}, {'type': 'VariableDeclaration', 'name': 'response', 'range': [258, 275], 'children': [{'type': 'CallExpression', 'name': 'requests.post', 'range': [260, 275], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [264, 266], 'children': []}, {'type': 'Identifier', 'name': 'request_body', 'range': [270, 270], 'children': []}, {'type': 'Identifier', 'name': 'headers', 'range': [274, 274], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'token_data', 'range': [277, 284], 'children': [{'type': 'CallExpression', 'name': 'response.json', 'range': [279, 284], 'children': []}]}, {'type': 'VariableDeclaration', 'name': 'email', 'range': [296, 332], 'children': [{'type': 'ConditionalExpression', 'name': 'conditional', 'range': [298, 332], 'children': [{'type': 'LogicalExpression', 'name': 'logical', 'range': [311, 329], 'children': [{'type': 'BinaryExpression', 'name': 'binary', 'range': [311, 318], 'children': [{'type': 'Identifier', 'name': '"person"', 'range': [312, 312], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]', 'range': [314, 316], 'children': []}]}, {'type': 'BinaryExpression', 'name': 'binary', 'range': [319, 329], 'children': [{'type': 'Identifier', 'name': '"email"', 'range': [320, 320], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]', 'range': [322, 328], 'children': []}]}]}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]["email"]', 'range': [300, 309], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [331, 331], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [336, 378], 'children': [{'type': 'NewExpression', 'name': 'OAuth2Credentials', 'range': [337, 378], 'children': [{'type': 'Property', 'name': 'provider', 'range': [340, 342], 'children': [{'type': 'Identifier', 'name': 'self.PROVIDER_NAME', 'range': [342, 344], 'children': []}]}, {'type': 'Property', 'name': 'title', 'range': [347, 349], 'children': [{'type': 'CallExpression', 'name': 'token_data.get', 'range': [349, 354], 'children': [{'type': 'StringLiteral', 'name': '"workspace_name"', 'range': [353, 353], 'children': []}]}]}, {'type': 'Property', 'name': 'username', 'range': [357, 359], 'children': [{'type': 'Identifier', 'name': 'email', 'range': [359, 359], 'children': []}]}, {'type': 'Property', 'name': 'access_token', 'range': [362, 364], 'children': [{'type': 'Identifier', 'name': 'token_data["access_token"]', 'range': [364, 366], 'children': []}]}, {'type': 'Property', 'name': 'refresh_token', 'range': [370, 372], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [372, 372], 'children': []}]}, {'type': 'Property', 'name': 'access_token_expires_at', 'range': [375, 377], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [377, 377], 'children': []}]}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'revoke_tokens', 'range': [383, 390], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [385, 387], 'children': [{'type': 'Parameter', 'name': 'credentials', 'range': [386, 386], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [388, 390], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [389, 390], 'children': [{'type': 'BooleanLiteral', 'name': 'False', 'range': [390, 390], 'children': []}]}]}]}, {'type': 'MethodDeclaration', 'name': '_refresh_tokens', 'range': [393, 415], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [395, 401], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [396, 396], 'children': []}, {'type': 'Parameter', 'name': 'credentials', 'range': [398, 400], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [406, 415], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [414, 415], 'children': [{'type': 'Identifier', 'name': 'credentials', 'range': [415, 415], 'children': []}]}]}]}]}]}
2025-01-08 10:03:03,930 - INFO - Starting Step 3: AST simplification
2025-01-08 10:04:25,810 - INFO - Step 3 result: {'type': 'Program', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'ClassDeclaration', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'MethodDeclaration', 'name': '__init__', 'range': [68, 116], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [70, 84], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [71, 71], 'children': []}, {'type': 'Parameter', 'name': 'client_id', 'range': [73, 75], 'children': []}, {'type': 'Parameter', 'name': 'client_secret', 'range': [77, 79], 'children': []}, {'type': 'Parameter', 'name': 'redirect_uri', 'range': [81, 83], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [86, 116], 'children': [{'type': 'Assignment', 'name': 'assignment', 'range': [87, 91], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [87, 89], 'children': []}, {'type': 'Identifier', 'name': 'client_id', 'range': [91, 91], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [93, 97], 'children': [{'type': 'Identifier', 'name': 'self.client_secret', 'range': [93, 95], 'children': []}, {'type': 'Identifier', 'name': 'client_secret', 'range': [97, 97], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [99, 103], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [99, 101], 'children': []}, {'type': 'Identifier', 'name': 'redirect_uri', 'range': [103, 103], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [105, 109], 'children': [{'type': 'Identifier', 'name': 'self.auth_base_url', 'range': [105, 107], 'children': []}, {'type': 'StringLiteral', 'name': '"https://api.notion.com/v1/oauth/authorize"', 'range': [109, 109], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [111, 115], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [111, 113], 'children': []}, {'type': 'StringLiteral', 'name': '"https://api.notion.com/v1/oauth/token"', 'range': [115, 115], 'children': []}]}]}]}, {'type': 'MethodDeclaration', 'name': 'get_login_url', 'range': [118, 177], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [120, 133], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [121, 121], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [123, 125], 'children': []}, {'type': 'Parameter', 'name': 'state', 'range': [130, 132], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [138, 177], 'children': [{'type': 'VariableDeclaration', 'name': 'params', 'range': [139, 172], 'children': [{'type': 'ObjectLiteral', 'name': 'params', 'range': [141, 172], 'children': [{'type': 'Property', 'name': 'client_id', 'range': [143, 147], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [145, 147], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [150, 154], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [152, 154], 'children': []}]}, {'type': 'Property', 'name': 'response_type', 'range': [157, 159], 'children': [{'type': 'StringLiteral', 'name': '"code"', 'range': [159, 159], 'children': []}]}, {'type': 'Property', 'name': 'owner', 'range': [162, 164], 'children': [{'type': 'StringLiteral', 'name': '"user"', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'state', 'range': [167, 169], 'children': [{'type': 'Identifier', 'name': 'state', 'range': [169, 169], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [174, 176], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.auth_base_url}?{urlencode(params)}"', 'range': [176, 176], 'children': []}]}]}]}, {'type': 'MethodDeclaration', 'name': 'exchange_code_for_tokens', 'range': [179, 334], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [181, 195], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [183, 183], 'children': []}, {'type': 'Parameter', 'name': 'code', 'range': [185, 187], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [189, 191], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [201, 334], 'children': [{'type': 'VariableDeclaration', 'name': 'request_body', 'range': [202, 223], 'children': [{'type': 'ObjectLiteral', 'name': 'request_body', 'range': [204, 223], 'children': [{'type': 'Property', 'name': 'grant_type', 'range': [206, 208], 'children': [{'type': 'StringLiteral', 'name': '"authorization_code"', 'range': [208, 208], 'children': []}]}, {'type': 'Property', 'name': 'code', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'code', 'range': [213, 213], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [216, 218], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [218, 218], 'children': []}]}]}]}, {'type': 'VariableDeclaration', 'name': 'auth_str', 'range': [225, 240], 'children': [{'type': 'CallExpression', 'name': 'b64encode', 'range': [227, 235], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.client_id}:{self.client_secret}"', 'range': [230, 230], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'headers', 'range': [241, 256], 'children': [{'type': 'ObjectLiteral', 'name': 'headers', 'range': [243, 256], 'children': [{'type': 'Property', 'name': 'Authorization', 'range': [245, 247], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Basic {auth_str}"', 'range': [248, 248], 'children': []}]}, {'type': 'Property', 'name': 'Accept', 'range': [251, 253], 'children': [{'type': 'StringLiteral', 'name': '"application/json"', 'range': [253, 253], 'children': []}]}]}]}, {'type': 'VariableDeclaration', 'name': 'response', 'range': [258, 275], 'children': [{'type': 'CallExpression', 'name': 'requests.post', 'range': [260, 275], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [264, 266], 'children': []}, {'type': 'Identifier', 'name': 'request_body', 'range': [270, 270], 'children': []}, {'type': 'Identifier', 'name': 'headers', 'range': [274, 274], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'token_data', 'range': [277, 284], 'children': [{'type': 'CallExpression', 'name': 'response.json', 'range': [279, 284], 'children': []}]}, {'type': 'VariableDeclaration', 'name': 'email', 'range': [296, 332], 'children': [{'type': 'ConditionalExpression', 'name': 'conditional', 'range': [298, 332], 'children': [{'type': 'LogicalExpression', 'name': 'logical', 'range': [311, 329], 'children': [{'type': 'BinaryExpression', 'name': 'binary', 'range': [311, 318], 'children': [{'type': 'Identifier', 'name': '"person"', 'range': [312, 312], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]', 'range': [314, 316], 'children': []}]}, {'type': 'BinaryExpression', 'name': 'binary', 'range': [319, 329], 'children': [{'type': 'Identifier', 'name': '"email"', 'range': [320, 320], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]', 'range': [322, 328], 'children': []}]}]}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]["email"]', 'range': [300, 309], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [331, 331], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [336, 378], 'children': [{'type': 'NewExpression', 'name': 'OAuth2Credentials', 'range': [337, 378], 'children': [{'type': 'Property', 'name': 'provider', 'range': [340, 342], 'children': [{'type': 'Identifier', 'name': 'self.PROVIDER_NAME', 'range': [342, 344], 'children': []}]}, {'type': 'Property', 'name': 'title', 'range': [347, 349], 'children': [{'type': 'CallExpression', 'name': 'token_data.get', 'range': [349, 354], 'children': [{'type': 'StringLiteral', 'name': '"workspace_name"', 'range': [353, 353], 'children': []}]}]}, {'type': 'Property', 'name': 'username', 'range': [357, 359], 'children': [{'type': 'Identifier', 'name': 'email', 'range': [359, 359], 'children': []}]}, {'type': 'Property', 'name': 'access_token', 'range': [362, 364], 'children': [{'type': 'Identifier', 'name': 'token_data["access_token"]', 'range': [364, 366], 'children': []}]}, {'type': 'Property', 'name': 'refresh_token', 'range': [370, 372], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [372, 372], 'children': []}]}, {'type': 'Property', 'name': 'access_token_expires_at', 'range': [375, 377], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [377, 377], 'children': []}]}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'revoke_tokens', 'range': [383, 390], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [385, 387], 'children': [{'type': 'Parameter', 'name': 'credentials', 'range': [386, 386], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [388, 390], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [389, 390], 'children': [{'type': 'BooleanLiteral', 'name': 'False', 'range': [390, 390], 'children': []}]}]}]}, {'type': 'MethodDeclaration', 'name': '_refresh_tokens', 'range': [393, 415], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [395, 401], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [396, 396], 'children': []}, {'type': 'Parameter', 'name': 'credentials', 'range': [398, 400], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [406, 415], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [414, 415], 'children': [{'type': 'Identifier', 'name': 'credentials', 'range': [415, 415], 'children': []}]}]}]}]}]}
2025-01-08 10:04:25,811 - INFO - Starting Step 4: AST normalization
2025-01-08 10:05:44,395 - INFO - Step 4 result: {'type': 'Program', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'ClassDecl', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'FunctionDecl', 'name': '__init__', 'range': [68, 116], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [70, 84], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [71, 71], 'children': []}, {'type': 'Parameter', 'name': 'client_id', 'range': [73, 75], 'children': []}, {'type': 'Parameter', 'name': 'client_secret', 'range': [77, 79], 'children': []}, {'type': 'Parameter', 'name': 'redirect_uri', 'range': [81, 83], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [86, 116], 'children': [{'type': 'Assignment', 'name': 'assignment', 'range': [87, 91], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [87, 89], 'children': []}, {'type': 'Identifier', 'name': 'client_id', 'range': [91, 91], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [93, 97], 'children': [{'type': 'Identifier', 'name': 'self.client_secret', 'range': [93, 95], 'children': []}, {'type': 'Identifier', 'name': 'client_secret', 'range': [97, 97], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [99, 103], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [99, 101], 'children': []}, {'type': 'Identifier', 'name': 'redirect_uri', 'range': [103, 103], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [105, 109], 'children': [{'type': 'Identifier', 'name': 'self.auth_base_url', 'range': [105, 107], 'children': []}, {'type': 'Literal', 'name': '"https://api.notion.com/v1/oauth/authorize"', 'range': [109, 109], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [111, 115], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [111, 113], 'children': []}, {'type': 'Literal', 'name': '"https://api.notion.com/v1/oauth/token"', 'range': [115, 115], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'get_login_url', 'range': [118, 177], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [120, 133], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [121, 121], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [123, 125], 'children': []}, {'type': 'Parameter', 'name': 'state', 'range': [130, 132], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [138, 177], 'children': [{'type': 'VariableDecl', 'name': 'params', 'range': [139, 172], 'children': [{'type': 'ObjectLiteral', 'name': 'params', 'range': [141, 172], 'children': [{'type': 'Property', 'name': 'client_id', 'range': [143, 147], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [145, 147], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [150, 154], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [152, 154], 'children': []}]}, {'type': 'Property', 'name': 'response_type', 'range': [157, 159], 'children': [{'type': 'Literal', 'name': '"code"', 'range': [159, 159], 'children': []}]}, {'type': 'Property', 'name': 'owner', 'range': [162, 164], 'children': [{'type': 'Literal', 'name': '"user"', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'state', 'range': [167, 169], 'children': [{'type': 'Identifier', 'name': 'state', 'range': [169, 169], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [174, 176], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.auth_base_url}?{urlencode(params)}"', 'range': [176, 176], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'exchange_code_for_tokens', 'range': [179, 334], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [181, 195], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [183, 183], 'children': []}, {'type': 'Parameter', 'name': 'code', 'range': [185, 187], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [189, 191], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [201, 334], 'children': [{'type': 'VariableDecl', 'name': 'request_body', 'range': [202, 223], 'children': [{'type': 'ObjectLiteral', 'name': 'request_body', 'range': [204, 223], 'children': [{'type': 'Property', 'name': 'grant_type', 'range': [206, 208], 'children': [{'type': 'Literal', 'name': '"authorization_code"', 'range': [208, 208], 'children': []}]}, {'type': 'Property', 'name': 'code', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'code', 'range': [213, 213], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [216, 218], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [218, 218], 'children': []}]}]}]}, {'type': 'VariableDecl', 'name': 'auth_str', 'range': [225, 240], 'children': [{'type': 'CallExpression', 'name': 'b64encode', 'range': [227, 235], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.client_id}:{self.client_secret}"', 'range': [230, 230], 'children': []}]}]}, {'type': 'VariableDecl', 'name': 'headers', 'range': [241, 256], 'children': [{'type': 'ObjectLiteral', 'name': 'headers', 'range': [243, 256], 'children': [{'type': 'Property', 'name': 'Authorization', 'range': [245, 247], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Basic {auth_str}"', 'range': [248, 248], 'children': []}]}, {'type': 'Property', 'name': 'Accept', 'range': [251, 253], 'children': [{'type': 'Literal', 'name': '"application/json"', 'range': [253, 253], 'children': []}]}]}]}, {'type': 'VariableDecl', 'name': 'response', 'range': [258, 275], 'children': [{'type': 'CallExpression', 'name': 'requests.post', 'range': [260, 275], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [264, 266], 'children': []}, {'type': 'Identifier', 'name': 'request_body', 'range': [270, 270], 'children': []}, {'type': 'Identifier', 'name': 'headers', 'range': [274, 274], 'children': []}]}]}, {'type': 'VariableDecl', 'name': 'token_data', 'range': [277, 284], 'children': [{'type': 'CallExpression', 'name': 'response.json', 'range': [279, 284], 'children': []}]}, {'type': 'VariableDecl', 'name': 'email', 'range': [296, 332], 'children': [{'type': 'ConditionalExpression', 'name': 'conditional', 'range': [298, 332], 'children': [{'type': 'LogicalExpression', 'name': 'logical', 'range': [311, 329], 'children': [{'type': 'BinaryExpression', 'name': 'binary', 'range': [311, 318], 'children': [{'type': 'Literal', 'name': '"person"', 'range': [312, 312], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]', 'range': [314, 316], 'children': []}]}, {'type': 'BinaryExpression', 'name': 'binary', 'range': [319, 329], 'children': [{'type': 'Literal', 'name': '"email"', 'range': [320, 320], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]', 'range': [322, 328], 'children': []}]}]}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]["email"]', 'range': [300, 309], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [331, 331], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [336, 378], 'children': [{'type': 'NewExpression', 'name': 'OAuth2Credentials', 'range': [337, 378], 'children': [{'type': 'Property', 'name': 'provider', 'range': [340, 342], 'children': [{'type': 'Identifier', 'name': 'self.PROVIDER_NAME', 'range': [342, 344], 'children': []}]}, {'type': 'Property', 'name': 'title', 'range': [347, 349], 'children': [{'type': 'CallExpression', 'name': 'token_data.get', 'range': [349, 354], 'children': [{'type': 'Literal', 'name': '"workspace_name"', 'range': [353, 353], 'children': []}]}]}, {'type': 'Property', 'name': 'username', 'range': [357, 359], 'children': [{'type': 'Identifier', 'name': 'email', 'range': [359, 359], 'children': []}]}, {'type': 'Property', 'name': 'access_token', 'range': [362, 364], 'children': [{'type': 'Identifier', 'name': 'token_data["access_token"]', 'range': [364, 366], 'children': []}]}, {'type': 'Property', 'name': 'refresh_token', 'range': [370, 372], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [372, 372], 'children': []}]}, {'type': 'Property', 'name': 'access_token_expires_at', 'range': [375, 377], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [377, 377], 'children': []}]}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'revoke_tokens', 'range': [383, 390], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [385, 387], 'children': [{'type': 'Parameter', 'name': 'credentials', 'range': [386, 386], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [388, 390], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [389, 390], 'children': [{'type': 'Literal', 'name': 'False', 'range': [390, 390], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': '_refresh_tokens', 'range': [393, 415], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [395, 401], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [396, 396], 'children': []}, {'type': 'Parameter', 'name': 'credentials', 'range': [398, 400], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [406, 415], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [414, 415], 'children': [{'type': 'Identifier', 'name': 'credentials', 'range': [415, 415], 'children': []}]}]}]}]}]}
2025-01-08 10:05:44,395 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:07:01,044 - INFO - Step 5 result: {'type': 'Program', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'ClassDecl', 'name': 'NotionOAuthHandler', 'range': [49, 417], 'children': [{'type': 'FunctionDecl', 'name': '__init__', 'range': [68, 116], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [70, 84], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [71, 71], 'children': []}, {'type': 'Parameter', 'name': 'client_id', 'range': [73, 75], 'children': []}, {'type': 'Parameter', 'name': 'client_secret', 'range': [77, 79], 'children': []}, {'type': 'Parameter', 'name': 'redirect_uri', 'range': [81, 83], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [86, 116], 'children': [{'type': 'Assignment', 'name': 'assignment', 'range': [87, 91], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [87, 89], 'children': []}, {'type': 'Identifier', 'name': 'client_id', 'range': [91, 91], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [93, 97], 'children': [{'type': 'Identifier', 'name': 'self.client_secret', 'range': [93, 95], 'children': []}, {'type': 'Identifier', 'name': 'client_secret', 'range': [97, 97], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [99, 103], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [99, 101], 'children': []}, {'type': 'Identifier', 'name': 'redirect_uri', 'range': [103, 103], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [105, 109], 'children': [{'type': 'Identifier', 'name': 'self.auth_base_url', 'range': [105, 107], 'children': []}, {'type': 'Literal', 'name': '"https://api.notion.com/v1/oauth/authorize"', 'range': [109, 109], 'children': []}]}, {'type': 'Assignment', 'name': 'assignment', 'range': [111, 115], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [111, 113], 'children': []}, {'type': 'Literal', 'name': '"https://api.notion.com/v1/oauth/token"', 'range': [115, 115], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'get_login_url', 'range': [118, 177], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [120, 133], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [121, 121], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [123, 125], 'children': []}, {'type': 'Parameter', 'name': 'state', 'range': [130, 132], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [138, 177], 'children': [{'type': 'VariableDecl', 'name': 'params', 'range': [139, 172], 'children': [{'type': 'ObjectLiteral', 'name': 'params', 'range': [141, 172], 'children': [{'type': 'Property', 'name': 'client_id', 'range': [143, 147], 'children': [{'type': 'Identifier', 'name': 'self.client_id', 'range': [145, 147], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [150, 154], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [152, 154], 'children': []}]}, {'type': 'Property', 'name': 'response_type', 'range': [157, 159], 'children': [{'type': 'Literal', 'name': '"code"', 'range': [159, 159], 'children': []}]}, {'type': 'Property', 'name': 'owner', 'range': [162, 164], 'children': [{'type': 'Literal', 'name': '"user"', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'state', 'range': [167, 169], 'children': [{'type': 'Identifier', 'name': 'state', 'range': [169, 169], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [174, 176], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.auth_base_url}?{urlencode(params)}"', 'range': [176, 176], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'exchange_code_for_tokens', 'range': [179, 334], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [181, 195], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [183, 183], 'children': []}, {'type': 'Parameter', 'name': 'code', 'range': [185, 187], 'children': []}, {'type': 'Parameter', 'name': 'scopes', 'range': [189, 191], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [201, 334], 'children': [{'type': 'VariableDecl', 'name': 'request_body', 'range': [202, 223], 'children': [{'type': 'ObjectLiteral', 'name': 'request_body', 'range': [204, 223], 'children': [{'type': 'Property', 'name': 'grant_type', 'range': [206, 208], 'children': [{'type': 'Literal', 'name': '"authorization_code"', 'range': [208, 208], 'children': []}]}, {'type': 'Property', 'name': 'code', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'code', 'range': [213, 213], 'children': []}]}, {'type': 'Property', 'name': 'redirect_uri', 'range': [216, 218], 'children': [{'type': 'Identifier', 'name': 'self.redirect_uri', 'range': [218, 218], 'children': []}]}]}]}, {'type': 'VariableDecl', 'name': 'auth_str', 'range': [225, 240], 'children': [{'type': 'CallExpression', 'name': 'b64encode', 'range': [227, 235], 'children': [{'type': 'TemplateLiteral', 'name': 'f"{self.client_id}:{self.client_secret}"', 'range': [230, 230], 'children': []}]}]}, {'type': 'VariableDecl', 'name': 'headers', 'range': [241, 256], 'children': [{'type': 'ObjectLiteral', 'name': 'headers', 'range': [243, 256], 'children': [{'type': 'Property', 'name': 'Authorization', 'range': [245, 247], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Basic {auth_str}"', 'range': [248, 248], 'children': []}]}, {'type': 'Property', 'name': 'Accept', 'range': [251, 253], 'children': [{'type': 'Literal', 'name': '"application/json"', 'range': [253, 253], 'children': []}]}]}]}, {'type': 'VariableDecl', 'name': 'response', 'range': [258, 275], 'children': [{'type': 'CallExpression', 'name': 'requests.post', 'range': [260, 275], 'children': [{'type': 'Identifier', 'name': 'self.token_url', 'range': [264, 266], 'children': []}, {'type': 'Identifier', 'name': 'request_body', 'range': [270, 270], 'children': []}, {'type': 'Identifier', 'name': 'headers', 'range': [274, 274], 'children': []}]}]}, {'type': 'VariableDecl', 'name': 'token_data', 'range': [277, 284], 'children': [{'type': 'CallExpression', 'name': 'response.json', 'range': [279, 284], 'children': []}]}, {'type': 'VariableDecl', 'name': 'email', 'range': [296, 332], 'children': [{'type': 'ConditionalExpression', 'name': 'conditional', 'range': [298, 332], 'children': [{'type': 'LogicalExpression', 'name': 'logical', 'range': [311, 329], 'children': [{'type': 'BinaryExpression', 'name': 'binary', 'range': [311, 318], 'children': [{'type': 'Literal', 'name': '"person"', 'range': [312, 312], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]', 'range': [314, 316], 'children': []}]}, {'type': 'BinaryExpression', 'name': 'binary', 'range': [319, 329], 'children': [{'type': 'Literal', 'name': '"email"', 'range': [320, 320], 'children': []}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]', 'range': [322, 328], 'children': []}]}]}, {'type': 'Identifier', 'name': 'token_data["owner"]["person"]["email"]', 'range': [300, 309], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [331, 331], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [336, 378], 'children': [{'type': 'NewExpression', 'name': 'OAuth2Credentials', 'range': [337, 378], 'children': [{'type': 'Property', 'name': 'provider', 'range': [340, 342], 'children': [{'type': 'Identifier', 'name': 'self.PROVIDER_NAME', 'range': [342, 344], 'children': []}]}, {'type': 'Property', 'name': 'title', 'range': [347, 349], 'children': [{'type': 'CallExpression', 'name': 'token_data.get', 'range': [349, 354], 'children': [{'type': 'Literal', 'name': '"workspace_name"', 'range': [353, 353], 'children': []}]}]}, {'type': 'Property', 'name': 'username', 'range': [357, 359], 'children': [{'type': 'Identifier', 'name': 'email', 'range': [359, 359], 'children': []}]}, {'type': 'Property', 'name': 'access_token', 'range': [362, 364], 'children': [{'type': 'Identifier', 'name': 'token_data["access_token"]', 'range': [364, 366], 'children': []}]}, {'type': 'Property', 'name': 'refresh_token', 'range': [370, 372], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [372, 372], 'children': []}]}, {'type': 'Property', 'name': 'access_token_expires_at', 'range': [375, 377], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [377, 377], 'children': []}]}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'revoke_tokens', 'range': [383, 390], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [385, 387], 'children': [{'type': 'Parameter', 'name': 'credentials', 'range': [386, 386], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [388, 390], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [389, 390], 'children': [{'type': 'Literal', 'name': 'False', 'range': [390, 390], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': '_refresh_tokens', 'range': [393, 415], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [395, 401], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [396, 396], 'children': []}, {'type': 'Parameter', 'name': 'credentials', 'range': [398, 400], 'children': []}]}, {'type': 'Block', 'name': 'body', 'range': [406, 415], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [414, 415], 'children': [{'type': 'Identifier', 'name': 'credentials', 'range': [415, 415], 'children': []}]}]}]}]}]}
2025-01-08 10:07:01,045 - INFO - Completed main AST analysis flow
2025-01-08 10:07:01,047 - INFO - Successfully processed chunk
2025-01-08 10:07:01,069 - INFO - Starting code generation from AST
2025-01-08 10:07:14,779 - INFO - Successfully generated code from AST
2025-01-08 10:07:14,780 - INFO - Starting static code similarity comparison
2025-01-08 10:07:14,789 - INFO - Static similarity result: {'final_score': 92.33, 'length_similarity': 91.28, 'token_similarity': 88.52, 'structure_similarity': 88.31, 'function_similarity': 100, 'complexity_similarity': 100.0, 'variable_similarity': 100}

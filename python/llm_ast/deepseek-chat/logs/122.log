2025-01-08 10:07:52,178 - INFO - Processing sample 122
2025-01-08 10:07:52,178 - INFO - Starting Step 0: Splitting code into top-level declarations
2025-01-08 10:19:16,806 - INFO - Successfully split code into 23 top-level declarations
2025-01-08 10:19:16,838 - INFO - Processing chunk #0 (size=675 chars, start_index=0)
2025-01-08 10:19:16,839 - INFO - Processing chunk with 675 chars starting at index 0
2025-01-08 10:19:16,839 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,839 - INFO - Tokenized code into 116 tokens
2025-01-08 10:19:16,839 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,841 - INFO - Processing chunk #1 (size=146 chars, start_index=116)
2025-01-08 10:19:16,841 - INFO - Processing chunk with 146 chars starting at index 116
2025-01-08 10:19:16,841 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,841 - INFO - Tokenized code into 27 tokens
2025-01-08 10:19:16,841 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,847 - INFO - Processing chunk #2 (size=156 chars, start_index=143)
2025-01-08 10:19:16,847 - INFO - Processing chunk with 156 chars starting at index 143
2025-01-08 10:19:16,847 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,847 - INFO - Tokenized code into 32 tokens
2025-01-08 10:19:16,847 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,849 - INFO - Processing chunk #3 (size=59 chars, start_index=175)
2025-01-08 10:19:16,849 - INFO - Processing chunk with 59 chars starting at index 175
2025-01-08 10:19:16,849 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,850 - INFO - Tokenized code into 14 tokens
2025-01-08 10:19:16,850 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,851 - INFO - Processing chunk #4 (size=435 chars, start_index=189)
2025-01-08 10:19:16,851 - INFO - Processing chunk with 435 chars starting at index 189
2025-01-08 10:19:16,851 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,852 - INFO - Tokenized code into 103 tokens
2025-01-08 10:19:16,852 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,854 - INFO - Processing chunk #5 (size=1090 chars, start_index=292)
2025-01-08 10:19:16,854 - INFO - Processing chunk with 1090 chars starting at index 292
2025-01-08 10:19:16,854 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,854 - INFO - Tokenized code into 188 tokens
2025-01-08 10:19:16,854 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,874 - INFO - Processing chunk #6 (size=1514 chars, start_index=480)
2025-01-08 10:19:16,874 - INFO - Processing chunk with 1514 chars starting at index 480
2025-01-08 10:19:16,875 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,875 - INFO - Tokenized code into 265 tokens
2025-01-08 10:19:16,875 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,882 - INFO - Processing chunk #7 (size=1389 chars, start_index=745)
2025-01-08 10:19:16,882 - INFO - Processing chunk with 1389 chars starting at index 745
2025-01-08 10:19:16,882 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,883 - INFO - Tokenized code into 206 tokens
2025-01-08 10:19:16,883 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,884 - INFO - Processing chunk #8 (size=2528 chars, start_index=951)
2025-01-08 10:19:16,885 - INFO - Processing chunk with 2528 chars starting at index 951
2025-01-08 10:19:16,885 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,885 - INFO - Tokenized code into 320 tokens
2025-01-08 10:19:16,885 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,887 - INFO - Processing chunk #9 (size=439 chars, start_index=1271)
2025-01-08 10:19:16,888 - INFO - Processing chunk with 439 chars starting at index 1271
2025-01-08 10:19:16,888 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,888 - INFO - Tokenized code into 69 tokens
2025-01-08 10:19:16,888 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,897 - INFO - Processing chunk #10 (size=294 chars, start_index=1340)
2025-01-08 10:19:16,898 - INFO - Processing chunk with 294 chars starting at index 1340
2025-01-08 10:19:16,898 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,898 - INFO - Tokenized code into 60 tokens
2025-01-08 10:19:16,898 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,899 - INFO - Processing chunk #11 (size=530 chars, start_index=1400)
2025-01-08 10:19:16,904 - INFO - Processing chunk with 530 chars starting at index 1400
2025-01-08 10:19:16,904 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,904 - INFO - Tokenized code into 110 tokens
2025-01-08 10:19:16,904 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,909 - INFO - Processing chunk #12 (size=214 chars, start_index=1510)
2025-01-08 10:19:16,910 - INFO - Processing chunk with 214 chars starting at index 1510
2025-01-08 10:19:16,910 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,910 - INFO - Tokenized code into 56 tokens
2025-01-08 10:19:16,910 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,920 - INFO - Processing chunk #13 (size=1202 chars, start_index=1566)
2025-01-08 10:19:16,920 - INFO - Processing chunk with 1202 chars starting at index 1566
2025-01-08 10:19:16,920 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,921 - INFO - Processing chunk #14 (size=480 chars, start_index=1846)
2025-01-08 10:19:16,926 - INFO - Processing chunk #15 (size=58 chars, start_index=1939)
2025-01-08 10:19:16,927 - INFO - Tokenized code into 280 tokens
2025-01-08 10:19:16,928 - INFO - Processing chunk #16 (size=965 chars, start_index=1952)
2025-01-08 10:19:16,928 - INFO - Processing chunk with 480 chars starting at index 1846
2025-01-08 10:19:16,929 - INFO - Processing chunk #17 (size=1627 chars, start_index=2163)
2025-01-08 10:19:16,929 - INFO - Processing chunk with 58 chars starting at index 1939
2025-01-08 10:19:16,930 - INFO - Processing chunk #18 (size=564 chars, start_index=2510)
2025-01-08 10:19:16,931 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,932 - INFO - Processing chunk #19 (size=456 chars, start_index=2615)
2025-01-08 10:19:16,932 - INFO - Processing chunk with 965 chars starting at index 1952
2025-01-08 10:19:16,933 - INFO - Processing chunk #20 (size=79 chars, start_index=2696)
2025-01-08 10:19:16,933 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,934 - INFO - Processing chunk #21 (size=552 chars, start_index=2752)
2025-01-08 10:19:16,935 - INFO - Processing chunk #22 (size=584 chars, start_index=2856)
2025-01-08 10:19:16,943 - INFO - Processing chunk with 584 chars starting at index 2856
2025-01-08 10:19:16,943 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,936 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,941 - INFO - Processing chunk with 456 chars starting at index 2615
2025-01-08 10:19:16,941 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,942 - INFO - Processing chunk with 79 chars starting at index 2696
2025-01-08 10:19:16,942 - INFO - Tokenized code into 93 tokens
2025-01-08 10:19:16,942 - INFO - Processing chunk with 552 chars starting at index 2752
2025-01-08 10:19:16,935 - INFO - Processing chunk with 1627 chars starting at index 2163
2025-01-08 10:19:16,946 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,943 - INFO - Tokenized code into 105 tokens
2025-01-08 10:19:16,943 - INFO - Tokenized code into 13 tokens
2025-01-08 10:19:16,947 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,944 - INFO - Tokenized code into 211 tokens
2025-01-08 10:19:16,945 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,945 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,945 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,936 - INFO - Processing chunk with 564 chars starting at index 2510
2025-01-08 10:19:16,953 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,946 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,944 - INFO - Starting main AST analysis flow
2025-01-08 10:19:16,948 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,952 - INFO - Tokenized code into 56 tokens
2025-01-08 10:19:16,953 - INFO - Tokenized code into 104 tokens
2025-01-08 10:19:16,946 - INFO - Tokenized code into 347 tokens
2025-01-08 10:19:16,968 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,955 - INFO - Tokenized code into 81 tokens
2025-01-08 10:19:16,970 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,968 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,954 - INFO - Tokenized code into 105 tokens
2025-01-08 10:19:16,968 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:16,980 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:19:20,281 - INFO - Step 1 result: {'type': 'Program', 'name': 'create_graph_execution', 'range': [745, 950], 'children': []}
2025-01-08 10:19:20,281 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,287 - INFO - Step 1 result: {'type': 'Program', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': []}
2025-01-08 10:19:20,287 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,302 - INFO - Step 1 result: {'type': 'Program', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': []}
2025-01-08 10:19:20,302 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,373 - INFO - Step 1 result: {'type': 'Program', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': []}
2025-01-08 10:19:20,373 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,378 - INFO - Step 1 result: {'type': 'Program', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': []}
2025-01-08 10:19:20,379 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,406 - INFO - Step 1 result: {'type': 'Program', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': []}
2025-01-08 10:19:20,406 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,421 - INFO - Step 1 result: {'type': 'Program', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': []}
2025-01-08 10:19:20,422 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,489 - INFO - Step 1 result: {'type': 'Program', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': []}
2025-01-08 10:19:20,489 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,502 - INFO - Step 1 result: {'type': 'Program', 'name': 'get_incomplete_executions', 'range': [2615, 2695], 'children': []}
2025-01-08 10:19:20,502 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,721 - INFO - Step 1 result: {'type': 'Program', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': []}
2025-01-08 10:19:20,721 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:20,726 - INFO - Step 1 result: {'type': 'Program', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': []}
2025-01-08 10:19:20,727 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:21,019 - INFO - Step 1 result: {'type': 'Program', 'name': 'from_db', 'range': [480, 744], 'children': []}
2025-01-08 10:19:21,019 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:21,562 - INFO - Step 1 result: {'type': 'Program', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': []}
2025-01-08 10:19:21,562 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:21,590 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [2696, 2751], 'children': [{'type': 'ConfigDeclaration', 'name': 'config', 'range': [2744, 2748], 'children': []}]}
2025-01-08 10:19:21,591 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:21,985 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [1939, 1951], 'children': [{'type': 'VariableDeclaration', 'name': 'LIST_SPLIT', 'range': [1939, 1942], 'children': []}, {'type': 'VariableDeclaration', 'name': 'DICT_SPLIT', 'range': [1943, 1946], 'children': []}, {'type': 'VariableDeclaration', 'name': 'OBJC_SPLIT', 'range': [1947, 1950], 'children': []}]}
2025-01-08 10:19:21,987 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:22,117 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [175, 188], 'children': [{'type': 'VariableDeclaration', 'name': 'ExecutionStatus', 'range': [175, 178], 'children': []}, {'type': 'VariableDeclaration', 'name': 'T', 'range': [180, 186], 'children': []}]}
2025-01-08 10:19:22,117 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:22,952 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [189, 291], 'children': [{'type': 'ClassDeclaration', 'name': 'ExecutionQueue', 'range': [189, 291], 'children': [{'type': 'MethodDeclaration', 'name': '__init__', 'range': [204, 222], 'children': []}, {'type': 'MethodDeclaration', 'name': 'add', 'range': [224, 249], 'children': []}, {'type': 'MethodDeclaration', 'name': 'get', 'range': [251, 269], 'children': []}, {'type': 'MethodDeclaration', 'name': 'empty', 'range': [271, 289], 'children': []}]}]}
2025-01-08 10:19:22,952 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:23,158 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [2752, 2855], 'children': [{'type': 'ClassDeclaration', 'name': 'RedisExecutionEventBus', 'range': [2752, 2765], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [2767, 2784], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'publish', 'range': [2786, 2806], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'listen', 'range': [2808, 2853], 'children': []}]}
2025-01-08 10:19:23,158 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:24,304 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [2856, 2960], 'children': [{'type': 'ClassDeclaration', 'name': 'AsyncRedisExecutionEventBus', 'range': [2856, 2865], 'children': []}, {'type': 'VariableDeclaration', 'name': 'Model', 'range': [2866, 2869], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [2871, 2888], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'publish', 'range': [2890, 2912], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'listen', 'range': [2914, 2959], 'children': []}]}
2025-01-08 10:19:24,305 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:24,550 - INFO - Step 1 result: {'type': 'Program', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'ClassDeclaration', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [118, 120], 'children': []}, {'type': 'Property', 'name': 'user_id', 'range': [123, 125], 'children': []}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [127, 129], 'children': []}, {'type': 'Property', 'name': 'graph_id', 'range': [131, 133], 'children': []}, {'type': 'Property', 'name': 'start_node_execs', 'range': [135, 140], 'children': []}]}]}
2025-01-08 10:19:24,550 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:25,088 - INFO - Step 1 result: {'type': 'Program', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'ClassDeclaration', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [145, 147], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [148, 174], 'children': [{'type': 'Property', 'name': 'user_id', 'range': [150, 152], 'children': []}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [154, 156], 'children': []}, {'type': 'Property', 'name': 'graph_id', 'range': [158, 160], 'children': []}, {'type': 'Property', 'name': 'node_exec_id', 'range': [162, 164], 'children': []}, {'type': 'Property', 'name': 'node_id', 'range': [166, 168], 'children': []}, {'type': 'Property', 'name': 'data', 'range': [170, 172], 'children': []}]}]}]}
2025-01-08 10:19:25,088 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:25,972 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [2696, 2751], 'children': [{'type': 'ConfigDeclaration', 'name': 'config', 'range': [2744, 2748], 'children': [{'type': 'Assignment', 'name': '=', 'range': [2745, 2745], 'children': []}, {'type': 'FunctionCall', 'name': 'Config', 'range': [2746, 2748], 'children': [{'type': 'Arguments', 'name': '', 'range': [2747, 2748], 'children': []}]}]}]}
2025-01-08 10:19:25,973 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:27,387 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [0, 115], 'children': [{'type': 'ImportDeclaration', 'name': 'defaultdict', 'range': [0, 4], 'children': []}, {'type': 'ImportDeclaration', 'name': 'datetime, timezone', 'range': [5, 11], 'children': []}, {'type': 'ImportDeclaration', 'name': 'Manager', 'range': [12, 16], 'children': []}, {'type': 'ImportDeclaration', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [17, 29], 'children': []}, {'type': 'ImportDeclaration', 'name': 'AgentExecutionStatus', 'range': [31, 37], 'children': []}, {'type': 'ImportDeclaration', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [38, 55], 'children': []}, {'type': 'ImportDeclaration', 'name': 'BaseModel', 'range': [56, 60], 'children': []}, {'type': 'ImportDeclaration', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [62, 74], 'children': []}, {'type': 'ImportDeclaration', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [75, 85], 'children': []}, {'type': 'ImportDeclaration', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [86, 96], 'children': []}, {'type': 'ImportDeclaration', 'name': 'json, mock', 'range': [97, 105], 'children': []}, {'type': 'ImportDeclaration', 'name': 'Config', 'range': [106, 114], 'children': []}]}
2025-01-08 10:19:27,387 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:27,973 - INFO - Step 2 result: {'nodes': [{'type': 'VariableDeclaration', 'name': 'ExecutionStatus', 'range': [175, 178], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [176, 177], 'children': [{'type': 'Identifier', 'name': 'AgentExecutionStatus', 'range': [177, 177], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'T', 'range': [180, 186], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [181, 182], 'children': [{'type': 'CallExpression', 'name': 'TypeVar', 'range': [182, 185], 'children': [{'type': 'Literal', 'name': '"T"', 'range': [184, 184], 'children': []}]}]}]}]}
2025-01-08 10:19:27,973 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:28,687 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [2696, 2751], 'children': [{'type': 'ConfigDeclaration', 'name': 'config', 'range': [2744, 2748], 'children': [{'type': 'FunctionCall', 'name': 'Config', 'range': [2746, 2748], 'children': []}]}]}
2025-01-08 10:19:28,687 - INFO - Starting Step 4: AST normalization
2025-01-08 10:19:28,892 - INFO - Step 1 result: {'type': 'Program', 'name': 'ExecutionResult', 'range': [292, 479], 'children': [{'type': 'ClassDeclaration', 'name': 'ExecutionResult', 'range': [292, 356], 'children': [{'type': 'PropertyDeclaration', 'name': 'graph_id', 'range': [299, 301], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'graph_version', 'range': [303, 305], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'graph_exec_id', 'range': [307, 309], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'node_exec_id', 'range': [311, 313], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'node_id', 'range': [315, 317], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'block_id', 'range': [319, 321], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'status', 'range': [323, 325], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'input_data', 'range': [327, 329], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'output_data', 'range': [331, 333], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'add_time', 'range': [335, 337], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'queue_time', 'range': [339, 343], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'start_time', 'range': [345, 349], 'children': []}, {'type': 'PropertyDeclaration', 'name': 'end_time', 'range': [351, 355], 'children': []}]}, {'type': 'MethodDeclaration', 'name': 'from_graph', 'range': [358, 478], 'children': []}]}
2025-01-08 10:19:28,893 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:19:29,815 - INFO - Step 2 result: {'nodes': [{'type': 'VariableDeclaration', 'name': 'LIST_SPLIT', 'range': [1939, 1942], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1940, 1941], 'children': [{'type': 'Literal', 'name': '"_$_"', 'range': [1941, 1941], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'DICT_SPLIT', 'range': [1943, 1946], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1944, 1945], 'children': [{'type': 'Literal', 'name': '"_#_"', 'range': [1945, 1945], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'OBJC_SPLIT', 'range': [1947, 1950], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1948, 1949], 'children': [{'type': 'Literal', 'name': '"_@_"', 'range': [1949, 1949], 'children': []}]}]}]}
2025-01-08 10:19:29,815 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:31,545 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [2696, 2751], 'children': [{'type': 'VariableDeclaration', 'name': 'config', 'range': [2744, 2748], 'children': [{'type': 'CallExpression', 'name': 'Config', 'range': [2746, 2748], 'children': []}]}]}
2025-01-08 10:19:31,545 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:19:32,968 - INFO - Step 2 result: {'type': 'Program', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'ClassDeclaration', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [118, 120], 'children': []}, {'type': 'Property', 'name': 'user_id', 'range': [123, 125], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [125, 125], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [127, 129], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [129, 129], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [131, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [133, 133], 'children': []}]}, {'type': 'Property', 'name': 'start_node_execs', 'range': [135, 140], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [137, 137], 'children': [{'type': 'GenericType', 'name': 'NodeExecutionEntry', 'range': [139, 139], 'children': []}]}]}]}]}
2025-01-08 10:19:32,969 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:33,629 - INFO - Step 3 result: {'nodes': [{'type': 'VariableDeclaration', 'name': 'ExecutionStatus', 'range': [175, 178], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [176, 177], 'children': [{'type': 'Identifier', 'name': 'AgentExecutionStatus', 'range': [177, 177], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'T', 'range': [180, 186], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [181, 182], 'children': [{'type': 'CallExpression', 'name': 'TypeVar', 'range': [182, 185], 'children': [{'type': 'Literal', 'name': '"T"', 'range': [184, 184], 'children': []}]}]}]}]}
2025-01-08 10:19:33,629 - INFO - Starting Step 4: AST normalization
2025-01-08 10:19:34,740 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [2696, 2751], 'children': [{'type': 'VariableDeclaration', 'name': 'config', 'range': [2744, 2748], 'children': [{'type': 'CallExpression', 'name': 'Config', 'range': [2746, 2748], 'children': []}]}]}
2025-01-08 10:19:34,740 - INFO - Completed main AST analysis flow
2025-01-08 10:19:34,740 - INFO - Successfully processed chunk
2025-01-08 10:19:35,694 - INFO - Step 2 result: {'type': 'Program', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'ClassDeclaration', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [145, 147], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [148, 174], 'children': [{'type': 'Property', 'name': 'user_id', 'range': [150, 152], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [152, 152], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [154, 156], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [156, 156], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [158, 160], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [160, 160], 'children': []}]}, {'type': 'Property', 'name': 'node_exec_id', 'range': [162, 164], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'node_id', 'range': [166, 168], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [168, 168], 'children': []}]}, {'type': 'Property', 'name': 'data', 'range': [170, 172], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [172, 172], 'children': []}]}]}]}]}
2025-01-08 10:19:35,694 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:37,599 - INFO - Step 2 result: {'type': 'Program', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1846, 1851], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1847, 1850], 'children': []}, {'type': 'FunctionName', 'name': 'get_execution_results', 'range': [1848, 1869], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1849, 1853], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1850, 1852], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1851, 1852], 'children': []}]}]}, {'type': 'ReturnType', 'name': '-> list[ExecutionResult]', 'range': [1854, 1859], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1860, 1938], 'children': [{'type': 'AssignmentExpression', 'name': 'executions = await AgentNodeExecution.prisma().find_many(...)', 'range': [1862, 1918], 'children': [{'type': 'VariableDeclarator', 'name': 'executions', 'range': [1862, 1871], 'children': []}, {'type': 'AwaitExpression', 'name': 'await AgentNodeExecution.prisma().find_many(...)', 'range': [1864, 1918], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many(...)', 'range': [1865, 1918], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1865, 1867], 'children': []}, {'type': 'CallExpression', 'name': 'find_many(...)', 'range': [1868, 1918], 'children': [{'type': 'ObjectExpression', 'name': 'where = {...}', 'range': [1874, 1880], 'children': []}, {'type': 'Identifier', 'name': 'include = EXECUTION_RESULT_INCLUDE', 'range': [1883, 1886], 'children': []}, {'type': 'ArrayExpression', 'name': 'order = [...]', 'range': [1888, 1915], 'children': []}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res = [...]', 'range': [1920, 1933], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1920, 1921], 'children': []}, {'type': 'ArrayExpression', 'name': '[...]', 'range': [1922, 1933], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db(execution)', 'range': [1923, 1928], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return res', 'range': [1935, 1936], 'children': []}]}]}]}
2025-01-08 10:19:37,599 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:37,639 - INFO - Step 3 result: {'nodes': [{'type': 'VariableDeclaration', 'name': 'LIST_SPLIT', 'range': [1939, 1942], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1940, 1941], 'children': [{'type': 'Literal', 'name': '"_$_"', 'range': [1941, 1941], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'DICT_SPLIT', 'range': [1943, 1946], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1944, 1945], 'children': [{'type': 'Literal', 'name': '"_#_"', 'range': [1945, 1945], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'OBJC_SPLIT', 'range': [1947, 1950], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1948, 1949], 'children': [{'type': 'Literal', 'name': '"_@_"', 'range': [1949, 1949], 'children': []}]}]}]}
2025-01-08 10:19:37,639 - INFO - Starting Step 4: AST normalization
2025-01-08 10:19:39,351 - INFO - Step 2 result: {'type': 'Program', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'FunctionDeclaration', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [951, 955], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [952, 955], 'children': []}, {'type': 'FunctionName', 'name': 'upsert_execution_input', 'range': [953, 974], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [954, 985], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [956, 958], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [961, 963], 'children': []}, {'type': 'Parameter', 'name': 'input_name', 'range': [966, 968], 'children': []}, {'type': 'Parameter', 'name': 'input_data', 'range': [971, 973], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [976, 982], 'children': []}]}, {'type': 'ReturnType', 'name': 'tuple[str, BlockInput]', 'range': [986, 993], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [994, 1270], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [996, 998], 'children': []}, {'type': 'VariableDeclaration', 'name': 'existing_execution', 'range': [1000, 1092], 'children': []}, {'type': 'VariableDeclaration', 'name': 'json_input_data', 'range': [1093, 1101], 'children': []}, {'type': 'IfStatement', 'name': 'if existing_execution', 'range': [1103, 1185], 'children': [{'type': 'Block', 'name': 'if_block', 'range': [1106, 1185], 'children': [{'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create', 'range': [1107, 1140], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1142, 1185], 'children': []}]}]}, {'type': 'ElifStatement', 'name': 'elif not node_exec_id', 'range': [1187, 1256], 'children': [{'type': 'Block', 'name': 'elif_block', 'range': [1191, 1256], 'children': [{'type': 'VariableDeclaration', 'name': 'result', 'range': [1192, 1245], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1246, 1256], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [1258, 1269], 'children': [{'type': 'Block', 'name': 'else_block', 'range': [1260, 1269], 'children': [{'type': 'RaiseStatement', 'name': 'raise ValueError', 'range': [1261, 1268], 'children': []}]}]}]}]}]}
2025-01-08 10:19:39,351 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:39,856 - INFO - Step 4 result: {'nodes': [{'type': 'VariableDeclaration', 'name': 'ExecutionStatus', 'range': [175, 178], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [176, 177], 'children': [{'type': 'Identifier', 'name': 'AgentExecutionStatus', 'range': [177, 177], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'T', 'range': [180, 186], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [181, 182], 'children': [{'type': 'CallExpression', 'name': 'TypeVar', 'range': [182, 185], 'children': [{'type': 'Literal', 'name': '"T"', 'range': [184, 184], 'children': []}]}]}]}]}
2025-01-08 10:19:39,856 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:19:40,306 - INFO - Step 2 result: {'type': 'Program', 'name': 'get_incomplete_executions', 'range': [2615, 2695], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_incomplete_executions', 'range': [2615, 2693], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [2615, 2619], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [2616, 2619], 'children': []}, {'type': 'Identifier', 'name': 'get_incomplete_executions', 'range': [2617, 2641], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [2618, 2628], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2620, 2623], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2621, 2623], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2624, 2627], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2625, 2627], 'children': []}]}]}, {'type': 'ReturnType', 'name': '', 'range': [2629, 2635], 'children': [{'type': 'TypeAnnotation', 'name': 'list[ExecutionResult]', 'range': [2631, 2635], 'children': []}]}, {'type': 'Block', 'name': '', 'range': [2636, 2693], 'children': [{'type': 'VariableDeclaration', 'name': 'executions', 'range': [2637, 2678], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [2639, 2644], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many', 'range': [2640, 2678], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2649, 2670], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2653, 2656], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2655, 2656], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2658, 2661], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2660, 2661], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2663, 2668], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2665, 2668], 'children': []}]}]}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2675, 2676], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': '', 'range': [2680, 2693], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [2681, 2692], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2682, 2687], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2686, 2687], 'children': []}]}]}]}]}]}]}
2025-01-08 10:19:40,306 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:40,684 - INFO - Step 2 result: {'type': 'Program', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1400, 1404], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1401, 1404], 'children': []}, {'type': 'FunctionName', 'name': 'update_graph_execution_stats', 'range': [1402, 1423], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1403, 1420], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1405, 1407], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1407, 1410], 'children': []}, {'type': 'Parameter', 'name': 'stats', 'range': [1410, 1412], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any]', 'range': [1412, 1418], 'children': []}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1421, 1425], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1425, 1509], 'children': [{'type': 'Assignment', 'name': 'status', 'range': [1426, 1441], 'children': [{'type': 'Variable', 'name': 'status', 'range': [1426, 1431], 'children': []}, {'type': 'ConditionalExpression', 'name': 'if-else', 'range': [1431, 1441], 'children': [{'type': 'Condition', 'name': 'stats.get("error")', 'range': [1431, 1437], 'children': []}, {'type': 'TrueBranch', 'name': 'ExecutionStatus.FAILED', 'range': [1438, 1441], 'children': []}, {'type': 'FalseBranch', 'name': 'ExecutionStatus.COMPLETED', 'range': [1441, 1441], 'children': []}]}]}, {'type': 'AwaitExpression', 'name': 'await AgentGraphExecution.prisma().update', 'range': [1445, 1486], 'children': [{'type': 'CallExpression', 'name': 'AgentGraphExecution.prisma', 'range': [1446, 1450], 'children': []}, {'type': 'CallExpression', 'name': 'update', 'range': [1452, 1486], 'children': [{'type': 'Argument', 'name': 'where', 'range': [1455, 1461], 'children': []}, {'type': 'Argument', 'name': 'data', 'range': [1464, 1483], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if not res', 'range': [1488, 1498], 'children': [{'type': 'Condition', 'name': 'not res', 'range': [1488, 1491], 'children': []}, {'type': 'ThenBranch', 'name': 'raise ValueError', 'range': [1492, 1498], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_graph(res)', 'range': [1501, 1508], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_graph', 'range': [1502, 1507], 'children': []}]}]}]}]}
2025-01-08 10:19:40,684 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:41,549 - INFO - Step 3 result: {'type': 'Program', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'ClassDeclaration', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [118, 120], 'children': []}, {'type': 'Property', 'name': 'user_id', 'range': [123, 125], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [125, 125], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [127, 129], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [129, 129], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [131, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [133, 133], 'children': []}]}, {'type': 'Property', 'name': 'start_node_execs', 'range': [135, 140], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [137, 137], 'children': [{'type': 'GenericType', 'name': 'NodeExecutionEntry', 'range': [139, 139], 'children': []}]}]}]}]}
2025-01-08 10:19:41,549 - INFO - Starting Step 4: AST normalization
2025-01-08 10:19:43,800 - INFO - Step 2 result: {'type': 'Program', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'FunctionDeclaration', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [1954, 1962], 'children': [{'type': 'Parameter', 'name': 'output', 'range': [1955, 1957], 'children': []}, {'type': 'Parameter', 'name': 'name', 'range': [1959, 1961], 'children': []}]}, {'type': 'ReturnType', 'name': 'returnType', 'range': [1963, 1967], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1969, 2161], 'children': [{'type': 'Comment', 'name': 'comment', 'range': [1970, 1979], 'children': []}, {'type': 'VariableDeclaration', 'name': 'output_name, output_data', 'range': [1980, 1985], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [1987, 1996], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1988, 1991], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1994, 1995], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1998, 2060], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1999, 2005], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2008, 2021], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2023, 2043], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2024, 2038], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2041, 2042], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2044, 2059], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2062, 2107], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2063, 2069], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2072, 2083], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2084, 2101], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2085, 2096], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2099, 2100], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2102, 2106], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2109, 2157], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2110, 2116], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2119, 2130], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2131, 2154], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2132, 2144], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2147, 2153], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2155, 2156], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2159, 2160], 'children': []}]}]}]}
2025-01-08 10:19:43,800 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:44,914 - INFO - Step 4 result: {'nodes': [{'type': 'VariableDeclaration', 'name': 'LIST_SPLIT', 'range': [1939, 1942], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1940, 1941], 'children': [{'type': 'Literal', 'name': '"_$_"', 'range': [1941, 1941], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'DICT_SPLIT', 'range': [1943, 1946], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1944, 1945], 'children': [{'type': 'Literal', 'name': '"_#_"', 'range': [1945, 1945], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'OBJC_SPLIT', 'range': [1947, 1950], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1948, 1949], 'children': [{'type': 'Literal', 'name': '"_@_"', 'range': [1949, 1949], 'children': []}]}]}]}
2025-01-08 10:19:44,914 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:19:45,068 - INFO - Step 2 result: {'nodes': [{'type': 'ClassDeclaration', 'name': 'AsyncRedisExecutionEventBus', 'range': [2856, 2865], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus[ExecutionResult]', 'range': [2858, 2863], 'children': []}]}, {'type': 'VariableDeclaration', 'name': 'Model', 'range': [2866, 2869], 'children': [{'type': 'Assignment', 'name': '=', 'range': [2867, 2868], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [2868, 2868], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [2871, 2888], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2871, 2872], 'children': []}, {'type': 'Parameter', 'name': 'self', 'range': [2877, 2877], 'children': []}, {'type': 'ReturnType', 'name': '-> str', 'range': [2879, 2881], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2884, 2887], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2885, 2887], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'publish', 'range': [2890, 2912], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2894, 2894], 'children': []}, {'type': 'Parameter', 'name': 'res: ExecutionResult', 'range': [2896, 2898], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [2902, 2911], 'children': [{'type': 'MemberExpression', 'name': 'self.publish_event', 'range': [2903, 2905], 'children': []}, {'type': 'Argument', 'name': 'res', 'range': [2907, 2907], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2909, 2910], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'listen', 'range': [2914, 2959], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2919, 2919], 'children': []}, {'type': 'Parameter', 'name': 'graph_id: str = "*"', 'range': [2921, 2925], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id: str = "*"', 'range': [2927, 2931], 'children': []}, {'type': 'ReturnType', 'name': '-> AsyncGenerator[ExecutionResult, None]', 'range': [2934, 2941], 'children': []}, {'type': 'AsyncForStatement', 'name': 'async for', 'range': [2944, 2958], 'children': [{'type': 'VariableDeclaration', 'name': 'execution_result', 'range': [2946, 2946], 'children': []}, {'type': 'MemberExpression', 'name': 'self.listen_events', 'range': [2948, 2950], 'children': []}, {'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2952, 2953], 'children': []}, {'type': 'YieldStatement', 'name': 'yield', 'range': [2957, 2958], 'children': []}]}]}]}
2025-01-08 10:19:45,069 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:45,526 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [189, 291], 'children': [{'type': 'ClassDeclaration', 'name': 'ExecutionQueue', 'range': [189, 291], 'children': [{'type': 'MethodDeclaration', 'name': '__init__', 'range': [204, 222], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [211, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [211, 211], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [213, 213], 'children': []}]}, {'type': 'CallExpression', 'name': '(', 'range': [215, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [215, 219], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [215, 217], 'children': [{'type': 'Identifier', 'name': 'Manager', 'range': [215, 215], 'children': []}]}, {'type': 'Identifier', 'name': 'Queue', 'range': [219, 219], 'children': []}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'add', 'range': [224, 249], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [238, 245], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [238, 242], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [238, 238], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [240, 240], 'children': []}, {'type': 'Identifier', 'name': 'put', 'range': [242, 242], 'children': []}]}, {'type': 'Identifier', 'name': 'execution', 'range': [244, 244], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [247, 248], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [248, 248], 'children': []}]}]}, {'type': 'MethodDeclaration', 'name': 'get', 'range': [251, 269], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [261, 268], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [262, 268], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [262, 266], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [262, 262], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [264, 264], 'children': []}, {'type': 'Identifier', 'name': 'get', 'range': [266, 266], 'children': []}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'empty', 'range': [271, 289], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [281, 288], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [282, 288], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [282, 286], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [282, 282], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [284, 284], 'children': []}, {'type': 'Identifier', 'name': 'empty', 'range': [286, 286], 'children': []}]}]}]}]}]}]}
2025-01-08 10:19:45,526 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:45,981 - INFO - Step 2 result: {'type': 'Program', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'FunctionDeclaration', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'Decorator', 'name': '@staticmethod', 'range': [480, 481], 'children': []}, {'type': 'FunctionSignature', 'name': 'from_db', 'range': [483, 490], 'children': [{'type': 'Parameter', 'name': 'execution', 'range': [486, 488], 'children': []}]}, {'type': 'FunctionBody', 'name': 'from_db', 'range': [491, 744], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [492, 531], 'children': [{'type': 'Condition', 'name': 'execution.executionData', 'range': [493, 495], 'children': []}, {'type': 'ThenBlock', 'name': 'then', 'range': [496, 531], 'children': [{'type': 'Comment', 'name': '# Execution that has been queued for execution will persist its data.', 'range': [498, 510], 'children': []}, {'type': 'Assignment', 'name': 'input_data = json.loads(execution.executionData, target_type=dict[str, Any])', 'range': [512, 530], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [532, 582], 'children': [{'type': 'Comment', 'name': '# For incomplete execution, executionData will not be yet available.', 'range': [535, 546], 'children': []}, {'type': 'Assignment', 'name': 'input_data: BlockInput = defaultdict()', 'range': [548, 554], 'children': []}, {'type': 'ForLoop', 'name': 'for data in execution.Input or []:', 'range': [556, 582], 'children': [{'type': 'Assignment', 'name': 'input_data[data.name] = json.loads(data.data)', 'range': [567, 581], 'children': []}]}]}, {'type': 'Assignment', 'name': 'output_data: CompletedBlockOutput = defaultdict(list)', 'range': [584, 591], 'children': []}, {'type': 'ForLoop', 'name': 'for data in execution.Output or []:', 'range': [593, 622], 'children': [{'type': 'Assignment', 'name': 'output_data[data.name].append(json.loads(data.data))', 'range': [604, 621], 'children': []}]}, {'type': 'Assignment', 'name': 'graph_execution: AgentGraphExecution | None = execution.AgentGraphExecution', 'range': [624, 633], 'children': []}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult', 'range': [635, 742], 'children': [{'type': 'Argument', 'name': 'graph_id = graph_execution.agentGraphId if graph_execution else ""', 'range': [639, 647], 'children': []}, {'type': 'Argument', 'name': 'graph_version = graph_execution.agentGraphVersion if graph_execution else 0', 'range': [650, 658], 'children': []}, {'type': 'Argument', 'name': 'graph_exec_id = execution.agentGraphExecutionId', 'range': [661, 666], 'children': []}, {'type': 'Argument', 'name': 'block_id = execution.AgentNode.agentBlockId if execution.AgentNode else ""', 'range': [669, 680], 'children': []}, {'type': 'Argument', 'name': 'node_exec_id = execution.id', 'range': [683, 688], 'children': []}, {'type': 'Argument', 'name': 'node_id = execution.agentNodeId', 'range': [690, 695], 'children': []}, {'type': 'Argument', 'name': 'status = execution.executionStatus', 'range': [697, 702], 'children': []}, {'type': 'Argument', 'name': 'input_data = input_data', 'range': [704, 707], 'children': []}, {'type': 'Argument', 'name': 'output_data = output_data', 'range': [709, 712], 'children': []}, {'type': 'Argument', 'name': 'add_time = execution.addedTime', 'range': [714, 719], 'children': []}, {'type': 'Argument', 'name': 'queue_time = execution.queuedTime', 'range': [721, 726], 'children': []}, {'type': 'Argument', 'name': 'start_time = execution.startedTime', 'range': [728, 733], 'children': []}, {'type': 'Argument', 'name': 'end_time = execution.endedTime', 'range': [735, 740], 'children': []}]}]}]}]}
2025-01-08 10:19:45,981 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:46,095 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'MainOrSomething', 'range': [175, 186], 'children': [{'type': 'VariableDeclaration', 'name': 'ExecutionStatus', 'range': [175, 178], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [176, 177], 'children': [{'type': 'Identifier', 'name': 'AgentExecutionStatus', 'range': [177, 177], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'T', 'range': [180, 186], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [181, 182], 'children': [{'type': 'CallExpression', 'name': 'TypeVar', 'range': [182, 185], 'children': [{'type': 'Literal', 'name': '"T"', 'range': [184, 184], 'children': []}]}]}]}]}]}
2025-01-08 10:19:46,095 - INFO - Completed main AST analysis flow
2025-01-08 10:19:46,095 - INFO - Successfully processed chunk
2025-01-08 10:19:46,580 - INFO - Step 3 result: {'type': 'Program', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'ClassDeclaration', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [145, 147], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [148, 174], 'children': [{'type': 'Property', 'name': 'user_id', 'range': [150, 152], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [152, 152], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [154, 156], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [156, 156], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [158, 160], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [160, 160], 'children': []}]}, {'type': 'Property', 'name': 'node_exec_id', 'range': [162, 164], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'node_id', 'range': [166, 168], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [168, 168], 'children': []}]}, {'type': 'Property', 'name': 'data', 'range': [170, 172], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [172, 172], 'children': []}]}]}]}]}
2025-01-08 10:19:46,580 - INFO - Starting Step 4: AST normalization
2025-01-08 10:19:50,100 - INFO - Step 4 result: {'type': 'Program', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'ClassDecl', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [118, 120], 'children': []}, {'type': 'Property', 'name': 'user_id', 'range': [123, 125], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [125, 125], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [127, 129], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [129, 129], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [131, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [133, 133], 'children': []}]}, {'type': 'Property', 'name': 'start_node_execs', 'range': [135, 140], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [137, 137], 'children': [{'type': 'GenericType', 'name': 'NodeExecutionEntry', 'range': [139, 139], 'children': []}]}]}]}]}
2025-01-08 10:19:50,101 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:19:51,418 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [2752, 2855], 'children': [{'type': 'ClassDeclaration', 'name': 'RedisExecutionEventBus', 'range': [2752, 2765], 'children': [{'type': 'Inheritance', 'name': 'RedisEventBus[ExecutionResult]', 'range': [2754, 2759], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [2760, 2765], 'children': [{'type': 'FieldDeclaration', 'name': 'Model', 'range': [2762, 2764], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [2767, 2784], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2767, 2768], 'children': []}, {'type': 'FunctionSignature', 'name': '', 'range': [2770, 2778], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2773, 2774], 'children': []}, {'type': 'ReturnType', 'name': 'str', 'range': [2775, 2777], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2779, 2784], 'children': [{'type': 'ReturnStatement', 'name': '', 'range': [2780, 2784], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2781, 2783], 'children': []}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'publish', 'range': [2786, 2806], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2788, 2795], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2789, 2790], 'children': []}, {'type': 'Parameter', 'name': 'res', 'range': [2791, 2794], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [2792, 2794], 'children': []}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [2796, 2806], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [2797, 2806], 'children': [{'type': 'CallExpression', 'name': 'self.publish_event', 'range': [2797, 2805], 'children': [{'type': 'Argument', 'name': 'res', 'range': [2801, 2802], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2803, 2805], 'children': []}]}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'listen', 'range': [2808, 2853], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2810, 2837], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2812, 2813], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [2814, 2818], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2815, 2817], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2817, 2818], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [2820, 2824], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2821, 2823], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2823, 2824], 'children': []}]}, {'type': 'ReturnType', 'name': 'Generator[ExecutionResult, None, None]', 'range': [2827, 2836], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2838, 2853], 'children': [{'type': 'ForStatement', 'name': '', 'range': [2839, 2853], 'children': [{'type': 'VariableDeclaration', 'name': 'execution_result', 'range': [2840, 2841], 'children': []}, {'type': 'CallExpression', 'name': 'self.listen_events', 'range': [2842, 2848], 'children': [{'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2846, 2848], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2849, 2853], 'children': [{'type': 'YieldStatement', 'name': '', 'range': [2851, 2853], 'children': [{'type': 'Identifier', 'name': 'execution_result', 'range': [2852, 2853], 'children': []}]}]}]}]}]}]}
2025-01-08 10:19:51,419 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:52,181 - INFO - Step 2 result: {'type': 'Program', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1340, 1344], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1341, 1344], 'children': []}, {'type': 'Identifier', 'name': 'update_graph_execution_start_time', 'range': [1342, 1371], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1344, 1365], 'children': [{'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1344, 1356], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1346, 1349], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [1349, 1399], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [1350, 1398], 'children': [{'type': 'AwaitExpression', 'name': '', 'range': [1350, 1397], 'children': [{'type': 'CallExpression', 'name': '', 'range': [1351, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1351, 1357], 'children': [{'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [1351, 1369], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [1353, 1359], 'children': []}]}, {'type': 'CallExpression', 'name': '', 'range': [1357, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1357, 1363], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1357, 1363], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1363, 1394], 'children': [{'type': 'Property', 'name': 'where', 'range': [1360, 1366], 'children': [{'type': 'Identifier', 'name': 'where', 'range': [1360, 1364], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1362, 1366], 'children': [{'type': 'Property', 'name': 'id', 'range': [1363, 1365], 'children': [{'type': 'Literal', 'name': 'id', 'range': [1363, 1365], 'children': []}, {'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1365, 1377], 'children': []}]}]}]}, {'type': 'Property', 'name': 'data', 'range': [1369, 1394], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1369, 1373], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1371, 1394], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1373, 1378], 'children': [{'type': 'Literal', 'name': 'executionStatus', 'range': [1373, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1375, 1377], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1375, 1389], 'children': []}, {'type': 'Identifier', 'name': 'RUNNING', 'range': [1377, 1384], 'children': []}]}]}, {'type': 'Property', 'name': 'startedAt', 'range': [1380, 1392], 'children': [{'type': 'Literal', 'name': 'startedAt', 'range': [1380, 1389], 'children': []}, {'type': 'CallExpression', 'name': '', 'range': [1382, 1391], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1382, 1388], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1382, 1390], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1384, 1387], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1388, 1391], 'children': [{'type': 'Property', 'name': 'tz', 'range': [1387, 1390], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1387, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1389, 1390], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1389, 1397], 'children': []}, {'type': 'Identifier', 'name': 'utc', 'range': [1390, 1393], 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
2025-01-08 10:19:52,181 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:53,168 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'MainProgram', 'range': [1939, 1950], 'children': [{'type': 'VariableDeclaration', 'name': 'LIST_SPLIT', 'range': [1939, 1942], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1940, 1941], 'children': [{'type': 'Literal', 'name': '"_$_"', 'range': [1941, 1941], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'DICT_SPLIT', 'range': [1943, 1946], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1944, 1945], 'children': [{'type': 'Literal', 'name': '"_#_"', 'range': [1945, 1945], 'children': []}]}]}, {'type': 'VariableDeclaration', 'name': 'OBJC_SPLIT', 'range': [1947, 1950], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1948, 1949], 'children': [{'type': 'Literal', 'name': '"_@_"', 'range': [1949, 1949], 'children': []}]}]}]}]}
2025-01-08 10:19:53,168 - INFO - Completed main AST analysis flow
2025-01-08 10:19:53,168 - INFO - Successfully processed chunk
2025-01-08 10:19:53,329 - INFO - Step 2 result: {'nodes': [{'type': 'ImportDeclaration', 'name': 'defaultdict', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'collections', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'defaultdict', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'datetime, timezone', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'datetime', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'datetime, timezone', 'range': [7, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Manager', 'range': [12, 16], 'children': [{'type': 'FromImport', 'name': 'multiprocessing', 'range': [12, 13], 'children': []}, {'type': 'Import', 'name': 'Manager', 'range': [14, 15], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [17, 29], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [17, 18], 'children': []}, {'type': 'Import', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [19, 28], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentExecutionStatus', 'range': [31, 37], 'children': [{'type': 'FromImport', 'name': 'prisma.enums', 'range': [31, 34], 'children': []}, {'type': 'Import', 'name': 'AgentExecutionStatus', 'range': [35, 36], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [38, 55], 'children': [{'type': 'FromImport', 'name': 'prisma.models', 'range': [38, 41], 'children': []}, {'type': 'Import', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [42, 54], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseModel', 'range': [56, 60], 'children': [{'type': 'FromImport', 'name': 'pydantic', 'range': [56, 57], 'children': []}, {'type': 'Import', 'name': 'BaseModel', 'range': [58, 59], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [62, 74], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [62, 67], 'children': []}, {'type': 'Import', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [68, 73], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [75, 85], 'children': [{'type': 'FromImport', 'name': 'backend.data.includes', 'range': [75, 80], 'children': []}, {'type': 'Import', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [81, 84], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [86, 96], 'children': [{'type': 'FromImport', 'name': 'backend.data.queue', 'range': [86, 91], 'children': []}, {'type': 'Import', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [92, 95], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'json, mock', 'range': [97, 105], 'children': [{'type': 'FromImport', 'name': 'backend.util', 'range': [97, 100], 'children': []}, {'type': 'Import', 'name': 'json, mock', 'range': [101, 104], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Config', 'range': [106, 114], 'children': [{'type': 'FromImport', 'name': 'backend.util.settings', 'range': [106, 111], 'children': []}, {'type': 'Import', 'name': 'Config', 'range': [112, 113], 'children': []}]}]}
2025-01-08 10:19:53,329 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:53,848 - INFO - Step 2 result: {'type': 'Program', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [2510, 2514], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [2511, 2514], 'children': []}, {'type': 'FunctionName', 'name': 'get_latest_execution', 'range': [2512, 2532], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [2513, 2521], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2514, 2517], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2516, 2519], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2518, 2521], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2520, 2523], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult | None', 'range': [2522, 2527], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [2528, 2613], 'children': [{'type': 'VariableDeclaration', 'name': 'execution', 'range': [2529, 2536], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [2531, 2536], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [2532, 2536], 'children': []}]}]}, {'type': 'MethodCall', 'name': 'find_first', 'range': [2538, 2596], 'children': [{'type': 'Argument', 'name': 'where', 'range': [2541, 2579], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2543, 2579], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2545, 2548], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2547, 2550], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2550, 2553], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2552, 2555], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2555, 2564], 'children': [{'type': 'ObjectExpression', 'name': 'executionStatus', 'range': [2557, 2563], 'children': [{'type': 'Property', 'name': 'not', 'range': [2558, 2561], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2560, 2563], 'children': []}]}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [2566, 2573], 'children': [{'type': 'ObjectExpression', 'name': 'executionData', 'range': [2568, 2572], 'children': [{'type': 'Property', 'name': 'not', 'range': [2569, 2572], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2571, 2574], 'children': []}]}]}]}]}]}, {'type': 'Argument', 'name': 'order', 'range': [2582, 2589], 'children': [{'type': 'ObjectExpression', 'name': 'order', 'range': [2584, 2588], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [2585, 2588], 'children': [{'type': 'StringLiteral', 'name': 'desc', 'range': [2587, 2590], 'children': []}]}]}]}, {'type': 'Argument', 'name': 'include', 'range': [2591, 2595], 'children': [{'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2593, 2596], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2598, 2605], 'children': [{'type': 'Condition', 'name': 'not execution', 'range': [2599, 2601], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [2599, 2602], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2600, 2603], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'block', 'range': [2602, 2605], 'children': [{'type': 'ReturnStatement', 'name': 'return None', 'range': [2603, 2605], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2604, 2607], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_db(execution)', 'range': [2606, 2613], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': []}, {'type': 'Argument', 'name': 'execution', 'range': [2611, 2613], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2611, 2614], 'children': []}]}]}]}]}]}]}
2025-01-08 10:19:53,848 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:54,779 - INFO - Step 2 result: {'type': 'Program', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1510, 1514], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1511, 1514], 'children': []}, {'type': 'Identifier', 'name': 'update_node_execution_stats', 'range': [1512, 1540], 'children': []}, {'type': 'Punctuator', 'name': '(', 'range': [1513, 1514], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1514, 1526], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1514, 1526], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [1515, 1516], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1516, 1519], 'children': []}]}, {'type': 'Punctuator', 'name': ',', 'range': [1517, 1518], 'children': []}, {'type': 'Parameter', 'name': 'stats', 'range': [1518, 1526], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1518, 1523], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [1519, 1520], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict', 'range': [1520, 1526], 'children': [{'type': 'Punctuator', 'name': '[', 'range': [1521, 1522], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1522, 1525], 'children': []}, {'type': 'Punctuator', 'name': ',', 'range': [1523, 1524], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1524, 1527], 'children': []}, {'type': 'Punctuator', 'name': ']', 'range': [1525, 1526], 'children': []}]}]}, {'type': 'Punctuator', 'name': ')', 'range': [1526, 1527], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [1527, 1528], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [1528, 1565], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1529, 1534], 'children': []}, {'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1530, 1537], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1530, 1547], 'children': []}, {'type': 'Punctuator', 'name': '.', 'range': [1531, 1532], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [1532, 1538], 'children': []}]}, {'type': 'CallExpression', 'name': 'update', 'range': [1536, 1562], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1536, 1542], 'children': []}, {'type': 'Punctuator', 'name': '(', 'range': [1537, 1538], 'children': []}, {'type': 'ObjectExpression', 'name': 'where', 'range': [1539, 1545], 'children': [{'type': 'Property', 'name': 'id', 'range': [1542, 1545], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [1542, 1545], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [1543, 1544], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1544, 1556], 'children': []}]}]}, {'type': 'Punctuator', 'name': ',', 'range': [1546, 1547], 'children': []}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1548, 1559], 'children': [{'type': 'Property', 'name': 'stats', 'range': [1551, 1559], 'children': [{'type': 'Literal', 'name': '"stats"', 'range': [1551, 1557], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [1552, 1553], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1553, 1557], 'children': []}, {'type': 'Punctuator', 'name': '.', 'range': [1554, 1555], 'children': []}, {'type': 'Identifier', 'name': 'dumps', 'range': [1555, 1560], 'children': []}]}, {'type': 'Punctuator', 'name': '(', 'range': [1556, 1557], 'children': []}, {'type': 'Identifier', 'name': 'stats', 'range': [1557, 1562], 'children': []}, {'type': 'Punctuator', 'name': ')', 'range': [1558, 1559], 'children': []}]}]}]}, {'type': 'Punctuator', 'name': ',', 'range': [1560, 1561], 'children': []}, {'type': 'Punctuator', 'name': ')', 'range': [1562, 1563], 'children': []}]}]}]}]}
2025-01-08 10:19:54,779 - INFO - Starting Step 3: AST simplification
2025-01-08 10:19:55,775 - INFO - Step 3 result: {'type': 'Program', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1846, 1851], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1847, 1850], 'children': []}, {'type': 'FunctionName', 'name': 'get_execution_results', 'range': [1848, 1869], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1849, 1853], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1850, 1852], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1851, 1852], 'children': []}]}]}, {'type': 'ReturnType', 'name': '-> list[ExecutionResult]', 'range': [1854, 1859], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1860, 1938], 'children': [{'type': 'AssignmentExpression', 'name': 'executions = await AgentNodeExecution.prisma().find_many(...)', 'range': [1862, 1918], 'children': [{'type': 'VariableDeclarator', 'name': 'executions', 'range': [1862, 1871], 'children': []}, {'type': 'AwaitExpression', 'name': 'await AgentNodeExecution.prisma().find_many(...)', 'range': [1864, 1918], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many(...)', 'range': [1865, 1918], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1865, 1867], 'children': []}, {'type': 'CallExpression', 'name': 'find_many(...)', 'range': [1868, 1918], 'children': [{'type': 'ObjectExpression', 'name': 'where = {...}', 'range': [1874, 1880], 'children': []}, {'type': 'Identifier', 'name': 'include = EXECUTION_RESULT_INCLUDE', 'range': [1883, 1886], 'children': []}, {'type': 'ArrayExpression', 'name': 'order = [...]', 'range': [1888, 1915], 'children': []}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res = [...]', 'range': [1920, 1933], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1920, 1921], 'children': []}, {'type': 'ArrayExpression', 'name': '[...]', 'range': [1922, 1933], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db(execution)', 'range': [1923, 1928], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return res', 'range': [1935, 1936], 'children': []}]}]}]}
2025-01-08 10:19:55,775 - INFO - Starting Step 4: AST normalization
2025-01-08 10:19:57,134 - INFO - Step 4 result: {'type': 'Program', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'ClassDecl', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [145, 147], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [148, 174], 'children': [{'type': 'Property', 'name': 'user_id', 'range': [150, 152], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [152, 152], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [154, 156], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [156, 156], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [158, 160], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [160, 160], 'children': []}]}, {'type': 'Property', 'name': 'node_exec_id', 'range': [162, 164], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'node_id', 'range': [166, 168], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [168, 168], 'children': []}]}, {'type': 'Property', 'name': 'data', 'range': [170, 172], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [172, 172], 'children': []}]}]}]}]}
2025-01-08 10:19:57,135 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:19:57,976 - INFO - Step 3 result: {'type': 'Program', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'FunctionDeclaration', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [951, 955], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [952, 955], 'children': []}, {'type': 'FunctionName', 'name': 'upsert_execution_input', 'range': [953, 974], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [954, 985], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [956, 958], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [961, 963], 'children': []}, {'type': 'Parameter', 'name': 'input_name', 'range': [966, 968], 'children': []}, {'type': 'Parameter', 'name': 'input_data', 'range': [971, 973], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [976, 982], 'children': []}]}, {'type': 'ReturnType', 'name': 'tuple[str, BlockInput]', 'range': [986, 993], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [994, 1270], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [996, 998], 'children': []}, {'type': 'VariableDeclaration', 'name': 'existing_execution', 'range': [1000, 1092], 'children': []}, {'type': 'VariableDeclaration', 'name': 'json_input_data', 'range': [1093, 1101], 'children': []}, {'type': 'IfStatement', 'name': 'if existing_execution', 'range': [1103, 1185], 'children': [{'type': 'Block', 'name': 'if_block', 'range': [1106, 1185], 'children': [{'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create', 'range': [1107, 1140], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1142, 1185], 'children': []}]}]}, {'type': 'ElifStatement', 'name': 'elif not node_exec_id', 'range': [1187, 1256], 'children': [{'type': 'Block', 'name': 'elif_block', 'range': [1191, 1256], 'children': [{'type': 'VariableDeclaration', 'name': 'result', 'range': [1192, 1245], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1246, 1256], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [1258, 1269], 'children': [{'type': 'Block', 'name': 'else_block', 'range': [1260, 1269], 'children': [{'type': 'RaiseStatement', 'name': 'raise ValueError', 'range': [1261, 1268], 'children': []}]}]}]}]}]}
2025-01-08 10:19:57,977 - INFO - Starting Step 4: AST normalization
2025-01-08 10:19:58,676 - INFO - Step 5 result: {'type': 'Program', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'ClassDecl', 'name': 'GraphExecutionEntry', 'range': [116, 142], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [118, 120], 'children': []}, {'type': 'Property', 'name': 'user_id', 'range': [123, 125], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [125, 125], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [127, 129], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [129, 129], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [131, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [133, 133], 'children': []}]}, {'type': 'Property', 'name': 'start_node_execs', 'range': [135, 140], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [137, 137], 'children': [{'type': 'GenericType', 'name': 'NodeExecutionEntry', 'range': [139, 139], 'children': []}]}]}]}]}
2025-01-08 10:19:58,676 - INFO - Completed main AST analysis flow
2025-01-08 10:19:58,676 - INFO - Successfully processed chunk
2025-01-08 10:20:00,129 - INFO - Step 3 result: {'type': 'Program', 'name': 'get_incomplete_executions', 'range': [2615, 2695], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_incomplete_executions', 'range': [2615, 2693], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [2615, 2619], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [2616, 2619], 'children': []}, {'type': 'Identifier', 'name': 'get_incomplete_executions', 'range': [2617, 2641], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [2618, 2628], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2620, 2623], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2621, 2623], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2624, 2627], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2625, 2627], 'children': []}]}]}, {'type': 'ReturnType', 'name': '', 'range': [2629, 2635], 'children': [{'type': 'TypeAnnotation', 'name': 'list[ExecutionResult]', 'range': [2631, 2635], 'children': []}]}, {'type': 'Block', 'name': '', 'range': [2636, 2693], 'children': [{'type': 'VariableDeclaration', 'name': 'executions', 'range': [2637, 2678], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [2639, 2644], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many', 'range': [2640, 2678], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2649, 2670], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2653, 2656], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2655, 2656], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2658, 2661], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2660, 2661], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2663, 2668], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2665, 2668], 'children': []}]}]}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2675, 2676], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': '', 'range': [2680, 2693], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [2681, 2692], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2682, 2687], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2686, 2687], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:00,129 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:00,310 - INFO - Step 3 result: {'type': 'Program', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1400, 1404], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1401, 1404], 'children': []}, {'type': 'FunctionName', 'name': 'update_graph_execution_stats', 'range': [1402, 1423], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1403, 1420], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1405, 1407], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1407, 1410], 'children': []}, {'type': 'Parameter', 'name': 'stats', 'range': [1410, 1412], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any]', 'range': [1412, 1418], 'children': []}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1421, 1425], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1425, 1509], 'children': [{'type': 'Assignment', 'name': 'status', 'range': [1426, 1441], 'children': [{'type': 'Variable', 'name': 'status', 'range': [1426, 1431], 'children': []}, {'type': 'ConditionalExpression', 'name': 'if-else', 'range': [1431, 1441], 'children': [{'type': 'Condition', 'name': 'stats.get("error")', 'range': [1431, 1437], 'children': []}, {'type': 'TrueBranch', 'name': 'ExecutionStatus.FAILED', 'range': [1438, 1441], 'children': []}, {'type': 'FalseBranch', 'name': 'ExecutionStatus.COMPLETED', 'range': [1441, 1441], 'children': []}]}]}, {'type': 'AwaitExpression', 'name': 'await AgentGraphExecution.prisma().update', 'range': [1445, 1486], 'children': [{'type': 'CallExpression', 'name': 'AgentGraphExecution.prisma', 'range': [1446, 1450], 'children': []}, {'type': 'CallExpression', 'name': 'update', 'range': [1452, 1486], 'children': [{'type': 'Argument', 'name': 'where', 'range': [1455, 1461], 'children': []}, {'type': 'Argument', 'name': 'data', 'range': [1464, 1483], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if not res', 'range': [1488, 1498], 'children': [{'type': 'Condition', 'name': 'not res', 'range': [1488, 1491], 'children': []}, {'type': 'ThenBranch', 'name': 'raise ValueError', 'range': [1492, 1498], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_graph(res)', 'range': [1501, 1508], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_graph', 'range': [1502, 1507], 'children': []}]}]}]}]}
2025-01-08 10:20:00,311 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:00,555 - INFO - Step 2 result: {'type': 'Program', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'FunctionDeclaration', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1271, 1271], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1272, 1272], 'children': []}, {'type': 'Identifier', 'name': 'upsert_execution_output', 'range': [1273, 1273], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [1274, 1274], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1276, 1278], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1276, 1276], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1277, 1277], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1278, 1278], 'children': []}]}, {'type': 'Parameter', 'name': 'output_name', 'range': [1281, 1283], 'children': [{'type': 'Identifier', 'name': 'output_name', 'range': [1281, 1281], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1282, 1282], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1283, 1283], 'children': []}]}, {'type': 'Parameter', 'name': 'output_data', 'range': [1286, 1288], 'children': [{'type': 'Identifier', 'name': 'output_data', 'range': [1286, 1286], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1287, 1287], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1288, 1288], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [1291, 1291], 'children': []}, {'type': 'ReturnType', 'name': 'None', 'range': [1292, 1294], 'children': [{'type': 'Punctuation', 'name': '-', 'range': [1292, 1292], 'children': []}, {'type': 'Punctuation', 'name': '>', 'range': [1293, 1293], 'children': []}, {'type': 'TypeAnnotation', 'name': 'None', 'range': [1294, 1294], 'children': []}]}, {'type': 'Punctuation', 'name': ':', 'range': [1295, 1295], 'children': []}, {'type': 'Docstring', 'name': '""" \\n     Insert AgentNodeExecutionInputOutput record for as one of AgentNodeExecution.Output. \\n     """', 'range': [1297, 1299], 'children': []}, {'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create(data={...})', 'range': [1301, 1337], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1301, 1301], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecutionInputOutput.prisma().create', 'range': [1302, 1337], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecutionInputOutput', 'range': [1302, 1302], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [1303, 1303], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [1304, 1304], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [1305, 1305], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [1306, 1306], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [1307, 1307], 'children': []}, {'type': 'Identifier', 'name': 'create', 'range': [1308, 1308], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [1309, 1309], 'children': []}, {'type': 'ObjectExpression', 'name': 'data={...}', 'range': [1311, 1335], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1311, 1311], 'children': []}, {'type': 'Punctuation', 'name': '=', 'range': [1312, 1312], 'children': []}, {'type': 'Punctuation', 'name': '{', 'range': [1313, 1313], 'children': []}, {'type': 'Property', 'name': '"name": output_name', 'range': [1315, 1317], 'children': [{'type': 'Literal', 'name': '"name"', 'range': [1315, 1315], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1316, 1316], 'children': []}, {'type': 'Identifier', 'name': 'output_name', 'range': [1317, 1317], 'children': []}]}, {'type': 'Property', 'name': '"data": json.dumps(output_data)', 'range': [1320, 1327], 'children': [{'type': 'Literal', 'name': '"data"', 'range': [1320, 1320], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1321, 1321], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1322, 1327], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1322, 1322], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [1323, 1323], 'children': []}, {'type': 'Identifier', 'name': 'dumps', 'range': [1324, 1324], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [1325, 1325], 'children': []}, {'type': 'Identifier', 'name': 'output_data', 'range': [1326, 1326], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [1327, 1327], 'children': []}]}]}, {'type': 'Property', 'name': '"referencedByOutputExecId": node_exec_id', 'range': [1330, 1332], 'children': [{'type': 'Literal', 'name': '"referencedByOutputExecId"', 'range': [1330, 1330], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1331, 1331], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1332, 1332], 'children': []}]}, {'type': 'Punctuation', 'name': '}', 'range': [1335, 1335], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [1337, 1337], 'children': []}]}]}]}]}
2025-01-08 10:20:00,555 - INFO - Starting Step 3: AST simplification
2025-01-08 10:20:04,629 - INFO - Step 3 result: {'nodes': [{'type': 'ClassDeclaration', 'name': 'AsyncRedisExecutionEventBus', 'range': [2856, 2865], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus[ExecutionResult]', 'range': [2858, 2863], 'children': []}]}, {'type': 'VariableDeclaration', 'name': 'Model', 'range': [2866, 2869], 'children': [{'type': 'Assignment', 'name': '=', 'range': [2867, 2868], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [2868, 2868], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [2871, 2888], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2871, 2872], 'children': []}, {'type': 'Parameter', 'name': 'self', 'range': [2877, 2877], 'children': []}, {'type': 'ReturnType', 'name': '-> str', 'range': [2879, 2881], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2884, 2887], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2885, 2887], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'publish', 'range': [2890, 2912], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2894, 2894], 'children': []}, {'type': 'Parameter', 'name': 'res: ExecutionResult', 'range': [2896, 2898], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [2902, 2911], 'children': [{'type': 'MemberExpression', 'name': 'self.publish_event', 'range': [2903, 2905], 'children': []}, {'type': 'Argument', 'name': 'res', 'range': [2907, 2907], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2909, 2910], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'listen', 'range': [2914, 2959], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2919, 2919], 'children': []}, {'type': 'Parameter', 'name': 'graph_id: str = "*"', 'range': [2921, 2925], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id: str = "*"', 'range': [2927, 2931], 'children': []}, {'type': 'ReturnType', 'name': '-> AsyncGenerator[ExecutionResult, None]', 'range': [2934, 2941], 'children': []}, {'type': 'AsyncForStatement', 'name': 'async for', 'range': [2944, 2958], 'children': [{'type': 'VariableDeclaration', 'name': 'execution_result', 'range': [2946, 2946], 'children': []}, {'type': 'MemberExpression', 'name': 'self.listen_events', 'range': [2948, 2950], 'children': []}, {'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2952, 2953], 'children': []}, {'type': 'YieldStatement', 'name': 'yield', 'range': [2957, 2958], 'children': []}]}]}]}
2025-01-08 10:20:04,629 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:06,043 - INFO - Step 3 result: {'type': 'Program', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'FunctionDeclaration', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [1954, 1962], 'children': [{'type': 'Parameter', 'name': 'output', 'range': [1955, 1957], 'children': []}, {'type': 'Parameter', 'name': 'name', 'range': [1959, 1961], 'children': []}]}, {'type': 'ReturnType', 'name': 'returnType', 'range': [1963, 1967], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1969, 2161], 'children': [{'type': 'Comment', 'name': 'comment', 'range': [1970, 1979], 'children': []}, {'type': 'VariableDeclaration', 'name': 'output_name, output_data', 'range': [1980, 1985], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [1987, 1996], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1988, 1991], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1994, 1995], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1998, 2060], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1999, 2005], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2008, 2021], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2023, 2043], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2024, 2038], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2041, 2042], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2044, 2059], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2062, 2107], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2063, 2069], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2072, 2083], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2084, 2101], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2085, 2096], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2099, 2100], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2102, 2106], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2109, 2157], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2110, 2116], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2119, 2130], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2131, 2154], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2132, 2144], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2147, 2153], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2155, 2156], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2159, 2160], 'children': []}]}]}]}
2025-01-08 10:20:06,044 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:07,859 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [189, 291], 'children': [{'type': 'ClassDeclaration', 'name': 'ExecutionQueue', 'range': [189, 291], 'children': [{'type': 'MethodDeclaration', 'name': '__init__', 'range': [204, 222], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [211, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [211, 211], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [213, 213], 'children': []}]}, {'type': 'CallExpression', 'name': '(', 'range': [215, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [215, 219], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [215, 217], 'children': [{'type': 'Identifier', 'name': 'Manager', 'range': [215, 215], 'children': []}]}, {'type': 'Identifier', 'name': 'Queue', 'range': [219, 219], 'children': []}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'add', 'range': [224, 249], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [238, 245], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [238, 242], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [238, 238], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [240, 240], 'children': []}, {'type': 'Identifier', 'name': 'put', 'range': [242, 242], 'children': []}]}, {'type': 'Identifier', 'name': 'execution', 'range': [244, 244], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [247, 248], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [248, 248], 'children': []}]}]}, {'type': 'MethodDeclaration', 'name': 'get', 'range': [251, 269], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [261, 268], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [262, 268], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [262, 266], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [262, 262], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [264, 264], 'children': []}, {'type': 'Identifier', 'name': 'get', 'range': [266, 266], 'children': []}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'empty', 'range': [271, 289], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [281, 288], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [282, 288], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [282, 286], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [282, 282], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [284, 284], 'children': []}, {'type': 'Identifier', 'name': 'empty', 'range': [286, 286], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:07,860 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:07,888 - INFO - Step 5 result: {'type': 'Program', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'ClassDecl', 'name': 'NodeExecutionEntry', 'range': [143, 174], 'children': [{'type': 'Inheritance', 'name': 'BaseModel', 'range': [145, 147], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [148, 174], 'children': [{'type': 'Property', 'name': 'user_id', 'range': [150, 152], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [152, 152], 'children': []}]}, {'type': 'Property', 'name': 'graph_exec_id', 'range': [154, 156], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [156, 156], 'children': []}]}, {'type': 'Property', 'name': 'graph_id', 'range': [158, 160], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [160, 160], 'children': []}]}, {'type': 'Property', 'name': 'node_exec_id', 'range': [162, 164], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [164, 164], 'children': []}]}, {'type': 'Property', 'name': 'node_id', 'range': [166, 168], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [168, 168], 'children': []}]}, {'type': 'Property', 'name': 'data', 'range': [170, 172], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [172, 172], 'children': []}]}]}]}]}
2025-01-08 10:20:07,888 - INFO - Completed main AST analysis flow
2025-01-08 10:20:07,889 - INFO - Successfully processed chunk
2025-01-08 10:20:11,122 - INFO - Step 3 result: {'type': 'Program', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'FunctionDeclaration', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'Decorator', 'name': '@staticmethod', 'range': [480, 481], 'children': []}, {'type': 'FunctionSignature', 'name': 'from_db', 'range': [483, 490], 'children': [{'type': 'Parameter', 'name': 'execution', 'range': [486, 488], 'children': []}]}, {'type': 'FunctionBody', 'name': 'from_db', 'range': [491, 744], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [492, 531], 'children': [{'type': 'Condition', 'name': 'execution.executionData', 'range': [493, 495], 'children': []}, {'type': 'ThenBlock', 'name': 'then', 'range': [496, 531], 'children': [{'type': 'Comment', 'name': '# Execution that has been queued for execution will persist its data.', 'range': [498, 510], 'children': []}, {'type': 'Assignment', 'name': 'input_data = json.loads(execution.executionData, target_type=dict[str, Any])', 'range': [512, 530], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [532, 582], 'children': [{'type': 'Comment', 'name': '# For incomplete execution, executionData will not be yet available.', 'range': [535, 546], 'children': []}, {'type': 'Assignment', 'name': 'input_data: BlockInput = defaultdict()', 'range': [548, 554], 'children': []}, {'type': 'ForLoop', 'name': 'for data in execution.Input or []:', 'range': [556, 582], 'children': [{'type': 'Assignment', 'name': 'input_data[data.name] = json.loads(data.data)', 'range': [567, 581], 'children': []}]}]}, {'type': 'Assignment', 'name': 'output_data: CompletedBlockOutput = defaultdict(list)', 'range': [584, 591], 'children': []}, {'type': 'ForLoop', 'name': 'for data in execution.Output or []:', 'range': [593, 622], 'children': [{'type': 'Assignment', 'name': 'output_data[data.name].append(json.loads(data.data))', 'range': [604, 621], 'children': []}]}, {'type': 'Assignment', 'name': 'graph_execution: AgentGraphExecution | None = execution.AgentGraphExecution', 'range': [624, 633], 'children': []}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult', 'range': [635, 742], 'children': [{'type': 'Argument', 'name': 'graph_id = graph_execution.agentGraphId if graph_execution else ""', 'range': [639, 647], 'children': []}, {'type': 'Argument', 'name': 'graph_version = graph_execution.agentGraphVersion if graph_execution else 0', 'range': [650, 658], 'children': []}, {'type': 'Argument', 'name': 'graph_exec_id = execution.agentGraphExecutionId', 'range': [661, 666], 'children': []}, {'type': 'Argument', 'name': 'block_id = execution.AgentNode.agentBlockId if execution.AgentNode else ""', 'range': [669, 680], 'children': []}, {'type': 'Argument', 'name': 'node_exec_id = execution.id', 'range': [683, 688], 'children': []}, {'type': 'Argument', 'name': 'node_id = execution.agentNodeId', 'range': [690, 695], 'children': []}, {'type': 'Argument', 'name': 'status = execution.executionStatus', 'range': [697, 702], 'children': []}, {'type': 'Argument', 'name': 'input_data = input_data', 'range': [704, 707], 'children': []}, {'type': 'Argument', 'name': 'output_data = output_data', 'range': [709, 712], 'children': []}, {'type': 'Argument', 'name': 'add_time = execution.addedTime', 'range': [714, 719], 'children': []}, {'type': 'Argument', 'name': 'queue_time = execution.queuedTime', 'range': [721, 726], 'children': []}, {'type': 'Argument', 'name': 'start_time = execution.startedTime', 'range': [728, 733], 'children': []}, {'type': 'Argument', 'name': 'end_time = execution.endedTime', 'range': [735, 740], 'children': []}]}]}]}]}
2025-01-08 10:20:11,122 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:13,545 - INFO - Step 4 result: {'type': 'Program', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'FunctionDecl', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1846, 1851], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1847, 1850], 'children': []}, {'type': 'FunctionName', 'name': 'get_execution_results', 'range': [1848, 1869], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1849, 1853], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1850, 1852], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1851, 1852], 'children': []}]}]}, {'type': 'ReturnType', 'name': '-> list[ExecutionResult]', 'range': [1854, 1859], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1860, 1938], 'children': [{'type': 'AssignmentExpression', 'name': 'executions = await AgentNodeExecution.prisma().find_many(...)', 'range': [1862, 1918], 'children': [{'type': 'VariableDeclarator', 'name': 'executions', 'range': [1862, 1871], 'children': []}, {'type': 'AwaitExpression', 'name': 'await AgentNodeExecution.prisma().find_many(...)', 'range': [1864, 1918], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many(...)', 'range': [1865, 1918], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1865, 1867], 'children': []}, {'type': 'CallExpression', 'name': 'find_many(...)', 'range': [1868, 1918], 'children': [{'type': 'ObjectExpression', 'name': 'where = {...}', 'range': [1874, 1880], 'children': []}, {'type': 'Identifier', 'name': 'include = EXECUTION_RESULT_INCLUDE', 'range': [1883, 1886], 'children': []}, {'type': 'ArrayExpression', 'name': 'order = [...]', 'range': [1888, 1915], 'children': []}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res = [...]', 'range': [1920, 1933], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1920, 1921], 'children': []}, {'type': 'ArrayExpression', 'name': '[...]', 'range': [1922, 1933], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db(execution)', 'range': [1923, 1928], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return res', 'range': [1935, 1936], 'children': []}]}]}]}
2025-01-08 10:20:13,545 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:15,353 - INFO - Step 3 result: {'type': 'Program', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1510, 1514]}, {'type': 'Keyword', 'name': 'def', 'range': [1511, 1514]}, {'type': 'Identifier', 'name': 'update_node_execution_stats', 'range': [1512, 1540]}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1514, 1526], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1514, 1526]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1516, 1519]}]}, {'type': 'Parameter', 'name': 'stats', 'range': [1518, 1526], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1518, 1523]}, {'type': 'TypeAnnotation', 'name': 'dict', 'range': [1520, 1526], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1522, 1525]}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1524, 1527]}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [1528, 1565], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1529, 1534]}, {'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1530, 1537], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1530, 1547]}, {'type': 'Identifier', 'name': 'prisma', 'range': [1532, 1538]}]}, {'type': 'CallExpression', 'name': 'update', 'range': [1536, 1562], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1536, 1542]}, {'type': 'ObjectExpression', 'name': 'where', 'range': [1539, 1545], 'children': [{'type': 'Property', 'name': 'id', 'range': [1542, 1545], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [1542, 1545]}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1544, 1556]}]}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1548, 1559], 'children': [{'type': 'Property', 'name': 'stats', 'range': [1551, 1559], 'children': [{'type': 'Literal', 'name': '"stats"', 'range': [1551, 1557]}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1553, 1557]}, {'type': 'Identifier', 'name': 'dumps', 'range': [1555, 1560]}]}, {'type': 'Identifier', 'name': 'stats', 'range': [1557, 1562]}]}]}]}]}]}]}]}
2025-01-08 10:20:15,354 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:16,064 - INFO - Step 4 result: {'type': 'Program', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'FunctionDecl', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [951, 955], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [952, 955], 'children': []}, {'type': 'FunctionName', 'name': 'upsert_execution_input', 'range': [953, 974], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [954, 985], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [956, 958], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [961, 963], 'children': []}, {'type': 'Parameter', 'name': 'input_name', 'range': [966, 968], 'children': []}, {'type': 'Parameter', 'name': 'input_data', 'range': [971, 973], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [976, 982], 'children': []}]}, {'type': 'ReturnType', 'name': 'tuple[str, BlockInput]', 'range': [986, 993], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [994, 1270], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [996, 998], 'children': []}, {'type': 'VariableDecl', 'name': 'existing_execution', 'range': [1000, 1092], 'children': []}, {'type': 'VariableDecl', 'name': 'json_input_data', 'range': [1093, 1101], 'children': []}, {'type': 'IfStatement', 'name': 'if existing_execution', 'range': [1103, 1185], 'children': [{'type': 'Block', 'name': 'if_block', 'range': [1106, 1185], 'children': [{'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create', 'range': [1107, 1140], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1142, 1185], 'children': []}]}]}, {'type': 'ElifStatement', 'name': 'elif not node_exec_id', 'range': [1187, 1256], 'children': [{'type': 'Block', 'name': 'elif_block', 'range': [1191, 1256], 'children': [{'type': 'VariableDecl', 'name': 'result', 'range': [1192, 1245], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1246, 1256], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [1258, 1269], 'children': [{'type': 'Block', 'name': 'else_block', 'range': [1260, 1269], 'children': [{'type': 'RaiseStatement', 'name': 'raise ValueError', 'range': [1261, 1268], 'children': []}]}]}]}]}]}
2025-01-08 10:20:16,065 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:18,483 - INFO - Step 3 result: {'nodes': [{'type': 'ImportDeclaration', 'name': 'defaultdict', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'collections', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'defaultdict', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'datetime, timezone', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'datetime', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'datetime, timezone', 'range': [7, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Manager', 'range': [12, 16], 'children': [{'type': 'FromImport', 'name': 'multiprocessing', 'range': [12, 13], 'children': []}, {'type': 'Import', 'name': 'Manager', 'range': [14, 15], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [17, 29], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [17, 18], 'children': []}, {'type': 'Import', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [19, 28], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentExecutionStatus', 'range': [31, 37], 'children': [{'type': 'FromImport', 'name': 'prisma.enums', 'range': [31, 34], 'children': []}, {'type': 'Import', 'name': 'AgentExecutionStatus', 'range': [35, 36], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [38, 55], 'children': [{'type': 'FromImport', 'name': 'prisma.models', 'range': [38, 41], 'children': []}, {'type': 'Import', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [42, 54], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseModel', 'range': [56, 60], 'children': [{'type': 'FromImport', 'name': 'pydantic', 'range': [56, 57], 'children': []}, {'type': 'Import', 'name': 'BaseModel', 'range': [58, 59], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [62, 74], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [62, 67], 'children': []}, {'type': 'Import', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [68, 73], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [75, 85], 'children': [{'type': 'FromImport', 'name': 'backend.data.includes', 'range': [75, 80], 'children': []}, {'type': 'Import', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [81, 84], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [86, 96], 'children': [{'type': 'FromImport', 'name': 'backend.data.queue', 'range': [86, 91], 'children': []}, {'type': 'Import', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [92, 95], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'json, mock', 'range': [97, 105], 'children': [{'type': 'FromImport', 'name': 'backend.util', 'range': [97, 100], 'children': []}, {'type': 'Import', 'name': 'json, mock', 'range': [101, 104], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Config', 'range': [106, 114], 'children': [{'type': 'FromImport', 'name': 'backend.util.settings', 'range': [106, 111], 'children': []}, {'type': 'Import', 'name': 'Config', 'range': [112, 113], 'children': []}]}]}
2025-01-08 10:20:18,484 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:18,758 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [2752, 2855], 'children': [{'type': 'ClassDeclaration', 'name': 'RedisExecutionEventBus', 'range': [2752, 2765], 'children': [{'type': 'Inheritance', 'name': 'RedisEventBus[ExecutionResult]', 'range': [2754, 2759], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [2760, 2765], 'children': [{'type': 'FieldDeclaration', 'name': 'Model', 'range': [2762, 2764], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [2767, 2784], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2767, 2768], 'children': []}, {'type': 'FunctionSignature', 'name': '', 'range': [2770, 2778], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2773, 2774], 'children': []}, {'type': 'ReturnType', 'name': 'str', 'range': [2775, 2777], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2779, 2784], 'children': [{'type': 'ReturnStatement', 'name': '', 'range': [2780, 2784], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2781, 2783], 'children': []}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'publish', 'range': [2786, 2806], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2788, 2795], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2789, 2790], 'children': []}, {'type': 'Parameter', 'name': 'res', 'range': [2791, 2794], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [2792, 2794], 'children': []}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [2796, 2806], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [2797, 2806], 'children': [{'type': 'CallExpression', 'name': 'self.publish_event', 'range': [2797, 2805], 'children': [{'type': 'Argument', 'name': 'res', 'range': [2801, 2802], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2803, 2805], 'children': []}]}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'listen', 'range': [2808, 2853], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2810, 2837], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2812, 2813], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [2814, 2818], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2815, 2817], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2817, 2818], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [2820, 2824], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2821, 2823], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2823, 2824], 'children': []}]}, {'type': 'ReturnType', 'name': 'Generator[ExecutionResult, None, None]', 'range': [2827, 2836], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2838, 2853], 'children': [{'type': 'ForStatement', 'name': '', 'range': [2839, 2853], 'children': [{'type': 'VariableDeclaration', 'name': 'execution_result', 'range': [2840, 2841], 'children': []}, {'type': 'CallExpression', 'name': 'self.listen_events', 'range': [2842, 2848], 'children': [{'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2846, 2848], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2849, 2853], 'children': [{'type': 'YieldStatement', 'name': '', 'range': [2851, 2853], 'children': [{'type': 'Identifier', 'name': 'execution_result', 'range': [2852, 2853], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:18,758 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:19,690 - INFO - Step 4 result: {'type': 'Program', 'name': 'get_incomplete_executions', 'range': [2615, 2695], 'children': [{'type': 'FunctionDecl', 'name': 'get_incomplete_executions', 'range': [2615, 2693], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [2615, 2619], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [2616, 2619], 'children': []}, {'type': 'Identifier', 'name': 'get_incomplete_executions', 'range': [2617, 2641], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [2618, 2628], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2620, 2623], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2621, 2623], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2624, 2627], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2625, 2627], 'children': []}]}]}, {'type': 'ReturnType', 'name': '', 'range': [2629, 2635], 'children': [{'type': 'TypeAnnotation', 'name': 'list[ExecutionResult]', 'range': [2631, 2635], 'children': []}]}, {'type': 'Block', 'name': '', 'range': [2636, 2693], 'children': [{'type': 'VariableDeclaration', 'name': 'executions', 'range': [2637, 2678], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [2639, 2644], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many', 'range': [2640, 2678], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2649, 2670], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2653, 2656], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2655, 2656], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2658, 2661], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2660, 2661], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2663, 2668], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2665, 2668], 'children': []}]}]}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2675, 2676], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': '', 'range': [2680, 2693], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [2681, 2692], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2682, 2687], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2686, 2687], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:19,690 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:20,926 - INFO - Step 2 result: {'type': 'Program', 'name': 'ExecutionResult', 'range': [292, 479], 'children': [{'type': 'ClassDeclaration', 'name': 'ExecutionResult', 'range': [292, 356], 'children': [{'type': 'PropertyDeclaration', 'name': 'graph_id', 'range': [299, 301], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [301, 301], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'graph_version', 'range': [303, 305], 'children': [{'type': 'TypeAnnotation', 'name': 'int', 'range': [305, 305], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'graph_exec_id', 'range': [307, 309], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [309, 309], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'node_exec_id', 'range': [311, 313], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [313, 313], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'node_id', 'range': [315, 317], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [317, 317], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'block_id', 'range': [319, 321], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [321, 321], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'status', 'range': [323, 325], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [325, 325], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'input_data', 'range': [327, 329], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [329, 329], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'output_data', 'range': [331, 333], 'children': [{'type': 'TypeAnnotation', 'name': 'CompletedBlockOutput', 'range': [333, 333], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'add_time', 'range': [335, 337], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [337, 337], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'queue_time', 'range': [339, 343], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [341, 341], 'children': []}, {'type': 'UnionType', 'name': '|', 'range': [342, 342], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [343, 343], 'children': []}]}]}, {'type': 'PropertyDeclaration', 'name': 'start_time', 'range': [345, 349], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [347, 347], 'children': []}, {'type': 'UnionType', 'name': '|', 'range': [348, 348], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [349, 349], 'children': []}]}]}, {'type': 'PropertyDeclaration', 'name': 'end_time', 'range': [351, 355], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [353, 353], 'children': []}, {'type': 'UnionType', 'name': '|', 'range': [354, 354], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [355, 355], 'children': []}]}]}]}, {'type': 'MethodDeclaration', 'name': 'from_graph', 'range': [358, 478], 'children': [{'type': 'Parameter', 'name': 'graph', 'range': [364, 366], 'children': [{'type': 'TypeAnnotation', 'name': 'AgentGraphExecution', 'range': [366, 366], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [370, 477], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult', 'range': [371, 477], 'children': [{'type': 'Argument', 'name': 'graph_id', 'range': [374, 378], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [375, 375], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphId', 'range': [376, 378], 'children': []}]}]}, {'type': 'Argument', 'name': 'graph_version', 'range': [381, 385], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [382, 382], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphVersion', 'range': [383, 385], 'children': []}]}]}, {'type': 'Argument', 'name': 'graph_exec_id', 'range': [388, 392], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [389, 389], 'children': [{'type': 'MemberExpression', 'name': 'graph.id', 'range': [390, 392], 'children': []}]}]}, {'type': 'Argument', 'name': 'node_exec_id', 'range': [395, 397], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [396, 396], 'children': [{'type': 'StringLiteral', 'name': '""', 'range': [397, 397], 'children': []}]}]}, {'type': 'Argument', 'name': 'node_id', 'range': [400, 402], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [401, 401], 'children': [{'type': 'StringLiteral', 'name': '""', 'range': [402, 402], 'children': []}]}]}, {'type': 'Argument', 'name': 'block_id', 'range': [405, 407], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [406, 406], 'children': [{'type': 'StringLiteral', 'name': '""', 'range': [407, 407], 'children': []}]}]}, {'type': 'Argument', 'name': 'status', 'range': [410, 414], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [411, 411], 'children': [{'type': 'MemberExpression', 'name': 'graph.executionStatus', 'range': [412, 414], 'children': []}]}]}, {'type': 'Comment', 'name': '# TODO: Populate input_data & output_data from AgentNodeExecutions', 'range': [417, 426], 'children': []}, {'type': 'Comment', 'name': '# Input & Output comes AgentInputBlock & AgentOutputBlock.', 'range': [427, 436], 'children': []}, {'type': 'Argument', 'name': 'input_data', 'range': [437, 440], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [438, 438], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [439, 440], 'children': []}]}]}, {'type': 'Argument', 'name': 'output_data', 'range': [443, 446], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [444, 444], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [445, 446], 'children': []}]}]}, {'type': 'Argument', 'name': 'add_time', 'range': [449, 453], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [450, 450], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [451, 453], 'children': []}]}]}, {'type': 'Argument', 'name': 'queue_time', 'range': [456, 460], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [457, 457], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [458, 460], 'children': []}]}]}, {'type': 'Argument', 'name': 'start_time', 'range': [463, 467], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [464, 464], 'children': [{'type': 'MemberExpression', 'name': 'graph.startedAt', 'range': [465, 467], 'children': []}]}]}, {'type': 'Argument', 'name': 'end_time', 'range': [470, 474], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [471, 471], 'children': [{'type': 'MemberExpression', 'name': 'graph.updatedAt', 'range': [472, 474], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:20,927 - INFO - Starting Step 3: AST simplification
2025-01-08 10:20:22,000 - INFO - Step 4 result: {'type': 'Program', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'FunctionDecl', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1400, 1404], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1401, 1404], 'children': []}, {'type': 'Identifier', 'name': 'update_graph_execution_stats', 'range': [1402, 1423], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1403, 1420], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1405, 1407], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1407, 1410], 'children': []}, {'type': 'Parameter', 'name': 'stats', 'range': [1410, 1412], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any]', 'range': [1412, 1418], 'children': []}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1421, 1425], 'children': []}, {'type': 'BlockStatement', 'name': 'body', 'range': [1425, 1509], 'children': [{'type': 'AssignmentExpression', 'name': 'status', 'range': [1426, 1441], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1426, 1431], 'children': []}, {'type': 'ConditionalExpression', 'name': 'if-else', 'range': [1431, 1441], 'children': [{'type': 'CallExpression', 'name': 'stats.get', 'range': [1431, 1437], 'children': [{'type': 'Literal', 'name': '"error"', 'range': [1435, 1437], 'children': []}]}, {'type': 'Identifier', 'name': 'ExecutionStatus.FAILED', 'range': [1438, 1441], 'children': []}, {'type': 'Identifier', 'name': 'ExecutionStatus.COMPLETED', 'range': [1441, 1441], 'children': []}]}]}, {'type': 'AwaitExpression', 'name': 'await AgentGraphExecution.prisma().update', 'range': [1445, 1486], 'children': [{'type': 'CallExpression', 'name': 'AgentGraphExecution.prisma', 'range': [1446, 1450], 'children': []}, {'type': 'CallExpression', 'name': 'update', 'range': [1452, 1486], 'children': [{'type': 'Argument', 'name': 'where', 'range': [1455, 1461], 'children': []}, {'type': 'Argument', 'name': 'data', 'range': [1464, 1483], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if not res', 'range': [1488, 1498], 'children': [{'type': 'UnaryExpression', 'name': 'not res', 'range': [1488, 1491], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1489, 1491], 'children': []}]}, {'type': 'ThrowStatement', 'name': 'raise ValueError', 'range': [1492, 1498], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_graph(res)', 'range': [1501, 1508], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_graph', 'range': [1502, 1507], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1506, 1507], 'children': []}]}]}]}]}]}
2025-01-08 10:20:22,000 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:22,137 - INFO - Step 3 result: {'type': 'Program', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1340, 1344], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1341, 1344], 'children': []}, {'type': 'Identifier', 'name': 'update_graph_execution_start_time', 'range': [1342, 1371], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1344, 1365], 'children': [{'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1344, 1356], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1346, 1349], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [1349, 1399], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [1350, 1398], 'children': [{'type': 'AwaitExpression', 'name': '', 'range': [1350, 1397], 'children': [{'type': 'CallExpression', 'name': '', 'range': [1351, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1351, 1357], 'children': [{'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [1351, 1369], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [1353, 1359], 'children': []}]}, {'type': 'CallExpression', 'name': '', 'range': [1357, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1357, 1363], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1357, 1363], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1363, 1394], 'children': [{'type': 'Property', 'name': 'where', 'range': [1360, 1366], 'children': [{'type': 'Identifier', 'name': 'where', 'range': [1360, 1364], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1362, 1366], 'children': [{'type': 'Property', 'name': 'id', 'range': [1363, 1365], 'children': [{'type': 'Literal', 'name': 'id', 'range': [1363, 1365], 'children': []}, {'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1365, 1377], 'children': []}]}]}]}, {'type': 'Property', 'name': 'data', 'range': [1369, 1394], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1369, 1373], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1371, 1394], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1373, 1378], 'children': [{'type': 'Literal', 'name': 'executionStatus', 'range': [1373, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1375, 1377], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1375, 1389], 'children': []}, {'type': 'Identifier', 'name': 'RUNNING', 'range': [1377, 1384], 'children': []}]}]}, {'type': 'Property', 'name': 'startedAt', 'range': [1380, 1392], 'children': [{'type': 'Literal', 'name': 'startedAt', 'range': [1380, 1389], 'children': []}, {'type': 'CallExpression', 'name': '', 'range': [1382, 1391], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1382, 1388], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1382, 1390], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1384, 1387], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1388, 1391], 'children': [{'type': 'Property', 'name': 'tz', 'range': [1387, 1390], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1387, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1389, 1390], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1389, 1397], 'children': []}, {'type': 'Identifier', 'name': 'utc', 'range': [1390, 1393], 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
2025-01-08 10:20:22,137 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:24,912 - INFO - Step 4 result: {'nodes': [{'type': 'ClassDecl', 'name': 'AsyncRedisExecutionEventBus', 'range': [2856, 2865], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus[ExecutionResult]', 'range': [2858, 2863], 'children': []}]}, {'type': 'VariableDecl', 'name': 'Model', 'range': [2866, 2869], 'children': [{'type': 'Assignment', 'name': '=', 'range': [2867, 2868], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [2868, 2868], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'event_bus_name', 'range': [2871, 2888], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2871, 2872], 'children': []}, {'type': 'Parameter', 'name': 'self', 'range': [2877, 2877], 'children': []}, {'type': 'ReturnType', 'name': '-> str', 'range': [2879, 2881], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2884, 2887], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2885, 2887], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'publish', 'range': [2890, 2912], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2894, 2894], 'children': []}, {'type': 'Parameter', 'name': 'res: ExecutionResult', 'range': [2896, 2898], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [2902, 2911], 'children': [{'type': 'CallExpression', 'name': 'self.publish_event', 'range': [2903, 2905], 'children': []}, {'type': 'Argument', 'name': 'res', 'range': [2907, 2907], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2909, 2910], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'listen', 'range': [2914, 2959], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2919, 2919], 'children': []}, {'type': 'Parameter', 'name': 'graph_id: str = "*"', 'range': [2921, 2925], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id: str = "*"', 'range': [2927, 2931], 'children': []}, {'type': 'ReturnType', 'name': '-> AsyncGenerator[ExecutionResult, None]', 'range': [2934, 2941], 'children': []}, {'type': 'AsyncForStatement', 'name': 'async for', 'range': [2944, 2958], 'children': [{'type': 'VariableDecl', 'name': 'execution_result', 'range': [2946, 2946], 'children': []}, {'type': 'CallExpression', 'name': 'self.listen_events', 'range': [2948, 2950], 'children': []}, {'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2952, 2953], 'children': []}, {'type': 'YieldStatement', 'name': 'yield', 'range': [2957, 2958], 'children': []}]}]}]}
2025-01-08 10:20:24,913 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:26,183 - INFO - Step 3 result: {'type': 'Program', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'FunctionDeclaration', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1271, 1271], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1272, 1272], 'children': []}, {'type': 'Identifier', 'name': 'upsert_execution_output', 'range': [1273, 1273], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1276, 1278], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1276, 1276], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1278, 1278], 'children': []}]}, {'type': 'Parameter', 'name': 'output_name', 'range': [1281, 1283], 'children': [{'type': 'Identifier', 'name': 'output_name', 'range': [1281, 1281], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1283, 1283], 'children': []}]}, {'type': 'Parameter', 'name': 'output_data', 'range': [1286, 1288], 'children': [{'type': 'Identifier', 'name': 'output_data', 'range': [1286, 1286], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1288, 1288], 'children': []}]}, {'type': 'ReturnType', 'name': 'None', 'range': [1292, 1294], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [1294, 1294], 'children': []}]}, {'type': 'Docstring', 'name': '""" \\n     Insert AgentNodeExecutionInputOutput record for as one of AgentNodeExecution.Output. \\n     """', 'range': [1297, 1299], 'children': []}, {'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create(data={...})', 'range': [1301, 1337], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1301, 1301], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecutionInputOutput.prisma().create', 'range': [1302, 1337], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecutionInputOutput', 'range': [1302, 1302], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [1304, 1304], 'children': []}, {'type': 'Identifier', 'name': 'create', 'range': [1308, 1308], 'children': []}, {'type': 'ObjectExpression', 'name': 'data={...}', 'range': [1311, 1335], 'children': [{'type': 'Property', 'name': '"name": output_name', 'range': [1315, 1317], 'children': [{'type': 'Literal', 'name': '"name"', 'range': [1315, 1315], 'children': []}, {'type': 'Identifier', 'name': 'output_name', 'range': [1317, 1317], 'children': []}]}, {'type': 'Property', 'name': '"data": json.dumps(output_data)', 'range': [1320, 1327], 'children': [{'type': 'Literal', 'name': '"data"', 'range': [1320, 1320], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1322, 1327], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1322, 1322], 'children': []}, {'type': 'Identifier', 'name': 'dumps', 'range': [1324, 1324], 'children': []}, {'type': 'Identifier', 'name': 'output_data', 'range': [1326, 1326], 'children': []}]}]}, {'type': 'Property', 'name': '"referencedByOutputExecId": node_exec_id', 'range': [1330, 1332], 'children': [{'type': 'Literal', 'name': '"referencedByOutputExecId"', 'range': [1330, 1330], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1332, 1332], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:26,183 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:26,564 - INFO - Step 3 result: {'type': 'Program', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [2510, 2514], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [2511, 2514], 'children': []}, {'type': 'FunctionName', 'name': 'get_latest_execution', 'range': [2512, 2532], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [2513, 2521], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2514, 2517], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2516, 2519], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2518, 2521], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2520, 2523], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult | None', 'range': [2522, 2527], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [2528, 2613], 'children': [{'type': 'VariableDeclaration', 'name': 'execution', 'range': [2529, 2536], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [2531, 2536], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [2532, 2536], 'children': []}]}]}, {'type': 'MethodCall', 'name': 'find_first', 'range': [2538, 2596], 'children': [{'type': 'Argument', 'name': 'where', 'range': [2541, 2579], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2543, 2579], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2545, 2548], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2547, 2550], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2550, 2553], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2552, 2555], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2555, 2564], 'children': [{'type': 'ObjectExpression', 'name': 'executionStatus', 'range': [2557, 2563], 'children': [{'type': 'Property', 'name': 'not', 'range': [2558, 2561], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2560, 2563], 'children': []}]}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [2566, 2573], 'children': [{'type': 'ObjectExpression', 'name': 'executionData', 'range': [2568, 2572], 'children': [{'type': 'Property', 'name': 'not', 'range': [2569, 2572], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2571, 2574], 'children': []}]}]}]}]}]}, {'type': 'Argument', 'name': 'order', 'range': [2582, 2589], 'children': [{'type': 'ObjectExpression', 'name': 'order', 'range': [2584, 2588], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [2585, 2588], 'children': [{'type': 'StringLiteral', 'name': 'desc', 'range': [2587, 2590], 'children': []}]}]}]}, {'type': 'Argument', 'name': 'include', 'range': [2591, 2595], 'children': [{'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2593, 2596], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2598, 2605], 'children': [{'type': 'Condition', 'name': 'not execution', 'range': [2599, 2601], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [2599, 2602], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2600, 2603], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'block', 'range': [2602, 2605], 'children': [{'type': 'ReturnStatement', 'name': 'return None', 'range': [2603, 2605], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2604, 2607], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_db(execution)', 'range': [2606, 2613], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': []}, {'type': 'Argument', 'name': 'execution', 'range': [2611, 2613], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2611, 2614], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:26,564 - INFO - Starting Step 4: AST normalization
2025-01-08 10:20:28,570 - INFO - Step 4 result: {'type': 'Program', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'FunctionDecl', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [1954, 1962], 'children': [{'type': 'Parameter', 'name': 'output', 'range': [1955, 1957], 'children': []}, {'type': 'Parameter', 'name': 'name', 'range': [1959, 1961], 'children': []}]}, {'type': 'ReturnType', 'name': 'returnType', 'range': [1963, 1967], 'children': []}, {'type': 'BlockStatement', 'name': 'body', 'range': [1969, 2161], 'children': [{'type': 'Comment', 'name': 'comment', 'range': [1970, 1979], 'children': []}, {'type': 'VariableDeclaration', 'name': 'output_name, output_data', 'range': [1980, 1985], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [1987, 1996], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1988, 1991], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1994, 1995], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1998, 2060], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1999, 2005], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2008, 2021], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2023, 2043], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2024, 2038], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2041, 2042], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2044, 2059], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2062, 2107], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2063, 2069], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2072, 2083], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2084, 2101], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2085, 2096], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2099, 2100], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2102, 2106], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2109, 2157], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2110, 2116], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2119, 2130], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2131, 2154], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2132, 2144], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2147, 2153], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2155, 2156], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2159, 2160], 'children': []}]}]}]}
2025-01-08 10:20:28,570 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:29,026 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [189, 291], 'children': [{'type': 'ClassDecl', 'name': 'ExecutionQueue', 'range': [189, 291], 'children': [{'type': 'FunctionDecl', 'name': '__init__', 'range': [204, 222], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [211, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [211, 211], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [213, 213], 'children': []}]}, {'type': 'CallExpression', 'name': '(', 'range': [215, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [215, 219], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [215, 217], 'children': [{'type': 'Identifier', 'name': 'Manager', 'range': [215, 215], 'children': []}]}, {'type': 'Identifier', 'name': 'Queue', 'range': [219, 219], 'children': []}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'add', 'range': [224, 249], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [238, 245], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [238, 242], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [238, 238], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [240, 240], 'children': []}, {'type': 'Identifier', 'name': 'put', 'range': [242, 242], 'children': []}]}, {'type': 'Identifier', 'name': 'execution', 'range': [244, 244], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [247, 248], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [248, 248], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'get', 'range': [251, 269], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [261, 268], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [262, 268], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [262, 266], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [262, 262], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [264, 264], 'children': []}, {'type': 'Identifier', 'name': 'get', 'range': [266, 266], 'children': []}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'empty', 'range': [271, 289], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [281, 288], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [282, 288], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [282, 286], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [282, 282], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [284, 284], 'children': []}, {'type': 'Identifier', 'name': 'empty', 'range': [286, 286], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:29,027 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:30,672 - INFO - Step 5 result: {'type': 'Program', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'FunctionDecl', 'name': 'get_execution_results', 'range': [1846, 1938], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1846, 1851], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1847, 1850], 'children': []}, {'type': 'FunctionName', 'name': 'get_execution_results', 'range': [1848, 1869], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1849, 1853], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1850, 1852], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1851, 1852], 'children': []}]}]}, {'type': 'ReturnType', 'name': '-> list[ExecutionResult]', 'range': [1854, 1859], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1860, 1938], 'children': [{'type': 'AssignmentExpression', 'name': 'executions = await AgentNodeExecution.prisma().find_many(...)', 'range': [1862, 1918], 'children': [{'type': 'VariableDeclarator', 'name': 'executions', 'range': [1862, 1871], 'children': []}, {'type': 'AwaitExpression', 'name': 'await AgentNodeExecution.prisma().find_many(...)', 'range': [1864, 1918], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many(...)', 'range': [1865, 1918], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1865, 1867], 'children': []}, {'type': 'CallExpression', 'name': 'find_many(...)', 'range': [1868, 1918], 'children': [{'type': 'ObjectExpression', 'name': 'where = {...}', 'range': [1874, 1880], 'children': []}, {'type': 'Identifier', 'name': 'include = EXECUTION_RESULT_INCLUDE', 'range': [1883, 1886], 'children': []}, {'type': 'ArrayExpression', 'name': 'order = [...]', 'range': [1888, 1915], 'children': []}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res = [...]', 'range': [1920, 1933], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1920, 1921], 'children': []}, {'type': 'ArrayExpression', 'name': '[...]', 'range': [1922, 1933], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db(execution)', 'range': [1923, 1928], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return res', 'range': [1935, 1936], 'children': []}]}]}]}
2025-01-08 10:20:30,672 - INFO - Completed main AST analysis flow
2025-01-08 10:20:30,673 - INFO - Successfully processed chunk
2025-01-08 10:20:34,076 - INFO - Step 5 result: {'type': 'Program', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'FunctionDecl', 'name': 'upsert_execution_input', 'range': [951, 1270], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [951, 955], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [952, 955], 'children': []}, {'type': 'FunctionName', 'name': 'upsert_execution_input', 'range': [953, 974], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [954, 985], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [956, 958], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [961, 963], 'children': []}, {'type': 'Parameter', 'name': 'input_name', 'range': [966, 968], 'children': []}, {'type': 'Parameter', 'name': 'input_data', 'range': [971, 973], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [976, 982], 'children': []}]}, {'type': 'ReturnType', 'name': 'tuple[str, BlockInput]', 'range': [986, 993], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [994, 1270], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [996, 998], 'children': []}, {'type': 'VariableDecl', 'name': 'existing_execution', 'range': [1000, 1092], 'children': []}, {'type': 'VariableDecl', 'name': 'json_input_data', 'range': [1093, 1101], 'children': []}, {'type': 'IfStatement', 'name': 'if existing_execution', 'range': [1103, 1185], 'children': [{'type': 'Block', 'name': 'if_block', 'range': [1106, 1185], 'children': [{'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create', 'range': [1107, 1140], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1142, 1185], 'children': []}]}]}, {'type': 'ElifStatement', 'name': 'elif not node_exec_id', 'range': [1187, 1256], 'children': [{'type': 'Block', 'name': 'elif_block', 'range': [1191, 1256], 'children': [{'type': 'VariableDecl', 'name': 'result', 'range': [1192, 1245], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1246, 1256], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [1258, 1269], 'children': [{'type': 'Block', 'name': 'else_block', 'range': [1260, 1269], 'children': [{'type': 'RaiseStatement', 'name': 'raise ValueError', 'range': [1261, 1268], 'children': []}]}]}]}]}]}
2025-01-08 10:20:34,076 - INFO - Completed main AST analysis flow
2025-01-08 10:20:34,076 - INFO - Successfully processed chunk
2025-01-08 10:20:34,988 - INFO - Step 4 result: {'type': 'Program', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'FunctionDecl', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1510, 1514]}, {'type': 'Keyword', 'name': 'def', 'range': [1511, 1514]}, {'type': 'Identifier', 'name': 'update_node_execution_stats', 'range': [1512, 1540]}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1514, 1526], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1514, 1526]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1516, 1519]}]}, {'type': 'Parameter', 'name': 'stats', 'range': [1518, 1526], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1518, 1523]}, {'type': 'TypeAnnotation', 'name': 'dict', 'range': [1520, 1526], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1522, 1525]}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1524, 1527]}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [1528, 1565], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1529, 1534]}, {'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1530, 1537], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1530, 1547]}, {'type': 'Identifier', 'name': 'prisma', 'range': [1532, 1538]}]}, {'type': 'CallExpression', 'name': 'update', 'range': [1536, 1562], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1536, 1542]}, {'type': 'ObjectExpression', 'name': 'where', 'range': [1539, 1545], 'children': [{'type': 'Property', 'name': 'id', 'range': [1542, 1545], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [1542, 1545]}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1544, 1556]}]}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1548, 1559], 'children': [{'type': 'Property', 'name': 'stats', 'range': [1551, 1559], 'children': [{'type': 'Literal', 'name': '"stats"', 'range': [1551, 1557]}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1553, 1557]}, {'type': 'Identifier', 'name': 'dumps', 'range': [1555, 1560]}]}, {'type': 'Identifier', 'name': 'stats', 'range': [1557, 1562]}]}]}]}]}]}]}]}
2025-01-08 10:20:34,988 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:35,354 - INFO - Step 4 result: {'type': 'Program', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'FunctionDecl', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'Decorator', 'name': '@staticmethod', 'range': [480, 481], 'children': []}, {'type': 'FunctionSignature', 'name': 'from_db', 'range': [483, 490], 'children': [{'type': 'Parameter', 'name': 'execution', 'range': [486, 488], 'children': []}]}, {'type': 'FunctionBody', 'name': 'from_db', 'range': [491, 744], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [492, 531], 'children': [{'type': 'Condition', 'name': 'execution.executionData', 'range': [493, 495], 'children': []}, {'type': 'ThenBlock', 'name': 'then', 'range': [496, 531], 'children': [{'type': 'Comment', 'name': '# Execution that has been queued for execution will persist its data.', 'range': [498, 510], 'children': []}, {'type': 'Assignment', 'name': 'input_data = json.loads(execution.executionData, target_type=dict[str, Any])', 'range': [512, 530], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [532, 582], 'children': [{'type': 'Comment', 'name': '# For incomplete execution, executionData will not be yet available.', 'range': [535, 546], 'children': []}, {'type': 'Assignment', 'name': 'input_data: BlockInput = defaultdict()', 'range': [548, 554], 'children': []}, {'type': 'ForStatement', 'name': 'for data in execution.Input or []:', 'range': [556, 582], 'children': [{'type': 'Assignment', 'name': 'input_data[data.name] = json.loads(data.data)', 'range': [567, 581], 'children': []}]}]}, {'type': 'Assignment', 'name': 'output_data: CompletedBlockOutput = defaultdict(list)', 'range': [584, 591], 'children': []}, {'type': 'ForStatement', 'name': 'for data in execution.Output or []:', 'range': [593, 622], 'children': [{'type': 'Assignment', 'name': 'output_data[data.name].append(json.loads(data.data))', 'range': [604, 621], 'children': []}]}, {'type': 'Assignment', 'name': 'graph_execution: AgentGraphExecution | None = execution.AgentGraphExecution', 'range': [624, 633], 'children': []}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult', 'range': [635, 742], 'children': [{'type': 'Argument', 'name': 'graph_id = graph_execution.agentGraphId if graph_execution else ""', 'range': [639, 647], 'children': []}, {'type': 'Argument', 'name': 'graph_version = graph_execution.agentGraphVersion if graph_execution else 0', 'range': [650, 658], 'children': []}, {'type': 'Argument', 'name': 'graph_exec_id = execution.agentGraphExecutionId', 'range': [661, 666], 'children': []}, {'type': 'Argument', 'name': 'block_id = execution.AgentNode.agentBlockId if execution.AgentNode else ""', 'range': [669, 680], 'children': []}, {'type': 'Argument', 'name': 'node_exec_id = execution.id', 'range': [683, 688], 'children': []}, {'type': 'Argument', 'name': 'node_id = execution.agentNodeId', 'range': [690, 695], 'children': []}, {'type': 'Argument', 'name': 'status = execution.executionStatus', 'range': [697, 702], 'children': []}, {'type': 'Argument', 'name': 'input_data = input_data', 'range': [704, 707], 'children': []}, {'type': 'Argument', 'name': 'output_data = output_data', 'range': [709, 712], 'children': []}, {'type': 'Argument', 'name': 'add_time = execution.addedTime', 'range': [714, 719], 'children': []}, {'type': 'Argument', 'name': 'queue_time = execution.queuedTime', 'range': [721, 726], 'children': []}, {'type': 'Argument', 'name': 'start_time = execution.startedTime', 'range': [728, 733], 'children': []}, {'type': 'Argument', 'name': 'end_time = execution.endedTime', 'range': [735, 740], 'children': []}]}]}]}]}
2025-01-08 10:20:35,354 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:38,762 - INFO - Step 5 result: {'type': 'Program', 'name': 'get_incomplete_executions', 'range': [2615, 2695], 'children': [{'type': 'FunctionDecl', 'name': 'get_incomplete_executions', 'range': [2615, 2693], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [2615, 2619], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [2616, 2619], 'children': []}, {'type': 'Identifier', 'name': 'get_incomplete_executions', 'range': [2617, 2641], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [2618, 2628], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2620, 2623], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2621, 2623], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2624, 2627], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2625, 2627], 'children': []}]}]}, {'type': 'ReturnType', 'name': '', 'range': [2629, 2635], 'children': [{'type': 'TypeAnnotation', 'name': 'list[ExecutionResult]', 'range': [2631, 2635], 'children': []}]}, {'type': 'Block', 'name': '', 'range': [2636, 2693], 'children': [{'type': 'VariableDeclaration', 'name': 'executions', 'range': [2637, 2678], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [2639, 2644], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().find_many', 'range': [2640, 2678], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2649, 2670], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2653, 2656], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2655, 2656], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2658, 2661], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2660, 2661], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2663, 2668], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2665, 2668], 'children': []}]}]}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2675, 2676], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': '', 'range': [2680, 2693], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [2681, 2692], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2682, 2687], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2686, 2687], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:38,762 - INFO - Completed main AST analysis flow
2025-01-08 10:20:38,763 - INFO - Successfully processed chunk
2025-01-08 10:20:43,657 - INFO - Step 4 result: {'nodes': [{'type': 'ImportDeclaration', 'name': 'defaultdict', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'collections', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'defaultdict', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'datetime, timezone', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'datetime', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'datetime, timezone', 'range': [7, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Manager', 'range': [12, 16], 'children': [{'type': 'FromImport', 'name': 'multiprocessing', 'range': [12, 13], 'children': []}, {'type': 'Import', 'name': 'Manager', 'range': [14, 15], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [17, 29], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [17, 18], 'children': []}, {'type': 'Import', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [19, 28], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentExecutionStatus', 'range': [31, 37], 'children': [{'type': 'FromImport', 'name': 'prisma.enums', 'range': [31, 34], 'children': []}, {'type': 'Import', 'name': 'AgentExecutionStatus', 'range': [35, 36], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [38, 55], 'children': [{'type': 'FromImport', 'name': 'prisma.models', 'range': [38, 41], 'children': []}, {'type': 'Import', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [42, 54], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseModel', 'range': [56, 60], 'children': [{'type': 'FromImport', 'name': 'pydantic', 'range': [56, 57], 'children': []}, {'type': 'Import', 'name': 'BaseModel', 'range': [58, 59], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [62, 74], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [62, 67], 'children': []}, {'type': 'Import', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [68, 73], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [75, 85], 'children': [{'type': 'FromImport', 'name': 'backend.data.includes', 'range': [75, 80], 'children': []}, {'type': 'Import', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [81, 84], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [86, 96], 'children': [{'type': 'FromImport', 'name': 'backend.data.queue', 'range': [86, 91], 'children': []}, {'type': 'Import', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [92, 95], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'json, mock', 'range': [97, 105], 'children': [{'type': 'FromImport', 'name': 'backend.util', 'range': [97, 100], 'children': []}, {'type': 'Import', 'name': 'json, mock', 'range': [101, 104], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Config', 'range': [106, 114], 'children': [{'type': 'FromImport', 'name': 'backend.util.settings', 'range': [106, 111], 'children': []}, {'type': 'Import', 'name': 'Config', 'range': [112, 113], 'children': []}]}]}
2025-01-08 10:20:43,658 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:43,985 - INFO - Step 5 result: {'type': 'Program', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'FunctionDecl', 'name': 'update_graph_execution_stats', 'range': [1400, 1509], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1400, 1404], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1401, 1404], 'children': []}, {'type': 'Identifier', 'name': 'update_graph_execution_stats', 'range': [1402, 1423], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1403, 1420], 'children': [{'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1405, 1407], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1407, 1410], 'children': []}, {'type': 'Parameter', 'name': 'stats', 'range': [1410, 1412], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any]', 'range': [1412, 1418], 'children': []}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1421, 1425], 'children': []}, {'type': 'BlockStatement', 'name': 'body', 'range': [1425, 1509], 'children': [{'type': 'AssignmentExpression', 'name': 'status', 'range': [1426, 1441], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1426, 1431], 'children': []}, {'type': 'ConditionalExpression', 'name': 'if-else', 'range': [1431, 1441], 'children': [{'type': 'CallExpression', 'name': 'stats.get', 'range': [1431, 1437], 'children': [{'type': 'Literal', 'name': '"error"', 'range': [1435, 1437], 'children': []}]}, {'type': 'Identifier', 'name': 'ExecutionStatus.FAILED', 'range': [1438, 1441], 'children': []}, {'type': 'Identifier', 'name': 'ExecutionStatus.COMPLETED', 'range': [1441, 1441], 'children': []}]}]}, {'type': 'AwaitExpression', 'name': 'await AgentGraphExecution.prisma().update', 'range': [1445, 1486], 'children': [{'type': 'CallExpression', 'name': 'AgentGraphExecution.prisma', 'range': [1446, 1450], 'children': []}, {'type': 'CallExpression', 'name': 'update', 'range': [1452, 1486], 'children': [{'type': 'Argument', 'name': 'where', 'range': [1455, 1461], 'children': []}, {'type': 'Argument', 'name': 'data', 'range': [1464, 1483], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if not res', 'range': [1488, 1498], 'children': [{'type': 'UnaryExpression', 'name': 'not res', 'range': [1488, 1491], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1489, 1491], 'children': []}]}, {'type': 'ThrowStatement', 'name': 'raise ValueError', 'range': [1492, 1498], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_graph(res)', 'range': [1501, 1508], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_graph', 'range': [1502, 1507], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1506, 1507], 'children': []}]}]}]}]}]}
2025-01-08 10:20:43,985 - INFO - Completed main AST analysis flow
2025-01-08 10:20:43,986 - INFO - Successfully processed chunk
2025-01-08 10:20:45,041 - INFO - Step 5 result: {'type': 'Program', 'name': 'MainProgram', 'range': [2856, 2959], 'children': [{'type': 'ClassDecl', 'name': 'AsyncRedisExecutionEventBus', 'range': [2856, 2865], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus[ExecutionResult]', 'range': [2858, 2863], 'children': []}]}, {'type': 'VariableDecl', 'name': 'Model', 'range': [2866, 2869], 'children': [{'type': 'Assignment', 'name': '=', 'range': [2867, 2868], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [2868, 2868], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'event_bus_name', 'range': [2871, 2888], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2871, 2872], 'children': []}, {'type': 'Parameter', 'name': 'self', 'range': [2877, 2877], 'children': []}, {'type': 'ReturnType', 'name': '-> str', 'range': [2879, 2881], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2884, 2887], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2885, 2887], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'publish', 'range': [2890, 2912], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2894, 2894], 'children': []}, {'type': 'Parameter', 'name': 'res: ExecutionResult', 'range': [2896, 2898], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [2902, 2911], 'children': [{'type': 'CallExpression', 'name': 'self.publish_event', 'range': [2903, 2905], 'children': []}, {'type': 'Argument', 'name': 'res', 'range': [2907, 2907], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2909, 2910], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'listen', 'range': [2914, 2959], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2919, 2919], 'children': []}, {'type': 'Parameter', 'name': 'graph_id: str = "*"', 'range': [2921, 2925], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id: str = "*"', 'range': [2927, 2931], 'children': []}, {'type': 'ReturnType', 'name': '-> AsyncGenerator[ExecutionResult, None]', 'range': [2934, 2941], 'children': []}, {'type': 'AsyncForStatement', 'name': 'async for', 'range': [2944, 2958], 'children': [{'type': 'VariableDecl', 'name': 'execution_result', 'range': [2946, 2946], 'children': []}, {'type': 'CallExpression', 'name': 'self.listen_events', 'range': [2948, 2950], 'children': []}, {'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2952, 2953], 'children': []}, {'type': 'YieldStatement', 'name': 'yield', 'range': [2957, 2958], 'children': []}]}]}]}
2025-01-08 10:20:45,042 - INFO - Completed main AST analysis flow
2025-01-08 10:20:45,042 - INFO - Successfully processed chunk
2025-01-08 10:20:46,235 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [2752, 2855], 'children': [{'type': 'ClassDecl', 'name': 'RedisExecutionEventBus', 'range': [2752, 2765], 'children': [{'type': 'Inheritance', 'name': 'RedisEventBus[ExecutionResult]', 'range': [2754, 2759], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [2760, 2765], 'children': [{'type': 'FieldDecl', 'name': 'Model', 'range': [2762, 2764], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'event_bus_name', 'range': [2767, 2784], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2767, 2768], 'children': []}, {'type': 'FunctionSignature', 'name': '', 'range': [2770, 2778], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2773, 2774], 'children': []}, {'type': 'ReturnType', 'name': 'str', 'range': [2775, 2777], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2779, 2784], 'children': [{'type': 'ReturnStatement', 'name': '', 'range': [2780, 2784], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2781, 2783], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'publish', 'range': [2786, 2806], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2788, 2795], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2789, 2790], 'children': []}, {'type': 'Parameter', 'name': 'res', 'range': [2791, 2794], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [2792, 2794], 'children': []}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [2796, 2806], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [2797, 2806], 'children': [{'type': 'CallExpression', 'name': 'self.publish_event', 'range': [2797, 2805], 'children': [{'type': 'Argument', 'name': 'res', 'range': [2801, 2802], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2803, 2805], 'children': []}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'listen', 'range': [2808, 2853], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2810, 2837], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2812, 2813], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [2814, 2818], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2815, 2817], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2817, 2818], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [2820, 2824], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2821, 2823], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2823, 2824], 'children': []}]}, {'type': 'ReturnType', 'name': 'Generator[ExecutionResult, None, None]', 'range': [2827, 2836], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2838, 2853], 'children': [{'type': 'ForStatement', 'name': '', 'range': [2839, 2853], 'children': [{'type': 'VariableDecl', 'name': 'execution_result', 'range': [2840, 2841], 'children': []}, {'type': 'CallExpression', 'name': 'self.listen_events', 'range': [2842, 2848], 'children': [{'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2846, 2848], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2849, 2853], 'children': [{'type': 'YieldStatement', 'name': '', 'range': [2851, 2853], 'children': [{'type': 'Identifier', 'name': 'execution_result', 'range': [2852, 2853], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:46,235 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:49,780 - INFO - Step 5 result: {'type': 'Program', 'name': 'ExecutionQueue', 'range': [189, 291], 'children': [{'type': 'FunctionDecl', 'name': '__init__', 'range': [204, 222], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [211, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [211, 213], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [211, 211], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [213, 213], 'children': []}]}, {'type': 'CallExpression', 'name': '(', 'range': [215, 221], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [215, 219], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [215, 217], 'children': [{'type': 'Identifier', 'name': 'Manager', 'range': [215, 215], 'children': []}]}, {'type': 'Identifier', 'name': 'Queue', 'range': [219, 219], 'children': []}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'add', 'range': [224, 249], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [238, 245], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [238, 242], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [238, 238], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [240, 240], 'children': []}, {'type': 'Identifier', 'name': 'put', 'range': [242, 242], 'children': []}]}, {'type': 'Identifier', 'name': 'execution', 'range': [244, 244], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [247, 248], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [248, 248], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'get', 'range': [251, 269], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [261, 268], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [262, 268], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [262, 266], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [262, 262], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [264, 264], 'children': []}, {'type': 'Identifier', 'name': 'get', 'range': [266, 266], 'children': []}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'empty', 'range': [271, 289], 'children': [{'type': 'ReturnStatement', 'name': 'return', 'range': [281, 288], 'children': [{'type': 'CallExpression', 'name': '(', 'range': [282, 288], 'children': [{'type': 'MemberExpression', 'name': '.', 'range': [282, 286], 'children': [{'type': 'Identifier', 'name': 'self', 'range': [282, 282], 'children': []}, {'type': 'Identifier', 'name': 'queue', 'range': [284, 284], 'children': []}, {'type': 'Identifier', 'name': 'empty', 'range': [286, 286], 'children': []}]}]}]}]}]}
2025-01-08 10:20:49,780 - INFO - Completed main AST analysis flow
2025-01-08 10:20:49,781 - INFO - Successfully processed chunk
2025-01-08 10:20:50,780 - INFO - Step 4 result: {'type': 'Program', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'FunctionDecl', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1271, 1271], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1272, 1272], 'children': []}, {'type': 'Identifier', 'name': 'upsert_execution_output', 'range': [1273, 1273], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1276, 1278], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1276, 1276], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1278, 1278], 'children': []}]}, {'type': 'Parameter', 'name': 'output_name', 'range': [1281, 1283], 'children': [{'type': 'Identifier', 'name': 'output_name', 'range': [1281, 1281], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1283, 1283], 'children': []}]}, {'type': 'Parameter', 'name': 'output_data', 'range': [1286, 1288], 'children': [{'type': 'Identifier', 'name': 'output_data', 'range': [1286, 1286], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1288, 1288], 'children': []}]}, {'type': 'ReturnType', 'name': 'None', 'range': [1292, 1294], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [1294, 1294], 'children': []}]}, {'type': 'Docstring', 'name': '""" \\n     Insert AgentNodeExecutionInputOutput record for as one of AgentNodeExecution.Output. \\n     """', 'range': [1297, 1299], 'children': []}, {'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create(data={...})', 'range': [1301, 1337], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1301, 1301], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecutionInputOutput.prisma().create', 'range': [1302, 1337], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecutionInputOutput', 'range': [1302, 1302], 'children': []}, {'type': 'CallExpression', 'name': 'prisma', 'range': [1304, 1304], 'children': []}, {'type': 'Identifier', 'name': 'create', 'range': [1308, 1308], 'children': []}, {'type': 'ObjectExpression', 'name': 'data={...}', 'range': [1311, 1335], 'children': [{'type': 'Property', 'name': '"name": output_name', 'range': [1315, 1317], 'children': [{'type': 'Literal', 'name': '"name"', 'range': [1315, 1315], 'children': []}, {'type': 'Identifier', 'name': 'output_name', 'range': [1317, 1317], 'children': []}]}, {'type': 'Property', 'name': '"data": json.dumps(output_data)', 'range': [1320, 1327], 'children': [{'type': 'Literal', 'name': '"data"', 'range': [1320, 1320], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1322, 1327], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1322, 1322], 'children': []}, {'type': 'Identifier', 'name': 'dumps', 'range': [1324, 1324], 'children': []}, {'type': 'Identifier', 'name': 'output_data', 'range': [1326, 1326], 'children': []}]}]}, {'type': 'Property', 'name': '"referencedByOutputExecId": node_exec_id', 'range': [1330, 1332], 'children': [{'type': 'Literal', 'name': '"referencedByOutputExecId"', 'range': [1330, 1330], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1332, 1332], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:50,780 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:51,299 - INFO - Step 5 result: {'type': 'Program', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'FunctionDecl', 'name': 'parse_execution_output', 'range': [1952, 2162], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [1954, 1962], 'children': [{'type': 'Parameter', 'name': 'output', 'range': [1955, 1957], 'children': []}, {'type': 'Parameter', 'name': 'name', 'range': [1959, 1961], 'children': []}]}, {'type': 'ReturnType', 'name': 'returnType', 'range': [1963, 1967], 'children': []}, {'type': 'BlockStatement', 'name': 'body', 'range': [1969, 2161], 'children': [{'type': 'Comment', 'name': 'comment', 'range': [1970, 1979], 'children': []}, {'type': 'VariableDeclaration', 'name': 'output_name, output_data', 'range': [1980, 1985], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [1987, 1996], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1988, 1991], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1994, 1995], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1998, 2060], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1999, 2005], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2008, 2021], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2023, 2043], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2024, 2038], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2041, 2042], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2044, 2059], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2062, 2107], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2063, 2069], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2072, 2083], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2084, 2101], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2085, 2096], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2099, 2100], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2102, 2106], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2109, 2157], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2110, 2116], 'children': []}, {'type': 'VariableDeclaration', 'name': 'index', 'range': [2119, 2130], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [2131, 2154], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [2132, 2144], 'children': []}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2147, 2153], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2155, 2156], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [2159, 2160], 'children': []}]}]}]}
2025-01-08 10:20:51,299 - INFO - Completed main AST analysis flow
2025-01-08 10:20:51,300 - INFO - Successfully processed chunk
2025-01-08 10:20:52,042 - INFO - Step 4 result: {'type': 'Program', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'FunctionDecl', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1340, 1344], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1341, 1344], 'children': []}, {'type': 'Identifier', 'name': 'update_graph_execution_start_time', 'range': [1342, 1371], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1344, 1365], 'children': [{'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1344, 1356], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1346, 1349], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [1349, 1399], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [1350, 1398], 'children': [{'type': 'AwaitExpression', 'name': '', 'range': [1350, 1397], 'children': [{'type': 'CallExpression', 'name': '', 'range': [1351, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1351, 1357], 'children': [{'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [1351, 1369], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [1353, 1359], 'children': []}]}, {'type': 'CallExpression', 'name': '', 'range': [1357, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1357, 1363], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1357, 1363], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1363, 1394], 'children': [{'type': 'Property', 'name': 'where', 'range': [1360, 1366], 'children': [{'type': 'Identifier', 'name': 'where', 'range': [1360, 1364], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1362, 1366], 'children': [{'type': 'Property', 'name': 'id', 'range': [1363, 1365], 'children': [{'type': 'Literal', 'name': 'id', 'range': [1363, 1365], 'children': []}, {'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1365, 1377], 'children': []}]}]}]}, {'type': 'Property', 'name': 'data', 'range': [1369, 1394], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1369, 1373], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1371, 1394], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1373, 1378], 'children': [{'type': 'Literal', 'name': 'executionStatus', 'range': [1373, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1375, 1377], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1375, 1389], 'children': []}, {'type': 'Identifier', 'name': 'RUNNING', 'range': [1377, 1384], 'children': []}]}]}, {'type': 'Property', 'name': 'startedAt', 'range': [1380, 1392], 'children': [{'type': 'Literal', 'name': 'startedAt', 'range': [1380, 1389], 'children': []}, {'type': 'CallExpression', 'name': '', 'range': [1382, 1391], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1382, 1388], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1382, 1390], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1384, 1387], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1388, 1391], 'children': [{'type': 'Property', 'name': 'tz', 'range': [1387, 1390], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1387, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1389, 1390], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1389, 1397], 'children': []}, {'type': 'Identifier', 'name': 'utc', 'range': [1390, 1393], 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
2025-01-08 10:20:52,042 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:52,229 - INFO - Step 2 result: {'type': 'Program', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'FunctionDef', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'Arguments', 'name': '', 'range': [2165, 2169], 'children': [{'type': 'Argument', 'name': 'data', 'range': [2166, 2168], 'children': []}]}, {'type': 'ReturnType', 'name': 'BlockInput', 'range': [2170, 2172], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [2175, 2177], 'children': []}, {'type': 'Comment', 'name': '', 'range': [2180, 2198], 'children': []}, {'type': 'Assignment', 'name': 'items', 'range': [2200, 2209], 'children': [{'type': 'Call', 'name': 'list', 'range': [2202, 2209], 'children': [{'type': 'Attribute', 'name': 'items', 'range': [2204, 2208], 'children': [{'type': 'Name', 'name': 'data', 'range': [2204, 2205], 'children': []}]}]}]}, {'type': 'For', 'name': '', 'range': [2212, 2340], 'children': [{'type': 'Targets', 'name': '', 'range': [2213, 2215], 'children': [{'type': 'Name', 'name': 'key', 'range': [2213, 2214], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2215, 2215], 'children': []}]}, {'type': 'Iter', 'name': 'items', 'range': [2217, 2217], 'children': []}, {'type': 'If', 'name': '', 'range': [2220, 2227], 'children': [{'type': 'Test', 'name': '', 'range': [2221, 2225], 'children': [{'type': 'NotIn', 'name': '', 'range': [2222, 2224], 'children': [{'type': 'Name', 'name': 'LIST_SPLIT', 'range': [2221, 2221], 'children': []}, {'type': 'Name', 'name': 'key', 'range': [2224, 2224], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2226, 2227], 'children': [{'type': 'Continue', 'name': '', 'range': [2227, 2227], 'children': []}]}]}, {'type': 'Assignment', 'name': 'name, index', 'range': [2229, 2239], 'children': [{'type': 'Call', 'name': 'split', 'range': [2233, 2239], 'children': [{'type': 'Name', 'name': 'key', 'range': [2233, 2234], 'children': []}, {'type': 'Name', 'name': 'LIST_SPLIT', 'range': [2237, 2237], 'children': []}]}]}, {'type': 'If', 'name': '', 'range': [2240, 2254], 'children': [{'type': 'Test', 'name': '', 'range': [2241, 2247], 'children': [{'type': 'Not', 'name': '', 'range': [2241, 2241], 'children': []}, {'type': 'Call', 'name': 'isdigit', 'range': [2243, 2247], 'children': [{'type': 'Name', 'name': 'index', 'range': [2243, 2244], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2248, 2254], 'children': [{'type': 'Raise', 'name': '', 'range': [2249, 2254], 'children': [{'type': 'Call', 'name': 'ValueError', 'range': [2250, 2254], 'children': [{'type': 'FormattedValue', 'name': '', 'range': [2252, 2253], 'children': []}]}]}]}]}, {'type': 'Assignment', 'name': 'data[name]', 'range': [2257, 2271], 'children': [{'type': 'Call', 'name': 'get', 'range': [2262, 2271], 'children': [{'type': 'Name', 'name': 'data', 'range': [2262, 2263], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2266, 2266], 'children': []}, {'type': 'List', 'name': '', 'range': [2268, 2270], 'children': []}]}]}, {'type': 'If', 'name': '', 'range': [2272, 2340], 'children': [{'type': 'Test', 'name': '', 'range': [2273, 2286], 'children': [{'type': 'Compare', 'name': '', 'range': [2273, 2286], 'children': [{'type': 'Call', 'name': 'int', 'range': [2273, 2277], 'children': [{'type': 'Name', 'name': 'index', 'range': [2275, 2276], 'children': []}]}, {'type': 'GtE', 'name': '', 'range': [2277, 2278], 'children': []}, {'type': 'Call', 'name': 'len', 'range': [2279, 2286], 'children': [{'type': 'Subscript', 'name': '', 'range': [2281, 2285], 'children': [{'type': 'Name', 'name': 'data', 'range': [2281, 2282], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2283, 2284], 'children': []}]}]}]}]}, {'type': 'Body', 'name': '', 'range': [2287, 2340], 'children': [{'type': 'Comment', 'name': '', 'range': [2288, 2297], 'children': []}, {'type': 'Assignment', 'name': 'data[name]', 'range': [2299, 2327], 'children': [{'type': 'Call', 'name': 'extend', 'range': [2303, 2327], 'children': [{'type': 'Name', 'name': 'data', 'range': [2299, 2300], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2301, 2302], 'children': []}, {'type': 'BinOp', 'name': '', 'range': [2306, 2326], 'children': [{'type': 'List', 'name': '', 'range': [2306, 2308], 'children': []}, {'type': 'Mult', 'name': '', 'range': [2309, 2309], 'children': []}, {'type': 'BinOp', 'name': '', 'range': [2310, 2325], 'children': [{'type': 'Call', 'name': 'int', 'range': [2310, 2314], 'children': [{'type': 'Name', 'name': 'index', 'range': [2312, 2313], 'children': []}]}, {'type': 'Sub', 'name': '', 'range': [2315, 2315], 'children': []}, {'type': 'Call', 'name': 'len', 'range': [2316, 2323], 'children': [{'type': 'Subscript', 'name': '', 'range': [2318, 2322], 'children': [{'type': 'Name', 'name': 'data', 'range': [2318, 2319], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2320, 2321], 'children': []}]}]}, {'type': 'Add', 'name': '', 'range': [2323, 2323], 'children': []}, {'type': 'Num', 'name': '1', 'range': [2324, 2325], 'children': []}]}]}]}]}, {'type': 'Assignment', 'name': 'data[name][int(index)]', 'range': [2328, 2340], 'children': [{'type': 'Subscript', 'name': '', 'range': [2328, 2338], 'children': [{'type': 'Name', 'name': 'data', 'range': [2328, 2329], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2330, 2331], 'children': []}, {'type': 'Call', 'name': 'int', 'range': [2333, 2337], 'children': [{'type': 'Name', 'name': 'index', 'range': [2335, 2336], 'children': []}]}]}, {'type': 'Name', 'name': 'value', 'range': [2339, 2340], 'children': []}]}]}]}]}, {'type': 'Comment', 'name': '', 'range': [2342, 2360], 'children': []}, {'type': 'For', 'name': '', 'range': [2362, 2414], 'children': [{'type': 'Targets', 'name': '', 'range': [2363, 2365], 'children': [{'type': 'Name', 'name': 'key', 'range': [2363, 2364], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2365, 2365], 'children': []}]}, {'type': 'Iter', 'name': 'items', 'range': [2367, 2367], 'children': []}, {'type': 'If', 'name': '', 'range': [2370, 2377], 'children': [{'type': 'Test', 'name': '', 'range': [2371, 2375], 'children': [{'type': 'NotIn', 'name': '', 'range': [2372, 2374], 'children': [{'type': 'Name', 'name': 'DICT_SPLIT', 'range': [2371, 2371], 'children': []}, {'type': 'Name', 'name': 'key', 'range': [2374, 2374], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2376, 2377], 'children': [{'type': 'Continue', 'name': '', 'range': [2377, 2377], 'children': []}]}]}, {'type': 'Assignment', 'name': 'name, index', 'range': [2379, 2389], 'children': [{'type': 'Call', 'name': 'split', 'range': [2383, 2389], 'children': [{'type': 'Name', 'name': 'key', 'range': [2383, 2384], 'children': []}, {'type': 'Name', 'name': 'DICT_SPLIT', 'range': [2387, 2387], 'children': []}]}]}, {'type': 'Assignment', 'name': 'data[name]', 'range': [2390, 2404], 'children': [{'type': 'Call', 'name': 'get', 'range': [2395, 2404], 'children': [{'type': 'Name', 'name': 'data', 'range': [2395, 2396], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2399, 2399], 'children': []}, {'type': 'Dict', 'name': '', 'range': [2401, 2403], 'children': []}]}]}, {'type': 'Assignment', 'name': 'data[name][index]', 'range': [2405, 2414], 'children': [{'type': 'Subscript', 'name': '', 'range': [2405, 2412], 'children': [{'type': 'Name', 'name': 'data', 'range': [2405, 2406], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2407, 2408], 'children': []}, {'type': 'Name', 'name': 'index', 'range': [2410, 2411], 'children': []}]}, {'type': 'Name', 'name': 'value', 'range': [2413, 2414], 'children': []}]}]}, {'type': 'Comment', 'name': '', 'range': [2416, 2434], 'children': []}, {'type': 'For', 'name': '', 'range': [2436, 2504], 'children': [{'type': 'Targets', 'name': '', 'range': [2437, 2439], 'children': [{'type': 'Name', 'name': 'key', 'range': [2437, 2438], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2439, 2439], 'children': []}]}, {'type': 'Iter', 'name': 'items', 'range': [2441, 2441], 'children': []}, {'type': 'If', 'name': '', 'range': [2444, 2451], 'children': [{'type': 'Test', 'name': '', 'range': [2445, 2449], 'children': [{'type': 'NotIn', 'name': '', 'range': [2446, 2448], 'children': [{'type': 'Name', 'name': 'OBJC_SPLIT', 'range': [2445, 2445], 'children': []}, {'type': 'Name', 'name': 'key', 'range': [2448, 2448], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2450, 2451], 'children': [{'type': 'Continue', 'name': '', 'range': [2451, 2451], 'children': []}]}]}, {'type': 'Assignment', 'name': 'name, index', 'range': [2453, 2463], 'children': [{'type': 'Call', 'name': 'split', 'range': [2457, 2463], 'children': [{'type': 'Name', 'name': 'key', 'range': [2457, 2458], 'children': []}, {'type': 'Name', 'name': 'OBJC_SPLIT', 'range': [2461, 2461], 'children': []}]}]}, {'type': 'If', 'name': '', 'range': [2464, 2482], 'children': [{'type': 'Test', 'name': '', 'range': [2465, 2480], 'children': [{'type': 'Or', 'name': '', 'range': [2469, 2469], 'children': []}, {'type': 'NotIn', 'name': '', 'range': [2466, 2468], 'children': [{'type': 'Name', 'name': 'name', 'range': [2465, 2466], 'children': []}, {'type': 'Name', 'name': 'data', 'range': [2468, 2468], 'children': []}]}, {'type': 'Not', 'name': '', 'range': [2470, 2470], 'children': []}, {'type': 'Call', 'name': 'isinstance', 'range': [2471, 2480], 'children': [{'type': 'Subscript', 'name': '', 'range': [2473, 2477], 'children': [{'type': 'Name', 'name': 'data', 'range': [2473, 2474], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2475, 2476], 'children': []}]}, {'type': 'Name', 'name': 'object', 'range': [2478, 2479], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2481, 2482], 'children': [{'type': 'Assignment', 'name': 'data[name]', 'range': [2482, 2492], 'children': [{'type': 'Call', 'name': 'MockObject', 'range': [2487, 2492], 'children': [{'type': 'Name', 'name': 'mock', 'range': [2487, 2488], 'children': []}]}]}]}]}, {'type': 'Assignment', 'name': 'setattr(data[name], index, value)', 'range': [2493, 2504], 'children': [{'type': 'Call', 'name': 'setattr', 'range': [2493, 2504], 'children': [{'type': 'Subscript', 'name': '', 'range': [2495, 2499], 'children': [{'type': 'Name', 'name': 'data', 'range': [2495, 2496], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2497, 2498], 'children': []}]}, {'type': 'Name', 'name': 'index', 'range': [2500, 2501], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2502, 2503], 'children': []}]}]}]}, {'type': 'Return', 'name': '', 'range': [2506, 2507], 'children': [{'type': 'Name', 'name': 'data', 'range': [2507, 2507], 'children': []}]}]}]}
2025-01-08 10:20:52,229 - INFO - Starting Step 3: AST simplification
2025-01-08 10:20:54,980 - INFO - Step 5 result: {'type': 'Program', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'FunctionDecl', 'name': 'update_node_execution_stats', 'range': [1510, 1565], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1510, 1514]}, {'type': 'Keyword', 'name': 'def', 'range': [1511, 1514]}, {'type': 'Identifier', 'name': 'update_node_execution_stats', 'range': [1512, 1540]}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1514, 1526], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1514, 1526]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1516, 1519]}]}, {'type': 'Parameter', 'name': 'stats', 'range': [1518, 1526], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1518, 1523]}, {'type': 'TypeAnnotation', 'name': 'dict', 'range': [1520, 1526], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1522, 1525]}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1524, 1527]}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [1528, 1565], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1529, 1534]}, {'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1530, 1537], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1530, 1547]}, {'type': 'Identifier', 'name': 'prisma', 'range': [1532, 1538]}]}, {'type': 'CallExpression', 'name': 'update', 'range': [1536, 1562], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1536, 1542]}, {'type': 'ObjectExpression', 'name': 'where', 'range': [1539, 1545], 'children': [{'type': 'Property', 'name': 'id', 'range': [1542, 1545], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [1542, 1545]}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1544, 1556]}]}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1548, 1559], 'children': [{'type': 'Property', 'name': 'stats', 'range': [1551, 1559], 'children': [{'type': 'Literal', 'name': '"stats"', 'range': [1551, 1557]}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1553, 1558], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1553, 1557]}, {'type': 'Identifier', 'name': 'dumps', 'range': [1555, 1560]}]}, {'type': 'Identifier', 'name': 'stats', 'range': [1557, 1562]}]}]}]}]}]}]}]}
2025-01-08 10:20:54,980 - INFO - Completed main AST analysis flow
2025-01-08 10:20:54,982 - INFO - Successfully processed chunk
2025-01-08 10:20:58,676 - INFO - Step 4 result: {'type': 'Program', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'FunctionDecl', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [2510, 2514], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [2511, 2514], 'children': []}, {'type': 'FunctionName', 'name': 'get_latest_execution', 'range': [2512, 2532], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [2513, 2521], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2514, 2517], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2516, 2519], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2518, 2521], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2520, 2523], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult | None', 'range': [2522, 2527], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [2528, 2613], 'children': [{'type': 'VariableDeclaration', 'name': 'execution', 'range': [2529, 2536], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [2531, 2536], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [2532, 2536], 'children': []}]}]}, {'type': 'CallExpression', 'name': 'find_first', 'range': [2538, 2596], 'children': [{'type': 'Argument', 'name': 'where', 'range': [2541, 2579], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2543, 2579], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2545, 2548], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2547, 2550], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2550, 2553], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2552, 2555], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2555, 2564], 'children': [{'type': 'ObjectExpression', 'name': 'executionStatus', 'range': [2557, 2563], 'children': [{'type': 'Property', 'name': 'not', 'range': [2558, 2561], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2560, 2563], 'children': []}]}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [2566, 2573], 'children': [{'type': 'ObjectExpression', 'name': 'executionData', 'range': [2568, 2572], 'children': [{'type': 'Property', 'name': 'not', 'range': [2569, 2572], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2571, 2574], 'children': []}]}]}]}]}]}, {'type': 'Argument', 'name': 'order', 'range': [2582, 2589], 'children': [{'type': 'ObjectExpression', 'name': 'order', 'range': [2584, 2588], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [2585, 2588], 'children': [{'type': 'StringLiteral', 'name': 'desc', 'range': [2587, 2590], 'children': []}]}]}]}, {'type': 'Argument', 'name': 'include', 'range': [2591, 2595], 'children': [{'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2593, 2596], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2598, 2605], 'children': [{'type': 'Condition', 'name': 'not execution', 'range': [2599, 2601], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [2599, 2602], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2600, 2603], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'block', 'range': [2602, 2605], 'children': [{'type': 'ReturnStatement', 'name': 'return None', 'range': [2603, 2605], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2604, 2607], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_db(execution)', 'range': [2606, 2613], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': []}, {'type': 'Argument', 'name': 'execution', 'range': [2611, 2613], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2611, 2614], 'children': []}]}]}]}]}]}]}
2025-01-08 10:20:58,676 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:20:59,856 - INFO - Step 5 result: {'type': 'Program', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'FunctionDecl', 'name': 'from_db', 'range': [480, 744], 'children': [{'type': 'Decorator', 'name': '@staticmethod', 'range': [480, 481], 'children': []}, {'type': 'FunctionSignature', 'name': 'from_db', 'range': [483, 490], 'children': [{'type': 'Parameter', 'name': 'execution', 'range': [486, 488], 'children': []}]}, {'type': 'FunctionBody', 'name': 'from_db', 'range': [491, 744], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [492, 531], 'children': [{'type': 'Condition', 'name': 'execution.executionData', 'range': [493, 495], 'children': []}, {'type': 'ThenBlock', 'name': 'then', 'range': [496, 531], 'children': [{'type': 'Comment', 'name': '# Execution that has been queued for execution will persist its data.', 'range': [498, 510], 'children': []}, {'type': 'Assignment', 'name': 'input_data = json.loads(execution.executionData, target_type=dict[str, Any])', 'range': [512, 530], 'children': []}]}]}, {'type': 'ElseStatement', 'name': 'else', 'range': [532, 582], 'children': [{'type': 'Comment', 'name': '# For incomplete execution, executionData will not be yet available.', 'range': [535, 546], 'children': []}, {'type': 'Assignment', 'name': 'input_data: BlockInput = defaultdict()', 'range': [548, 554], 'children': []}, {'type': 'ForStatement', 'name': 'for data in execution.Input or []:', 'range': [556, 582], 'children': [{'type': 'Assignment', 'name': 'input_data[data.name] = json.loads(data.data)', 'range': [567, 581], 'children': []}]}]}, {'type': 'Assignment', 'name': 'output_data: CompletedBlockOutput = defaultdict(list)', 'range': [584, 591], 'children': []}, {'type': 'ForStatement', 'name': 'for data in execution.Output or []:', 'range': [593, 622], 'children': [{'type': 'Assignment', 'name': 'output_data[data.name].append(json.loads(data.data))', 'range': [604, 621], 'children': []}]}, {'type': 'Assignment', 'name': 'graph_execution: AgentGraphExecution | None = execution.AgentGraphExecution', 'range': [624, 633], 'children': []}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult', 'range': [635, 742], 'children': [{'type': 'Argument', 'name': 'graph_id = graph_execution.agentGraphId if graph_execution else ""', 'range': [639, 647], 'children': []}, {'type': 'Argument', 'name': 'graph_version = graph_execution.agentGraphVersion if graph_execution else 0', 'range': [650, 658], 'children': []}, {'type': 'Argument', 'name': 'graph_exec_id = execution.agentGraphExecutionId', 'range': [661, 666], 'children': []}, {'type': 'Argument', 'name': 'block_id = execution.AgentNode.agentBlockId if execution.AgentNode else ""', 'range': [669, 680], 'children': []}, {'type': 'Argument', 'name': 'node_exec_id = execution.id', 'range': [683, 688], 'children': []}, {'type': 'Argument', 'name': 'node_id = execution.agentNodeId', 'range': [690, 695], 'children': []}, {'type': 'Argument', 'name': 'status = execution.executionStatus', 'range': [697, 702], 'children': []}, {'type': 'Argument', 'name': 'input_data = input_data', 'range': [704, 707], 'children': []}, {'type': 'Argument', 'name': 'output_data = output_data', 'range': [709, 712], 'children': []}, {'type': 'Argument', 'name': 'add_time = execution.addedTime', 'range': [714, 719], 'children': []}, {'type': 'Argument', 'name': 'queue_time = execution.queuedTime', 'range': [721, 726], 'children': []}, {'type': 'Argument', 'name': 'start_time = execution.startedTime', 'range': [728, 733], 'children': []}, {'type': 'Argument', 'name': 'end_time = execution.endedTime', 'range': [735, 740], 'children': []}]}]}]}]}
2025-01-08 10:20:59,856 - INFO - Completed main AST analysis flow
2025-01-08 10:20:59,856 - INFO - Successfully processed chunk
2025-01-08 10:21:02,143 - INFO - Step 3 result: {'type': 'Program', 'name': 'ExecutionResult', 'range': [292, 479], 'children': [{'type': 'ClassDeclaration', 'name': 'ExecutionResult', 'range': [292, 356], 'children': [{'type': 'PropertyDeclaration', 'name': 'graph_id', 'range': [299, 301], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [301, 301], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'graph_version', 'range': [303, 305], 'children': [{'type': 'TypeAnnotation', 'name': 'int', 'range': [305, 305], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'graph_exec_id', 'range': [307, 309], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [309, 309], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'node_exec_id', 'range': [311, 313], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [313, 313], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'node_id', 'range': [315, 317], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [317, 317], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'block_id', 'range': [319, 321], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [321, 321], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'status', 'range': [323, 325], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [325, 325], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'input_data', 'range': [327, 329], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [329, 329], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'output_data', 'range': [331, 333], 'children': [{'type': 'TypeAnnotation', 'name': 'CompletedBlockOutput', 'range': [333, 333], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'add_time', 'range': [335, 337], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [337, 337], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'queue_time', 'range': [339, 343], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [341, 341], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [343, 343], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'start_time', 'range': [345, 349], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [347, 347], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [349, 349], 'children': []}]}, {'type': 'PropertyDeclaration', 'name': 'end_time', 'range': [351, 355], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [353, 353], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [355, 355], 'children': []}]}]}, {'type': 'MethodDeclaration', 'name': 'from_graph', 'range': [358, 478], 'children': [{'type': 'Parameter', 'name': 'graph', 'range': [364, 366], 'children': [{'type': 'TypeAnnotation', 'name': 'AgentGraphExecution', 'range': [366, 366], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [370, 477], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult', 'range': [371, 477], 'children': [{'type': 'Argument', 'name': 'graph_id', 'range': [374, 378], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphId', 'range': [376, 378], 'children': []}]}, {'type': 'Argument', 'name': 'graph_version', 'range': [381, 385], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphVersion', 'range': [383, 385], 'children': []}]}, {'type': 'Argument', 'name': 'graph_exec_id', 'range': [388, 392], 'children': [{'type': 'MemberExpression', 'name': 'graph.id', 'range': [390, 392], 'children': []}]}, {'type': 'Argument', 'name': 'node_exec_id', 'range': [395, 397], 'children': [{'type': 'StringLiteral', 'name': '""', 'range': [397, 397], 'children': []}]}, {'type': 'Argument', 'name': 'node_id', 'range': [400, 402], 'children': [{'type': 'StringLiteral', 'name': '""', 'range': [402, 402], 'children': []}]}, {'type': 'Argument', 'name': 'block_id', 'range': [405, 407], 'children': [{'type': 'StringLiteral', 'name': '""', 'range': [407, 407], 'children': []}]}, {'type': 'Argument', 'name': 'status', 'range': [410, 414], 'children': [{'type': 'MemberExpression', 'name': 'graph.executionStatus', 'range': [412, 414], 'children': []}]}, {'type': 'Comment', 'name': '# TODO: Populate input_data & output_data from AgentNodeExecutions', 'range': [417, 426], 'children': []}, {'type': 'Comment', 'name': '# Input & Output comes AgentInputBlock & AgentOutputBlock.', 'range': [427, 436], 'children': []}, {'type': 'Argument', 'name': 'input_data', 'range': [437, 440], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [439, 440], 'children': []}]}, {'type': 'Argument', 'name': 'output_data', 'range': [443, 446], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [445, 446], 'children': []}]}, {'type': 'Argument', 'name': 'add_time', 'range': [449, 453], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [451, 453], 'children': []}]}, {'type': 'Argument', 'name': 'queue_time', 'range': [456, 460], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [458, 460], 'children': []}]}, {'type': 'Argument', 'name': 'start_time', 'range': [463, 467], 'children': [{'type': 'MemberExpression', 'name': 'graph.startedAt', 'range': [465, 467], 'children': []}]}, {'type': 'Argument', 'name': 'end_time', 'range': [470, 474], 'children': [{'type': 'MemberExpression', 'name': 'graph.updatedAt', 'range': [472, 474], 'children': []}]}]}]}]}]}
2025-01-08 10:21:02,143 - INFO - Starting Step 4: AST normalization
2025-01-08 10:21:09,134 - INFO - Step 5 result: {'type': 'Program', 'name': 'MainProgram', 'range': [0, 114], 'children': [{'type': 'ImportDeclaration', 'name': 'defaultdict', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'collections', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'defaultdict', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'datetime, timezone', 'range': [5, 11], 'children': [{'type': 'FromImport', 'name': 'datetime', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'datetime, timezone', 'range': [7, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Manager', 'range': [12, 16], 'children': [{'type': 'FromImport', 'name': 'multiprocessing', 'range': [12, 13], 'children': []}, {'type': 'Import', 'name': 'Manager', 'range': [14, 15], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [17, 29], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [17, 18], 'children': []}, {'type': 'Import', 'name': 'Any, AsyncGenerator, Generator, Generic, TypeVar', 'range': [19, 28], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentExecutionStatus', 'range': [31, 37], 'children': [{'type': 'FromImport', 'name': 'prisma.enums', 'range': [31, 34], 'children': []}, {'type': 'Import', 'name': 'AgentExecutionStatus', 'range': [35, 36], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [38, 55], 'children': [{'type': 'FromImport', 'name': 'prisma.models', 'range': [38, 41], 'children': []}, {'type': 'Import', 'name': 'AgentGraphExecution, AgentNodeExecution, AgentNodeExecutionInputOutput', 'range': [42, 54], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BaseModel', 'range': [56, 60], 'children': [{'type': 'FromImport', 'name': 'pydantic', 'range': [56, 57], 'children': []}, {'type': 'Import', 'name': 'BaseModel', 'range': [58, 59], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [62, 74], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [62, 67], 'children': []}, {'type': 'Import', 'name': 'BlockData, BlockInput, CompletedBlockOutput', 'range': [68, 73], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [75, 85], 'children': [{'type': 'FromImport', 'name': 'backend.data.includes', 'range': [75, 80], 'children': []}, {'type': 'Import', 'name': 'EXECUTION_RESULT_INCLUDE, GRAPH_EXECUTION_INCLUDE', 'range': [81, 84], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [86, 96], 'children': [{'type': 'FromImport', 'name': 'backend.data.queue', 'range': [86, 91], 'children': []}, {'type': 'Import', 'name': 'AsyncRedisEventBus, RedisEventBus', 'range': [92, 95], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'json, mock', 'range': [97, 105], 'children': [{'type': 'FromImport', 'name': 'backend.util', 'range': [97, 100], 'children': []}, {'type': 'Import', 'name': 'json, mock', 'range': [101, 104], 'children': []}]}, {'type': 'ImportDeclaration', 'name': 'Config', 'range': [106, 114], 'children': [{'type': 'FromImport', 'name': 'backend.util.settings', 'range': [106, 111], 'children': []}, {'type': 'Import', 'name': 'Config', 'range': [112, 113], 'children': []}]}]}
2025-01-08 10:21:09,134 - INFO - Completed main AST analysis flow
2025-01-08 10:21:09,135 - INFO - Successfully processed chunk
2025-01-08 10:21:11,768 - INFO - Step 2 result: {'type': 'Program', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1566, 1571], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1567, 1570], 'children': []}, {'type': 'FunctionName', 'name': 'update_execution_status', 'range': [1568, 1588], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1569, 1604], 'children': [{'type': 'Parameter', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': [{'type': 'ParameterName', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1572, 1574], 'children': []}]}, {'type': 'Parameter', 'name': 'status', 'range': [1576, 1579], 'children': [{'type': 'ParameterName', 'name': 'status', 'range': [1576, 1579], 'children': []}, {'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [1577, 1579], 'children': []}]}, {'type': 'Parameter', 'name': 'execution_data', 'range': [1581, 1587], 'children': [{'type': 'ParameterName', 'name': 'execution_data', 'range': [1581, 1587], 'children': []}, {'type': 'TypeAnnotation', 'name': 'BlockInput | None', 'range': [1582, 1587], 'children': []}]}, {'type': 'Parameter', 'name': 'stats', 'range': [1590, 1601], 'children': [{'type': 'ParameterName', 'name': 'stats', 'range': [1590, 1601], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any] | None', 'range': [1591, 1601], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1605, 1607], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1608, 1845], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [1610, 1628], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1611, 1621], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1611, 1614], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1611, 1614], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1614, 1616], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1614, 1616], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1615, 1616], 'children': []}]}]}, {'type': 'BinaryExpression', 'name': 'and', 'range': [1617, 1621], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1617, 1621], 'children': []}, {'type': 'NullLiteral', 'name': 'None', 'range': [1619, 1621], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1622, 1628], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1623, 1627], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1624, 1627], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1624, 1627], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1625, 1627], 'children': [{'type': 'StringLiteral', 'name': '"Execution data must be provided when queuing an execution."', 'range': [1626, 1627], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'VariableDeclarator', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'Identifier', 'name': 'now', 'range': [1630, 1642], 'children': []}, {'type': 'CallExpression', 'name': 'datetime.now', 'range': [1632, 1641], 'children': [{'type': 'MemberExpression', 'name': 'datetime.now', 'range': [1632, 1634], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1632, 1634], 'children': []}, {'type': 'Property', 'name': 'now', 'range': [1633, 1634], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1635, 1641], 'children': [{'type': 'AssignmentExpression', 'name': 'tz=', 'range': [1636, 1640], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1636, 1640], 'children': []}, {'type': 'MemberExpression', 'name': 'timezone.utc', 'range': [1638, 1640], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1638, 1640], 'children': []}, {'type': 'Property', 'name': 'utc', 'range': [1639, 1640], 'children': []}]}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'VariableDeclarator', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1643, 1784], 'children': []}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1645, 1784], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1647, 1654], 'children': [{'type': 'Identifier', 'name': 'executionStatus', 'range': [1647, 1654], 'children': []}, {'type': 'Identifier', 'name': 'status', 'range': [1653, 1654], 'children': []}]}, {'type': 'Property', 'name': 'queuedTime', 'range': [1658, 1676], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1658, 1676], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1666, 1676], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1667, 1670], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1667, 1670], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1670, 1672], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1670, 1672], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1671, 1672], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1673, 1675], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [1673, 1675], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1673, 1675], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1674, 1675], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1676, 1676], 'children': []}]}]}, {'type': 'Property', 'name': 'startedTime', 'range': [1679, 1697], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1679, 1697], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1687, 1697], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1688, 1691], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1688, 1691], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.RUNNING', 'range': [1691, 1693], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1691, 1693], 'children': []}, {'type': 'Property', 'name': 'RUNNING', 'range': [1692, 1693], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1694, 1696], 'children': [{'type': 'Property', 'name': 'startedTime', 'range': [1694, 1696], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1694, 1696], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1695, 1696], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1697, 1697], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1700, 1718], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1700, 1718], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1708, 1718], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1709, 1712], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1709, 1712], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.FAILED', 'range': [1712, 1714], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1712, 1714], 'children': []}, {'type': 'Property', 'name': 'FAILED', 'range': [1713, 1714], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1715, 1717], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1715, 1717], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1715, 1717], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1716, 1717], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1718, 1718], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1721, 1739], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1721, 1739], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1729, 1739], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1730, 1733], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1730, 1733], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.COMPLETED', 'range': [1733, 1735], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1733, 1735], 'children': []}, {'type': 'Property', 'name': 'COMPLETED', 'range': [1734, 1735], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1736, 1738], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1736, 1738], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1736, 1738], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1737, 1738], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1739, 1739], 'children': []}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [1742, 1760], 'children': [{'type': 'Identifier', 'name': 'executionData', 'range': [1742, 1760], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1756, 1760], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1756, 1760], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1748, 1754], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1748, 1750], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1748, 1750], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1749, 1750], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1751, 1754], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1752, 1754], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1760, 1760], 'children': []}]}]}, {'type': 'Property', 'name': 'stats', 'range': [1763, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1763, 1781], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1777, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1777, 1781], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1769, 1775], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1769, 1771], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1769, 1771], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1770, 1771], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1772, 1775], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1773, 1775], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1781, 1781], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1787, 1823], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [1789, 1823], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().update', 'range': [1790, 1822], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1790, 1792], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1790, 1792], 'children': []}, {'type': 'Property', 'name': 'prisma', 'range': [1791, 1792], 'children': []}]}, {'type': 'CallExpression', 'name': 'prisma().update', 'range': [1793, 1822], 'children': [{'type': 'MemberExpression', 'name': 'prisma().update', 'range': [1793, 1796], 'children': [{'type': 'CallExpression', 'name': 'prisma', 'range': [1793, 1795], 'children': [{'type': 'Identifier', 'name': 'prisma', 'range': [1793, 1795], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1794, 1795], 'children': []}]}, {'type': 'Property', 'name': 'update', 'range': [1795, 1796], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1797, 1822], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [1799, 1806], 'children': [{'type': 'Property', 'name': 'id', 'range': [1802, 1805], 'children': [{'type': 'Identifier', 'name': 'id', 'range': [1802, 1805], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1804, 1805], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1808, 1811], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1808, 1811], 'children': []}]}, {'type': 'Comment', 'name': '# type: ignore', 'range': [1812, 1816], 'children': []}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [1819, 1820], 'children': []}]}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1824, 1835], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1825, 1827], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [1825, 1827], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1826, 1827], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1828, 1835], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1829, 1834], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1830, 1834], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1830, 1834], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1831, 1834], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Execution {node_exec_id} not found."', 'range': [1832, 1834], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1833, 1834], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1837, 1844], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1843], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1840], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [1838, 1840], 'children': []}, {'type': 'Property', 'name': 'from_db', 'range': [1839, 1840], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1841, 1843], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1842, 1843], 'children': []}]}]}]}]}]}]}
2025-01-08 10:21:11,769 - INFO - Starting Step 3: AST simplification
2025-01-08 10:21:13,683 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [2752, 2855], 'children': [{'type': 'ClassDecl', 'name': 'RedisExecutionEventBus', 'range': [2752, 2765], 'children': [{'type': 'Inheritance', 'name': 'RedisEventBus[ExecutionResult]', 'range': [2754, 2759], 'children': []}, {'type': 'ClassBody', 'name': '', 'range': [2760, 2765], 'children': [{'type': 'FieldDecl', 'name': 'Model', 'range': [2762, 2764], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'event_bus_name', 'range': [2767, 2784], 'children': [{'type': 'Decorator', 'name': '@property', 'range': [2767, 2768], 'children': []}, {'type': 'FunctionSignature', 'name': '', 'range': [2770, 2778], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2773, 2774], 'children': []}, {'type': 'ReturnType', 'name': 'str', 'range': [2775, 2777], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2779, 2784], 'children': [{'type': 'ReturnStatement', 'name': '', 'range': [2780, 2784], 'children': [{'type': 'MemberExpression', 'name': 'config.execution_event_bus_name', 'range': [2781, 2783], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'publish', 'range': [2786, 2806], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2788, 2795], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2789, 2790], 'children': []}, {'type': 'Parameter', 'name': 'res', 'range': [2791, 2794], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [2792, 2794], 'children': []}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [2796, 2806], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [2797, 2806], 'children': [{'type': 'CallExpression', 'name': 'self.publish_event', 'range': [2797, 2805], 'children': [{'type': 'Argument', 'name': 'res', 'range': [2801, 2802], 'children': []}, {'type': 'Argument', 'name': 'f"{res.graph_id}/{res.graph_exec_id}"', 'range': [2803, 2805], 'children': []}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'listen', 'range': [2808, 2853], 'children': [{'type': 'FunctionSignature', 'name': '', 'range': [2810, 2837], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [2812, 2813], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [2814, 2818], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2815, 2817], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2817, 2818], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [2820, 2824], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2821, 2823], 'children': []}, {'type': 'DefaultValue', 'name': '"*"', 'range': [2823, 2824], 'children': []}]}, {'type': 'ReturnType', 'name': 'Generator[ExecutionResult, None, None]', 'range': [2827, 2836], 'children': []}]}, {'type': 'FunctionBody', 'name': '', 'range': [2838, 2853], 'children': [{'type': 'ForStatement', 'name': '', 'range': [2839, 2853], 'children': [{'type': 'VariableDecl', 'name': 'execution_result', 'range': [2840, 2841], 'children': []}, {'type': 'CallExpression', 'name': 'self.listen_events', 'range': [2842, 2848], 'children': [{'type': 'Argument', 'name': 'f"{graph_id}/{graph_exec_id}"', 'range': [2846, 2848], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2849, 2853], 'children': [{'type': 'YieldStatement', 'name': '', 'range': [2851, 2853], 'children': [{'type': 'Identifier', 'name': 'execution_result', 'range': [2852, 2853], 'children': []}]}]}]}]}]}]}
2025-01-08 10:21:13,683 - INFO - Completed main AST analysis flow
2025-01-08 10:21:13,683 - INFO - Successfully processed chunk
2025-01-08 10:21:16,068 - INFO - Step 2 result: {'type': 'Program', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'FunctionDeclaration', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [745, 745], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [746, 746], 'children': []}, {'type': 'Identifier', 'name': 'create_graph_execution', 'range': [747, 747], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [748, 748], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [750, 752], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [750, 750], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [751, 751], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [752, 752], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [753, 753], 'children': []}, {'type': 'Parameter', 'name': 'graph_version', 'range': [755, 757], 'children': [{'type': 'Identifier', 'name': 'graph_version', 'range': [755, 755], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [756, 756], 'children': []}, {'type': 'TypeAnnotation', 'name': 'int', 'range': [757, 757], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [758, 758], 'children': []}, {'type': 'Parameter', 'name': 'nodes_input', 'range': [760, 770], 'children': [{'type': 'Identifier', 'name': 'nodes_input', 'range': [760, 760], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [761, 761], 'children': []}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [762, 762], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [763, 763], 'children': []}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [764, 764], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [765, 765], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [766, 766], 'children': []}, {'type': 'Punctuation', 'name': ',', 'range': [767, 767], 'children': []}, {'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [768, 768], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [769, 769], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [770, 770], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [771, 771], 'children': []}, {'type': 'Parameter', 'name': 'user_id', 'range': [773, 775], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [773, 773], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [774, 774], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [775, 775], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [778, 778], 'children': []}, {'type': 'Punctuation', 'name': '-', 'range': [779, 779], 'children': []}, {'type': 'Punctuation', 'name': '>', 'range': [780, 780], 'children': []}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [781, 781], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [782, 782], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [783, 783], 'children': []}, {'type': 'Punctuation', 'name': ',', 'range': [784, 784], 'children': []}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [785, 785], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [786, 786], 'children': []}, {'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [787, 787], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [788, 788], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [789, 789], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [790, 790], 'children': []}, {'type': 'StringLiteral', 'name': '""', 'range': [792, 794], 'children': []}, {'type': 'Block', 'name': 'FunctionBody', 'range': [796, 950], 'children': [{'type': 'VariableDeclaration', 'name': 'result', 'range': [796, 925], 'children': [{'type': 'Identifier', 'name': 'result', 'range': [796, 796], 'children': []}, {'type': 'Punctuation', 'name': '=', 'range': [797, 797], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [798, 798], 'children': []}, {'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [799, 799], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [800, 800], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [801, 801], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [802, 802], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [803, 803], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [804, 804], 'children': []}, {'type': 'Identifier', 'name': 'create', 'range': [805, 805], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [806, 806], 'children': []}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [808, 913], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [808, 808], 'children': []}, {'type': 'Punctuation', 'name': '=', 'range': [809, 809], 'children': []}, {'type': 'Punctuation', 'name': '{', 'range': [810, 810], 'children': []}, {'type': 'Property', 'name': '"agentGraphId"', 'range': [812, 814], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphId"', 'range': [812, 812], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [813, 813], 'children': []}, {'type': 'Identifier', 'name': 'graph_id', 'range': [814, 814], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [815, 815], 'children': []}, {'type': 'Property', 'name': '"agentGraphVersion"', 'range': [817, 819], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphVersion"', 'range': [817, 817], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [818, 818], 'children': []}, {'type': 'Identifier', 'name': 'graph_version', 'range': [819, 819], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [820, 820], 'children': []}, {'type': 'Property', 'name': '"executionStatus"', 'range': [822, 826], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [822, 822], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [823, 823], 'children': []}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [824, 824], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [825, 825], 'children': []}, {'type': 'Identifier', 'name': 'QUEUED', 'range': [826, 826], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [827, 827], 'children': []}, {'type': 'Property', 'name': '"AgentNodeExecutions"', 'range': [829, 905], 'children': [{'type': 'StringLiteral', 'name': '"AgentNodeExecutions"', 'range': [829, 829], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [830, 830], 'children': []}, {'type': 'Punctuation', 'name': '{', 'range': [831, 831], 'children': []}, {'type': 'Property', 'name': '"create"', 'range': [833, 903], 'children': [{'type': 'StringLiteral', 'name': '"create"', 'range': [833, 833], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [834, 834], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [835, 835], 'children': []}, {'type': 'Comment', 'name': '# type: ignore', 'range': [836, 840], 'children': []}, {'type': 'ObjectLiteral', 'name': 'NodeExecution', 'range': [841, 894], 'children': [{'type': 'Punctuation', 'name': '{', 'range': [841, 841], 'children': []}, {'type': 'Property', 'name': '"agentNodeId"', 'range': [843, 845], 'children': [{'type': 'StringLiteral', 'name': '"agentNodeId"', 'range': [843, 843], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [844, 844], 'children': []}, {'type': 'Identifier', 'name': 'node_id', 'range': [845, 845], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [846, 846], 'children': []}, {'type': 'Property', 'name': '"executionStatus"', 'range': [848, 852], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [848, 848], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [849, 849], 'children': []}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [850, 850], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [851, 851], 'children': []}, {'type': 'Identifier', 'name': 'INCOMPLETE', 'range': [852, 852], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [853, 853], 'children': []}, {'type': 'Property', 'name': '"Input"', 'range': [855, 891], 'children': [{'type': 'StringLiteral', 'name': '"Input"', 'range': [855, 855], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [856, 856], 'children': []}, {'type': 'Punctuation', 'name': '{', 'range': [857, 857], 'children': []}, {'type': 'Property', 'name': '"create"', 'range': [859, 889], 'children': [{'type': 'StringLiteral', 'name': '"create"', 'range': [859, 859], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [860, 860], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [861, 861], 'children': []}, {'type': 'ObjectLiteral', 'name': 'InputData', 'range': [863, 876], 'children': [{'type': 'Punctuation', 'name': '{', 'range': [863, 863], 'children': []}, {'type': 'Property', 'name': '"name"', 'range': [864, 866], 'children': [{'type': 'StringLiteral', 'name': '"name"', 'range': [864, 864], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [865, 865], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [866, 866], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [867, 867], 'children': []}, {'type': 'Property', 'name': '"data"', 'range': [868, 875], 'children': [{'type': 'StringLiteral', 'name': '"data"', 'range': [868, 868], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [869, 869], 'children': []}, {'type': 'Identifier', 'name': 'json', 'range': [870, 870], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [871, 871], 'children': []}, {'type': 'Identifier', 'name': 'dumps', 'range': [872, 872], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [873, 873], 'children': []}, {'type': 'Identifier', 'name': 'data', 'range': [874, 874], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [875, 875], 'children': []}]}, {'type': 'Punctuation', 'name': '}', 'range': [876, 876], 'children': []}]}, {'type': 'ForStatement', 'name': 'for', 'range': [878, 888], 'children': [{'type': 'Identifier', 'name': 'name', 'range': [879, 879], 'children': []}, {'type': 'Punctuation', 'name': ',', 'range': [880, 880], 'children': []}, {'type': 'Identifier', 'name': 'data', 'range': [881, 881], 'children': []}, {'type': 'Keyword', 'name': 'in', 'range': [882, 882], 'children': []}, {'type': 'Identifier', 'name': 'node_input', 'range': [883, 883], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [884, 884], 'children': []}, {'type': 'Identifier', 'name': 'items', 'range': [885, 885], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [886, 886], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [887, 887], 'children': []}]}, {'type': 'Punctuation', 'name': ']', 'range': [889, 889], 'children': []}]}, {'type': 'Punctuation', 'name': '}', 'range': [891, 891], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [892, 892], 'children': []}, {'type': 'Punctuation', 'name': '}', 'range': [894, 894], 'children': []}]}, {'type': 'ForStatement', 'name': 'for', 'range': [896, 902], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [897, 897], 'children': []}, {'type': 'Punctuation', 'name': ',', 'range': [898, 898], 'children': []}, {'type': 'Identifier', 'name': 'node_input', 'range': [899, 899], 'children': []}, {'type': 'Keyword', 'name': 'in', 'range': [900, 900], 'children': []}, {'type': 'Identifier', 'name': 'nodes_input', 'range': [901, 901], 'children': []}]}, {'type': 'Punctuation', 'name': ']', 'range': [903, 903], 'children': []}]}, {'type': 'Punctuation', 'name': '}', 'range': [905, 905], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [906, 906], 'children': []}, {'type': 'Property', 'name': '"userId"', 'range': [908, 910], 'children': [{'type': 'StringLiteral', 'name': '"userId"', 'range': [908, 908], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [909, 909], 'children': []}, {'type': 'Identifier', 'name': 'user_id', 'range': [910, 910], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [911, 911], 'children': []}, {'type': 'Punctuation', 'name': '}', 'range': [913, 913], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [914, 914], 'children': []}, {'type': 'Property', 'name': 'include', 'range': [916, 918], 'children': [{'type': 'Identifier', 'name': 'include', 'range': [916, 916], 'children': []}, {'type': 'Punctuation', 'name': '=', 'range': [917, 917], 'children': []}, {'type': 'Identifier', 'name': 'GRAPH_EXECUTION_INCLUDE', 'range': [918, 918], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [919, 919], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [921, 921], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [924, 948], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [924, 924], 'children': []}, {'type': 'Identifier', 'name': 'result', 'range': [925, 925], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [926, 926], 'children': []}, {'type': 'Identifier', 'name': 'id', 'range': [927, 927], 'children': []}, {'type': 'Punctuation', 'name': ',', 'range': [928, 928], 'children': []}, {'type': 'ArrayLiteral', 'name': 'ExecutionResults', 'range': [929, 948], 'children': [{'type': 'Punctuation', 'name': '[', 'range': [929, 929], 'children': []}, {'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [931, 936], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [931, 931], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [932, 932], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [933, 933], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [934, 934], 'children': []}, {'type': 'Identifier', 'name': 'execution', 'range': [935, 935], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [936, 936], 'children': []}]}, {'type': 'ForStatement', 'name': 'for', 'range': [938, 947], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [939, 939], 'children': []}, {'type': 'Keyword', 'name': 'in', 'range': [940, 940], 'children': []}, {'type': 'Identifier', 'name': 'result', 'range': [941, 941], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [942, 942], 'children': []}, {'type': 'Identifier', 'name': 'AgentNodeExecutions', 'range': [943, 943], 'children': []}, {'type': 'LogicalExpression', 'name': 'or', 'range': [944, 946], 'children': [{'type': 'Punctuation', 'name': '[', 'range': [945, 945], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [946, 946], 'children': []}]}]}, {'type': 'Punctuation', 'name': ']', 'range': [948, 948], 'children': []}]}]}]}]}]}
2025-01-08 10:21:16,069 - INFO - Starting Step 3: AST simplification
2025-01-08 10:21:17,173 - INFO - Step 5 result: {'type': 'Program', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'FunctionDecl', 'name': 'upsert_execution_output', 'range': [1271, 1339], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1271, 1271], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1272, 1272], 'children': []}, {'type': 'Identifier', 'name': 'upsert_execution_output', 'range': [1273, 1273], 'children': []}, {'type': 'Parameter', 'name': 'node_exec_id', 'range': [1276, 1278], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1276, 1276], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1278, 1278], 'children': []}]}, {'type': 'Parameter', 'name': 'output_name', 'range': [1281, 1283], 'children': [{'type': 'Identifier', 'name': 'output_name', 'range': [1281, 1281], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1283, 1283], 'children': []}]}, {'type': 'Parameter', 'name': 'output_data', 'range': [1286, 1288], 'children': [{'type': 'Identifier', 'name': 'output_data', 'range': [1286, 1286], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Any', 'range': [1288, 1288], 'children': []}]}, {'type': 'ReturnType', 'name': 'None', 'range': [1292, 1294], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [1294, 1294], 'children': []}]}, {'type': 'Docstring', 'name': '""" \\n     Insert AgentNodeExecutionInputOutput record for as one of AgentNodeExecution.Output. \\n     """', 'range': [1297, 1299], 'children': []}, {'type': 'ExpressionStatement', 'name': 'await AgentNodeExecutionInputOutput.prisma().create(data={...})', 'range': [1301, 1337], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [1301, 1301], 'children': []}, {'type': 'CallExpression', 'name': 'AgentNodeExecutionInputOutput.prisma().create', 'range': [1302, 1337], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecutionInputOutput', 'range': [1302, 1302], 'children': []}, {'type': 'CallExpression', 'name': 'prisma', 'range': [1304, 1304], 'children': []}, {'type': 'Identifier', 'name': 'create', 'range': [1308, 1308], 'children': []}, {'type': 'ObjectExpression', 'name': 'data={...}', 'range': [1311, 1335], 'children': [{'type': 'Property', 'name': '"name": output_name', 'range': [1315, 1317], 'children': [{'type': 'Literal', 'name': '"name"', 'range': [1315, 1315], 'children': []}, {'type': 'Identifier', 'name': 'output_name', 'range': [1317, 1317], 'children': []}]}, {'type': 'Property', 'name': '"data": json.dumps(output_data)', 'range': [1320, 1327], 'children': [{'type': 'Literal', 'name': '"data"', 'range': [1320, 1320], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1322, 1327], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1322, 1322], 'children': []}, {'type': 'Identifier', 'name': 'dumps', 'range': [1324, 1324], 'children': []}, {'type': 'Identifier', 'name': 'output_data', 'range': [1326, 1326], 'children': []}]}]}, {'type': 'Property', 'name': '"referencedByOutputExecId": node_exec_id', 'range': [1330, 1332], 'children': [{'type': 'Literal', 'name': '"referencedByOutputExecId"', 'range': [1330, 1330], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1332, 1332], 'children': []}]}]}]}]}]}]}
2025-01-08 10:21:17,173 - INFO - Completed main AST analysis flow
2025-01-08 10:21:17,174 - INFO - Successfully processed chunk
2025-01-08 10:21:22,423 - INFO - Step 5 result: {'type': 'Program', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'FunctionDecl', 'name': 'update_graph_execution_start_time', 'range': [1340, 1399], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1340, 1344], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1341, 1344], 'children': []}, {'type': 'Identifier', 'name': 'update_graph_execution_start_time', 'range': [1342, 1371], 'children': []}, {'type': 'Parameter', 'name': 'graph_exec_id', 'range': [1344, 1365], 'children': [{'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1344, 1356], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1346, 1349], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [1349, 1399], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [1350, 1398], 'children': [{'type': 'AwaitExpression', 'name': '', 'range': [1350, 1397], 'children': [{'type': 'CallExpression', 'name': '', 'range': [1351, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1351, 1357], 'children': [{'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [1351, 1369], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [1353, 1359], 'children': []}]}, {'type': 'CallExpression', 'name': '', 'range': [1357, 1397], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1357, 1363], 'children': [{'type': 'Identifier', 'name': 'update', 'range': [1357, 1363], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1363, 1394], 'children': [{'type': 'Property', 'name': 'where', 'range': [1360, 1366], 'children': [{'type': 'Identifier', 'name': 'where', 'range': [1360, 1364], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1362, 1366], 'children': [{'type': 'Property', 'name': 'id', 'range': [1363, 1365], 'children': [{'type': 'Literal', 'name': 'id', 'range': [1363, 1365], 'children': []}, {'type': 'Identifier', 'name': 'graph_exec_id', 'range': [1365, 1377], 'children': []}]}]}]}, {'type': 'Property', 'name': 'data', 'range': [1369, 1394], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1369, 1373], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [1371, 1394], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1373, 1378], 'children': [{'type': 'Literal', 'name': 'executionStatus', 'range': [1373, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1375, 1377], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1375, 1389], 'children': []}, {'type': 'Identifier', 'name': 'RUNNING', 'range': [1377, 1384], 'children': []}]}]}, {'type': 'Property', 'name': 'startedAt', 'range': [1380, 1392], 'children': [{'type': 'Literal', 'name': 'startedAt', 'range': [1380, 1389], 'children': []}, {'type': 'CallExpression', 'name': '', 'range': [1382, 1391], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [1382, 1388], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1382, 1390], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1384, 1387], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [1388, 1391], 'children': [{'type': 'Property', 'name': 'tz', 'range': [1387, 1390], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1387, 1389], 'children': []}, {'type': 'MemberExpression', 'name': '', 'range': [1389, 1390], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1389, 1397], 'children': []}, {'type': 'Identifier', 'name': 'utc', 'range': [1390, 1393], 'children': []}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}
2025-01-08 10:21:22,424 - INFO - Completed main AST analysis flow
2025-01-08 10:21:22,424 - INFO - Successfully processed chunk
2025-01-08 10:21:30,980 - INFO - Step 5 result: {'type': 'Program', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'FunctionDecl', 'name': 'get_latest_execution', 'range': [2510, 2613], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [2510, 2514], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [2511, 2514], 'children': []}, {'type': 'FunctionName', 'name': 'get_latest_execution', 'range': [2512, 2532], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [2513, 2521], 'children': [{'type': 'Parameter', 'name': 'node_id', 'range': [2514, 2517], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2516, 2519], 'children': []}]}, {'type': 'Parameter', 'name': 'graph_eid', 'range': [2518, 2521], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [2520, 2523], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult | None', 'range': [2522, 2527], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [2528, 2613], 'children': [{'type': 'VariableDeclaration', 'name': 'execution', 'range': [2529, 2536], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [2531, 2536], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [2532, 2536], 'children': []}]}]}, {'type': 'CallExpression', 'name': 'find_first', 'range': [2538, 2596], 'children': [{'type': 'Argument', 'name': 'where', 'range': [2541, 2579], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [2543, 2579], 'children': [{'type': 'Property', 'name': 'agentNodeId', 'range': [2545, 2548], 'children': [{'type': 'Identifier', 'name': 'node_id', 'range': [2547, 2550], 'children': []}]}, {'type': 'Property', 'name': 'agentGraphExecutionId', 'range': [2550, 2553], 'children': [{'type': 'Identifier', 'name': 'graph_eid', 'range': [2552, 2555], 'children': []}]}, {'type': 'Property', 'name': 'executionStatus', 'range': [2555, 2564], 'children': [{'type': 'ObjectExpression', 'name': 'executionStatus', 'range': [2557, 2563], 'children': [{'type': 'Property', 'name': 'not', 'range': [2558, 2561], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionStatus.INCOMPLETE', 'range': [2560, 2563], 'children': []}]}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [2566, 2573], 'children': [{'type': 'ObjectExpression', 'name': 'executionData', 'range': [2568, 2572], 'children': [{'type': 'Property', 'name': 'not', 'range': [2569, 2572], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2571, 2574], 'children': []}]}]}]}]}]}, {'type': 'Argument', 'name': 'order', 'range': [2582, 2589], 'children': [{'type': 'ObjectExpression', 'name': 'order', 'range': [2584, 2588], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [2585, 2588], 'children': [{'type': 'StringLiteral', 'name': 'desc', 'range': [2587, 2590], 'children': []}]}]}]}, {'type': 'Argument', 'name': 'include', 'range': [2591, 2595], 'children': [{'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [2593, 2596], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [2598, 2605], 'children': [{'type': 'Condition', 'name': 'not execution', 'range': [2599, 2601], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [2599, 2602], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2600, 2603], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'block', 'range': [2602, 2605], 'children': [{'type': 'ReturnStatement', 'name': 'return None', 'range': [2603, 2605], 'children': [{'type': 'Identifier', 'name': 'None', 'range': [2604, 2607], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return ExecutionResult.from_db(execution)', 'range': [2606, 2613], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [2607, 2612], 'children': []}, {'type': 'Argument', 'name': 'execution', 'range': [2611, 2613], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [2611, 2614], 'children': []}]}]}]}]}]}]}
2025-01-08 10:21:30,980 - INFO - Completed main AST analysis flow
2025-01-08 10:21:30,981 - INFO - Successfully processed chunk
2025-01-08 10:21:43,171 - INFO - Step 4 result: {'type': 'Program', 'name': 'ExecutionResult', 'range': [292, 479], 'children': [{'type': 'ClassDecl', 'name': 'ExecutionResult', 'range': [292, 356], 'children': [{'type': 'PropertyDecl', 'name': 'graph_id', 'range': [299, 301], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [301, 301], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'graph_version', 'range': [303, 305], 'children': [{'type': 'TypeAnnotation', 'name': 'int', 'range': [305, 305], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'graph_exec_id', 'range': [307, 309], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [309, 309], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'node_exec_id', 'range': [311, 313], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [313, 313], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'node_id', 'range': [315, 317], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [317, 317], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'block_id', 'range': [319, 321], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [321, 321], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'status', 'range': [323, 325], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [325, 325], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'input_data', 'range': [327, 329], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [329, 329], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'output_data', 'range': [331, 333], 'children': [{'type': 'TypeAnnotation', 'name': 'CompletedBlockOutput', 'range': [333, 333], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'add_time', 'range': [335, 337], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [337, 337], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'queue_time', 'range': [339, 343], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [341, 341], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [343, 343], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'start_time', 'range': [345, 349], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [347, 347], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [349, 349], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'end_time', 'range': [351, 355], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [353, 353], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [355, 355], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'from_graph', 'range': [358, 478], 'children': [{'type': 'Parameter', 'name': 'graph', 'range': [364, 366], 'children': [{'type': 'TypeAnnotation', 'name': 'AgentGraphExecution', 'range': [366, 366], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [370, 477], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult', 'range': [371, 477], 'children': [{'type': 'Argument', 'name': 'graph_id', 'range': [374, 378], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphId', 'range': [376, 378], 'children': []}]}, {'type': 'Argument', 'name': 'graph_version', 'range': [381, 385], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphVersion', 'range': [383, 385], 'children': []}]}, {'type': 'Argument', 'name': 'graph_exec_id', 'range': [388, 392], 'children': [{'type': 'MemberExpression', 'name': 'graph.id', 'range': [390, 392], 'children': []}]}, {'type': 'Argument', 'name': 'node_exec_id', 'range': [395, 397], 'children': [{'type': 'Literal', 'name': '""', 'range': [397, 397], 'children': []}]}, {'type': 'Argument', 'name': 'node_id', 'range': [400, 402], 'children': [{'type': 'Literal', 'name': '""', 'range': [402, 402], 'children': []}]}, {'type': 'Argument', 'name': 'block_id', 'range': [405, 407], 'children': [{'type': 'Literal', 'name': '""', 'range': [407, 407], 'children': []}]}, {'type': 'Argument', 'name': 'status', 'range': [410, 414], 'children': [{'type': 'MemberExpression', 'name': 'graph.executionStatus', 'range': [412, 414], 'children': []}]}, {'type': 'Comment', 'name': '# TODO: Populate input_data & output_data from AgentNodeExecutions', 'range': [417, 426], 'children': []}, {'type': 'Comment', 'name': '# Input & Output comes AgentInputBlock & AgentOutputBlock.', 'range': [427, 436], 'children': []}, {'type': 'Argument', 'name': 'input_data', 'range': [437, 440], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [439, 440], 'children': []}]}, {'type': 'Argument', 'name': 'output_data', 'range': [443, 446], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [445, 446], 'children': []}]}, {'type': 'Argument', 'name': 'add_time', 'range': [449, 453], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [451, 453], 'children': []}]}, {'type': 'Argument', 'name': 'queue_time', 'range': [456, 460], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [458, 460], 'children': []}]}, {'type': 'Argument', 'name': 'start_time', 'range': [463, 467], 'children': [{'type': 'MemberExpression', 'name': 'graph.startedAt', 'range': [465, 467], 'children': []}]}, {'type': 'Argument', 'name': 'end_time', 'range': [470, 474], 'children': [{'type': 'MemberExpression', 'name': 'graph.updatedAt', 'range': [472, 474], 'children': []}]}]}]}]}]}
2025-01-08 10:21:43,171 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:22:02,075 - INFO - Step 3 result: {'type': 'Program', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'FunctionDeclaration', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [745, 745]}, {'type': 'Keyword', 'name': 'def', 'range': [746, 746]}, {'type': 'Identifier', 'name': 'create_graph_execution', 'range': [747, 747]}, {'type': 'Parameter', 'name': 'graph_id', 'range': [750, 752], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [750, 750]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [752, 752]}]}, {'type': 'Parameter', 'name': 'graph_version', 'range': [755, 757], 'children': [{'type': 'Identifier', 'name': 'graph_version', 'range': [755, 755]}, {'type': 'TypeAnnotation', 'name': 'int', 'range': [757, 757]}]}, {'type': 'Parameter', 'name': 'nodes_input', 'range': [760, 770], 'children': [{'type': 'Identifier', 'name': 'nodes_input', 'range': [760, 760]}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [762, 762]}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [764, 764]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [766, 766]}, {'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [768, 768]}]}, {'type': 'Parameter', 'name': 'user_id', 'range': [773, 775], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [773, 773]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [775, 775]}]}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [781, 781], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [783, 783]}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [785, 785]}, {'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [787, 787]}]}, {'type': 'Block', 'name': 'FunctionBody', 'range': [796, 950], 'children': [{'type': 'VariableDeclaration', 'name': 'result', 'range': [796, 925], 'children': [{'type': 'Identifier', 'name': 'result', 'range': [796, 796]}, {'type': 'Keyword', 'name': 'await', 'range': [798, 798]}, {'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [799, 799]}, {'type': 'Identifier', 'name': 'prisma', 'range': [801, 801]}, {'type': 'Identifier', 'name': 'create', 'range': [805, 805]}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [808, 913], 'children': [{'type': 'Property', 'name': '"agentGraphId"', 'range': [812, 814], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphId"', 'range': [812, 812]}, {'type': 'Identifier', 'name': 'graph_id', 'range': [814, 814]}]}, {'type': 'Property', 'name': '"agentGraphVersion"', 'range': [817, 819], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphVersion"', 'range': [817, 817]}, {'type': 'Identifier', 'name': 'graph_version', 'range': [819, 819]}]}, {'type': 'Property', 'name': '"executionStatus"', 'range': [822, 826], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [822, 822]}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [824, 824]}, {'type': 'Identifier', 'name': 'QUEUED', 'range': [826, 826]}]}, {'type': 'Property', 'name': '"AgentNodeExecutions"', 'range': [829, 905], 'children': [{'type': 'StringLiteral', 'name': '"AgentNodeExecutions"', 'range': [829, 829]}, {'type': 'ObjectLiteral', 'name': 'NodeExecution', 'range': [841, 894], 'children': [{'type': 'Property', 'name': '"agentNodeId"', 'range': [843, 845], 'children': [{'type': 'StringLiteral', 'name': '"agentNodeId"', 'range': [843, 843]}, {'type': 'Identifier', 'name': 'node_id', 'range': [845, 845]}]}, {'type': 'Property', 'name': '"executionStatus"', 'range': [848, 852], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [848, 848]}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [850, 850]}, {'type': 'Identifier', 'name': 'INCOMPLETE', 'range': [852, 852]}]}, {'type': 'Property', 'name': '"Input"', 'range': [855, 891], 'children': [{'type': 'StringLiteral', 'name': '"Input"', 'range': [855, 855]}, {'type': 'ObjectLiteral', 'name': 'InputData', 'range': [863, 876], 'children': [{'type': 'Property', 'name': '"name"', 'range': [864, 866], 'children': [{'type': 'StringLiteral', 'name': '"name"', 'range': [864, 864]}, {'type': 'Identifier', 'name': 'name', 'range': [866, 866]}]}, {'type': 'Property', 'name': '"data"', 'range': [868, 875], 'children': [{'type': 'StringLiteral', 'name': '"data"', 'range': [868, 868]}, {'type': 'Identifier', 'name': 'json', 'range': [870, 870]}, {'type': 'Identifier', 'name': 'dumps', 'range': [872, 872]}, {'type': 'Identifier', 'name': 'data', 'range': [874, 874]}]}]}]}]}]}, {'type': 'Property', 'name': '"userId"', 'range': [908, 910], 'children': [{'type': 'StringLiteral', 'name': '"userId"', 'range': [908, 908]}, {'type': 'Identifier', 'name': 'user_id', 'range': [910, 910]}]}]}, {'type': 'Property', 'name': 'include', 'range': [916, 918], 'children': [{'type': 'Identifier', 'name': 'include', 'range': [916, 916]}, {'type': 'Identifier', 'name': 'GRAPH_EXECUTION_INCLUDE', 'range': [918, 918]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [924, 948], 'children': [{'type': 'Identifier', 'name': 'result', 'range': [925, 925]}, {'type': 'Identifier', 'name': 'id', 'range': [927, 927]}, {'type': 'ArrayLiteral', 'name': 'ExecutionResults', 'range': [929, 948], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [931, 936], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [931, 931]}, {'type': 'Identifier', 'name': 'from_db', 'range': [933, 933]}, {'type': 'Identifier', 'name': 'execution', 'range': [935, 935]}]}, {'type': 'ForStatement', 'name': 'for', 'range': [938, 947], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [939, 939]}, {'type': 'Identifier', 'name': 'result', 'range': [941, 941]}, {'type': 'Identifier', 'name': 'AgentNodeExecutions', 'range': [943, 943]}]}]}]}]}]}]}
2025-01-08 10:22:02,076 - INFO - Starting Step 4: AST normalization
2025-01-08 10:22:23,589 - INFO - Step 5 result: {'type': 'Program', 'name': 'ExecutionResult', 'range': [292, 479], 'children': [{'type': 'ClassDecl', 'name': 'ExecutionResult', 'range': [292, 356], 'children': [{'type': 'PropertyDecl', 'name': 'graph_id', 'range': [299, 301], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [301, 301], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'graph_version', 'range': [303, 305], 'children': [{'type': 'TypeAnnotation', 'name': 'int', 'range': [305, 305], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'graph_exec_id', 'range': [307, 309], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [309, 309], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'node_exec_id', 'range': [311, 313], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [313, 313], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'node_id', 'range': [315, 317], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [317, 317], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'block_id', 'range': [319, 321], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [321, 321], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'status', 'range': [323, 325], 'children': [{'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [325, 325], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'input_data', 'range': [327, 329], 'children': [{'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [329, 329], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'output_data', 'range': [331, 333], 'children': [{'type': 'TypeAnnotation', 'name': 'CompletedBlockOutput', 'range': [333, 333], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'add_time', 'range': [335, 337], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [337, 337], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'queue_time', 'range': [339, 343], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [341, 341], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [343, 343], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'start_time', 'range': [345, 349], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [347, 347], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [349, 349], 'children': []}]}, {'type': 'PropertyDecl', 'name': 'end_time', 'range': [351, 355], 'children': [{'type': 'TypeAnnotation', 'name': 'datetime', 'range': [353, 353], 'children': []}, {'type': 'UnionType', 'name': 'None', 'range': [355, 355], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'from_graph', 'range': [358, 478], 'children': [{'type': 'Parameter', 'name': 'graph', 'range': [364, 366], 'children': [{'type': 'TypeAnnotation', 'name': 'AgentGraphExecution', 'range': [366, 366], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [370, 477], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult', 'range': [371, 477], 'children': [{'type': 'Argument', 'name': 'graph_id', 'range': [374, 378], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphId', 'range': [376, 378], 'children': []}]}, {'type': 'Argument', 'name': 'graph_version', 'range': [381, 385], 'children': [{'type': 'MemberExpression', 'name': 'graph.agentGraphVersion', 'range': [383, 385], 'children': []}]}, {'type': 'Argument', 'name': 'graph_exec_id', 'range': [388, 392], 'children': [{'type': 'MemberExpression', 'name': 'graph.id', 'range': [390, 392], 'children': []}]}, {'type': 'Argument', 'name': 'node_exec_id', 'range': [395, 397], 'children': [{'type': 'Literal', 'name': '""', 'range': [397, 397], 'children': []}]}, {'type': 'Argument', 'name': 'node_id', 'range': [400, 402], 'children': [{'type': 'Literal', 'name': '""', 'range': [402, 402], 'children': []}]}, {'type': 'Argument', 'name': 'block_id', 'range': [405, 407], 'children': [{'type': 'Literal', 'name': '""', 'range': [407, 407], 'children': []}]}, {'type': 'Argument', 'name': 'status', 'range': [410, 414], 'children': [{'type': 'MemberExpression', 'name': 'graph.executionStatus', 'range': [412, 414], 'children': []}]}, {'type': 'Comment', 'name': '# TODO: Populate input_data & output_data from AgentNodeExecutions', 'range': [417, 426], 'children': []}, {'type': 'Comment', 'name': '# Input & Output comes AgentInputBlock & AgentOutputBlock.', 'range': [427, 436], 'children': []}, {'type': 'Argument', 'name': 'input_data', 'range': [437, 440], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [439, 440], 'children': []}]}, {'type': 'Argument', 'name': 'output_data', 'range': [443, 446], 'children': [{'type': 'ObjectExpression', 'name': '{}', 'range': [445, 446], 'children': []}]}, {'type': 'Argument', 'name': 'add_time', 'range': [449, 453], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [451, 453], 'children': []}]}, {'type': 'Argument', 'name': 'queue_time', 'range': [456, 460], 'children': [{'type': 'MemberExpression', 'name': 'graph.createdAt', 'range': [458, 460], 'children': []}]}, {'type': 'Argument', 'name': 'start_time', 'range': [463, 467], 'children': [{'type': 'MemberExpression', 'name': 'graph.startedAt', 'range': [465, 467], 'children': []}]}, {'type': 'Argument', 'name': 'end_time', 'range': [470, 474], 'children': [{'type': 'MemberExpression', 'name': 'graph.updatedAt', 'range': [472, 474], 'children': []}]}]}]}]}]}
2025-01-08 10:22:23,589 - INFO - Completed main AST analysis flow
2025-01-08 10:22:23,590 - INFO - Successfully processed chunk
2025-01-08 10:22:24,821 - INFO - Step 3 result: {'type': 'Program', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'FunctionDef', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'Arguments', 'name': '', 'range': [2165, 2169], 'children': [{'type': 'Argument', 'name': 'data', 'range': [2166, 2168], 'children': []}]}, {'type': 'ReturnType', 'name': 'BlockInput', 'range': [2170, 2172], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [2175, 2177], 'children': []}, {'type': 'Comment', 'name': '', 'range': [2180, 2198], 'children': []}, {'type': 'Assignment', 'name': 'items', 'range': [2200, 2209], 'children': [{'type': 'Call', 'name': 'list', 'range': [2202, 2209], 'children': [{'type': 'Attribute', 'name': 'items', 'range': [2204, 2208], 'children': [{'type': 'Name', 'name': 'data', 'range': [2204, 2205], 'children': []}]}]}]}, {'type': 'For', 'name': '', 'range': [2212, 2340], 'children': [{'type': 'Targets', 'name': '', 'range': [2213, 2215], 'children': [{'type': 'Name', 'name': 'key', 'range': [2213, 2214], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2215, 2215], 'children': []}]}, {'type': 'Iter', 'name': 'items', 'range': [2217, 2217], 'children': []}, {'type': 'If', 'name': '', 'range': [2220, 2227], 'children': [{'type': 'Test', 'name': '', 'range': [2221, 2225], 'children': [{'type': 'NotIn', 'name': '', 'range': [2222, 2224], 'children': [{'type': 'Name', 'name': 'LIST_SPLIT', 'range': [2221, 2221], 'children': []}, {'type': 'Name', 'name': 'key', 'range': [2224, 2224], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2226, 2227], 'children': [{'type': 'Continue', 'name': '', 'range': [2227, 2227], 'children': []}]}]}, {'type': 'Assignment', 'name': 'name, index', 'range': [2229, 2239], 'children': [{'type': 'Call', 'name': 'split', 'range': [2233, 2239], 'children': [{'type': 'Name', 'name': 'key', 'range': [2233, 2234], 'children': []}, {'type': 'Name', 'name': 'LIST_SPLIT', 'range': [2237, 2237], 'children': []}]}]}, {'type': 'If', 'name': '', 'range': [2240, 2254], 'children': [{'type': 'Test', 'name': '', 'range': [2241, 2247], 'children': [{'type': 'Not', 'name': '', 'range': [2241, 2241], 'children': []}, {'type': 'Call', 'name': 'isdigit', 'range': [2243, 2247], 'children': [{'type': 'Name', 'name': 'index', 'range': [2243, 2244], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2248, 2254], 'children': [{'type': 'Raise', 'name': '', 'range': [2249, 2254], 'children': [{'type': 'Call', 'name': 'ValueError', 'range': [2250, 2254], 'children': [{'type': 'FormattedValue', 'name': '', 'range': [2252, 2253], 'children': []}]}]}]}]}, {'type': 'Assignment', 'name': 'data[name]', 'range': [2257, 2271], 'children': [{'type': 'Call', 'name': 'get', 'range': [2262, 2271], 'children': [{'type': 'Name', 'name': 'data', 'range': [2262, 2263], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2266, 2266], 'children': []}, {'type': 'List', 'name': '', 'range': [2268, 2270], 'children': []}]}]}, {'type': 'If', 'name': '', 'range': [2272, 2340], 'children': [{'type': 'Test', 'name': '', 'range': [2273, 2286], 'children': [{'type': 'Compare', 'name': '', 'range': [2273, 2286], 'children': [{'type': 'Call', 'name': 'int', 'range': [2273, 2277], 'children': [{'type': 'Name', 'name': 'index', 'range': [2275, 2276], 'children': []}]}, {'type': 'GtE', 'name': '', 'range': [2277, 2278], 'children': []}, {'type': 'Call', 'name': 'len', 'range': [2279, 2286], 'children': [{'type': 'Subscript', 'name': '', 'range': [2281, 2285], 'children': [{'type': 'Name', 'name': 'data', 'range': [2281, 2282], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2283, 2284], 'children': []}]}]}]}]}, {'type': 'Body', 'name': '', 'range': [2287, 2340], 'children': [{'type': 'Comment', 'name': '', 'range': [2288, 2297], 'children': []}, {'type': 'Assignment', 'name': 'data[name]', 'range': [2299, 2327], 'children': [{'type': 'Call', 'name': 'extend', 'range': [2303, 2327], 'children': [{'type': 'Name', 'name': 'data', 'range': [2299, 2300], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2301, 2302], 'children': []}, {'type': 'BinOp', 'name': '', 'range': [2306, 2326], 'children': [{'type': 'List', 'name': '', 'range': [2306, 2308], 'children': []}, {'type': 'Mult', 'name': '', 'range': [2309, 2309], 'children': []}, {'type': 'BinOp', 'name': '', 'range': [2310, 2325], 'children': [{'type': 'Call', 'name': 'int', 'range': [2310, 2314], 'children': [{'type': 'Name', 'name': 'index', 'range': [2312, 2313], 'children': []}]}, {'type': 'Sub', 'name': '', 'range': [2315, 2315], 'children': []}, {'type': 'Call', 'name': 'len', 'range': [2316, 2323], 'children': [{'type': 'Subscript', 'name': '', 'range': [2318, 2322], 'children': [{'type': 'Name', 'name': 'data', 'range': [2318, 2319], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2320, 2321], 'children': []}]}]}, {'type': 'Add', 'name': '', 'range': [2323, 2323], 'children': []}, {'type': 'Num', 'name': '1', 'range': [2324, 2325], 'children': []}]}]}]}]}, {'type': 'Assignment', 'name': 'data[name][int(index)]', 'range': [2328, 2340], 'children': [{'type': 'Subscript', 'name': '', 'range': [2328, 2338], 'children': [{'type': 'Name', 'name': 'data', 'range': [2328, 2329], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2330, 2331], 'children': []}, {'type': 'Call', 'name': 'int', 'range': [2333, 2337], 'children': [{'type': 'Name', 'name': 'index', 'range': [2335, 2336], 'children': []}]}]}, {'type': 'Name', 'name': 'value', 'range': [2339, 2340], 'children': []}]}]}]}]}, {'type': 'Comment', 'name': '', 'range': [2342, 2360], 'children': []}, {'type': 'For', 'name': '', 'range': [2362, 2414], 'children': [{'type': 'Targets', 'name': '', 'range': [2363, 2365], 'children': [{'type': 'Name', 'name': 'key', 'range': [2363, 2364], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2365, 2365], 'children': []}]}, {'type': 'Iter', 'name': 'items', 'range': [2367, 2367], 'children': []}, {'type': 'If', 'name': '', 'range': [2370, 2377], 'children': [{'type': 'Test', 'name': '', 'range': [2371, 2375], 'children': [{'type': 'NotIn', 'name': '', 'range': [2372, 2374], 'children': [{'type': 'Name', 'name': 'DICT_SPLIT', 'range': [2371, 2371], 'children': []}, {'type': 'Name', 'name': 'key', 'range': [2374, 2374], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2376, 2377], 'children': [{'type': 'Continue', 'name': '', 'range': [2377, 2377], 'children': []}]}]}, {'type': 'Assignment', 'name': 'name, index', 'range': [2379, 2389], 'children': [{'type': 'Call', 'name': 'split', 'range': [2383, 2389], 'children': [{'type': 'Name', 'name': 'key', 'range': [2383, 2384], 'children': []}, {'type': 'Name', 'name': 'DICT_SPLIT', 'range': [2387, 2387], 'children': []}]}]}, {'type': 'Assignment', 'name': 'data[name]', 'range': [2390, 2404], 'children': [{'type': 'Call', 'name': 'get', 'range': [2395, 2404], 'children': [{'type': 'Name', 'name': 'data', 'range': [2395, 2396], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2399, 2399], 'children': []}, {'type': 'Dict', 'name': '', 'range': [2401, 2403], 'children': []}]}]}, {'type': 'Assignment', 'name': 'data[name][index]', 'range': [2405, 2414], 'children': [{'type': 'Subscript', 'name': '', 'range': [2405, 2412], 'children': [{'type': 'Name', 'name': 'data', 'range': [2405, 2406], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2407, 2408], 'children': []}, {'type': 'Name', 'name': 'index', 'range': [2410, 2411], 'children': []}]}, {'type': 'Name', 'name': 'value', 'range': [2413, 2414], 'children': []}]}]}, {'type': 'Comment', 'name': '', 'range': [2416, 2434], 'children': []}, {'type': 'For', 'name': '', 'range': [2436, 2504], 'children': [{'type': 'Targets', 'name': '', 'range': [2437, 2439], 'children': [{'type': 'Name', 'name': 'key', 'range': [2437, 2438], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2439, 2439], 'children': []}]}, {'type': 'Iter', 'name': 'items', 'range': [2441, 2441], 'children': []}, {'type': 'If', 'name': '', 'range': [2444, 2451], 'children': [{'type': 'Test', 'name': '', 'range': [2445, 2449], 'children': [{'type': 'NotIn', 'name': '', 'range': [2446, 2448], 'children': [{'type': 'Name', 'name': 'OBJC_SPLIT', 'range': [2445, 2445], 'children': []}, {'type': 'Name', 'name': 'key', 'range': [2448, 2448], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2450, 2451], 'children': [{'type': 'Continue', 'name': '', 'range': [2451, 2451], 'children': []}]}]}, {'type': 'Assignment', 'name': 'name, index', 'range': [2453, 2463], 'children': [{'type': 'Call', 'name': 'split', 'range': [2457, 2463], 'children': [{'type': 'Name', 'name': 'key', 'range': [2457, 2458], 'children': []}, {'type': 'Name', 'name': 'OBJC_SPLIT', 'range': [2461, 2461], 'children': []}]}]}, {'type': 'If', 'name': '', 'range': [2464, 2482], 'children': [{'type': 'Test', 'name': '', 'range': [2465, 2480], 'children': [{'type': 'Or', 'name': '', 'range': [2469, 2469], 'children': []}, {'type': 'NotIn', 'name': '', 'range': [2466, 2468], 'children': [{'type': 'Name', 'name': 'name', 'range': [2465, 2466], 'children': []}, {'type': 'Name', 'name': 'data', 'range': [2468, 2468], 'children': []}]}, {'type': 'Not', 'name': '', 'range': [2470, 2470], 'children': []}, {'type': 'Call', 'name': 'isinstance', 'range': [2471, 2480], 'children': [{'type': 'Subscript', 'name': '', 'range': [2473, 2477], 'children': [{'type': 'Name', 'name': 'data', 'range': [2473, 2474], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2475, 2476], 'children': []}]}, {'type': 'Name', 'name': 'object', 'range': [2478, 2479], 'children': []}]}]}, {'type': 'Body', 'name': '', 'range': [2481, 2482], 'children': [{'type': 'Assignment', 'name': 'data[name]', 'range': [2482, 2492], 'children': [{'type': 'Call', 'name': 'MockObject', 'range': [2487, 2492], 'children': [{'type': 'Name', 'name': 'mock', 'range': [2487, 2488], 'children': []}]}]}]}]}, {'type': 'Assignment', 'name': 'setattr(data[name], index, value)', 'range': [2493, 2504], 'children': [{'type': 'Call', 'name': 'setattr', 'range': [2493, 2504], 'children': [{'type': 'Subscript', 'name': '', 'range': [2495, 2499], 'children': [{'type': 'Name', 'name': 'data', 'range': [2495, 2496], 'children': []}, {'type': 'Name', 'name': 'name', 'range': [2497, 2498], 'children': []}]}, {'type': 'Name', 'name': 'index', 'range': [2500, 2501], 'children': []}, {'type': 'Name', 'name': 'value', 'range': [2502, 2503], 'children': []}]}]}]}, {'type': 'Return', 'name': '', 'range': [2506, 2507], 'children': [{'type': 'Name', 'name': 'data', 'range': [2507, 2507], 'children': []}]}]}]}
2025-01-08 10:22:24,821 - INFO - Starting Step 4: AST normalization
2025-01-08 10:22:47,414 - INFO - Step 4 result: {'type': 'Program', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'FunctionDecl', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [745, 745]}, {'type': 'Keyword', 'name': 'def', 'range': [746, 746]}, {'type': 'Identifier', 'name': 'create_graph_execution', 'range': [747, 747]}, {'type': 'Parameter', 'name': 'graph_id', 'range': [750, 752], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [750, 750]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [752, 752]}]}, {'type': 'Parameter', 'name': 'graph_version', 'range': [755, 757], 'children': [{'type': 'Identifier', 'name': 'graph_version', 'range': [755, 755]}, {'type': 'TypeAnnotation', 'name': 'int', 'range': [757, 757]}]}, {'type': 'Parameter', 'name': 'nodes_input', 'range': [760, 770], 'children': [{'type': 'Identifier', 'name': 'nodes_input', 'range': [760, 760]}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [762, 762]}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [764, 764]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [766, 766]}, {'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [768, 768]}]}, {'type': 'Parameter', 'name': 'user_id', 'range': [773, 775], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [773, 773]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [775, 775]}]}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [781, 781], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [783, 783]}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [785, 785]}, {'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [787, 787]}]}, {'type': 'Block', 'name': 'FunctionBody', 'range': [796, 950], 'children': [{'type': 'VariableDecl', 'name': 'result', 'range': [796, 925], 'children': [{'type': 'Identifier', 'name': 'result', 'range': [796, 796]}, {'type': 'Keyword', 'name': 'await', 'range': [798, 798]}, {'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [799, 799]}, {'type': 'Identifier', 'name': 'prisma', 'range': [801, 801]}, {'type': 'Identifier', 'name': 'create', 'range': [805, 805]}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [808, 913], 'children': [{'type': 'Property', 'name': '"agentGraphId"', 'range': [812, 814], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphId"', 'range': [812, 812]}, {'type': 'Identifier', 'name': 'graph_id', 'range': [814, 814]}]}, {'type': 'Property', 'name': '"agentGraphVersion"', 'range': [817, 819], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphVersion"', 'range': [817, 817]}, {'type': 'Identifier', 'name': 'graph_version', 'range': [819, 819]}]}, {'type': 'Property', 'name': '"executionStatus"', 'range': [822, 826], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [822, 822]}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [824, 824]}, {'type': 'Identifier', 'name': 'QUEUED', 'range': [826, 826]}]}, {'type': 'Property', 'name': '"AgentNodeExecutions"', 'range': [829, 905], 'children': [{'type': 'StringLiteral', 'name': '"AgentNodeExecutions"', 'range': [829, 829]}, {'type': 'ObjectLiteral', 'name': 'NodeExecution', 'range': [841, 894], 'children': [{'type': 'Property', 'name': '"agentNodeId"', 'range': [843, 845], 'children': [{'type': 'StringLiteral', 'name': '"agentNodeId"', 'range': [843, 843]}, {'type': 'Identifier', 'name': 'node_id', 'range': [845, 845]}]}, {'type': 'Property', 'name': '"executionStatus"', 'range': [848, 852], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [848, 848]}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [850, 850]}, {'type': 'Identifier', 'name': 'INCOMPLETE', 'range': [852, 852]}]}, {'type': 'Property', 'name': '"Input"', 'range': [855, 891], 'children': [{'type': 'StringLiteral', 'name': '"Input"', 'range': [855, 855]}, {'type': 'ObjectLiteral', 'name': 'InputData', 'range': [863, 876], 'children': [{'type': 'Property', 'name': '"name"', 'range': [864, 866], 'children': [{'type': 'StringLiteral', 'name': '"name"', 'range': [864, 864]}, {'type': 'Identifier', 'name': 'name', 'range': [866, 866]}]}, {'type': 'Property', 'name': '"data"', 'range': [868, 875], 'children': [{'type': 'StringLiteral', 'name': '"data"', 'range': [868, 868]}, {'type': 'Identifier', 'name': 'json', 'range': [870, 870]}, {'type': 'Identifier', 'name': 'dumps', 'range': [872, 872]}, {'type': 'Identifier', 'name': 'data', 'range': [874, 874]}]}]}]}]}]}, {'type': 'Property', 'name': '"userId"', 'range': [908, 910], 'children': [{'type': 'StringLiteral', 'name': '"userId"', 'range': [908, 908]}, {'type': 'Identifier', 'name': 'user_id', 'range': [910, 910]}]}]}, {'type': 'Property', 'name': 'include', 'range': [916, 918], 'children': [{'type': 'Identifier', 'name': 'include', 'range': [916, 916]}, {'type': 'Identifier', 'name': 'GRAPH_EXECUTION_INCLUDE', 'range': [918, 918]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [924, 948], 'children': [{'type': 'Identifier', 'name': 'result', 'range': [925, 925]}, {'type': 'Identifier', 'name': 'id', 'range': [927, 927]}, {'type': 'ArrayLiteral', 'name': 'ExecutionResults', 'range': [929, 948], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [931, 936], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [931, 931]}, {'type': 'Identifier', 'name': 'from_db', 'range': [933, 933]}, {'type': 'Identifier', 'name': 'execution', 'range': [935, 935]}]}, {'type': 'ForStatement', 'name': 'for', 'range': [938, 947], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [939, 939]}, {'type': 'Identifier', 'name': 'result', 'range': [941, 941]}, {'type': 'Identifier', 'name': 'AgentNodeExecutions', 'range': [943, 943]}]}]}]}]}]}]}
2025-01-08 10:22:47,414 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:23:04,687 - INFO - Step 3 result: {'type': 'Program', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1566, 1571], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1567, 1570], 'children': []}, {'type': 'FunctionName', 'name': 'update_execution_status', 'range': [1568, 1588], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1569, 1604], 'children': [{'type': 'Parameter', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': [{'type': 'ParameterName', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1572, 1574], 'children': []}]}, {'type': 'Parameter', 'name': 'status', 'range': [1576, 1579], 'children': [{'type': 'ParameterName', 'name': 'status', 'range': [1576, 1579], 'children': []}, {'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [1577, 1579], 'children': []}]}, {'type': 'Parameter', 'name': 'execution_data', 'range': [1581, 1587], 'children': [{'type': 'ParameterName', 'name': 'execution_data', 'range': [1581, 1587], 'children': []}, {'type': 'TypeAnnotation', 'name': 'BlockInput | None', 'range': [1582, 1587], 'children': []}]}, {'type': 'Parameter', 'name': 'stats', 'range': [1590, 1601], 'children': [{'type': 'ParameterName', 'name': 'stats', 'range': [1590, 1601], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any] | None', 'range': [1591, 1601], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1605, 1607], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1608, 1845], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [1610, 1628], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1611, 1621], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1611, 1614], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1611, 1614], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1614, 1616], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1614, 1616], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1615, 1616], 'children': []}]}]}, {'type': 'BinaryExpression', 'name': 'and', 'range': [1617, 1621], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1617, 1621], 'children': []}, {'type': 'NullLiteral', 'name': 'None', 'range': [1619, 1621], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1622, 1628], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1623, 1627], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1624, 1627], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1624, 1627], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1625, 1627], 'children': [{'type': 'StringLiteral', 'name': '"Execution data must be provided when queuing an execution."', 'range': [1626, 1627], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'VariableDeclarator', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'Identifier', 'name': 'now', 'range': [1630, 1642], 'children': []}, {'type': 'CallExpression', 'name': 'datetime.now', 'range': [1632, 1641], 'children': [{'type': 'MemberExpression', 'name': 'datetime.now', 'range': [1632, 1634], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1632, 1634], 'children': []}, {'type': 'Property', 'name': 'now', 'range': [1633, 1634], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1635, 1641], 'children': [{'type': 'AssignmentExpression', 'name': 'tz=', 'range': [1636, 1640], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1636, 1640], 'children': []}, {'type': 'MemberExpression', 'name': 'timezone.utc', 'range': [1638, 1640], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1638, 1640], 'children': []}, {'type': 'Property', 'name': 'utc', 'range': [1639, 1640], 'children': []}]}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'VariableDeclarator', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1643, 1784], 'children': []}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1645, 1784], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1647, 1654], 'children': [{'type': 'Identifier', 'name': 'executionStatus', 'range': [1647, 1654], 'children': []}, {'type': 'Identifier', 'name': 'status', 'range': [1653, 1654], 'children': []}]}, {'type': 'Property', 'name': 'queuedTime', 'range': [1658, 1676], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1658, 1676], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1666, 1676], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1667, 1670], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1667, 1670], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1670, 1672], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1670, 1672], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1671, 1672], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1673, 1675], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [1673, 1675], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1673, 1675], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1674, 1675], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1676, 1676], 'children': []}]}]}, {'type': 'Property', 'name': 'startedTime', 'range': [1679, 1697], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1679, 1697], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1687, 1697], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1688, 1691], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1688, 1691], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.RUNNING', 'range': [1691, 1693], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1691, 1693], 'children': []}, {'type': 'Property', 'name': 'RUNNING', 'range': [1692, 1693], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1694, 1696], 'children': [{'type': 'Property', 'name': 'startedTime', 'range': [1694, 1696], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1694, 1696], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1695, 1696], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1697, 1697], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1700, 1718], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1700, 1718], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1708, 1718], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1709, 1712], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1709, 1712], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.FAILED', 'range': [1712, 1714], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1712, 1714], 'children': []}, {'type': 'Property', 'name': 'FAILED', 'range': [1713, 1714], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1715, 1717], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1715, 1717], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1715, 1717], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1716, 1717], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1718, 1718], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1721, 1739], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1721, 1739], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1729, 1739], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1730, 1733], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1730, 1733], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.COMPLETED', 'range': [1733, 1735], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1733, 1735], 'children': []}, {'type': 'Property', 'name': 'COMPLETED', 'range': [1734, 1735], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1736, 1738], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1736, 1738], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1736, 1738], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1737, 1738], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1739, 1739], 'children': []}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [1742, 1760], 'children': [{'type': 'Identifier', 'name': 'executionData', 'range': [1742, 1760], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1756, 1760], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1756, 1760], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1748, 1754], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1748, 1750], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1748, 1750], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1749, 1750], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1751, 1754], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1752, 1754], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1760, 1760], 'children': []}]}]}, {'type': 'Property', 'name': 'stats', 'range': [1763, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1763, 1781], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1777, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1777, 1781], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1769, 1775], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1769, 1771], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1769, 1771], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1770, 1771], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1772, 1775], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1773, 1775], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1781, 1781], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1787, 1823], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [1789, 1823], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().update', 'range': [1790, 1822], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1790, 1792], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1790, 1792], 'children': []}, {'type': 'Property', 'name': 'prisma', 'range': [1791, 1792], 'children': []}]}, {'type': 'CallExpression', 'name': 'prisma().update', 'range': [1793, 1822], 'children': [{'type': 'MemberExpression', 'name': 'prisma().update', 'range': [1793, 1796], 'children': [{'type': 'CallExpression', 'name': 'prisma', 'range': [1793, 1795], 'children': [{'type': 'Identifier', 'name': 'prisma', 'range': [1793, 1795], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1794, 1795], 'children': []}]}, {'type': 'Property', 'name': 'update', 'range': [1795, 1796], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1797, 1822], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [1799, 1806], 'children': [{'type': 'Property', 'name': 'id', 'range': [1802, 1805], 'children': [{'type': 'Identifier', 'name': 'id', 'range': [1802, 1805], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1804, 1805], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1808, 1811], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1808, 1811], 'children': []}]}, {'type': 'Comment', 'name': '# type: ignore', 'range': [1812, 1816], 'children': []}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [1819, 1820], 'children': []}]}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1824, 1835], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1825, 1827], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [1825, 1827], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1826, 1827], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1828, 1835], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1829, 1834], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1830, 1834], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1830, 1834], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1831, 1834], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Execution {node_exec_id} not found."', 'range': [1832, 1834], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1833, 1834], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1837, 1844], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1843], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1840], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [1838, 1840], 'children': []}, {'type': 'Property', 'name': 'from_db', 'range': [1839, 1840], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1841, 1843], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1842, 1843], 'children': []}]}]}]}]}]}]}
2025-01-08 10:23:04,688 - INFO - Starting Step 4: AST normalization
2025-01-08 10:23:34,760 - INFO - Step 5 result: {'type': 'Program', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'FunctionDecl', 'name': 'create_graph_execution', 'range': [745, 950], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [745, 745]}, {'type': 'Keyword', 'name': 'def', 'range': [746, 746]}, {'type': 'Identifier', 'name': 'create_graph_execution', 'range': [747, 747]}, {'type': 'Parameter', 'name': 'graph_id', 'range': [750, 752], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [750, 750]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [752, 752]}]}, {'type': 'Parameter', 'name': 'graph_version', 'range': [755, 757], 'children': [{'type': 'Identifier', 'name': 'graph_version', 'range': [755, 755]}, {'type': 'TypeAnnotation', 'name': 'int', 'range': [757, 757]}]}, {'type': 'Parameter', 'name': 'nodes_input', 'range': [760, 770], 'children': [{'type': 'Identifier', 'name': 'nodes_input', 'range': [760, 760]}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [762, 762]}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [764, 764]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [766, 766]}, {'type': 'TypeAnnotation', 'name': 'BlockInput', 'range': [768, 768]}]}, {'type': 'Parameter', 'name': 'user_id', 'range': [773, 775], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [773, 773]}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [775, 775]}]}, {'type': 'TypeAnnotation', 'name': 'tuple', 'range': [781, 781], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [783, 783]}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [785, 785]}, {'type': 'TypeAnnotation', 'name': 'ExecutionResult', 'range': [787, 787]}]}, {'type': 'Block', 'name': 'FunctionBody', 'range': [796, 950], 'children': [{'type': 'VariableDecl', 'name': 'result', 'range': [796, 925], 'children': [{'type': 'Identifier', 'name': 'result', 'range': [796, 796]}, {'type': 'Keyword', 'name': 'await', 'range': [798, 798]}, {'type': 'Identifier', 'name': 'AgentGraphExecution', 'range': [799, 799]}, {'type': 'Identifier', 'name': 'prisma', 'range': [801, 801]}, {'type': 'Identifier', 'name': 'create', 'range': [805, 805]}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [808, 913], 'children': [{'type': 'Property', 'name': '"agentGraphId"', 'range': [812, 814], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphId"', 'range': [812, 812]}, {'type': 'Identifier', 'name': 'graph_id', 'range': [814, 814]}]}, {'type': 'Property', 'name': '"agentGraphVersion"', 'range': [817, 819], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphVersion"', 'range': [817, 817]}, {'type': 'Identifier', 'name': 'graph_version', 'range': [819, 819]}]}, {'type': 'Property', 'name': '"executionStatus"', 'range': [822, 826], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [822, 822]}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [824, 824]}, {'type': 'Identifier', 'name': 'QUEUED', 'range': [826, 826]}]}, {'type': 'Property', 'name': '"AgentNodeExecutions"', 'range': [829, 905], 'children': [{'type': 'StringLiteral', 'name': '"AgentNodeExecutions"', 'range': [829, 829]}, {'type': 'ObjectLiteral', 'name': 'NodeExecution', 'range': [841, 894], 'children': [{'type': 'Property', 'name': '"agentNodeId"', 'range': [843, 845], 'children': [{'type': 'StringLiteral', 'name': '"agentNodeId"', 'range': [843, 843]}, {'type': 'Identifier', 'name': 'node_id', 'range': [845, 845]}]}, {'type': 'Property', 'name': '"executionStatus"', 'range': [848, 852], 'children': [{'type': 'StringLiteral', 'name': '"executionStatus"', 'range': [848, 848]}, {'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [850, 850]}, {'type': 'Identifier', 'name': 'INCOMPLETE', 'range': [852, 852]}]}, {'type': 'Property', 'name': '"Input"', 'range': [855, 891], 'children': [{'type': 'StringLiteral', 'name': '"Input"', 'range': [855, 855]}, {'type': 'ObjectLiteral', 'name': 'InputData', 'range': [863, 876], 'children': [{'type': 'Property', 'name': '"name"', 'range': [864, 866], 'children': [{'type': 'StringLiteral', 'name': '"name"', 'range': [864, 864]}, {'type': 'Identifier', 'name': 'name', 'range': [866, 866]}]}, {'type': 'Property', 'name': '"data"', 'range': [868, 875], 'children': [{'type': 'StringLiteral', 'name': '"data"', 'range': [868, 868]}, {'type': 'Identifier', 'name': 'json', 'range': [870, 870]}, {'type': 'Identifier', 'name': 'dumps', 'range': [872, 872]}, {'type': 'Identifier', 'name': 'data', 'range': [874, 874]}]}]}]}]}]}, {'type': 'Property', 'name': '"userId"', 'range': [908, 910], 'children': [{'type': 'StringLiteral', 'name': '"userId"', 'range': [908, 908]}, {'type': 'Identifier', 'name': 'user_id', 'range': [910, 910]}]}]}, {'type': 'Property', 'name': 'include', 'range': [916, 918], 'children': [{'type': 'Identifier', 'name': 'include', 'range': [916, 916]}, {'type': 'Identifier', 'name': 'GRAPH_EXECUTION_INCLUDE', 'range': [918, 918]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [924, 948], 'children': [{'type': 'Identifier', 'name': 'result', 'range': [925, 925]}, {'type': 'Identifier', 'name': 'id', 'range': [927, 927]}, {'type': 'ArrayLiteral', 'name': 'ExecutionResults', 'range': [929, 948], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [931, 936], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [931, 931]}, {'type': 'Identifier', 'name': 'from_db', 'range': [933, 933]}, {'type': 'Identifier', 'name': 'execution', 'range': [935, 935]}]}, {'type': 'ForStatement', 'name': 'for', 'range': [938, 947], 'children': [{'type': 'Identifier', 'name': 'execution', 'range': [939, 939]}, {'type': 'Identifier', 'name': 'result', 'range': [941, 941]}, {'type': 'Identifier', 'name': 'AgentNodeExecutions', 'range': [943, 943]}]}]}]}]}]}]}
2025-01-08 10:23:34,760 - INFO - Completed main AST analysis flow
2025-01-08 10:23:34,762 - INFO - Successfully processed chunk
2025-01-08 10:23:50,731 - INFO - Step 4 result: {'type': 'Program', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'FunctionDecl', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'Arguments', 'name': '', 'range': [2165, 2169], 'children': [{'type': 'Argument', 'name': 'data', 'range': [2166, 2168], 'children': []}]}, {'type': 'ReturnType', 'name': 'BlockInput', 'range': [2170, 2172], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [2175, 2177], 'children': []}, {'type': 'Comment', 'name': '', 'range': [2180, 2198], 'children': []}, {'type': 'AssignmentExpression', 'name': 'items', 'range': [2200, 2209], 'children': [{'type': 'CallExpression', 'name': 'list', 'range': [2202, 2209], 'children': [{'type': 'MemberExpression', 'name': 'items', 'range': [2204, 2208], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2204, 2205], 'children': []}]}]}]}, {'type': 'ForStatement', 'name': '', 'range': [2212, 2340], 'children': [{'type': 'VariableDeclaration', 'name': '', 'range': [2213, 2215], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2213, 2214], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2215, 2215], 'children': []}]}, {'type': 'Identifier', 'name': 'items', 'range': [2217, 2217], 'children': []}, {'type': 'IfStatement', 'name': '', 'range': [2220, 2227], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2221, 2225], 'children': [{'type': 'Identifier', 'name': 'LIST_SPLIT', 'range': [2221, 2221], 'children': []}, {'type': 'Identifier', 'name': 'key', 'range': [2224, 2224], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2226, 2227], 'children': [{'type': 'ContinueStatement', 'name': '', 'range': [2227, 2227], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'name, index', 'range': [2229, 2239], 'children': [{'type': 'CallExpression', 'name': 'split', 'range': [2233, 2239], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2233, 2234], 'children': []}, {'type': 'Identifier', 'name': 'LIST_SPLIT', 'range': [2237, 2237], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [2240, 2254], 'children': [{'type': 'UnaryExpression', 'name': '', 'range': [2241, 2247], 'children': [{'type': 'CallExpression', 'name': 'isdigit', 'range': [2243, 2247], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2243, 2244], 'children': []}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [2248, 2254], 'children': [{'type': 'ThrowStatement', 'name': '', 'range': [2249, 2254], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [2250, 2254], 'children': [{'type': 'Literal', 'name': '', 'range': [2252, 2253], 'children': []}]}]}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2257, 2271], 'children': [{'type': 'CallExpression', 'name': 'get', 'range': [2262, 2271], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2262, 2263], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2266, 2266], 'children': []}, {'type': 'ArrayExpression', 'name': '', 'range': [2268, 2270], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [2272, 2340], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2273, 2286], 'children': [{'type': 'CallExpression', 'name': 'int', 'range': [2273, 2277], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2275, 2276], 'children': []}]}, {'type': 'Identifier', 'name': 'GtE', 'range': [2277, 2278], 'children': []}, {'type': 'CallExpression', 'name': 'len', 'range': [2279, 2286], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2281, 2285], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2281, 2282], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2283, 2284], 'children': []}]}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [2287, 2340], 'children': [{'type': 'Comment', 'name': '', 'range': [2288, 2297], 'children': []}, {'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2299, 2327], 'children': [{'type': 'CallExpression', 'name': 'extend', 'range': [2303, 2327], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2299, 2300], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2301, 2302], 'children': []}, {'type': 'BinaryExpression', 'name': '', 'range': [2306, 2326], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [2306, 2308], 'children': []}, {'type': 'Identifier', 'name': 'Mult', 'range': [2309, 2309], 'children': []}, {'type': 'BinaryExpression', 'name': '', 'range': [2310, 2325], 'children': [{'type': 'CallExpression', 'name': 'int', 'range': [2310, 2314], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2312, 2313], 'children': []}]}, {'type': 'Identifier', 'name': 'Sub', 'range': [2315, 2315], 'children': []}, {'type': 'CallExpression', 'name': 'len', 'range': [2316, 2323], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2318, 2322], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2318, 2319], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2320, 2321], 'children': []}]}]}, {'type': 'Identifier', 'name': 'Add', 'range': [2323, 2323], 'children': []}, {'type': 'Literal', 'name': '1', 'range': [2324, 2325], 'children': []}]}]}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name][int(index)]', 'range': [2328, 2340], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2328, 2338], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2328, 2329], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2330, 2331], 'children': []}, {'type': 'CallExpression', 'name': 'int', 'range': [2333, 2337], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2335, 2336], 'children': []}]}]}, {'type': 'Identifier', 'name': 'value', 'range': [2339, 2340], 'children': []}]}]}]}]}, {'type': 'Comment', 'name': '', 'range': [2342, 2360], 'children': []}, {'type': 'ForStatement', 'name': '', 'range': [2362, 2414], 'children': [{'type': 'VariableDeclaration', 'name': '', 'range': [2363, 2365], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2363, 2364], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2365, 2365], 'children': []}]}, {'type': 'Identifier', 'name': 'items', 'range': [2367, 2367], 'children': []}, {'type': 'IfStatement', 'name': '', 'range': [2370, 2377], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2371, 2375], 'children': [{'type': 'Identifier', 'name': 'DICT_SPLIT', 'range': [2371, 2371], 'children': []}, {'type': 'Identifier', 'name': 'key', 'range': [2374, 2374], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2376, 2377], 'children': [{'type': 'ContinueStatement', 'name': '', 'range': [2377, 2377], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'name, index', 'range': [2379, 2389], 'children': [{'type': 'CallExpression', 'name': 'split', 'range': [2383, 2389], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2383, 2384], 'children': []}, {'type': 'Identifier', 'name': 'DICT_SPLIT', 'range': [2387, 2387], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2390, 2404], 'children': [{'type': 'CallExpression', 'name': 'get', 'range': [2395, 2404], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2395, 2396], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2399, 2399], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [2401, 2403], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name][index]', 'range': [2405, 2414], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2405, 2412], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2405, 2406], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2407, 2408], 'children': []}, {'type': 'Identifier', 'name': 'index', 'range': [2410, 2411], 'children': []}]}, {'type': 'Identifier', 'name': 'value', 'range': [2413, 2414], 'children': []}]}]}, {'type': 'Comment', 'name': '', 'range': [2416, 2434], 'children': []}, {'type': 'ForStatement', 'name': '', 'range': [2436, 2504], 'children': [{'type': 'VariableDeclaration', 'name': '', 'range': [2437, 2439], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2437, 2438], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2439, 2439], 'children': []}]}, {'type': 'Identifier', 'name': 'items', 'range': [2441, 2441], 'children': []}, {'type': 'IfStatement', 'name': '', 'range': [2444, 2451], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2445, 2449], 'children': [{'type': 'Identifier', 'name': 'OBJC_SPLIT', 'range': [2445, 2445], 'children': []}, {'type': 'Identifier', 'name': 'key', 'range': [2448, 2448], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2450, 2451], 'children': [{'type': 'ContinueStatement', 'name': '', 'range': [2451, 2451], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'name, index', 'range': [2453, 2463], 'children': [{'type': 'CallExpression', 'name': 'split', 'range': [2457, 2463], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2457, 2458], 'children': []}, {'type': 'Identifier', 'name': 'OBJC_SPLIT', 'range': [2461, 2461], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [2464, 2482], 'children': [{'type': 'LogicalExpression', 'name': '', 'range': [2465, 2480], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2466, 2468], 'children': [{'type': 'Identifier', 'name': 'name', 'range': [2465, 2466], 'children': []}, {'type': 'Identifier', 'name': 'data', 'range': [2468, 2468], 'children': []}]}, {'type': 'UnaryExpression', 'name': '', 'range': [2470, 2470], 'children': []}, {'type': 'CallExpression', 'name': 'isinstance', 'range': [2471, 2480], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2473, 2477], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2473, 2474], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2475, 2476], 'children': []}]}, {'type': 'Identifier', 'name': 'object', 'range': [2478, 2479], 'children': []}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [2481, 2482], 'children': [{'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2482, 2492], 'children': [{'type': 'NewExpression', 'name': 'MockObject', 'range': [2487, 2492], 'children': [{'type': 'Identifier', 'name': 'mock', 'range': [2487, 2488], 'children': []}]}]}]}]}, {'type': 'ExpressionStatement', 'name': 'setattr(data[name], index, value)', 'range': [2493, 2504], 'children': [{'type': 'CallExpression', 'name': 'setattr', 'range': [2493, 2504], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2495, 2499], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2495, 2496], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2497, 2498], 'children': []}]}, {'type': 'Identifier', 'name': 'index', 'range': [2500, 2501], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2502, 2503], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': '', 'range': [2506, 2507], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2507, 2507], 'children': []}]}]}]}
2025-01-08 10:23:50,731 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:24:58,753 - INFO - Step 4 result: {'type': 'Program', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'FunctionDecl', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1566, 1571], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1567, 1570], 'children': []}, {'type': 'FunctionName', 'name': 'update_execution_status', 'range': [1568, 1588], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1569, 1604], 'children': [{'type': 'Parameter', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': [{'type': 'ParameterName', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1572, 1574], 'children': []}]}, {'type': 'Parameter', 'name': 'status', 'range': [1576, 1579], 'children': [{'type': 'ParameterName', 'name': 'status', 'range': [1576, 1579], 'children': []}, {'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [1577, 1579], 'children': []}]}, {'type': 'Parameter', 'name': 'execution_data', 'range': [1581, 1587], 'children': [{'type': 'ParameterName', 'name': 'execution_data', 'range': [1581, 1587], 'children': []}, {'type': 'TypeAnnotation', 'name': 'BlockInput | None', 'range': [1582, 1587], 'children': []}]}, {'type': 'Parameter', 'name': 'stats', 'range': [1590, 1601], 'children': [{'type': 'ParameterName', 'name': 'stats', 'range': [1590, 1601], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any] | None', 'range': [1591, 1601], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1605, 1607], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1608, 1845], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [1610, 1628], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1611, 1621], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1611, 1614], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1611, 1614], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1614, 1616], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1614, 1616], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1615, 1616], 'children': []}]}]}, {'type': 'BinaryExpression', 'name': 'and', 'range': [1617, 1621], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1617, 1621], 'children': []}, {'type': 'NullLiteral', 'name': 'None', 'range': [1619, 1621], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1622, 1628], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1623, 1627], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1624, 1627], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1624, 1627], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1625, 1627], 'children': [{'type': 'StringLiteral', 'name': '"Execution data must be provided when queuing an execution."', 'range': [1626, 1627], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'VariableDeclarator', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'Identifier', 'name': 'now', 'range': [1630, 1642], 'children': []}, {'type': 'CallExpression', 'name': 'datetime.now', 'range': [1632, 1641], 'children': [{'type': 'MemberExpression', 'name': 'datetime.now', 'range': [1632, 1634], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1632, 1634], 'children': []}, {'type': 'Property', 'name': 'now', 'range': [1633, 1634], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1635, 1641], 'children': [{'type': 'AssignmentExpression', 'name': 'tz=', 'range': [1636, 1640], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1636, 1640], 'children': []}, {'type': 'MemberExpression', 'name': 'timezone.utc', 'range': [1638, 1640], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1638, 1640], 'children': []}, {'type': 'Property', 'name': 'utc', 'range': [1639, 1640], 'children': []}]}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'VariableDeclarator', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1643, 1784], 'children': []}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1645, 1784], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1647, 1654], 'children': [{'type': 'Identifier', 'name': 'executionStatus', 'range': [1647, 1654], 'children': []}, {'type': 'Identifier', 'name': 'status', 'range': [1653, 1654], 'children': []}]}, {'type': 'Property', 'name': 'queuedTime', 'range': [1658, 1676], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1658, 1676], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1666, 1676], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1667, 1670], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1667, 1670], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1670, 1672], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1670, 1672], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1671, 1672], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1673, 1675], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [1673, 1675], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1673, 1675], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1674, 1675], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1676, 1676], 'children': []}]}]}, {'type': 'Property', 'name': 'startedTime', 'range': [1679, 1697], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1679, 1697], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1687, 1697], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1688, 1691], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1688, 1691], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.RUNNING', 'range': [1691, 1693], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1691, 1693], 'children': []}, {'type': 'Property', 'name': 'RUNNING', 'range': [1692, 1693], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1694, 1696], 'children': [{'type': 'Property', 'name': 'startedTime', 'range': [1694, 1696], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1694, 1696], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1695, 1696], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1697, 1697], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1700, 1718], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1700, 1718], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1708, 1718], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1709, 1712], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1709, 1712], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.FAILED', 'range': [1712, 1714], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1712, 1714], 'children': []}, {'type': 'Property', 'name': 'FAILED', 'range': [1713, 1714], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1715, 1717], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1715, 1717], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1715, 1717], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1716, 1717], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1718, 1718], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1721, 1739], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1721, 1739], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1729, 1739], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1730, 1733], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1730, 1733], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.COMPLETED', 'range': [1733, 1735], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1733, 1735], 'children': []}, {'type': 'Property', 'name': 'COMPLETED', 'range': [1734, 1735], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1736, 1738], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1736, 1738], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1736, 1738], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1737, 1738], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1739, 1739], 'children': []}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [1742, 1760], 'children': [{'type': 'Identifier', 'name': 'executionData', 'range': [1742, 1760], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1756, 1760], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1756, 1760], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1748, 1754], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1748, 1750], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1748, 1750], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1749, 1750], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1751, 1754], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1752, 1754], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1760, 1760], 'children': []}]}]}, {'type': 'Property', 'name': 'stats', 'range': [1763, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1763, 1781], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1777, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1777, 1781], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1769, 1775], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1769, 1771], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1769, 1771], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1770, 1771], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1772, 1775], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1773, 1775], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1781, 1781], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1787, 1823], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [1789, 1823], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().update', 'range': [1790, 1822], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1790, 1792], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1790, 1792], 'children': []}, {'type': 'Property', 'name': 'prisma', 'range': [1791, 1792], 'children': []}]}, {'type': 'CallExpression', 'name': 'prisma().update', 'range': [1793, 1822], 'children': [{'type': 'MemberExpression', 'name': 'prisma().update', 'range': [1793, 1796], 'children': [{'type': 'CallExpression', 'name': 'prisma', 'range': [1793, 1795], 'children': [{'type': 'Identifier', 'name': 'prisma', 'range': [1793, 1795], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1794, 1795], 'children': []}]}, {'type': 'Property', 'name': 'update', 'range': [1795, 1796], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1797, 1822], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [1799, 1806], 'children': [{'type': 'Property', 'name': 'id', 'range': [1802, 1805], 'children': [{'type': 'Identifier', 'name': 'id', 'range': [1802, 1805], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1804, 1805], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1808, 1811], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1808, 1811], 'children': []}]}, {'type': 'Comment', 'name': '# type: ignore', 'range': [1812, 1816], 'children': []}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [1819, 1820], 'children': []}]}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1824, 1835], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1825, 1827], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [1825, 1827], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1826, 1827], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1828, 1835], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1829, 1834], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1830, 1834], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1830, 1834], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1831, 1834], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Execution {node_exec_id} not found."', 'range': [1832, 1834], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1833, 1834], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1837, 1844], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1843], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1840], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [1838, 1840], 'children': []}, {'type': 'Property', 'name': 'from_db', 'range': [1839, 1840], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1841, 1843], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1842, 1843], 'children': []}]}]}]}]}]}]}
2025-01-08 10:24:58,753 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:25:22,729 - INFO - Step 5 result: {'type': 'Program', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'FunctionDecl', 'name': 'merge_execution_input', 'range': [2163, 2509], 'children': [{'type': 'Arguments', 'name': '', 'range': [2165, 2169], 'children': [{'type': 'Argument', 'name': 'data', 'range': [2166, 2168], 'children': []}]}, {'type': 'ReturnType', 'name': 'BlockInput', 'range': [2170, 2172], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [2175, 2177], 'children': []}, {'type': 'Comment', 'name': '', 'range': [2180, 2198], 'children': []}, {'type': 'AssignmentExpression', 'name': 'items', 'range': [2200, 2209], 'children': [{'type': 'CallExpression', 'name': 'list', 'range': [2202, 2209], 'children': [{'type': 'MemberExpression', 'name': 'items', 'range': [2204, 2208], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2204, 2205], 'children': []}]}]}]}, {'type': 'ForStatement', 'name': '', 'range': [2212, 2340], 'children': [{'type': 'VariableDeclaration', 'name': '', 'range': [2213, 2215], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2213, 2214], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2215, 2215], 'children': []}]}, {'type': 'Identifier', 'name': 'items', 'range': [2217, 2217], 'children': []}, {'type': 'IfStatement', 'name': '', 'range': [2220, 2227], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2221, 2225], 'children': [{'type': 'Identifier', 'name': 'LIST_SPLIT', 'range': [2221, 2221], 'children': []}, {'type': 'Identifier', 'name': 'key', 'range': [2224, 2224], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2226, 2227], 'children': [{'type': 'ContinueStatement', 'name': '', 'range': [2227, 2227], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'name, index', 'range': [2229, 2239], 'children': [{'type': 'CallExpression', 'name': 'split', 'range': [2233, 2239], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2233, 2234], 'children': []}, {'type': 'Identifier', 'name': 'LIST_SPLIT', 'range': [2237, 2237], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [2240, 2254], 'children': [{'type': 'UnaryExpression', 'name': '', 'range': [2241, 2247], 'children': [{'type': 'CallExpression', 'name': 'isdigit', 'range': [2243, 2247], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2243, 2244], 'children': []}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [2248, 2254], 'children': [{'type': 'ThrowStatement', 'name': '', 'range': [2249, 2254], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [2250, 2254], 'children': [{'type': 'Literal', 'name': '', 'range': [2252, 2253], 'children': []}]}]}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2257, 2271], 'children': [{'type': 'CallExpression', 'name': 'get', 'range': [2262, 2271], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2262, 2263], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2266, 2266], 'children': []}, {'type': 'ArrayExpression', 'name': '', 'range': [2268, 2270], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [2272, 2340], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2273, 2286], 'children': [{'type': 'CallExpression', 'name': 'int', 'range': [2273, 2277], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2275, 2276], 'children': []}]}, {'type': 'Identifier', 'name': 'GtE', 'range': [2277, 2278], 'children': []}, {'type': 'CallExpression', 'name': 'len', 'range': [2279, 2286], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2281, 2285], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2281, 2282], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2283, 2284], 'children': []}]}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [2287, 2340], 'children': [{'type': 'Comment', 'name': '', 'range': [2288, 2297], 'children': []}, {'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2299, 2327], 'children': [{'type': 'CallExpression', 'name': 'extend', 'range': [2303, 2327], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2299, 2300], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2301, 2302], 'children': []}, {'type': 'BinaryExpression', 'name': '', 'range': [2306, 2326], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [2306, 2308], 'children': []}, {'type': 'Identifier', 'name': 'Mult', 'range': [2309, 2309], 'children': []}, {'type': 'BinaryExpression', 'name': '', 'range': [2310, 2325], 'children': [{'type': 'CallExpression', 'name': 'int', 'range': [2310, 2314], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2312, 2313], 'children': []}]}, {'type': 'Identifier', 'name': 'Sub', 'range': [2315, 2315], 'children': []}, {'type': 'CallExpression', 'name': 'len', 'range': [2316, 2323], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2318, 2322], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2318, 2319], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2320, 2321], 'children': []}]}]}, {'type': 'Identifier', 'name': 'Add', 'range': [2323, 2323], 'children': []}, {'type': 'Literal', 'name': '1', 'range': [2324, 2325], 'children': []}]}]}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name][int(index)]', 'range': [2328, 2340], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2328, 2338], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2328, 2329], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2330, 2331], 'children': []}, {'type': 'CallExpression', 'name': 'int', 'range': [2333, 2337], 'children': [{'type': 'Identifier', 'name': 'index', 'range': [2335, 2336], 'children': []}]}]}, {'type': 'Identifier', 'name': 'value', 'range': [2339, 2340], 'children': []}]}]}]}]}, {'type': 'Comment', 'name': '', 'range': [2342, 2360], 'children': []}, {'type': 'ForStatement', 'name': '', 'range': [2362, 2414], 'children': [{'type': 'VariableDeclaration', 'name': '', 'range': [2363, 2365], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2363, 2364], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2365, 2365], 'children': []}]}, {'type': 'Identifier', 'name': 'items', 'range': [2367, 2367], 'children': []}, {'type': 'IfStatement', 'name': '', 'range': [2370, 2377], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2371, 2375], 'children': [{'type': 'Identifier', 'name': 'DICT_SPLIT', 'range': [2371, 2371], 'children': []}, {'type': 'Identifier', 'name': 'key', 'range': [2374, 2374], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2376, 2377], 'children': [{'type': 'ContinueStatement', 'name': '', 'range': [2377, 2377], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'name, index', 'range': [2379, 2389], 'children': [{'type': 'CallExpression', 'name': 'split', 'range': [2383, 2389], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2383, 2384], 'children': []}, {'type': 'Identifier', 'name': 'DICT_SPLIT', 'range': [2387, 2387], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2390, 2404], 'children': [{'type': 'CallExpression', 'name': 'get', 'range': [2395, 2404], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2395, 2396], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2399, 2399], 'children': []}, {'type': 'ObjectExpression', 'name': '', 'range': [2401, 2403], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'data[name][index]', 'range': [2405, 2414], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2405, 2412], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2405, 2406], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2407, 2408], 'children': []}, {'type': 'Identifier', 'name': 'index', 'range': [2410, 2411], 'children': []}]}, {'type': 'Identifier', 'name': 'value', 'range': [2413, 2414], 'children': []}]}]}, {'type': 'Comment', 'name': '', 'range': [2416, 2434], 'children': []}, {'type': 'ForStatement', 'name': '', 'range': [2436, 2504], 'children': [{'type': 'VariableDeclaration', 'name': '', 'range': [2437, 2439], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2437, 2438], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2439, 2439], 'children': []}]}, {'type': 'Identifier', 'name': 'items', 'range': [2441, 2441], 'children': []}, {'type': 'IfStatement', 'name': '', 'range': [2444, 2451], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2445, 2449], 'children': [{'type': 'Identifier', 'name': 'OBJC_SPLIT', 'range': [2445, 2445], 'children': []}, {'type': 'Identifier', 'name': 'key', 'range': [2448, 2448], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [2450, 2451], 'children': [{'type': 'ContinueStatement', 'name': '', 'range': [2451, 2451], 'children': []}]}]}, {'type': 'AssignmentExpression', 'name': 'name, index', 'range': [2453, 2463], 'children': [{'type': 'CallExpression', 'name': 'split', 'range': [2457, 2463], 'children': [{'type': 'Identifier', 'name': 'key', 'range': [2457, 2458], 'children': []}, {'type': 'Identifier', 'name': 'OBJC_SPLIT', 'range': [2461, 2461], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [2464, 2482], 'children': [{'type': 'LogicalExpression', 'name': '', 'range': [2465, 2480], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [2466, 2468], 'children': [{'type': 'Identifier', 'name': 'name', 'range': [2465, 2466], 'children': []}, {'type': 'Identifier', 'name': 'data', 'range': [2468, 2468], 'children': []}]}, {'type': 'UnaryExpression', 'name': '', 'range': [2470, 2470], 'children': []}, {'type': 'CallExpression', 'name': 'isinstance', 'range': [2471, 2480], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2473, 2477], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2473, 2474], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2475, 2476], 'children': []}]}, {'type': 'Identifier', 'name': 'object', 'range': [2478, 2479], 'children': []}]}]}, {'type': 'BlockStatement', 'name': '', 'range': [2481, 2482], 'children': [{'type': 'AssignmentExpression', 'name': 'data[name]', 'range': [2482, 2492], 'children': [{'type': 'NewExpression', 'name': 'MockObject', 'range': [2487, 2492], 'children': [{'type': 'Identifier', 'name': 'mock', 'range': [2487, 2488], 'children': []}]}]}]}]}, {'type': 'ExpressionStatement', 'name': 'setattr(data[name], index, value)', 'range': [2493, 2504], 'children': [{'type': 'CallExpression', 'name': 'setattr', 'range': [2493, 2504], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [2495, 2499], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2495, 2496], 'children': []}, {'type': 'Identifier', 'name': 'name', 'range': [2497, 2498], 'children': []}]}, {'type': 'Identifier', 'name': 'index', 'range': [2500, 2501], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [2502, 2503], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': '', 'range': [2506, 2507], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [2507, 2507], 'children': []}]}]}]}
2025-01-08 10:25:22,729 - INFO - Completed main AST analysis flow
2025-01-08 10:25:22,730 - INFO - Successfully processed chunk
2025-01-08 10:26:48,933 - INFO - Step 5 result: {'type': 'Program', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'FunctionDecl', 'name': 'update_execution_status', 'range': [1566, 1845], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1566, 1571], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1567, 1570], 'children': []}, {'type': 'FunctionName', 'name': 'update_execution_status', 'range': [1568, 1588], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [1569, 1604], 'children': [{'type': 'Parameter', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': [{'type': 'ParameterName', 'name': 'node_exec_id', 'range': [1571, 1574], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1572, 1574], 'children': []}]}, {'type': 'Parameter', 'name': 'status', 'range': [1576, 1579], 'children': [{'type': 'ParameterName', 'name': 'status', 'range': [1576, 1579], 'children': []}, {'type': 'TypeAnnotation', 'name': 'ExecutionStatus', 'range': [1577, 1579], 'children': []}]}, {'type': 'Parameter', 'name': 'execution_data', 'range': [1581, 1587], 'children': [{'type': 'ParameterName', 'name': 'execution_data', 'range': [1581, 1587], 'children': []}, {'type': 'TypeAnnotation', 'name': 'BlockInput | None', 'range': [1582, 1587], 'children': []}]}, {'type': 'Parameter', 'name': 'stats', 'range': [1590, 1601], 'children': [{'type': 'ParameterName', 'name': 'stats', 'range': [1590, 1601], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict[str, Any] | None', 'range': [1591, 1601], 'children': []}]}]}, {'type': 'ReturnType', 'name': 'ExecutionResult', 'range': [1605, 1607], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [1608, 1845], 'children': [{'type': 'IfStatement', 'name': 'if', 'range': [1610, 1628], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1611, 1621], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1611, 1614], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1611, 1614], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1614, 1616], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1614, 1616], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1615, 1616], 'children': []}]}]}, {'type': 'BinaryExpression', 'name': 'and', 'range': [1617, 1621], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1617, 1621], 'children': []}, {'type': 'NullLiteral', 'name': 'None', 'range': [1619, 1621], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1622, 1628], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1623, 1627], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1624, 1627], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1624, 1627], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1625, 1627], 'children': [{'type': 'StringLiteral', 'name': '"Execution data must be provided when queuing an execution."', 'range': [1626, 1627], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'VariableDeclarator', 'name': 'now', 'range': [1630, 1642], 'children': [{'type': 'Identifier', 'name': 'now', 'range': [1630, 1642], 'children': []}, {'type': 'CallExpression', 'name': 'datetime.now', 'range': [1632, 1641], 'children': [{'type': 'MemberExpression', 'name': 'datetime.now', 'range': [1632, 1634], 'children': [{'type': 'Identifier', 'name': 'datetime', 'range': [1632, 1634], 'children': []}, {'type': 'Property', 'name': 'now', 'range': [1633, 1634], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1635, 1641], 'children': [{'type': 'AssignmentExpression', 'name': 'tz=', 'range': [1636, 1640], 'children': [{'type': 'Identifier', 'name': 'tz', 'range': [1636, 1640], 'children': []}, {'type': 'MemberExpression', 'name': 'timezone.utc', 'range': [1638, 1640], 'children': [{'type': 'Identifier', 'name': 'timezone', 'range': [1638, 1640], 'children': []}, {'type': 'Property', 'name': 'utc', 'range': [1639, 1640], 'children': []}]}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'VariableDeclarator', 'name': 'data', 'range': [1643, 1784], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1643, 1784], 'children': []}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1645, 1784], 'children': [{'type': 'Property', 'name': 'executionStatus', 'range': [1647, 1654], 'children': [{'type': 'Identifier', 'name': 'executionStatus', 'range': [1647, 1654], 'children': []}, {'type': 'Identifier', 'name': 'status', 'range': [1653, 1654], 'children': []}]}, {'type': 'Property', 'name': 'queuedTime', 'range': [1658, 1676], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1658, 1676], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1666, 1676], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1667, 1670], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1667, 1670], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.QUEUED', 'range': [1670, 1672], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1670, 1672], 'children': []}, {'type': 'Property', 'name': 'QUEUED', 'range': [1671, 1672], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1673, 1675], 'children': [{'type': 'Property', 'name': 'queuedTime', 'range': [1673, 1675], 'children': [{'type': 'Identifier', 'name': 'queuedTime', 'range': [1673, 1675], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1674, 1675], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1676, 1676], 'children': []}]}]}, {'type': 'Property', 'name': 'startedTime', 'range': [1679, 1697], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1679, 1697], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1687, 1697], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1688, 1691], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1688, 1691], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.RUNNING', 'range': [1691, 1693], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1691, 1693], 'children': []}, {'type': 'Property', 'name': 'RUNNING', 'range': [1692, 1693], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1694, 1696], 'children': [{'type': 'Property', 'name': 'startedTime', 'range': [1694, 1696], 'children': [{'type': 'Identifier', 'name': 'startedTime', 'range': [1694, 1696], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1695, 1696], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1697, 1697], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1700, 1718], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1700, 1718], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1708, 1718], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1709, 1712], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1709, 1712], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.FAILED', 'range': [1712, 1714], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1712, 1714], 'children': []}, {'type': 'Property', 'name': 'FAILED', 'range': [1713, 1714], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1715, 1717], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1715, 1717], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1715, 1717], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1716, 1717], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1718, 1718], 'children': []}]}]}, {'type': 'Property', 'name': 'endedTime', 'range': [1721, 1739], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1721, 1739], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1729, 1739], 'children': [{'type': 'BinaryExpression', 'name': '==', 'range': [1730, 1733], 'children': [{'type': 'Identifier', 'name': 'status', 'range': [1730, 1733], 'children': []}, {'type': 'MemberExpression', 'name': 'ExecutionStatus.COMPLETED', 'range': [1733, 1735], 'children': [{'type': 'Identifier', 'name': 'ExecutionStatus', 'range': [1733, 1735], 'children': []}, {'type': 'Property', 'name': 'COMPLETED', 'range': [1734, 1735], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1736, 1738], 'children': [{'type': 'Property', 'name': 'endedTime', 'range': [1736, 1738], 'children': [{'type': 'Identifier', 'name': 'endedTime', 'range': [1736, 1738], 'children': []}, {'type': 'Identifier', 'name': 'now', 'range': [1737, 1738], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1739, 1739], 'children': []}]}]}, {'type': 'Property', 'name': 'executionData', 'range': [1742, 1760], 'children': [{'type': 'Identifier', 'name': 'executionData', 'range': [1742, 1760], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1756, 1760], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1756, 1760], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1748, 1754], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1748, 1750], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1748, 1750], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1749, 1750], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1751, 1754], 'children': [{'type': 'Identifier', 'name': 'execution_data', 'range': [1752, 1754], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1760, 1760], 'children': []}]}]}, {'type': 'Property', 'name': 'stats', 'range': [1763, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1763, 1781], 'children': []}, {'type': 'ConditionalExpression', 'name': 'ternary', 'range': [1777, 1781], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1777, 1781], 'children': []}, {'type': 'CallExpression', 'name': 'json.dumps', 'range': [1769, 1775], 'children': [{'type': 'MemberExpression', 'name': 'json.dumps', 'range': [1769, 1771], 'children': [{'type': 'Identifier', 'name': 'json', 'range': [1769, 1771], 'children': []}, {'type': 'Property', 'name': 'dumps', 'range': [1770, 1771], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1772, 1775], 'children': [{'type': 'Identifier', 'name': 'stats', 'range': [1773, 1775], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'object', 'range': [1781, 1781], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'VariableDeclarator', 'name': 'res', 'range': [1787, 1823], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1787, 1823], 'children': []}, {'type': 'AwaitExpression', 'name': 'await', 'range': [1789, 1823], 'children': [{'type': 'CallExpression', 'name': 'AgentNodeExecution.prisma().update', 'range': [1790, 1822], 'children': [{'type': 'MemberExpression', 'name': 'AgentNodeExecution.prisma', 'range': [1790, 1792], 'children': [{'type': 'Identifier', 'name': 'AgentNodeExecution', 'range': [1790, 1792], 'children': []}, {'type': 'Property', 'name': 'prisma', 'range': [1791, 1792], 'children': []}]}, {'type': 'CallExpression', 'name': 'prisma().update', 'range': [1793, 1822], 'children': [{'type': 'MemberExpression', 'name': 'prisma().update', 'range': [1793, 1796], 'children': [{'type': 'CallExpression', 'name': 'prisma', 'range': [1793, 1795], 'children': [{'type': 'Identifier', 'name': 'prisma', 'range': [1793, 1795], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1794, 1795], 'children': []}]}, {'type': 'Property', 'name': 'update', 'range': [1795, 1796], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1797, 1822], 'children': [{'type': 'ObjectExpression', 'name': 'where', 'range': [1799, 1806], 'children': [{'type': 'Property', 'name': 'id', 'range': [1802, 1805], 'children': [{'type': 'Identifier', 'name': 'id', 'range': [1802, 1805], 'children': []}, {'type': 'Identifier', 'name': 'node_exec_id', 'range': [1804, 1805], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [1808, 1811], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [1808, 1811], 'children': []}]}, {'type': 'Comment', 'name': '# type: ignore', 'range': [1812, 1816], 'children': []}, {'type': 'Identifier', 'name': 'EXECUTION_RESULT_INCLUDE', 'range': [1819, 1820], 'children': []}]}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [1824, 1835], 'children': [{'type': 'Condition', 'name': 'condition', 'range': [1825, 1827], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [1825, 1827], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1826, 1827], 'children': []}]}]}, {'type': 'BlockStatement', 'name': 'consequent', 'range': [1828, 1835], 'children': [{'type': 'RaiseStatement', 'name': 'raise', 'range': [1829, 1834], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [1830, 1834], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [1830, 1834], 'children': []}, {'type': 'Arguments', 'name': 'arguments', 'range': [1831, 1834], 'children': [{'type': 'TemplateLiteral', 'name': 'f"Execution {node_exec_id} not found."', 'range': [1832, 1834], 'children': [{'type': 'Identifier', 'name': 'node_exec_id', 'range': [1833, 1834], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [1837, 1844], 'children': [{'type': 'CallExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1843], 'children': [{'type': 'MemberExpression', 'name': 'ExecutionResult.from_db', 'range': [1838, 1840], 'children': [{'type': 'Identifier', 'name': 'ExecutionResult', 'range': [1838, 1840], 'children': []}, {'type': 'Property', 'name': 'from_db', 'range': [1839, 1840], 'children': []}]}, {'type': 'Arguments', 'name': 'arguments', 'range': [1841, 1843], 'children': [{'type': 'Identifier', 'name': 'res', 'range': [1842, 1843], 'children': []}]}]}]}]}]}]}
2025-01-08 10:26:48,933 - INFO - Completed main AST analysis flow
2025-01-08 10:26:48,934 - INFO - Successfully processed chunk
2025-01-08 10:26:49,195 - INFO - Starting code generation from AST
2025-01-08 10:26:49,884 - ERROR - Error in get_code_from_ast: Error code: 400 - {'error': {'message': "This model's maximum context length is 65536 tokens. However, you requested 73084 tokens (64892 in the messages, 8192 in the completion). Please reduce the length of the messages or completion.", 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_request_error'}}
2025-01-08 10:26:49,885 - INFO - Starting static code similarity comparison
2025-01-08 10:26:49,894 - INFO - Static similarity result: {'final_score': 20.19, 'length_similarity': 0.0, 'token_similarity': 0.0, 'structure_similarity': 0.0, 'function_similarity': 100, 'complexity_similarity': 1.92, 'variable_similarity': 100}

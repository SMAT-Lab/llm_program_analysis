2025-01-08 09:55:07,591 - INFO - Processing sample 95
2025-01-08 09:55:07,591 - INFO - Starting Step 0: Splitting code into top-level declarations
2025-01-08 09:55:10,974 - INFO - Successfully split code into 3 top-level declarations
2025-01-08 09:55:10,977 - INFO - Processing chunk #0 (size=418 chars, start_index=0)
2025-01-08 09:55:10,977 - INFO - Processing chunk with 418 chars starting at index 0
2025-01-08 09:55:10,977 - INFO - Starting main AST analysis flow
2025-01-08 09:55:10,978 - INFO - Tokenized code into 88 tokens
2025-01-08 09:55:10,978 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 09:55:10,979 - INFO - Processing chunk #1 (size=1699 chars, start_index=88)
2025-01-08 09:55:10,979 - INFO - Processing chunk with 1699 chars starting at index 88
2025-01-08 09:55:10,979 - INFO - Starting main AST analysis flow
2025-01-08 09:55:10,980 - INFO - Tokenized code into 344 tokens
2025-01-08 09:55:10,980 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 09:55:10,982 - INFO - Processing chunk #2 (size=2949 chars, start_index=432)
2025-01-08 09:55:10,982 - INFO - Processing chunk with 2949 chars starting at index 432
2025-01-08 09:55:10,982 - INFO - Starting main AST analysis flow
2025-01-08 09:55:10,983 - INFO - Tokenized code into 451 tokens
2025-01-08 09:55:10,983 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 09:55:13,325 - INFO - Step 1 result: {'type': 'Program', 'name': 'test_graph_creation', 'range': [100, 431], 'children': []}
2025-01-08 09:55:13,325 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 09:55:13,625 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [432, 442], 'children': []}
2025-01-08 09:55:13,625 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 09:55:19,068 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [0, 87], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 4], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [5, 9], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [11, 13], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [15, 27], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [28, 36], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [37, 49], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [50, 58], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [59, 67], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [68, 76], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [77, 85], 'children': []}]}
2025-01-08 09:55:19,069 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 09:55:42,216 - INFO - Step 2 result: {'nodes': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'Any', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [5, 9], 'children': [{'type': 'FromImport', 'name': 'uuid', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'UUID', 'range': [7, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [11, 13], 'children': [{'type': 'Import', 'name': 'pytest', 'range': [11, 12], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [15, 27], 'children': [{'type': 'FromImport', 'name': 'backend.blocks.basic', 'range': [15, 20], 'children': []}, {'type': 'Import', 'name': 'AgentInputBlock', 'range': [21, 22], 'children': []}, {'type': 'Import', 'name': 'AgentOutputBlock', 'range': [23, 24], 'children': []}, {'type': 'Import', 'name': 'StoreValueBlock', 'range': [25, 26], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [28, 36], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [28, 33], 'children': []}, {'type': 'Import', 'name': 'BlockSchema', 'range': [34, 35], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [37, 49], 'children': [{'type': 'FromImport', 'name': 'backend.data.graph', 'range': [37, 42], 'children': []}, {'type': 'Import', 'name': 'Graph', 'range': [43, 44], 'children': []}, {'type': 'Import', 'name': 'Link', 'range': [45, 46], 'children': []}, {'type': 'Import', 'name': 'Node', 'range': [47, 48], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [50, 58], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [50, 55], 'children': []}, {'type': 'Import', 'name': 'SchemaField', 'range': [56, 57], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [59, 67], 'children': [{'type': 'FromImport', 'name': 'backend.data.user', 'range': [59, 64], 'children': []}, {'type': 'Import', 'name': 'DEFAULT_USER_ID', 'range': [65, 66], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [68, 76], 'children': [{'type': 'FromImport', 'name': 'backend.server.model', 'range': [68, 73], 'children': []}, {'type': 'Import', 'name': 'CreateGraph', 'range': [74, 75], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [77, 85], 'children': [{'type': 'FromImport', 'name': 'backend.util.test', 'range': [77, 82], 'children': []}, {'type': 'Import', 'name': 'SpinTestServer', 'range': [83, 84], 'children': []}]}]}
2025-01-08 09:55:42,216 - INFO - Starting Step 3: AST simplification
2025-01-08 09:55:43,636 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [432, 442], 'children': [{'type': 'Decorator', 'name': '@pytest.mark.asyncio', 'range': [432, 442], 'children': []}, {'type': 'FunctionDef', 'name': 'test_get_input_schema', 'range': [444, 882], 'children': [{'type': 'Async', 'name': 'async', 'range': [444, 449], 'children': []}, {'type': 'Def', 'name': 'def', 'range': [445, 448], 'children': []}, {'type': 'FunctionName', 'name': 'test_get_input_schema', 'range': [446, 466], 'children': []}, {'type': 'Parameters', 'name': '', 'range': [447, 451], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [448, 450], 'children': [{'type': 'TypeAnnotation', 'name': ':', 'range': [449, 450], 'children': [{'type': 'Type', 'name': 'SpinTestServer', 'range': [450, 464], 'children': []}]}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [452, 882], 'children': [{'type': 'Docstring', 'name': '', 'range': [453, 456], 'children': []}, {'type': 'Assignment', 'name': 'value_block = StoreValueBlock().id', 'range': [458, 465], 'children': []}, {'type': 'Assignment', 'name': 'input_block = AgentInputBlock().id', 'range': [466, 473], 'children': []}, {'type': 'Assignment', 'name': 'output_block = AgentOutputBlock().id', 'range': [474, 481], 'children': []}, {'type': 'Assignment', 'name': 'graph = Graph(name="TestInputSchema", description="Test input schema", nodes=[Node(id="node_0_a", block_id=input_block, input_default={"name": "in_key_a", "title": "Key A", "value": "A"}, metadata={"id": "node_0_a"}), Node(id="node_0_b", block_id=input_block, input_default={"name": "in_key_b", "advanced": True}, metadata={"id": "node_0_b"}), Node(id="node_1", block_id=value_block, metadata={"id": "node_1"}), Node(id="node_2", block_id=output_block, input_default={"name": "out_key", "description": "This is an output key"}, metadata={"id": "node_2"})], links=[Link(source_id="node_0_a", sink_id="node_1", source_name="result", sink_name="input"), Link(source_id="node_0_b", sink_id="node_1", source_name="result", sink_name="input"), Link(source_id="node_1", sink_id="node_2", source_name="output", sink_name="value")])', 'range': [483, 732], 'children': []}, {'type': 'Assignment', 'name': 'create_graph = CreateGraph(graph=graph)', 'range': [735, 742], 'children': []}, {'type': 'Assignment', 'name': 'created_graph = await server.agent_server.test_create_graph(create_graph, DEFAULT_USER_ID)', 'range': [744, 758], 'children': []}, {'type': 'ClassDef', 'name': 'ExpectedInputSchema', 'range': [761, 801], 'children': [{'type': 'ClassBody', 'name': '', 'range': [767, 801], 'children': [{'type': 'ClassVariable', 'name': 'in_key_a: Any = SchemaField(title="Key A", default="A", advanced=False)', 'range': [768, 785], 'children': []}, {'type': 'ClassVariable', 'name': 'in_key_b: Any = SchemaField(title="in_key_b", advanced=True)', 'range': [787, 800], 'children': []}]}]}, {'type': 'ClassDef', 'name': 'ExpectedOutputSchema', 'range': [803, 833], 'children': [{'type': 'ClassBody', 'name': '', 'range': [809, 833], 'children': [{'type': 'ClassVariable', 'name': 'out_key: Any = SchemaField(description="This is an output key", title="out_key", advanced=False)', 'range': [810, 832], 'children': []}]}]}, {'type': 'Assignment', 'name': 'input_schema = created_graph.input_schema', 'range': [835, 840], 'children': []}, {'type': 'Assignment', 'name': 'input_schema["title"] = "ExpectedInputSchema"', 'range': [841, 847], 'children': []}, {'type': 'Assert', 'name': 'assert input_schema == ExpectedInputSchema.jsonschema()', 'range': [848, 857], 'children': []}, {'type': 'Assignment', 'name': 'output_schema = created_graph.output_schema', 'range': [859, 864], 'children': []}, {'type': 'Assignment', 'name': 'output_schema["title"] = "ExpectedOutputSchema"', 'range': [865, 871], 'children': []}, {'type': 'Assert', 'name': 'assert output_schema == ExpectedOutputSchema.jsonschema()', 'range': [872, 881], 'children': []}]}]}]}
2025-01-08 09:55:43,636 - INFO - Starting Step 3: AST simplification
2025-01-08 09:55:43,681 - INFO - Step 2 result: {'type': 'Program', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'FunctionDeclaration', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [104, 107], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [108, 431], 'children': [{'type': 'VariableDeclaration', 'name': 'value_block', 'range': [114, 121], 'children': []}, {'type': 'VariableDeclaration', 'name': 'input_block', 'range': [122, 129], 'children': []}, {'type': 'VariableDeclaration', 'name': 'graph', 'range': [131, 235], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [133, 235], 'children': [{'type': 'Property', 'name': 'id', 'range': [136, 138], 'children': []}, {'type': 'Property', 'name': 'name', 'range': [141, 143], 'children': []}, {'type': 'Property', 'name': 'description', 'range': [146, 148], 'children': []}, {'type': 'Property', 'name': 'nodes', 'range': [151, 199], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [153, 199], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [155, 164], 'children': [{'type': 'Property', 'name': 'id', 'range': [157, 159], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [161, 163], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [167, 184], 'children': [{'type': 'Property', 'name': 'id', 'range': [169, 171], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [173, 175], 'children': []}, {'type': 'Property', 'name': 'input_default', 'range': [177, 183], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [187, 196], 'children': [{'type': 'Property', 'name': 'id', 'range': [189, 191], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [193, 195], 'children': []}]}]}]}, {'type': 'Property', 'name': 'links', 'range': [202, 232], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [204, 232], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [206, 229], 'children': [{'type': 'Property', 'name': 'source_id', 'range': [209, 211], 'children': []}, {'type': 'Property', 'name': 'sink_id', 'range': [214, 216], 'children': []}, {'type': 'Property', 'name': 'source_name', 'range': [219, 221], 'children': []}, {'type': 'Property', 'name': 'sink_name', 'range': [224, 226], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'create_graph', 'range': [237, 245], 'children': []}, {'type': 'VariableDeclaration', 'name': 'created_graph', 'range': [246, 261], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [263, 270], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [271, 278], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [280, 290], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [291, 303], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [304, 316], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [317, 329], 'children': []}, {'type': 'VariableDeclaration', 'name': 'nodes', 'range': [331, 336], 'children': []}, {'type': 'VariableDeclaration', 'name': 'links', 'range': [337, 342], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [343, 351], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [352, 367], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [368, 398], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [399, 429], 'children': []}]}]}]}
2025-01-08 09:55:43,681 - INFO - Starting Step 3: AST simplification
2025-01-08 09:56:05,357 - INFO - Step 3 result: {'nodes': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'Any', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [5, 9], 'children': [{'type': 'FromImport', 'name': 'uuid', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'UUID', 'range': [7, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [11, 13], 'children': [{'type': 'Import', 'name': 'pytest', 'range': [11, 12], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [15, 27], 'children': [{'type': 'FromImport', 'name': 'backend.blocks.basic', 'range': [15, 20], 'children': []}, {'type': 'Import', 'name': 'AgentInputBlock', 'range': [21, 22], 'children': []}, {'type': 'Import', 'name': 'AgentOutputBlock', 'range': [23, 24], 'children': []}, {'type': 'Import', 'name': 'StoreValueBlock', 'range': [25, 26], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [28, 36], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [28, 33], 'children': []}, {'type': 'Import', 'name': 'BlockSchema', 'range': [34, 35], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [37, 49], 'children': [{'type': 'FromImport', 'name': 'backend.data.graph', 'range': [37, 42], 'children': []}, {'type': 'Import', 'name': 'Graph', 'range': [43, 44], 'children': []}, {'type': 'Import', 'name': 'Link', 'range': [45, 46], 'children': []}, {'type': 'Import', 'name': 'Node', 'range': [47, 48], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [50, 58], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [50, 55], 'children': []}, {'type': 'Import', 'name': 'SchemaField', 'range': [56, 57], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [59, 67], 'children': [{'type': 'FromImport', 'name': 'backend.data.user', 'range': [59, 64], 'children': []}, {'type': 'Import', 'name': 'DEFAULT_USER_ID', 'range': [65, 66], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [68, 76], 'children': [{'type': 'FromImport', 'name': 'backend.server.model', 'range': [68, 73], 'children': []}, {'type': 'Import', 'name': 'CreateGraph', 'range': [74, 75], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [77, 85], 'children': [{'type': 'FromImport', 'name': 'backend.util.test', 'range': [77, 82], 'children': []}, {'type': 'Import', 'name': 'SpinTestServer', 'range': [83, 84], 'children': []}]}]}
2025-01-08 09:56:05,357 - INFO - Starting Step 4: AST normalization
2025-01-08 09:56:13,855 - INFO - Step 3 result: {'type': 'Program', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'FunctionDeclaration', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [104, 107], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [108, 431], 'children': [{'type': 'VariableDeclaration', 'name': 'value_block', 'range': [114, 121], 'children': []}, {'type': 'VariableDeclaration', 'name': 'input_block', 'range': [122, 129], 'children': []}, {'type': 'VariableDeclaration', 'name': 'graph', 'range': [131, 235], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [133, 235], 'children': [{'type': 'Property', 'name': 'id', 'range': [136, 138], 'children': []}, {'type': 'Property', 'name': 'name', 'range': [141, 143], 'children': []}, {'type': 'Property', 'name': 'description', 'range': [146, 148], 'children': []}, {'type': 'Property', 'name': 'nodes', 'range': [151, 199], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [153, 199], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [155, 164], 'children': [{'type': 'Property', 'name': 'id', 'range': [157, 159], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [161, 163], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [167, 184], 'children': [{'type': 'Property', 'name': 'id', 'range': [169, 171], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [173, 175], 'children': []}, {'type': 'Property', 'name': 'input_default', 'range': [177, 183], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [187, 196], 'children': [{'type': 'Property', 'name': 'id', 'range': [189, 191], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [193, 195], 'children': []}]}]}]}, {'type': 'Property', 'name': 'links', 'range': [202, 232], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [204, 232], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [206, 229], 'children': [{'type': 'Property', 'name': 'source_id', 'range': [209, 211], 'children': []}, {'type': 'Property', 'name': 'sink_id', 'range': [214, 216], 'children': []}, {'type': 'Property', 'name': 'source_name', 'range': [219, 221], 'children': []}, {'type': 'Property', 'name': 'sink_name', 'range': [224, 226], 'children': []}]}]}]}]}]}, {'type': 'VariableDeclaration', 'name': 'create_graph', 'range': [237, 245], 'children': []}, {'type': 'VariableDeclaration', 'name': 'created_graph', 'range': [246, 261], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [263, 270], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [271, 278], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [280, 290], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [291, 303], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [304, 316], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [317, 329], 'children': []}, {'type': 'VariableDeclaration', 'name': 'nodes', 'range': [331, 336], 'children': []}, {'type': 'VariableDeclaration', 'name': 'links', 'range': [337, 342], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [343, 351], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [352, 367], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [368, 398], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [399, 429], 'children': []}]}]}]}
2025-01-08 09:56:13,855 - INFO - Starting Step 4: AST normalization
2025-01-08 09:56:28,711 - INFO - Step 4 result: {'nodes': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'Any', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [5, 9], 'children': [{'type': 'FromImport', 'name': 'uuid', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'UUID', 'range': [7, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [11, 13], 'children': [{'type': 'Import', 'name': 'pytest', 'range': [11, 12], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [15, 27], 'children': [{'type': 'FromImport', 'name': 'backend.blocks.basic', 'range': [15, 20], 'children': []}, {'type': 'Import', 'name': 'AgentInputBlock', 'range': [21, 22], 'children': []}, {'type': 'Import', 'name': 'AgentOutputBlock', 'range': [23, 24], 'children': []}, {'type': 'Import', 'name': 'StoreValueBlock', 'range': [25, 26], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [28, 36], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [28, 33], 'children': []}, {'type': 'Import', 'name': 'BlockSchema', 'range': [34, 35], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [37, 49], 'children': [{'type': 'FromImport', 'name': 'backend.data.graph', 'range': [37, 42], 'children': []}, {'type': 'Import', 'name': 'Graph', 'range': [43, 44], 'children': []}, {'type': 'Import', 'name': 'Link', 'range': [45, 46], 'children': []}, {'type': 'Import', 'name': 'Node', 'range': [47, 48], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [50, 58], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [50, 55], 'children': []}, {'type': 'Import', 'name': 'SchemaField', 'range': [56, 57], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [59, 67], 'children': [{'type': 'FromImport', 'name': 'backend.data.user', 'range': [59, 64], 'children': []}, {'type': 'Import', 'name': 'DEFAULT_USER_ID', 'range': [65, 66], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [68, 76], 'children': [{'type': 'FromImport', 'name': 'backend.server.model', 'range': [68, 73], 'children': []}, {'type': 'Import', 'name': 'CreateGraph', 'range': [74, 75], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [77, 85], 'children': [{'type': 'FromImport', 'name': 'backend.util.test', 'range': [77, 82], 'children': []}, {'type': 'Import', 'name': 'SpinTestServer', 'range': [83, 84], 'children': []}]}]}
2025-01-08 09:56:28,711 - INFO - Starting Step 5: Final AST combination
2025-01-08 09:56:43,372 - INFO - Step 4 result: {'type': 'Program', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'FunctionDecl', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [104, 107], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [108, 431], 'children': [{'type': 'VariableDecl', 'name': 'value_block', 'range': [114, 121], 'children': []}, {'type': 'VariableDecl', 'name': 'input_block', 'range': [122, 129], 'children': []}, {'type': 'VariableDecl', 'name': 'graph', 'range': [131, 235], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [133, 235], 'children': [{'type': 'Property', 'name': 'id', 'range': [136, 138], 'children': []}, {'type': 'Property', 'name': 'name', 'range': [141, 143], 'children': []}, {'type': 'Property', 'name': 'description', 'range': [146, 148], 'children': []}, {'type': 'Property', 'name': 'nodes', 'range': [151, 199], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [153, 199], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [155, 164], 'children': [{'type': 'Property', 'name': 'id', 'range': [157, 159], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [161, 163], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [167, 184], 'children': [{'type': 'Property', 'name': 'id', 'range': [169, 171], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [173, 175], 'children': []}, {'type': 'Property', 'name': 'input_default', 'range': [177, 183], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [187, 196], 'children': [{'type': 'Property', 'name': 'id', 'range': [189, 191], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [193, 195], 'children': []}]}]}]}, {'type': 'Property', 'name': 'links', 'range': [202, 232], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [204, 232], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [206, 229], 'children': [{'type': 'Property', 'name': 'source_id', 'range': [209, 211], 'children': []}, {'type': 'Property', 'name': 'sink_id', 'range': [214, 216], 'children': []}, {'type': 'Property', 'name': 'source_name', 'range': [219, 221], 'children': []}, {'type': 'Property', 'name': 'sink_name', 'range': [224, 226], 'children': []}]}]}]}]}]}, {'type': 'VariableDecl', 'name': 'create_graph', 'range': [237, 245], 'children': []}, {'type': 'VariableDecl', 'name': 'created_graph', 'range': [246, 261], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [263, 270], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [271, 278], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [280, 290], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [291, 303], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [304, 316], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [317, 329], 'children': []}, {'type': 'VariableDecl', 'name': 'nodes', 'range': [331, 336], 'children': []}, {'type': 'VariableDecl', 'name': 'links', 'range': [337, 342], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [343, 351], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [352, 367], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [368, 398], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [399, 429], 'children': []}]}]}]}
2025-01-08 09:56:43,373 - INFO - Starting Step 5: Final AST combination
2025-01-08 09:56:53,134 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'MainOrSomething', 'range': [0, 85], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 4], 'children': [{'type': 'FromImport', 'name': 'typing', 'range': [0, 1], 'children': []}, {'type': 'Import', 'name': 'Any', 'range': [2, 3], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [5, 9], 'children': [{'type': 'FromImport', 'name': 'uuid', 'range': [5, 6], 'children': []}, {'type': 'Import', 'name': 'UUID', 'range': [7, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [11, 13], 'children': [{'type': 'Import', 'name': 'pytest', 'range': [11, 12], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [15, 27], 'children': [{'type': 'FromImport', 'name': 'backend.blocks.basic', 'range': [15, 20], 'children': []}, {'type': 'Import', 'name': 'AgentInputBlock', 'range': [21, 22], 'children': []}, {'type': 'Import', 'name': 'AgentOutputBlock', 'range': [23, 24], 'children': []}, {'type': 'Import', 'name': 'StoreValueBlock', 'range': [25, 26], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [28, 36], 'children': [{'type': 'FromImport', 'name': 'backend.data.block', 'range': [28, 33], 'children': []}, {'type': 'Import', 'name': 'BlockSchema', 'range': [34, 35], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [37, 49], 'children': [{'type': 'FromImport', 'name': 'backend.data.graph', 'range': [37, 42], 'children': []}, {'type': 'Import', 'name': 'Graph', 'range': [43, 44], 'children': []}, {'type': 'Import', 'name': 'Link', 'range': [45, 46], 'children': []}, {'type': 'Import', 'name': 'Node', 'range': [47, 48], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [50, 58], 'children': [{'type': 'FromImport', 'name': 'backend.data.model', 'range': [50, 55], 'children': []}, {'type': 'Import', 'name': 'SchemaField', 'range': [56, 57], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [59, 67], 'children': [{'type': 'FromImport', 'name': 'backend.data.user', 'range': [59, 64], 'children': []}, {'type': 'Import', 'name': 'DEFAULT_USER_ID', 'range': [65, 66], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [68, 76], 'children': [{'type': 'FromImport', 'name': 'backend.server.model', 'range': [68, 73], 'children': []}, {'type': 'Import', 'name': 'CreateGraph', 'range': [74, 75], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [77, 85], 'children': [{'type': 'FromImport', 'name': 'backend.util.test', 'range': [77, 82], 'children': []}, {'type': 'Import', 'name': 'SpinTestServer', 'range': [83, 84], 'children': []}]}]}]}
2025-01-08 09:56:53,134 - INFO - Completed main AST analysis flow
2025-01-08 09:56:53,135 - INFO - Successfully processed chunk
2025-01-08 09:57:13,400 - INFO - Step 5 result: {'type': 'Program', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'FunctionDecl', 'name': 'test_graph_creation', 'range': [100, 431], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [104, 107], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [108, 431], 'children': [{'type': 'VariableDecl', 'name': 'value_block', 'range': [114, 121], 'children': []}, {'type': 'VariableDecl', 'name': 'input_block', 'range': [122, 129], 'children': []}, {'type': 'VariableDecl', 'name': 'graph', 'range': [131, 235], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [133, 235], 'children': [{'type': 'Property', 'name': 'id', 'range': [136, 138], 'children': []}, {'type': 'Property', 'name': 'name', 'range': [141, 143], 'children': []}, {'type': 'Property', 'name': 'description', 'range': [146, 148], 'children': []}, {'type': 'Property', 'name': 'nodes', 'range': [151, 199], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [153, 199], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [155, 164], 'children': [{'type': 'Property', 'name': 'id', 'range': [157, 159], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [161, 163], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [167, 184], 'children': [{'type': 'Property', 'name': 'id', 'range': [169, 171], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [173, 175], 'children': []}, {'type': 'Property', 'name': 'input_default', 'range': [177, 183], 'children': []}]}, {'type': 'ObjectExpression', 'name': '', 'range': [187, 196], 'children': [{'type': 'Property', 'name': 'id', 'range': [189, 191], 'children': []}, {'type': 'Property', 'name': 'block_id', 'range': [193, 195], 'children': []}]}]}]}, {'type': 'Property', 'name': 'links', 'range': [202, 232], 'children': [{'type': 'ArrayExpression', 'name': '', 'range': [204, 232], 'children': [{'type': 'ObjectExpression', 'name': '', 'range': [206, 229], 'children': [{'type': 'Property', 'name': 'source_id', 'range': [209, 211], 'children': []}, {'type': 'Property', 'name': 'sink_id', 'range': [214, 216], 'children': []}, {'type': 'Property', 'name': 'source_name', 'range': [219, 221], 'children': []}, {'type': 'Property', 'name': 'sink_name', 'range': [224, 226], 'children': []}]}]}]}]}]}, {'type': 'VariableDecl', 'name': 'create_graph', 'range': [237, 245], 'children': []}, {'type': 'VariableDecl', 'name': 'created_graph', 'range': [246, 261], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [263, 270], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [271, 278], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [280, 290], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [291, 303], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [304, 316], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [317, 329], 'children': []}, {'type': 'VariableDecl', 'name': 'nodes', 'range': [331, 336], 'children': []}, {'type': 'VariableDecl', 'name': 'links', 'range': [337, 342], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [343, 351], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [352, 367], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [368, 398], 'children': []}, {'type': 'ExpressionStatement', 'name': '', 'range': [399, 429], 'children': []}]}]}]}
2025-01-08 09:57:13,400 - INFO - Completed main AST analysis flow
2025-01-08 09:57:13,401 - INFO - Successfully processed chunk
2025-01-08 09:57:25,488 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [432, 442], 'children': [{'type': 'Decorator', 'name': '@pytest.mark.asyncio', 'range': [432, 442], 'children': []}, {'type': 'FunctionDef', 'name': 'test_get_input_schema', 'range': [444, 882], 'children': [{'type': 'Async', 'name': 'async', 'range': [444, 449], 'children': []}, {'type': 'Def', 'name': 'def', 'range': [445, 448], 'children': []}, {'type': 'FunctionName', 'name': 'test_get_input_schema', 'range': [446, 466], 'children': []}, {'type': 'Parameters', 'name': '', 'range': [447, 451], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [448, 450], 'children': [{'type': 'TypeAnnotation', 'name': ':', 'range': [449, 450], 'children': [{'type': 'Type', 'name': 'SpinTestServer', 'range': [450, 464], 'children': []}]}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [452, 882], 'children': [{'type': 'Docstring', 'name': '', 'range': [453, 456], 'children': []}, {'type': 'Assignment', 'name': 'value_block = StoreValueBlock().id', 'range': [458, 465], 'children': []}, {'type': 'Assignment', 'name': 'input_block = AgentInputBlock().id', 'range': [466, 473], 'children': []}, {'type': 'Assignment', 'name': 'output_block = AgentOutputBlock().id', 'range': [474, 481], 'children': []}, {'type': 'Assignment', 'name': 'graph = Graph', 'range': [483, 732], 'children': [{'type': 'KeywordArgument', 'name': 'name', 'range': [488, 490], 'children': [{'type': 'Literal', 'name': '"TestInputSchema"', 'range': [490, 504], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'description', 'range': [493, 495], 'children': [{'type': 'Literal', 'name': '"Test input schema"', 'range': [495, 513], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'nodes', 'range': [498, 500], 'children': [{'type': 'List', 'name': '', 'range': [500, 644], 'children': [{'type': 'Node', 'name': 'Node', 'range': [502, 541], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [505, 507], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [507, 517], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [510, 512], 'children': [{'type': 'Identifier', 'name': 'input_block', 'range': [512, 523], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [515, 517], 'children': [{'type': 'Dict', 'name': '', 'range': [517, 529], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [518, 520], 'children': [{'type': 'Literal', 'name': '"in_key_a"', 'range': [520, 530], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'title', 'range': [522, 524], 'children': [{'type': 'Literal', 'name': '"Key A"', 'range': [524, 531], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'value', 'range': [526, 528], 'children': [{'type': 'Literal', 'name': '"A"', 'range': [528, 529], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [532, 534], 'children': [{'type': 'Dict', 'name': '', 'range': [534, 538], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [535, 537], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [537, 538], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [544, 579], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [547, 549], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [549, 559], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [552, 554], 'children': [{'type': 'Identifier', 'name': 'input_block', 'range': [554, 565], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [557, 559], 'children': [{'type': 'Dict', 'name': '', 'range': [559, 567], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [560, 562], 'children': [{'type': 'Literal', 'name': '"in_key_b"', 'range': [562, 572], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'advanced', 'range': [564, 566], 'children': [{'type': 'Literal', 'name': 'True', 'range': [566, 567], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [570, 572], 'children': [{'type': 'Dict', 'name': '', 'range': [572, 576], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [573, 575], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [575, 576], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [582, 599], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [585, 587], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [587, 597], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [590, 592], 'children': [{'type': 'Identifier', 'name': 'value_block', 'range': [592, 603], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [593, 595], 'children': [{'type': 'Dict', 'name': '', 'range': [595, 598], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [596, 598], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [598, 599], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [602, 641], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [605, 607], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [607, 617], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [610, 612], 'children': [{'type': 'Identifier', 'name': 'output_block', 'range': [612, 623], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [615, 617], 'children': [{'type': 'Dict', 'name': '', 'range': [617, 629], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [619, 621], 'children': [{'type': 'Literal', 'name': '"out_key"', 'range': [621, 631], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'description', 'range': [624, 626], 'children': [{'type': 'Literal', 'name': '"This is an output key"', 'range': [626, 647], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [632, 634], 'children': [{'type': 'Dict', 'name': '', 'range': [634, 638], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [635, 637], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [637, 638], 'children': []}]}]}]}]}]}]}, {'type': 'KeywordArgument', 'name': 'links', 'range': [647, 649], 'children': [{'type': 'List', 'name': '', 'range': [649, 729], 'children': [{'type': 'Link', 'name': 'Link', 'range': [651, 674], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [654, 656], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [656, 666], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [659, 661], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [661, 671], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [664, 666], 'children': [{'type': 'Literal', 'name': '"result"', 'range': [666, 674], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [669, 671], 'children': [{'type': 'Literal', 'name': '"input"', 'range': [671, 678], 'children': []}]}]}, {'type': 'Link', 'name': 'Link', 'range': [677, 700], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [680, 682], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [682, 692], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [685, 687], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [687, 697], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [690, 692], 'children': [{'type': 'Literal', 'name': '"result"', 'range': [692, 700], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [695, 697], 'children': [{'type': 'Literal', 'name': '"input"', 'range': [697, 704], 'children': []}]}]}, {'type': 'Link', 'name': 'Link', 'range': [703, 726], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [706, 708], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [708, 718], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [711, 713], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [713, 723], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [716, 718], 'children': [{'type': 'Literal', 'name': '"output"', 'range': [718, 726], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [721, 723], 'children': [{'type': 'Literal', 'name': '"value"', 'range': [723, 730], 'children': []}]}]}]}]}]}, {'type': 'Assignment', 'name': 'create_graph = CreateGraph', 'range': [735, 742], 'children': [{'type': 'KeywordArgument', 'name': 'graph', 'range': [739, 741], 'children': [{'type': 'Identifier', 'name': 'graph', 'range': [741, 746], 'children': []}]}]}, {'type': 'Assignment', 'name': 'created_graph = await server.agent_server.test_create_graph', 'range': [744, 758], 'children': [{'type': 'Call', 'name': '', 'range': [751, 757], 'children': [{'type': 'Identifier', 'name': 'create_graph', 'range': [754, 766], 'children': []}, {'type': 'Identifier', 'name': 'DEFAULT_USER_ID', 'range': [756, 770], 'children': []}]}]}, {'type': 'ClassDef', 'name': 'ExpectedInputSchema', 'range': [761, 801], 'children': [{'type': 'ClassBody', 'name': '', 'range': [767, 801], 'children': [{'type': 'ClassVariable', 'name': 'in_key_a: Any = SchemaField', 'range': [768, 785], 'children': [{'type': 'Call', 'name': '', 'range': [772, 785], 'children': [{'type': 'KeywordArgument', 'name': 'title', 'range': [774, 776], 'children': [{'type': 'Literal', 'name': '"Key A"', 'range': [776, 785], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'default', 'range': [778, 780], 'children': [{'type': 'Literal', 'name': '"A"', 'range': [780, 785], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [782, 784], 'children': [{'type': 'Literal', 'name': 'False', 'range': [784, 785], 'children': []}]}]}]}, {'type': 'ClassVariable', 'name': 'in_key_b: Any = SchemaField', 'range': [787, 800], 'children': [{'type': 'Call', 'name': '', 'range': [791, 800], 'children': [{'type': 'KeywordArgument', 'name': 'title', 'range': [793, 795], 'children': [{'type': 'Literal', 'name': '"in_key_b"', 'range': [795, 805], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [797, 799], 'children': [{'type': 'Literal', 'name': 'True', 'range': [799, 800], 'children': []}]}]}]}]}]}, {'type': 'ClassDef', 'name': 'ExpectedOutputSchema', 'range': [803, 833], 'children': [{'type': 'ClassBody', 'name': '', 'range': [809, 833], 'children': [{'type': 'ClassVariable', 'name': 'out_key: Any = SchemaField', 'range': [810, 832], 'children': [{'type': 'Call', 'name': '', 'range': [814, 832], 'children': [{'type': 'KeywordArgument', 'name': 'description', 'range': [817, 819], 'children': [{'type': 'Literal', 'name': '"This is an output key"', 'range': [819, 840], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'title', 'range': [822, 824], 'children': [{'type': 'Literal', 'name': '"out_key"', 'range': [824, 833], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [827, 829], 'children': [{'type': 'Literal', 'name': 'False', 'range': [829, 832], 'children': []}]}]}]}]}]}, {'type': 'Assignment', 'name': 'input_schema = created_graph.input_schema', 'range': [835, 840], 'children': []}, {'type': 'Assignment', 'name': 'input_schema["title"] = "ExpectedInputSchema"', 'range': [841, 847], 'children': []}, {'type': 'Assert', 'name': 'assert input_schema == ExpectedInputSchema.jsonschema()', 'range': [848, 857], 'children': []}, {'type': 'Assignment', 'name': 'output_schema = created_graph.output_schema', 'range': [859, 864], 'children': []}, {'type': 'Assignment', 'name': 'output_schema["title"] = "ExpectedOutputSchema"', 'range': [865, 871], 'children': []}, {'type': 'Assert', 'name': 'assert output_schema == ExpectedOutputSchema.jsonschema()', 'range': [872, 881], 'children': []}]}]}]}
2025-01-08 09:57:25,488 - INFO - Starting Step 4: AST normalization
2025-01-08 09:59:07,037 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [432, 442], 'children': [{'type': 'Decorator', 'name': '@pytest.mark.asyncio', 'range': [432, 442], 'children': []}, {'type': 'FunctionDecl', 'name': 'test_get_input_schema', 'range': [444, 882], 'children': [{'type': 'Async', 'name': 'async', 'range': [444, 449], 'children': []}, {'type': 'Def', 'name': 'def', 'range': [445, 448], 'children': []}, {'type': 'FunctionName', 'name': 'test_get_input_schema', 'range': [446, 466], 'children': []}, {'type': 'Parameters', 'name': '', 'range': [447, 451], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [448, 450], 'children': [{'type': 'TypeAnnotation', 'name': ':', 'range': [449, 450], 'children': [{'type': 'Type', 'name': 'SpinTestServer', 'range': [450, 464], 'children': []}]}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [452, 882], 'children': [{'type': 'Docstring', 'name': '', 'range': [453, 456], 'children': []}, {'type': 'Assignment', 'name': 'value_block = StoreValueBlock().id', 'range': [458, 465], 'children': []}, {'type': 'Assignment', 'name': 'input_block = AgentInputBlock().id', 'range': [466, 473], 'children': []}, {'type': 'Assignment', 'name': 'output_block = AgentOutputBlock().id', 'range': [474, 481], 'children': []}, {'type': 'Assignment', 'name': 'graph = Graph', 'range': [483, 732], 'children': [{'type': 'KeywordArgument', 'name': 'name', 'range': [488, 490], 'children': [{'type': 'Literal', 'name': '"TestInputSchema"', 'range': [490, 504], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'description', 'range': [493, 495], 'children': [{'type': 'Literal', 'name': '"Test input schema"', 'range': [495, 513], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'nodes', 'range': [498, 500], 'children': [{'type': 'List', 'name': '', 'range': [500, 644], 'children': [{'type': 'Node', 'name': 'Node', 'range': [502, 541], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [505, 507], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [507, 517], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [510, 512], 'children': [{'type': 'Identifier', 'name': 'input_block', 'range': [512, 523], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [515, 517], 'children': [{'type': 'Dict', 'name': '', 'range': [517, 529], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [518, 520], 'children': [{'type': 'Literal', 'name': '"in_key_a"', 'range': [520, 530], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'title', 'range': [522, 524], 'children': [{'type': 'Literal', 'name': '"Key A"', 'range': [524, 531], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'value', 'range': [526, 528], 'children': [{'type': 'Literal', 'name': '"A"', 'range': [528, 529], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [532, 534], 'children': [{'type': 'Dict', 'name': '', 'range': [534, 538], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [535, 537], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [537, 538], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [544, 579], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [547, 549], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [549, 559], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [552, 554], 'children': [{'type': 'Identifier', 'name': 'input_block', 'range': [554, 565], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [557, 559], 'children': [{'type': 'Dict', 'name': '', 'range': [559, 567], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [560, 562], 'children': [{'type': 'Literal', 'name': '"in_key_b"', 'range': [562, 572], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'advanced', 'range': [564, 566], 'children': [{'type': 'Literal', 'name': 'True', 'range': [566, 567], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [570, 572], 'children': [{'type': 'Dict', 'name': '', 'range': [572, 576], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [573, 575], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [575, 576], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [582, 599], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [585, 587], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [587, 597], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [590, 592], 'children': [{'type': 'Identifier', 'name': 'value_block', 'range': [592, 603], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [593, 595], 'children': [{'type': 'Dict', 'name': '', 'range': [595, 598], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [596, 598], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [598, 599], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [602, 641], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [605, 607], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [607, 617], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [610, 612], 'children': [{'type': 'Identifier', 'name': 'output_block', 'range': [612, 623], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [615, 617], 'children': [{'type': 'Dict', 'name': '', 'range': [617, 629], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [619, 621], 'children': [{'type': 'Literal', 'name': '"out_key"', 'range': [621, 631], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'description', 'range': [624, 626], 'children': [{'type': 'Literal', 'name': '"This is an output key"', 'range': [626, 647], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [632, 634], 'children': [{'type': 'Dict', 'name': '', 'range': [634, 638], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [635, 637], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [637, 638], 'children': []}]}]}]}]}]}]}, {'type': 'KeywordArgument', 'name': 'links', 'range': [647, 649], 'children': [{'type': 'List', 'name': '', 'range': [649, 729], 'children': [{'type': 'Link', 'name': 'Link', 'range': [651, 674], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [654, 656], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [656, 666], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [659, 661], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [661, 671], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [664, 666], 'children': [{'type': 'Literal', 'name': '"result"', 'range': [666, 674], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [669, 671], 'children': [{'type': 'Literal', 'name': '"input"', 'range': [671, 678], 'children': []}]}]}, {'type': 'Link', 'name': 'Link', 'range': [677, 700], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [680, 682], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [682, 692], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [685, 687], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [687, 697], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [690, 692], 'children': [{'type': 'Literal', 'name': '"result"', 'range': [692, 700], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [695, 697], 'children': [{'type': 'Literal', 'name': '"input"', 'range': [697, 704], 'children': []}]}]}, {'type': 'Link', 'name': 'Link', 'range': [703, 726], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [706, 708], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [708, 718], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [711, 713], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [713, 723], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [716, 718], 'children': [{'type': 'Literal', 'name': '"output"', 'range': [718, 726], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [721, 723], 'children': [{'type': 'Literal', 'name': '"value"', 'range': [723, 730], 'children': []}]}]}]}]}]}, {'type': 'Assignment', 'name': 'create_graph = CreateGraph', 'range': [735, 742], 'children': [{'type': 'KeywordArgument', 'name': 'graph', 'range': [739, 741], 'children': [{'type': 'Identifier', 'name': 'graph', 'range': [741, 746], 'children': []}]}]}, {'type': 'Assignment', 'name': 'created_graph = await server.agent_server.test_create_graph', 'range': [744, 758], 'children': [{'type': 'CallExpression', 'name': '', 'range': [751, 757], 'children': [{'type': 'Identifier', 'name': 'create_graph', 'range': [754, 766], 'children': []}, {'type': 'Identifier', 'name': 'DEFAULT_USER_ID', 'range': [756, 770], 'children': []}]}]}, {'type': 'ClassDecl', 'name': 'ExpectedInputSchema', 'range': [761, 801], 'children': [{'type': 'ClassBody', 'name': '', 'range': [767, 801], 'children': [{'type': 'ClassVariable', 'name': 'in_key_a: Any = SchemaField', 'range': [768, 785], 'children': [{'type': 'CallExpression', 'name': '', 'range': [772, 785], 'children': [{'type': 'KeywordArgument', 'name': 'title', 'range': [774, 776], 'children': [{'type': 'Literal', 'name': '"Key A"', 'range': [776, 785], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'default', 'range': [778, 780], 'children': [{'type': 'Literal', 'name': '"A"', 'range': [780, 785], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [782, 784], 'children': [{'type': 'Literal', 'name': 'False', 'range': [784, 785], 'children': []}]}]}]}, {'type': 'ClassVariable', 'name': 'in_key_b: Any = SchemaField', 'range': [787, 800], 'children': [{'type': 'CallExpression', 'name': '', 'range': [791, 800], 'children': [{'type': 'KeywordArgument', 'name': 'title', 'range': [793, 795], 'children': [{'type': 'Literal', 'name': '"in_key_b"', 'range': [795, 805], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [797, 799], 'children': [{'type': 'Literal', 'name': 'True', 'range': [799, 800], 'children': []}]}]}]}]}]}, {'type': 'ClassDecl', 'name': 'ExpectedOutputSchema', 'range': [803, 833], 'children': [{'type': 'ClassBody', 'name': '', 'range': [809, 833], 'children': [{'type': 'ClassVariable', 'name': 'out_key: Any = SchemaField', 'range': [810, 832], 'children': [{'type': 'CallExpression', 'name': '', 'range': [814, 832], 'children': [{'type': 'KeywordArgument', 'name': 'description', 'range': [817, 819], 'children': [{'type': 'Literal', 'name': '"This is an output key"', 'range': [819, 840], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'title', 'range': [822, 824], 'children': [{'type': 'Literal', 'name': '"out_key"', 'range': [824, 833], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [827, 829], 'children': [{'type': 'Literal', 'name': 'False', 'range': [829, 832], 'children': []}]}]}]}]}]}, {'type': 'Assignment', 'name': 'input_schema = created_graph.input_schema', 'range': [835, 840], 'children': []}, {'type': 'Assignment', 'name': 'input_schema["title"] = "ExpectedInputSchema"', 'range': [841, 847], 'children': []}, {'type': 'Assert', 'name': 'assert input_schema == ExpectedInputSchema.jsonschema()', 'range': [848, 857], 'children': []}, {'type': 'Assignment', 'name': 'output_schema = created_graph.output_schema', 'range': [859, 864], 'children': []}, {'type': 'Assignment', 'name': 'output_schema["title"] = "ExpectedOutputSchema"', 'range': [865, 871], 'children': []}, {'type': 'Assert', 'name': 'assert output_schema == ExpectedOutputSchema.jsonschema()', 'range': [872, 881], 'children': []}]}]}]}
2025-01-08 09:59:07,037 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:00:49,606 - INFO - Step 5 result: {'type': 'Program', 'name': 'MainProgram', 'range': [432, 882], 'children': [{'type': 'Decorator', 'name': '@pytest.mark.asyncio', 'range': [432, 442], 'children': []}, {'type': 'FunctionDecl', 'name': 'test_get_input_schema', 'range': [444, 882], 'children': [{'type': 'Async', 'name': 'async', 'range': [444, 449], 'children': []}, {'type': 'Def', 'name': 'def', 'range': [445, 448], 'children': []}, {'type': 'FunctionName', 'name': 'test_get_input_schema', 'range': [446, 466], 'children': []}, {'type': 'Parameters', 'name': '', 'range': [447, 451], 'children': [{'type': 'Parameter', 'name': 'server', 'range': [448, 450], 'children': [{'type': 'TypeAnnotation', 'name': ':', 'range': [449, 450], 'children': [{'type': 'Type', 'name': 'SpinTestServer', 'range': [450, 464], 'children': []}]}]}]}, {'type': 'FunctionBody', 'name': '', 'range': [452, 882], 'children': [{'type': 'Docstring', 'name': '', 'range': [453, 456], 'children': []}, {'type': 'Assignment', 'name': 'value_block = StoreValueBlock().id', 'range': [458, 465], 'children': []}, {'type': 'Assignment', 'name': 'input_block = AgentInputBlock().id', 'range': [466, 473], 'children': []}, {'type': 'Assignment', 'name': 'output_block = AgentOutputBlock().id', 'range': [474, 481], 'children': []}, {'type': 'Assignment', 'name': 'graph = Graph', 'range': [483, 732], 'children': [{'type': 'KeywordArgument', 'name': 'name', 'range': [488, 490], 'children': [{'type': 'Literal', 'name': '"TestInputSchema"', 'range': [490, 504], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'description', 'range': [493, 495], 'children': [{'type': 'Literal', 'name': '"Test input schema"', 'range': [495, 513], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'nodes', 'range': [498, 500], 'children': [{'type': 'List', 'name': '', 'range': [500, 644], 'children': [{'type': 'Node', 'name': 'Node', 'range': [502, 541], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [505, 507], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [507, 517], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [510, 512], 'children': [{'type': 'Identifier', 'name': 'input_block', 'range': [512, 523], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [515, 517], 'children': [{'type': 'Dict', 'name': '', 'range': [517, 529], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [518, 520], 'children': [{'type': 'Literal', 'name': '"in_key_a"', 'range': [520, 530], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'title', 'range': [522, 524], 'children': [{'type': 'Literal', 'name': '"Key A"', 'range': [524, 531], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'value', 'range': [526, 528], 'children': [{'type': 'Literal', 'name': '"A"', 'range': [528, 529], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [532, 534], 'children': [{'type': 'Dict', 'name': '', 'range': [534, 538], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [535, 537], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [537, 538], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [544, 579], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [547, 549], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [549, 559], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [552, 554], 'children': [{'type': 'Identifier', 'name': 'input_block', 'range': [554, 565], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [557, 559], 'children': [{'type': 'Dict', 'name': '', 'range': [559, 567], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [560, 562], 'children': [{'type': 'Literal', 'name': '"in_key_b"', 'range': [562, 572], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'advanced', 'range': [564, 566], 'children': [{'type': 'Literal', 'name': 'True', 'range': [566, 567], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [570, 572], 'children': [{'type': 'Dict', 'name': '', 'range': [572, 576], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [573, 575], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [575, 576], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [582, 599], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [585, 587], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [587, 597], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [590, 592], 'children': [{'type': 'Identifier', 'name': 'value_block', 'range': [592, 603], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [593, 595], 'children': [{'type': 'Dict', 'name': '', 'range': [595, 598], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [596, 598], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [598, 599], 'children': []}]}]}]}]}, {'type': 'Node', 'name': 'Node', 'range': [602, 641], 'children': [{'type': 'KeywordArgument', 'name': 'id', 'range': [605, 607], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [607, 617], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'block_id', 'range': [610, 612], 'children': [{'type': 'Identifier', 'name': 'output_block', 'range': [612, 623], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'input_default', 'range': [615, 617], 'children': [{'type': 'Dict', 'name': '', 'range': [617, 629], 'children': [{'type': 'KeyValuePair', 'name': 'name', 'range': [619, 621], 'children': [{'type': 'Literal', 'name': '"out_key"', 'range': [621, 631], 'children': []}]}, {'type': 'KeyValuePair', 'name': 'description', 'range': [624, 626], 'children': [{'type': 'Literal', 'name': '"This is an output key"', 'range': [626, 647], 'children': []}]}]}]}, {'type': 'KeywordArgument', 'name': 'metadata', 'range': [632, 634], 'children': [{'type': 'Dict', 'name': '', 'range': [634, 638], 'children': [{'type': 'KeyValuePair', 'name': 'id', 'range': [635, 637], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [637, 638], 'children': []}]}]}]}]}]}]}, {'type': 'KeywordArgument', 'name': 'links', 'range': [647, 649], 'children': [{'type': 'List', 'name': '', 'range': [649, 729], 'children': [{'type': 'Link', 'name': 'Link', 'range': [651, 674], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [654, 656], 'children': [{'type': 'Literal', 'name': '"node_0_a"', 'range': [656, 666], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [659, 661], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [661, 671], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [664, 666], 'children': [{'type': 'Literal', 'name': '"result"', 'range': [666, 674], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [669, 671], 'children': [{'type': 'Literal', 'name': '"input"', 'range': [671, 678], 'children': []}]}]}, {'type': 'Link', 'name': 'Link', 'range': [677, 700], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [680, 682], 'children': [{'type': 'Literal', 'name': '"node_0_b"', 'range': [682, 692], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [685, 687], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [687, 697], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [690, 692], 'children': [{'type': 'Literal', 'name': '"result"', 'range': [692, 700], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [695, 697], 'children': [{'type': 'Literal', 'name': '"input"', 'range': [697, 704], 'children': []}]}]}, {'type': 'Link', 'name': 'Link', 'range': [703, 726], 'children': [{'type': 'KeywordArgument', 'name': 'source_id', 'range': [706, 708], 'children': [{'type': 'Literal', 'name': '"node_1"', 'range': [708, 718], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_id', 'range': [711, 713], 'children': [{'type': 'Literal', 'name': '"node_2"', 'range': [713, 723], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'source_name', 'range': [716, 718], 'children': [{'type': 'Literal', 'name': '"output"', 'range': [718, 726], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'sink_name', 'range': [721, 723], 'children': [{'type': 'Literal', 'name': '"value"', 'range': [723, 730], 'children': []}]}]}]}]}]}, {'type': 'Assignment', 'name': 'create_graph = CreateGraph', 'range': [735, 742], 'children': [{'type': 'KeywordArgument', 'name': 'graph', 'range': [739, 741], 'children': [{'type': 'Identifier', 'name': 'graph', 'range': [741, 746], 'children': []}]}]}, {'type': 'Assignment', 'name': 'created_graph = await server.agent_server.test_create_graph', 'range': [744, 758], 'children': [{'type': 'CallExpression', 'name': '', 'range': [751, 757], 'children': [{'type': 'Identifier', 'name': 'create_graph', 'range': [754, 766], 'children': []}, {'type': 'Identifier', 'name': 'DEFAULT_USER_ID', 'range': [756, 770], 'children': []}]}]}, {'type': 'ClassDecl', 'name': 'ExpectedInputSchema', 'range': [761, 801], 'children': [{'type': 'ClassBody', 'name': '', 'range': [767, 801], 'children': [{'type': 'ClassVariable', 'name': 'in_key_a: Any = SchemaField', 'range': [768, 785], 'children': [{'type': 'CallExpression', 'name': '', 'range': [772, 785], 'children': [{'type': 'KeywordArgument', 'name': 'title', 'range': [774, 776], 'children': [{'type': 'Literal', 'name': '"Key A"', 'range': [776, 785], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'default', 'range': [778, 780], 'children': [{'type': 'Literal', 'name': '"A"', 'range': [780, 785], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [782, 784], 'children': [{'type': 'Literal', 'name': 'False', 'range': [784, 785], 'children': []}]}]}]}, {'type': 'ClassVariable', 'name': 'in_key_b: Any = SchemaField', 'range': [787, 800], 'children': [{'type': 'CallExpression', 'name': '', 'range': [791, 800], 'children': [{'type': 'KeywordArgument', 'name': 'title', 'range': [793, 795], 'children': [{'type': 'Literal', 'name': '"in_key_b"', 'range': [795, 805], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [797, 799], 'children': [{'type': 'Literal', 'name': 'True', 'range': [799, 800], 'children': []}]}]}]}]}]}, {'type': 'ClassDecl', 'name': 'ExpectedOutputSchema', 'range': [803, 833], 'children': [{'type': 'ClassBody', 'name': '', 'range': [809, 833], 'children': [{'type': 'ClassVariable', 'name': 'out_key: Any = SchemaField', 'range': [810, 832], 'children': [{'type': 'CallExpression', 'name': '', 'range': [814, 832], 'children': [{'type': 'KeywordArgument', 'name': 'description', 'range': [817, 819], 'children': [{'type': 'Literal', 'name': '"This is an output key"', 'range': [819, 840], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'title', 'range': [822, 824], 'children': [{'type': 'Literal', 'name': '"out_key"', 'range': [824, 833], 'children': []}]}, {'type': 'KeywordArgument', 'name': 'advanced', 'range': [827, 829], 'children': [{'type': 'Literal', 'name': 'False', 'range': [829, 832], 'children': []}]}]}]}]}]}, {'type': 'Assignment', 'name': 'input_schema = created_graph.input_schema', 'range': [835, 840], 'children': []}, {'type': 'Assignment', 'name': 'input_schema["title"] = "ExpectedInputSchema"', 'range': [841, 847], 'children': []}, {'type': 'Assert', 'name': 'assert input_schema == ExpectedInputSchema.jsonschema()', 'range': [848, 857], 'children': []}, {'type': 'Assignment', 'name': 'output_schema = created_graph.output_schema', 'range': [859, 864], 'children': []}, {'type': 'Assignment', 'name': 'output_schema["title"] = "ExpectedOutputSchema"', 'range': [865, 871], 'children': []}, {'type': 'Assert', 'name': 'assert output_schema == ExpectedOutputSchema.jsonschema()', 'range': [872, 881], 'children': []}]}]}]}
2025-01-08 10:00:49,607 - INFO - Completed main AST analysis flow
2025-01-08 10:00:49,608 - INFO - Successfully processed chunk
2025-01-08 10:00:49,647 - INFO - Starting code generation from AST

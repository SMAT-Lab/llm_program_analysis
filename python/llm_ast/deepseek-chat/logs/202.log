2025-01-08 10:27:27,672 - INFO - Processing sample 202
2025-01-08 10:27:27,672 - INFO - Starting Step 0: Splitting code into top-level declarations
2025-01-08 10:27:35,598 - INFO - Successfully split code into 9 top-level declarations
2025-01-08 10:27:35,602 - INFO - Processing chunk #0 (size=129 chars, start_index=0)
2025-01-08 10:27:35,610 - INFO - Processing chunk with 129 chars starting at index 0
2025-01-08 10:27:35,611 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,611 - INFO - Tokenized code into 26 tokens
2025-01-08 10:27:35,611 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,614 - INFO - Processing chunk #1 (size=127 chars, start_index=26)
2025-01-08 10:27:35,616 - INFO - Processing chunk with 127 chars starting at index 26
2025-01-08 10:27:35,616 - INFO - Processing chunk #2 (size=2 chars, start_index=55)
2025-01-08 10:27:35,616 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,617 - INFO - Processing chunk with 2 chars starting at index 55
2025-01-08 10:27:35,620 - INFO - Processing chunk #3 (size=139 chars, start_index=57)
2025-01-08 10:27:35,620 - INFO - Tokenized code into 29 tokens
2025-01-08 10:27:35,624 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,627 - INFO - Processing chunk #4 (size=2 chars, start_index=89)
2025-01-08 10:27:35,645 - INFO - Processing chunk with 139 chars starting at index 57
2025-01-08 10:27:35,648 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,648 - INFO - Processing chunk #5 (size=713 chars, start_index=91)
2025-01-08 10:27:35,650 - INFO - Tokenized code into 2 tokens
2025-01-08 10:27:35,650 - INFO - Processing chunk with 2 chars starting at index 89
2025-01-08 10:27:35,652 - INFO - Processing chunk #6 (size=2 chars, start_index=226)
2025-01-08 10:27:35,653 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,657 - INFO - Processing chunk #7 (size=258 chars, start_index=228)
2025-01-08 10:27:35,663 - INFO - Processing chunk #8 (size=1 chars, start_index=280)
2025-01-08 10:27:35,681 - INFO - Processing chunk with 1 chars starting at index 280
2025-01-08 10:27:35,675 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,676 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,678 - INFO - Processing chunk with 2 chars starting at index 226
2025-01-08 10:27:35,679 - INFO - Tokenized code into 32 tokens
2025-01-08 10:27:35,679 - INFO - Processing chunk with 258 chars starting at index 228
2025-01-08 10:27:35,663 - INFO - Processing chunk with 713 chars starting at index 91
2025-01-08 10:27:35,681 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,682 - INFO - Tokenized code into 2 tokens
2025-01-08 10:27:35,715 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,684 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,692 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,698 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,738 - INFO - Tokenized code into 135 tokens
2025-01-08 10:27:35,684 - INFO - Starting main AST analysis flow
2025-01-08 10:27:35,729 - INFO - Tokenized code into 52 tokens
2025-01-08 10:27:35,698 - INFO - Tokenized code into 1 tokens
2025-01-08 10:27:35,738 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,760 - INFO - Tokenized code into 2 tokens
2025-01-08 10:27:35,761 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,762 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:35,767 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:27:42,541 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [226, 227], 'children': []}
2025-01-08 10:27:42,542 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:42,637 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [55, 56], 'children': []}
2025-01-08 10:27:42,638 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:42,752 - INFO - Step 1 result: {'type': 'Program', 'name': 'verify_user', 'range': [91, 225], 'children': []}
2025-01-08 10:27:42,753 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:43,031 - INFO - Step 1 result: {'type': 'Program', 'name': 'requires_admin_user', 'range': [57, 88], 'children': []}
2025-01-08 10:27:43,068 - INFO - Step 1 result: {'error': 'Insufficient data to identify top-level declarations. The provided token list does not contain enough information to determine any declarations.'}
2025-01-08 10:27:43,129 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:43,069 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:43,136 - INFO - Step 1 result: {'error': 'Insufficient token list provided for analysis. The token list must contain more than just a newline character to identify top-level declarations.'}
2025-01-08 10:27:43,286 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:43,580 - INFO - Step 1 result: {'type': 'Program', 'name': 'get_user_id', 'range': [228, 279], 'children': []}
2025-01-08 10:27:43,580 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:47,299 - INFO - Step 1 result: {'type': 'Program', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'FunctionDeclaration', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [29, 39], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [31, 31]}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [33, 38]}]}, {'type': 'ReturnType', 'name': 'User', 'range': [42, 42]}, {'type': 'ReturnStatement', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [48, 48]}, {'type': 'Argument', 'name': 'admin_only', 'range': [50, 52]}]}]}]}
2025-01-08 10:27:47,299 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:49,167 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [0, 25], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'fastapi', 'range': [0, 1]}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [4, 9], 'children': [{'type': 'ImportSpecifier', 'name': 'Settings', 'range': [4, 8]}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [10, 15], 'children': [{'type': 'ImportSpecifier', 'name': 'auth_middleware', 'range': [10, 14]}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [16, 23], 'children': [{'type': 'ImportSpecifier', 'name': 'DEFAULT_USER_ID', 'range': [16, 20]}, {'type': 'ImportSpecifier', 'name': 'User', 'range': [22, 22]}]}]}
2025-01-08 10:27:49,173 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:27:51,702 - INFO - Step 2 result: {'error': 'Insufficient token list provided for analysis. The token list must contain more than just a newline character to identify top-level declarations and their inner content.'}
2025-01-08 10:27:51,702 - INFO - Starting Step 3: AST simplification
2025-01-08 10:27:57,774 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [55, 56], 'children': []}
2025-01-08 10:27:57,774 - INFO - Starting Step 3: AST simplification
2025-01-08 10:27:58,551 - INFO - Step 2 result: {'error': 'Insufficient data to identify top-level declarations. The provided token list does not contain enough information to determine any declarations.'}
2025-01-08 10:27:58,597 - INFO - Starting Step 3: AST simplification
2025-01-08 10:27:58,613 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [226, 227], 'children': []}
2025-01-08 10:27:58,635 - INFO - Starting Step 3: AST simplification
2025-01-08 10:27:59,406 - INFO - Step 3 result: {'error': 'Insufficient token list provided for analysis. The token list must contain more than just a newline character to identify top-level declarations and their inner content.'}
2025-01-08 10:27:59,431 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:02,394 - INFO - Step 2 result: {'type': 'Program', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'FunctionDeclaration', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [61, 70], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [63, 63], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [65, 70], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [76, 76], 'children': []}, {'type': 'ReturnStatement', 'name': 'return verify_user(payload, admin_only=True)', 'range': [79, 87], 'children': [{'type': 'FunctionCall', 'name': 'verify_user', 'range': [80, 87], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [82, 82], 'children': []}, {'type': 'KeywordArgument', 'name': 'admin_only=True', 'range': [84, 86], 'children': []}]}]}]}]}
2025-01-08 10:28:02,435 - INFO - Starting Step 3: AST simplification
2025-01-08 10:28:05,102 - INFO - Step 2 result: {'nodes': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'fastapi', 'range': [0, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [4, 9], 'children': [{'type': 'ImportSpecifier', 'name': 'Settings', 'range': [4, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [10, 15], 'children': [{'type': 'ImportSpecifier', 'name': 'auth_middleware', 'range': [10, 14], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [16, 23], 'children': [{'type': 'ImportSpecifier', 'name': 'DEFAULT_USER_ID', 'range': [16, 20], 'children': []}, {'type': 'ImportSpecifier', 'name': 'User', 'range': [22, 22], 'children': []}]}]}
2025-01-08 10:28:05,102 - INFO - Starting Step 3: AST simplification
2025-01-08 10:28:05,249 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [55, 56], 'children': []}
2025-01-08 10:28:05,249 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:05,710 - INFO - Step 2 result: {'type': 'Program', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'FunctionDeclaration', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [29, 39], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [31, 31]}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [33, 38], 'children': [{'type': 'CallExpression', 'name': 'Depends', 'range': [35, 38], 'children': [{'type': 'Argument', 'name': 'auth_middleware', 'range': [37, 37]}]}]}]}, {'type': 'ReturnType', 'name': 'User', 'range': [42, 42]}, {'type': 'ReturnStatement', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'CallExpression', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [48, 48]}, {'type': 'Argument', 'name': 'admin_only', 'range': [50, 52], 'children': [{'type': 'Literal', 'name': 'False', 'range': [52, 52]}]}]}]}]}]}
2025-01-08 10:28:06,416 - INFO - Starting Step 3: AST simplification
2025-01-08 10:28:09,898 - INFO - Step 3 result: {'error': 'Insufficient data to identify top-level declarations. The provided token list does not contain enough information to determine any declarations.'}
2025-01-08 10:28:09,981 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [226, 227], 'children': []}
2025-01-08 10:28:09,990 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:10,039 - INFO - Step 4 result: {'type': 'Program', 'name': 'Main', 'range': [0, 0], 'children': []}
2025-01-08 10:28:10,140 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:10,058 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:10,587 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [55, 56], 'children': []}
2025-01-08 10:28:10,588 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:13,784 - INFO - Step 2 result: {'type': 'Program', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [231, 240], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [233, 233], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [235, 240], 'children': []}]}, {'type': 'ReturnType', 'name': 'str', 'range': [244, 244], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [246, 279], 'children': [{'type': 'VariableDeclaration', 'name': 'user_id', 'range': [247, 254], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [248, 254], 'children': [{'type': 'MemberExpression', 'name': 'payload.get', 'range': [249, 252], 'children': []}, {'type': 'Literal', 'name': '"sub"', 'range': [253, 253], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [256, 275], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [257, 257], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [258, 258], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [260, 275], 'children': [{'type': 'ThrowStatement', 'name': 'raise', 'range': [261, 275], 'children': [{'type': 'NewExpression', 'name': 'fastapi.HTTPException', 'range': [262, 275], 'children': [{'type': 'ArgumentList', 'name': '', 'range': [265, 275], 'children': [{'type': 'AssignmentExpression', 'name': 'status_code=', 'range': [267, 269], 'children': [{'type': 'Literal', 'name': '401', 'range': [269, 269], 'children': []}]}, {'type': 'AssignmentExpression', 'name': 'detail=', 'range': [271, 273], 'children': [{'type': 'Literal', 'name': '"User ID not found in token"', 'range': [273, 273], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [277, 278], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [278, 278], 'children': []}]}]}]}]}
2025-01-08 10:28:13,784 - INFO - Starting Step 3: AST simplification
2025-01-08 10:28:15,184 - INFO - Step 3 result: {'nodes': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'fastapi', 'range': [0, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [4, 9], 'children': [{'type': 'ImportSpecifier', 'name': 'Settings', 'range': [4, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [10, 15], 'children': [{'type': 'ImportSpecifier', 'name': 'auth_middleware', 'range': [10, 14], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [16, 23], 'children': [{'type': 'ImportSpecifier', 'name': 'DEFAULT_USER_ID', 'range': [16, 20], 'children': []}, {'type': 'ImportSpecifier', 'name': 'User', 'range': [22, 22], 'children': []}]}]}
2025-01-08 10:28:15,683 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:16,921 - INFO - Step 3 result: {'type': 'Program', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'FunctionDeclaration', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [61, 70], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [63, 63], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [65, 70], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [76, 76], 'children': []}, {'type': 'ReturnStatement', 'name': 'return verify_user(payload, admin_only=True)', 'range': [79, 87], 'children': [{'type': 'FunctionCall', 'name': 'verify_user', 'range': [80, 87], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [82, 82], 'children': []}, {'type': 'KeywordArgument', 'name': 'admin_only=True', 'range': [84, 86], 'children': []}]}]}]}]}
2025-01-08 10:28:16,921 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:17,376 - INFO - Step 4 result: {'type': 'Program', 'name': 'Program', 'range': [0, 0], 'children': []}
2025-01-08 10:28:17,379 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:18,193 - INFO - Step 3 result: {'type': 'Program', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'FunctionDeclaration', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [29, 39], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [31, 31]}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [33, 38], 'children': [{'type': 'CallExpression', 'name': 'Depends', 'range': [35, 38], 'children': [{'type': 'Argument', 'name': 'auth_middleware', 'range': [37, 37]}]}]}]}, {'type': 'ReturnType', 'name': 'User', 'range': [42, 42]}, {'type': 'ReturnStatement', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'CallExpression', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [48, 48]}, {'type': 'Argument', 'name': 'admin_only', 'range': [50, 52], 'children': [{'type': 'Literal', 'name': 'False', 'range': [52, 52]}]}]}]}]}]}
2025-01-08 10:28:18,201 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:18,219 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [55, 56], 'children': []}
2025-01-08 10:28:18,220 - INFO - Completed main AST analysis flow
2025-01-08 10:28:18,220 - INFO - Successfully processed chunk
2025-01-08 10:28:18,400 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [226, 227], 'children': []}
2025-01-08 10:28:18,400 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:18,609 - INFO - Step 5 result: {'type': 'Program', 'name': 'Main', 'range': [0, 0], 'children': []}
2025-01-08 10:28:18,609 - INFO - Completed main AST analysis flow
2025-01-08 10:28:18,609 - INFO - Successfully processed chunk
2025-01-08 10:28:21,996 - INFO - Step 5 result: {'type': 'Program', 'name': 'Program', 'range': [0, 0], 'children': []}
2025-01-08 10:28:22,001 - INFO - Completed main AST analysis flow
2025-01-08 10:28:22,002 - INFO - Successfully processed chunk
2025-01-08 10:28:22,232 - INFO - Step 2 result: {'type': 'Program', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'FunctionDeclaration', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [93, 103], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [94, 98], 'children': []}, {'type': 'Parameter', 'name': 'admin_only', 'range': [100, 102], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [104, 106], 'children': []}, {'type': 'Block', 'name': 'body', 'range': [108, 225], 'children': [{'type': 'IfStatement', 'name': 'if_not_payload', 'range': [109, 135], 'children': [{'type': 'Condition', 'name': 'not_payload', 'range': [110, 111], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [113, 135], 'children': [{'type': 'IfStatement', 'name': 'if_ENABLE_AUTH', 'range': [114, 135], 'children': [{'type': 'Condition', 'name': 'Settings.ENABLE_AUTH', 'range': [115, 117], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [119, 135], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [120, 134], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [121, 134], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [124, 133], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [126, 128], 'children': []}, {'type': 'Argument', 'name': 'detail="Authorization header is missing"', 'range': [130, 132], 'children': []}]}]}]}]}]}]}]}, {'type': 'Comment', 'name': 'comment', 'range': [136, 145], 'children': []}, {'type': 'Assignment', 'name': 'payload_assignment', 'range': [146, 156], 'children': [{'type': 'ObjectLiteral', 'name': 'payload', 'range': [148, 156], 'children': [{'type': 'Property', 'name': 'sub', 'range': [149, 151], 'children': []}, {'type': 'Property', 'name': 'role', 'range': [153, 155], 'children': []}]}]}, {'type': 'Assignment', 'name': 'user_id_assignment', 'range': [159, 167], 'children': [{'type': 'CallExpression', 'name': 'payload.get', 'range': [161, 167], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [164, 166], 'children': [{'type': 'Argument', 'name': '"sub"', 'range': [165, 165], 'children': []}]}]}]}, {'type': 'IfStatement', 'name': 'if_not_user_id', 'range': [169, 189], 'children': [{'type': 'Condition', 'name': 'not_user_id', 'range': [170, 171], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [173, 189], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [174, 188], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [175, 188], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [178, 187], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [180, 182], 'children': []}, {'type': 'Argument', 'name': 'detail="User ID not found in token"', 'range': [184, 186], 'children': []}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if_admin_only', 'range': [191, 216], 'children': [{'type': 'Condition', 'name': 'admin_only_and_payload_role_not_admin', 'range': [192, 200], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [202, 216], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [203, 215], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [204, 215], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [207, 214], 'children': [{'type': 'Argument', 'name': 'status_code=403', 'range': [208, 210], 'children': []}, {'type': 'Argument', 'name': 'detail="Admin access required"', 'range': [212, 214], 'children': []}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return_User_from_payload', 'range': [218, 225], 'children': [{'type': 'CallExpression', 'name': 'User.from_payload', 'range': [219, 225], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [222, 224], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [223, 223], 'children': []}]}]}]}]}]}]}
2025-01-08 10:28:22,237 - INFO - Starting Step 3: AST simplification
2025-01-08 10:28:22,274 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [226, 227], 'children': []}
2025-01-08 10:28:22,294 - INFO - Completed main AST analysis flow
2025-01-08 10:28:22,299 - INFO - Successfully processed chunk
2025-01-08 10:28:25,539 - INFO - Step 4 result: {'nodes': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'fastapi', 'range': [0, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [4, 9], 'children': [{'type': 'ImportSpecifier', 'name': 'Settings', 'range': [4, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [10, 15], 'children': [{'type': 'ImportSpecifier', 'name': 'auth_middleware', 'range': [10, 14], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [16, 23], 'children': [{'type': 'ImportSpecifier', 'name': 'DEFAULT_USER_ID', 'range': [16, 20], 'children': []}, {'type': 'ImportSpecifier', 'name': 'User', 'range': [22, 22], 'children': []}]}]}
2025-01-08 10:28:25,539 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:26,715 - INFO - Step 4 result: {'type': 'Program', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'FunctionDecl', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [61, 70], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [63, 63], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [65, 70], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [76, 76], 'children': []}, {'type': 'ReturnStatement', 'name': 'return verify_user(payload, admin_only=True)', 'range': [79, 87], 'children': [{'type': 'CallExpression', 'name': 'verify_user', 'range': [80, 87], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [82, 82], 'children': []}, {'type': 'KeywordArgument', 'name': 'admin_only=True', 'range': [84, 86], 'children': []}]}]}]}]}
2025-01-08 10:28:26,718 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:29,282 - INFO - Step 4 result: {'type': 'Program', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'FunctionDecl', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [29, 39], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [31, 31]}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [33, 38], 'children': [{'type': 'CallExpression', 'name': 'Depends', 'range': [35, 38], 'children': [{'type': 'Argument', 'name': 'auth_middleware', 'range': [37, 37]}]}]}]}, {'type': 'ReturnType', 'name': 'User', 'range': [42, 42]}, {'type': 'ReturnStatement', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'CallExpression', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [48, 48]}, {'type': 'Argument', 'name': 'admin_only', 'range': [50, 52], 'children': [{'type': 'Literal', 'name': 'False', 'range': [52, 52]}]}]}]}]}]}
2025-01-08 10:28:29,282 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:33,742 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'MainOrSomething', 'range': [0, 23], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'fastapi', 'range': [0, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [4, 9], 'children': [{'type': 'ImportSpecifier', 'name': 'Settings', 'range': [4, 8], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [10, 15], 'children': [{'type': 'ImportSpecifier', 'name': 'auth_middleware', 'range': [10, 14], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [16, 23], 'children': [{'type': 'ImportSpecifier', 'name': 'DEFAULT_USER_ID', 'range': [16, 20], 'children': []}, {'type': 'ImportSpecifier', 'name': 'User', 'range': [22, 22], 'children': []}]}]}]}
2025-01-08 10:28:33,742 - INFO - Completed main AST analysis flow
2025-01-08 10:28:33,743 - INFO - Successfully processed chunk
2025-01-08 10:28:35,440 - INFO - Step 5 result: {'type': 'Program', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'FunctionDecl', 'name': 'requires_admin_user', 'range': [57, 88], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [61, 70], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [63, 63], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [65, 70], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [76, 76], 'children': []}, {'type': 'ReturnStatement', 'name': 'return verify_user(payload, admin_only=True)', 'range': [79, 87], 'children': [{'type': 'CallExpression', 'name': 'verify_user', 'range': [80, 87], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [82, 82], 'children': []}, {'type': 'KeywordArgument', 'name': 'admin_only=True', 'range': [84, 86], 'children': []}]}]}]}]}
2025-01-08 10:28:35,441 - INFO - Completed main AST analysis flow
2025-01-08 10:28:35,441 - INFO - Successfully processed chunk
2025-01-08 10:28:35,793 - INFO - Step 3 result: {'type': 'Program', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [231, 240], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [233, 233], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [235, 240], 'children': []}]}, {'type': 'ReturnType', 'name': 'str', 'range': [244, 244], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [246, 279], 'children': [{'type': 'VariableDeclaration', 'name': 'user_id', 'range': [247, 254], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [248, 254], 'children': [{'type': 'MemberExpression', 'name': 'payload.get', 'range': [249, 252], 'children': []}, {'type': 'Literal', 'name': '"sub"', 'range': [253, 253], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [256, 275], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [257, 257], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [258, 258], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [260, 275], 'children': [{'type': 'ThrowStatement', 'name': 'raise', 'range': [261, 275], 'children': [{'type': 'NewExpression', 'name': 'fastapi.HTTPException', 'range': [262, 275], 'children': [{'type': 'ArgumentList', 'name': '', 'range': [265, 275], 'children': [{'type': 'AssignmentExpression', 'name': 'status_code=', 'range': [267, 269], 'children': [{'type': 'Literal', 'name': '401', 'range': [269, 269], 'children': []}]}, {'type': 'AssignmentExpression', 'name': 'detail=', 'range': [271, 273], 'children': [{'type': 'Literal', 'name': '"User ID not found in token"', 'range': [273, 273], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [277, 278], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [278, 278], 'children': []}]}]}]}]}
2025-01-08 10:28:35,793 - INFO - Starting Step 4: AST normalization
2025-01-08 10:28:39,112 - INFO - Step 5 result: {'type': 'Program', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'FunctionDecl', 'name': 'requires_user', 'range': [26, 54], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [29, 39], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [31, 31]}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [33, 38], 'children': [{'type': 'CallExpression', 'name': 'Depends', 'range': [35, 38], 'children': [{'type': 'Argument', 'name': 'auth_middleware', 'range': [37, 37]}]}]}]}, {'type': 'ReturnType', 'name': 'User', 'range': [42, 42]}, {'type': 'ReturnStatement', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'CallExpression', 'name': 'verify_user', 'range': [46, 53], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [48, 48]}, {'type': 'Argument', 'name': 'admin_only', 'range': [50, 52], 'children': [{'type': 'Literal', 'name': 'False', 'range': [52, 52]}]}]}]}]}]}
2025-01-08 10:28:39,112 - INFO - Completed main AST analysis flow
2025-01-08 10:28:39,113 - INFO - Successfully processed chunk
2025-01-08 10:28:53,683 - INFO - Step 4 result: {'type': 'Program', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'FunctionDecl', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [231, 240], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [233, 233], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [235, 240], 'children': []}]}, {'type': 'ReturnType', 'name': 'str', 'range': [244, 244], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [246, 279], 'children': [{'type': 'VariableDecl', 'name': 'user_id', 'range': [247, 254], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [248, 254], 'children': [{'type': 'CallExpression', 'name': 'payload.get', 'range': [249, 252], 'children': []}, {'type': 'Literal', 'name': '"sub"', 'range': [253, 253], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [256, 275], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [257, 257], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [258, 258], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [260, 275], 'children': [{'type': 'ThrowStatement', 'name': 'raise', 'range': [261, 275], 'children': [{'type': 'NewExpression', 'name': 'fastapi.HTTPException', 'range': [262, 275], 'children': [{'type': 'ArgumentList', 'name': '', 'range': [265, 275], 'children': [{'type': 'AssignmentExpression', 'name': 'status_code=', 'range': [267, 269], 'children': [{'type': 'Literal', 'name': '401', 'range': [269, 269], 'children': []}]}, {'type': 'AssignmentExpression', 'name': 'detail=', 'range': [271, 273], 'children': [{'type': 'Literal', 'name': '"User ID not found in token"', 'range': [273, 273], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [277, 278], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [278, 278], 'children': []}]}]}]}]}
2025-01-08 10:28:53,683 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:28:54,581 - INFO - Step 3 result: {'type': 'Program', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'FunctionDeclaration', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [93, 103], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [94, 98], 'children': []}, {'type': 'Parameter', 'name': 'admin_only', 'range': [100, 102], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [104, 106], 'children': []}, {'type': 'Block', 'name': 'body', 'range': [108, 225], 'children': [{'type': 'IfStatement', 'name': 'if_not_payload', 'range': [109, 135], 'children': [{'type': 'Condition', 'name': 'not_payload', 'range': [110, 111], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [113, 135], 'children': [{'type': 'IfStatement', 'name': 'if_ENABLE_AUTH', 'range': [114, 135], 'children': [{'type': 'Condition', 'name': 'Settings.ENABLE_AUTH', 'range': [115, 117], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [119, 135], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [120, 134], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [121, 134], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [124, 133], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [126, 128], 'children': []}, {'type': 'Argument', 'name': 'detail="Authorization header is missing"', 'range': [130, 132], 'children': []}]}]}]}]}]}]}]}, {'type': 'Comment', 'name': 'comment', 'range': [136, 145], 'children': []}, {'type': 'Assignment', 'name': 'payload_assignment', 'range': [146, 156], 'children': [{'type': 'ObjectLiteral', 'name': 'payload', 'range': [148, 156], 'children': [{'type': 'Property', 'name': 'sub', 'range': [149, 151], 'children': []}, {'type': 'Property', 'name': 'role', 'range': [153, 155], 'children': []}]}]}, {'type': 'Assignment', 'name': 'user_id_assignment', 'range': [159, 167], 'children': [{'type': 'CallExpression', 'name': 'payload.get', 'range': [161, 167], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [164, 166], 'children': [{'type': 'Argument', 'name': '"sub"', 'range': [165, 165], 'children': []}]}]}]}, {'type': 'IfStatement', 'name': 'if_not_user_id', 'range': [169, 189], 'children': [{'type': 'Condition', 'name': 'not_user_id', 'range': [170, 171], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [173, 189], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [174, 188], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [175, 188], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [178, 187], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [180, 182], 'children': []}, {'type': 'Argument', 'name': 'detail="User ID not found in token"', 'range': [184, 186], 'children': []}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if_admin_only', 'range': [191, 216], 'children': [{'type': 'Condition', 'name': 'admin_only_and_payload_role_not_admin', 'range': [192, 200], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [202, 216], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [203, 215], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [204, 215], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [207, 214], 'children': [{'type': 'Argument', 'name': 'status_code=403', 'range': [208, 210], 'children': []}, {'type': 'Argument', 'name': 'detail="Admin access required"', 'range': [212, 214], 'children': []}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return_User_from_payload', 'range': [218, 225], 'children': [{'type': 'CallExpression', 'name': 'User.from_payload', 'range': [219, 225], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [222, 224], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [223, 223], 'children': []}]}]}]}]}]}]}
2025-01-08 10:28:54,581 - INFO - Starting Step 4: AST normalization
2025-01-08 10:29:09,714 - INFO - Step 5 result: {'type': 'Program', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'FunctionDecl', 'name': 'get_user_id', 'range': [228, 279], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [231, 240], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [233, 233], 'children': []}, {'type': 'DefaultValue', 'name': 'fastapi.Depends(auth_middleware)', 'range': [235, 240], 'children': []}]}, {'type': 'ReturnType', 'name': 'str', 'range': [244, 244], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [246, 279], 'children': [{'type': 'VariableDecl', 'name': 'user_id', 'range': [247, 254], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [248, 254], 'children': [{'type': 'CallExpression', 'name': 'payload.get', 'range': [249, 252], 'children': []}, {'type': 'Literal', 'name': '"sub"', 'range': [253, 253], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [256, 275], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [257, 257], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [258, 258], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [260, 275], 'children': [{'type': 'ThrowStatement', 'name': 'raise', 'range': [261, 275], 'children': [{'type': 'NewExpression', 'name': 'fastapi.HTTPException', 'range': [262, 275], 'children': [{'type': 'ArgumentList', 'name': '', 'range': [265, 275], 'children': [{'type': 'AssignmentExpression', 'name': 'status_code=', 'range': [267, 269], 'children': [{'type': 'Literal', 'name': '401', 'range': [269, 269], 'children': []}]}, {'type': 'AssignmentExpression', 'name': 'detail=', 'range': [271, 273], 'children': [{'type': 'Literal', 'name': '"User ID not found in token"', 'range': [273, 273], 'children': []}]}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [277, 278], 'children': [{'type': 'Identifier', 'name': 'user_id', 'range': [278, 278], 'children': []}]}]}]}]}
2025-01-08 10:29:09,714 - INFO - Completed main AST analysis flow
2025-01-08 10:29:09,715 - INFO - Successfully processed chunk
2025-01-08 10:29:26,854 - INFO - Step 4 result: {'type': 'Program', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'FunctionDecl', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [93, 103], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [94, 98], 'children': []}, {'type': 'Parameter', 'name': 'admin_only', 'range': [100, 102], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [104, 106], 'children': []}, {'type': 'Block', 'name': 'body', 'range': [108, 225], 'children': [{'type': 'IfStatement', 'name': 'if_not_payload', 'range': [109, 135], 'children': [{'type': 'Condition', 'name': 'not_payload', 'range': [110, 111], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [113, 135], 'children': [{'type': 'IfStatement', 'name': 'if_ENABLE_AUTH', 'range': [114, 135], 'children': [{'type': 'Condition', 'name': 'Settings.ENABLE_AUTH', 'range': [115, 117], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [119, 135], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [120, 134], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [121, 134], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [124, 133], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [126, 128], 'children': []}, {'type': 'Argument', 'name': 'detail="Authorization header is missing"', 'range': [130, 132], 'children': []}]}]}]}]}]}]}]}, {'type': 'Comment', 'name': 'comment', 'range': [136, 145], 'children': []}, {'type': 'Assignment', 'name': 'payload_assignment', 'range': [146, 156], 'children': [{'type': 'ObjectLiteral', 'name': 'payload', 'range': [148, 156], 'children': [{'type': 'Property', 'name': 'sub', 'range': [149, 151], 'children': []}, {'type': 'Property', 'name': 'role', 'range': [153, 155], 'children': []}]}]}, {'type': 'Assignment', 'name': 'user_id_assignment', 'range': [159, 167], 'children': [{'type': 'CallExpression', 'name': 'payload.get', 'range': [161, 167], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [164, 166], 'children': [{'type': 'Argument', 'name': '"sub"', 'range': [165, 165], 'children': []}]}]}]}, {'type': 'IfStatement', 'name': 'if_not_user_id', 'range': [169, 189], 'children': [{'type': 'Condition', 'name': 'not_user_id', 'range': [170, 171], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [173, 189], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [174, 188], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [175, 188], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [178, 187], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [180, 182], 'children': []}, {'type': 'Argument', 'name': 'detail="User ID not found in token"', 'range': [184, 186], 'children': []}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if_admin_only', 'range': [191, 216], 'children': [{'type': 'Condition', 'name': 'admin_only_and_payload_role_not_admin', 'range': [192, 200], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [202, 216], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [203, 215], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [204, 215], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [207, 214], 'children': [{'type': 'Argument', 'name': 'status_code=403', 'range': [208, 210], 'children': []}, {'type': 'Argument', 'name': 'detail="Admin access required"', 'range': [212, 214], 'children': []}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return_User_from_payload', 'range': [218, 225], 'children': [{'type': 'CallExpression', 'name': 'User.from_payload', 'range': [219, 225], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [222, 224], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [223, 223], 'children': []}]}]}]}]}]}]}
2025-01-08 10:29:26,854 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:29:58,001 - INFO - Step 5 result: {'type': 'Program', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'FunctionDecl', 'name': 'verify_user', 'range': [91, 225], 'children': [{'type': 'ParameterList', 'name': 'parameters', 'range': [93, 103], 'children': [{'type': 'Parameter', 'name': 'payload', 'range': [94, 98], 'children': []}, {'type': 'Parameter', 'name': 'admin_only', 'range': [100, 102], 'children': []}]}, {'type': 'ReturnType', 'name': 'User', 'range': [104, 106], 'children': []}, {'type': 'Block', 'name': 'body', 'range': [108, 225], 'children': [{'type': 'IfStatement', 'name': 'if_not_payload', 'range': [109, 135], 'children': [{'type': 'Condition', 'name': 'not_payload', 'range': [110, 111], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [113, 135], 'children': [{'type': 'IfStatement', 'name': 'if_ENABLE_AUTH', 'range': [114, 135], 'children': [{'type': 'Condition', 'name': 'Settings.ENABLE_AUTH', 'range': [115, 117], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [119, 135], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [120, 134], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [121, 134], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [124, 133], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [126, 128], 'children': []}, {'type': 'Argument', 'name': 'detail="Authorization header is missing"', 'range': [130, 132], 'children': []}]}]}]}]}]}]}]}, {'type': 'Comment', 'name': 'comment', 'range': [136, 145], 'children': []}, {'type': 'Assignment', 'name': 'payload_assignment', 'range': [146, 156], 'children': [{'type': 'ObjectLiteral', 'name': 'payload', 'range': [148, 156], 'children': [{'type': 'Property', 'name': 'sub', 'range': [149, 151], 'children': []}, {'type': 'Property', 'name': 'role', 'range': [153, 155], 'children': []}]}]}, {'type': 'Assignment', 'name': 'user_id_assignment', 'range': [159, 167], 'children': [{'type': 'CallExpression', 'name': 'payload.get', 'range': [161, 167], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [164, 166], 'children': [{'type': 'Argument', 'name': '"sub"', 'range': [165, 165], 'children': []}]}]}]}, {'type': 'IfStatement', 'name': 'if_not_user_id', 'range': [169, 189], 'children': [{'type': 'Condition', 'name': 'not_user_id', 'range': [170, 171], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [173, 189], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [174, 188], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [175, 188], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [178, 187], 'children': [{'type': 'Argument', 'name': 'status_code=401', 'range': [180, 182], 'children': []}, {'type': 'Argument', 'name': 'detail="User ID not found in token"', 'range': [184, 186], 'children': []}]}]}]}]}]}, {'type': 'IfStatement', 'name': 'if_admin_only', 'range': [191, 216], 'children': [{'type': 'Condition', 'name': 'admin_only_and_payload_role_not_admin', 'range': [192, 200], 'children': []}, {'type': 'Block', 'name': 'then', 'range': [202, 216], 'children': [{'type': 'RaiseStatement', 'name': 'raise_HTTPException', 'range': [203, 215], 'children': [{'type': 'CallExpression', 'name': 'fastapi.HTTPException', 'range': [204, 215], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [207, 214], 'children': [{'type': 'Argument', 'name': 'status_code=403', 'range': [208, 210], 'children': []}, {'type': 'Argument', 'name': 'detail="Admin access required"', 'range': [212, 214], 'children': []}]}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return_User_from_payload', 'range': [218, 225], 'children': [{'type': 'CallExpression', 'name': 'User.from_payload', 'range': [219, 225], 'children': [{'type': 'ArgumentList', 'name': 'arguments', 'range': [222, 224], 'children': [{'type': 'Argument', 'name': 'payload', 'range': [223, 223], 'children': []}]}]}]}]}]}]}
2025-01-08 10:29:58,002 - INFO - Completed main AST analysis flow
2025-01-08 10:29:58,002 - INFO - Successfully processed chunk
2025-01-08 10:29:58,020 - INFO - Starting code generation from AST
2025-01-08 10:30:04,980 - INFO - Successfully generated code from AST
2025-01-08 10:30:04,980 - INFO - Starting static code similarity comparison
2025-01-08 10:30:04,983 - INFO - Static similarity result: {'final_score': 96.81, 'length_similarity': 98.91, 'token_similarity': 100.0, 'structure_similarity': 87.88, 'function_similarity': 100, 'complexity_similarity': 100.0, 'variable_similarity': 100}

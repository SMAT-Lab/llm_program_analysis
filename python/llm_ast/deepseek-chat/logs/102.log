2025-01-08 09:56:46,773 - INFO - Processing sample 102
2025-01-08 09:56:46,773 - INFO - Starting Step 0: Splitting code into top-level declarations
2025-01-08 09:56:49,608 - INFO - Successfully split code into 3 top-level declarations
2025-01-08 09:56:49,610 - INFO - Processing chunk #0 (size=55 chars, start_index=0)
2025-01-08 09:56:49,611 - INFO - Processing chunk with 55 chars starting at index 0
2025-01-08 09:56:49,611 - INFO - Starting main AST analysis flow
2025-01-08 09:56:49,611 - INFO - Tokenized code into 23 tokens
2025-01-08 09:56:49,611 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 09:56:49,612 - INFO - Processing chunk #1 (size=380 chars, start_index=23)
2025-01-08 09:56:49,613 - INFO - Processing chunk with 380 chars starting at index 23
2025-01-08 09:56:49,613 - INFO - Starting main AST analysis flow
2025-01-08 09:56:49,613 - INFO - Tokenized code into 90 tokens
2025-01-08 09:56:49,614 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 09:56:49,619 - INFO - Processing chunk #2 (size=57 chars, start_index=113)
2025-01-08 09:56:49,619 - INFO - Processing chunk with 57 chars starting at index 113
2025-01-08 09:56:49,620 - INFO - Starting main AST analysis flow
2025-01-08 09:56:49,620 - INFO - Tokenized code into 13 tokens
2025-01-08 09:56:49,620 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 09:56:51,488 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [0, 22], 'children': []}
2025-01-08 09:56:51,488 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 09:56:54,015 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [23, 112], 'children': [{'type': 'ClassDeclaration', 'name': 'RemoveDuplicateUrls', 'range': [23, 29], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'mapper', 'range': [31, 46], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'reducer', 'range': [48, 77], 'children': []}, {'type': 'FunctionDeclaration', 'name': 'steps', 'range': [79, 112], 'children': []}]}
2025-01-08 09:56:54,015 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 09:56:57,856 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [113, 125], 'children': [{'type': 'IfStatement', 'name': '', 'range': [113, 118], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [114, 117], 'children': [{'type': 'Identifier', 'name': '__name__', 'range': [114, 114], 'children': []}, {'type': 'StringLiteral', 'name': "'__main__'", 'range': [117, 117], 'children': []}]}]}, {'type': 'ExpressionStatement', 'name': '', 'range': [120, 124], 'children': [{'type': 'CallExpression', 'name': '', 'range': [120, 124], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [120, 122], 'children': [{'type': 'Identifier', 'name': 'RemoveDuplicateUrls', 'range': [120, 120], 'children': []}, {'type': 'Identifier', 'name': 'run', 'range': [122, 122], 'children': []}]}]}]}]}
2025-01-08 09:56:57,857 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 09:56:58,337 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [0, 22], 'children': [{'type': 'Comment', 'name': '', 'range': [0, 12], 'children': [{'type': 'CommentLine', 'name': '', 'range': [0, 12], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [14, 20], 'children': [{'type': 'ImportSpecifier', 'name': 'MRJob', 'range': [14, 20], 'children': [{'type': 'ImportDefaultSpecifier', 'name': 'MRJob', 'range': [19, 20], 'children': []}, {'type': 'ImportNamespaceSpecifier', 'name': 'mrjob.job', 'range': [14, 18], 'children': []}]}]}]}
2025-01-08 09:56:58,337 - INFO - Starting Step 3: AST simplification
2025-01-08 09:57:05,270 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [0, 22], 'children': [{'type': 'Comment', 'name': '', 'range': [0, 12], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [14, 20], 'children': [{'type': 'ImportSpecifier', 'name': 'MRJob', 'range': [14, 20], 'children': [{'type': 'ImportDefaultSpecifier', 'name': 'MRJob', 'range': [19, 20], 'children': []}, {'type': 'ImportNamespaceSpecifier', 'name': 'mrjob.job', 'range': [14, 18], 'children': []}]}]}]}
2025-01-08 09:57:05,270 - INFO - Starting Step 4: AST normalization
2025-01-08 09:57:06,589 - INFO - Step 2 result: {'nodes': [{'type': 'IfStatement', 'name': '', 'range': [113, 118], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [114, 117], 'children': [{'type': 'Identifier', 'name': '__name__', 'range': [114, 114], 'children': []}, {'type': 'StringLiteral', 'name': "'__main__'", 'range': [117, 117], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [118, 125], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [120, 124], 'children': [{'type': 'CallExpression', 'name': '', 'range': [120, 124], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [120, 122], 'children': [{'type': 'Identifier', 'name': 'RemoveDuplicateUrls', 'range': [120, 120], 'children': []}, {'type': 'Identifier', 'name': 'run', 'range': [122, 122], 'children': []}]}]}]}]}]}]}
2025-01-08 09:57:06,590 - INFO - Starting Step 3: AST simplification
2025-01-08 09:57:10,361 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [0, 22], 'children': [{'type': 'Comment', 'name': '', 'range': [0, 12], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [14, 20], 'children': [{'type': 'ImportSpecifier', 'name': 'MRJob', 'range': [14, 20], 'children': [{'type': 'ImportDefaultSpecifier', 'name': 'MRJob', 'range': [19, 20], 'children': []}, {'type': 'ImportNamespaceSpecifier', 'name': 'mrjob.job', 'range': [14, 18], 'children': []}]}]}]}
2025-01-08 09:57:10,362 - INFO - Starting Step 5: Final AST combination
2025-01-08 09:57:14,720 - INFO - Step 2 result: {'nodes': [{'type': 'ClassDeclaration', 'name': 'RemoveDuplicateUrls', 'range': [23, 29], 'children': [{'type': 'Inheritance', 'name': 'MRJob', 'range': [26, 27], 'children': []}]}, {'type': 'FunctionDeclaration', 'name': 'mapper', 'range': [31, 46], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [34, 35], 'children': []}, {'type': 'Parameter', 'name': '_', 'range': [36, 37], 'children': []}, {'type': 'Parameter', 'name': 'line', 'range': [38, 39], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [42, 46], 'children': [{'type': 'YieldValue', 'name': 'line', 'range': [43, 44], 'children': []}, {'type': 'YieldValue', 'name': '1', 'range': [45, 46], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'reducer', 'range': [48, 77], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [51, 52], 'children': []}, {'type': 'Parameter', 'name': 'key', 'range': [53, 54], 'children': []}, {'type': 'Parameter', 'name': 'values', 'range': [55, 56], 'children': []}, {'type': 'AssignmentExpression', 'name': 'total', 'range': [59, 65], 'children': [{'type': 'SumFunction', 'name': 'sum', 'range': [61, 65], 'children': [{'type': 'Argument', 'name': 'values', 'range': [63, 64], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [66, 77], 'children': [{'type': 'Condition', 'name': 'total == 1', 'range': [67, 71], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [73, 77], 'children': [{'type': 'YieldValue', 'name': 'key', 'range': [74, 75], 'children': []}, {'type': 'YieldValue', 'name': 'total', 'range': [76, 77], 'children': []}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'steps', 'range': [79, 112], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [82, 83], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [86, 89], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [90, 112], 'children': [{'type': 'List', 'name': '', 'range': [91, 112], 'children': [{'type': 'FunctionCall', 'name': 'mr', 'range': [93, 110], 'children': [{'type': 'Argument', 'name': 'mapper=self.mapper', 'range': [97, 103], 'children': []}, {'type': 'Argument', 'name': 'reducer=self.reducer', 'range': [104, 109], 'children': []}]}]}]}]}]}
2025-01-08 09:57:14,720 - INFO - Starting Step 3: AST simplification
2025-01-08 09:57:15,027 - INFO - Step 3 result: {'nodes': [{'type': 'IfStatement', 'name': '', 'range': [113, 118], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [114, 117], 'children': [{'type': 'Identifier', 'name': '__name__', 'range': [114, 114], 'children': []}, {'type': 'StringLiteral', 'name': "'__main__'", 'range': [117, 117], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [118, 125], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [120, 124], 'children': [{'type': 'CallExpression', 'name': '', 'range': [120, 124], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [120, 122], 'children': [{'type': 'Identifier', 'name': 'RemoveDuplicateUrls', 'range': [120, 120], 'children': []}, {'type': 'Identifier', 'name': 'run', 'range': [122, 122], 'children': []}]}]}]}]}]}]}
2025-01-08 09:57:15,027 - INFO - Starting Step 4: AST normalization
2025-01-08 09:57:15,448 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [0, 22], 'children': [{'type': 'Comment', 'name': '', 'range': [0, 12], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [14, 20], 'children': [{'type': 'ImportSpecifier', 'name': 'MRJob', 'range': [14, 20], 'children': [{'type': 'ImportDefaultSpecifier', 'name': 'MRJob', 'range': [19, 20], 'children': []}, {'type': 'ImportNamespaceSpecifier', 'name': 'mrjob.job', 'range': [14, 18], 'children': []}]}]}]}
2025-01-08 09:57:15,448 - INFO - Completed main AST analysis flow
2025-01-08 09:57:15,448 - INFO - Successfully processed chunk
2025-01-08 09:57:23,074 - INFO - Step 4 result: {'nodes': [{'type': 'IfStatement', 'name': '', 'range': [113, 118], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [114, 117], 'children': [{'type': 'Identifier', 'name': '__name__', 'range': [114, 114], 'children': []}, {'type': 'Literal', 'name': "'__main__'", 'range': [117, 117], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [118, 125], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [120, 124], 'children': [{'type': 'CallExpression', 'name': '', 'range': [120, 124], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [120, 122], 'children': [{'type': 'Identifier', 'name': 'RemoveDuplicateUrls', 'range': [120, 120], 'children': []}, {'type': 'Identifier', 'name': 'run', 'range': [122, 122], 'children': []}]}]}]}]}]}]}
2025-01-08 09:57:23,074 - INFO - Starting Step 5: Final AST combination
2025-01-08 09:57:31,476 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'MainOrSomething', 'range': [113, 125], 'children': [{'type': 'IfStatement', 'name': '', 'range': [113, 118], 'children': [{'type': 'BinaryExpression', 'name': '', 'range': [114, 117], 'children': [{'type': 'Identifier', 'name': '__name__', 'range': [114, 114], 'children': []}, {'type': 'Literal', 'name': "'__main__'", 'range': [117, 117], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [118, 125], 'children': [{'type': 'ExpressionStatement', 'name': '', 'range': [120, 124], 'children': [{'type': 'CallExpression', 'name': '', 'range': [120, 124], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [120, 122], 'children': [{'type': 'Identifier', 'name': 'RemoveDuplicateUrls', 'range': [120, 120], 'children': []}, {'type': 'Identifier', 'name': 'run', 'range': [122, 122], 'children': []}]}]}]}]}]}]}]}
2025-01-08 09:57:31,476 - INFO - Completed main AST analysis flow
2025-01-08 09:57:31,476 - INFO - Successfully processed chunk
2025-01-08 09:57:34,662 - INFO - Step 3 result: {'nodes': [{'type': 'ClassDeclaration', 'name': 'RemoveDuplicateUrls', 'range': [23, 29], 'children': [{'type': 'Inheritance', 'name': 'MRJob', 'range': [26, 27], 'children': []}]}, {'type': 'FunctionDeclaration', 'name': 'mapper', 'range': [31, 46], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [34, 35], 'children': []}, {'type': 'Parameter', 'name': '_', 'range': [36, 37], 'children': []}, {'type': 'Parameter', 'name': 'line', 'range': [38, 39], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [42, 46], 'children': [{'type': 'YieldValue', 'name': 'line', 'range': [43, 44], 'children': []}, {'type': 'YieldValue', 'name': '1', 'range': [45, 46], 'children': []}]}]}, {'type': 'FunctionDeclaration', 'name': 'reducer', 'range': [48, 77], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [51, 52], 'children': []}, {'type': 'Parameter', 'name': 'key', 'range': [53, 54], 'children': []}, {'type': 'Parameter', 'name': 'values', 'range': [55, 56], 'children': []}, {'type': 'AssignmentExpression', 'name': 'total', 'range': [59, 65], 'children': [{'type': 'SumFunction', 'name': 'sum', 'range': [61, 65], 'children': [{'type': 'Argument', 'name': 'values', 'range': [63, 64], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [66, 77], 'children': [{'type': 'Condition', 'name': 'total == 1', 'range': [67, 71], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [73, 77], 'children': [{'type': 'YieldValue', 'name': 'key', 'range': [74, 75], 'children': []}, {'type': 'YieldValue', 'name': 'total', 'range': [76, 77], 'children': []}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'steps', 'range': [79, 112], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [82, 83], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [86, 89], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [90, 112], 'children': [{'type': 'List', 'name': '', 'range': [91, 112], 'children': [{'type': 'FunctionCall', 'name': 'mr', 'range': [93, 110], 'children': [{'type': 'Argument', 'name': 'mapper=self.mapper', 'range': [97, 103], 'children': []}, {'type': 'Argument', 'name': 'reducer=self.reducer', 'range': [104, 109], 'children': []}]}]}]}]}]}
2025-01-08 09:57:34,662 - INFO - Starting Step 4: AST normalization
2025-01-08 09:57:54,942 - INFO - Step 4 result: {'nodes': [{'type': 'ClassDecl', 'name': 'RemoveDuplicateUrls', 'range': [23, 29], 'children': [{'type': 'Inheritance', 'name': 'MRJob', 'range': [26, 27], 'children': []}]}, {'type': 'FunctionDecl', 'name': 'mapper', 'range': [31, 46], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [34, 35], 'children': []}, {'type': 'Parameter', 'name': '_', 'range': [36, 37], 'children': []}, {'type': 'Parameter', 'name': 'line', 'range': [38, 39], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [42, 46], 'children': [{'type': 'YieldValue', 'name': 'line', 'range': [43, 44], 'children': []}, {'type': 'YieldValue', 'name': '1', 'range': [45, 46], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'reducer', 'range': [48, 77], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [51, 52], 'children': []}, {'type': 'Parameter', 'name': 'key', 'range': [53, 54], 'children': []}, {'type': 'Parameter', 'name': 'values', 'range': [55, 56], 'children': []}, {'type': 'AssignmentExpression', 'name': 'total', 'range': [59, 65], 'children': [{'type': 'CallExpression', 'name': 'sum', 'range': [61, 65], 'children': [{'type': 'Argument', 'name': 'values', 'range': [63, 64], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [66, 77], 'children': [{'type': 'BinaryExpression', 'name': 'total == 1', 'range': [67, 71], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [73, 77], 'children': [{'type': 'YieldValue', 'name': 'key', 'range': [74, 75], 'children': []}, {'type': 'YieldValue', 'name': 'total', 'range': [76, 77], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'steps', 'range': [79, 112], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [82, 83], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [86, 89], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [90, 112], 'children': [{'type': 'List', 'name': '', 'range': [91, 112], 'children': [{'type': 'CallExpression', 'name': 'mr', 'range': [93, 110], 'children': [{'type': 'Argument', 'name': 'mapper=self.mapper', 'range': [97, 103], 'children': []}, {'type': 'Argument', 'name': 'reducer=self.reducer', 'range': [104, 109], 'children': []}]}]}]}]}]}
2025-01-08 09:57:54,942 - INFO - Starting Step 5: Final AST combination
2025-01-08 09:58:15,685 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'RemoveDuplicateUrls', 'range': [23, 112], 'children': [{'type': 'ClassDecl', 'name': 'RemoveDuplicateUrls', 'range': [23, 29], 'children': [{'type': 'Inheritance', 'name': 'MRJob', 'range': [26, 27], 'children': []}]}, {'type': 'FunctionDecl', 'name': 'mapper', 'range': [31, 46], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [34, 35], 'children': []}, {'type': 'Parameter', 'name': '_', 'range': [36, 37], 'children': []}, {'type': 'Parameter', 'name': 'line', 'range': [38, 39], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [42, 46], 'children': [{'type': 'YieldValue', 'name': 'line', 'range': [43, 44], 'children': []}, {'type': 'YieldValue', 'name': '1', 'range': [45, 46], 'children': []}]}]}, {'type': 'FunctionDecl', 'name': 'reducer', 'range': [48, 77], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [51, 52], 'children': []}, {'type': 'Parameter', 'name': 'key', 'range': [53, 54], 'children': []}, {'type': 'Parameter', 'name': 'values', 'range': [55, 56], 'children': []}, {'type': 'AssignmentExpression', 'name': 'total', 'range': [59, 65], 'children': [{'type': 'CallExpression', 'name': 'sum', 'range': [61, 65], 'children': [{'type': 'Argument', 'name': 'values', 'range': [63, 64], 'children': []}]}]}, {'type': 'IfStatement', 'name': '', 'range': [66, 77], 'children': [{'type': 'BinaryExpression', 'name': 'total == 1', 'range': [67, 71], 'children': []}, {'type': 'YieldStatement', 'name': '', 'range': [73, 77], 'children': [{'type': 'YieldValue', 'name': 'key', 'range': [74, 75], 'children': []}, {'type': 'YieldValue', 'name': 'total', 'range': [76, 77], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'steps', 'range': [79, 112], 'children': [{'type': 'Parameter', 'name': 'self', 'range': [82, 83], 'children': []}, {'type': 'Docstring', 'name': '', 'range': [86, 89], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [90, 112], 'children': [{'type': 'List', 'name': '', 'range': [91, 112], 'children': [{'type': 'CallExpression', 'name': 'mr', 'range': [93, 110], 'children': [{'type': 'Argument', 'name': 'mapper=self.mapper', 'range': [97, 103], 'children': []}, {'type': 'Argument', 'name': 'reducer=self.reducer', 'range': [104, 109], 'children': []}]}]}]}]}]}]}
2025-01-08 09:58:15,685 - INFO - Completed main AST analysis flow
2025-01-08 09:58:15,685 - INFO - Successfully processed chunk
2025-01-08 09:58:15,689 - INFO - Starting code generation from AST
2025-01-08 09:58:17,746 - INFO - Successfully generated code from AST
2025-01-08 09:58:17,747 - INFO - Starting static code similarity comparison
2025-01-08 09:58:17,748 - INFO - Static similarity result: {'final_score': 37.5, 'length_similarity': 9.69, 'token_similarity': 32.56, 'structure_similarity': 11.76, 'function_similarity': 100, 'complexity_similarity': 33.33, 'variable_similarity': 100}

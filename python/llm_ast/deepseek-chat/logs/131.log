2025-01-08 10:12:20,979 - INFO - Processing sample 131
2025-01-08 10:12:20,979 - INFO - Starting Step 0: Splitting code into top-level declarations
2025-01-08 10:12:32,023 - INFO - Successfully split code into 19 top-level declarations
2025-01-08 10:12:32,026 - INFO - Processing chunk #0 (size=454 chars, start_index=0)
2025-01-08 10:12:32,026 - INFO - Processing chunk with 454 chars starting at index 0
2025-01-08 10:12:32,027 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,027 - INFO - Tokenized code into 79 tokens
2025-01-08 10:12:32,027 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,028 - INFO - Processing chunk #1 (size=52 chars, start_index=79)
2025-01-08 10:12:32,028 - INFO - Processing chunk with 52 chars starting at index 79
2025-01-08 10:12:32,028 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,029 - INFO - Tokenized code into 11 tokens
2025-01-08 10:12:32,029 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,034 - INFO - Processing chunk #2 (size=39 chars, start_index=90)
2025-01-08 10:12:32,034 - INFO - Processing chunk with 39 chars starting at index 90
2025-01-08 10:12:32,034 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,034 - INFO - Tokenized code into 11 tokens
2025-01-08 10:12:32,034 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,035 - INFO - Processing chunk #3 (size=1185 chars, start_index=101)
2025-01-08 10:12:32,036 - INFO - Processing chunk with 1185 chars starting at index 101
2025-01-08 10:12:32,036 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,037 - INFO - Tokenized code into 234 tokens
2025-01-08 10:12:32,037 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,039 - INFO - Processing chunk #4 (size=66 chars, start_index=335)
2025-01-08 10:12:32,040 - INFO - Processing chunk #5 (size=638 chars, start_index=385)
2025-01-08 10:12:32,040 - INFO - Processing chunk with 66 chars starting at index 335
2025-01-08 10:12:32,125 - INFO - Processing chunk #6 (size=327 chars, start_index=502)
2025-01-08 10:12:32,129 - INFO - Processing chunk with 327 chars starting at index 502
2025-01-08 10:12:32,129 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,128 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,126 - INFO - Processing chunk with 638 chars starting at index 385
2025-01-08 10:12:32,129 - INFO - Tokenized code into 54 tokens
2025-01-08 10:12:32,132 - INFO - Tokenized code into 50 tokens
2025-01-08 10:12:32,133 - INFO - Processing chunk #7 (size=470 chars, start_index=556)
2025-01-08 10:12:32,142 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,145 - INFO - Processing chunk #8 (size=592 chars, start_index=630)
2025-01-08 10:12:32,152 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,156 - INFO - Processing chunk #9 (size=599 chars, start_index=729)
2025-01-08 10:12:32,158 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,159 - INFO - Processing chunk with 470 chars starting at index 556
2025-01-08 10:12:32,308 - INFO - Tokenized code into 117 tokens
2025-01-08 10:12:32,314 - INFO - Processing chunk #10 (size=504 chars, start_index=836)
2025-01-08 10:12:32,324 - INFO - Processing chunk #11 (size=298 chars, start_index=919)
2025-01-08 10:12:32,329 - INFO - Processing chunk with 592 chars starting at index 630
2025-01-08 10:12:32,331 - INFO - Processing chunk with 599 chars starting at index 729
2025-01-08 10:12:32,337 - INFO - Processing chunk #12 (size=66 chars, start_index=969)
2025-01-08 10:12:32,341 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,342 - INFO - Processing chunk #13 (size=110 chars, start_index=1019)
2025-01-08 10:12:32,342 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,343 - INFO - Processing chunk #14 (size=162 chars, start_index=1043)
2025-01-08 10:12:32,348 - INFO - Processing chunk with 504 chars starting at index 836
2025-01-08 10:12:32,348 - INFO - Processing chunk with 298 chars starting at index 919
2025-01-08 10:12:32,349 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,349 - INFO - Processing chunk #15 (size=41 chars, start_index=1076)
2025-01-08 10:12:32,349 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,361 - INFO - Processing chunk #16 (size=161 chars, start_index=1084)
2025-01-08 10:12:32,363 - INFO - Processing chunk with 66 chars starting at index 969
2025-01-08 10:12:32,364 - INFO - Tokenized code into 74 tokens
2025-01-08 10:12:32,376 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,366 - INFO - Processing chunk with 110 chars starting at index 1019
2025-01-08 10:12:32,371 - INFO - Processing chunk #18 (size=259 chars, start_index=1156)
2025-01-08 10:12:32,372 - INFO - Processing chunk with 162 chars starting at index 1043
2025-01-08 10:12:32,373 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,374 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,374 - INFO - Tokenized code into 99 tokens
2025-01-08 10:12:32,375 - INFO - Processing chunk with 41 chars starting at index 1076
2025-01-08 10:12:32,376 - INFO - Tokenized code into 107 tokens
2025-01-08 10:12:32,376 - INFO - Processing chunk with 161 chars starting at index 1084
2025-01-08 10:12:32,376 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,365 - INFO - Processing chunk #17 (size=261 chars, start_index=1108)
2025-01-08 10:12:32,389 - INFO - Processing chunk with 261 chars starting at index 1108
2025-01-08 10:12:32,389 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,386 - INFO - Processing chunk with 259 chars starting at index 1156
2025-01-08 10:12:32,386 - INFO - Tokenized code into 83 tokens
2025-01-08 10:12:32,387 - INFO - Tokenized code into 50 tokens
2025-01-08 10:12:32,387 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,388 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,388 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,388 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,389 - INFO - Tokenized code into 50 tokens
2025-01-08 10:12:32,400 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,386 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,389 - INFO - Tokenized code into 48 tokens
2025-01-08 10:12:32,402 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,390 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,391 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,395 - INFO - Tokenized code into 8 tokens
2025-01-08 10:12:32,396 - INFO - Tokenized code into 24 tokens
2025-01-08 10:12:32,385 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,401 - INFO - Tokenized code into 33 tokens
2025-01-08 10:12:32,390 - INFO - Starting main AST analysis flow
2025-01-08 10:12:32,422 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,425 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,426 - INFO - Tokenized code into 24 tokens
2025-01-08 10:12:32,426 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,427 - INFO - Tokenized code into 50 tokens
2025-01-08 10:12:32,428 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:32,436 - INFO - Starting Step 1: Initial AST node identification
2025-01-08 10:12:33,599 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [79, 89], 'children': []}
2025-01-08 10:12:33,599 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:34,563 - INFO - Step 1 result: {'type': 'Program', 'name': 'get_webhook', 'range': [502, 555], 'children': []}
2025-01-08 10:12:34,563 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:34,950 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [969, 1018], 'children': []}
2025-01-08 10:12:34,950 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:34,994 - INFO - Step 1 result: {'type': 'Program', 'name': 'delete_webhook', 'range': [919, 968], 'children': []}
2025-01-08 10:12:34,994 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,005 - INFO - Step 1 result: {'type': 'Program', 'name': 'create_webhook', 'range': [385, 501], 'children': []}
2025-01-08 10:12:35,005 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,013 - INFO - Step 1 result: {'type': 'Program', 'name': '_webhook_event_bus', 'range': [1076, 1081], 'children': []}
2025-01-08 10:12:35,013 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,025 - INFO - Step 1 result: {'type': 'Program', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': []}
2025-01-08 10:12:35,025 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,039 - INFO - Step 1 result: {'type': 'Program', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': []}
2025-01-08 10:12:35,039 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,045 - INFO - Step 1 result: {'type': 'Program', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': []}
2025-01-08 10:12:35,046 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,060 - INFO - Step 1 result: {'type': 'Program', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': []}
2025-01-08 10:12:35,060 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,073 - INFO - Step 1 result: {'type': 'Program', 'name': 'update_webhook_config', 'range': [836, 918], 'children': []}
2025-01-08 10:12:35,073 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,075 - INFO - Step 1 result: {'type': 'Program', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 728], 'children': []}
2025-01-08 10:12:35,078 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:35,121 - INFO - Step 1 result: {'type': 'Program', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': []}
2025-01-08 10:12:35,121 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:36,052 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [335, 384], 'children': [{'type': 'Comment', 'name': '', 'range': [336, 357], 'children': []}, {'type': 'CRUDFunctions', 'name': '', 'range': [358, 359], 'children': []}, {'type': 'Comment', 'name': '', 'range': [360, 380], 'children': []}]}
2025-01-08 10:12:36,052 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:36,623 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [90, 100], 'children': [{'type': 'VariableDeclaration', 'name': 'logger', 'range': [90, 97], 'children': [{'type': 'AssignmentExpression', 'name': '', 'range': [91, 97], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [92, 97], 'children': [{'type': 'Identifier', 'name': 'logging', 'range': [92, 92], 'children': []}, {'type': 'Identifier', 'name': 'getLogger', 'range': [94, 94], 'children': []}, {'type': 'Literal', 'name': '__name__', 'range': [96, 96], 'children': []}]}]}]}]}
2025-01-08 10:12:36,623 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:38,367 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [969, 1018], 'children': [{'type': 'Comment', 'name': '', 'range': [970, 1015], 'children': [{'type': 'CommentLine', 'name': '', 'range': [970, 1015], 'children': []}]}, {'type': 'NewLine', 'name': '', 'range': [1016, 1018], 'children': []}]}
2025-01-08 10:12:38,367 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:38,791 - INFO - Step 1 result: {'type': 'Program', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'ClassDeclaration', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'Inheritance', 'name': 'BaseDbModel', 'range': [1021, 1023], 'children': []}, {'type': 'Property', 'name': 'provider', 'range': [1026, 1028], 'children': []}, {'type': 'Property', 'name': 'webhook_id', 'range': [1030, 1032], 'children': []}, {'type': 'Property', 'name': 'event_type', 'range': [1034, 1036], 'children': []}, {'type': 'Property', 'name': 'payload', 'range': [1038, 1040], 'children': []}]}]}
2025-01-08 10:12:38,791 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:39,034 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [0, 78], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [3, 11], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [13, 17], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [18, 24], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [25, 31], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [33, 41], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [42, 50], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [51, 59], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [60, 70], 'children': []}, {'type': 'ImportDeclaration', 'name': '', 'range': [72, 77], 'children': []}]}
2025-01-08 10:12:39,034 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:39,467 - INFO - Step 1 result: {'type': 'Program', 'name': '', 'range': [1043, 1075], 'children': [{'type': 'ClassDeclaration', 'name': 'WebhookEventBus', 'range': [1043, 1056], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus', 'range': [1045, 1050], 'children': [{'type': 'GenericType', 'name': 'WebhookEvent', 'range': [1047, 1049], 'children': []}]}, {'type': 'VariableDeclaration', 'name': 'Model', 'range': [1053, 1055], 'children': []}]}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [1058, 1073], 'children': [{'type': 'ReturnType', 'name': 'str', 'range': [1067, 1068], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [1071, 1072], 'children': []}]}]}
2025-01-08 10:12:39,467 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:39,647 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [79, 89], 'children': [{'type': 'IfStatement', 'name': '', 'range': [79, 82], 'children': [{'type': 'Identifier', 'name': 'TYPE_CHECKING', 'range': [80, 80], 'children': []}]}, {'type': 'ImportStatement', 'name': '', 'range': [83, 88], 'children': [{'type': 'FromClause', 'name': '', 'range': [83, 85], 'children': [{'type': 'Identifier', 'name': '.', 'range': [84, 84], 'children': []}, {'type': 'Identifier', 'name': 'graph', 'range': [85, 85], 'children': []}]}, {'type': 'ImportClause', 'name': '', 'range': [86, 87], 'children': [{'type': 'Identifier', 'name': 'NodeModel', 'range': [87, 87], 'children': []}]}]}]}
2025-01-08 10:12:39,647 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:39,953 - INFO - Step 2 result: {'type': 'Program', 'name': '_webhook_event_bus', 'range': [1076, 1081], 'children': [{'type': 'Assignment', 'name': '=', 'range': [1077, 1080], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1076, 1076], 'children': []}, {'type': 'FunctionCall', 'name': 'WebhookEventBus', 'range': [1078, 1080], 'children': [{'type': 'Arguments', 'name': '()', 'range': [1079, 1080], 'children': []}]}]}]}
2025-01-08 10:12:39,954 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:41,000 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [969, 1018], 'children': [{'type': 'Comment', 'name': '', 'range': [970, 1015], 'children': []}, {'type': 'NewLine', 'name': '', 'range': [1016, 1018], 'children': []}]}
2025-01-08 10:12:41,000 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:41,351 - INFO - Step 2 result: {'nodes': [{'type': 'Comment', 'name': '', 'range': [336, 357], 'children': [{'type': 'CommentLine', 'name': '', 'range': [336, 357], 'children': []}]}, {'type': 'CRUDFunctions', 'name': '', 'range': [358, 359], 'children': [{'type': 'Keyword', 'name': 'CRUD', 'range': [358, 358], 'children': []}, {'type': 'Keyword', 'name': 'functions', 'range': [359, 359], 'children': []}]}, {'type': 'Comment', 'name': '', 'range': [360, 380], 'children': [{'type': 'CommentLine', 'name': '', 'range': [360, 380], 'children': []}]}]}
2025-01-08 10:12:41,351 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:41,397 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [90, 100], 'children': [{'type': 'VariableDeclaration', 'name': 'logger', 'range': [90, 97], 'children': [{'type': 'AssignmentExpression', 'name': '', 'range': [91, 97], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [92, 97], 'children': [{'type': 'Identifier', 'name': 'logging', 'range': [92, 92], 'children': []}, {'type': 'Identifier', 'name': 'getLogger', 'range': [94, 94], 'children': []}, {'type': 'Literal', 'name': '__name__', 'range': [96, 96], 'children': []}]}]}]}]}
2025-01-08 10:12:41,397 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:42,583 - INFO - Step 1 result: {'type': 'Program', 'name': 'Webhook', 'range': [101, 334], 'children': [{'type': 'ClassDeclaration', 'name': 'Webhook', 'range': [101, 167], 'children': [{'type': 'ClassBody', 'range': [107, 167], 'children': [{'type': 'FieldDeclaration', 'name': 'user_id', 'range': [108, 110]}, {'type': 'FieldDeclaration', 'name': 'provider', 'range': [112, 114]}, {'type': 'FieldDeclaration', 'name': 'credentials_id', 'range': [116, 118]}, {'type': 'FieldDeclaration', 'name': 'webhook_type', 'range': [120, 122]}, {'type': 'FieldDeclaration', 'name': 'resource', 'range': [124, 126]}, {'type': 'FieldDeclaration', 'name': 'events', 'range': [128, 133]}, {'type': 'FieldDeclaration', 'name': 'config', 'range': [135, 144]}, {'type': 'FieldDeclaration', 'name': 'secret', 'range': [146, 148]}, {'type': 'FieldDeclaration', 'name': 'provider_webhook_id', 'range': [151, 153]}, {'type': 'FieldDeclaration', 'name': 'attached_nodes', 'range': [156, 166]}]}]}, {'type': 'MethodDeclaration', 'name': 'url', 'range': [175, 198], 'children': [{'type': 'MethodBody', 'range': [184, 198], 'children': [{'type': 'ReturnStatement', 'range': [185, 197]}]}]}, {'type': 'MethodDeclaration', 'name': 'from_db', 'range': [203, 333], 'children': [{'type': 'MethodBody', 'range': [211, 333], 'children': [{'type': 'ImportStatement', 'range': [212, 216]}, {'type': 'ReturnStatement', 'range': [219, 332]}]}]}]}
2025-01-08 10:12:42,583 - INFO - Starting Step 2: Detailed AST construction
2025-01-08 10:12:43,484 - INFO - Step 3 result: {'type': 'Program', 'name': '_webhook_event_bus', 'range': [1076, 1081], 'children': [{'type': 'Assignment', 'name': '=', 'range': [1077, 1080], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1076, 1076], 'children': []}, {'type': 'FunctionCall', 'name': 'WebhookEventBus', 'range': [1078, 1080], 'children': []}]}]}
2025-01-08 10:12:43,484 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:43,833 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [969, 1018], 'children': [{'type': 'Comment', 'name': '', 'range': [970, 1015], 'children': []}, {'type': 'NewLine', 'name': '', 'range': [1016, 1018], 'children': []}]}
2025-01-08 10:12:43,833 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:12:45,401 - INFO - Step 3 result: {'nodes': [{'type': 'Comment', 'name': '', 'range': [336, 357], 'children': []}, {'type': 'CRUDFunctions', 'name': '', 'range': [358, 359], 'children': [{'type': 'Keyword', 'name': 'CRUD', 'range': [358, 358], 'children': []}, {'type': 'Keyword', 'name': 'functions', 'range': [359, 359], 'children': []}]}, {'type': 'Comment', 'name': '', 'range': [360, 380], 'children': []}]}
2025-01-08 10:12:45,401 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:45,815 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [79, 89], 'children': [{'type': 'IfStatement', 'name': '', 'range': [79, 82], 'children': [{'type': 'Identifier', 'name': 'TYPE_CHECKING', 'range': [80, 80], 'children': []}]}, {'type': 'ImportStatement', 'name': '', 'range': [83, 88], 'children': [{'type': 'FromClause', 'name': '', 'range': [83, 85], 'children': [{'type': 'Identifier', 'name': '.', 'range': [84, 84], 'children': []}, {'type': 'Identifier', 'name': 'graph', 'range': [85, 85], 'children': []}]}, {'type': 'ImportClause', 'name': '', 'range': [86, 87], 'children': [{'type': 'Identifier', 'name': 'NodeModel', 'range': [87, 87], 'children': []}]}]}]}
2025-01-08 10:12:45,816 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:46,343 - INFO - Step 2 result: {'type': 'Program', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 728], 'children': [{'type': 'FunctionDeclaration', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 727], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [630, 634], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [631, 634], 'children': []}, {'type': 'FunctionName', 'name': 'find_webhook_by_credentials_and_props', 'range': [632, 663], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [633, 653], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [635, 637], 'children': []}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [639, 641], 'children': []}, {'type': 'Parameter', 'name': 'resource', 'range': [643, 645], 'children': []}, {'type': 'Parameter', 'name': 'events', 'range': [647, 652], 'children': []}]}, {'type': 'ReturnType', 'name': '-> Webhook | None', 'range': [655, 659], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [661, 727], 'children': [{'type': 'Docstring', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [662, 664], 'children': []}, {'type': 'Assignment', 'name': 'webhook = await IntegrationWebhook.prisma().find_first(...)', 'range': [666, 714], 'children': []}, {'type': 'ReturnStatement', 'name': 'return Webhook.from_db(webhook) if webhook else None', 'range': [716, 726], 'children': []}]}]}]}
2025-01-08 10:12:46,343 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:46,495 - INFO - Step 2 result: {'type': 'Program', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'ClassDeclaration', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'Inheritance', 'name': 'BaseDbModel', 'range': [1021, 1023], 'children': []}, {'type': 'Property', 'name': 'provider', 'range': [1026, 1028], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1028, 1028], 'children': []}]}, {'type': 'Property', 'name': 'webhook_id', 'range': [1030, 1032], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1032, 1032], 'children': []}]}, {'type': 'Property', 'name': 'event_type', 'range': [1034, 1036], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1036, 1036], 'children': []}]}, {'type': 'Property', 'name': 'payload', 'range': [1038, 1040], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [1040, 1040], 'children': []}]}]}]}
2025-01-08 10:12:46,495 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:46,569 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [969, 1018], 'children': [{'type': 'Comment', 'name': '', 'range': [970, 1015], 'children': []}, {'type': 'NewLine', 'name': '', 'range': [1016, 1018], 'children': []}]}
2025-01-08 10:12:46,569 - INFO - Completed main AST analysis flow
2025-01-08 10:12:46,569 - INFO - Successfully processed chunk
2025-01-08 10:12:46,623 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [90, 100], 'children': [{'type': 'VariableDeclaration', 'name': 'logger', 'range': [90, 97], 'children': [{'type': 'AssignmentExpression', 'name': '', 'range': [91, 97], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [92, 97], 'children': [{'type': 'Identifier', 'name': 'logging', 'range': [92, 92], 'children': []}, {'type': 'Identifier', 'name': 'getLogger', 'range': [94, 94], 'children': []}, {'type': 'Literal', 'name': '__name__', 'range': [96, 96], 'children': []}]}]}]}]}
2025-01-08 10:12:46,623 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:47,123 - INFO - Step 4 result: {'type': 'Program', 'name': '_webhook_event_bus', 'range': [1076, 1081], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1077, 1080], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1076, 1076], 'children': []}, {'type': 'CallExpression', 'name': 'WebhookEventBus', 'range': [1078, 1080], 'children': []}]}]}
2025-01-08 10:12:47,123 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:12:47,297 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [1043, 1075], 'children': [{'type': 'ClassDeclaration', 'name': 'WebhookEventBus', 'range': [1043, 1056], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus', 'range': [1045, 1050], 'children': [{'type': 'GenericType', 'name': 'WebhookEvent', 'range': [1047, 1049], 'children': []}]}, {'type': 'VariableDeclaration', 'name': 'Model', 'range': [1053, 1055], 'children': [{'type': 'Assignment', 'name': '=', 'range': [1054, 1054], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1055, 1055], 'children': []}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [1058, 1073], 'children': [{'type': 'ReturnType', 'name': 'str', 'range': [1067, 1068], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [1071, 1072], 'children': [{'type': 'Literal', 'name': '"webhooks"', 'range': [1072, 1072], 'children': []}]}]}]}
2025-01-08 10:12:47,297 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:49,226 - INFO - Step 2 result: {'type': 'Program', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'FunctionDeclaration', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1108, 1112], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1109, 1112], 'children': []}, {'type': 'FunctionName', 'name': 'listen_for_webhook_events', 'range': [1110, 1135], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [1111, 1126], 'children': [{'type': 'Parameter', 'name': 'webhook_id', 'range': [1113, 1115], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1115, 1118], 'children': []}, {'type': 'Parameter', 'name': 'event_type', 'range': [1117, 1124], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1118, 1124], 'children': []}]}, {'type': 'ReturnType', 'name': 'AsyncGenerator[WebhookEvent, None]', 'range': [1127, 1135], 'children': []}, {'type': 'FunctionBody', 'name': '', 'range': [1136, 1155], 'children': [{'type': 'AsyncForStatement', 'name': '', 'range': [1137, 1154], 'children': [{'type': 'ForKeyword', 'name': 'for', 'range': [1138, 1141], 'children': []}, {'type': 'VariableDeclaration', 'name': 'event', 'range': [1139, 1141], 'children': []}, {'type': 'InKeyword', 'name': 'in', 'range': [1140, 1141], 'children': []}, {'type': 'Expression', 'name': '_webhook_event_bus.listen_events(f"{webhook_id}/{event_type or \'*\'}")', 'range': [1141, 1149], 'children': []}, {'type': 'Block', 'name': '', 'range': [1150, 1154], 'children': [{'type': 'YieldStatement', 'name': 'yield event', 'range': [1152, 1153], 'children': []}]}]}]}]}]}
2025-01-08 10:12:49,226 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:49,413 - INFO - Step 4 result: {'nodes': [{'type': 'Comment', 'name': '', 'range': [336, 357], 'children': []}, {'type': 'FunctionDecl', 'name': 'CRUDFunctions', 'range': [358, 359], 'children': [{'type': 'Keyword', 'name': 'CRUD', 'range': [358, 358], 'children': []}, {'type': 'Keyword', 'name': 'functions', 'range': [359, 359], 'children': []}]}, {'type': 'Comment', 'name': '', 'range': [360, 380], 'children': []}]}
2025-01-08 10:12:49,413 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:12:50,741 - INFO - Step 5 result: {'type': 'Program', 'name': '_webhook_event_bus', 'range': [1076, 1081], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1077, 1080], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1076, 1076], 'children': []}, {'type': 'CallExpression', 'name': 'WebhookEventBus', 'range': [1078, 1080], 'children': []}]}]}
2025-01-08 10:12:50,741 - INFO - Completed main AST analysis flow
2025-01-08 10:12:50,742 - INFO - Successfully processed chunk
2025-01-08 10:12:51,733 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [79, 89], 'children': [{'type': 'IfStatement', 'name': '', 'range': [79, 82], 'children': [{'type': 'Identifier', 'name': 'TYPE_CHECKING', 'range': [80, 80], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [83, 88], 'children': [{'type': 'FromClause', 'name': '', 'range': [83, 85], 'children': [{'type': 'Identifier', 'name': '.', 'range': [84, 84], 'children': []}, {'type': 'Identifier', 'name': 'graph', 'range': [85, 85], 'children': []}]}, {'type': 'ImportClause', 'name': '', 'range': [86, 87], 'children': [{'type': 'Identifier', 'name': 'NodeModel', 'range': [87, 87], 'children': []}]}]}]}
2025-01-08 10:12:51,733 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:12:52,158 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [90, 100], 'children': [{'type': 'VariableDeclaration', 'name': 'logger', 'range': [90, 97], 'children': [{'type': 'AssignmentExpression', 'name': '', 'range': [91, 97], 'children': [{'type': 'CallExpression', 'name': '', 'range': [92, 97], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [92, 97], 'children': [{'type': 'Identifier', 'name': 'logging', 'range': [92, 92], 'children': []}, {'type': 'Identifier', 'name': 'getLogger', 'range': [94, 94], 'children': []}]}, {'type': 'Literal', 'name': '__name__', 'range': [96, 96], 'children': []}]}]}]}]}
2025-01-08 10:12:52,158 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:12:52,638 - INFO - Step 2 result: {'type': 'Program', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [556, 556], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [557, 557], 'children': []}, {'type': 'FunctionName', 'name': 'get_all_webhooks_by_creds', 'range': [558, 558], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [559, 563], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [560, 560], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [562, 562], 'children': []}]}, {'type': 'ReturnType', 'name': 'list[Webhook]', 'range': [564, 569], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [570, 629], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [572, 574], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [576, 586], 'children': [{'type': 'Condition', 'name': 'not credentials_id', 'range': [577, 578], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [581, 585], 'children': [{'type': 'ExceptionType', 'name': 'ValueError', 'range': [582, 582], 'children': []}, {'type': 'ExceptionMessage', 'name': '"credentials_id must not be empty"', 'range': [584, 584], 'children': []}]}]}, {'type': 'Assignment', 'name': 'webhooks', 'range': [587, 614], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [589, 589], 'children': []}, {'type': 'MethodCall', 'name': 'IntegrationWebhook.prisma().find_many', 'range': [590, 613], 'children': [{'type': 'Arguments', 'name': 'arguments', 'range': [593, 613], 'children': [{'type': 'KeywordArgument', 'name': 'where', 'range': [599, 605], 'children': []}, {'type': 'KeywordArgument', 'name': 'include', 'range': [608, 610], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [615, 628], 'children': [{'type': 'ListComprehension', 'name': 'list comprehension', 'range': [616, 627], 'children': [{'type': 'Expression', 'name': 'Webhook.from_db(webhook)', 'range': [617, 622], 'children': []}, {'type': 'ForClause', 'name': 'for webhook in webhooks', 'range': [623, 626], 'children': []}]}]}]}]}]}
2025-01-08 10:12:52,638 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:52,859 - INFO - Step 2 result: {'type': 'Program', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'FunctionDeclaration', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1084, 1084], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1085, 1085], 'children': []}, {'type': 'Identifier', 'name': 'publish_webhook_event', 'range': [1086, 1086], 'children': []}, {'type': 'Punctuator', 'name': '(', 'range': [1087, 1087], 'children': []}, {'type': 'Identifier', 'name': 'event', 'range': [1088, 1088], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [1089, 1089], 'children': []}, {'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1090, 1090], 'children': []}, {'type': 'Punctuator', 'name': ')', 'range': [1091, 1091], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [1092, 1092], 'children': []}, {'type': 'LineBreak', 'name': '\n', 'range': [1093, 1093], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1094, 1094], 'children': []}, {'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1095, 1095], 'children': []}, {'type': 'Punctuator', 'name': '.', 'range': [1096, 1096], 'children': []}, {'type': 'Identifier', 'name': 'publish_event', 'range': [1097, 1097], 'children': []}, {'type': 'Punctuator', 'name': '(', 'range': [1098, 1098], 'children': []}, {'type': 'LineBreak', 'name': '\n', 'range': [1099, 1099], 'children': []}, {'type': 'Identifier', 'name': 'event', 'range': [1100, 1100], 'children': []}, {'type': 'Punctuator', 'name': ',', 'range': [1101, 1101], 'children': []}, {'type': 'Identifier', 'name': 'f', 'range': [1102, 1102], 'children': []}, {'type': 'StringLiteral', 'name': '"{event.webhook_id}/{event.event_type}"', 'range': [1103, 1103], 'children': []}, {'type': 'LineBreak', 'name': '\n', 'range': [1104, 1104], 'children': []}, {'type': 'Punctuator', 'name': ')', 'range': [1105, 1105], 'children': []}, {'type': 'LineBreak', 'name': '\n', 'range': [1106, 1106], 'children': []}, {'type': 'LineBreak', 'name': '\n', 'range': [1107, 1107], 'children': []}]}]}
2025-01-08 10:12:52,860 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:54,116 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'MainProgram', 'range': [336, 380], 'children': [{'type': 'Comment', 'name': '', 'range': [336, 357], 'children': []}, {'type': 'FunctionDecl', 'name': 'CRUDFunctions', 'range': [358, 359], 'children': [{'type': 'Keyword', 'name': 'CRUD', 'range': [358, 358], 'children': []}, {'type': 'Keyword', 'name': 'functions', 'range': [359, 359], 'children': []}]}, {'type': 'Comment', 'name': '', 'range': [360, 380], 'children': []}]}]}
2025-01-08 10:12:54,116 - INFO - Completed main AST analysis flow
2025-01-08 10:12:54,116 - INFO - Successfully processed chunk
2025-01-08 10:12:54,402 - INFO - Step 3 result: {'type': 'Program', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'ClassDeclaration', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'Inheritance', 'name': 'BaseDbModel', 'range': [1021, 1023], 'children': []}, {'type': 'Property', 'name': 'provider', 'range': [1026, 1028], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1028, 1028], 'children': []}]}, {'type': 'Property', 'name': 'webhook_id', 'range': [1030, 1032], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1032, 1032], 'children': []}]}, {'type': 'Property', 'name': 'event_type', 'range': [1034, 1036], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1036, 1036], 'children': []}]}, {'type': 'Property', 'name': 'payload', 'range': [1038, 1040], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [1040, 1040], 'children': []}]}]}]}
2025-01-08 10:12:54,403 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:54,632 - INFO - Step 2 result: {'type': 'Program', 'name': '', 'range': [0, 78], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'logging', 'range': [1, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [3, 11], 'children': [{'type': 'ImportSpecifier', 'name': 'TYPE_CHECKING', 'range': [6, 6], 'children': []}, {'type': 'ImportSpecifier', 'name': 'AsyncGenerator', 'range': [8, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'Optional', 'range': [10, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [13, 17], 'children': [{'type': 'ImportSpecifier', 'name': 'Json', 'range': [16, 16], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [18, 24], 'children': [{'type': 'ImportSpecifier', 'name': 'IntegrationWebhook', 'range': [23, 23], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [25, 31], 'children': [{'type': 'ImportSpecifier', 'name': 'Field', 'range': [28, 28], 'children': []}, {'type': 'ImportSpecifier', 'name': 'computed_field', 'range': [30, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [33, 41], 'children': [{'type': 'ImportSpecifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [40, 40], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [42, 50], 'children': [{'type': 'ImportSpecifier', 'name': 'AsyncRedisEventBus', 'range': [49, 49], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [51, 59], 'children': [{'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [58, 58], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [60, 70], 'children': [{'type': 'ImportSpecifier', 'name': 'webhook_ingress_url', 'range': [69, 69], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [72, 77], 'children': [{'type': 'ImportSpecifier', 'name': 'BaseDbModel', 'range': [76, 76], 'children': []}]}]}
2025-01-08 10:12:54,633 - INFO - Starting Step 3: AST simplification
2025-01-08 10:12:55,090 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [1043, 1075], 'children': [{'type': 'ClassDeclaration', 'name': 'WebhookEventBus', 'range': [1043, 1056], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus', 'range': [1045, 1050], 'children': [{'type': 'GenericType', 'name': 'WebhookEvent', 'range': [1047, 1049], 'children': []}]}, {'type': 'VariableDeclaration', 'name': 'Model', 'range': [1053, 1055], 'children': [{'type': 'Assignment', 'name': '=', 'range': [1054, 1054], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1055, 1055], 'children': []}]}]}]}, {'type': 'FunctionDeclaration', 'name': 'event_bus_name', 'range': [1058, 1073], 'children': [{'type': 'ReturnType', 'name': 'str', 'range': [1067, 1068], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [1071, 1072], 'children': [{'type': 'Literal', 'name': '"webhooks"', 'range': [1072, 1072], 'children': []}]}]}]}
2025-01-08 10:12:55,090 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:56,563 - INFO - Step 3 result: {'type': 'Program', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 728], 'children': [{'type': 'FunctionDeclaration', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 727], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [630, 634], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [631, 634], 'children': []}, {'type': 'FunctionName', 'name': 'find_webhook_by_credentials_and_props', 'range': [632, 663], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [633, 653], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [635, 637], 'children': []}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [639, 641], 'children': []}, {'type': 'Parameter', 'name': 'resource', 'range': [643, 645], 'children': []}, {'type': 'Parameter', 'name': 'events', 'range': [647, 652], 'children': []}]}, {'type': 'ReturnType', 'name': '-> Webhook | None', 'range': [655, 659], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [661, 727], 'children': [{'type': 'Docstring', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [662, 664], 'children': []}, {'type': 'Assignment', 'name': 'webhook = await IntegrationWebhook.prisma().find_first(...)', 'range': [666, 714], 'children': []}, {'type': 'ReturnStatement', 'name': 'return Webhook.from_db(webhook) if webhook else None', 'range': [716, 726], 'children': []}]}]}]}
2025-01-08 10:12:56,563 - INFO - Starting Step 4: AST normalization
2025-01-08 10:12:57,481 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [90, 100], 'children': [{'type': 'VariableDeclaration', 'name': 'logger', 'range': [90, 97], 'children': [{'type': 'AssignmentExpression', 'name': '', 'range': [91, 97], 'children': [{'type': 'CallExpression', 'name': '', 'range': [92, 97], 'children': [{'type': 'MemberExpression', 'name': '', 'range': [92, 97], 'children': [{'type': 'Identifier', 'name': 'logging', 'range': [92, 92], 'children': []}, {'type': 'Identifier', 'name': 'getLogger', 'range': [94, 94], 'children': []}]}, {'type': 'Literal', 'name': '__name__', 'range': [96, 96], 'children': []}]}]}]}]}
2025-01-08 10:12:57,481 - INFO - Completed main AST analysis flow
2025-01-08 10:12:57,481 - INFO - Successfully processed chunk
2025-01-08 10:12:57,560 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [79, 89], 'children': [{'type': 'IfStatement', 'name': '', 'range': [79, 82], 'children': [{'type': 'Identifier', 'name': 'TYPE_CHECKING', 'range': [80, 80], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [83, 88], 'children': [{'type': 'FromClause', 'name': '', 'range': [83, 85], 'children': [{'type': 'Identifier', 'name': '.', 'range': [84, 84], 'children': []}, {'type': 'Identifier', 'name': 'graph', 'range': [85, 85], 'children': []}]}, {'type': 'ImportClause', 'name': '', 'range': [86, 87], 'children': [{'type': 'Identifier', 'name': 'NodeModel', 'range': [87, 87], 'children': []}]}]}]}
2025-01-08 10:12:57,560 - INFO - Completed main AST analysis flow
2025-01-08 10:12:57,561 - INFO - Successfully processed chunk
2025-01-08 10:12:58,670 - INFO - Step 2 result: {'type': 'Program', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [502, 502], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [503, 503], 'children': []}, {'type': 'Identifier', 'name': 'get_webhook', 'range': [504, 504], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [505, 505], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [506, 506], 'children': [{'type': 'Punctuation', 'name': ':', 'range': [507, 507], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [508, 508], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [509, 509], 'children': []}, {'type': 'Punctuation', 'name': '-', 'range': [510, 510], 'children': []}, {'type': 'Punctuation', 'name': '>', 'range': [511, 511], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [512, 512], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [513, 513], 'children': []}, {'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [515, 517], 'children': []}, {'type': 'VariableDeclaration', 'name': 'webhook', 'range': [519, 553], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [521, 521], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [522, 522], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [523, 523], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [524, 524], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [525, 525], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [526, 526], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [527, 527], 'children': []}, {'type': 'Identifier', 'name': 'find_unique_or_raise', 'range': [528, 528], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [529, 529], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [531, 537], 'children': [{'type': 'StringLiteral', 'name': '"id"', 'range': [534, 534], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [535, 535], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [536, 536], 'children': []}]}, {'type': 'Identifier', 'name': 'include', 'range': [540, 540], 'children': []}, {'type': 'Punctuation', 'name': '=', 'range': [541, 541], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [542, 542], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [545, 545], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [547, 553], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [548, 548], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [549, 549], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [550, 550], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [551, 551], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [552, 552], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [553, 553], 'children': []}]}]}]}
2025-01-08 10:12:58,671 - INFO - Starting Step 3: AST simplification
2025-01-08 10:13:01,581 - INFO - Step 3 result: {'type': 'Program', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'FunctionDeclaration', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1084, 1084], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1085, 1085], 'children': []}, {'type': 'Identifier', 'name': 'publish_webhook_event', 'range': [1086, 1086], 'children': []}, {'type': 'Identifier', 'name': 'event', 'range': [1088, 1088], 'children': []}, {'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1090, 1090], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1094, 1094], 'children': []}, {'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1095, 1095], 'children': []}, {'type': 'Identifier', 'name': 'publish_event', 'range': [1097, 1097], 'children': []}, {'type': 'Identifier', 'name': 'event', 'range': [1100, 1100], 'children': []}, {'type': 'Identifier', 'name': 'f', 'range': [1102, 1102], 'children': []}, {'type': 'StringLiteral', 'name': '"{event.webhook_id}/{event.event_type}"', 'range': [1103, 1103], 'children': []}]}]}
2025-01-08 10:13:01,581 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:01,816 - INFO - Step 2 result: {'type': 'Program', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'FunctionDeclaration', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [919, 919], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [920, 920], 'children': []}, {'type': 'Identifier', 'name': 'delete_webhook', 'range': [921, 921], 'children': []}, {'type': 'Punctuator', 'name': '(', 'range': [922, 922], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [923, 923], 'children': [{'type': 'Punctuator', 'name': ':', 'range': [924, 924], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [925, 925], 'children': []}]}, {'type': 'Punctuator', 'name': ')', 'range': [926, 926], 'children': []}, {'type': 'ReturnType', 'name': '->', 'range': [927, 928], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [929, 929], 'children': []}]}, {'type': 'Punctuator', 'name': ':', 'range': [930, 930], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [931, 968], 'children': [{'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [932, 934], 'children': []}, {'type': 'VariableDeclaration', 'name': 'deleted', 'range': [936, 954], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [938, 938], 'children': []}, {'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma.delete', 'range': [939, 945], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [939, 939], 'children': []}, {'type': 'Punctuator', 'name': '.', 'range': [940, 940], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [941, 941], 'children': []}, {'type': 'Punctuator', 'name': '.', 'range': [944, 944], 'children': []}, {'type': 'Identifier', 'name': 'delete', 'range': [945, 945], 'children': []}]}, {'type': 'Punctuator', 'name': '(', 'range': [946, 946], 'children': []}, {'type': 'ObjectExpression', 'name': 'where', 'range': [947, 953], 'children': [{'type': 'Property', 'name': 'id', 'range': [950, 952], 'children': [{'type': 'StringLiteral', 'name': '"id"', 'range': [950, 950], 'children': []}, {'type': 'Punctuator', 'name': ':', 'range': [951, 951], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [952, 952], 'children': []}]}]}, {'type': 'Punctuator', 'name': ')', 'range': [954, 954], 'children': []}]}, {'type': 'IfStatement', 'name': '', 'range': [956, 967], 'children': [{'type': 'Keyword', 'name': 'if', 'range': [956, 956], 'children': []}, {'type': 'UnaryExpression', 'name': 'not', 'range': [957, 957], 'children': [{'type': 'Identifier', 'name': 'deleted', 'range': [958, 958], 'children': []}]}, {'type': 'Punctuator', 'name': ':', 'range': [959, 959], 'children': []}, {'type': 'BlockStatement', 'name': '', 'range': [960, 967], 'children': [{'type': 'ThrowStatement', 'name': '', 'range': [961, 966], 'children': [{'type': 'Keyword', 'name': 'raise', 'range': [961, 961], 'children': []}, {'type': 'NewExpression', 'name': 'ValueError', 'range': [962, 966], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [962, 962], 'children': []}, {'type': 'Punctuator', 'name': '(', 'range': [963, 963], 'children': []}, {'type': 'TemplateLiteral', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [964, 965], 'children': []}, {'type': 'Punctuator', 'name': ')', 'range': [966, 966], 'children': []}]}]}]}]}]}]}]}
2025-01-08 10:13:01,816 - INFO - Starting Step 3: AST simplification
2025-01-08 10:13:01,980 - INFO - Step 4 result: {'type': 'Program', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'ClassDecl', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'Inheritance', 'name': 'BaseDbModel', 'range': [1021, 1023], 'children': []}, {'type': 'Property', 'name': 'provider', 'range': [1026, 1028], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1028, 1028], 'children': []}]}, {'type': 'Property', 'name': 'webhook_id', 'range': [1030, 1032], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1032, 1032], 'children': []}]}, {'type': 'Property', 'name': 'event_type', 'range': [1034, 1036], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1036, 1036], 'children': []}]}, {'type': 'Property', 'name': 'payload', 'range': [1038, 1040], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [1040, 1040], 'children': []}]}]}]}
2025-01-08 10:13:01,981 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:02,330 - INFO - Step 3 result: {'type': 'Program', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'FunctionDeclaration', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1108, 1112], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1109, 1112], 'children': []}, {'type': 'FunctionName', 'name': 'listen_for_webhook_events', 'range': [1110, 1135], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [1111, 1126], 'children': [{'type': 'Parameter', 'name': 'webhook_id', 'range': [1113, 1115], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1115, 1118], 'children': []}, {'type': 'Parameter', 'name': 'event_type', 'range': [1117, 1124], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1118, 1124], 'children': []}]}, {'type': 'ReturnType', 'name': 'AsyncGenerator[WebhookEvent, None]', 'range': [1127, 1135], 'children': []}, {'type': 'FunctionBody', 'name': '', 'range': [1136, 1155], 'children': [{'type': 'AsyncForStatement', 'name': '', 'range': [1137, 1154], 'children': [{'type': 'ForKeyword', 'name': 'for', 'range': [1138, 1141], 'children': []}, {'type': 'VariableDeclaration', 'name': 'event', 'range': [1139, 1141], 'children': []}, {'type': 'InKeyword', 'name': 'in', 'range': [1140, 1141], 'children': []}, {'type': 'Expression', 'name': '_webhook_event_bus.listen_events', 'range': [1141, 1149], 'children': []}, {'type': 'Block', 'name': '', 'range': [1150, 1154], 'children': [{'type': 'YieldStatement', 'name': 'yield event', 'range': [1152, 1153], 'children': []}]}]}]}]}]}
2025-01-08 10:13:02,331 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:02,790 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [1043, 1075], 'children': [{'type': 'ClassDecl', 'name': 'WebhookEventBus', 'range': [1043, 1056], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus', 'range': [1045, 1050], 'children': [{'type': 'GenericType', 'name': 'WebhookEvent', 'range': [1047, 1049], 'children': []}]}, {'type': 'VariableDecl', 'name': 'Model', 'range': [1053, 1055], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1054, 1054], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1055, 1055], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'event_bus_name', 'range': [1058, 1073], 'children': [{'type': 'ReturnType', 'name': 'str', 'range': [1067, 1068], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [1071, 1072], 'children': [{'type': 'Literal', 'name': '"webhooks"', 'range': [1072, 1072], 'children': []}]}]}]}
2025-01-08 10:13:02,791 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:06,443 - INFO - Step 2 result: {'type': 'Program', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'FunctionDeclaration', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1156, 1156], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1157, 1157], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_webhook_event', 'range': [1158, 1158], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [1159, 1159], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [1161, 1163], 'children': [{'type': 'Identifier', 'name': 'webhook_id', 'range': [1161, 1161], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1162, 1162], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1163, 1163], 'children': []}]}, {'type': 'Parameter', 'name': 'event_type', 'range': [1165, 1172], 'children': [{'type': 'Identifier', 'name': 'event_type', 'range': [1165, 1165], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1166, 1166], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1167, 1170], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1167, 1167], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [1168, 1168], 'children': []}, {'type': 'Identifier', 'name': 'str', 'range': [1169, 1169], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [1170, 1170], 'children': []}]}, {'type': 'Punctuation', 'name': '=', 'range': [1171, 1171], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [1172, 1172], 'children': []}]}, {'type': 'Parameter', 'name': 'timeout', 'range': [1174, 1181], 'children': [{'type': 'Identifier', 'name': 'timeout', 'range': [1174, 1174], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [1175, 1175], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[float]', 'range': [1176, 1179], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1176, 1176], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [1177, 1177], 'children': []}, {'type': 'Identifier', 'name': 'float', 'range': [1178, 1178], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [1179, 1179], 'children': []}]}, {'type': 'Punctuation', 'name': '=', 'range': [1180, 1180], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [1181, 1181], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [1183, 1183], 'children': []}, {'type': 'ReturnType', 'name': '->', 'range': [1184, 1185], 'children': []}, {'type': 'TypeAnnotation', 'name': 'WebhookEvent | None', 'range': [1186, 1188], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1186, 1186], 'children': []}, {'type': 'Punctuation', 'name': '|', 'range': [1187, 1187], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [1188, 1188], 'children': []}]}, {'type': 'Punctuation', 'name': ':', 'range': [1189, 1189], 'children': []}, {'type': 'Block', 'name': '', 'range': [1190, 1205], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [1191, 1191], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1192, 1192], 'children': []}, {'type': 'Expression', 'name': '_webhook_event_bus.wait_for_event', 'range': [1193, 1203], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1193, 1193], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [1194, 1194], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_event', 'range': [1195, 1195], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [1196, 1196], 'children': []}, {'type': 'StringLiteral', 'name': 'f"{webhook_id}/{event_type or \'*\'}"', 'range': [1198, 1199], 'children': []}, {'type': 'Punctuation', 'name': ',', 'range': [1200, 1200], 'children': []}, {'type': 'Identifier', 'name': 'timeout', 'range': [1201, 1201], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [1203, 1203], 'children': []}]}]}]}]}
2025-01-08 10:13:06,443 - INFO - Starting Step 3: AST simplification
2025-01-08 10:13:07,524 - INFO - Step 4 result: {'type': 'Program', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 728], 'children': [{'type': 'FunctionDecl', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 727], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [630, 634], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [631, 634], 'children': []}, {'type': 'FunctionName', 'name': 'find_webhook_by_credentials_and_props', 'range': [632, 663], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [633, 653], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [635, 637], 'children': []}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [639, 641], 'children': []}, {'type': 'Parameter', 'name': 'resource', 'range': [643, 645], 'children': []}, {'type': 'Parameter', 'name': 'events', 'range': [647, 652], 'children': []}]}, {'type': 'ReturnType', 'name': '-> Webhook | None', 'range': [655, 659], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [661, 727], 'children': [{'type': 'Docstring', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [662, 664], 'children': []}, {'type': 'Assignment', 'name': 'webhook = await IntegrationWebhook.prisma().find_first(...)', 'range': [666, 714], 'children': []}, {'type': 'ReturnStatement', 'name': 'return Webhook.from_db(webhook) if webhook else None', 'range': [716, 726], 'children': []}]}]}]}
2025-01-08 10:13:07,524 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:09,623 - INFO - Step 5 result: {'type': 'Program', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'ClassDecl', 'name': 'WebhookEvent', 'range': [1019, 1042], 'children': [{'type': 'Inheritance', 'name': 'BaseDbModel', 'range': [1021, 1023], 'children': []}, {'type': 'Property', 'name': 'provider', 'range': [1026, 1028], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1028, 1028], 'children': []}]}, {'type': 'Property', 'name': 'webhook_id', 'range': [1030, 1032], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1032, 1032], 'children': []}]}, {'type': 'Property', 'name': 'event_type', 'range': [1034, 1036], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [1036, 1036], 'children': []}]}, {'type': 'Property', 'name': 'payload', 'range': [1038, 1040], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [1040, 1040], 'children': []}]}]}]}
2025-01-08 10:13:09,624 - INFO - Completed main AST analysis flow
2025-01-08 10:13:09,624 - INFO - Successfully processed chunk
2025-01-08 10:13:09,801 - INFO - Step 3 result: {'type': 'Program', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [556, 556], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [557, 557], 'children': []}, {'type': 'FunctionName', 'name': 'get_all_webhooks_by_creds', 'range': [558, 558], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [559, 563], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [560, 560], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [562, 562], 'children': []}]}, {'type': 'ReturnType', 'name': 'list[Webhook]', 'range': [564, 569], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [570, 629], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [572, 574], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [576, 586], 'children': [{'type': 'Condition', 'name': 'not credentials_id', 'range': [577, 578], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [581, 585], 'children': [{'type': 'ExceptionType', 'name': 'ValueError', 'range': [582, 582], 'children': []}, {'type': 'ExceptionMessage', 'name': '"credentials_id must not be empty"', 'range': [584, 584], 'children': []}]}]}, {'type': 'Assignment', 'name': 'webhooks', 'range': [587, 614], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [589, 589], 'children': []}, {'type': 'MethodCall', 'name': 'IntegrationWebhook.prisma().find_many', 'range': [590, 613], 'children': [{'type': 'Arguments', 'name': 'arguments', 'range': [593, 613], 'children': [{'type': 'KeywordArgument', 'name': 'where', 'range': [599, 605], 'children': []}, {'type': 'KeywordArgument', 'name': 'include', 'range': [608, 610], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [615, 628], 'children': [{'type': 'ListComprehension', 'name': 'list comprehension', 'range': [616, 627], 'children': [{'type': 'Expression', 'name': 'Webhook.from_db(webhook)', 'range': [617, 622], 'children': []}, {'type': 'ForClause', 'name': 'for webhook in webhooks', 'range': [623, 626], 'children': []}]}]}]}]}]}
2025-01-08 10:13:09,801 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:10,075 - INFO - Step 3 result: {'type': 'Program', 'name': '', 'range': [0, 78], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'logging', 'range': [1, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [3, 11], 'children': [{'type': 'ImportSpecifier', 'name': 'TYPE_CHECKING', 'range': [6, 6], 'children': []}, {'type': 'ImportSpecifier', 'name': 'AsyncGenerator', 'range': [8, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'Optional', 'range': [10, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [13, 17], 'children': [{'type': 'ImportSpecifier', 'name': 'Json', 'range': [16, 16], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [18, 24], 'children': [{'type': 'ImportSpecifier', 'name': 'IntegrationWebhook', 'range': [23, 23], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [25, 31], 'children': [{'type': 'ImportSpecifier', 'name': 'Field', 'range': [28, 28], 'children': []}, {'type': 'ImportSpecifier', 'name': 'computed_field', 'range': [30, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [33, 41], 'children': [{'type': 'ImportSpecifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [40, 40], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [42, 50], 'children': [{'type': 'ImportSpecifier', 'name': 'AsyncRedisEventBus', 'range': [49, 49], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [51, 59], 'children': [{'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [58, 58], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [60, 70], 'children': [{'type': 'ImportSpecifier', 'name': 'webhook_ingress_url', 'range': [69, 69], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [72, 77], 'children': [{'type': 'ImportSpecifier', 'name': 'BaseDbModel', 'range': [76, 76], 'children': []}]}]}
2025-01-08 10:13:10,076 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:10,201 - INFO - Step 4 result: {'type': 'Program', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'FunctionDecl', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1084, 1084], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1085, 1085], 'children': []}, {'type': 'Identifier', 'name': 'publish_webhook_event', 'range': [1086, 1086], 'children': []}, {'type': 'Identifier', 'name': 'event', 'range': [1088, 1088], 'children': []}, {'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1090, 1090], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1094, 1094], 'children': []}, {'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1095, 1095], 'children': []}, {'type': 'CallExpression', 'name': 'publish_event', 'range': [1097, 1097], 'children': [{'type': 'Identifier', 'name': 'event', 'range': [1100, 1100], 'children': []}, {'type': 'Literal', 'name': '"{event.webhook_id}/{event.event_type}"', 'range': [1103, 1103], 'children': []}]}]}]}
2025-01-08 10:13:10,201 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:10,773 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [1043, 1075], 'children': [{'type': 'ClassDecl', 'name': 'WebhookEventBus', 'range': [1043, 1056], 'children': [{'type': 'Inheritance', 'name': 'AsyncRedisEventBus', 'range': [1045, 1050], 'children': [{'type': 'GenericType', 'name': 'WebhookEvent', 'range': [1047, 1049], 'children': []}]}, {'type': 'VariableDecl', 'name': 'Model', 'range': [1053, 1055], 'children': [{'type': 'AssignmentExpression', 'name': '=', 'range': [1054, 1054], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1055, 1055], 'children': []}]}]}]}, {'type': 'FunctionDecl', 'name': 'event_bus_name', 'range': [1058, 1073], 'children': [{'type': 'ReturnType', 'name': 'str', 'range': [1067, 1068], 'children': []}, {'type': 'ReturnStatement', 'name': '', 'range': [1071, 1072], 'children': [{'type': 'Literal', 'name': '"webhooks"', 'range': [1072, 1072], 'children': []}]}]}]}
2025-01-08 10:13:10,773 - INFO - Completed main AST analysis flow
2025-01-08 10:13:10,773 - INFO - Successfully processed chunk
2025-01-08 10:13:14,062 - INFO - Step 3 result: {'type': 'Program', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'FunctionDeclaration', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [502, 502], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [503, 503], 'children': []}, {'type': 'Identifier', 'name': 'get_webhook', 'range': [504, 504], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [506, 506], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [508, 508], 'children': []}]}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [512, 512], 'children': []}, {'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [515, 517], 'children': []}, {'type': 'VariableDeclaration', 'name': 'webhook', 'range': [519, 553], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [521, 521], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [522, 522], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [524, 524], 'children': []}, {'type': 'Identifier', 'name': 'find_unique_or_raise', 'range': [528, 528], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [531, 537], 'children': [{'type': 'StringLiteral', 'name': '"id"', 'range': [534, 534], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [536, 536], 'children': []}]}, {'type': 'Identifier', 'name': 'include', 'range': [540, 540], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [542, 542], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [547, 553], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [548, 548], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [550, 550], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [552, 552], 'children': []}]}]}]}
2025-01-08 10:13:14,063 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:15,041 - INFO - Step 4 result: {'type': 'Program', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'FunctionDecl', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1108, 1112], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1109, 1112], 'children': []}, {'type': 'FunctionName', 'name': 'listen_for_webhook_events', 'range': [1110, 1135], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [1111, 1126], 'children': [{'type': 'Parameter', 'name': 'webhook_id', 'range': [1113, 1115], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1115, 1118], 'children': []}, {'type': 'Parameter', 'name': 'event_type', 'range': [1117, 1124], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1118, 1124], 'children': []}]}, {'type': 'ReturnType', 'name': 'AsyncGenerator[WebhookEvent, None]', 'range': [1127, 1135], 'children': []}, {'type': 'FunctionBody', 'name': '', 'range': [1136, 1155], 'children': [{'type': 'AsyncForStatement', 'name': '', 'range': [1137, 1154], 'children': [{'type': 'ForKeyword', 'name': 'for', 'range': [1138, 1141], 'children': []}, {'type': 'VariableDecl', 'name': 'event', 'range': [1139, 1141], 'children': []}, {'type': 'InKeyword', 'name': 'in', 'range': [1140, 1141], 'children': []}, {'type': 'CallExpression', 'name': '_webhook_event_bus.listen_events', 'range': [1141, 1149], 'children': []}, {'type': 'Block', 'name': '', 'range': [1150, 1154], 'children': [{'type': 'YieldStatement', 'name': 'yield event', 'range': [1152, 1153], 'children': []}]}]}]}]}]}
2025-01-08 10:13:15,041 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:17,984 - INFO - Step 2 result: {'type': 'Program', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [836, 836], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [837, 837], 'children': []}, {'type': 'Identifier', 'name': 'update_webhook_config', 'range': [838, 838], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [839, 839], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [840, 840], 'children': [{'type': 'Punctuation', 'name': ':', 'range': [841, 841], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [842, 842], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [843, 843], 'children': []}, {'type': 'Parameter', 'name': 'updated_config', 'range': [844, 844], 'children': [{'type': 'Punctuation', 'name': ':', 'range': [845, 845], 'children': []}, {'type': 'TypeAnnotation', 'name': 'dict', 'range': [846, 846], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [847, 847], 'children': []}, {'type': 'Punctuation', 'name': '-', 'range': [848, 848], 'children': []}, {'type': 'Punctuation', 'name': '>', 'range': [849, 849], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [850, 850], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [851, 851], 'children': []}, {'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [854, 854], 'children': []}, {'type': 'VariableDeclaration', 'name': '_updated_webhook', 'range': [857, 857], 'children': [{'type': 'Punctuation', 'name': '=', 'range': [858, 858], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [859, 859], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [860, 860], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [861, 861], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [862, 862], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [863, 863], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [864, 864], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [865, 865], 'children': []}, {'type': 'Identifier', 'name': 'update', 'range': [866, 866], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [867, 867], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [869, 875], 'children': [{'type': 'Punctuation', 'name': '=', 'range': [870, 870], 'children': []}, {'type': 'Punctuation', 'name': '{', 'range': [871, 871], 'children': []}, {'type': 'StringLiteral', 'name': '"id"', 'range': [872, 872], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [873, 873], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [874, 874], 'children': []}, {'type': 'Punctuation', 'name': '}', 'range': [875, 875], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [876, 876], 'children': []}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [878, 887], 'children': [{'type': 'Punctuation', 'name': '=', 'range': [879, 879], 'children': []}, {'type': 'Punctuation', 'name': '{', 'range': [880, 880], 'children': []}, {'type': 'StringLiteral', 'name': '"config"', 'range': [881, 881], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [882, 882], 'children': []}, {'type': 'Identifier', 'name': 'Json', 'range': [883, 883], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [884, 884], 'children': []}, {'type': 'Identifier', 'name': 'updated_config', 'range': [885, 885], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [886, 886], 'children': []}, {'type': 'Punctuation', 'name': '}', 'range': [887, 887], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [888, 888], 'children': []}, {'type': 'Identifier', 'name': 'include', 'range': [890, 890], 'children': [{'type': 'Punctuation', 'name': '=', 'range': [891, 891], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [892, 892], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [893, 893], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [895, 895], 'children': []}]}, {'type': 'IfStatement', 'name': 'if', 'range': [897, 909], 'children': [{'type': 'Identifier', 'name': '_updated_webhook', 'range': [898, 898], 'children': []}, {'type': 'Keyword', 'name': 'is', 'range': [899, 899], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [900, 900], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [901, 901], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [903, 908], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [904, 904], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [905, 905], 'children': []}, {'type': 'StringLiteral', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [907, 907], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [908, 908], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [910, 917], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [911, 911], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [912, 912], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [913, 913], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [914, 914], 'children': []}, {'type': 'Identifier', 'name': '_updated_webhook', 'range': [915, 915], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [916, 916], 'children': []}]}]}]}
2025-01-08 10:13:17,985 - INFO - Starting Step 3: AST simplification
2025-01-08 10:13:18,354 - INFO - Step 5 result: {'type': 'Program', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 728], 'children': [{'type': 'FunctionDecl', 'name': 'find_webhook_by_credentials_and_props', 'range': [630, 727], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [630, 634], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [631, 634], 'children': []}, {'type': 'FunctionName', 'name': 'find_webhook_by_credentials_and_props', 'range': [632, 663], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [633, 653], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [635, 637], 'children': []}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [639, 641], 'children': []}, {'type': 'Parameter', 'name': 'resource', 'range': [643, 645], 'children': []}, {'type': 'Parameter', 'name': 'events', 'range': [647, 652], 'children': []}]}, {'type': 'ReturnType', 'name': '-> Webhook | None', 'range': [655, 659], 'children': []}, {'type': 'FunctionBody', 'name': 'body', 'range': [661, 727], 'children': [{'type': 'Docstring', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [662, 664], 'children': []}, {'type': 'Assignment', 'name': 'webhook = await IntegrationWebhook.prisma().find_first(...)', 'range': [666, 714], 'children': []}, {'type': 'ReturnStatement', 'name': 'return Webhook.from_db(webhook) if webhook else None', 'range': [716, 726], 'children': []}]}]}]}
2025-01-08 10:13:18,354 - INFO - Completed main AST analysis flow
2025-01-08 10:13:18,355 - INFO - Successfully processed chunk
2025-01-08 10:13:18,769 - INFO - Step 5 result: {'type': 'Program', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'FunctionDecl', 'name': 'publish_webhook_event', 'range': [1084, 1107], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1084, 1084], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1085, 1085], 'children': []}, {'type': 'Identifier', 'name': 'publish_webhook_event', 'range': [1086, 1086], 'children': []}, {'type': 'Identifier', 'name': 'event', 'range': [1088, 1088], 'children': []}, {'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1090, 1090], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1094, 1094], 'children': []}, {'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1095, 1095], 'children': []}, {'type': 'CallExpression', 'name': 'publish_event', 'range': [1097, 1097], 'children': [{'type': 'Identifier', 'name': 'event', 'range': [1100, 1100], 'children': []}, {'type': 'Literal', 'name': '"{event.webhook_id}/{event.event_type}"', 'range': [1103, 1103], 'children': []}]}]}]}
2025-01-08 10:13:18,769 - INFO - Completed main AST analysis flow
2025-01-08 10:13:18,769 - INFO - Successfully processed chunk
2025-01-08 10:13:19,734 - INFO - Step 3 result: {'type': 'Program', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'FunctionDeclaration', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [919, 919], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [920, 920], 'children': []}, {'type': 'Identifier', 'name': 'delete_webhook', 'range': [921, 921], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [923, 923], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [925, 925], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [927, 928], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [929, 929], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [931, 968], 'children': [{'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [932, 934], 'children': []}, {'type': 'VariableDeclaration', 'name': 'deleted', 'range': [936, 954], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [938, 938], 'children': []}, {'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma.delete', 'range': [939, 945], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [939, 939], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [941, 941], 'children': []}, {'type': 'Identifier', 'name': 'delete', 'range': [945, 945], 'children': []}]}, {'type': 'ObjectExpression', 'name': 'where', 'range': [947, 953], 'children': [{'type': 'Property', 'name': 'id', 'range': [950, 952], 'children': [{'type': 'StringLiteral', 'name': '"id"', 'range': [950, 950], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [952, 952], 'children': []}]}]}]}, {'type': 'IfStatement', 'name': '', 'range': [956, 967], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [957, 957], 'children': [{'type': 'Identifier', 'name': 'deleted', 'range': [958, 958], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [960, 967], 'children': [{'type': 'ThrowStatement', 'name': '', 'range': [961, 966], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [962, 966], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [962, 962], 'children': []}, {'type': 'TemplateLiteral', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [964, 965], 'children': []}]}]}]}]}]}]}]}
2025-01-08 10:13:19,734 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:24,254 - INFO - Step 2 result: {'nodes': [{'type': 'ClassDeclaration', 'name': 'Webhook', 'range': [101, 167], 'children': [{'type': 'ClassBody', 'range': [107, 167], 'children': [{'type': 'FieldDeclaration', 'name': 'user_id', 'range': [108, 110], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [110]}]}, {'type': 'FieldDeclaration', 'name': 'provider', 'range': [112, 114], 'children': [{'type': 'TypeAnnotation', 'name': 'ProviderName', 'range': [114]}]}, {'type': 'FieldDeclaration', 'name': 'credentials_id', 'range': [116, 118], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [118]}]}, {'type': 'FieldDeclaration', 'name': 'webhook_type', 'range': [120, 122], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [122]}]}, {'type': 'FieldDeclaration', 'name': 'resource', 'range': [124, 126], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [126]}]}, {'type': 'FieldDeclaration', 'name': 'events', 'range': [128, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [130, 133], 'children': [{'type': 'TypeArgument', 'name': 'str', 'range': [132]}]}]}, {'type': 'FieldDeclaration', 'name': 'config', 'range': [135, 144], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [137]}, {'type': 'Assignment', 'name': 'Field', 'range': [139, 144], 'children': [{'type': 'Argument', 'name': 'default_factory', 'range': [141, 143], 'children': [{'type': 'Value', 'name': 'dict', 'range': [143]}]}]}]}, {'type': 'FieldDeclaration', 'name': 'secret', 'range': [146, 148], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [148]}]}, {'type': 'FieldDeclaration', 'name': 'provider_webhook_id', 'range': [151, 153], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [153]}]}, {'type': 'FieldDeclaration', 'name': 'attached_nodes', 'range': [156, 166], 'children': [{'type': 'TypeAnnotation', 'name': 'Optional', 'range': [158, 164], 'children': [{'type': 'TypeArgument', 'name': 'list', 'range': [160, 163], 'children': [{'type': 'TypeArgument', 'name': 'NodeModel', 'range': [162]}]}]}, {'type': 'Assignment', 'name': 'None', 'range': [166]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'url', 'range': [175, 198], 'children': [{'type': 'MethodBody', 'range': [184, 198], 'children': [{'type': 'ReturnStatement', 'range': [185, 197], 'children': [{'type': 'CallExpression', 'name': 'webhook_ingress_url', 'range': [186, 197], 'children': [{'type': 'Argument', 'name': 'self.provider.value', 'range': [188, 192]}, {'type': 'Argument', 'name': 'self.id', 'range': [194, 196]}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'from_db', 'range': [203, 333], 'children': [{'type': 'MethodBody', 'range': [211, 333], 'children': [{'type': 'ImportStatement', 'range': [212, 216], 'children': [{'type': 'ImportSource', 'name': 'graph', 'range': [213]}, {'type': 'ImportedItem', 'name': 'NodeModel', 'range': [216]}]}, {'type': 'ReturnStatement', 'range': [219, 332], 'children': [{'type': 'CallExpression', 'name': 'Webhook', 'range': [220, 332], 'children': [{'type': 'Argument', 'name': 'id', 'range': [223, 227], 'children': [{'type': 'Value', 'name': 'webhook.id', 'range': [225, 227]}]}, {'type': 'Argument', 'name': 'user_id', 'range': [230, 234], 'children': [{'type': 'Value', 'name': 'webhook.userId', 'range': [232, 234]}]}, {'type': 'Argument', 'name': 'provider', 'range': [237, 244], 'children': [{'type': 'CallExpression', 'name': 'ProviderName', 'range': [239, 244], 'children': [{'type': 'Argument', 'name': 'webhook.provider', 'range': [241, 243]}]}]}, {'type': 'Argument', 'name': 'credentials_id', 'range': [247, 251], 'children': [{'type': 'Value', 'name': 'webhook.credentialsId', 'range': [249, 251]}]}, {'type': 'Argument', 'name': 'webhook_type', 'range': [254, 258], 'children': [{'type': 'Value', 'name': 'webhook.webhookType', 'range': [256, 258]}]}, {'type': 'Argument', 'name': 'resource', 'range': [261, 265], 'children': [{'type': 'Value', 'name': 'webhook.resource', 'range': [263, 265]}]}, {'type': 'Argument', 'name': 'events', 'range': [268, 272], 'children': [{'type': 'Value', 'name': 'webhook.events', 'range': [270, 272]}]}, {'type': 'Argument', 'name': 'config', 'range': [275, 282], 'children': [{'type': 'CallExpression', 'name': 'dict', 'range': [277, 282], 'children': [{'type': 'Argument', 'name': 'webhook.config', 'range': [279, 281]}]}]}, {'type': 'Argument', 'name': 'secret', 'range': [285, 289], 'children': [{'type': 'Value', 'name': 'webhook.secret', 'range': [287, 289]}]}, {'type': 'Argument', 'name': 'provider_webhook_id', 'range': [292, 296], 'children': [{'type': 'Value', 'name': 'webhook.providerWebhookId', 'range': [294, 296]}]}, {'type': 'Argument', 'name': 'attached_nodes', 'range': [299, 329], 'children': [{'type': 'ConditionalExpression', 'range': [301, 329], 'children': [{'type': 'Condition', 'range': [318, 324], 'children': [{'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [321]}]}, {'type': 'Consequent', 'range': [302, 316], 'children': [{'type': 'ListComprehension', 'range': [303, 316], 'children': [{'type': 'Element', 'range': [304, 309], 'children': [{'type': 'CallExpression', 'name': 'NodeModel.from_db', 'range': [306, 309], 'children': [{'type': 'Argument', 'name': 'node', 'range': [308]}]}]}, {'type': 'Iterator', 'range': [310, 313], 'children': [{'type': 'Value', 'name': 'node', 'range': [311]}, {'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [313]}]}]}]}, {'type': 'Alternate', 'range': [326, 327], 'children': [{'type': 'Value', 'name': 'None', 'range': [327]}]}]}]}]}]}]}]}]}
2025-01-08 10:13:24,255 - INFO - Starting Step 3: AST simplification
2025-01-08 10:13:24,613 - INFO - Step 4 result: {'type': 'Program', 'name': '', 'range': [0, 78], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'logging', 'range': [1, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [3, 11], 'children': [{'type': 'ImportSpecifier', 'name': 'TYPE_CHECKING', 'range': [6, 6], 'children': []}, {'type': 'ImportSpecifier', 'name': 'AsyncGenerator', 'range': [8, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'Optional', 'range': [10, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [13, 17], 'children': [{'type': 'ImportSpecifier', 'name': 'Json', 'range': [16, 16], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [18, 24], 'children': [{'type': 'ImportSpecifier', 'name': 'IntegrationWebhook', 'range': [23, 23], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [25, 31], 'children': [{'type': 'ImportSpecifier', 'name': 'Field', 'range': [28, 28], 'children': []}, {'type': 'ImportSpecifier', 'name': 'computed_field', 'range': [30, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [33, 41], 'children': [{'type': 'ImportSpecifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [40, 40], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [42, 50], 'children': [{'type': 'ImportSpecifier', 'name': 'AsyncRedisEventBus', 'range': [49, 49], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [51, 59], 'children': [{'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [58, 58], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [60, 70], 'children': [{'type': 'ImportSpecifier', 'name': 'webhook_ingress_url', 'range': [69, 69], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [72, 77], 'children': [{'type': 'ImportSpecifier', 'name': 'BaseDbModel', 'range': [76, 76], 'children': []}]}]}
2025-01-08 10:13:24,613 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:27,417 - INFO - Step 5 result: {'type': 'Program', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'FunctionDecl', 'name': 'listen_for_webhook_events', 'range': [1108, 1155], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [1108, 1112], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [1109, 1112], 'children': []}, {'type': 'FunctionName', 'name': 'listen_for_webhook_events', 'range': [1110, 1135], 'children': []}, {'type': 'ParameterList', 'name': '', 'range': [1111, 1126], 'children': [{'type': 'Parameter', 'name': 'webhook_id', 'range': [1113, 1115], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1115, 1118], 'children': []}, {'type': 'Parameter', 'name': 'event_type', 'range': [1117, 1124], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1118, 1124], 'children': []}]}, {'type': 'ReturnType', 'name': 'AsyncGenerator[WebhookEvent, None]', 'range': [1127, 1135], 'children': []}, {'type': 'FunctionBody', 'name': '', 'range': [1136, 1155], 'children': [{'type': 'AsyncForStatement', 'name': '', 'range': [1137, 1154], 'children': [{'type': 'ForKeyword', 'name': 'for', 'range': [1138, 1141], 'children': []}, {'type': 'VariableDecl', 'name': 'event', 'range': [1139, 1141], 'children': []}, {'type': 'InKeyword', 'name': 'in', 'range': [1140, 1141], 'children': []}, {'type': 'CallExpression', 'name': '_webhook_event_bus.listen_events', 'range': [1141, 1149], 'children': []}, {'type': 'Block', 'name': '', 'range': [1150, 1154], 'children': [{'type': 'YieldStatement', 'name': 'yield event', 'range': [1152, 1153], 'children': []}]}]}]}]}]}
2025-01-08 10:13:27,417 - INFO - Completed main AST analysis flow
2025-01-08 10:13:27,418 - INFO - Successfully processed chunk
2025-01-08 10:13:27,466 - INFO - Step 4 result: {'type': 'Program', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'FunctionDecl', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [556, 556], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [557, 557], 'children': []}, {'type': 'Identifier', 'name': 'get_all_webhooks_by_creds', 'range': [558, 558], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [559, 563], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [560, 560], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [562, 562], 'children': []}]}, {'type': 'ReturnType', 'name': 'list[Webhook]', 'range': [564, 569], 'children': []}, {'type': 'BlockStatement', 'name': 'body', 'range': [570, 629], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [572, 574], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [576, 586], 'children': [{'type': 'UnaryExpression', 'name': 'not credentials_id', 'range': [577, 578], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [581, 585], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [582, 582], 'children': []}, {'type': 'Literal', 'name': '"credentials_id must not be empty"', 'range': [584, 584], 'children': []}]}]}, {'type': 'VariableDecl', 'name': 'webhooks', 'range': [587, 614], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [589, 589], 'children': []}, {'type': 'CallExpression', 'name': 'IntegrationWebhook.prisma().find_many', 'range': [590, 613], 'children': [{'type': 'Arguments', 'name': 'arguments', 'range': [593, 613], 'children': [{'type': 'KeywordArgument', 'name': 'where', 'range': [599, 605], 'children': []}, {'type': 'KeywordArgument', 'name': 'include', 'range': [608, 610], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [615, 628], 'children': [{'type': 'ListComprehension', 'name': 'list comprehension', 'range': [616, 627], 'children': [{'type': 'CallExpression', 'name': 'Webhook.from_db(webhook)', 'range': [617, 622], 'children': []}, {'type': 'ForStatement', 'name': 'for webhook in webhooks', 'range': [623, 626], 'children': []}]}]}]}]}]}
2025-01-08 10:13:27,466 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:28,166 - INFO - Step 3 result: {'type': 'Program', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'FunctionDeclaration', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1156, 1156], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1157, 1157], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_webhook_event', 'range': [1158, 1158], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [1161, 1163], 'children': [{'type': 'Identifier', 'name': 'webhook_id', 'range': [1161, 1161], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1163, 1163], 'children': []}]}, {'type': 'Parameter', 'name': 'event_type', 'range': [1165, 1172], 'children': [{'type': 'Identifier', 'name': 'event_type', 'range': [1165, 1165], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1167, 1170], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1167, 1167], 'children': []}, {'type': 'Identifier', 'name': 'str', 'range': [1169, 1169], 'children': []}]}, {'type': 'Identifier', 'name': 'None', 'range': [1172, 1172], 'children': []}]}, {'type': 'Parameter', 'name': 'timeout', 'range': [1174, 1181], 'children': [{'type': 'Identifier', 'name': 'timeout', 'range': [1174, 1174], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[float]', 'range': [1176, 1179], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1176, 1176], 'children': []}, {'type': 'Identifier', 'name': 'float', 'range': [1178, 1178], 'children': []}]}, {'type': 'Identifier', 'name': 'None', 'range': [1181, 1181], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [1184, 1185], 'children': []}, {'type': 'TypeAnnotation', 'name': 'WebhookEvent | None', 'range': [1186, 1188], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1186, 1186], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [1188, 1188], 'children': []}]}, {'type': 'Block', 'name': '', 'range': [1190, 1205], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [1191, 1191], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1192, 1192], 'children': []}, {'type': 'Expression', 'name': '_webhook_event_bus.wait_for_event', 'range': [1193, 1203], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1193, 1193], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_event', 'range': [1195, 1195], 'children': []}, {'type': 'StringLiteral', 'name': 'f"{webhook_id}/{event_type or \'*\'}"', 'range': [1198, 1199], 'children': []}, {'type': 'Identifier', 'name': 'timeout', 'range': [1201, 1201], 'children': []}]}]}]}]}
2025-01-08 10:13:28,166 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:29,930 - INFO - Step 4 result: {'type': 'Program', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'FunctionDecl', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [502, 502], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [503, 503], 'children': []}, {'type': 'Identifier', 'name': 'get_webhook', 'range': [504, 504], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [506, 506], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [508, 508], 'children': []}]}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [512, 512], 'children': []}, {'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [515, 517], 'children': []}, {'type': 'VariableDecl', 'name': 'webhook', 'range': [519, 553], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [521, 521], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [522, 522], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [524, 524], 'children': []}, {'type': 'Identifier', 'name': 'find_unique_or_raise', 'range': [528, 528], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [531, 537], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [534, 534], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [536, 536], 'children': []}]}, {'type': 'Identifier', 'name': 'include', 'range': [540, 540], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [542, 542], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [547, 553], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [548, 548], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [550, 550], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [552, 552], 'children': []}]}]}]}
2025-01-08 10:13:29,930 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:30,691 - INFO - Step 2 result: {'type': 'Program', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'FunctionDeclaration', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [729, 729], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [730, 730], 'children': []}, {'type': 'Identifier', 'name': 'find_webhook_by_graph_and_props', 'range': [731, 731], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [732, 732], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [734, 736], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [734, 734], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [735, 735], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [736, 736], 'children': []}]}, {'type': 'Parameter', 'name': 'provider', 'range': [738, 740], 'children': [{'type': 'Identifier', 'name': 'provider', 'range': [738, 738], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [739, 739], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [740, 740], 'children': []}]}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [742, 744], 'children': [{'type': 'Identifier', 'name': 'webhook_type', 'range': [742, 742], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [743, 743], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [744, 744], 'children': []}]}, {'type': 'Parameter', 'name': 'events', 'range': [746, 751], 'children': [{'type': 'Identifier', 'name': 'events', 'range': [746, 746], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [747, 747], 'children': []}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [748, 748], 'children': []}, {'type': 'Punctuation', 'name': '[', 'range': [749, 749], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [750, 750], 'children': []}, {'type': 'Punctuation', 'name': ']', 'range': [751, 751], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [753, 753], 'children': []}, {'type': 'ReturnType', 'name': '->', 'range': [754, 755], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [756, 756], 'children': []}, {'type': 'Punctuation', 'name': '|', 'range': [757, 757], 'children': []}, {'type': 'TypeAnnotation', 'name': 'None', 'range': [758, 758], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [759, 759], 'children': []}, {'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [762, 762], 'children': []}, {'type': 'VariableDeclaration', 'name': 'webhook', 'range': [765, 833], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [765, 765], 'children': []}, {'type': 'Punctuation', 'name': '=', 'range': [766, 766], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [767, 767], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [768, 768], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [769, 769], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [770, 770], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [771, 771], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [772, 772], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [773, 773], 'children': []}, {'type': 'Identifier', 'name': 'find_first', 'range': [774, 774], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [775, 775], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [777, 813], 'children': [{'type': 'Property', 'name': '"provider"', 'range': [781, 783], 'children': [{'type': 'StringLiteral', 'name': '"provider"', 'range': [781, 781], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [782, 782], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [783, 783], 'children': []}]}, {'type': 'Property', 'name': '"webhookType"', 'range': [786, 788], 'children': [{'type': 'StringLiteral', 'name': '"webhookType"', 'range': [786, 786], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [787, 787], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [788, 788], 'children': []}]}, {'type': 'Property', 'name': '"events"', 'range': [791, 797], 'children': [{'type': 'StringLiteral', 'name': '"events"', 'range': [791, 791], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [792, 792], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"has_every": events}', 'range': [793, 797], 'children': [{'type': 'Property', 'name': '"has_every"', 'range': [794, 796], 'children': [{'type': 'StringLiteral', 'name': '"has_every"', 'range': [794, 794], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [795, 795], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [796, 796], 'children': []}]}]}]}, {'type': 'Property', 'name': '"AgentNodes"', 'range': [800, 810], 'children': [{'type': 'StringLiteral', 'name': '"AgentNodes"', 'range': [800, 800], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [801, 801], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"some": {"agentGraphId": graph_id}}', 'range': [802, 810], 'children': [{'type': 'Property', 'name': '"some"', 'range': [803, 805], 'children': [{'type': 'StringLiteral', 'name': '"some"', 'range': [803, 803], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [804, 804], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"agentGraphId": graph_id}', 'range': [805, 809], 'children': [{'type': 'Property', 'name': '"agentGraphId"', 'range': [806, 808], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphId"', 'range': [806, 806], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [807, 807], 'children': []}, {'type': 'Identifier', 'name': 'graph_id', 'range': [808, 808], 'children': []}]}]}]}]}]}]}, {'type': 'Punctuation', 'name': ',', 'range': [814, 814], 'children': []}, {'type': 'Identifier', 'name': 'include', 'range': [816, 816], 'children': []}, {'type': 'Punctuation', 'name': '=', 'range': [817, 817], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [818, 818], 'children': []}, {'type': 'Punctuation', 'name': ',', 'range': [819, 819], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [821, 821], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [823, 833], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [824, 824], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [825, 825], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [826, 826], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [827, 827], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [828, 828], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [829, 829], 'children': []}, {'type': 'Keyword', 'name': 'if', 'range': [830, 830], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [831, 831], 'children': []}, {'type': 'Keyword', 'name': 'else', 'range': [832, 832], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [833, 833], 'children': []}]}]}]}
2025-01-08 10:13:30,691 - INFO - Starting Step 3: AST simplification
2025-01-08 10:13:38,177 - INFO - Step 4 result: {'type': 'Program', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'FunctionDecl', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [919, 919], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [920, 920], 'children': []}, {'type': 'Identifier', 'name': 'delete_webhook', 'range': [921, 921], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [923, 923], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [925, 925], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [927, 928], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [929, 929], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [931, 968], 'children': [{'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [932, 934], 'children': []}, {'type': 'VariableDeclaration', 'name': 'deleted', 'range': [936, 954], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [938, 938], 'children': []}, {'type': 'CallExpression', 'name': 'IntegrationWebhook.prisma.delete', 'range': [939, 945], 'children': [{'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma.delete', 'range': [939, 945], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [939, 939], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [941, 941], 'children': []}, {'type': 'Identifier', 'name': 'delete', 'range': [945, 945], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'where', 'range': [947, 953], 'children': [{'type': 'Property', 'name': 'id', 'range': [950, 952], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [950, 950], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [952, 952], 'children': []}]}]}]}, {'type': 'IfStatement', 'name': '', 'range': [956, 967], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [957, 957], 'children': [{'type': 'Identifier', 'name': 'deleted', 'range': [958, 958], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [960, 967], 'children': [{'type': 'ThrowStatement', 'name': '', 'range': [961, 966], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [962, 966], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [962, 962], 'children': []}, {'type': 'TemplateLiteral', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [964, 965], 'children': []}]}]}]}]}]}]}]}
2025-01-08 10:13:38,177 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:40,091 - INFO - Step 5 result: {'type': 'Program', 'name': '', 'range': [0, 78], 'children': [{'type': 'ImportDeclaration', 'name': '', 'range': [0, 2], 'children': [{'type': 'ImportSpecifier', 'name': 'logging', 'range': [1, 1], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [3, 11], 'children': [{'type': 'ImportSpecifier', 'name': 'TYPE_CHECKING', 'range': [6, 6], 'children': []}, {'type': 'ImportSpecifier', 'name': 'AsyncGenerator', 'range': [8, 8], 'children': []}, {'type': 'ImportSpecifier', 'name': 'Optional', 'range': [10, 10], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [13, 17], 'children': [{'type': 'ImportSpecifier', 'name': 'Json', 'range': [16, 16], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [18, 24], 'children': [{'type': 'ImportSpecifier', 'name': 'IntegrationWebhook', 'range': [23, 23], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [25, 31], 'children': [{'type': 'ImportSpecifier', 'name': 'Field', 'range': [28, 28], 'children': []}, {'type': 'ImportSpecifier', 'name': 'computed_field', 'range': [30, 30], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [33, 41], 'children': [{'type': 'ImportSpecifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [40, 40], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [42, 50], 'children': [{'type': 'ImportSpecifier', 'name': 'AsyncRedisEventBus', 'range': [49, 49], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [51, 59], 'children': [{'type': 'ImportSpecifier', 'name': 'ProviderName', 'range': [58, 58], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [60, 70], 'children': [{'type': 'ImportSpecifier', 'name': 'webhook_ingress_url', 'range': [69, 69], 'children': []}]}, {'type': 'ImportDeclaration', 'name': '', 'range': [72, 77], 'children': [{'type': 'ImportSpecifier', 'name': 'BaseDbModel', 'range': [76, 76], 'children': []}]}]}
2025-01-08 10:13:40,091 - INFO - Completed main AST analysis flow
2025-01-08 10:13:40,092 - INFO - Successfully processed chunk
2025-01-08 10:13:40,724 - INFO - Step 3 result: {'type': 'Program', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'FunctionDeclaration', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [836, 836], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [837, 837], 'children': []}, {'type': 'Identifier', 'name': 'update_webhook_config', 'range': [838, 838], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [840, 842], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [842, 842], 'children': []}]}, {'type': 'Parameter', 'name': 'updated_config', 'range': [844, 846], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [846, 846], 'children': []}]}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [850, 850], 'children': []}, {'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [854, 854], 'children': []}, {'type': 'VariableDeclaration', 'name': '_updated_webhook', 'range': [857, 895], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [859, 859], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [860, 860], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [862, 862], 'children': []}, {'type': 'Identifier', 'name': 'update', 'range': [866, 866], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [869, 875], 'children': [{'type': 'StringLiteral', 'name': '"id"', 'range': [872, 872], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [874, 874], 'children': []}]}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [878, 887], 'children': [{'type': 'StringLiteral', 'name': '"config"', 'range': [881, 881], 'children': []}, {'type': 'Identifier', 'name': 'Json', 'range': [883, 883], 'children': []}, {'type': 'Identifier', 'name': 'updated_config', 'range': [885, 885], 'children': []}]}, {'type': 'Identifier', 'name': 'include', 'range': [890, 892], 'children': [{'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [892, 892], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [897, 909], 'children': [{'type': 'Identifier', 'name': '_updated_webhook', 'range': [898, 898], 'children': []}, {'type': 'Keyword', 'name': 'is', 'range': [899, 899], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [900, 900], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [903, 908], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [904, 904], 'children': []}, {'type': 'StringLiteral', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [907, 907], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [910, 917], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [911, 911], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [913, 913], 'children': []}, {'type': 'Identifier', 'name': '_updated_webhook', 'range': [915, 915], 'children': []}]}]}]}
2025-01-08 10:13:40,724 - INFO - Starting Step 4: AST normalization
2025-01-08 10:13:44,796 - INFO - Step 5 result: {'type': 'Program', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'FunctionDecl', 'name': 'get_webhook', 'range': [502, 555], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [502, 502], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [503, 503], 'children': []}, {'type': 'Identifier', 'name': 'get_webhook', 'range': [504, 504], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [506, 506], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [508, 508], 'children': []}]}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [512, 512], 'children': []}, {'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [515, 517], 'children': []}, {'type': 'VariableDecl', 'name': 'webhook', 'range': [519, 553], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [521, 521], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [522, 522], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [524, 524], 'children': []}, {'type': 'Identifier', 'name': 'find_unique_or_raise', 'range': [528, 528], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [531, 537], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [534, 534], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [536, 536], 'children': []}]}, {'type': 'Identifier', 'name': 'include', 'range': [540, 540], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [542, 542], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [547, 553], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [548, 548], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [550, 550], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [552, 552], 'children': []}]}]}]}
2025-01-08 10:13:44,796 - INFO - Completed main AST analysis flow
2025-01-08 10:13:44,796 - INFO - Successfully processed chunk
2025-01-08 10:13:44,829 - INFO - Step 5 result: {'type': 'Program', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'FunctionDecl', 'name': 'get_all_webhooks_by_creds', 'range': [556, 629], 'children': [{'type': 'AsyncKeyword', 'name': 'async', 'range': [556, 556], 'children': []}, {'type': 'DefKeyword', 'name': 'def', 'range': [557, 557], 'children': []}, {'type': 'Identifier', 'name': 'get_all_webhooks_by_creds', 'range': [558, 558], 'children': []}, {'type': 'ParameterList', 'name': 'parameters', 'range': [559, 563], 'children': [{'type': 'Parameter', 'name': 'credentials_id', 'range': [560, 560], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [562, 562], 'children': []}]}, {'type': 'ReturnType', 'name': 'list[Webhook]', 'range': [564, 569], 'children': []}, {'type': 'BlockStatement', 'name': 'body', 'range': [570, 629], 'children': [{'type': 'Docstring', 'name': 'docstring', 'range': [572, 574], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [576, 586], 'children': [{'type': 'UnaryExpression', 'name': 'not credentials_id', 'range': [577, 578], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [581, 585], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [582, 582], 'children': []}, {'type': 'Literal', 'name': '"credentials_id must not be empty"', 'range': [584, 584], 'children': []}]}]}, {'type': 'VariableDecl', 'name': 'webhooks', 'range': [587, 614], 'children': [{'type': 'AwaitExpression', 'name': 'await', 'range': [589, 589], 'children': []}, {'type': 'CallExpression', 'name': 'IntegrationWebhook.prisma().find_many', 'range': [590, 613], 'children': [{'type': 'Arguments', 'name': 'arguments', 'range': [593, 613], 'children': [{'type': 'KeywordArgument', 'name': 'where', 'range': [599, 605], 'children': []}, {'type': 'KeywordArgument', 'name': 'include', 'range': [608, 610], 'children': []}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [615, 628], 'children': [{'type': 'ListComprehension', 'name': 'list comprehension', 'range': [616, 627], 'children': [{'type': 'CallExpression', 'name': 'Webhook.from_db(webhook)', 'range': [617, 622], 'children': []}, {'type': 'ForStatement', 'name': 'for webhook in webhooks', 'range': [623, 626], 'children': []}]}]}]}]}]}
2025-01-08 10:13:44,829 - INFO - Completed main AST analysis flow
2025-01-08 10:13:44,830 - INFO - Successfully processed chunk
2025-01-08 10:13:48,920 - INFO - Step 4 result: {'type': 'Program', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'FunctionDecl', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1156, 1156], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1157, 1157], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_webhook_event', 'range': [1158, 1158], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [1161, 1163], 'children': [{'type': 'Identifier', 'name': 'webhook_id', 'range': [1161, 1161], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1163, 1163], 'children': []}]}, {'type': 'Parameter', 'name': 'event_type', 'range': [1165, 1172], 'children': [{'type': 'Identifier', 'name': 'event_type', 'range': [1165, 1165], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1167, 1170], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1167, 1167], 'children': []}, {'type': 'Identifier', 'name': 'str', 'range': [1169, 1169], 'children': []}]}, {'type': 'Identifier', 'name': 'None', 'range': [1172, 1172], 'children': []}]}, {'type': 'Parameter', 'name': 'timeout', 'range': [1174, 1181], 'children': [{'type': 'Identifier', 'name': 'timeout', 'range': [1174, 1174], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[float]', 'range': [1176, 1179], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1176, 1176], 'children': []}, {'type': 'Identifier', 'name': 'float', 'range': [1178, 1178], 'children': []}]}, {'type': 'Identifier', 'name': 'None', 'range': [1181, 1181], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [1184, 1185], 'children': []}, {'type': 'TypeAnnotation', 'name': 'WebhookEvent | None', 'range': [1186, 1188], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1186, 1186], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [1188, 1188], 'children': []}]}, {'type': 'Block', 'name': '', 'range': [1190, 1205], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [1191, 1191], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1192, 1192], 'children': []}, {'type': 'CallExpression', 'name': '_webhook_event_bus.wait_for_event', 'range': [1193, 1203], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1193, 1193], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_event', 'range': [1195, 1195], 'children': []}, {'type': 'Literal', 'name': 'f"{webhook_id}/{event_type or \'*\'}"', 'range': [1198, 1199], 'children': []}, {'type': 'Identifier', 'name': 'timeout', 'range': [1201, 1201], 'children': []}]}]}]}]}
2025-01-08 10:13:48,920 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:13:50,226 - INFO - Step 2 result: {'type': 'Program', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'FunctionDeclaration', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [385, 385], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [386, 386], 'children': []}, {'type': 'Identifier', 'name': 'create_webhook', 'range': [387, 387], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [388, 388], 'children': []}, {'type': 'Parameter', 'name': 'webhook', 'range': [389, 392], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [389, 389], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [390, 390], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [391, 391], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [392, 392], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [393, 394], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [395, 395], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [396, 396], 'children': []}, {'type': 'Block', 'name': '', 'range': [397, 501], 'children': [{'type': 'VariableDeclaration', 'name': 'created_webhook', 'range': [398, 491], 'children': [{'type': 'Identifier', 'name': 'created_webhook', 'range': [398, 398], 'children': []}, {'type': 'Operator', 'name': '=', 'range': [399, 399], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [400, 400], 'children': []}, {'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma().create', 'range': [401, 407], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [401, 401], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [402, 402], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [403, 403], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [404, 404], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [405, 405], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [406, 406], 'children': []}, {'type': 'Identifier', 'name': 'create', 'range': [407, 407], 'children': []}]}, {'type': 'Punctuation', 'name': '(', 'range': [408, 408], 'children': []}, {'type': 'ObjectExpression', 'name': 'data', 'range': [410, 489], 'children': [{'type': 'Identifier', 'name': 'data', 'range': [410, 410], 'children': []}, {'type': 'Operator', 'name': '=', 'range': [411, 411], 'children': []}, {'type': 'Punctuation', 'name': '{', 'range': [412, 412], 'children': []}, {'type': 'Property', 'name': 'id', 'range': [414, 419], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [414, 414], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [415, 415], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.id', 'range': [416, 418], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [416, 416], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [417, 417], 'children': []}, {'type': 'Identifier', 'name': 'id', 'range': [418, 418], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [419, 419], 'children': []}]}, {'type': 'Property', 'name': 'userId', 'range': [421, 426], 'children': [{'type': 'Literal', 'name': '"userId"', 'range': [421, 421], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [422, 422], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.user_id', 'range': [423, 425], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [423, 423], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [424, 424], 'children': []}, {'type': 'Identifier', 'name': 'user_id', 'range': [425, 425], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [426, 426], 'children': []}]}, {'type': 'Property', 'name': 'provider', 'range': [428, 435], 'children': [{'type': 'Literal', 'name': '"provider"', 'range': [428, 428], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [429, 429], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider.value', 'range': [430, 434], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [430, 430], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [431, 431], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [432, 432], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [433, 433], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [434, 434], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [435, 435], 'children': []}]}, {'type': 'Property', 'name': 'credentialsId', 'range': [437, 442], 'children': [{'type': 'Literal', 'name': '"credentialsId"', 'range': [437, 437], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [438, 438], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.credentials_id', 'range': [439, 441], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [439, 439], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [440, 440], 'children': []}, {'type': 'Identifier', 'name': 'credentials_id', 'range': [441, 441], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [442, 442], 'children': []}]}, {'type': 'Property', 'name': 'webhookType', 'range': [444, 449], 'children': [{'type': 'Literal', 'name': '"webhookType"', 'range': [444, 444], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [445, 445], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.webhook_type', 'range': [446, 448], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [446, 446], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [447, 447], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [448, 448], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [449, 449], 'children': []}]}, {'type': 'Property', 'name': 'resource', 'range': [451, 456], 'children': [{'type': 'Literal', 'name': '"resource"', 'range': [451, 451], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [452, 452], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.resource', 'range': [453, 455], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [453, 453], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [454, 454], 'children': []}, {'type': 'Identifier', 'name': 'resource', 'range': [455, 455], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [456, 456], 'children': []}]}, {'type': 'Property', 'name': 'events', 'range': [458, 463], 'children': [{'type': 'Literal', 'name': '"events"', 'range': [458, 458], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [459, 459], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.events', 'range': [460, 462], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [460, 460], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [461, 461], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [462, 462], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [463, 463], 'children': []}]}, {'type': 'Property', 'name': 'config', 'range': [465, 473], 'children': [{'type': 'Literal', 'name': '"config"', 'range': [465, 465], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [466, 466], 'children': []}, {'type': 'CallExpression', 'name': 'Json', 'range': [467, 472], 'children': [{'type': 'Identifier', 'name': 'Json', 'range': [467, 467], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [468, 468], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.config', 'range': [469, 471], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [469, 469], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [470, 470], 'children': []}, {'type': 'Identifier', 'name': 'config', 'range': [471, 471], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [472, 472], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [473, 473], 'children': []}]}, {'type': 'Property', 'name': 'secret', 'range': [475, 480], 'children': [{'type': 'Literal', 'name': '"secret"', 'range': [475, 475], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [476, 476], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.secret', 'range': [477, 479], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [477, 477], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [478, 478], 'children': []}, {'type': 'Identifier', 'name': 'secret', 'range': [479, 479], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [480, 480], 'children': []}]}, {'type': 'Property', 'name': 'providerWebhookId', 'range': [482, 487], 'children': [{'type': 'Literal', 'name': '"providerWebhookId"', 'range': [482, 482], 'children': []}, {'type': 'Punctuation', 'name': ':', 'range': [483, 483], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider_webhook_id', 'range': [484, 486], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [484, 484], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [485, 485], 'children': []}, {'type': 'Identifier', 'name': 'provider_webhook_id', 'range': [486, 486], 'children': []}]}, {'type': 'Punctuation', 'name': ',', 'range': [487, 487], 'children': []}]}, {'type': 'Punctuation', 'name': '}', 'range': [489, 489], 'children': []}]}, {'type': 'Punctuation', 'name': ')', 'range': [491, 491], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [493, 500], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [493, 493], 'children': []}, {'type': 'CallExpression', 'name': 'Webhook.from_db', 'range': [494, 499], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [494, 494], 'children': []}, {'type': 'Punctuation', 'name': '.', 'range': [495, 495], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [496, 496], 'children': []}, {'type': 'Punctuation', 'name': '(', 'range': [497, 497], 'children': []}, {'type': 'Identifier', 'name': 'created_webhook', 'range': [498, 498], 'children': []}, {'type': 'Punctuation', 'name': ')', 'range': [499, 499], 'children': []}]}]}]}]}]}
2025-01-08 10:13:50,226 - INFO - Starting Step 3: AST simplification
2025-01-08 10:13:56,746 - INFO - Step 5 result: {'type': 'Program', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'FunctionDecl', 'name': 'delete_webhook', 'range': [919, 968], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [919, 919], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [920, 920], 'children': []}, {'type': 'Identifier', 'name': 'delete_webhook', 'range': [921, 921], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [923, 923], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [925, 925], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [927, 928], 'children': [{'type': 'TypeAnnotation', 'name': 'None', 'range': [929, 929], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [931, 968], 'children': [{'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [932, 934], 'children': []}, {'type': 'VariableDeclaration', 'name': 'deleted', 'range': [936, 954], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [938, 938], 'children': []}, {'type': 'CallExpression', 'name': 'IntegrationWebhook.prisma.delete', 'range': [939, 945], 'children': [{'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma.delete', 'range': [939, 945], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [939, 939], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [941, 941], 'children': []}, {'type': 'Identifier', 'name': 'delete', 'range': [945, 945], 'children': []}]}]}, {'type': 'ObjectExpression', 'name': 'where', 'range': [947, 953], 'children': [{'type': 'Property', 'name': 'id', 'range': [950, 952], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [950, 950], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [952, 952], 'children': []}]}]}]}, {'type': 'IfStatement', 'name': '', 'range': [956, 967], 'children': [{'type': 'UnaryExpression', 'name': 'not', 'range': [957, 957], 'children': [{'type': 'Identifier', 'name': 'deleted', 'range': [958, 958], 'children': []}]}, {'type': 'BlockStatement', 'name': '', 'range': [960, 967], 'children': [{'type': 'ThrowStatement', 'name': '', 'range': [961, 966], 'children': [{'type': 'NewExpression', 'name': 'ValueError', 'range': [962, 966], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [962, 962], 'children': []}, {'type': 'TemplateLiteral', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [964, 965], 'children': []}]}]}]}]}]}]}]}
2025-01-08 10:13:56,746 - INFO - Completed main AST analysis flow
2025-01-08 10:13:56,746 - INFO - Successfully processed chunk
2025-01-08 10:14:02,598 - INFO - Step 4 result: {'type': 'Program', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'FunctionDecl', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [836, 836], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [837, 837], 'children': []}, {'type': 'Identifier', 'name': 'update_webhook_config', 'range': [838, 838], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [840, 842], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [842, 842], 'children': []}]}, {'type': 'Parameter', 'name': 'updated_config', 'range': [844, 846], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [846, 846], 'children': []}]}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [850, 850], 'children': []}, {'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [854, 854], 'children': []}, {'type': 'VariableDecl', 'name': '_updated_webhook', 'range': [857, 895], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [859, 859], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [860, 860], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [862, 862], 'children': []}, {'type': 'Identifier', 'name': 'update', 'range': [866, 866], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [869, 875], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [872, 872], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [874, 874], 'children': []}]}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [878, 887], 'children': [{'type': 'Literal', 'name': '"config"', 'range': [881, 881], 'children': []}, {'type': 'Identifier', 'name': 'Json', 'range': [883, 883], 'children': []}, {'type': 'Identifier', 'name': 'updated_config', 'range': [885, 885], 'children': []}]}, {'type': 'Identifier', 'name': 'include', 'range': [890, 892], 'children': [{'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [892, 892], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [897, 909], 'children': [{'type': 'Identifier', 'name': '_updated_webhook', 'range': [898, 898], 'children': []}, {'type': 'Keyword', 'name': 'is', 'range': [899, 899], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [900, 900], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [903, 908], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [904, 904], 'children': []}, {'type': 'Literal', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [907, 907], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [910, 917], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [911, 911], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [913, 913], 'children': []}, {'type': 'Identifier', 'name': '_updated_webhook', 'range': [915, 915], 'children': []}]}]}]}
2025-01-08 10:14:02,598 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:14:07,325 - INFO - Step 3 result: {'nodes': [{'type': 'ClassDeclaration', 'name': 'Webhook', 'range': [101, 167], 'children': [{'type': 'ClassBody', 'range': [107, 167], 'children': [{'type': 'FieldDeclaration', 'name': 'user_id', 'range': [108, 110], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [110]}]}, {'type': 'FieldDeclaration', 'name': 'provider', 'range': [112, 114], 'children': [{'type': 'TypeAnnotation', 'name': 'ProviderName', 'range': [114]}]}, {'type': 'FieldDeclaration', 'name': 'credentials_id', 'range': [116, 118], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [118]}]}, {'type': 'FieldDeclaration', 'name': 'webhook_type', 'range': [120, 122], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [122]}]}, {'type': 'FieldDeclaration', 'name': 'resource', 'range': [124, 126], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [126]}]}, {'type': 'FieldDeclaration', 'name': 'events', 'range': [128, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [130, 133], 'children': [{'type': 'TypeArgument', 'name': 'str', 'range': [132]}]}]}, {'type': 'FieldDeclaration', 'name': 'config', 'range': [135, 144], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [137]}, {'type': 'Assignment', 'name': 'Field', 'range': [139, 144], 'children': [{'type': 'Argument', 'name': 'default_factory', 'range': [141, 143], 'children': [{'type': 'Value', 'name': 'dict', 'range': [143]}]}]}]}, {'type': 'FieldDeclaration', 'name': 'secret', 'range': [146, 148], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [148]}]}, {'type': 'FieldDeclaration', 'name': 'provider_webhook_id', 'range': [151, 153], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [153]}]}, {'type': 'FieldDeclaration', 'name': 'attached_nodes', 'range': [156, 166], 'children': [{'type': 'TypeAnnotation', 'name': 'Optional', 'range': [158, 164], 'children': [{'type': 'TypeArgument', 'name': 'list', 'range': [160, 163], 'children': [{'type': 'TypeArgument', 'name': 'NodeModel', 'range': [162]}]}]}, {'type': 'Assignment', 'name': 'None', 'range': [166]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'url', 'range': [175, 198], 'children': [{'type': 'MethodBody', 'range': [184, 198], 'children': [{'type': 'ReturnStatement', 'range': [185, 197], 'children': [{'type': 'CallExpression', 'name': 'webhook_ingress_url', 'range': [186, 197], 'children': [{'type': 'Argument', 'name': 'self.provider.value', 'range': [188, 192]}, {'type': 'Argument', 'name': 'self.id', 'range': [194, 196]}]}]}]}]}, {'type': 'MethodDeclaration', 'name': 'from_db', 'range': [203, 333], 'children': [{'type': 'MethodBody', 'range': [211, 333], 'children': [{'type': 'ImportStatement', 'range': [212, 216], 'children': [{'type': 'ImportSource', 'name': 'graph', 'range': [213]}, {'type': 'ImportedItem', 'name': 'NodeModel', 'range': [216]}]}, {'type': 'ReturnStatement', 'range': [219, 332], 'children': [{'type': 'CallExpression', 'name': 'Webhook', 'range': [220, 332], 'children': [{'type': 'Argument', 'name': 'id', 'range': [223, 227], 'children': [{'type': 'Value', 'name': 'webhook.id', 'range': [225, 227]}]}, {'type': 'Argument', 'name': 'user_id', 'range': [230, 234], 'children': [{'type': 'Value', 'name': 'webhook.userId', 'range': [232, 234]}]}, {'type': 'Argument', 'name': 'provider', 'range': [237, 244], 'children': [{'type': 'CallExpression', 'name': 'ProviderName', 'range': [239, 244], 'children': [{'type': 'Argument', 'name': 'webhook.provider', 'range': [241, 243]}]}]}, {'type': 'Argument', 'name': 'credentials_id', 'range': [247, 251], 'children': [{'type': 'Value', 'name': 'webhook.credentialsId', 'range': [249, 251]}]}, {'type': 'Argument', 'name': 'webhook_type', 'range': [254, 258], 'children': [{'type': 'Value', 'name': 'webhook.webhookType', 'range': [256, 258]}]}, {'type': 'Argument', 'name': 'resource', 'range': [261, 265], 'children': [{'type': 'Value', 'name': 'webhook.resource', 'range': [263, 265]}]}, {'type': 'Argument', 'name': 'events', 'range': [268, 272], 'children': [{'type': 'Value', 'name': 'webhook.events', 'range': [270, 272]}]}, {'type': 'Argument', 'name': 'config', 'range': [275, 282], 'children': [{'type': 'CallExpression', 'name': 'dict', 'range': [277, 282], 'children': [{'type': 'Argument', 'name': 'webhook.config', 'range': [279, 281]}]}]}, {'type': 'Argument', 'name': 'secret', 'range': [285, 289], 'children': [{'type': 'Value', 'name': 'webhook.secret', 'range': [287, 289]}]}, {'type': 'Argument', 'name': 'provider_webhook_id', 'range': [292, 296], 'children': [{'type': 'Value', 'name': 'webhook.providerWebhookId', 'range': [294, 296]}]}, {'type': 'Argument', 'name': 'attached_nodes', 'range': [299, 329], 'children': [{'type': 'ConditionalExpression', 'range': [301, 329], 'children': [{'type': 'Condition', 'range': [318, 324], 'children': [{'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [321]}]}, {'type': 'Consequent', 'range': [302, 316], 'children': [{'type': 'ListComprehension', 'range': [303, 316], 'children': [{'type': 'Element', 'range': [304, 309], 'children': [{'type': 'CallExpression', 'name': 'NodeModel.from_db', 'range': [306, 309], 'children': [{'type': 'Argument', 'name': 'node', 'range': [308]}]}]}, {'type': 'Iterator', 'range': [310, 313], 'children': [{'type': 'Value', 'name': 'node', 'range': [311]}, {'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [313]}]}]}]}, {'type': 'Alternate', 'range': [326, 327], 'children': [{'type': 'Value', 'name': 'None', 'range': [327]}]}]}]}]}]}]}]}]}
2025-01-08 10:14:07,325 - INFO - Starting Step 4: AST normalization
2025-01-08 10:14:07,673 - INFO - Step 3 result: {'type': 'Program', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'FunctionDeclaration', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [729, 729], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [730, 730], 'children': []}, {'type': 'Identifier', 'name': 'find_webhook_by_graph_and_props', 'range': [731, 731], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [734, 736], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [734, 734], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [736, 736], 'children': []}]}, {'type': 'Parameter', 'name': 'provider', 'range': [738, 740], 'children': [{'type': 'Identifier', 'name': 'provider', 'range': [738, 738], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [740, 740], 'children': []}]}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [742, 744], 'children': [{'type': 'Identifier', 'name': 'webhook_type', 'range': [742, 742], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [744, 744], 'children': []}]}, {'type': 'Parameter', 'name': 'events', 'range': [746, 751], 'children': [{'type': 'Identifier', 'name': 'events', 'range': [746, 746], 'children': []}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [748, 748], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [750, 750], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [754, 755], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [756, 756], 'children': []}, {'type': 'TypeAnnotation', 'name': 'None', 'range': [758, 758], 'children': []}, {'type': 'StringLiteral', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [762, 762], 'children': []}, {'type': 'VariableDeclaration', 'name': 'webhook', 'range': [765, 833], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [765, 765], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [767, 767], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [768, 768], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [770, 770], 'children': []}, {'type': 'Identifier', 'name': 'find_first', 'range': [774, 774], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [777, 813], 'children': [{'type': 'Property', 'name': '"provider"', 'range': [781, 783], 'children': [{'type': 'StringLiteral', 'name': '"provider"', 'range': [781, 781], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [783, 783], 'children': []}]}, {'type': 'Property', 'name': '"webhookType"', 'range': [786, 788], 'children': [{'type': 'StringLiteral', 'name': '"webhookType"', 'range': [786, 786], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [788, 788], 'children': []}]}, {'type': 'Property', 'name': '"events"', 'range': [791, 797], 'children': [{'type': 'StringLiteral', 'name': '"events"', 'range': [791, 791], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"has_every": events}', 'range': [793, 797], 'children': [{'type': 'Property', 'name': '"has_every"', 'range': [794, 796], 'children': [{'type': 'StringLiteral', 'name': '"has_every"', 'range': [794, 794], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [796, 796], 'children': []}]}]}]}, {'type': 'Property', 'name': '"AgentNodes"', 'range': [800, 810], 'children': [{'type': 'StringLiteral', 'name': '"AgentNodes"', 'range': [800, 800], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"some": {"agentGraphId": graph_id}}', 'range': [802, 810], 'children': [{'type': 'Property', 'name': '"some"', 'range': [803, 805], 'children': [{'type': 'StringLiteral', 'name': '"some"', 'range': [803, 803], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"agentGraphId": graph_id}', 'range': [805, 809], 'children': [{'type': 'Property', 'name': '"agentGraphId"', 'range': [806, 808], 'children': [{'type': 'StringLiteral', 'name': '"agentGraphId"', 'range': [806, 806], 'children': []}, {'type': 'Identifier', 'name': 'graph_id', 'range': [808, 808], 'children': []}]}]}]}]}]}]}, {'type': 'Identifier', 'name': 'include', 'range': [816, 816], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [818, 818], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [823, 833], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [824, 824], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [826, 826], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [828, 828], 'children': []}, {'type': 'Keyword', 'name': 'if', 'range': [830, 830], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [831, 831], 'children': []}, {'type': 'Keyword', 'name': 'else', 'range': [832, 832], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [833, 833], 'children': []}]}]}]}
2025-01-08 10:14:07,673 - INFO - Starting Step 4: AST normalization
2025-01-08 10:14:09,319 - INFO - Step 5 result: {'type': 'Program', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'FunctionDecl', 'name': 'wait_for_webhook_event', 'range': [1156, 1205], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [1156, 1156], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [1157, 1157], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_webhook_event', 'range': [1158, 1158], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [1161, 1163], 'children': [{'type': 'Identifier', 'name': 'webhook_id', 'range': [1161, 1161], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [1163, 1163], 'children': []}]}, {'type': 'Parameter', 'name': 'event_type', 'range': [1165, 1172], 'children': [{'type': 'Identifier', 'name': 'event_type', 'range': [1165, 1165], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[str]', 'range': [1167, 1170], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1167, 1167], 'children': []}, {'type': 'Identifier', 'name': 'str', 'range': [1169, 1169], 'children': []}]}, {'type': 'Identifier', 'name': 'None', 'range': [1172, 1172], 'children': []}]}, {'type': 'Parameter', 'name': 'timeout', 'range': [1174, 1181], 'children': [{'type': 'Identifier', 'name': 'timeout', 'range': [1174, 1174], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Optional[float]', 'range': [1176, 1179], 'children': [{'type': 'Identifier', 'name': 'Optional', 'range': [1176, 1176], 'children': []}, {'type': 'Identifier', 'name': 'float', 'range': [1178, 1178], 'children': []}]}, {'type': 'Identifier', 'name': 'None', 'range': [1181, 1181], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [1184, 1185], 'children': []}, {'type': 'TypeAnnotation', 'name': 'WebhookEvent | None', 'range': [1186, 1188], 'children': [{'type': 'Identifier', 'name': 'WebhookEvent', 'range': [1186, 1186], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [1188, 1188], 'children': []}]}, {'type': 'Block', 'name': '', 'range': [1190, 1205], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [1191, 1191], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [1192, 1192], 'children': []}, {'type': 'CallExpression', 'name': '_webhook_event_bus.wait_for_event', 'range': [1193, 1203], 'children': [{'type': 'Identifier', 'name': '_webhook_event_bus', 'range': [1193, 1193], 'children': []}, {'type': 'Identifier', 'name': 'wait_for_event', 'range': [1195, 1195], 'children': []}, {'type': 'Literal', 'name': 'f"{webhook_id}/{event_type or \'*\'}"', 'range': [1198, 1199], 'children': []}, {'type': 'Identifier', 'name': 'timeout', 'range': [1201, 1201], 'children': []}]}]}]}]}
2025-01-08 10:14:09,319 - INFO - Completed main AST analysis flow
2025-01-08 10:14:09,321 - INFO - Successfully processed chunk
2025-01-08 10:14:25,249 - INFO - Step 5 result: {'type': 'Program', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'FunctionDecl', 'name': 'update_webhook_config', 'range': [836, 918], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [836, 836], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [837, 837], 'children': []}, {'type': 'Identifier', 'name': 'update_webhook_config', 'range': [838, 838], 'children': []}, {'type': 'Parameter', 'name': 'webhook_id', 'range': [840, 842], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [842, 842], 'children': []}]}, {'type': 'Parameter', 'name': 'updated_config', 'range': [844, 846], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [846, 846], 'children': []}]}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [850, 850], 'children': []}, {'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [854, 854], 'children': []}, {'type': 'VariableDecl', 'name': '_updated_webhook', 'range': [857, 895], 'children': [{'type': 'Keyword', 'name': 'await', 'range': [859, 859], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [860, 860], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [862, 862], 'children': []}, {'type': 'Identifier', 'name': 'update', 'range': [866, 866], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [869, 875], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [872, 872], 'children': []}, {'type': 'Identifier', 'name': 'webhook_id', 'range': [874, 874], 'children': []}]}, {'type': 'ObjectLiteral', 'name': 'data', 'range': [878, 887], 'children': [{'type': 'Literal', 'name': '"config"', 'range': [881, 881], 'children': []}, {'type': 'Identifier', 'name': 'Json', 'range': [883, 883], 'children': []}, {'type': 'Identifier', 'name': 'updated_config', 'range': [885, 885], 'children': []}]}, {'type': 'Identifier', 'name': 'include', 'range': [890, 892], 'children': [{'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [892, 892], 'children': []}]}]}, {'type': 'IfStatement', 'name': 'if', 'range': [897, 909], 'children': [{'type': 'Identifier', 'name': '_updated_webhook', 'range': [898, 898], 'children': []}, {'type': 'Keyword', 'name': 'is', 'range': [899, 899], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [900, 900], 'children': []}, {'type': 'RaiseStatement', 'name': 'raise', 'range': [903, 908], 'children': [{'type': 'Identifier', 'name': 'ValueError', 'range': [904, 904], 'children': []}, {'type': 'Literal', 'name': 'f"Webhook #{webhook_id} not found"', 'range': [907, 907], 'children': []}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [910, 917], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [911, 911], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [913, 913], 'children': []}, {'type': 'Identifier', 'name': '_updated_webhook', 'range': [915, 915], 'children': []}]}]}]}
2025-01-08 10:14:25,249 - INFO - Completed main AST analysis flow
2025-01-08 10:14:25,250 - INFO - Successfully processed chunk
2025-01-08 10:14:36,972 - INFO - Step 3 result: {'type': 'Program', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'FunctionDeclaration', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [385, 385], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [386, 386], 'children': []}, {'type': 'Identifier', 'name': 'create_webhook', 'range': [387, 387], 'children': []}, {'type': 'Parameter', 'name': 'webhook', 'range': [389, 392], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [389, 389], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [391, 391], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [393, 394], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [395, 395], 'children': []}, {'type': 'Block', 'name': '', 'range': [397, 501], 'children': [{'type': 'VariableDeclaration', 'name': 'created_webhook', 'range': [398, 491], 'children': [{'type': 'Identifier', 'name': 'created_webhook', 'range': [398, 398], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [400, 400], 'children': []}, {'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma().create', 'range': [401, 407], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [401, 401], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [403, 403], 'children': []}, {'type': 'Identifier', 'name': 'create', 'range': [407, 407], 'children': []}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [410, 489], 'children': [{'type': 'Property', 'name': 'id', 'range': [414, 419], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [414, 414], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.id', 'range': [416, 418], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [416, 416], 'children': []}, {'type': 'Identifier', 'name': 'id', 'range': [418, 418], 'children': []}]}]}, {'type': 'Property', 'name': 'userId', 'range': [421, 426], 'children': [{'type': 'Literal', 'name': '"userId"', 'range': [421, 421], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.user_id', 'range': [423, 425], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [423, 423], 'children': []}, {'type': 'Identifier', 'name': 'user_id', 'range': [425, 425], 'children': []}]}]}, {'type': 'Property', 'name': 'provider', 'range': [428, 435], 'children': [{'type': 'Literal', 'name': '"provider"', 'range': [428, 428], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider.value', 'range': [430, 434], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [430, 430], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [432, 432], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [434, 434], 'children': []}]}]}, {'type': 'Property', 'name': 'credentialsId', 'range': [437, 442], 'children': [{'type': 'Literal', 'name': '"credentialsId"', 'range': [437, 437], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.credentials_id', 'range': [439, 441], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [439, 439], 'children': []}, {'type': 'Identifier', 'name': 'credentials_id', 'range': [441, 441], 'children': []}]}]}, {'type': 'Property', 'name': 'webhookType', 'range': [444, 449], 'children': [{'type': 'Literal', 'name': '"webhookType"', 'range': [444, 444], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.webhook_type', 'range': [446, 448], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [446, 446], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [448, 448], 'children': []}]}]}, {'type': 'Property', 'name': 'resource', 'range': [451, 456], 'children': [{'type': 'Literal', 'name': '"resource"', 'range': [451, 451], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.resource', 'range': [453, 455], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [453, 453], 'children': []}, {'type': 'Identifier', 'name': 'resource', 'range': [455, 455], 'children': []}]}]}, {'type': 'Property', 'name': 'events', 'range': [458, 463], 'children': [{'type': 'Literal', 'name': '"events"', 'range': [458, 458], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.events', 'range': [460, 462], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [460, 460], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [462, 462], 'children': []}]}]}, {'type': 'Property', 'name': 'config', 'range': [465, 473], 'children': [{'type': 'Literal', 'name': '"config"', 'range': [465, 465], 'children': []}, {'type': 'CallExpression', 'name': 'Json', 'range': [467, 472], 'children': [{'type': 'Identifier', 'name': 'Json', 'range': [467, 467], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.config', 'range': [469, 471], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [469, 469], 'children': []}, {'type': 'Identifier', 'name': 'config', 'range': [471, 471], 'children': []}]}]}]}, {'type': 'Property', 'name': 'secret', 'range': [475, 480], 'children': [{'type': 'Literal', 'name': '"secret"', 'range': [475, 475], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.secret', 'range': [477, 479], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [477, 477], 'children': []}, {'type': 'Identifier', 'name': 'secret', 'range': [479, 479], 'children': []}]}]}, {'type': 'Property', 'name': 'providerWebhookId', 'range': [482, 487], 'children': [{'type': 'Literal', 'name': '"providerWebhookId"', 'range': [482, 482], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider_webhook_id', 'range': [484, 486], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [484, 484], 'children': []}, {'type': 'Identifier', 'name': 'provider_webhook_id', 'range': [486, 486], 'children': []}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [493, 500], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [493, 493], 'children': []}, {'type': 'CallExpression', 'name': 'Webhook.from_db', 'range': [494, 499], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [494, 494], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [496, 496], 'children': []}, {'type': 'Identifier', 'name': 'created_webhook', 'range': [498, 498], 'children': []}]}]}]}]}]}
2025-01-08 10:14:36,972 - INFO - Starting Step 4: AST normalization
2025-01-08 10:14:46,298 - INFO - Step 4 result: {'type': 'Program', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'FunctionDecl', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [729, 729], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [730, 730], 'children': []}, {'type': 'Identifier', 'name': 'find_webhook_by_graph_and_props', 'range': [731, 731], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [734, 736], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [734, 734], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [736, 736], 'children': []}]}, {'type': 'Parameter', 'name': 'provider', 'range': [738, 740], 'children': [{'type': 'Identifier', 'name': 'provider', 'range': [738, 738], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [740, 740], 'children': []}]}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [742, 744], 'children': [{'type': 'Identifier', 'name': 'webhook_type', 'range': [742, 742], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [744, 744], 'children': []}]}, {'type': 'Parameter', 'name': 'events', 'range': [746, 751], 'children': [{'type': 'Identifier', 'name': 'events', 'range': [746, 746], 'children': []}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [748, 748], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [750, 750], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [754, 755], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [756, 756], 'children': []}, {'type': 'TypeAnnotation', 'name': 'None', 'range': [758, 758], 'children': []}, {'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [762, 762], 'children': []}, {'type': 'VariableDecl', 'name': 'webhook', 'range': [765, 833], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [765, 765], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [767, 767], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [768, 768], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [770, 770], 'children': []}, {'type': 'Identifier', 'name': 'find_first', 'range': [774, 774], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [777, 813], 'children': [{'type': 'Property', 'name': '"provider"', 'range': [781, 783], 'children': [{'type': 'Literal', 'name': '"provider"', 'range': [781, 781], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [783, 783], 'children': []}]}, {'type': 'Property', 'name': '"webhookType"', 'range': [786, 788], 'children': [{'type': 'Literal', 'name': '"webhookType"', 'range': [786, 786], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [788, 788], 'children': []}]}, {'type': 'Property', 'name': '"events"', 'range': [791, 797], 'children': [{'type': 'Literal', 'name': '"events"', 'range': [791, 791], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"has_every": events}', 'range': [793, 797], 'children': [{'type': 'Property', 'name': '"has_every"', 'range': [794, 796], 'children': [{'type': 'Literal', 'name': '"has_every"', 'range': [794, 794], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [796, 796], 'children': []}]}]}]}, {'type': 'Property', 'name': '"AgentNodes"', 'range': [800, 810], 'children': [{'type': 'Literal', 'name': '"AgentNodes"', 'range': [800, 800], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"some": {"agentGraphId": graph_id}}', 'range': [802, 810], 'children': [{'type': 'Property', 'name': '"some"', 'range': [803, 805], 'children': [{'type': 'Literal', 'name': '"some"', 'range': [803, 803], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"agentGraphId": graph_id}', 'range': [805, 809], 'children': [{'type': 'Property', 'name': '"agentGraphId"', 'range': [806, 808], 'children': [{'type': 'Literal', 'name': '"agentGraphId"', 'range': [806, 806], 'children': []}, {'type': 'Identifier', 'name': 'graph_id', 'range': [808, 808], 'children': []}]}]}]}]}]}]}, {'type': 'Identifier', 'name': 'include', 'range': [816, 816], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [818, 818], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [823, 833], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [824, 824], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [826, 826], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [828, 828], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [830, 830], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [831, 831], 'children': []}]}, {'type': 'Keyword', 'name': 'else', 'range': [832, 832], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [833, 833], 'children': []}]}]}]}
2025-01-08 10:14:46,298 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:14:49,612 - INFO - Step 4 result: {'nodes': [{'type': 'ClassDecl', 'name': 'Webhook', 'range': [101, 167], 'children': [{'type': 'ClassBody', 'range': [107, 167], 'children': [{'type': 'FieldDecl', 'name': 'user_id', 'range': [108, 110], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [110]}]}, {'type': 'FieldDecl', 'name': 'provider', 'range': [112, 114], 'children': [{'type': 'TypeAnnotation', 'name': 'ProviderName', 'range': [114]}]}, {'type': 'FieldDecl', 'name': 'credentials_id', 'range': [116, 118], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [118]}]}, {'type': 'FieldDecl', 'name': 'webhook_type', 'range': [120, 122], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [122]}]}, {'type': 'FieldDecl', 'name': 'resource', 'range': [124, 126], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [126]}]}, {'type': 'FieldDecl', 'name': 'events', 'range': [128, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [130, 133], 'children': [{'type': 'TypeArgument', 'name': 'str', 'range': [132]}]}]}, {'type': 'FieldDecl', 'name': 'config', 'range': [135, 144], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [137]}, {'type': 'Assignment', 'name': 'Field', 'range': [139, 144], 'children': [{'type': 'Argument', 'name': 'default_factory', 'range': [141, 143], 'children': [{'type': 'Value', 'name': 'dict', 'range': [143]}]}]}]}, {'type': 'FieldDecl', 'name': 'secret', 'range': [146, 148], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [148]}]}, {'type': 'FieldDecl', 'name': 'provider_webhook_id', 'range': [151, 153], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [153]}]}, {'type': 'FieldDecl', 'name': 'attached_nodes', 'range': [156, 166], 'children': [{'type': 'TypeAnnotation', 'name': 'Optional', 'range': [158, 164], 'children': [{'type': 'TypeArgument', 'name': 'list', 'range': [160, 163], 'children': [{'type': 'TypeArgument', 'name': 'NodeModel', 'range': [162]}]}]}, {'type': 'Assignment', 'name': 'None', 'range': [166]}]}]}]}, {'type': 'FunctionDecl', 'name': 'url', 'range': [175, 198], 'children': [{'type': 'FunctionBody', 'range': [184, 198], 'children': [{'type': 'ReturnStatement', 'range': [185, 197], 'children': [{'type': 'CallExpression', 'name': 'webhook_ingress_url', 'range': [186, 197], 'children': [{'type': 'Argument', 'name': 'self.provider.value', 'range': [188, 192]}, {'type': 'Argument', 'name': 'self.id', 'range': [194, 196]}]}]}]}]}, {'type': 'FunctionDecl', 'name': 'from_db', 'range': [203, 333], 'children': [{'type': 'FunctionBody', 'range': [211, 333], 'children': [{'type': 'ImportStatement', 'range': [212, 216], 'children': [{'type': 'ImportSource', 'name': 'graph', 'range': [213]}, {'type': 'ImportedItem', 'name': 'NodeModel', 'range': [216]}]}, {'type': 'ReturnStatement', 'range': [219, 332], 'children': [{'type': 'CallExpression', 'name': 'Webhook', 'range': [220, 332], 'children': [{'type': 'Argument', 'name': 'id', 'range': [223, 227], 'children': [{'type': 'Value', 'name': 'webhook.id', 'range': [225, 227]}]}, {'type': 'Argument', 'name': 'user_id', 'range': [230, 234], 'children': [{'type': 'Value', 'name': 'webhook.userId', 'range': [232, 234]}]}, {'type': 'Argument', 'name': 'provider', 'range': [237, 244], 'children': [{'type': 'CallExpression', 'name': 'ProviderName', 'range': [239, 244], 'children': [{'type': 'Argument', 'name': 'webhook.provider', 'range': [241, 243]}]}]}, {'type': 'Argument', 'name': 'credentials_id', 'range': [247, 251], 'children': [{'type': 'Value', 'name': 'webhook.credentialsId', 'range': [249, 251]}]}, {'type': 'Argument', 'name': 'webhook_type', 'range': [254, 258], 'children': [{'type': 'Value', 'name': 'webhook.webhookType', 'range': [256, 258]}]}, {'type': 'Argument', 'name': 'resource', 'range': [261, 265], 'children': [{'type': 'Value', 'name': 'webhook.resource', 'range': [263, 265]}]}, {'type': 'Argument', 'name': 'events', 'range': [268, 272], 'children': [{'type': 'Value', 'name': 'webhook.events', 'range': [270, 272]}]}, {'type': 'Argument', 'name': 'config', 'range': [275, 282], 'children': [{'type': 'CallExpression', 'name': 'dict', 'range': [277, 282], 'children': [{'type': 'Argument', 'name': 'webhook.config', 'range': [279, 281]}]}]}, {'type': 'Argument', 'name': 'secret', 'range': [285, 289], 'children': [{'type': 'Value', 'name': 'webhook.secret', 'range': [287, 289]}]}, {'type': 'Argument', 'name': 'provider_webhook_id', 'range': [292, 296], 'children': [{'type': 'Value', 'name': 'webhook.providerWebhookId', 'range': [294, 296]}]}, {'type': 'Argument', 'name': 'attached_nodes', 'range': [299, 329], 'children': [{'type': 'ConditionalExpression', 'range': [301, 329], 'children': [{'type': 'Condition', 'range': [318, 324], 'children': [{'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [321]}]}, {'type': 'Consequent', 'range': [302, 316], 'children': [{'type': 'ListComprehension', 'range': [303, 316], 'children': [{'type': 'Element', 'range': [304, 309], 'children': [{'type': 'CallExpression', 'name': 'NodeModel.from_db', 'range': [306, 309], 'children': [{'type': 'Argument', 'name': 'node', 'range': [308]}]}]}, {'type': 'Iterator', 'range': [310, 313], 'children': [{'type': 'Value', 'name': 'node', 'range': [311]}, {'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [313]}]}]}]}, {'type': 'Alternate', 'range': [326, 327], 'children': [{'type': 'Value', 'name': 'None', 'range': [327]}]}]}]}]}]}]}]}]}
2025-01-08 10:14:49,612 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:15:25,043 - INFO - Step 5 result: {'type': 'Program', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'FunctionDecl', 'name': 'find_webhook_by_graph_and_props', 'range': [729, 835], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [729, 729], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [730, 730], 'children': []}, {'type': 'Identifier', 'name': 'find_webhook_by_graph_and_props', 'range': [731, 731], 'children': []}, {'type': 'Parameter', 'name': 'graph_id', 'range': [734, 736], 'children': [{'type': 'Identifier', 'name': 'graph_id', 'range': [734, 734], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [736, 736], 'children': []}]}, {'type': 'Parameter', 'name': 'provider', 'range': [738, 740], 'children': [{'type': 'Identifier', 'name': 'provider', 'range': [738, 738], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [740, 740], 'children': []}]}, {'type': 'Parameter', 'name': 'webhook_type', 'range': [742, 744], 'children': [{'type': 'Identifier', 'name': 'webhook_type', 'range': [742, 742], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [744, 744], 'children': []}]}, {'type': 'Parameter', 'name': 'events', 'range': [746, 751], 'children': [{'type': 'Identifier', 'name': 'events', 'range': [746, 746], 'children': []}, {'type': 'TypeAnnotation', 'name': 'list', 'range': [748, 748], 'children': []}, {'type': 'TypeAnnotation', 'name': 'str', 'range': [750, 750], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [754, 755], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [756, 756], 'children': []}, {'type': 'TypeAnnotation', 'name': 'None', 'range': [758, 758], 'children': []}, {'type': 'Literal', 'name': '"⚠️ No `user_id` check: DO NOT USE without check in user-facing endpoints."', 'range': [762, 762], 'children': []}, {'type': 'VariableDecl', 'name': 'webhook', 'range': [765, 833], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [765, 765], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [767, 767], 'children': []}, {'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [768, 768], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [770, 770], 'children': []}, {'type': 'Identifier', 'name': 'find_first', 'range': [774, 774], 'children': []}, {'type': 'ObjectLiteral', 'name': 'where', 'range': [777, 813], 'children': [{'type': 'Property', 'name': '"provider"', 'range': [781, 783], 'children': [{'type': 'Literal', 'name': '"provider"', 'range': [781, 781], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [783, 783], 'children': []}]}, {'type': 'Property', 'name': '"webhookType"', 'range': [786, 788], 'children': [{'type': 'Literal', 'name': '"webhookType"', 'range': [786, 786], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [788, 788], 'children': []}]}, {'type': 'Property', 'name': '"events"', 'range': [791, 797], 'children': [{'type': 'Literal', 'name': '"events"', 'range': [791, 791], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"has_every": events}', 'range': [793, 797], 'children': [{'type': 'Property', 'name': '"has_every"', 'range': [794, 796], 'children': [{'type': 'Literal', 'name': '"has_every"', 'range': [794, 794], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [796, 796], 'children': []}]}]}]}, {'type': 'Property', 'name': '"AgentNodes"', 'range': [800, 810], 'children': [{'type': 'Literal', 'name': '"AgentNodes"', 'range': [800, 800], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"some": {"agentGraphId": graph_id}}', 'range': [802, 810], 'children': [{'type': 'Property', 'name': '"some"', 'range': [803, 805], 'children': [{'type': 'Literal', 'name': '"some"', 'range': [803, 803], 'children': []}, {'type': 'ObjectLiteral', 'name': '{"agentGraphId": graph_id}', 'range': [805, 809], 'children': [{'type': 'Property', 'name': '"agentGraphId"', 'range': [806, 808], 'children': [{'type': 'Literal', 'name': '"agentGraphId"', 'range': [806, 806], 'children': []}, {'type': 'Identifier', 'name': 'graph_id', 'range': [808, 808], 'children': []}]}]}]}]}]}]}, {'type': 'Identifier', 'name': 'include', 'range': [816, 816], 'children': []}, {'type': 'Identifier', 'name': 'INTEGRATION_WEBHOOK_INCLUDE', 'range': [818, 818], 'children': []}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [823, 833], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [824, 824], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [826, 826], 'children': []}, {'type': 'Identifier', 'name': 'webhook', 'range': [828, 828], 'children': []}, {'type': 'IfStatement', 'name': 'if', 'range': [830, 830], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [831, 831], 'children': []}]}, {'type': 'Keyword', 'name': 'else', 'range': [832, 832], 'children': []}, {'type': 'Identifier', 'name': 'None', 'range': [833, 833], 'children': []}]}]}]}
2025-01-08 10:15:25,043 - INFO - Completed main AST analysis flow
2025-01-08 10:15:25,044 - INFO - Successfully processed chunk
2025-01-08 10:15:27,469 - INFO - Step 4 result: {'type': 'Program', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'FunctionDecl', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [385, 385], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [386, 386], 'children': []}, {'type': 'Identifier', 'name': 'create_webhook', 'range': [387, 387], 'children': []}, {'type': 'Parameter', 'name': 'webhook', 'range': [389, 392], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [389, 389], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [391, 391], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [393, 394], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [395, 395], 'children': []}, {'type': 'Block', 'name': '', 'range': [397, 501], 'children': [{'type': 'VariableDecl', 'name': 'created_webhook', 'range': [398, 491], 'children': [{'type': 'Identifier', 'name': 'created_webhook', 'range': [398, 398], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [400, 400], 'children': []}, {'type': 'CallExpression', 'name': 'IntegrationWebhook.prisma().create', 'range': [401, 407], 'children': [{'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma', 'range': [401, 403], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [401, 401], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [403, 403], 'children': []}]}, {'type': 'Identifier', 'name': 'create', 'range': [407, 407], 'children': []}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [410, 489], 'children': [{'type': 'Property', 'name': 'id', 'range': [414, 419], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [414, 414], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.id', 'range': [416, 418], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [416, 416], 'children': []}, {'type': 'Identifier', 'name': 'id', 'range': [418, 418], 'children': []}]}]}, {'type': 'Property', 'name': 'userId', 'range': [421, 426], 'children': [{'type': 'Literal', 'name': '"userId"', 'range': [421, 421], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.user_id', 'range': [423, 425], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [423, 423], 'children': []}, {'type': 'Identifier', 'name': 'user_id', 'range': [425, 425], 'children': []}]}]}, {'type': 'Property', 'name': 'provider', 'range': [428, 435], 'children': [{'type': 'Literal', 'name': '"provider"', 'range': [428, 428], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider.value', 'range': [430, 434], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [430, 430], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [432, 432], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [434, 434], 'children': []}]}]}, {'type': 'Property', 'name': 'credentialsId', 'range': [437, 442], 'children': [{'type': 'Literal', 'name': '"credentialsId"', 'range': [437, 437], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.credentials_id', 'range': [439, 441], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [439, 439], 'children': []}, {'type': 'Identifier', 'name': 'credentials_id', 'range': [441, 441], 'children': []}]}]}, {'type': 'Property', 'name': 'webhookType', 'range': [444, 449], 'children': [{'type': 'Literal', 'name': '"webhookType"', 'range': [444, 444], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.webhook_type', 'range': [446, 448], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [446, 446], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [448, 448], 'children': []}]}]}, {'type': 'Property', 'name': 'resource', 'range': [451, 456], 'children': [{'type': 'Literal', 'name': '"resource"', 'range': [451, 451], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.resource', 'range': [453, 455], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [453, 453], 'children': []}, {'type': 'Identifier', 'name': 'resource', 'range': [455, 455], 'children': []}]}]}, {'type': 'Property', 'name': 'events', 'range': [458, 463], 'children': [{'type': 'Literal', 'name': '"events"', 'range': [458, 458], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.events', 'range': [460, 462], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [460, 460], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [462, 462], 'children': []}]}]}, {'type': 'Property', 'name': 'config', 'range': [465, 473], 'children': [{'type': 'Literal', 'name': '"config"', 'range': [465, 465], 'children': []}, {'type': 'CallExpression', 'name': 'Json', 'range': [467, 472], 'children': [{'type': 'Identifier', 'name': 'Json', 'range': [467, 467], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.config', 'range': [469, 471], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [469, 469], 'children': []}, {'type': 'Identifier', 'name': 'config', 'range': [471, 471], 'children': []}]}]}]}, {'type': 'Property', 'name': 'secret', 'range': [475, 480], 'children': [{'type': 'Literal', 'name': '"secret"', 'range': [475, 475], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.secret', 'range': [477, 479], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [477, 477], 'children': []}, {'type': 'Identifier', 'name': 'secret', 'range': [479, 479], 'children': []}]}]}, {'type': 'Property', 'name': 'providerWebhookId', 'range': [482, 487], 'children': [{'type': 'Literal', 'name': '"providerWebhookId"', 'range': [482, 482], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider_webhook_id', 'range': [484, 486], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [484, 484], 'children': []}, {'type': 'Identifier', 'name': 'provider_webhook_id', 'range': [486, 486], 'children': []}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [493, 500], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [493, 493], 'children': []}, {'type': 'CallExpression', 'name': 'Webhook.from_db', 'range': [494, 499], 'children': [{'type': 'MemberExpression', 'name': 'Webhook.from_db', 'range': [494, 496], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [494, 494], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [496, 496], 'children': []}]}, {'type': 'Identifier', 'name': 'created_webhook', 'range': [498, 498], 'children': []}]}]}]}]}]}
2025-01-08 10:15:27,470 - INFO - Starting Step 5: Final AST combination
2025-01-08 10:15:35,939 - INFO - Step 5 result: {'nodes': [{'type': 'Program', 'name': 'WebhookClass', 'range': [101, 167], 'children': [{'type': 'ClassDecl', 'name': 'Webhook', 'range': [101, 167], 'children': [{'type': 'ClassBody', 'range': [107, 167], 'children': [{'type': 'FieldDecl', 'name': 'user_id', 'range': [108, 110], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [110]}]}, {'type': 'FieldDecl', 'name': 'provider', 'range': [112, 114], 'children': [{'type': 'TypeAnnotation', 'name': 'ProviderName', 'range': [114]}]}, {'type': 'FieldDecl', 'name': 'credentials_id', 'range': [116, 118], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [118]}]}, {'type': 'FieldDecl', 'name': 'webhook_type', 'range': [120, 122], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [122]}]}, {'type': 'FieldDecl', 'name': 'resource', 'range': [124, 126], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [126]}]}, {'type': 'FieldDecl', 'name': 'events', 'range': [128, 133], 'children': [{'type': 'TypeAnnotation', 'name': 'list', 'range': [130, 133], 'children': [{'type': 'TypeArgument', 'name': 'str', 'range': [132]}]}]}, {'type': 'FieldDecl', 'name': 'config', 'range': [135, 144], 'children': [{'type': 'TypeAnnotation', 'name': 'dict', 'range': [137]}, {'type': 'Assignment', 'name': 'Field', 'range': [139, 144], 'children': [{'type': 'Argument', 'name': 'default_factory', 'range': [141, 143], 'children': [{'type': 'Value', 'name': 'dict', 'range': [143]}]}]}]}, {'type': 'FieldDecl', 'name': 'secret', 'range': [146, 148], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [148]}]}, {'type': 'FieldDecl', 'name': 'provider_webhook_id', 'range': [151, 153], 'children': [{'type': 'TypeAnnotation', 'name': 'str', 'range': [153]}]}, {'type': 'FieldDecl', 'name': 'attached_nodes', 'range': [156, 166], 'children': [{'type': 'TypeAnnotation', 'name': 'Optional', 'range': [158, 164], 'children': [{'type': 'TypeArgument', 'name': 'list', 'range': [160, 163], 'children': [{'type': 'TypeArgument', 'name': 'NodeModel', 'range': [162]}]}]}, {'type': 'Assignment', 'name': 'None', 'range': [166]}]}]}]}]}, {'type': 'Program', 'name': 'UrlFunction', 'range': [175, 198], 'children': [{'type': 'FunctionDecl', 'name': 'url', 'range': [175, 198], 'children': [{'type': 'FunctionBody', 'range': [184, 198], 'children': [{'type': 'ReturnStatement', 'range': [185, 197], 'children': [{'type': 'CallExpression', 'name': 'webhook_ingress_url', 'range': [186, 197], 'children': [{'type': 'Argument', 'name': 'self.provider.value', 'range': [188, 192]}, {'type': 'Argument', 'name': 'self.id', 'range': [194, 196]}]}]}]}]}]}, {'type': 'Program', 'name': 'FromDbFunction', 'range': [203, 333], 'children': [{'type': 'FunctionDecl', 'name': 'from_db', 'range': [203, 333], 'children': [{'type': 'FunctionBody', 'range': [211, 333], 'children': [{'type': 'ImportStatement', 'range': [212, 216], 'children': [{'type': 'ImportSource', 'name': 'graph', 'range': [213]}, {'type': 'ImportedItem', 'name': 'NodeModel', 'range': [216]}]}, {'type': 'ReturnStatement', 'range': [219, 332], 'children': [{'type': 'CallExpression', 'name': 'Webhook', 'range': [220, 332], 'children': [{'type': 'Argument', 'name': 'id', 'range': [223, 227], 'children': [{'type': 'Value', 'name': 'webhook.id', 'range': [225, 227]}]}, {'type': 'Argument', 'name': 'user_id', 'range': [230, 234], 'children': [{'type': 'Value', 'name': 'webhook.userId', 'range': [232, 234]}]}, {'type': 'Argument', 'name': 'provider', 'range': [237, 244], 'children': [{'type': 'CallExpression', 'name': 'ProviderName', 'range': [239, 244], 'children': [{'type': 'Argument', 'name': 'webhook.provider', 'range': [241, 243]}]}]}, {'type': 'Argument', 'name': 'credentials_id', 'range': [247, 251], 'children': [{'type': 'Value', 'name': 'webhook.credentialsId', 'range': [249, 251]}]}, {'type': 'Argument', 'name': 'webhook_type', 'range': [254, 258], 'children': [{'type': 'Value', 'name': 'webhook.webhookType', 'range': [256, 258]}]}, {'type': 'Argument', 'name': 'resource', 'range': [261, 265], 'children': [{'type': 'Value', 'name': 'webhook.resource', 'range': [263, 265]}]}, {'type': 'Argument', 'name': 'events', 'range': [268, 272], 'children': [{'type': 'Value', 'name': 'webhook.events', 'range': [270, 272]}]}, {'type': 'Argument', 'name': 'config', 'range': [275, 282], 'children': [{'type': 'CallExpression', 'name': 'dict', 'range': [277, 282], 'children': [{'type': 'Argument', 'name': 'webhook.config', 'range': [279, 281]}]}]}, {'type': 'Argument', 'name': 'secret', 'range': [285, 289], 'children': [{'type': 'Value', 'name': 'webhook.secret', 'range': [287, 289]}]}, {'type': 'Argument', 'name': 'provider_webhook_id', 'range': [292, 296], 'children': [{'type': 'Value', 'name': 'webhook.providerWebhookId', 'range': [294, 296]}]}, {'type': 'Argument', 'name': 'attached_nodes', 'range': [299, 329], 'children': [{'type': 'ConditionalExpression', 'range': [301, 329], 'children': [{'type': 'Condition', 'range': [318, 324], 'children': [{'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [321]}]}, {'type': 'Consequent', 'range': [302, 316], 'children': [{'type': 'ListComprehension', 'range': [303, 316], 'children': [{'type': 'Element', 'range': [304, 309], 'children': [{'type': 'CallExpression', 'name': 'NodeModel.from_db', 'range': [306, 309], 'children': [{'type': 'Argument', 'name': 'node', 'range': [308]}]}]}, {'type': 'Iterator', 'range': [310, 313], 'children': [{'type': 'Value', 'name': 'node', 'range': [311]}, {'type': 'Value', 'name': 'webhook.AgentNodes', 'range': [313]}]}]}]}, {'type': 'Alternate', 'range': [326, 327], 'children': [{'type': 'Value', 'name': 'None', 'range': [327]}]}]}]}]}]}]}]}]}]}
2025-01-08 10:15:35,939 - INFO - Completed main AST analysis flow
2025-01-08 10:15:35,940 - INFO - Successfully processed chunk
2025-01-08 10:16:17,132 - INFO - Step 5 result: {'type': 'Program', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'FunctionDecl', 'name': 'create_webhook', 'range': [385, 501], 'children': [{'type': 'Keyword', 'name': 'async', 'range': [385, 385], 'children': []}, {'type': 'Keyword', 'name': 'def', 'range': [386, 386], 'children': []}, {'type': 'Identifier', 'name': 'create_webhook', 'range': [387, 387], 'children': []}, {'type': 'Parameter', 'name': 'webhook', 'range': [389, 392], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [389, 389], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [391, 391], 'children': []}]}, {'type': 'ReturnType', 'name': '->', 'range': [393, 394], 'children': []}, {'type': 'TypeAnnotation', 'name': 'Webhook', 'range': [395, 395], 'children': []}, {'type': 'Block', 'name': '', 'range': [397, 501], 'children': [{'type': 'VariableDecl', 'name': 'created_webhook', 'range': [398, 491], 'children': [{'type': 'Identifier', 'name': 'created_webhook', 'range': [398, 398], 'children': []}, {'type': 'Keyword', 'name': 'await', 'range': [400, 400], 'children': []}, {'type': 'CallExpression', 'name': 'IntegrationWebhook.prisma().create', 'range': [401, 407], 'children': [{'type': 'MemberExpression', 'name': 'IntegrationWebhook.prisma', 'range': [401, 403], 'children': [{'type': 'Identifier', 'name': 'IntegrationWebhook', 'range': [401, 401], 'children': []}, {'type': 'Identifier', 'name': 'prisma', 'range': [403, 403], 'children': []}]}, {'type': 'Identifier', 'name': 'create', 'range': [407, 407], 'children': []}]}, {'type': 'ObjectExpression', 'name': 'data', 'range': [410, 489], 'children': [{'type': 'Property', 'name': 'id', 'range': [414, 419], 'children': [{'type': 'Literal', 'name': '"id"', 'range': [414, 414], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.id', 'range': [416, 418], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [416, 416], 'children': []}, {'type': 'Identifier', 'name': 'id', 'range': [418, 418], 'children': []}]}]}, {'type': 'Property', 'name': 'userId', 'range': [421, 426], 'children': [{'type': 'Literal', 'name': '"userId"', 'range': [421, 421], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.user_id', 'range': [423, 425], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [423, 423], 'children': []}, {'type': 'Identifier', 'name': 'user_id', 'range': [425, 425], 'children': []}]}]}, {'type': 'Property', 'name': 'provider', 'range': [428, 435], 'children': [{'type': 'Literal', 'name': '"provider"', 'range': [428, 428], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider.value', 'range': [430, 434], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [430, 430], 'children': []}, {'type': 'Identifier', 'name': 'provider', 'range': [432, 432], 'children': []}, {'type': 'Identifier', 'name': 'value', 'range': [434, 434], 'children': []}]}]}, {'type': 'Property', 'name': 'credentialsId', 'range': [437, 442], 'children': [{'type': 'Literal', 'name': '"credentialsId"', 'range': [437, 437], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.credentials_id', 'range': [439, 441], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [439, 439], 'children': []}, {'type': 'Identifier', 'name': 'credentials_id', 'range': [441, 441], 'children': []}]}]}, {'type': 'Property', 'name': 'webhookType', 'range': [444, 449], 'children': [{'type': 'Literal', 'name': '"webhookType"', 'range': [444, 444], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.webhook_type', 'range': [446, 448], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [446, 446], 'children': []}, {'type': 'Identifier', 'name': 'webhook_type', 'range': [448, 448], 'children': []}]}]}, {'type': 'Property', 'name': 'resource', 'range': [451, 456], 'children': [{'type': 'Literal', 'name': '"resource"', 'range': [451, 451], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.resource', 'range': [453, 455], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [453, 453], 'children': []}, {'type': 'Identifier', 'name': 'resource', 'range': [455, 455], 'children': []}]}]}, {'type': 'Property', 'name': 'events', 'range': [458, 463], 'children': [{'type': 'Literal', 'name': '"events"', 'range': [458, 458], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.events', 'range': [460, 462], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [460, 460], 'children': []}, {'type': 'Identifier', 'name': 'events', 'range': [462, 462], 'children': []}]}]}, {'type': 'Property', 'name': 'config', 'range': [465, 473], 'children': [{'type': 'Literal', 'name': '"config"', 'range': [465, 465], 'children': []}, {'type': 'CallExpression', 'name': 'Json', 'range': [467, 472], 'children': [{'type': 'Identifier', 'name': 'Json', 'range': [467, 467], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.config', 'range': [469, 471], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [469, 469], 'children': []}, {'type': 'Identifier', 'name': 'config', 'range': [471, 471], 'children': []}]}]}]}, {'type': 'Property', 'name': 'secret', 'range': [475, 480], 'children': [{'type': 'Literal', 'name': '"secret"', 'range': [475, 475], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.secret', 'range': [477, 479], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [477, 477], 'children': []}, {'type': 'Identifier', 'name': 'secret', 'range': [479, 479], 'children': []}]}]}, {'type': 'Property', 'name': 'providerWebhookId', 'range': [482, 487], 'children': [{'type': 'Literal', 'name': '"providerWebhookId"', 'range': [482, 482], 'children': []}, {'type': 'MemberExpression', 'name': 'webhook.provider_webhook_id', 'range': [484, 486], 'children': [{'type': 'Identifier', 'name': 'webhook', 'range': [484, 484], 'children': []}, {'type': 'Identifier', 'name': 'provider_webhook_id', 'range': [486, 486], 'children': []}]}]}]}]}, {'type': 'ReturnStatement', 'name': 'return', 'range': [493, 500], 'children': [{'type': 'Keyword', 'name': 'return', 'range': [493, 493], 'children': []}, {'type': 'CallExpression', 'name': 'Webhook.from_db', 'range': [494, 499], 'children': [{'type': 'MemberExpression', 'name': 'Webhook.from_db', 'range': [494, 496], 'children': [{'type': 'Identifier', 'name': 'Webhook', 'range': [494, 494], 'children': []}, {'type': 'Identifier', 'name': 'from_db', 'range': [496, 496], 'children': []}]}, {'type': 'Identifier', 'name': 'created_webhook', 'range': [498, 498], 'children': []}]}]}]}]}]}
2025-01-08 10:16:17,133 - INFO - Completed main AST analysis flow
2025-01-08 10:16:17,134 - INFO - Successfully processed chunk
2025-01-08 10:16:17,222 - INFO - Starting code generation from AST
2025-01-08 10:18:12,768 - INFO - Successfully generated code from AST
2025-01-08 10:18:12,769 - INFO - Starting static code similarity comparison
2025-01-08 10:18:12,792 - INFO - Static similarity result: {'final_score': 99.98, 'length_similarity': 99.87, 'token_similarity': 100.0, 'structure_similarity': 100.0, 'function_similarity': 100, 'complexity_similarity': 100.0, 'variable_similarity': 100}

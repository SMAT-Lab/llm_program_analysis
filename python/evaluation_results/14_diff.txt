--- ground_truth
+++ llm_generated
@@ -1,31 +1,40 @@
 import re
+
 from jinja2 import BaseLoader
 from jinja2.sandbox import SandboxedEnvironment
 class TextFormatter:
 
     def __init__(self):
+        # Create a sandboxed environment
         self.env = SandboxedEnvironment(loader=BaseLoader(), autoescape=True)
+
+        # Clear any registered filters, tests, and globals to minimize attack surface
         self.env.filters.clear()
         self.env.tests.clear()
         self.env.globals.clear()
 
+
     def format_string(self, template_str: str, values=None, **kwargs) -> str:
-        template_str = re.sub('(?<!{){[ a-zA-Z0-9_]+}', '{\\g<0>}', template_str)
+        # For python.format compatibility: replace all {...} with {{..}}.
+        # But avoid replacing {{...}} to {{{...}}}.
+        template_str = re.sub(r"(?<!{){[ a-zA-Z0-9_]+}", r"{\g<0>}", template_str)
         template = self.env.from_string(template_str)
         return template.render(values or {}, **kwargs)
 def __init__(self):
-    self.env = SandboxedEnvironment(loader=BaseLoader(), autoescape=True)
-    self.env.filters.clear()
-    self.env.tests.clear()
-    self.env.globals.clear()
-self.env = SandboxedEnvironment(loader=BaseLoader(), autoescape=True)
-self.env.filters.clear()
-self.env.tests.clear()
-self.env.globals.clear()
+        # Create a sandboxed environment
+        self.env = SandboxedEnvironment(loader=BaseLoader(), autoescape=True)
+
+        # Clear any registered filters, tests, and globals to minimize attack surface
+        self.env.filters.clear()
+        self.env.tests.clear()
+        self.env.globals.clear()
 def format_string(self, template_str: str, values=None, **kwargs) -> str:
-    template_str = re.sub('(?<!{){[ a-zA-Z0-9_]+}', '{\\g<0>}', template_str)
-    template = self.env.from_string(template_str)
-    return template.render(values or {}, **kwargs)
-template_str = re.sub('(?<!{){[ a-zA-Z0-9_]+}', '{\\g<0>}', template_str)
-template = self.env.from_string(template_str)
-return template.render(values or {}, **kwargs)+
+        # For python.format compatibility: replace all {...} with {{..}}.
+        # But avoid replacing {{...}} to {{{...}}}.
+
+        template_str = re.sub(r"(?<!{){[ a-zA-Z0-9_]+}", r"{\g<0>}", template_str)
+
+        template = self.env.from_string(template_str)
+
+        return template.render(values or {}, **kwargs)
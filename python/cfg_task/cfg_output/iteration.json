{
  "nodes": [
    {
      "id": "1",
      "type": "block",
      "statements": [
        "from typing import Any",
        "from backend.data.block import Block, BlockCategory, BlockOutput, BlockSchema",
        "from backend.data.model import SchemaField",
        "from backend.util.json import json",
        "class StepThroughItemsBlock(Block):\n\n    class Input(BlockSchema):\n        items: list = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default=[])\n        items_object: dict = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default={})\n        items_str: str = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default='')\n\n    class Output(BlockSchema):\n        item: Any = SchemaField(description='The current item in the iteration')\n        key: Any = SchemaField(description='The key or index of the current item in the iteration')\n\n    def __init__(self):\n        super().__init__(id='f66a3543-28d3-4ab5-8945-9b336371e2ce', input_schema=StepThroughItemsBlock.Input, output_schema=StepThroughItemsBlock.Output, categories={BlockCategory.LOGIC}, description='Iterates over a list or dictionary and outputs each item.', test_input={'items': [1, 2, 3, {'key1': 'value1', 'key2': 'value2'}]}, test_output=[('item', 1), ('key', 0), ('item', 2), ('key', 1), ('item', 3), ('key', 2), ('item', {'key1': 'value1', 'key2': 'value2'}), ('key', 3)], test_mock={})\n\n    def run(self, input_data: Input, **kwargs) -> BlockOutput:\n        for data in [input_data.items, input_data.items_object, input_data.items_str]:\n            if not data:\n                continue\n            if isinstance(data, str):\n                items = json.loads(data)\n            else:\n                items = data\n            if isinstance(items, dict):\n                for item in items.values():\n                    yield ('item', item)\n                    yield ('key', item)\n            else:\n                for (index, item) in enumerate(items):\n                    yield ('item', item)\n                    yield ('key', index)",
        "class Input(BlockSchema):\n    items: list = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default=[])\n    items_object: dict = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default={})\n    items_str: str = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default='')",
        "items: list = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default=[])",
        "items_object: dict = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default={})",
        "items_str: str = SchemaField(advanced=False, description='The list or dictionary of items to iterate over', placeholder=\"[1, 2, 3, 4, 5] or {'key1': 'value1', 'key2': 'value2'}\", default='')",
        "class Output(BlockSchema):\n    item: Any = SchemaField(description='The current item in the iteration')\n    key: Any = SchemaField(description='The key or index of the current item in the iteration')",
        "item: Any = SchemaField(description='The current item in the iteration')",
        "key: Any = SchemaField(description='The key or index of the current item in the iteration')",
        "def __init__(self):\n    super().__init__(id='f66a3543-28d3-4ab5-8945-9b336371e2ce', input_schema=StepThroughItemsBlock.Input, output_schema=StepThroughItemsBlock.Output, categories={BlockCategory.LOGIC}, description='Iterates over a list or dictionary and outputs each item.', test_input={'items': [1, 2, 3, {'key1': 'value1', 'key2': 'value2'}]}, test_output=[('item', 1), ('key', 0), ('item', 2), ('key', 1), ('item', 3), ('key', 2), ('item', {'key1': 'value1', 'key2': 'value2'}), ('key', 3)], test_mock={})",
        "super().__init__()",
        "def run(self, input_data: Input, **kwargs) -> BlockOutput:\n    for data in [input_data.items, input_data.items_object, input_data.items_str]:\n        if not data:\n            continue\n        if isinstance(data, str):\n            items = json.loads(data)\n        else:\n            items = data\n        if isinstance(items, dict):\n            for item in items.values():\n                yield ('item', item)\n                yield ('key', item)\n        else:\n            for (index, item) in enumerate(items):\n                yield ('item', item)\n                yield ('key', index)"
      ]
    },
    {
      "id": "2",
      "type": "block",
      "statements": [
        "data",
        "[input_data.items, input_data.items_object, input_data.items_str]"
      ]
    },
    {
      "id": "3",
      "type": "block",
      "statements": [
        "not data"
      ]
    },
    {
      "id": "4",
      "type": "block",
      "statements": []
    },
    {
      "id": "5",
      "type": "block",
      "statements": [
        "continue"
      ]
    },
    {
      "id": "6",
      "type": "block",
      "statements": []
    },
    {
      "id": "7",
      "type": "block",
      "statements": [
        "isinstance(data, str)"
      ]
    },
    {
      "id": "8",
      "type": "block",
      "statements": [
        "items = json.loads(data)"
      ]
    },
    {
      "id": "9",
      "type": "block",
      "statements": [
        "items = data"
      ]
    },
    {
      "id": "10",
      "type": "block",
      "statements": [
        "isinstance(items, dict)"
      ]
    },
    {
      "id": "11",
      "type": "block",
      "statements": []
    },
    {
      "id": "12",
      "type": "block",
      "statements": []
    },
    {
      "id": "13",
      "type": "block",
      "statements": []
    },
    {
      "id": "14",
      "type": "block",
      "statements": [
        "item",
        "items.values()"
      ]
    },
    {
      "id": "15",
      "type": "block",
      "statements": [
        "(yield ('item', item))",
        "(yield ('key', item))"
      ]
    },
    {
      "id": "16",
      "type": "block",
      "statements": []
    },
    {
      "id": "17",
      "type": "block",
      "statements": [
        "(index, item)",
        "enumerate(items)"
      ]
    },
    {
      "id": "18",
      "type": "block",
      "statements": [
        "(yield ('item', item))",
        "(yield ('key', index))"
      ]
    },
    {
      "id": "19",
      "type": "block",
      "statements": []
    }
  ],
  "edges": [
    {
      "source": "1",
      "target": "2",
      "type": "next"
    },
    {
      "source": "2",
      "target": "3",
      "type": "true"
    },
    {
      "source": "2",
      "target": "4",
      "type": "false"
    },
    {
      "source": "3",
      "target": "5",
      "type": "true"
    },
    {
      "source": "3",
      "target": "6",
      "type": "false"
    },
    {
      "source": "5",
      "target": "7",
      "type": "next"
    },
    {
      "source": "6",
      "target": "7",
      "type": "next"
    },
    {
      "source": "7",
      "target": "8",
      "type": "true"
    },
    {
      "source": "7",
      "target": "9",
      "type": "false"
    },
    {
      "source": "8",
      "target": "10",
      "type": "next"
    },
    {
      "source": "9",
      "target": "10",
      "type": "next"
    },
    {
      "source": "10",
      "target": "11",
      "type": "true"
    },
    {
      "source": "10",
      "target": "12",
      "type": "false"
    },
    {
      "source": "11",
      "target": "14",
      "type": "next"
    },
    {
      "source": "12",
      "target": "17",
      "type": "next"
    },
    {
      "source": "13",
      "target": "2",
      "type": "next"
    },
    {
      "source": "14",
      "target": "15",
      "type": "true"
    },
    {
      "source": "14",
      "target": "16",
      "type": "false"
    },
    {
      "source": "15",
      "target": "14",
      "type": "next"
    },
    {
      "source": "16",
      "target": "13",
      "type": "next"
    },
    {
      "source": "17",
      "target": "18",
      "type": "true"
    },
    {
      "source": "17",
      "target": "19",
      "type": "false"
    },
    {
      "source": "18",
      "target": "17",
      "type": "next"
    },
    {
      "source": "19",
      "target": "13",
      "type": "next"
    }
  ]
}
{
    "nodes": [
        {
            "id": "chunk_0_GlobalBlock_1",
            "code": "# -*- coding: utf-8 -*-\n"
        },
        {
            "id": "chunk_0_GlobalBlock_2",
            "code": "from mrjob.job import MRJob\n"
        },
        {
            "id": "chunk_1_RemoveDuplicateUrls_1",
            "code": "class RemoveDuplicateUrls(MRJob):\n\n"
        },
        {
            "id": "chunk_1_RemoveDuplicateUrls_2",
            "code": "    def mapper(self, _, line):\n        yield line, 1\n"
        },
        {
            "id": "chunk_1_RemoveDuplicateUrls_3",
            "code": "    def reducer(self, key, values):\n        total = sum(values)\n        if total == 1:\n            yield key, total\n"
        },
        {
            "id": "chunk_1_RemoveDuplicateUrls_4",
            "code": "    def steps(self):\n        \"\"\"Run the map and reduce steps.\"\"\"\n        return [\n            self.mr(mapper=self.mapper,\n                    reducer=self.reducer)\n        ]\n"
        },
        {
            "id": "chunk_2_mapper_1",
            "code": "    def mapper(self, _, line):\n        yield line, 1\n"
        },
        {
            "id": "chunk_3_reducer_1",
            "code": "    def reducer(self, key, values):\n        total = sum(values)\n"
        },
        {
            "id": "chunk_3_reducer_2",
            "code": "        if total == 1:\n            yield key, total\n"
        },
        {
            "id": "chunk_4_steps_1",
            "code": "    def steps(self):\n        \"\"\"Run the map and reduce steps.\"\"\"\n"
        },
        {
            "id": "chunk_4_steps_2",
            "code": "        return [\n            self.mr(mapper=self.mapper,\n                    reducer=self.reducer)\n        ]\n"
        },
        {
            "id": "chunk_5_GlobalBlock_1",
            "code": "if __name__ == '__main__':\n    RemoveDuplicateUrls.run()\n"
        }
    ],
    "edges": [
        {
            "from": "chunk_0_GlobalBlock_1",
            "to": "chunk_0_GlobalBlock_2"
        },
        {
            "from": "chunk_1_RemoveDuplicateUrls_1",
            "to": "chunk_1_RemoveDuplicateUrls_2"
        },
        {
            "from": "chunk_1_RemoveDuplicateUrls_1",
            "to": "chunk_1_RemoveDuplicateUrls_3"
        },
        {
            "from": "chunk_1_RemoveDuplicateUrls_1",
            "to": "chunk_1_RemoveDuplicateUrls_4"
        },
        {
            "from": "chunk_3_reducer_1",
            "to": "chunk_3_reducer_2"
        },
        {
            "from": "chunk_4_steps_1",
            "to": "chunk_4_steps_2"
        }
    ]
}
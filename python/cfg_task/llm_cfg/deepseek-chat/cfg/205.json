{
    "nodes": [
        {
            "id": "chunk_0_GlobalBlock_1",
            "code": "\"\"\"Analytics API\"\"\"\n"
        },
        {
            "id": "chunk_0_GlobalBlock_2",
            "code": "from typing import Annotated\n"
        },
        {
            "id": "chunk_0_GlobalBlock_3",
            "code": "import fastapi\n"
        },
        {
            "id": "chunk_0_GlobalBlock_4",
            "code": "import backend.data.analytics\nfrom backend.server.utils import get_user_id\n"
        },
        {
            "id": "chunk_0_GlobalBlock_5",
            "code": "router = fastapi.APIRouter()\n"
        },
        {
            "id": "chunk_1_log_raw_metric_1",
            "code": "@router.post(path=\"/log_raw_metric\")\nasync def log_raw_metric(\n    user_id: Annotated[str, fastapi.Depends(get_user_id)],\n    metric_name: Annotated[str, fastapi.Body(..., embed=True)],\n    metric_value: Annotated[float, fastapi.Body(..., embed=True)],\n    data_string: Annotated[str, fastapi.Body(..., embed=True)],\n):\n"
        },
        {
            "id": "chunk_1_log_raw_metric_2",
            "code": "    result = await backend.data.analytics.log_raw_metric(\n        user_id=user_id,\n        metric_name=metric_name,\n        metric_value=metric_value,\n        data_string=data_string,\n    )\n"
        },
        {
            "id": "chunk_1_log_raw_metric_3",
            "code": "    return result.id\n"
        },
        {
            "id": "chunk_2_log_raw_analytics_1",
            "code": "@router.post(\"/log_raw_analytics\")\nasync def log_raw_analytics(\n    user_id: Annotated[str, fastapi.Depends(get_user_id)],\n    type: Annotated[str, fastapi.Body(..., embed=True)],\n    data: Annotated[\n        dict,\n        fastapi.Body(..., embed=True, description=\"The data to log\"),\n    ],\n    data_index: Annotated[\n        str,\n        fastapi.Body(\n            ...,\n            embed=True,\n            description=\"Indexable field for any count based analytical measures like page order clicking, tutorial step completion, etc.\",\n        ),\n    ],\n):\n"
        },
        {
            "id": "chunk_2_log_raw_analytics_2",
            "code": "    result = await backend.data.analytics.log_raw_analytics(\n        user_id, type, data, data_index\n    )\n"
        },
        {
            "id": "chunk_2_log_raw_analytics_3",
            "code": "    return result.id\n"
        }
    ],
    "edges": [
        {
            "from": "chunk_0_GlobalBlock_1",
            "to": "chunk_0_GlobalBlock_2"
        },
        {
            "from": "chunk_0_GlobalBlock_2",
            "to": "chunk_0_GlobalBlock_3"
        },
        {
            "from": "chunk_0_GlobalBlock_3",
            "to": "chunk_0_GlobalBlock_4"
        },
        {
            "from": "chunk_0_GlobalBlock_4",
            "to": "chunk_0_GlobalBlock_5"
        },
        {
            "from": "chunk_1_log_raw_metric_1",
            "to": "chunk_1_log_raw_metric_2"
        },
        {
            "from": "chunk_1_log_raw_metric_2",
            "to": "chunk_1_log_raw_metric_3"
        },
        {
            "from": "chunk_2_log_raw_analytics_1",
            "to": "chunk_2_log_raw_analytics_2"
        },
        {
            "from": "chunk_2_log_raw_analytics_2",
            "to": "chunk_2_log_raw_analytics_3"
        }
    ]
}